---
uid: identity/overview/getting-started/aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider
title: 'ASP.net Identity: Verwenden von MySQL-Speicher mit einem EntityFramework MySQLC#-Anbieter ()-ASP.NET 4. x'
author: maumar
description: In diesem Tutorial wird gezeigt, wie Sie den standardmäßigen Datenspeichermechanismus für ASP.net Identity mit EntityFramework (SQL-Client Anbieter) durch eine MySQL-Bereitstellung ersetzen...
ms.author: riande
ms.date: 12/10/2013
ms.assetid: 15253312-a92c-43ba-908e-b5dacd3d08b8
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider
msc.type: authoredcontent
ms.openlocfilehash: e89ed139657c5ce9ddcc56879946c62038919483
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78471873"
---
# <a name="aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider-c"></a><span data-ttu-id="e55a9-103">ASP.net Identity: Verwenden von MySQL-Speicher mit einem EntityFramework MySQLC#-Anbieter ()</span><span class="sxs-lookup"><span data-stu-id="e55a9-103">ASP.NET Identity: Using MySQL Storage with an EntityFramework MySQL Provider (C#)</span></span>

<span data-ttu-id="e55a9-104">von [Maurycy Markowski](https://github.com/maumar), [Raquel de Almeida](https://github.com/raquelsa), [Robert McMurray](https://github.com/rmcmurray)</span><span class="sxs-lookup"><span data-stu-id="e55a9-104">by [Maurycy Markowski](https://github.com/maumar), [Raquel Soares De Almeida](https://github.com/raquelsa), [Robert McMurray](https://github.com/rmcmurray)</span></span>

> <span data-ttu-id="e55a9-105">In diesem Tutorial wird gezeigt, wie Sie den standardmäßigen Datenspeichermechanismus für [**ASP.net Identity**](introduction-to-aspnet-identity.md) mit EntityFramework (SQL-Client Anbieter) durch einen MySQL-Anbieter ersetzen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-105">This tutorial shows you how to replace the default data storage mechanism for [**ASP.NET Identity**](introduction-to-aspnet-identity.md) with EntityFramework (SQL client provider) with a MySQL provider.</span></span>

<span data-ttu-id="e55a9-106">In diesem Tutorial werden die folgenden Themen behandelt:</span><span class="sxs-lookup"><span data-stu-id="e55a9-106">The following topics will be covered in this tutorial:</span></span>

- <span data-ttu-id="e55a9-107">Erstellen einer MySQL-Datenbank in Azure</span><span class="sxs-lookup"><span data-stu-id="e55a9-107">Creating a MySQL database on Azure</span></span>
- <span data-ttu-id="e55a9-108">Erstellen einer MVC-Anwendung mit Visual Studio 2013 MVC-Vorlage</span><span class="sxs-lookup"><span data-stu-id="e55a9-108">Creating an MVC application using Visual Studio 2013 MVC template</span></span>
- <span data-ttu-id="e55a9-109">Konfigurieren von EntityFramework für die Zusammenarbeit mit einem MySQL-Datenbankanbieter</span><span class="sxs-lookup"><span data-stu-id="e55a9-109">Configuring EntityFramework to work with a MySQL database provider</span></span>
- <span data-ttu-id="e55a9-110">Ausführen der Anwendung zum Überprüfen der Ergebnisse</span><span class="sxs-lookup"><span data-stu-id="e55a9-110">Running the application to verify the results</span></span>

<span data-ttu-id="e55a9-111">Am Ende dieses Tutorials verfügen Sie über eine MVC-Anwendung mit dem ASP.net Identity-Speicher, der eine MySQL-Datenbank verwendet, die in Azure gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="e55a9-111">At the end of this tutorial, you will have an MVC application with the ASP.NET Identity store that is using a MySQL database that is hosted in Azure.</span></span>

## <a name="creating-a-mysql-database-instance-on-azure"></a><span data-ttu-id="e55a9-112">Erstellen einer MySQL-Daten Bank Instanz in Azure</span><span class="sxs-lookup"><span data-stu-id="e55a9-112">Creating a MySQL database instance on Azure</span></span>

1. <span data-ttu-id="e55a9-113">Melden Sie sich beim [Azure-Portal](https://go.microsoft.com/fwlink/?linkid=529715&amp;clcid=0x409)an.</span><span class="sxs-lookup"><span data-stu-id="e55a9-113">Log in to the [Azure Portal](https://go.microsoft.com/fwlink/?linkid=529715&amp;clcid=0x409).</span></span>
2. <span data-ttu-id="e55a9-114">Klicken Sie unten auf der Seite auf **neu** , und wählen Sie dann **Speichern**aus:</span><span class="sxs-lookup"><span data-stu-id="e55a9-114">Click **NEW** at the bottom of the page, and then select **STORE**:</span></span>

    [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image2.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image1.png)
3. <span data-ttu-id="e55a9-115">Wählen Sie im Assistenten zum **auswählen und hinzufügen** von **cleardb MySQL-Datenbank**aus, und klicken Sie dann unten im Frame auf den Pfeil " **weiter** ":</span><span class="sxs-lookup"><span data-stu-id="e55a9-115">In the **Choose and Add-on** wizard, select **ClearDB MySQL Database**, and then click the **Next** arrow at the bottom of the frame:</span></span>

   <span data-ttu-id="e55a9-116">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-116">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-117">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-117">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.png)</span></span>
4. <span data-ttu-id="e55a9-118">Behalten Sie den standardmäßigen **Free** -Plan bei, ändern Sie den **Namen** in **identitymysqldatabase**, wählen Sie die Region aus, die Sie am nächsten ist, und klicken Sie dann unten im Frame auf den Pfeil " **weiter** ":</span><span class="sxs-lookup"><span data-stu-id="e55a9-118">Keep the default **Free** plan, change the **NAME** to **IdentityMySQLDatabase**, select the region that is nearest to you, and then click the **Next** arrow at the bottom of the frame:</span></span>

   <span data-ttu-id="e55a9-119">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-119">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-120">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-120">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.png)</span></span>
5. <span data-ttu-id="e55a9-121">Klicken Sie **auf das** Häkchensymbol, um die Erstellung der Datenbank abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-121">Click the **PURCHASE** checkmark to complete the database creation.</span></span>

   <span data-ttu-id="e55a9-122">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-122">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-123">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-123">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.png)</span></span>
6. <span data-ttu-id="e55a9-124">Nachdem die Datenbank erstellt wurde, können Sie sie auf der Registerkarte **ADD-ONS** im Verwaltungsportal verwalten.</span><span class="sxs-lookup"><span data-stu-id="e55a9-124">After your database has been created, you can manage it from the **ADD-ONS** tab in the management portal.</span></span> <span data-ttu-id="e55a9-125">Zum Abrufen der Verbindungsinformationen für die Datenbank klicken Sie unten auf der Seite auf **Verbindungs** Informationen:</span><span class="sxs-lookup"><span data-stu-id="e55a9-125">To retrieve the connection information for your database, click **CONNECTION INFO** at the bottom of the page:</span></span>

   <span data-ttu-id="e55a9-126">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-126">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-127">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image10.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-127">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image10.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image9.png)</span></span>
7. <span data-ttu-id="e55a9-128">Kopieren Sie die Verbindungs Zeichenfolge, indem Sie auf die Schaltfläche "Kopieren" im Feld " **ConnectionString** " klicken und speichern. Diese Informationen werden später in diesem Tutorial für Ihre MVC-Anwendung verwendet:</span><span class="sxs-lookup"><span data-stu-id="e55a9-128">Copy the connection string by clicking on the copy button by the **CONNECTIONSTRING** field and save it; you will use this information later in this tutorial for your MVC application:</span></span>

   <span data-ttu-id="e55a9-129">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-129">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-130">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image12.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-130">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image12.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image11.png)</span></span>

## <a name="creating-an-mvc-application-project"></a><span data-ttu-id="e55a9-131">Erstellen eines MVC-Anwendungs Projekts</span><span class="sxs-lookup"><span data-stu-id="e55a9-131">Creating an MVC application project</span></span>

<span data-ttu-id="e55a9-132">Um die Schritte in diesem Abschnitt des Tutorials ausführen zu können, müssen Sie zuerst [Visual Studio Express 2013 für Web](https://go.microsoft.com/fwlink/?LinkId=299058) -oder [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566)installieren.</span><span class="sxs-lookup"><span data-stu-id="e55a9-132">To complete the steps in this section of the tutorial, you will first need to install [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="e55a9-133">Nachdem Visual Studio installiert wurde, führen Sie die folgenden Schritte aus, um ein neues MVC-Anwendungsprojekt zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="e55a9-133">Once Visual Studio has been installed, use the following steps to create a new MVC application project:</span></span>

1. <span data-ttu-id="e55a9-134">Öffnen Sie Visual Studio 2103.</span><span class="sxs-lookup"><span data-stu-id="e55a9-134">Open Visual Studio 2103.</span></span>
2. <span data-ttu-id="e55a9-135">Klicken Sie auf der **Start** Seite auf **Neues Projekt** , oder klicken Sie auf das Menü **Datei** und dann auf **Neues Projekt**:</span><span class="sxs-lookup"><span data-stu-id="e55a9-135">Click **New Project** from the **Start** page, or you can click the **File** menu and then **New Project**:</span></span>

   <span data-ttu-id="e55a9-136">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-136">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-137">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image2.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="e55a9-137">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image2.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image1.jpg)</span></span>
3. <span data-ttu-id="e55a9-138">Wenn das Dialogfeld **Neues Projekt** angezeigt wird, erweitern Sie in der Liste der Vorlagen die Option **Visualisierung C#**  , klicken Sie auf **Web**, und wählen Sie **ASP.NET Webanwendung**aus.</span><span class="sxs-lookup"><span data-stu-id="e55a9-138">When the **New Project** dialog box is displayed, expand **Visual C#** in the list of templates, then click **Web**, and select **ASP.NET Web Application**.</span></span> <span data-ttu-id="e55a9-139">Benennen Sie Ihr Projekt **identitymysqldemo** , und klicken Sie dann auf **OK**:</span><span class="sxs-lookup"><span data-stu-id="e55a9-139">Name your project **IdentityMySQLDemo** and then click **OK**:</span></span>

   <span data-ttu-id="e55a9-140">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-140">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-141">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image14.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-141">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image14.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image13.png)</span></span>
4. <span data-ttu-id="e55a9-142">Wählen Sie im Dialogfeld **Neues ASP.net-Projekt** die Option **MVC** -vorlagenvorlage mit den Standardoptionen aus. Dadurch werden **einzelne Benutzerkonten** als Authentifizierungsmethode konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="e55a9-142">In the **New ASP.NET Project** dialog, select the **MVC** templatewith the default options; this will configure **Individual User Accounts** as the authentication method.</span></span> <span data-ttu-id="e55a9-143">Klicken Sie auf **OK**:</span><span class="sxs-lookup"><span data-stu-id="e55a9-143">Click **OK**:</span></span>

   <span data-ttu-id="e55a9-144">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-144">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-145">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image16.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-145">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image16.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image15.png)</span></span>

## <a name="configure-entityframework-to-work-with-a-mysql-database"></a><span data-ttu-id="e55a9-146">Konfigurieren von EntityFramework für die Arbeit mit einer MySQL-Datenbank</span><span class="sxs-lookup"><span data-stu-id="e55a9-146">Configure EntityFramework to work with a MySQL database</span></span>

### <a name="update-the-entity-framework-assembly-for-your-project"></a><span data-ttu-id="e55a9-147">Aktualisieren Sie die Entity Framework Assembly für Ihr Projekt.</span><span class="sxs-lookup"><span data-stu-id="e55a9-147">Update the Entity Framework assembly for your project</span></span>

<span data-ttu-id="e55a9-148">Die MVC-Anwendung, die aus der Visual Studio 2013 Vorlage erstellt wurde, enthält einen Verweis auf das 6.0.0-Paket " [EntityFramework](http://www.nuget.org/packages/EntityFramework) ", es wurden jedoch seit der Veröffentlichung Updates für diese Assembly erstellt, die bedeutende Leistungsverbesserungen enthalten.</span><span class="sxs-lookup"><span data-stu-id="e55a9-148">The MVC application that was created from the Visual Studio 2013 template contains a reference to the [EntityFramework 6.0.0](http://www.nuget.org/packages/EntityFramework) package, but there have been updates to that assembly since its release which contain significant performance improvements.</span></span> <span data-ttu-id="e55a9-149">Führen Sie die folgenden Schritte aus, um die neuesten Updates in Ihrer Anwendung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="e55a9-149">In order to use these latest updates in your application, use the following steps.</span></span>

1. <span data-ttu-id="e55a9-150">Öffnen Sie Ihr MVC-Projekt in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e55a9-150">Open your MVC project in Visual Studio.</span></span>
2. <span data-ttu-id="e55a9-151">Klicken **Sie auf Extras und dann**auf **nuget-Paket-Manager**und anschließend auf Paket-Manager- **Konsole**:</span><span class="sxs-lookup"><span data-stu-id="e55a9-151">Click **Tools**, then click **NuGet Package Manager**, and then click **Package Manager Console**:</span></span>

   <span data-ttu-id="e55a9-152">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-152">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-153">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image18.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-153">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image18.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image17.png)</span></span>
3. <span data-ttu-id="e55a9-154">Die **Paket-Manager-Konsole** wird im unteren Abschnitt von Visual Studio angezeigt.</span><span class="sxs-lookup"><span data-stu-id="e55a9-154">The **Package Manager Console** will appear in the bottom section of Visual Studio.</span></span> <span data-ttu-id="e55a9-155">Geben Sie &quot;**Update-Package EntityFramework**&quot; ein, und drücken Sie die EINGABETASTE:</span><span class="sxs-lookup"><span data-stu-id="e55a9-155">Type &quot;**Update-Package EntityFramework**&quot; and press Enter:</span></span>

   <span data-ttu-id="e55a9-156">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-156">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-157">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image20.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-157">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image20.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image19.png)</span></span>

### <a name="install-the-mysql-provider-for-entityframework"></a><span data-ttu-id="e55a9-158">Installieren des MySQL-Anbieters für EntityFramework</span><span class="sxs-lookup"><span data-stu-id="e55a9-158">Install the MySQL provider for EntityFramework</span></span>

<span data-ttu-id="e55a9-159">Damit von EntityFramework eine Verbindung mit der MySQL-Datenbank hergestellt werden kann, müssen Sie einen MySQL-Anbieter installieren.</span><span class="sxs-lookup"><span data-stu-id="e55a9-159">In order for EntityFramework to connect to MySQL database, you need to install a MySQL provider.</span></span> <span data-ttu-id="e55a9-160">Öffnen Sie hierzu die Paket- **Manager-Konsole** , geben Sie &quot;**install-Package MySQL. Data. Entity-Pre**&quot;ein, und drücken Sie dann die EINGABETASTE.</span><span class="sxs-lookup"><span data-stu-id="e55a9-160">To do so, open the **Package Manager Console** and type &quot;**Install-Package MySql.Data.Entity -Pre**&quot;, and then press Enter.</span></span>

> [!NOTE]
> <span data-ttu-id="e55a9-161">Dabei handelt es sich um eine Vorabversion der Assembly, die möglicherweise Fehler enthält.</span><span class="sxs-lookup"><span data-stu-id="e55a9-161">This is a pre-release version of the assembly, and as such it may contain bugs.</span></span> <span data-ttu-id="e55a9-162">Sie sollten keine Vorabversion des Anbieters in der Produktionsumgebung verwenden.</span><span class="sxs-lookup"><span data-stu-id="e55a9-162">You should not use a pre-release version of the provider in production.</span></span>

<span data-ttu-id="e55a9-163">[Klicken Sie auf das folgende Bild, um es zu erweitern.]</span><span class="sxs-lookup"><span data-stu-id="e55a9-163">[Click the following image to expand it.]</span></span>

[![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image22.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image21.png)

### <a name="making-project-configuration-changes-to-the-webconfig-file-for-your-application"></a><span data-ttu-id="e55a9-164">Vornehmen von Änderungen an der Projekt Konfiguration in der Datei "Web. config" für Ihre Anwendung</span><span class="sxs-lookup"><span data-stu-id="e55a9-164">Making project configuration changes to the Web.config file for your application</span></span>

<span data-ttu-id="e55a9-165">In diesem Abschnitt Konfigurieren Sie die Entity Framework für die Verwendung des soeben installierten MySQL-Anbieters, registrieren die MySQL-Anbieterfactory und fügen Ihre Verbindungs Zeichenfolge aus Azure hinzu.</span><span class="sxs-lookup"><span data-stu-id="e55a9-165">In this section you will configure the Entity Framework to use the MySQL provider that you just installed, register the MySQL provider factory, and add your connection string from Azure.</span></span>

> [!NOTE]
> <span data-ttu-id="e55a9-166">Die folgenden Beispiele enthalten eine bestimmte Assemblyversion für MySQL. Data. dll.</span><span class="sxs-lookup"><span data-stu-id="e55a9-166">The following examples contain a specific assembly version for MySql.Data.dll.</span></span> <span data-ttu-id="e55a9-167">Wenn die Assemblyversion geändert wird, müssen Sie die entsprechenden Konfigurationseinstellungen mit der richtigen Version ändern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-167">If the assembly version changes, you will need to modify the appropriate configuration settings with the correct version.</span></span>

1. <span data-ttu-id="e55a9-168">Öffnen Sie die Datei "Web. config" für Ihr Projekt in Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="e55a9-168">Open the Web.config file for your project in Visual Studio 2013.</span></span>
2. <span data-ttu-id="e55a9-169">Suchen Sie die folgenden Konfigurationseinstellungen, mit denen der Standarddaten Bank Anbieter und die Factory für die Entity Framework definiert werden:</span><span class="sxs-lookup"><span data-stu-id="e55a9-169">Locate the following configuration settings, which define the default database provider and factory for the Entity Framework:</span></span>

    [!code-xml[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample1.xml)]
3. <span data-ttu-id="e55a9-170">Ersetzen Sie diese Konfigurationseinstellungen durch Folgendes, um die Entity Framework so zu konfigurieren, dass der MySQL-Anbieter verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="e55a9-170">Replace those configuration settings with the following, which will configure the Entity Framework to use the MySQL provider:</span></span>

    [!code-xml[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample2.xml)]
4. <span data-ttu-id="e55a9-171">Suchen Sie den &lt;connectionStrings-&gt; Abschnitt, und ersetzen Sie ihn durch den folgenden Code, der die Verbindungs Zeichenfolge für Ihre MySQL-Datenbank definiert, die in Azure gehostet wird (Beachten Sie, dass der Wert für "ProviderName" auch aus dem ursprünglichen geändert wurde):</span><span class="sxs-lookup"><span data-stu-id="e55a9-171">Locate the &lt;connectionStrings&gt; section and replace it with the following code, which will define the connection string for your MySQL database that is hosted on Azure (note that providerName value has also been changed from the original):</span></span>

    [!code-xml[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample3.xml?highlight=3-4)]

### <a name="adding-custom-migrationhistory-context"></a><span data-ttu-id="e55a9-172">Benutzerdefinierten migrationhistory-Kontext wird hinzugefügt</span><span class="sxs-lookup"><span data-stu-id="e55a9-172">Adding custom MigrationHistory context</span></span>

<span data-ttu-id="e55a9-173">Entity Framework Code First verwendet eine **migrationhistory** -Tabelle, um Modelländerungen nachzuverfolgen und die Konsistenz zwischen dem Datenbankschema und dem konzeptionellen Schema sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-173">Entity Framework Code First uses a **MigrationHistory** table to keep track of model changes and to ensure the consistency between the database schema and conceptual schema.</span></span> <span data-ttu-id="e55a9-174">Diese Tabelle funktioniert jedoch nicht standardmäßig für MySQL, da der Primärschlüssel zu groß ist.</span><span class="sxs-lookup"><span data-stu-id="e55a9-174">However, this table does not work for MySQL by default because the primary key is too large.</span></span> <span data-ttu-id="e55a9-175">Um diese Situation zu beheben, müssen Sie die Schlüsselgröße für diese Tabelle verkleinern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-175">To remedy this situation, you will need to shrink the key size for that table.</span></span> <span data-ttu-id="e55a9-176">Führen Sie dazu die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="e55a9-176">To do so, use the following steps:</span></span>

1. <span data-ttu-id="e55a9-177">Die Schema Informationen für diese Tabelle werden in einem **historycontext**aufgezeichnet, der wie ein beliebiger anderer **dbcontext**geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="e55a9-177">The schema information for this table is captured in a **HistoryContext**, which can be modified as any other **DbContext**.</span></span> <span data-ttu-id="e55a9-178">Fügen Sie zu diesem Zweck dem Projekt eine neue Klassendatei mit dem Namen **MySqlHistoryContext.cs** hinzu, und ersetzen Sie den Inhalt durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="e55a9-178">To do so, add a new class file named **MySqlHistoryContext.cs** to the project, and replace its contents with the following code:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample4.cs)]
2. <span data-ttu-id="e55a9-179">Als nächstes müssen Sie Entity Framework so konfigurieren, dass die geänderte **historycontext**anstelle der Standardeinstellung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="e55a9-179">Next you will need to configure Entity Framework to use the modified **HistoryContext**, rather than default one.</span></span> <span data-ttu-id="e55a9-180">Dies kann durch die Verwendung von Code basierten Konfigurationsfunktionen erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="e55a9-180">This can be done by leveraging code-based configuration features.</span></span> <span data-ttu-id="e55a9-181">Fügen Sie zu diesem Zweck dem Projekt eine neue Klassendatei mit dem Namen **MySqlConfiguration.cs** hinzu, und ersetzen Sie den Inhalt durch:</span><span class="sxs-lookup"><span data-stu-id="e55a9-181">To do so, add new class file named **MySqlConfiguration.cs** to your project and replace its contents with:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample5.cs)]

### <a name="creating-a-custom-entityframework-initializer-for-applicationdbcontext"></a><span data-ttu-id="e55a9-182">Erstellen eines benutzerdefinierten EntityFramework-Initialisierers für "applicationdbcontext"</span><span class="sxs-lookup"><span data-stu-id="e55a9-182">Creating a custom EntityFramework initializer for ApplicationDbContext</span></span>

<span data-ttu-id="e55a9-183">Der in diesem Tutorial vorgestellte MySQL-Anbieter unterstützt derzeit keine Entity Framework Migrationen, sodass Sie modellinitialisierer verwenden müssen, um eine Verbindung mit der Datenbank herzustellen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-183">The MySQL provider that is featured in this tutorial does not currently support Entity Framework migrations, so you will need to use model initializers in order to connect to the database.</span></span> <span data-ttu-id="e55a9-184">Da in diesem Tutorial eine MySQL-Instanz in Azure verwendet wird, müssen Sie einen benutzerdefinierten Entity Framework Initialisierer erstellen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-184">Because this tutorial is using a MySQL instance on Azure, you will need to create a custom Entity Framework initializer.</span></span>

> [!NOTE]
> <span data-ttu-id="e55a9-185">Dieser Schritt ist nicht erforderlich, wenn Sie eine Verbindung mit einer SQL Server Instanz in Azure herstellen oder wenn Sie eine Datenbank verwenden, die lokal gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="e55a9-185">This step is not required if you are connecting to a SQL Server instance on Azure or if you are using a database that is hosted on premises.</span></span>

<span data-ttu-id="e55a9-186">Führen Sie die folgenden Schritte aus, um einen benutzerdefinierten Entity Framework Initialisierer für MySQL zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="e55a9-186">To create a custom Entity Framework initializer for MySQL, use the following steps:</span></span>

1. <span data-ttu-id="e55a9-187">Fügen Sie dem Projekt eine neue Klassendatei mit dem Namen **MySqlInitializer.cs** hinzu, und ersetzen Sie deren Inhalt durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="e55a9-187">Add a new class file named **MySqlInitializer.cs** to the project, and replace it's contents with the following code:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample6.cs?highlight=23)]
2. <span data-ttu-id="e55a9-188">Öffnen Sie die Datei **IdentityModels.cs** für das Projekt, das sich im Verzeichnis **Models** befindet, und ersetzen Sie den Inhalt durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="e55a9-188">Open the **IdentityModels.cs** file for your project, which is located in the **Models** directory, and replace it's contents with the following:</span></span>

    [!code-csharp[Main](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/samples/sample7.cs)]

## <a name="running-the-application-and-verifying-the-database"></a><span data-ttu-id="e55a9-189">Ausführen der Anwendung und Überprüfen der Datenbank</span><span class="sxs-lookup"><span data-stu-id="e55a9-189">Running the application and verifying the database</span></span>

<span data-ttu-id="e55a9-190">Nachdem Sie die Schritte in den vorherigen Abschnitten ausgeführt haben, sollten Sie Ihre Datenbank testen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-190">Once you have completed the steps in the preceding sections, you should test your database.</span></span> <span data-ttu-id="e55a9-191">Führen Sie dazu die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="e55a9-191">To do so, use the following steps:</span></span>

1. <span data-ttu-id="e55a9-192">Drücken Sie **STRG + F5** , um die Webanwendung zu erstellen und auszuführen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-192">Press **Ctrl + F5** to build and run the web application.</span></span>
2. <span data-ttu-id="e55a9-193">Klicken Sie oben auf der Seite auf die Registerkarte **registrieren** :</span><span class="sxs-lookup"><span data-stu-id="e55a9-193">Click the **Register** tab on the top of the page:</span></span>

   <span data-ttu-id="e55a9-194">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-194">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-195">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="e55a9-195">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image4.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image3.jpg)</span></span>
3. <span data-ttu-id="e55a9-196">Geben Sie einen neuen Benutzernamen und ein Kennwort ein, und klicken Sie dann auf **registrieren**:</span><span class="sxs-lookup"><span data-stu-id="e55a9-196">Enter a new user name and password, and then click **Register**:</span></span>

   <span data-ttu-id="e55a9-197">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-197">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-198">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image24.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-198">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image24.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image23.png)</span></span>
4. <span data-ttu-id="e55a9-199">An diesem Punkt werden die ASP.net Identity Tabellen in der MySQL-Datenbank erstellt, und der Benutzer wird registriert und bei der Anwendung angemeldet:</span><span class="sxs-lookup"><span data-stu-id="e55a9-199">At this point the ASP.NET Identity tables are created on the MySQL Database, and the user is registered and logged into the application:</span></span>

   <span data-ttu-id="e55a9-200">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-200">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-201">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.jpg)</span><span class="sxs-lookup"><span data-stu-id="e55a9-201">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image6.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image5.jpg)</span></span>

### <a name="installing-mysql-workbench-tool-to-verify-the-data"></a><span data-ttu-id="e55a9-202">Installieren des MySQL Workbench-Tools zum Überprüfen der Daten</span><span class="sxs-lookup"><span data-stu-id="e55a9-202">Installing MySQL Workbench tool to verify the data</span></span>

1. <span data-ttu-id="e55a9-203">Installieren Sie das **MySQL Workbench** -Tool auf der [MySQL-Downloadseite](http://dev.mysql.com/downloads/windows/installer/) .</span><span class="sxs-lookup"><span data-stu-id="e55a9-203">Install the **MySQL Workbench** tool from the [MySQL downloads page](http://dev.mysql.com/downloads/windows/installer/)</span></span>
2. <span data-ttu-id="e55a9-204">Wählen Sie im Installations-Assistenten für die Registerkarte **Funktionsauswahl** unter **Anwendungs** Abschnitt die Option **MySQL Workbench** aus.</span><span class="sxs-lookup"><span data-stu-id="e55a9-204">In the installation wizard: **Feature Selection** tab, select **MySQL Workbench** under **applications** section.</span></span>
3. <span data-ttu-id="e55a9-205">Starten Sie die APP, und fügen Sie eine neue Verbindung mit den Verbindungs Zeichenfolgen-Daten aus der Azure MySQL-Datenbank hinzu, die Sie beim betteln dieses Tutorials erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="e55a9-205">Launch the app and add a new connection using the connection string data from the Azure MySQL database you created at the begging of this tutorial.</span></span>
4. <span data-ttu-id="e55a9-206">Überprüfen Sie nach dem Herstellen der Verbindung die **ASP.net Identity** Tabellen, die für die **identitymysqldatabase** erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="e55a9-206">After establishing the connection, inspect the **ASP.NET Identity** tables created on the **IdentityMySQLDatabase.**</span></span>
5. <span data-ttu-id="e55a9-207">Sie werden feststellen, dass alle ASP.net Identity erforderlichen Tabellen erstellt werden, wie in der folgenden Abbildung dargestellt:</span><span class="sxs-lookup"><span data-stu-id="e55a9-207">You will see that all ASP.NET Identity required tables are created as shown in the image below:</span></span>

   <span data-ttu-id="e55a9-208">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-208">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-209">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="e55a9-209">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image8.jpg)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image7.jpg)</span></span>
6. <span data-ttu-id="e55a9-210">Überprüfen Sie die **aspnettusers** -Tabelle auf die Instanz, um die Einträge beim Registrieren neuer Benutzer zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="e55a9-210">Inspect the **aspnetusers** table for instance to check for the entries as you register new users.</span></span>

   <span data-ttu-id="e55a9-211">[Klicken Sie auf die folgende Abbildung, um Sie zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="e55a9-211">[Click the following image to expand it.</span></span> <span data-ttu-id="e55a9-212">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image26.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="e55a9-212">] [![](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image26.png)](aspnet-identity-using-mysql-storage-with-an-entityframework-mysql-provider/_static/image25.png)</span></span>
