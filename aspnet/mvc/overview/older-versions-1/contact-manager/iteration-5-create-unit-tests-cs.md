---
uid: mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
title: 'Iterations #5 – Erstellen von KomponententestsC#() | Microsoft-Dokumentation'
author: microsoft
description: In der fünften Iterationen wird die Wartung und Änderung unserer Anwendung durch Hinzufügen von Komponententests vereinfacht. Wir simulieren unsere Datenmodell Klassen und erstellen Komponententests für o...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 28ad8f80-b8a5-444e-b478-8b15a846060c
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-5-create-unit-tests-cs
msc.type: authoredcontent
ms.openlocfilehash: 32e81cce34a0e0b1f6b01934334e1b66dce89651
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78437841"
---
# <a name="iteration-5--create-unit-tests-c"></a><span data-ttu-id="abda4-104">Iterations #5 – Erstellen von KomponententestsC#()</span><span class="sxs-lookup"><span data-stu-id="abda4-104">Iteration #5 – Create unit tests (C#)</span></span>

<span data-ttu-id="abda4-105">von [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="abda4-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="abda4-106">Code herunterladen</span><span class="sxs-lookup"><span data-stu-id="abda4-106">Download Code</span></span>](iteration-5-create-unit-tests-cs/_static/contactmanager_5_cs1.zip)

> <span data-ttu-id="abda4-107">In der fünften Iterationen wird die Wartung und Änderung unserer Anwendung durch Hinzufügen von Komponententests vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="abda4-107">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="abda4-108">Wir simulieren unsere Datenmodell Klassen und erstellen Komponententests für unsere Controller und Validierungs Logik.</span><span class="sxs-lookup"><span data-stu-id="abda4-108">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="abda4-109">Aufbauen einer Kontakt Verwaltung ASP.NET MVC-AnwendungC#()</span><span class="sxs-lookup"><span data-stu-id="abda4-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="abda4-110">In dieser Reihe von Tutorials erstellen wir von Anfang bis Ende eine gesamte Kontakt Verwaltungs Anwendung.</span><span class="sxs-lookup"><span data-stu-id="abda4-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="abda4-111">Mithilfe der Kontakt-Manager-Anwendung können Sie Kontaktinformationen (Namen, Telefonnummern und e-Mail-Adressen) für eine Liste von Personen speichern.</span><span class="sxs-lookup"><span data-stu-id="abda4-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="abda4-112">Die Anwendung wird über mehrere Iterationen erstellt.</span><span class="sxs-lookup"><span data-stu-id="abda4-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="abda4-113">Bei jeder Iterationen verbessern wir die Anwendung allmählich.</span><span class="sxs-lookup"><span data-stu-id="abda4-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="abda4-114">Das Ziel dieses mehrfaches Iterations Ansatzes besteht darin, Ihnen zu ermöglichen, den Grund für jede Änderung zu verstehen.</span><span class="sxs-lookup"><span data-stu-id="abda4-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="abda4-115">Iterations #1: Erstellen Sie die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="abda4-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="abda4-116">In der ersten Iterationen erstellen wir den Kontakt-Manager auf einfachste Art und Weise.</span><span class="sxs-lookup"><span data-stu-id="abda4-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="abda4-117">Wir fügen Unterstützung für grundlegende Daten Bank Vorgänge hinzu: Create, Read, Update und DELETE (CRUD).</span><span class="sxs-lookup"><span data-stu-id="abda4-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="abda4-118">Iterations #2: machen Sie das Aussehen der Anwendung schön.</span><span class="sxs-lookup"><span data-stu-id="abda4-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="abda4-119">In dieser Iterationen verbessern wir die Darstellung der Anwendung durch Ändern der standardmäßigen ASP.NET-MVC-Ansichts Master Seite und des Cascading Stylesheets.</span><span class="sxs-lookup"><span data-stu-id="abda4-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="abda4-120">Iterations #3: Formular Validierung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="abda4-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="abda4-121">In der dritten Iterationen fügen wir die grundlegende Formular Validierung hinzu.</span><span class="sxs-lookup"><span data-stu-id="abda4-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="abda4-122">Wir hindern Personen daran, ein Formular zu senden, ohne die erforderlichen Formularfelder abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="abda4-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="abda4-123">Wir überprüfen auch die e-Mail-Adressen und Telefonnummern.</span><span class="sxs-lookup"><span data-stu-id="abda4-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="abda4-124">Iterations #4: Legen Sie die Anwendung lose gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="abda4-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="abda4-125">In dieser vierten Iterationen nutzen wir mehrere Software Entwurfsmuster, um die Verwaltung und Änderung der Contact Manager-Anwendung zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="abda4-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="abda4-126">Beispielsweise können wir unsere Anwendung so umgestalten, dass Sie das Repository-Muster und das Muster für die Abhängigkeitsinjektion verwendet.</span><span class="sxs-lookup"><span data-stu-id="abda4-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="abda4-127">Iterations #5: Erstellen von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="abda4-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="abda4-128">In der fünften Iterationen wird die Wartung und Änderung unserer Anwendung durch Hinzufügen von Komponententests vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="abda4-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="abda4-129">Wir simulieren unsere Datenmodell Klassen und erstellen Komponententests für unsere Controller und Validierungs Logik.</span><span class="sxs-lookup"><span data-stu-id="abda4-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="abda4-130">Iterations #6: Verwenden Sie die Test gesteuerte Entwicklung.</span><span class="sxs-lookup"><span data-stu-id="abda4-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="abda4-131">In dieser sechsten Iterationen fügen wir der Anwendung neue Funktionen hinzu, indem wir zuerst Komponententests schreiben und Code für die Komponententests schreiben.</span><span class="sxs-lookup"><span data-stu-id="abda4-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="abda4-132">In dieser Iterationen fügen wir Kontaktgruppen hinzu.</span><span class="sxs-lookup"><span data-stu-id="abda4-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="abda4-133">Iterations #7: Hinzufügen von AJAX-Funktionen.</span><span class="sxs-lookup"><span data-stu-id="abda4-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="abda4-134">In der siebten Iterationen verbessern wir die Reaktionsfähigkeit und Leistung unserer Anwendung durch Hinzufügen von Unterstützung für AJAX.</span><span class="sxs-lookup"><span data-stu-id="abda4-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="abda4-135">Diese Iterations</span><span class="sxs-lookup"><span data-stu-id="abda4-135">This Iteration</span></span>

<span data-ttu-id="abda4-136">In der vorherigen Iterationen der Kontakt-Manager-Anwendung haben wir die Anwendung so umgestaltet, dass Sie lockerer gekoppelt ist.</span><span class="sxs-lookup"><span data-stu-id="abda4-136">In the previous iteration of the Contact Manager application, we refactored the application to be more loosely coupled.</span></span> <span data-ttu-id="abda4-137">Die Anwendung wurde in verschiedene Controller-, Dienst-und Repository-Schichten aufgeteilt.</span><span class="sxs-lookup"><span data-stu-id="abda4-137">We separated the application into distinct controller, service, and repository layers.</span></span> <span data-ttu-id="abda4-138">Jede Ebene interagiert mit der darunter liegenden Ebene über Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="abda4-138">Each layer interacts with the layer beneath it through interfaces.</span></span>

<span data-ttu-id="abda4-139">Wir haben die Anwendung umgestaltet, um die Wartung und Änderung der Anwendung zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="abda4-139">We refactored the application to make the application easier to maintain and modify.</span></span> <span data-ttu-id="abda4-140">Wenn wir z. b. eine neue Datenzugriffs Technologie verwenden müssen, können wir einfach die Repository-Ebene ändern, ohne den Controller oder die Dienst Schicht zu berühren.</span><span class="sxs-lookup"><span data-stu-id="abda4-140">For example, if we need to use a new data access technology, we can simply change the repository layer without touching the controller or service layer.</span></span> <span data-ttu-id="abda4-141">Indem der Kontakt-Manager locker gekoppelt wird, haben wir die Anwendung stabiler geändert, damit Sie geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="abda4-141">By making the Contact Manager loosely coupled, we ve made the application more resilient to change.</span></span>

<span data-ttu-id="abda4-142">Was passiert jedoch, wenn wir der Kontakt-Manager-Anwendung ein neues Feature hinzufügen müssen?</span><span class="sxs-lookup"><span data-stu-id="abda4-142">But, what happens when we need to add a new feature to the Contact Manager application?</span></span> <span data-ttu-id="abda4-143">Oder was geschieht, wenn ein Fehler behoben wird?</span><span class="sxs-lookup"><span data-stu-id="abda4-143">Or, what happens when we fix a bug?</span></span> <span data-ttu-id="abda4-144">Eine traurige, aber bewährte Tatsache, dass Sie Code schreiben, besteht darin, dass Sie immer dann, wenn Sie Code berühren, das Risiko einer Einführung neuer Fehler erzeugen.</span><span class="sxs-lookup"><span data-stu-id="abda4-144">A sad, but well proven, truth of writing code is that whenever you touch code you create the risk of introducing new bugs.</span></span>

<span data-ttu-id="abda4-145">Beispielsweise kann Ihr Manager einen guten Tag zum Hinzufügen eines neuen Features zum Contact Manager auffordern.</span><span class="sxs-lookup"><span data-stu-id="abda4-145">For example, one fine day, your manager might ask you to add a new feature to the Contact Manager.</span></span> <span data-ttu-id="abda4-146">Sie möchte Unterstützung für Kontaktgruppen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="abda4-146">She wants you to add support for Contact Groups.</span></span> <span data-ttu-id="abda4-147">Sie möchte, dass Benutzer Ihre Kontakte in Gruppen wie Friends, Business usw. organisieren können.</span><span class="sxs-lookup"><span data-stu-id="abda4-147">She wants you to enable users to organize their contacts into groups such as Friends, Business, and so on.</span></span>

<span data-ttu-id="abda4-148">Um diese neue Funktion zu implementieren, müssen Sie alle drei Ebenen der Contact Manager-Anwendung ändern.</span><span class="sxs-lookup"><span data-stu-id="abda4-148">In order to implement this new feature, you'll need to modify all three layers of the Contact Manager application.</span></span> <span data-ttu-id="abda4-149">Sie müssen den Controllern, der Dienst Ebene und dem Repository neue Funktionen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="abda4-149">You'll need to add new functionality to the controllers, the service layer, and the repository.</span></span> <span data-ttu-id="abda4-150">Sobald Sie mit dem Ändern von Code beginnen, riskieren Sie die Funktionen, die zuvor funktionieren.</span><span class="sxs-lookup"><span data-stu-id="abda4-150">As soon as you start modifying code, you risk breaking functionality that worked before.</span></span>

<span data-ttu-id="abda4-151">Das Umgestalten der Anwendung in separate Ebenen, wie dies in der vorherigen Iterationen der Fall war, war eine gute Sache.</span><span class="sxs-lookup"><span data-stu-id="abda4-151">Refactoring our application into separate layers, as we did in the previous iteration, was a good thing.</span></span> <span data-ttu-id="abda4-152">Dies war eine gute Sache, da es uns ermöglicht, Änderungen an ganzen Ebenen vorzunehmen, ohne den Rest der Anwendung zu berühren.</span><span class="sxs-lookup"><span data-stu-id="abda4-152">It was a good thing because it enables us to make changes to entire layers without touching the rest of the application.</span></span> <span data-ttu-id="abda4-153">Wenn Sie jedoch den Code in einer Ebene leichter verwalten und ändern möchten, müssen Sie Komponententests für den Code erstellen.</span><span class="sxs-lookup"><span data-stu-id="abda4-153">However, if you want to make the code within a layer easier to maintain and modify, you need to create unit tests for the code.</span></span>

<span data-ttu-id="abda4-154">Sie verwenden einen-Komponenten Test, um eine einzelne Code Einheit zu testen.</span><span class="sxs-lookup"><span data-stu-id="abda4-154">You use a unit test to test an individual unit of code.</span></span> <span data-ttu-id="abda4-155">Diese Code Einheiten sind kleiner als ganze Anwendungsebenen.</span><span class="sxs-lookup"><span data-stu-id="abda4-155">These units of code are smaller than entire application layers.</span></span> <span data-ttu-id="abda4-156">In der Regel verwenden Sie einen Komponenten Test, um zu überprüfen, ob eine bestimmte Methode im Code erwartungsgemäß verhält.</span><span class="sxs-lookup"><span data-stu-id="abda4-156">Typically, you use a unit test to verify whether a particular method in your code behaves in the way that you expect.</span></span> <span data-ttu-id="abda4-157">Beispielsweise erstellen Sie einen Komponenten Test für die Methode "Methode", die von der contactmanagerservice-Klasse verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-157">For example, you would create a unit test for the CreateContact() method exposed by the ContactManagerService class.</span></span>

<span data-ttu-id="abda4-158">Die Komponententests für eine Anwendung funktionieren genau wie ein Sicherheitsnetz.</span><span class="sxs-lookup"><span data-stu-id="abda4-158">The unit tests for an application work just like a safety net.</span></span> <span data-ttu-id="abda4-159">Wenn Sie Code in einer Anwendung ändern, können Sie eine Reihe von Komponententests ausführen, um zu überprüfen, ob die Änderung vorhandene Funktionalität unterbricht.</span><span class="sxs-lookup"><span data-stu-id="abda4-159">Whenever you modify code in an application, you can run a set of unit tests to check whether the modification breaks existing functionality.</span></span> <span data-ttu-id="abda4-160">Mit Komponententests können Sie den Code sicher ändern.</span><span class="sxs-lookup"><span data-stu-id="abda4-160">Unit tests make your code safe to modify.</span></span> <span data-ttu-id="abda4-161">Mit Komponententests können Sie den gesamten Code in der Anwendung stabiler ändern.</span><span class="sxs-lookup"><span data-stu-id="abda4-161">Unit tests make all of the code in your application more resilient to change.</span></span>

<span data-ttu-id="abda4-162">In dieser Iterations Komponente fügen wir unserer Contact Manager-Anwendung Komponententests hinzu.</span><span class="sxs-lookup"><span data-stu-id="abda4-162">In this iteration, we add unit tests to our Contact Manager application.</span></span> <span data-ttu-id="abda4-163">Auf diese Weise können wir in der nächsten Iterationen der Anwendung Kontaktgruppen hinzufügen, ohne sich Gedanken über das Abbrechen vorhandener Funktionen machen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="abda4-163">That way, in the next iteration, we can add Contact Groups to our application without worrying about breaking existing functionality.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="abda4-164">Es gibt eine Vielzahl von Frameworks für Unittests, einschließlich nunit, xUnit.net und MbUnit.</span><span class="sxs-lookup"><span data-stu-id="abda4-164">There are a variety of unit testing frameworks including NUnit, xUnit.net, and MbUnit.</span></span> <span data-ttu-id="abda4-165">In diesem Tutorial verwenden wir das Komponenten Test-Framework, das in Visual Studio enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="abda4-165">In this tutorial, we use the unit testing framework included with Visual Studio.</span></span> <span data-ttu-id="abda4-166">Sie könnten jedoch auch eines dieser alternativen Frameworks verwenden.</span><span class="sxs-lookup"><span data-stu-id="abda4-166">However, you could just as easily use one of these alternative frameworks.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="abda4-167">Was wird getestet?</span><span class="sxs-lookup"><span data-stu-id="abda4-167">What Gets Tested</span></span>

<span data-ttu-id="abda4-168">In der perfekten Welt würde der gesamte Code durch Komponententests abgedeckt werden.</span><span class="sxs-lookup"><span data-stu-id="abda4-168">In the perfect world, all of your code would be covered by unit tests.</span></span> <span data-ttu-id="abda4-169">In der perfekten Welt hätten Sie das perfekte Sicherheitsnetz.</span><span class="sxs-lookup"><span data-stu-id="abda4-169">In the perfect world, you would have the perfect safety net.</span></span> <span data-ttu-id="abda4-170">Sie können jede Codezeile in Ihrer Anwendung ändern und sofort wissen, indem Sie die Komponententests ausführen, und zwar unabhängig davon, ob die Änderung die vorhandene Funktionalität abgebrochen hat.</span><span class="sxs-lookup"><span data-stu-id="abda4-170">You would be able to modify any line of code in your application and know instantly, by executing your unit tests, whether the change broke existing functionality.</span></span>

<span data-ttu-id="abda4-171">Wir leben jedoch nicht in einer idealen Welt.</span><span class="sxs-lookup"><span data-stu-id="abda4-171">However, we don t live in a perfect world.</span></span> <span data-ttu-id="abda4-172">In der Praxis konzentrieren Sie sich beim Schreiben von Komponententests auf das Schreiben von Tests für Ihre Geschäftslogik (z. b. Validierungs Logik).</span><span class="sxs-lookup"><span data-stu-id="abda4-172">In practice, when writing unit tests, you concentrate on writing tests for your business logic (for example, validation logic).</span></span> <span data-ttu-id="abda4-173">Insbesondere schreiben Sie *keine* Komponententests für Ihre Datenzugriffs Logik oder Ihre Ansichts Logik.</span><span class="sxs-lookup"><span data-stu-id="abda4-173">In particular, you *do not* write unit tests for your data access logic or your view logic.</span></span>

<span data-ttu-id="abda4-174">Um nützlich zu sein, müssen Komponententests sehr schnell ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="abda4-174">To be useful, unit tests must execute very quickly.</span></span> <span data-ttu-id="abda4-175">Sie können mühelos Hunderte (oder sogar Tausende) von Komponententests für eine Anwendung sammeln.</span><span class="sxs-lookup"><span data-stu-id="abda4-175">You easily can accumulate hundreds (or even thousands) of unit tests for an application.</span></span> <span data-ttu-id="abda4-176">Wenn die Ausführung der Komponententests viel Zeit in Anspruch nimmt, wird die Ausführung vermieden.</span><span class="sxs-lookup"><span data-stu-id="abda4-176">If the unit tests take a long time to run then you'll avoid executing them.</span></span> <span data-ttu-id="abda4-177">Mit anderen Worten, die Komponententests mit langer Ausführungszeit sind für tägliche Codierungs Zwecke unbrauchbar.</span><span class="sxs-lookup"><span data-stu-id="abda4-177">In other words, long running unit tests are useless for day to day coding purposes.</span></span>

<span data-ttu-id="abda4-178">Aus diesem Grund schreiben Sie in der Regel keine Komponententests für Code, der mit einer-Datenbank interagiert.</span><span class="sxs-lookup"><span data-stu-id="abda4-178">For this reason, you typically do not write unit tests for code that interacts with a database.</span></span> <span data-ttu-id="abda4-179">Das Ausführen von Hunderten von Komponententests für eine Live Datenbank wäre zu langsam.</span><span class="sxs-lookup"><span data-stu-id="abda4-179">Running hundreds of unit tests against a live database would be too slow.</span></span> <span data-ttu-id="abda4-180">Stattdessen können Sie Ihre Datenbank simulieren und Code schreiben, der mit der Mock-Datenbank interagiert (es wird beschrieben, wie Sie eine Datenbank weiter unten durcharbeiten).</span><span class="sxs-lookup"><span data-stu-id="abda4-180">Instead, you mock your database and write code that interacts with the mock database (we discuss mocking a database below).</span></span>

<span data-ttu-id="abda4-181">Aus einem ähnlichen Grund schreiben Sie in der Regel keine Komponententests für Sichten.</span><span class="sxs-lookup"><span data-stu-id="abda4-181">For a similar reason, you typically do not write unit tests for views.</span></span> <span data-ttu-id="abda4-182">Um eine Ansicht zu testen, müssen Sie einen Webserver einrichten.</span><span class="sxs-lookup"><span data-stu-id="abda4-182">In order to test a view, you must spin up a web server.</span></span> <span data-ttu-id="abda4-183">Da das Einrichten eines Webservers ein relativ langsamer Prozess ist, wird das Erstellen von Komponententests für Ihre Sichten nicht empfohlen.</span><span class="sxs-lookup"><span data-stu-id="abda4-183">Because spinning up a web server is a relatively slow process, creating unit tests for your views is not recommended.</span></span>

<span data-ttu-id="abda4-184">Wenn Ihre Ansicht komplizierte Logik enthält, sollten Sie erwägen, die Logik in Hilfsmethoden zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="abda4-184">If your view contains complicated logic then you should consider moving the logic into Helper methods.</span></span> <span data-ttu-id="abda4-185">Sie können Komponententests für Hilfsmethoden schreiben, die ausgeführt werden, ohne einen Webserver aufzugliederung.</span><span class="sxs-lookup"><span data-stu-id="abda4-185">You can write unit tests for Helper methods that execute without spinning up a web server.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="abda4-186">Obwohl das Schreiben von Tests für die Datenzugriffs Logik oder die Sicht Logik beim Schreiben von Komponententests keine gute Idee ist, können diese Tests bei der Erstellung funktionaler oder Integrationstests sehr wertvoll sein.</span><span class="sxs-lookup"><span data-stu-id="abda4-186">While writing tests for data access logic or view logic is not a good idea when writing unit tests, these tests can be very valuable when building functional or integration tests.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="abda4-187">ASP.NET MVC ist die Web Forms Ansichts-Engine.</span><span class="sxs-lookup"><span data-stu-id="abda4-187">ASP.NET MVC is the Web Forms View Engine.</span></span> <span data-ttu-id="abda4-188">Während das Web Forms Ansichts Modul von einem Webserver abhängt, sind andere Ansichts-Engines möglicherweise nicht.</span><span class="sxs-lookup"><span data-stu-id="abda4-188">While the Web Forms View Engine is dependent on a web server, other view engines might not be.</span></span>

## <a name="using-a-mock-object-framework"></a><span data-ttu-id="abda4-189">Verwenden eines Mock-Objekt-Frameworks</span><span class="sxs-lookup"><span data-stu-id="abda4-189">Using a Mock Object Framework</span></span>

<span data-ttu-id="abda4-190">Beim Erstellen von Komponententests müssen Sie fast immer ein Mock-Objekt Framework nutzen.</span><span class="sxs-lookup"><span data-stu-id="abda4-190">When building unit tests, you almost always need to take advantage of a Mock Object framework.</span></span> <span data-ttu-id="abda4-191">Mit einem Mock-Objekt Framework können Sie Mock und stubweise für die Klassen in der Anwendung erstellen.</span><span class="sxs-lookup"><span data-stu-id="abda4-191">A Mock Object framework enables you to create mocks and stubs for the classes in your application.</span></span>

<span data-ttu-id="abda4-192">Beispielsweise können Sie ein Mock-Objekt Framework verwenden, um eine Pseudo Version der Repository-Klasse zu generieren.</span><span class="sxs-lookup"><span data-stu-id="abda4-192">For example, you can use a Mock Object framework to generate a mock version of your repository class.</span></span> <span data-ttu-id="abda4-193">Auf diese Weise können Sie die mockrepository-Klasse anstelle der realen Repository-Klasse in ihren Komponententests verwenden.</span><span class="sxs-lookup"><span data-stu-id="abda4-193">That way, you can use the mock repository class instead of the real repository class in your unit tests.</span></span> <span data-ttu-id="abda4-194">Mithilfe des mockrepository können Sie beim Ausführen eines Komponententests vermeiden, Datenbankcode auszuführen.</span><span class="sxs-lookup"><span data-stu-id="abda4-194">Using the mock repository enables you to avoid executing database code when executing a unit test.</span></span>

<span data-ttu-id="abda4-195">Visual Studio enthält kein Mock-Objekt Framework.</span><span class="sxs-lookup"><span data-stu-id="abda4-195">Visual Studio does not include a Mock Object framework.</span></span> <span data-ttu-id="abda4-196">Es gibt jedoch mehrere kommerzielle und Open Source-Pseudo Objekt-Frameworks, die für .NET Framework verfügbar sind:</span><span class="sxs-lookup"><span data-stu-id="abda4-196">However, there are several commercial and open source Mock Object frameworks available for the .NET framework:</span></span>

1. <span data-ttu-id="abda4-197">Muq: Dieses Framework ist unter der Open Source-BSD-Lizenz verfügbar.</span><span class="sxs-lookup"><span data-stu-id="abda4-197">Moq - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="abda4-198">Sie können "muq" aus [https://code.google.com/p/moq/](https://code.google.com/p/moq/)herunterladen.</span><span class="sxs-lookup"><span data-stu-id="abda4-198">You can download Moq from [https://code.google.com/p/moq/](https://code.google.com/p/moq/).</span></span>
2. <span data-ttu-id="abda4-199">Rhino-Mock: Dieses Framework ist unter der Open Source-BSD-Lizenz verfügbar.</span><span class="sxs-lookup"><span data-stu-id="abda4-199">Rhino Mocks - This framework is available under the open source BSD license.</span></span> <span data-ttu-id="abda4-200">Sie können Rhino-Mock aus [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx)herunterladen.</span><span class="sxs-lookup"><span data-stu-id="abda4-200">You can download Rhino Mocks from [http://ayende.com/projects/rhino-mocks.aspx](http://ayende.com/projects/rhino-mocks.aspx).</span></span>
3. <span data-ttu-id="abda4-201">Typemockisolator: Dies ist ein kommerzielles Framework.</span><span class="sxs-lookup"><span data-stu-id="abda4-201">Typemock Isolator - This is a commercial framework.</span></span> <span data-ttu-id="abda4-202">Sie können eine Testversion von [http://www.typemock.com/](http://www.typemock.com/)herunterladen.</span><span class="sxs-lookup"><span data-stu-id="abda4-202">You can download a trial version from [http://www.typemock.com/](http://www.typemock.com/).</span></span>

<span data-ttu-id="abda4-203">In diesem Tutorial entschied ich mich für die Verwendung von "muq".</span><span class="sxs-lookup"><span data-stu-id="abda4-203">In this tutorial, I decided to use Moq.</span></span> <span data-ttu-id="abda4-204">Allerdings können Sie mit Rhino-Mock oder typemockisolator die Mockobjekte für die Contact Manager-Anwendung erstellen.</span><span class="sxs-lookup"><span data-stu-id="abda4-204">However, you could just as easily use Rhino Mocks or Typemock Isolator to create the Mock objects for the Contact Manager application.</span></span>

<span data-ttu-id="abda4-205">Bevor Sie die Verwendung von "muq" durchführen können, müssen Sie die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="abda4-205">Before you can use Moq, you need to complete the following steps:</span></span>

1. <span data-ttu-id="abda4-206">erforderlich.</span><span class="sxs-lookup"><span data-stu-id="abda4-206">.</span></span>
2. <span data-ttu-id="abda4-207">Stellen Sie vor dem Entzippen des Downloads sicher, dass Sie mit der rechten Maustaste auf die Datei klicken, und klicken Sie auf die Schaltfläche **Unblock** (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="abda4-207">Before you unzip the download, make sure that you right-click the file and click the button labeled **Unblock** (see Figure 1).</span></span>
3. <span data-ttu-id="abda4-208">Entpacken Sie den Download.</span><span class="sxs-lookup"><span data-stu-id="abda4-208">Unzip the download.</span></span>
4. <span data-ttu-id="abda4-209">Fügen Sie einen Verweis auf die-Assembly hinzu, indem Sie mit der rechten Maustaste auf den Ordner Verweise im Projekt ContactManager. Tests klicken und **Verweis hinzufügen**auswählen.</span><span class="sxs-lookup"><span data-stu-id="abda4-209">Add a reference to the Moq assembly by right-clicking the References folder in the ContactManager.Tests project and selecting **Add Reference**.</span></span> <span data-ttu-id="abda4-210">Navigieren Sie auf der Registerkarte durchsuchen zu dem Ordner, in dem Sie die Datei ". dll" entzippt haben, und wählen Sie die Assembly ".</span><span class="sxs-lookup"><span data-stu-id="abda4-210">Under the Browse tab, browse to the folder where you unzipped Moq and select the Moq.dll assembly.</span></span> <span data-ttu-id="abda4-211">Klicken Sie auf die Schaltfläche **OK** .</span><span class="sxs-lookup"><span data-stu-id="abda4-211">Click the **OK** button.</span></span>
5. <span data-ttu-id="abda4-212">Nachdem Sie diese Schritte ausgeführt haben, sollte der Ordner Verweise wie in Abbildung 2 aussehen.</span><span class="sxs-lookup"><span data-stu-id="abda4-212">After you complete these steps, your References folder should look like Figure 2.</span></span>

<span data-ttu-id="abda4-213">[Aufheben der Blockierung von muq ![](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="abda4-213">[![Unblocking Moq](iteration-5-create-unit-tests-cs/_static/image1.jpg)](iteration-5-create-unit-tests-cs/_static/image1.png)</span></span>

<span data-ttu-id="abda4-214">**Abbildung 01**: Aufheben der Blockierung von muq ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-5-create-unit-tests-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="abda4-214">**Figure 01**: Unblocking Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image2.png))</span></span>

<span data-ttu-id="abda4-215">[Verweise ![nach dem Hinzufügen von muq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="abda4-215">[![References after adding Moq](iteration-5-create-unit-tests-cs/_static/image2.jpg)](iteration-5-create-unit-tests-cs/_static/image3.png)</span></span>

<span data-ttu-id="abda4-216">**Abbildung 02**: Verweise nach dem Hinzufügen von muq ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-5-create-unit-tests-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="abda4-216">**Figure 02**: References after adding Moq([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image4.png))</span></span>

## <a name="creating-unit-tests-for-the-service-layer"></a><span data-ttu-id="abda4-217">Erstellen von Komponenten Tests für die Dienst Ebene</span><span class="sxs-lookup"><span data-stu-id="abda4-217">Creating Unit Tests for the Service Layer</span></span>

<span data-ttu-id="abda4-218">Beginnen Sie, indem Sie eine Reihe von Komponententests für die Dienst Ebene der Kontakt-Manager-Anwendung erstellen.</span><span class="sxs-lookup"><span data-stu-id="abda4-218">Let s start by creating a set of unit tests for our Contact Manager application s service layer.</span></span> <span data-ttu-id="abda4-219">Wir verwenden diese Tests, um unsere Validierungs Logik zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="abda4-219">We'll use these tests to verify our validation logic.</span></span>

<span data-ttu-id="abda4-220">Erstellen Sie im Projekt "ContactManager. Tests" einen neuen Ordner mit dem Namen "Models".</span><span class="sxs-lookup"><span data-stu-id="abda4-220">Create a new folder named Models in the ContactManager.Tests project.</span></span> <span data-ttu-id="abda4-221">Klicken Sie dann mit der rechten Maustaste auf den Ordner Modelle, und wählen Sie **hinzufügen, neuer Test**aus.</span><span class="sxs-lookup"><span data-stu-id="abda4-221">Next, right-click the Models folder and select **Add, New Test**.</span></span> <span data-ttu-id="abda4-222">Das in Abbildung 3 dargestellte Dialogfeld **neuen Test hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="abda4-222">The **Add New Test** dialog shown in Figure 3 appears.</span></span> <span data-ttu-id="abda4-223">Wählen Sie die Vorlage Komponenten **Test** aus, und benennen Sie den neuen Test ContactManagerServiceTest.cs.</span><span class="sxs-lookup"><span data-stu-id="abda4-223">Select the **Unit Test** template and name your new test ContactManagerServiceTest.cs.</span></span> <span data-ttu-id="abda4-224">Klicken Sie auf die Schaltfläche **OK** , um den neuen Test dem Testprojekt hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="abda4-224">Click the **OK** button to add your new test to your Test Project.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="abda4-225">Im Allgemeinen möchten Sie, dass die Ordnerstruktur des Test Projekts der Ordnerstruktur Ihres ASP.NET MVC-Projekts entspricht.</span><span class="sxs-lookup"><span data-stu-id="abda4-225">In general, you want the folder structure of your Test Project to match the folder structure of your ASP.NET MVC project.</span></span> <span data-ttu-id="abda4-226">Beispielsweise platzieren Sie Controller Tests in einem Controller Ordner, modellieren Tests in einem Modell Ordner usw.</span><span class="sxs-lookup"><span data-stu-id="abda4-226">For example, you place controller tests in a Controllers folder, model tests in a Models folder, and so on.</span></span>

<span data-ttu-id="abda4-227">[![models\contactmanagerservicetest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="abda4-227">[![Models\ContactManagerServiceTest.cs](iteration-5-create-unit-tests-cs/_static/image3.jpg)](iteration-5-create-unit-tests-cs/_static/image5.png)</span></span>

<span data-ttu-id="abda4-228">**Abbildung 03**: models\contactmanagerservicetest.cs ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-5-create-unit-tests-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="abda4-228">**Figure 03**: Models\ContactManagerServiceTest.cs([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image6.png))</span></span>

<span data-ttu-id="abda4-229">Zunächst möchten wir die Methode "Methode", die von der contactmanagerservice-Klasse verfügbar gemacht wird, testen.</span><span class="sxs-lookup"><span data-stu-id="abda4-229">Initially, we want to test the CreateContact() method exposed by the ContactManagerService class.</span></span> <span data-ttu-id="abda4-230">Wir erstellen die folgenden fünf Tests:</span><span class="sxs-lookup"><span data-stu-id="abda4-230">We'll create the following five tests:</span></span>

- <span data-ttu-id="abda4-231">"Kreatecontact ()": testet, ob "kreatecontact ()" den Wert "true" zurückgibt, wenn ein gültiger Kontakt an die Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-231">CreateContact() - Tests that CreateContact() returns the value true when a valid Contact is passed to the method.</span></span>
- <span data-ttu-id="abda4-232">"Kreatecontactrequiredfirstname ()": testet, ob dem Modell Status eine Fehlermeldung hinzugefügt wird, wenn ein Kontakt mit einem fehlenden Vornamen an die Methode "up contact ()" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-232">CreateContactRequiredFirstName() - Tests that an error message is added to model state when a Contact with a missing first name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="abda4-233">"Kreatecontactrequiredlastname ()": testet, ob eine Fehlermeldung zum Modell Status hinzugefügt wird, wenn ein Kontakt mit einem fehlenden Nachnamen an die Methode "up contact ()" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-233">CreateContactRequiredLastName() - Tests that an error message is added to model state when a Contact with a missing last name is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="abda4-234">"Kreatecontactinvalidphone ()": testet, ob dem Modell Status eine Fehlermeldung hinzugefügt wird, wenn ein Kontakt mit einer ungültigen Telefonnummer an die Methode "Methode" von "| atecontact ()" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-234">CreateContactInvalidPhone() - Tests that an error message is added to model state when a Contact with an invalid phone number is passed to the CreateContact() method.</span></span>
- <span data-ttu-id="abda4-235">"Kreatecontactinvalidemail ()": testet, ob dem Modell Status eine Fehlermeldung hinzugefügt wird, wenn ein Kontakt mit einer ungültigen e-Mail-Adresse an die Methode "Methode.</span><span class="sxs-lookup"><span data-stu-id="abda4-235">CreateContactInvalidEmail() - Tests that an error message is added to model state when a Contact with an invalid email address is passed to the CreateContact() method..</span></span>

<span data-ttu-id="abda4-236">Der erste Test überprüft, ob ein gültiger Kontakt keinen Validierungs Fehler generiert.</span><span class="sxs-lookup"><span data-stu-id="abda4-236">The first test verifies that a valid Contact does not generate a validation error.</span></span> <span data-ttu-id="abda4-237">Die verbleibenden Tests überprüfen jede der Validierungsregeln.</span><span class="sxs-lookup"><span data-stu-id="abda4-237">The remaining tests check each of the validation rules.</span></span>

<span data-ttu-id="abda4-238">Der Code für diese Tests ist in der Liste 1 enthalten.</span><span class="sxs-lookup"><span data-stu-id="abda4-238">The code for these tests is contained in Listing 1.</span></span>

<span data-ttu-id="abda4-239">**Codebeispiel 1: models\contactmanagerservicetest.cs**</span><span class="sxs-lookup"><span data-stu-id="abda4-239">**Listing 1 - Models\ContactManagerServiceTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample1.cs)]

<span data-ttu-id="abda4-240">Da wir die Contact-Klasse in der Liste 1 verwenden, müssen wir dem Test Projekt einen Verweis auf den Microsoft-Entity Framework hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="abda4-240">Because we use the Contact class in Listing 1, we need to add a reference to the Microsoft Entity Framework to our Test project.</span></span> <span data-ttu-id="abda4-241">Fügen Sie einen Verweis auf die System. Data. Entity-Assembly hinzu.</span><span class="sxs-lookup"><span data-stu-id="abda4-241">Add a reference to the System.Data.Entity assembly.</span></span>

<span data-ttu-id="abda4-242">In der Liste 1 ist eine Methode mit dem Namen Initialize () enthalten, die mit dem [TestInitialize]-Attribut ergänzt wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-242">Listing 1 contains a method named Initialize() that is decorated with the [TestInitialize] attribute.</span></span> <span data-ttu-id="abda4-243">Diese Methode wird automatisch vor jedem Ausführen der Komponententests aufgerufen (Sie wird fünf Mal direkt vor jedem der Komponententests aufgerufen).</span><span class="sxs-lookup"><span data-stu-id="abda4-243">This method is called automatically before each of the unit tests is run (it is called 5 times right before each of the unit tests).</span></span> <span data-ttu-id="abda4-244">Die Initialize ()-Methode erstellt ein Mock-Repository mit der folgenden Codezeile:</span><span class="sxs-lookup"><span data-stu-id="abda4-244">The Initialize() method creates a mock repository with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample2.cs)]

<span data-ttu-id="abda4-245">Diese Codezeile verwendet das MOQ-Framework, um ein mockrepository aus der icontactmanagerrepository-Schnittstelle zu generieren.</span><span class="sxs-lookup"><span data-stu-id="abda4-245">This line of code uses the Moq framework to generate a mock repository from the IContactManagerRepository interface.</span></span> <span data-ttu-id="abda4-246">Das mockrepository wird anstelle des eigentlichen entitycontactmanagerrepository verwendet, um den Zugriff auf die Datenbank zu vermeiden, wenn jeder Komponenten Test ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-246">The mock repository is used instead of the actual EntityContactManagerRepository to avoid accessing the database when each unit test is run.</span></span> <span data-ttu-id="abda4-247">Das Mock-Repository implementiert die Methoden der icontactmanagerrepository-Schnittstelle, aber die Methoden Don 't machen tatsächlich etwas.</span><span class="sxs-lookup"><span data-stu-id="abda4-247">The mock repository implements the methods of the IContactManagerRepository interface, but the methods don t actually do anything.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="abda4-248">Bei der Verwendung des muq-Frameworks wird zwischen \_mockrepository und \_mockrepository. Object unterschieden.</span><span class="sxs-lookup"><span data-stu-id="abda4-248">When using the Moq framework, there is a distinction between \_mockRepository and \_mockRepository.Object.</span></span> <span data-ttu-id="abda4-249">Der erste verweist auf das Mock&lt;icontactmanagerrepository&gt; Klasse, die Methoden zum Angeben des Verhaltens des Mock-Repository enthält.</span><span class="sxs-lookup"><span data-stu-id="abda4-249">The former refers to the Mock&lt;IContactManagerRepository&gt; class that contains methods for specifying how the mock repository will behave.</span></span> <span data-ttu-id="abda4-250">Letztere bezieht sich auf das eigentliche Mock-Repository, das die icontactmanagerrepository-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="abda4-250">The latter refers to the actual mock repository that implements the IContactManagerRepository interface.</span></span>

<span data-ttu-id="abda4-251">Das mockrepository wird in der Initialize ()-Methode verwendet, wenn eine Instanz der contactmanagerservice-Klasse erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-251">The mock repository is used in the Initialize() method when creating an instance of the ContactManagerService class.</span></span> <span data-ttu-id="abda4-252">Alle einzelnen Unittests verwenden diese Instanz der contactmanagerservice-Klasse.</span><span class="sxs-lookup"><span data-stu-id="abda4-252">All of the individual unit tests use this instance of the ContactManagerService class.</span></span>

<span data-ttu-id="abda4-253">In der Liste 1 sind fünf Methoden enthalten, die den einzelnen Komponententests entsprechen.</span><span class="sxs-lookup"><span data-stu-id="abda4-253">Listing 1 contains five methods that correspond to each of the unit tests.</span></span> <span data-ttu-id="abda4-254">Jede dieser Methoden wird mit dem [TestMethod]-Attribut versehen.</span><span class="sxs-lookup"><span data-stu-id="abda4-254">Each of these methods is decorated with the [TestMethod] attribute.</span></span> <span data-ttu-id="abda4-255">Wenn Sie die Komponententests ausführen, wird jede Methode, die über dieses Attribut verfügt, aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="abda4-255">When you run the unit tests, any method that has this attribute is called.</span></span> <span data-ttu-id="abda4-256">Anders ausgedrückt: jede Methode, die mit dem [TestMethod]-Attribut ergänzt wird, ist ein Komponenten Test.</span><span class="sxs-lookup"><span data-stu-id="abda4-256">In other words, any method that is decorated with the [TestMethod] attribute is a unit test.</span></span>

<span data-ttu-id="abda4-257">Der erste Komponenten Test mit dem Namen CreateContact () überprüft, ob das Aufrufen von CreateContact () den Wert true zurückgibt, wenn eine gültige Instanz der Contact-Klasse an die-Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-257">The first unit test, named CreateContact(), verifies that calling CreateContact() returns the value true when a valid instance of the Contact class is passed to the method.</span></span> <span data-ttu-id="abda4-258">Der Test erstellt eine Instanz der Contact-Klasse, ruft die Methode "| atecontact ()" auf und überprüft, ob "kreatecontact ()" den Wert "true" zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="abda4-258">The test creates an instance of the Contact class, calls the CreateContact() method, and verifies that CreateContact() returns the value true.</span></span>

<span data-ttu-id="abda4-259">Die verbleibenden Tests überprüfen, ob die Methode "false" zurückgibt, wenn die Methode "Methode" mit einem ungültigen Kontakt aufgerufen wird, und die erwartete Validierungs Fehlermeldung wird dem Modell Status hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="abda4-259">The remaining tests verify that when the CreateContact() method is called with an invalid Contact then the method returns false and the expected validation error message is added to model state.</span></span> <span data-ttu-id="abda4-260">Beispielsweise wird mit dem Test "kreatecontactrequiredfirstname ()" eine Instanz der Contact-Klasse mit einer leeren Zeichenfolge für die FirstName-Eigenschaft erstellt.</span><span class="sxs-lookup"><span data-stu-id="abda4-260">For example, the CreateContactRequiredFirstName() test creates an instance of the Contact class with an empty string for its FirstName property.</span></span> <span data-ttu-id="abda4-261">Als nächstes wird die Methode "up contact ()" mit dem ungültigen Kontakt aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="abda4-261">Next, the CreateContact() method is called with the invalid Contact.</span></span> <span data-ttu-id="abda4-262">Schließlich wird mit dem Test überprüft, ob "deatecontact ()" den Wert "false" zurückgibt und dass der Modell Status die erwartete Überprüfungs Fehlermeldung "Vorname ist erforderlich" enthält.</span><span class="sxs-lookup"><span data-stu-id="abda4-262">Finally, the test verifies that CreateContact() returns false and that model state contains the expected validation error message "First name is required."</span></span>

<span data-ttu-id="abda4-263">Sie können die Komponententests in der Liste 1 ausführen, indem Sie die Menüoption **Test, ausführen, alle Tests in Projekt Mappe (STRG + R, A)** auswählen.</span><span class="sxs-lookup"><span data-stu-id="abda4-263">You can run the unit tests in Listing 1 by selecting the menu option **Test, Run, All Tests in Solution (CTRL+R, A)**.</span></span> <span data-ttu-id="abda4-264">Die Ergebnisse der Tests werden im Fenster Testergebnisse angezeigt (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="abda4-264">The results of the tests are displayed in the Test Results window (see Figure 4).</span></span>

<span data-ttu-id="abda4-265">[![Testergebnisse](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="abda4-265">[![Test Results](iteration-5-create-unit-tests-cs/_static/image4.jpg)](iteration-5-create-unit-tests-cs/_static/image7.png)</span></span>

<span data-ttu-id="abda4-266">**Abbildung 04**: Testergebnisse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-5-create-unit-tests-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="abda4-266">**Figure 04**: Test Results ([Click to view full-size image](iteration-5-create-unit-tests-cs/_static/image8.png))</span></span>

## <a name="creating-unit-tests-for-controllers"></a><span data-ttu-id="abda4-267">Erstellen von Komponenten Tests für Controller</span><span class="sxs-lookup"><span data-stu-id="abda4-267">Creating Unit Tests for Controllers</span></span>

<span data-ttu-id="abda4-268">Die ASP. netmvc-Anwendung steuert den Fluss der Benutzerinteraktion.</span><span class="sxs-lookup"><span data-stu-id="abda4-268">ASP.NETMVC application control the flow of user interaction.</span></span> <span data-ttu-id="abda4-269">Beim Testen eines Controllers möchten Sie testen, ob der Controller das richtige Aktions Ergebnis zurückgibt, und Daten anzeigen.</span><span class="sxs-lookup"><span data-stu-id="abda4-269">When testing a controller, you want to test whether the controller returns the right action result and view data.</span></span> <span data-ttu-id="abda4-270">Möglicherweise möchten Sie auch testen, ob ein Controller in der erwarteten Weise mit Modellklassen interagiert.</span><span class="sxs-lookup"><span data-stu-id="abda4-270">You also might want to test whether a controller interacts with model classes in the manner expected.</span></span>

<span data-ttu-id="abda4-271">Beispielsweise enthält die Liste 2 zwei Komponententests für die Methode Contact Controller Create ().</span><span class="sxs-lookup"><span data-stu-id="abda4-271">For example, Listing 2 contains two unit tests for the Contact controller Create() method.</span></span> <span data-ttu-id="abda4-272">Der erste Komponenten Test überprüft, ob die Create ()-Methode, wenn ein gültiger Kontakt an die Create ()-Methode übergeben wird, an die Index Aktion umgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-272">The first unit test verifies that when a valid Contact is passed to the Create() method then the Create() method redirects to the Index action.</span></span> <span data-ttu-id="abda4-273">Anders ausgedrückt: Wenn ein gültiger Kontakt übermittelt wird, sollte die Create ()-Methode eine redirecttorouteresult zurückgeben, die die Index Aktion darstellt.</span><span class="sxs-lookup"><span data-stu-id="abda4-273">In other words, when passed a valid Contact, the Create() method should return a RedirectToRouteResult that represents the Index action.</span></span>

<span data-ttu-id="abda4-274">Wir möchten die Dienst Ebene "ContactManager" nicht testen, wenn wir die Controller Schicht testen.</span><span class="sxs-lookup"><span data-stu-id="abda4-274">We don t want to test the ContactManager service layer when we are testing the controller layer.</span></span> <span data-ttu-id="abda4-275">Daher wird die Dienst Ebene mit dem folgenden Code in der Initialize-Methode verspottet:</span><span class="sxs-lookup"><span data-stu-id="abda4-275">Therefore, we mock the service layer with the following code in the Initialize method:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample3.cs)]

<span data-ttu-id="abda4-276">Im createvalidcontact ()-Komponenten Test wird das Verhalten beim Aufrufen der Methode CreateContact () der Dienst Schicht mit der folgenden Codezeile verspottet:</span><span class="sxs-lookup"><span data-stu-id="abda4-276">In the CreateValidContact() unit test, we mock the behavior of calling the service layer CreateContact() method with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample4.cs)]

<span data-ttu-id="abda4-277">Diese Codezeile bewirkt, dass der Mock ContactManager-Dienst den Wert "true" zurückgibt, wenn die zugehörige Methode "| atecontact ()" aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-277">This line of code causes the mock ContactManager service to return the value true when its CreateContact() method is called.</span></span> <span data-ttu-id="abda4-278">Durch die Durchführung der Dienst Ebene können wir das Verhalten des Controllers testen, ohne dass Code in der Dienst Ebene ausgeführt werden muss.</span><span class="sxs-lookup"><span data-stu-id="abda4-278">By mocking the service layer, we can test the behavior of our controller without needing to execute any code in the service layer.</span></span>

<span data-ttu-id="abda4-279">Der zweite Komponenten Test überprüft, ob die Create ()-Aktion die CREATE VIEW zurückgibt, wenn ein ungültiger Kontakt an die-Methode übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-279">The second unit test verifies that the Create() action returns the Create view when an invalid contact is passed to the method.</span></span> <span data-ttu-id="abda4-280">Wir führen dazu, dass die Methode "kreatecontact ()" der Dienst Schicht den Wert "false" mit der folgenden Codezeile zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="abda4-280">We cause the service layer CreateContact() method to return the value false with the following line of code:</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample5.cs)]

<span data-ttu-id="abda4-281">Wenn sich die Create ()-Methode wie erwartet verhält, sollte Sie die CREATE VIEW zurückgeben, wenn die Dienst Ebene den Wert false zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="abda4-281">If the Create() method behaves as we expect then it should return the Create view when the service layer returns the value false.</span></span> <span data-ttu-id="abda4-282">Auf diese Weise kann der Controller die Validierungs Fehlermeldungen in der Create-Ansicht anzeigen, und der Benutzer hat die Möglichkeit, die ungültigen Kontakt Eigenschaften zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="abda4-282">That way, the controller can display the validation error messages in the Create view and the user has a chance to correct that invalid Contact properties.</span></span>

<span data-ttu-id="abda4-283">Wenn Sie Komponententests für Ihre Controller erstellen möchten, müssen Sie explizite Ansichts Namen aus den Controller Aktionen zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="abda4-283">If you plan to build unit tests for your controllers then you need to return explicit view names from your controller actions.</span></span> <span data-ttu-id="abda4-284">Geben Sie z. b. keine Ansicht wie folgt zurück:</span><span class="sxs-lookup"><span data-stu-id="abda4-284">For example, do not return a view like this:</span></span>

<span data-ttu-id="abda4-285">Rückgabe Ansicht ();</span><span class="sxs-lookup"><span data-stu-id="abda4-285">return View();</span></span>

<span data-ttu-id="abda4-286">Geben Sie stattdessen die Ansicht wie folgt zurück:</span><span class="sxs-lookup"><span data-stu-id="abda4-286">Instead, return the view like this:</span></span>

<span data-ttu-id="abda4-287">Rückgabe Ansicht ("erstellen");</span><span class="sxs-lookup"><span data-stu-id="abda4-287">return View("Create");</span></span>

<span data-ttu-id="abda4-288">Wenn Sie beim Zurückgeben einer Sicht nicht explizit sind, gibt die ViewResult. ViewName-Eigenschaft eine leere Zeichenfolge zurück.</span><span class="sxs-lookup"><span data-stu-id="abda4-288">If you are not explicit when returning a view then the ViewResult.ViewName property returns an empty string.</span></span>

<span data-ttu-id="abda4-289">**Codebeispiel 2: controllers\contactcontrollertest.cs**</span><span class="sxs-lookup"><span data-stu-id="abda4-289">**Listing 2 - Controllers\ContactControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-5-create-unit-tests-cs/samples/sample6.cs)]

## <a name="summary"></a><span data-ttu-id="abda4-290">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="abda4-290">Summary</span></span>

<span data-ttu-id="abda4-291">In dieser Iterationen haben wir Komponententests für unsere Contact Manager-Anwendung erstellt.</span><span class="sxs-lookup"><span data-stu-id="abda4-291">In this iteration, we created unit tests for our Contact Manager application.</span></span> <span data-ttu-id="abda4-292">Wir können diese Komponententests jederzeit ausführen, um zu überprüfen, ob sich die Anwendung immer noch auf die erwartete Weise verhält.</span><span class="sxs-lookup"><span data-stu-id="abda4-292">We can run these unit tests at any time to verify that our application still behaves in the manner that we expect.</span></span> <span data-ttu-id="abda4-293">Die Komponententests fungieren als Sicherheitsnetz für unsere Anwendung, sodass wir unsere Anwendung in Zukunft sicher ändern können.</span><span class="sxs-lookup"><span data-stu-id="abda4-293">The unit tests act as a safety net for our application enabling us to safely modify our application in the future.</span></span>

<span data-ttu-id="abda4-294">Wir haben zwei Sätze von Komponententests erstellt.</span><span class="sxs-lookup"><span data-stu-id="abda4-294">We created two sets of unit tests.</span></span> <span data-ttu-id="abda4-295">Zunächst haben wir unsere Validierungs Logik getestet, indem wir Komponententests für unsere Dienst Ebene erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="abda4-295">First, we tested our validation logic by creating unit tests for our service layer.</span></span> <span data-ttu-id="abda4-296">Als nächstes haben wir unsere Fluss Steuerungslogik getestet, indem wir Komponententests für unsere Controller Schicht erstellen.</span><span class="sxs-lookup"><span data-stu-id="abda4-296">Next, we tested our flow control logic by creating unit tests for our controller layer.</span></span> <span data-ttu-id="abda4-297">Beim Testen unserer Dienst Schicht haben wir unsere Tests für unsere Dienst Ebene von unserer Repository-Schicht isoliert, indem wir unsere Repository-Ebene durch die.</span><span class="sxs-lookup"><span data-stu-id="abda4-297">When testing our service layer, we isolated our tests for our service layer from our repository layer by mocking our repository layer.</span></span> <span data-ttu-id="abda4-298">Beim Testen der Controller Schicht isolieren wir unsere Tests für unsere Controller Schicht durch das Durchsuchen der Dienst Ebene.</span><span class="sxs-lookup"><span data-stu-id="abda4-298">When testing the controller layer, we isolated our tests for our controller layer by mocking the service layer.</span></span>

<span data-ttu-id="abda4-299">In der nächsten Iterationen wird die Contact Manager-Anwendung so geändert, dass Sie Kontaktgruppen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="abda4-299">In the next iteration, we modify the Contact Manager application so that it supports Contact Groups.</span></span> <span data-ttu-id="abda4-300">Wir fügen diese neue Funktionalität unserer Anwendung mithilfe eines Software Entwurfsprozesses hinzu, der als Test gesteuerte Entwicklung bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="abda4-300">We'll add this new functionality to our application using a software design process called test-driven development.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="abda4-301">[Zurück](iteration-4-make-the-application-loosely-coupled-cs.md)
> [Weiter](iteration-6-use-test-driven-development-cs.md)</span><span class="sxs-lookup"><span data-stu-id="abda4-301">[Previous](iteration-4-make-the-application-loosely-coupled-cs.md)
[Next](iteration-6-use-test-driven-development-cs.md)</span></span>
