---
uid: mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
title: 'Iterations #6 – Verwenden der Test gesteuerten Entwicklung (C#) | Microsoft-Dokumentation'
author: microsoft
description: In dieser sechsten Iterationen fügen wir der Anwendung neue Funktionen hinzu, indem wir zuerst Komponententests schreiben und Code für die Komponententests schreiben. In diesem Iterations,...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 013c3c26-7dc3-41d1-8064-f233c86008b5
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
msc.type: authoredcontent
ms.openlocfilehash: aee0ff9d8d7f17e8a00dab12467bd3a3457fbe18
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78487125"
---
# <a name="iteration-6--use-test-driven-development-c"></a><span data-ttu-id="ed2e1-104">Iterations #6 – Verwenden der Test gesteuerten Entwicklung (C#)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-104">Iteration #6 – Use test-driven development (C#)</span></span>

<span data-ttu-id="ed2e1-105">von [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="ed2e1-106">Code herunterladen</span><span class="sxs-lookup"><span data-stu-id="ed2e1-106">Download Code</span></span>](iteration-6-use-test-driven-development-cs/_static/contactmanager_6_cs1.zip)

> <span data-ttu-id="ed2e1-107">In dieser sechsten Iterationen fügen wir der Anwendung neue Funktionen hinzu, indem wir zuerst Komponententests schreiben und Code für die Komponententests schreiben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-107">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="ed2e1-108">In dieser Iterationen fügen wir Kontaktgruppen hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-108">In this iteration, we add contact groups.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="ed2e1-109">Aufbauen einer Kontakt Verwaltung ASP.NET MVC-AnwendungC#()</span><span class="sxs-lookup"><span data-stu-id="ed2e1-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="ed2e1-110">In dieser Reihe von Tutorials erstellen wir von Anfang bis Ende eine gesamte Kontakt Verwaltungs Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="ed2e1-111">Mithilfe der Kontakt-Manager-Anwendung können Sie Kontaktinformationen (Namen, Telefonnummern und e-Mail-Adressen) für eine Liste von Personen speichern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="ed2e1-112">Die Anwendung wird über mehrere Iterationen erstellt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="ed2e1-113">Bei jeder Iterationen verbessern wir die Anwendung allmählich.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="ed2e1-114">Das Ziel dieses mehrfaches Iterations Ansatzes besteht darin, Ihnen zu ermöglichen, den Grund für jede Änderung zu verstehen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="ed2e1-115">Iterations #1: Erstellen Sie die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="ed2e1-116">In der ersten Iterationen erstellen wir den Kontakt-Manager auf einfachste Art und Weise.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="ed2e1-117">Wir fügen Unterstützung für grundlegende Daten Bank Vorgänge hinzu: Create, Read, Update und DELETE (CRUD).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="ed2e1-118">Iterations #2: machen Sie das Aussehen der Anwendung schön.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="ed2e1-119">In dieser Iterationen verbessern wir die Darstellung der Anwendung durch Ändern der standardmäßigen ASP.NET-MVC-Ansichts Master Seite und des Cascading Stylesheets.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="ed2e1-120">Iterations #3: Formular Validierung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="ed2e1-121">In der dritten Iterationen fügen wir die grundlegende Formular Validierung hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="ed2e1-122">Wir hindern Personen daran, ein Formular zu senden, ohne die erforderlichen Formularfelder abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="ed2e1-123">Wir überprüfen auch die e-Mail-Adressen und Telefonnummern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="ed2e1-124">Iterations #4: Legen Sie die Anwendung lose gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="ed2e1-125">In dieser vierten Iterationen nutzen wir mehrere Software Entwurfsmuster, um die Verwaltung und Änderung der Contact Manager-Anwendung zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="ed2e1-126">Beispielsweise können wir unsere Anwendung so umgestalten, dass Sie das Repository-Muster und das Muster für die Abhängigkeitsinjektion verwendet.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="ed2e1-127">Iterations #5: Erstellen von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="ed2e1-128">In der fünften Iterationen wird die Wartung und Änderung unserer Anwendung durch Hinzufügen von Komponententests vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="ed2e1-129">Wir simulieren unsere Datenmodell Klassen und erstellen Komponententests für unsere Controller und Validierungs Logik.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="ed2e1-130">Iterations #6: Verwenden Sie die Test gesteuerte Entwicklung.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="ed2e1-131">In dieser sechsten Iterationen fügen wir der Anwendung neue Funktionen hinzu, indem wir zuerst Komponententests schreiben und Code für die Komponententests schreiben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="ed2e1-132">In dieser Iterationen fügen wir Kontaktgruppen hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="ed2e1-133">Iterations #7: Hinzufügen von AJAX-Funktionen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="ed2e1-134">In der siebten Iterationen verbessern wir die Reaktionsfähigkeit und Leistung unserer Anwendung durch Hinzufügen von Unterstützung für AJAX.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="ed2e1-135">Diese Iterations</span><span class="sxs-lookup"><span data-stu-id="ed2e1-135">This Iteration</span></span>

<span data-ttu-id="ed2e1-136">In der vorherigen Iterationen der Kontakt-Manager-Anwendung wurden Komponententests erstellt, um ein Sicherheitsnetz für unseren Code bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-136">In the previous iteration of the Contact Manager application, we created unit tests to provide a safety net for our code.</span></span> <span data-ttu-id="ed2e1-137">Die Motivation für die Erstellung der Komponententests bestand darin, den Code stabiler zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-137">The motivation for creating the unit tests was to make our code more resilient to change.</span></span> <span data-ttu-id="ed2e1-138">Mit Komponententests können wir glücklicherweise Änderungen am Code vornehmen und sofort wissen, ob die vorhandene Funktionalität beschädigt ist.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-138">With unit tests in place, we can happily make any change to our code and immediately know whether we have broken existing functionality.</span></span>

<span data-ttu-id="ed2e1-139">In dieser Iterationen werden Komponententests für einen völlig anderen Zweck verwendet.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-139">In this iteration, we use unit tests for an entirely different purpose.</span></span> <span data-ttu-id="ed2e1-140">In dieser Iterationen verwenden wir Komponententests als Teil einer Anwendungs Entwurfs Philosophie namens *Test gesteuerte Entwicklung*.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-140">In this iteration, we use unit tests as part of an application design philosophy called *test-driven development*.</span></span> <span data-ttu-id="ed2e1-141">Wenn Sie die Test gesteuerte Entwicklung testen, schreiben Sie zuerst Tests und schreiben dann Code für die Tests.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-141">When you practice test-driven development, you write tests first and then write code against the tests.</span></span>

<span data-ttu-id="ed2e1-142">Genauer: bei der Test gesteuerten Entwicklung gibt es drei Schritte, die Sie beim Erstellen von Code (rot/grün/Umgestaltung) ausführen:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-142">More precisely, when practicing test-driven development, there are three steps that you complete when creating code (Red/ Green/Refactor):</span></span>

1. <span data-ttu-id="ed2e1-143">Schreiben eines fehlgeschlagenen Komponententests (rot)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-143">Write a unit test that fails (Red)</span></span>
2. <span data-ttu-id="ed2e1-144">Schreiben von Code, der den Komponenten Test übergibt (grün)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-144">Write code that passes the unit test (Green)</span></span>
3. <span data-ttu-id="ed2e1-145">Umgestalten des Codes (Umgestaltung)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-145">Refactor your code (Refactor)</span></span>

<span data-ttu-id="ed2e1-146">Zuerst schreiben Sie den Komponenten Test.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-146">First, you write the unit test.</span></span> <span data-ttu-id="ed2e1-147">Der Komponenten Test sollte ihre Absicht zum Verhalten Ihres Codes Ausdrücken.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-147">The unit test should express your intention for how you expect your code to behave.</span></span> <span data-ttu-id="ed2e1-148">Wenn Sie den Komponenten Test erstmalig erstellen, sollte der Komponenten Test fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-148">When you first create the unit test, the unit test should fail.</span></span> <span data-ttu-id="ed2e1-149">Der Test sollte fehlschlagen, da Sie noch keinen Anwendungscode geschrieben haben, der den Test erfüllt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-149">The test should fail because you have not yet written any application code that satisfies the test.</span></span>

<span data-ttu-id="ed2e1-150">Als nächstes schreiben Sie genau genug Code, damit der Komponenten Test erfolgreich durchlaufen wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-150">Next, you write just enough code in order for the unit test to pass.</span></span> <span data-ttu-id="ed2e1-151">Ziel ist es, den Code in der verzögensten, sloppsten und schnellsten Weise zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-151">The goal is to write the code in the laziest, sloppiest and fastest possible way.</span></span> <span data-ttu-id="ed2e1-152">Sie sollten keine Zeit in Bezug auf die Architektur Ihrer Anwendung verschwenden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-152">You should not waste time thinking about the architecture of your application.</span></span> <span data-ttu-id="ed2e1-153">Stattdessen sollten Sie sich darauf konzentrieren, den minimalen Code zu schreiben, der erforderlich ist, um die vom Komponenten Test ausgedrückte Absicht zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-153">Instead, you should focus on writing the minimal amount of code necessary to satisfy the intention expressed by the unit test.</span></span>

<span data-ttu-id="ed2e1-154">Nachdem Sie ausreichend Code geschrieben haben, können Sie einen Schritt zurückgehen und die Gesamtarchitektur Ihrer Anwendung in Erwägung gezogen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-154">Finally, after you have written enough code, you can step back and consider the overall architecture of your application.</span></span> <span data-ttu-id="ed2e1-155">In diesem Schritt können Sie Ihren Code umschreiben (umgestalten), indem Sie die Vorteile von Software Entwurfsmustern (z. b. das Repository-Muster) nutzen, sodass der Code besser verwaltbar ist.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-155">In this step, you rewrite (refactor) your code by taking advantage of software design patterns -- such as the repository pattern -- so that your code is more maintainable.</span></span> <span data-ttu-id="ed2e1-156">In diesem Schritt können Sie den Code in diesem Schritt mühelos neu schreiben, da der Code von Komponententests abgedeckt wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-156">You can fearlessly rewrite your code in this step because your code is covered by unit tests.</span></span>

<span data-ttu-id="ed2e1-157">Es gibt viele Vorteile, die sich aus der Übung der Test gesteuerten Entwicklung ergeben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-157">There are many benefits that result from practicing test-driven development.</span></span> <span data-ttu-id="ed2e1-158">Zuerst zwingt die Test gesteuerte Entwicklung Sie, sich auf den Code zu konzentrieren, der eigentlich geschrieben werden muss.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-158">First, test-driven development forces you to focus on code that actually needs to be written.</span></span> <span data-ttu-id="ed2e1-159">Da Sie sich ständig auf das Schreiben von ausreichendem Code zum Durchführen eines bestimmten Tests konzentrieren, werden Sie daran gehindert, in das Unkraut zu gehen und riesige Mengen an Code zu schreiben, die Sie niemals verwenden werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-159">Because you are constantly focused on just writing enough code to pass a particular test, you are prevented from wandering into the weeds and writing massive amounts of code that you will never use.</span></span>

<span data-ttu-id="ed2e1-160">Zweitens zwingt eine "Test First"-Entwurfsmethodik, Code aus der Perspektive zu schreiben, wie der Code verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-160">Second, a "test first" design methodology forces you to write code from the perspective of how your code will be used.</span></span> <span data-ttu-id="ed2e1-161">Anders ausgedrückt: Wenn Sie die Test gesteuerte Entwicklung durchlaufen, schreiben Sie ständig die Tests aus der Perspektive des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-161">In other words, when practicing test-driven development, you are constantly writing your tests from a user perspective.</span></span> <span data-ttu-id="ed2e1-162">Aus diesem Grund kann die Test gesteuerte Entwicklung zu sauberen und verständlicheren APIs führen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-162">Therefore, test-driven development can result in cleaner and more understandable APIs.</span></span>

<span data-ttu-id="ed2e1-163">Zum Schluss zwingt die Test gesteuerte Entwicklung das Schreiben von Komponententests im Rahmen des normalen Prozesses zum Schreiben einer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-163">Finally, test-driven development forces you to write unit tests as part of the normal process of writing an application.</span></span> <span data-ttu-id="ed2e1-164">Als Projekt Stichtag ist das Testen in der Regel die erste Aufgabe, die das Fenster verlässt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-164">As a project deadline approaches, testing is typically the first thing that goes out the window.</span></span> <span data-ttu-id="ed2e1-165">Wenn Sie die Test gesteuerte Entwicklung betreiben, ist es jedoch wahrscheinlicher, dass Sie mit dem Schreiben von Komponententests in Bezug auf das Schreiben von Komponententests zu tun haben, da Komponententests durch die Test gesteuerte Entwicklung für den Prozess der Erstellung einer Anwendung zentral sind.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-165">When practicing test-driven development, on the other hand, you are more likely to be virtuous about writing unit tests because test-driven development makes unit tests central to the process of building an application.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="ed2e1-166">Um mehr über die Test gesteuerte Entwicklung zu erfahren, empfiehlt es sich, das Michael-Feathers-Buch zu lesen, das **effektiv mit Legacy Code arbeitet**.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-166">To learn more about test-driven development, I recommend that you read Michael Feathers book **Working Effectively with Legacy Code**.</span></span>

<span data-ttu-id="ed2e1-167">In dieser Iterationen fügen wir unserer Contact Manager-Anwendung ein neues Feature hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-167">In this iteration, we add a new feature to our Contact Manager application.</span></span> <span data-ttu-id="ed2e1-168">Wir fügen Unterstützung für Kontaktgruppen hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-168">We add support for Contact Groups.</span></span> <span data-ttu-id="ed2e1-169">Sie können Kontaktgruppen verwenden, um Ihre Kontakte in Kategorien wie z. b. Geschäfts-und Friend-Gruppen zu organisieren.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-169">You can use Contact Groups to organize your contacts into categories such as Business and Friend groups.</span></span>

<span data-ttu-id="ed2e1-170">Wir fügen diese neue Funktionalität unserer Anwendung hinzu, indem wir einen Prozess der Test gesteuerten Entwicklung befolgen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-170">We'll add this new functionality to our application by following a process of test-driven development.</span></span> <span data-ttu-id="ed2e1-171">Wir schreiben zuerst unsere Komponententests, und wir schreiben den gesamten Code für diese Tests.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-171">We'll write our unit tests first and we'll write all of our code against these tests.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="ed2e1-172">Was wird getestet?</span><span class="sxs-lookup"><span data-stu-id="ed2e1-172">What Gets Tested</span></span>

<span data-ttu-id="ed2e1-173">Wie bereits in der vorherigen Iterationen erläutert, schreiben Sie in der Regel keine Komponententests für Datenzugriffs Logik oder Sicht Logik.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-173">As we discussed in the previous iteration, you typically do not write unit tests for data access logic or view logic.</span></span> <span data-ttu-id="ed2e1-174">Sie schreiben keine Komponententests für die Datenzugriffs Logik, da der Zugriff auf eine Datenbank relativ langsam ist.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-174">You don t write unit tests for data access logic because accessing a database is a relatively slow operation.</span></span> <span data-ttu-id="ed2e1-175">Sie schreiben keine Komponententests für die Ansichts Logik, da der Zugriff auf eine Ansicht das Einrichten eines Webservers erfordert, bei dem es sich um einen relativ langsamen Vorgang handelt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-175">You don t write unit tests for view logic because accessing a view requires spinning up a web server which is a relatively slow operation.</span></span> <span data-ttu-id="ed2e1-176">Sie sollten keinen Komponenten Test schreiben, es sei denn, der Test kann immer wiederholt ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-176">You shouldn't write a unit test unless the test can be executed over and over again very fast</span></span>

<span data-ttu-id="ed2e1-177">Da die Test gesteuerte Entwicklung von Komponententests gesteuert wird, konzentrieren wir uns zunächst auf das Schreiben von Controller und Geschäftslogik.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-177">Because test-driven development is driven by unit tests, we focus initially on writing controller and business logic.</span></span> <span data-ttu-id="ed2e1-178">Wir vermeiden das Berühren der Datenbank oder Sichten.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-178">We avoid touching the database or views.</span></span> <span data-ttu-id="ed2e1-179">Wir werden die Datenbank erst am Ende dieses Lernprogramms ändern oder unsere Ansichten erstellen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-179">We won't modify the database or create our views until the very end of this tutorial.</span></span> <span data-ttu-id="ed2e1-180">Wir beginnen mit dem, was getestet werden kann.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-180">We start with what can be tested.</span></span>

## <a name="creating-user-stories"></a><span data-ttu-id="ed2e1-181">Erstellen von User Stories</span><span class="sxs-lookup"><span data-stu-id="ed2e1-181">Creating User Stories</span></span>

<span data-ttu-id="ed2e1-182">Beim Testen der Test gesteuerten Entwicklung beginnen Sie immer mit dem Schreiben eines Tests.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-182">When practicing test-driven development, you always start by writing a test.</span></span> <span data-ttu-id="ed2e1-183">Dadurch wird sofort die Frage gestellt: wie entscheiden Sie, welchen Test zuerst geschrieben werden soll?</span><span class="sxs-lookup"><span data-stu-id="ed2e1-183">This immediately raises the question: How do you decide what test to write first?</span></span> <span data-ttu-id="ed2e1-184">Um diese Frage zu beantworten, sollten Sie eine Reihe von [**User Stories**](http://en.wikipedia.org/wiki/User_stories)schreiben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-184">To answer this question, you should write a set of [**user stories**](http://en.wikipedia.org/wiki/User_stories).</span></span>

<span data-ttu-id="ed2e1-185">Eine User Story ist eine sehr kurze Beschreibung einer Software Anforderung (in der Regel ein Satz).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-185">A user story is a very brief (usually one sentence) description of a software requirement.</span></span> <span data-ttu-id="ed2e1-186">Dies sollte eine nicht technische Beschreibung einer Anforderung sein, die aus der Benutzer Perspektive geschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-186">It should be a non-technical description of a requirement written from a user perspective.</span></span>

<span data-ttu-id="ed2e1-187">Hier finden Sie die Benutzer Textabschnitte, die die Features beschreiben, die für die neue Funktion der Kontaktgruppe erforderlich sind:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-187">Here s the set of user stories that describe the features required by the new Contact Group functionality:</span></span>

1. <span data-ttu-id="ed2e1-188">Der Benutzer kann eine Liste von Kontaktgruppen anzeigen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-188">User can view a list of contact groups.</span></span>
2. <span data-ttu-id="ed2e1-189">Der Benutzer kann eine neue Kontaktgruppe erstellen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-189">User can create a new contact group.</span></span>
3. <span data-ttu-id="ed2e1-190">Der Benutzer kann eine vorhandene Kontaktgruppe löschen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-190">User can delete an existing contact group.</span></span>
4. <span data-ttu-id="ed2e1-191">Der Benutzer kann beim Erstellen eines neuen Kontakts eine Kontaktgruppe auswählen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-191">User can select a contact group when creating a new contact.</span></span>
5. <span data-ttu-id="ed2e1-192">Der Benutzer kann eine Kontaktgruppe auswählen, wenn ein vorhandener Kontakt bearbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-192">User can select a contact group when editing an existing contact.</span></span>
6. <span data-ttu-id="ed2e1-193">In der Index Ansicht wird eine Liste der Kontaktgruppen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-193">A list of contact groups is displayed in the Index view.</span></span>
7. <span data-ttu-id="ed2e1-194">Wenn ein Benutzer auf eine Kontaktgruppe klickt, wird eine Liste mit übereinstimmenden Kontakten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-194">When a user clicks a contact group, a list of matching contacts is displayed.</span></span>

<span data-ttu-id="ed2e1-195">Beachten Sie, dass diese Liste von User Stories von einem Kunden vollständig verständlich ist.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-195">Notice that this list of user stories is completely understandable by a customer.</span></span> <span data-ttu-id="ed2e1-196">Technische Implementierungsdetails werden nicht erwähnt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-196">There is no mention of technical implementation details.</span></span>

<span data-ttu-id="ed2e1-197">Während der Anwendung der Anwendung kann der Satz von User Storys besser verfeinert werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-197">While in the process of building your application, the set of user stories can become more refined.</span></span> <span data-ttu-id="ed2e1-198">Sie können eine User Story in mehrere Storys unterbrechen (Anforderungen).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-198">You might break a user story into multiple stories (requirements).</span></span> <span data-ttu-id="ed2e1-199">Beispielsweise können Sie entscheiden, dass das Erstellen einer neuen Kontaktgruppe eine Überprüfung beinhalten soll.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-199">For example, you might decide that creating a new contact group should involve validation.</span></span> <span data-ttu-id="ed2e1-200">Wenn Sie eine Kontaktgruppe ohne Namen einreichen, sollte ein Validierungs Fehler zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-200">Submitting a contact group without a name should return a validation error.</span></span>

<span data-ttu-id="ed2e1-201">Nachdem Sie eine Liste von User Stories erstellt haben, können Sie Ihren ersten Komponenten Test schreiben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-201">After you create a list of user stories, you are ready to write your first unit test.</span></span> <span data-ttu-id="ed2e1-202">Zunächst erstellen Sie einen Komponenten Test, um die Liste der Kontaktgruppen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-202">We'll start by creating a unit test for viewing the list of contact groups.</span></span>

## <a name="listing-contact-groups"></a><span data-ttu-id="ed2e1-203">Auflisten von Kontaktgruppen</span><span class="sxs-lookup"><span data-stu-id="ed2e1-203">Listing Contact Groups</span></span>

<span data-ttu-id="ed2e1-204">Der erste User Story ist, dass ein Benutzer in der Lage sein sollte, eine Liste der Kontaktgruppen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-204">Our first user story is that a user should be able to view a list of contact groups.</span></span> <span data-ttu-id="ed2e1-205">Wir müssen diese Story mit einem Test Ausdrücken.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-205">We need to express this story with a test.</span></span>

<span data-ttu-id="ed2e1-206">Erstellen Sie einen neuen Komponenten Test, indem Sie mit der rechten Maustaste auf den Ordner "Controllers" im Projekt "ContactManager. Tests" klicken, " **Hinzufügen", "neuer Test**" und "Komponenten **Test** Vorlage" auswählen (siehe Abbildung 1)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-206">Create a new unit test by right-clicking the Controllers folder in the ContactManager.Tests project, selecting **Add, New Test**, and selecting the **Unit Test** template (see Figure 1).</span></span> <span data-ttu-id="ed2e1-207">Benennen Sie den neuen Komponenten Test GroupControllerTest.cs, und klicken Sie auf die Schaltfläche **OK** .</span><span class="sxs-lookup"><span data-stu-id="ed2e1-207">Name the new unit test GroupControllerTest.cs and click the **OK** button.</span></span>

<span data-ttu-id="ed2e1-208">[![Hinzufügen des groupcontrollertest-Komponententests](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-208">[![Adding the GroupControllerTest unit test](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span></span>

<span data-ttu-id="ed2e1-209">**Abbildung 01**: Hinzufügen des groupcontrollertest-Komponententests ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-209">**Figure 01**: Adding the GroupControllerTest unit test([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image2.png))</span></span>

<span data-ttu-id="ed2e1-210">Der erste Komponenten Test ist in der Liste 1 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-210">Our first unit test is contained in Listing 1.</span></span> <span data-ttu-id="ed2e1-211">Mit diesem Test wird überprüft, ob die Index ()-Methode des Gruppen Controllers eine Gruppe von Gruppen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-211">This test verifies that the Index() method of the Group controller returns a set of Groups.</span></span> <span data-ttu-id="ed2e1-212">Der Test überprüft, ob in den Ansichts Daten eine Auflistung von Gruppen zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-212">The test verifies that a collection of Groups is returned in view data.</span></span>

<span data-ttu-id="ed2e1-213">**Codebeispiel 1-controllers\groupcontrollertest.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-213">**Listing 1 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample1.cs)]

<span data-ttu-id="ed2e1-214">Wenn Sie den Code zum ersten Mal in der Liste 1 in Visual Studio eingeben, werden viele rote Wellenlinien angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-214">When you first type the code in Listing 1 in Visual Studio, you'll get a lot of red squiggly lines.</span></span> <span data-ttu-id="ed2e1-215">Die GroupController-oder Group-Klassen wurden nicht erstellt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-215">We have not created the GroupController or Group classes.</span></span>

<span data-ttu-id="ed2e1-216">An diesem Punkt können wir die Anwendung selbst erstellen, damit wir den ersten Komponenten Test ausführen können.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-216">At this point, we can t even build our application so we can t execute our first unit test.</span></span> <span data-ttu-id="ed2e1-217">Das ist gut.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-217">That s good.</span></span> <span data-ttu-id="ed2e1-218">Dies zählt als fehlgeschlagenen Test.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-218">That counts as a failing test.</span></span> <span data-ttu-id="ed2e1-219">Daher verfügen wir jetzt über die Berechtigung, mit dem Schreiben von Anwendungscode zu beginnen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-219">Therefore, we now have permission to start writing application code.</span></span> <span data-ttu-id="ed2e1-220">Wir müssen genug Code schreiben, um den Test auszuführen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-220">We need to write enough code to execute our test.</span></span>

<span data-ttu-id="ed2e1-221">Die Group Controller-Klasse in der Liste 2 enthält das erforderliche Minimum an Code, das zum Durchlaufen des Komponententests erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-221">The Group controller class in Listing 2 contains the bare minimum of code required to pass the unit test.</span></span> <span data-ttu-id="ed2e1-222">Die Index ()-Aktion gibt eine statisch codierte Liste von Gruppen zurück (die Group-Klasse ist in der Liste 3 definiert).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-222">The Index() action returns a statically coded list of Groups (the Group class is defined in Listing 3).</span></span>

<span data-ttu-id="ed2e1-223">**Codebeispiel 2: controllers\groupcontroller.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-223">**Listing 2 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample2.cs)]

<span data-ttu-id="ed2e1-224">**Codebeispiel 3: models\group.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-224">**Listing 3 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample3.cs)]

<span data-ttu-id="ed2e1-225">Nachdem wir dem Projekt die GroupController-Klasse und die Group-Klasse hinzugefügt haben, wird der erste Komponenten Test erfolgreich abgeschlossen (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-225">After we add the GroupController and Group classes to our project, our first unit test completes successfully (see Figure 2).</span></span> <span data-ttu-id="ed2e1-226">Wir haben die mindestens erforderliche Arbeit zum Durchlaufen des Tests durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-226">We have done the minimum work required to pass the test.</span></span> <span data-ttu-id="ed2e1-227">Es ist Zeit, zu feiern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-227">It is time to celebrate.</span></span>

<span data-ttu-id="ed2e1-228">[![Erfolg!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-228">[![Success!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span></span>

<span data-ttu-id="ed2e1-229">**Abbildung 02**: Erfolg! ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-229">**Figure 02**: Success!([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image4.png))</span></span>

## <a name="creating-contact-groups"></a><span data-ttu-id="ed2e1-230">Erstellen von Kontaktgruppen</span><span class="sxs-lookup"><span data-stu-id="ed2e1-230">Creating Contact Groups</span></span>

<span data-ttu-id="ed2e1-231">Nun können wir mit dem zweiten User Story fortfahren.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-231">Now we can move on to the second user story.</span></span> <span data-ttu-id="ed2e1-232">Wir müssen neue Kontaktgruppen erstellen können.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-232">We need to be able to create new contact groups.</span></span> <span data-ttu-id="ed2e1-233">Wir müssen diese Absicht mit einem Test Ausdrücken.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-233">We need to express this intention with a test.</span></span>

<span data-ttu-id="ed2e1-234">Der Test in der Liste 4 überprüft, ob der Aufruf der Create ()-Methode mit einer neuen Gruppe die Gruppe der Liste der Gruppen hinzufügt, die von der Index ()-Methode zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-234">The test in Listing 4 verifies that calling the Create() method with a new Group adds the Group to the list of Groups returned by the Index() method.</span></span> <span data-ttu-id="ed2e1-235">Anders ausgedrückt: Wenn ich eine neue Gruppe erstelle, sollte ich die neue Gruppe aus der Liste der von der Index ()-Methode zurückgegebenen Gruppen zurückholen können.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-235">In other words, if I create a new group then I should be able to get the new Group back from the list of Groups returned by the Index() method.</span></span>

<span data-ttu-id="ed2e1-236">**Codebeispiel 4-controllers\groupcontrollertest.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-236">**Listing 4 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample4.cs)]

<span data-ttu-id="ed2e1-237">Der Test in der Liste 4 Ruft die Group Controller Create ()-Methode mit einer neuen Kontaktgruppe auf.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-237">The test in Listing 4 calls the Group controller Create() method with a new contact Group.</span></span> <span data-ttu-id="ed2e1-238">Als nächstes überprüft der Test, ob beim Aufrufen der Group Controller Index ()-Methode die neue Gruppe in den Ansichts Daten zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-238">Next, the test verifies that calling the Group controller Index() method returns the new Group in view data.</span></span>

<span data-ttu-id="ed2e1-239">Der geänderte Gruppen Controller in der Liste 5 enthält die minimalen Änderungen, die erforderlich sind, um den neuen Test zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-239">The modified Group controller in Listing 5 contains the bare minimum of changes required to pass the new test.</span></span>

<span data-ttu-id="ed2e1-240">**Auflistung 5-controllers\groupcontroller.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-240">**Listing 5 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample5.cs)]

## <a name="the-group-controller-in-listing-5-has-a-new-create-action-this-action-adds-a-group-to-a-collection-of-groups-notice-that-the-index-action-has-been-modified-to-return-the-contents-of-the-collection-of-groups"></a><span data-ttu-id="ed2e1-241">Der Gruppen Controller in der Liste 5 verfügt über eine neue Create ()-Aktion.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-241">The Group controller in Listing 5 has a new Create() action.</span></span> <span data-ttu-id="ed2e1-242">Durch diese Aktion wird einer Gruppe von Gruppen eine Gruppe hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-242">This action adds a Group to a collection of Groups.</span></span> <span data-ttu-id="ed2e1-243">Beachten Sie, dass die Index ()-Aktion geändert wurde, um den Inhalt der Auflistung von Gruppen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-243">Notice that the Index() action has been modified to return the contents of the collection of Groups.</span></span>

<span data-ttu-id="ed2e1-244">Noch einmal haben wir die erforderliche Mindestmenge an Arbeit durchgeführt, die zum Durchführen des Komponententests erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-244">Once again, we have performed the bare minimum amount of work required to pass the unit test.</span></span> <span data-ttu-id="ed2e1-245">Nachdem wir diese Änderungen am Gruppen Controller vorgenommen haben, bestehen alle Komponententests.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-245">After we make these changes to the Group controller, all of our unit tests pass.</span></span>

## <a name="adding-validation"></a><span data-ttu-id="ed2e1-246">Hinzufügen der Validierung</span><span class="sxs-lookup"><span data-stu-id="ed2e1-246">Adding Validation</span></span>

<span data-ttu-id="ed2e1-247">Diese Anforderung wurde im User Story nicht explizit angegeben.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-247">This requirement was not stated explicitly in the user story.</span></span> <span data-ttu-id="ed2e1-248">Es ist jedoch sinnvoll, dass eine Gruppe einen Namen hat.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-248">However, it is reasonable to require that a Group have a name.</span></span> <span data-ttu-id="ed2e1-249">Andernfalls wäre das Organisieren von Kontakten in Gruppen nicht sehr nützlich.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-249">Otherwise, organizing contacts into Groups would not be very useful.</span></span>

<span data-ttu-id="ed2e1-250">Die Liste 6 enthält einen neuen Test, der diese Absicht ausdrückt.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-250">Listing 6 contains a new test that expresses this intention.</span></span> <span data-ttu-id="ed2e1-251">Mit diesem Test wird überprüft, ob beim Versuch, eine Gruppe ohne Angabe eines Namens zu erstellen, im Modell Status eine Validierungs Fehlermeldung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-251">This test verifies that attempting to create a Group without supplying a name results in a validation error message in model state.</span></span>

<span data-ttu-id="ed2e1-252">**Codebeispiel 6-controllers\groupcontrollertest.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-252">**Listing 6 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample6.cs)]

<span data-ttu-id="ed2e1-253">Um diesen Test zu erfüllen, müssen wir der Group-Klasse eine Name-Eigenschaft hinzufügen (siehe Codebeispiel 7).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-253">In order to satisfy this test, we need to add a Name property to our Group class (see Listing 7).</span></span> <span data-ttu-id="ed2e1-254">Außerdem müssen wir der Aktion "Create ()" für den Group Controller-Vorgang ein kleines wenig Validierungs Logik hinzufügen (siehe Codebeispiel 8).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-254">Furthermore, we need to add a tiny bit of validation logic to our Group controller s Create() action (see Listing 8).</span></span>

<span data-ttu-id="ed2e1-255">**Codebeispiel 7: models\group.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-255">**Listing 7 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample7.cs)]

<span data-ttu-id="ed2e1-256">**Auflisten von 8-controllers\groupcontroller.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-256">**Listing 8 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample8.cs)]

<span data-ttu-id="ed2e1-257">Beachten Sie, dass die Group Controller Create ()-Aktion jetzt sowohl die Validierung als auch die Daten Bank Logik enthält.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-257">Notice that the Group controller Create() action now contains both validation and database logic.</span></span> <span data-ttu-id="ed2e1-258">Derzeit besteht die vom Gruppen Controller verwendete Datenbank nur aus einer Sammlung im Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-258">Currently, the database used by the Group controller consists of nothing more than an in-memory collection.</span></span>

## <a name="time-to-refactor"></a><span data-ttu-id="ed2e1-259">Umgestaltungs Zeit</span><span class="sxs-lookup"><span data-stu-id="ed2e1-259">Time to Refactor</span></span>

<span data-ttu-id="ed2e1-260">Der dritte Schritt in rot/grün/Umgestaltung ist das Umgestaltungs Element.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-260">The third step in Red/Green/Refactor is the Refactor part.</span></span> <span data-ttu-id="ed2e1-261">An diesem Punkt müssen wir aus dem Code zurückgehen und berücksichtigen, wie wir unsere Anwendung umgestalten können, um den Entwurf zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-261">At this point, we need to step back from our code and consider how we can refactor our application to improve its design.</span></span> <span data-ttu-id="ed2e1-262">Die Umgestaltungs Stufe ist die Phase, bei der wir uns die beste Methode zum Implementieren von Software Entwurfs Prinzipien und-Mustern vorstellen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-262">The Refactor stage is the stage at which we think hard about the best way of implementing software design principles and patterns.</span></span>

<span data-ttu-id="ed2e1-263">Wir können unseren Code beliebig ändern, um den Code Entwurf zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-263">We are free to modify our code in any way that we choose to improve the design of the code.</span></span> <span data-ttu-id="ed2e1-264">Wir haben ein Sicherheitsnetz von Unittests, die verhindern, dass vorhandene Funktionen unterbunden werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-264">We have a safety net of unit tests that prevent us from breaking existing functionality.</span></span>

<span data-ttu-id="ed2e1-265">Derzeit ist unser Gruppen Controller ein Chaos aus der Perspektive eines guten Softwaredesigns.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-265">Right now, our Group controller is a mess from the perspective of good software design.</span></span> <span data-ttu-id="ed2e1-266">Der Gruppen Controller enthält ein Durcheinander mit dem Validierungs-und Datenzugriffs Code.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-266">The Group controller contains a tangled mess of validation and data access code.</span></span> <span data-ttu-id="ed2e1-267">Um das Prinzip der einzelnen Verantwortung zu vermeiden, müssen wir diese Aspekte in verschiedene Klassen aufteilen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-267">To avoid violating the Single Responsibility Principle, we need to separate these concerns into different classes.</span></span>

<span data-ttu-id="ed2e1-268">Unsere umgestaltete Group Controller-Klasse ist in der Liste 9 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-268">Our refactored Group controller class is contained in Listing 9.</span></span> <span data-ttu-id="ed2e1-269">Der Controller wurde geändert, um die Dienst Ebene "ContactManager" zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-269">The controller has been modified to use the ContactManager service layer.</span></span> <span data-ttu-id="ed2e1-270">Dies ist die gleiche Dienst Schicht, die wir mit dem Contact Controller verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-270">This is the same service layer that we use with the Contact controller.</span></span>

<span data-ttu-id="ed2e1-271">Codebeispiel 10 enthält die neuen Methoden, die der ContactManager-Dienst Ebene hinzugefügt wurden, um das validieren, auflisten und Erstellen von Gruppen zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-271">Listing 10 contains the new methods added to the ContactManager service layer to support validating, listing, and creating groups.</span></span> <span data-ttu-id="ed2e1-272">Die icontactmanagerservice-Schnittstelle wurde so aktualisiert, dass Sie die neuen Methoden enthält.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-272">The IContactManagerService interface was updated to include the new methods.</span></span>

<span data-ttu-id="ed2e1-273">In der Liste 11 ist eine neue fakecontactmanagerrepository-Klasse enthalten, die die icontactmanagerrepository-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-273">Listing 11 contains a new FakeContactManagerRepository class that implements the IContactManagerRepository interface.</span></span> <span data-ttu-id="ed2e1-274">Anders als bei der entitycontactmanagerrepository-Klasse, die auch die icontactmanagerrepository-Schnittstelle implementiert, kommuniziert unsere neue fakecontactmanagerrepository-Klasse nicht mit der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-274">Unlike the EntityContactManagerRepository class that also implements the IContactManagerRepository interface, our new FakeContactManagerRepository class does not communicate with the database.</span></span> <span data-ttu-id="ed2e1-275">Die fakecontactmanagerrepository-Klasse verwendet eine Speicher interne Auflistung als Proxy für die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-275">The FakeContactManagerRepository class uses an in-memory collection as a proxy for the database.</span></span> <span data-ttu-id="ed2e1-276">Wir verwenden diese Klasse in den Komponententests als gefälschte Repository-Schicht.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-276">We'll use this class in our unit tests as a fake repository layer.</span></span>

<span data-ttu-id="ed2e1-277">**Codebeispiel 9-controllers\groupcontroller.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-277">**Listing 9 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample9.cs)]

<span data-ttu-id="ed2e1-278">**Auflisten von 10-controllers\contactmanagerservice.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-278">**Listing 10 - Controllers\ContactManagerService.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample10.cs)]

<span data-ttu-id="ed2e1-279">**Codebeispiel 11-controllers\fakecontactmanagerrepositor y.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-279">**Listing 11 - Controllers\FakeContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample11.cs)]

<span data-ttu-id="ed2e1-280">Das Ändern der icontactmanagerrepository-Schnittstelle erfordert, dass die Methoden "up Group ()" und "List Groups ()" in der entitycontactmanagerrepository-Klasse implementiert.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-280">Modifying the IContactManagerRepository interface requires use to implement the CreateGroup() and ListGroups() methods in the EntityContactManagerRepository class.</span></span> <span data-ttu-id="ed2e1-281">Die verzögert und schnellste Methode hierfür ist das Hinzufügen von Stub-Methoden, die wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-281">The laziest and fastest way to do this is to add stub methods that look like this:</span></span>   

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample12.cs)]

<span data-ttu-id="ed2e1-282">Zum Schluss erfordern diese Änderungen am Entwurf unserer Anwendung, dass wir einige Änderungen an den Komponententests vornehmen müssen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-282">Finally, these changes to the design of our application require us to make some modifications to our unit tests.</span></span> <span data-ttu-id="ed2e1-283">Beim Ausführen der Komponententests muss nun das fakecontactmanagerrepository-Objekt verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-283">We now need to use the FakeContactManagerRepository when performing the unit tests.</span></span> <span data-ttu-id="ed2e1-284">Die aktualisierte groupcontrollertest-Klasse ist in der Liste 12 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-284">The updated GroupControllerTest class is contained in Listing 12.</span></span>

<span data-ttu-id="ed2e1-285">**Auflistung 12-controllers\groupcontrollertest.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-285">**Listing 12 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample13.cs)]

<span data-ttu-id="ed2e1-286">Nachdem wir alle diese Änderungen vorgenommen haben, werden alle Komponententests bestanden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-286">After we make all of these changes, once again, all of our unit tests pass.</span></span> <span data-ttu-id="ed2e1-287">Wir haben den gesamten Kreis von rot/grün/Umgestaltung abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-287">We have completed the entire cycle of Red/Green/Refactor.</span></span> <span data-ttu-id="ed2e1-288">Wir haben die ersten zwei User Stories implementiert.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-288">We have implemented the first two user stories.</span></span> <span data-ttu-id="ed2e1-289">Wir verfügen nun über unterstützende Komponententests für die in den User Storys ausgedrückten Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-289">We now have supporting unit tests for the requirements expressed in the user stories.</span></span> <span data-ttu-id="ed2e1-290">Das Implementieren der restlichen Benutzer Textabschnitte umfasst das wiederholen desselben Zyklen von rot/grün/Umgestaltung.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-290">Implementing the remainder of the user stories involves repeating the same cycle of Red/Green/Refactor.</span></span>

## <a name="modifying-our-database"></a><span data-ttu-id="ed2e1-291">Ändern der Datenbank</span><span class="sxs-lookup"><span data-stu-id="ed2e1-291">Modifying our Database</span></span>

<span data-ttu-id="ed2e1-292">Leider ist unsere Arbeit nicht erledigt, obwohl wir alle Anforderungen erfüllt haben, die von unseren Komponententests ausgedrückt werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-292">Unfortunately, even though we have satisfied all of the requirements expressed by our unit tests, our work is not done.</span></span> <span data-ttu-id="ed2e1-293">Wir müssen weiterhin unsere Datenbank ändern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-293">We still need to modify our database.</span></span>

<span data-ttu-id="ed2e1-294">Wir müssen eine neue Gruppendaten Bank Tabelle erstellen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-294">We need to create a new Group database table.</span></span> <span data-ttu-id="ed2e1-295">Folgen Sie diesen Schritten:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-295">Follow these steps:</span></span>

1. <span data-ttu-id="ed2e1-296">Klicken Sie im Server-Explorer Fenster mit der rechten Maustaste auf den Ordner Tabellen, und wählen Sie die Menüoption **neue Tabelle hinzufügen**aus.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-296">In the Server Explorer window, right-click the Tables folder and select the menu option **Add New Table**.</span></span>
2. <span data-ttu-id="ed2e1-297">Geben Sie die beiden unten beschriebenen Spalten in der Tabellen-Designer ein.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-297">Enter the two columns described below in the Table Designer.</span></span>
3. <span data-ttu-id="ed2e1-298">Markieren Sie die ID-Spalte als Primärschlüssel und Identitäts Spalte.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-298">Mark the Id column as a primary key and Identity column.</span></span>
4. <span data-ttu-id="ed2e1-299">Speichern Sie die neue Tabelle mit den namens Gruppen, indem Sie auf das Symbol der Diskette klicken.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-299">Save the new table with the name Groups by clicking the icon of the floppy.</span></span>

<a id="0.11_table01"></a>

| <span data-ttu-id="ed2e1-300">**Spaltenname**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-300">**Column Name**</span></span> | <span data-ttu-id="ed2e1-301">**Datentyp**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-301">**Data Type**</span></span> | <span data-ttu-id="ed2e1-302">**NULL-Werte zulassen**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-302">**Allow Nulls**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="ed2e1-303">Id</span><span class="sxs-lookup"><span data-stu-id="ed2e1-303">Id</span></span> | <span data-ttu-id="ed2e1-304">int</span><span class="sxs-lookup"><span data-stu-id="ed2e1-304">int</span></span> | <span data-ttu-id="ed2e1-305">False</span><span class="sxs-lookup"><span data-stu-id="ed2e1-305">False</span></span> |
| <span data-ttu-id="ed2e1-306">Name</span><span class="sxs-lookup"><span data-stu-id="ed2e1-306">Name</span></span> | <span data-ttu-id="ed2e1-307">nvarchar(50)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-307">nvarchar(50)</span></span> | <span data-ttu-id="ed2e1-308">False</span><span class="sxs-lookup"><span data-stu-id="ed2e1-308">False</span></span> |

<span data-ttu-id="ed2e1-309">Als nächstes müssen wir alle Daten aus der Tabelle "Contacts" löschen (andernfalls können wir keine Beziehung zwischen den Tabellen "Contacts" und "Groups" erstellen).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-309">Next, we need to delete all of the data from the Contacts table (otherwise, we won't be able to create a relationship between the Contacts and Groups tables).</span></span> <span data-ttu-id="ed2e1-310">Folgen Sie diesen Schritten:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-310">Follow these steps:</span></span>

1. <span data-ttu-id="ed2e1-311">Klicken Sie mit der rechten Maustaste auf die Tabelle Kontakte, und wählen Sie die Menüoption **Tabellendaten anzeigen**aus.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-311">Right-click the Contacts table and select the menu option **Show Table Data**.</span></span>
2. <span data-ttu-id="ed2e1-312">Löschen Sie alle Zeilen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-312">Delete all of the rows.</span></span>

<span data-ttu-id="ed2e1-313">Als nächstes müssen wir eine Beziehung zwischen der Datenbanktabelle "Groups" und der vorhandenen Datenbanktabelle "Contacts" definieren.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-313">Next, we need to define a relationship between the Groups database table and the existing Contacts database table.</span></span> <span data-ttu-id="ed2e1-314">Folgen Sie diesen Schritten:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-314">Follow these steps:</span></span>

1. <span data-ttu-id="ed2e1-315">Doppelklicken Sie im Fenster Server-Explorer auf die Tabelle Kontakte, um die Tabellen-Designer zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-315">Double-click the Contacts table in the Server Explorer window to open the Table Designer.</span></span>
2. <span data-ttu-id="ed2e1-316">Fügen Sie der Tabelle Contacts eine neue ganzzahlige Spalte mit dem Namen GroupID hinzu.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-316">Add a new integer column to the Contacts table named GroupId.</span></span>
3. <span data-ttu-id="ed2e1-317">Klicken Sie auf die Schaltfläche Beziehung, um das Dialogfeld Fremdschlüssel Beziehungen zu öffnen (siehe Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-317">Click the Relationship button to open the Foreign Key Relationships dialog (see Figure 3).</span></span>
4. <span data-ttu-id="ed2e1-318">Klicken Sie auf die Schaltfläche Add.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-318">Click the Add button.</span></span>
5. <span data-ttu-id="ed2e1-319">Klicken Sie auf die Schaltfläche mit den Auslassungs Punkten neben der Schaltfläche Tabellen-und Spaltenspezifikation.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-319">Click the ellipsis button that appears next to the Table and Columns Specification button.</span></span>
6. <span data-ttu-id="ed2e1-320">Wählen Sie im Dialogfeld Tabellen und Spalten die Option Gruppen als Primärschlüssel Tabelle und ID als Primärschlüssel Spalte aus.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-320">In the Tables and Columns dialog, select Groups as the primary key table and Id as the primary key column.</span></span> <span data-ttu-id="ed2e1-321">Wählen Sie Kontakte als Fremdschlüssel Tabelle und GroupID als Fremdschlüssel Spalte aus (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-321">Select Contacts as the foreign key table and GroupId as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="ed2e1-322">Klicken Sie auf die Schaltfläche "OK".</span><span class="sxs-lookup"><span data-stu-id="ed2e1-322">Click the OK button.</span></span>
7. <span data-ttu-id="ed2e1-323">Wählen Sie unter **INSERT-und Update-Spezifikation**den Wert **Cascade** for **Delete Rule**aus.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-323">Under **INSERT and UPDATE Specification**, select the value **Cascade** for **Delete Rule**.</span></span>
8. <span data-ttu-id="ed2e1-324">Klicken Sie auf die Schaltfläche Schließen, um das Dialogfeld Fremdschlüssel Beziehungen zu schließen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-324">Click the Close button to close the Foreign Key Relationships dialog.</span></span>
9. <span data-ttu-id="ed2e1-325">Klicken Sie auf die Schaltfläche speichern, um die Änderungen in der Tabelle Kontakte zu speichern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-325">Click the Save button to save the changes to the Contacts table.</span></span>

<span data-ttu-id="ed2e1-326">[![Erstellen einer Datenbanktabellen Beziehung](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-326">[![Creating a database table relationship](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span></span>

<span data-ttu-id="ed2e1-327">**Abbildung 03**: Erstellen einer Datenbanktabellen Beziehung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-327">**Figure 03**: Creating a database table relationship ([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image6.png))</span></span>

<span data-ttu-id="ed2e1-328">[![angeben von Tabellen Beziehungen](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-328">[![Specifying table relationships](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span></span>

<span data-ttu-id="ed2e1-329">**Abbildung 04**: Angeben von Tabellen Beziehungen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-329">**Figure 04**: Specifying table relationships([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image8.png))</span></span>

### <a name="updating-our-data-model"></a><span data-ttu-id="ed2e1-330">Aktualisieren des Datenmodells</span><span class="sxs-lookup"><span data-stu-id="ed2e1-330">Updating our Data Model</span></span>

<span data-ttu-id="ed2e1-331">Als nächstes müssen wir das Datenmodell aktualisieren, um die neue Datenbanktabelle darzustellen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-331">Next, we need to update our data model to represent the new database table.</span></span> <span data-ttu-id="ed2e1-332">Folgen Sie diesen Schritten:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-332">Follow these steps:</span></span>

1. <span data-ttu-id="ed2e1-333">Doppelklicken Sie im Ordner Models auf die Datei contactmanagermodel. edmx, um die Entity Designer zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-333">Double-click the ContactManagerModel.edmx file in the Models folder to open the Entity Designer.</span></span>
2. <span data-ttu-id="ed2e1-334">Klicken Sie mit der rechten Maustaste auf die Designer Oberfläche, und wählen Sie die Menüoption **Modell aus Datenbank aktualisieren aus**.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-334">Right-click the Designer surface and select the menu option **Update Model from Database**.</span></span>
3. <span data-ttu-id="ed2e1-335">Wählen Sie im Update-Assistenten die Tabelle Gruppen aus, und klicken Sie auf die Schaltfläche Fertigstellen (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-335">In the Update Wizard, select the Groups table and click the Finish button (see Figure 5).</span></span>
4. <span data-ttu-id="ed2e1-336">Klicken Sie mit der rechten Maustaste auf die Entität Gruppen, und wählen Sie die Option **Umbenennen**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-336">Right-click the Groups entity and select the menu option **Rename**.</span></span> <span data-ttu-id="ed2e1-337">Ändern Sie den Namen der *Groups* -Entität in *Group* (Singular).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-337">Change the name of the *Groups* entity to *Group* (singular).</span></span>
5. <span data-ttu-id="ed2e1-338">Klicken Sie mit der rechten Maustaste auf die Gruppen Navigations Eigenschaft, die unten in der Entität "Contact" angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-338">Right-click the Groups navigation property that appears at the bottom of the Contact entity.</span></span> <span data-ttu-id="ed2e1-339">Ändern Sie den Namen der *Gruppen* Navigations Eigenschaft in *Group* (Singular).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-339">Change the name of the *Groups* navigation property to *Group* (singular).</span></span>

<span data-ttu-id="ed2e1-340">[![Aktualisieren eines Entity Framework Modells aus der Datenbank](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-340">[![Updating an Entity Framework model from the database](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span></span>

<span data-ttu-id="ed2e1-341">**Abbildung 05**: Aktualisieren eines Entity Framework Modells aus der Datenbank ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-341">**Figure 05**: Updating an Entity Framework model from the database([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image10.png))</span></span>

<span data-ttu-id="ed2e1-342">Nachdem Sie diese Schritte ausgeführt haben, stellt das Datenmodell die Tabellen "Contacts" und "Groups" dar.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-342">After you complete these steps, your data model will represent both the Contacts and Groups tables.</span></span> <span data-ttu-id="ed2e1-343">Die Entity Designer sollte beide Entitäten anzeigen (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="ed2e1-343">The Entity Designer should show both entities (see Figure 6).</span></span>

<span data-ttu-id="ed2e1-344">[![Entity Designer anzeigen von Gruppe und Kontakt](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-344">[![Entity Designer displaying Group and Contact](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span></span>

<span data-ttu-id="ed2e1-345">**Abbildung 06**: Entity Designer anzeigen von Gruppe und Kontakt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-345">**Figure 06**: Entity Designer displaying Group and Contact([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image12.png))</span></span>

### <a name="creating-our-repository-classes"></a><span data-ttu-id="ed2e1-346">Erstellen der Repository-Klassen</span><span class="sxs-lookup"><span data-stu-id="ed2e1-346">Creating our Repository Classes</span></span>

<span data-ttu-id="ed2e1-347">Als nächstes müssen wir unsere Repository-Klasse implementieren.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-347">Next, we need to implement our repository class.</span></span> <span data-ttu-id="ed2e1-348">Im Verlauf dieser Iterationen haben wir der icontactmanagerrepository-Schnittstelle mehrere neue Methoden hinzugefügt, während wir Code schreiben, um die Komponententests zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-348">Over the course of this iteration, we added several new methods to the IContactManagerRepository interface while writing code to satisfy our unit tests.</span></span> <span data-ttu-id="ed2e1-349">Die endgültige Version der icontactmanagerrepository-Schnittstelle ist in der Liste 14 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-349">The final version of the IContactManagerRepository interface is contained in Listing 14.</span></span>

<span data-ttu-id="ed2e1-350">**Codebeispiel 14: models\icontactmanagerrepositoriy.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-350">**Listing 14 - Models\IContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample14.cs)]

<span data-ttu-id="ed2e1-351">Wir haben noch keine der Methoden implementiert, die sich auf die Arbeit mit Kontaktgruppen beziehen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-351">We haven't actually implemented any of the methods related to working with contact groups.</span></span> <span data-ttu-id="ed2e1-352">Derzeit verfügt die entitycontactmanagerrepository-Klasse über Stubmethoden für jede der Kontaktgruppen Methoden, die in der icontactmanagerrepository-Schnittstelle aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-352">Currently, the EntityContactManagerRepository class has stub methods for each of the contact group methods listed in the IContactManagerRepository interface.</span></span> <span data-ttu-id="ed2e1-353">Beispielsweise sieht die ListGroups ()-Methode zurzeit wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-353">For example, the ListGroups() method currently looks like this:</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample15.cs)]

<span data-ttu-id="ed2e1-354">Mit den Stub-Methoden konnten wir unsere Anwendung kompilieren und die Komponententests durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-354">The stub methods enabled us to compile our application and pass the unit tests.</span></span> <span data-ttu-id="ed2e1-355">Jetzt ist es aber an der Zeit, diese Methoden tatsächlich zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-355">However, now it is time to actually implement these methods.</span></span> <span data-ttu-id="ed2e1-356">Die endgültige Version der entitycontactmanagerrepository-Klasse ist in der Liste 13 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-356">The final version of the EntityContactManagerRepository class is contained in Listing 13.</span></span>

<span data-ttu-id="ed2e1-357">**Auflisten 13-models\entitycontactmanagerrepositor y.cs**</span><span class="sxs-lookup"><span data-stu-id="ed2e1-357">**Listing 13 - Models\EntityContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample16.cs)]

### <a name="creating-the-views"></a><span data-ttu-id="ed2e1-358">Erstellen der Sichten</span><span class="sxs-lookup"><span data-stu-id="ed2e1-358">Creating the Views</span></span>

<span data-ttu-id="ed2e1-359">ASP.NET MVC-Anwendung, wenn Sie die standardmäßige ASP.net-Ansichts-Engine verwenden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-359">ASP.NET MVC application when you use the default ASP.NET view engine.</span></span> <span data-ttu-id="ed2e1-360">Daher erstellen Sie keine Sichten als Reaktion auf einen bestimmten Komponenten Test.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-360">So, you don t create views in response to a particular unit test.</span></span> <span data-ttu-id="ed2e1-361">Da eine Anwendung jedoch ohne Ansichten nutzlos wäre, können wir diese Iterations Iterationen nicht durchführen, ohne die in der Contact Manager-Anwendung enthaltenen Sichten zu erstellen und zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-361">However, because an application would be useless without views, we can t complete this iteration without creating and modifying the views contained in the Contact Manager application.</span></span>

<span data-ttu-id="ed2e1-362">Zum Verwalten von Kontaktgruppen müssen die folgenden neuen Ansichten erstellt werden (siehe Abbildung 7):</span><span class="sxs-lookup"><span data-stu-id="ed2e1-362">We need to create the following new views for managing contact groups (see Figure 7):</span></span>

- <span data-ttu-id="ed2e1-363">Views\group\index.aspx-zeigt die Liste der Kontaktgruppen an</span><span class="sxs-lookup"><span data-stu-id="ed2e1-363">Views\Group\Index.aspx - Displays list of contact groups</span></span>
- <span data-ttu-id="ed2e1-364">Views\group\delete.aspx-zeigt das Bestätigungsformular zum Löschen einer Kontaktgruppe an</span><span class="sxs-lookup"><span data-stu-id="ed2e1-364">Views\Group\Delete.aspx - Displays confirmation form for deleting a contact group</span></span>

<span data-ttu-id="ed2e1-365">[![der Gruppen Index Ansicht](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-365">[![The Group Index view](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span></span>

<span data-ttu-id="ed2e1-366">**Abbildung 07**: Ansicht "Gruppen Index" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-366">**Figure 07**: The Group Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image14.png))</span></span>

<span data-ttu-id="ed2e1-367">Wir müssen die folgenden vorhandenen Ansichten so ändern, dass Sie Kontaktgruppen enthalten:</span><span class="sxs-lookup"><span data-stu-id="ed2e1-367">We need to modify the following existing views so that they include contact groups:</span></span>

- <span data-ttu-id="ed2e1-368">Views\home\kreate.aspx</span><span class="sxs-lookup"><span data-stu-id="ed2e1-368">Views\Home\Create.aspx</span></span>
- <span data-ttu-id="ed2e1-369">Views\home\edit.aspx</span><span class="sxs-lookup"><span data-stu-id="ed2e1-369">Views\Home\Edit.aspx</span></span>
- <span data-ttu-id="ed2e1-370">Views\home\index.aspx</span><span class="sxs-lookup"><span data-stu-id="ed2e1-370">Views\Home\Index.aspx</span></span>

<span data-ttu-id="ed2e1-371">Die geänderten Ansichten sehen Sie sich die Visual Studio-Anwendung an, die dieses Tutorial begleitet.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-371">You can see the modified views by looking at the Visual Studio application that accompanies this tutorial.</span></span> <span data-ttu-id="ed2e1-372">Abbildung 8 veranschaulicht z. b. die Kontakt Index Sicht.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-372">For example, Figure 8 illustrates the Contact Index view.</span></span>

<span data-ttu-id="ed2e1-373">[![der Ansicht "Kontakt index"](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-373">[![The Contact Index view](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span></span>

<span data-ttu-id="ed2e1-374">**Abbildung 08**: Ansicht "Kontakt index" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](iteration-6-use-test-driven-development-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="ed2e1-374">**Figure 08**: The Contact Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ed2e1-375">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="ed2e1-375">Summary</span></span>

<span data-ttu-id="ed2e1-376">In dieser Iterationen haben wir unserer Contact Manager-Anwendung neue Funktionen hinzugefügt, indem wir eine Test gesteuerte Entwicklungsmethode für Entwicklungsanwendungen befolgen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-376">In this iteration, we added new functionality to our Contact Manager application by following a test-driven development application design methodology.</span></span> <span data-ttu-id="ed2e1-377">Wir haben mit der Erstellung eines Satzes von User Stories begonnen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-377">We started by creating a set of user stories.</span></span> <span data-ttu-id="ed2e1-378">Wir haben eine Reihe von Komponententests erstellt, die den Anforderungen entsprechen, die von den User Storys ausgedrückt werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-378">We created a set of unit tests that corresponds to the requirements expressed by the user stories.</span></span> <span data-ttu-id="ed2e1-379">Schließlich haben wir gerade genug Code geschrieben, um die Anforderungen zu erfüllen, die von den Komponententests ausgedrückt werden.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-379">Finally, we wrote just enough code to satisfy the requirements expressed by the unit tests.</span></span>

<span data-ttu-id="ed2e1-380">Nachdem das Schreiben von ausreichendem Code abgeschlossen wurde, um die von den Komponententests ausgedrückten Anforderungen zu erfüllen, haben wir unsere Datenbank und Sichten aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-380">After we finished writing enough code to satisfy the requirements expressed by the unit tests, we updated our database and views.</span></span> <span data-ttu-id="ed2e1-381">Wir haben unserer Datenbank eine neue Gruppentabelle hinzugefügt und unser Entity Framework Datenmodell aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-381">We added a new Groups table to our database and updated our Entity Framework Data Model.</span></span> <span data-ttu-id="ed2e1-382">Außerdem haben wir einen Satz von Sichten erstellt und geändert.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-382">We also created and modified a set of views.</span></span>

<span data-ttu-id="ed2e1-383">In der nächsten Iterations--der abschließenden Iterations-wird die Anwendung neu geschrieben, um AJAX zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-383">In the next iteration -- the final iteration -- we rewrite our application to take advantage of Ajax.</span></span> <span data-ttu-id="ed2e1-384">Durch die Nutzung von AJAX verbessern wir die Reaktionsfähigkeit und Leistung der Kontakt-Manager-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ed2e1-384">By taking advantage of Ajax, we'll improve the responsiveness and performance of the Contact Manager application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ed2e1-385">[Zurück](iteration-5-create-unit-tests-cs.md)
> [Weiter](iteration-7-add-ajax-functionality-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ed2e1-385">[Previous](iteration-5-create-unit-tests-cs.md)
[Next](iteration-7-add-ajax-functionality-cs.md)</span></span>
