---
uid: mvc/overview/older-versions-1/contact-manager/iteration-7-add-ajax-functionality-cs
title: 'Iteration #7 – Hinzufügen von Ajax-Funktionalität (C) | Microsoft Docs'
author: rick-anderson
description: In der siebten Iteration verbessern wir die Reaktionsfähigkeit und Leistung unserer Anwendung, indem wir Unterstützung für Ajax hinzufügen.
ms.author: riande
ms.date: 02/20/2009
ms.assetid: f1b0809e-8909-444e-b6bb-a5cd1dea3f72
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-7-add-ajax-functionality-cs
msc.type: authoredcontent
ms.openlocfilehash: 12d7348382bc55af049567922bd6963970a9421b
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542312"
---
# <a name="iteration-7--add-ajax-functionality-c"></a><span data-ttu-id="ec8e6-103">Iteration 7 – Hinzufügen von AJAX-Funktionen (C#)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-103">Iteration #7 – Add Ajax functionality (C#)</span></span>

<span data-ttu-id="ec8e6-104">von [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="ec8e6-105">Code herunterladen</span><span class="sxs-lookup"><span data-stu-id="ec8e6-105">Download Code</span></span>](iteration-7-add-ajax-functionality-cs/_static/contactmanager_7_cs1.zip)

> <span data-ttu-id="ec8e6-106">In der siebten Iteration verbessern wir die Reaktionsfähigkeit und Leistung unserer Anwendung, indem wir Unterstützung für Ajax hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-106">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="ec8e6-107">Erstellen einer Kontaktverwaltungs-ASP.NET MVC-Anwendung (C-Anwendung)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-107">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="ec8e6-108">In dieser Reihe von Tutorials erstellen wir eine gesamte Contact Management-Anwendung von Anfang bis Ende.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-108">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="ec8e6-109">Mit der Kontakt-Manager-Anwendung können Sie Kontaktinformationen - Namen, Telefonnummern und E-Mail-Adressen - für eine Personenliste speichern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-109">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="ec8e6-110">Wir erstellen die Anwendung über mehrere Iterationen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-110">We build the application over multiple iterations.</span></span> <span data-ttu-id="ec8e6-111">Mit jeder Iteration verbessern wir die Anwendung schrittweise.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-111">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="ec8e6-112">Das Ziel dieses Ansatzes mit mehreren Iterationen besteht darin, den Grund für jede Änderung zu verstehen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-112">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="ec8e6-113">Iteration #1 - Erstellen Sie die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-113">Iteration #1 - Create the application.</span></span> <span data-ttu-id="ec8e6-114">In der ersten Iteration erstellen wir den Contact Manager auf einfachste Weise.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-114">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="ec8e6-115">Wir fügen Unterstützung für grundlegende Datenbankvorgänge hinzu: Erstellen, Lesen, Aktualisieren und Löschen (CRUD).</span><span class="sxs-lookup"><span data-stu-id="ec8e6-115">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="ec8e6-116">Iteration #2 - Machen Sie die Anwendung schön aussehen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-116">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="ec8e6-117">In dieser Iteration verbessern wir das Erscheinungsbild der Anwendung, indem wir die Standard-ASP.NET MVC-Ansichtsmasterseite und des kaskadierenden Stylesheets ändern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-117">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="ec8e6-118">Iteration #3 - Formularüberprüfung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-118">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="ec8e6-119">In der dritten Iteration fügen wir eine grundlegende Formularvalidierung hinzu.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-119">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="ec8e6-120">Wir verhindern, dass Personen ein Formular einreichen, ohne die erforderlichen Formularfelder ausfüllen zu müssen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-120">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="ec8e6-121">Wir validieren auch E-Mail-Adressen und Telefonnummern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-121">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="ec8e6-122">Iteration #4 - Machen Sie die Anwendung lose gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-122">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="ec8e6-123">In dieser vierten Iteration nutzen wir mehrere Softwareentwurfsmuster, um die Wartung und Änderung der Contact Manager-Anwendung zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-123">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="ec8e6-124">Beispielsweise gestalten wir unsere Anwendung so um, dass sie das Repository-Muster und das Abhängigkeitsinjektionsmuster verwendet.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-124">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="ec8e6-125">Iteration #5 - Erstellen von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-125">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="ec8e6-126">In der fünften Iteration erleichtern wir die Wartung und Änderung unserer Anwendung durch Hinzufügen von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-126">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="ec8e6-127">Wir verspotten unsere Datenmodellklassen und erstellen Komponententests für unsere Controller und Validierungslogik.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-127">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="ec8e6-128">Iteration #6 - Verwenden Sie die testgesteuerte Entwicklung.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-128">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="ec8e6-129">In dieser sechsten Iteration fügen wir unserer Anwendung neue Funktionen hinzu, indem wir zuerst Komponententests schreiben und Code für die Komponententests schreiben.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-129">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="ec8e6-130">In dieser Iteration fügen wir Kontaktgruppen hinzu.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-130">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="ec8e6-131">Iteration #7 - Ajax-Funktionalität hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-131">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="ec8e6-132">In der siebten Iteration verbessern wir die Reaktionsfähigkeit und Leistung unserer Anwendung, indem wir Unterstützung für Ajax hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-132">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="ec8e6-133">Diese Iteration</span><span class="sxs-lookup"><span data-stu-id="ec8e6-133">This Iteration</span></span>

<span data-ttu-id="ec8e6-134">In dieser Iteration der Contact Manager-Anwendung gestalten wir unsere Anwendung um, um Ajax zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-134">In this iteration of the Contact Manager application, we refactor our application to make use of Ajax.</span></span> <span data-ttu-id="ec8e6-135">Indem wir Die Vorteile von Ajax nutzen, machen wir unsere Anwendung reaktionsschneller.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-135">By taking advantage of Ajax, we make our application more responsive.</span></span> <span data-ttu-id="ec8e6-136">Wir können das Rendern einer ganzen Seite vermeiden, wenn wir nur eine bestimmte Region in einer Seite aktualisieren müssen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-136">We can avoid rendering an entire page when we need to update only a certain region in a page.</span></span>

<span data-ttu-id="ec8e6-137">Wir gestalten unsere Indexansicht so um, dass wir nicht die gesamte Seite neu anzeigen müssen, wenn jemand eine neue Kontaktgruppe auswählt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-137">We'll refactor our Index view so that we don t need to redisplay the entire page whenever someone selects a new contact group.</span></span> <span data-ttu-id="ec8e6-138">Wenn jemand stattdessen auf eine Kontaktgruppe klickt, aktualisieren wir einfach die Liste der Kontakte und lassen den Rest der Seite in Ruhe.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-138">Instead, when someone clicks a contact group, we'll just update the list of contacts and leave the rest of the page alone.</span></span>

<span data-ttu-id="ec8e6-139">Wir ändern auch die Funktionsweise unseres Löschlinks.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-139">We'll also change the way our delete link works.</span></span> <span data-ttu-id="ec8e6-140">Anstatt eine separate Bestätigungsseite anzuzeigen, wird ein JavaScript-Bestätigungsdialogfeld angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-140">Instead of displaying a separate confirmation page, we'll display a JavaScript confirmation dialog.</span></span> <span data-ttu-id="ec8e6-141">Wenn Sie bestätigen, dass Sie einen Kontakt löschen möchten, wird ein HTTP DELETE-Vorgang für den Server ausgeführt, um den Kontaktdatensatz aus der Datenbank zu löschen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-141">If you confirm that you want to delete a contact, an HTTP DELETE operation is performed against the server to delete the contact record from the database.</span></span>

<span data-ttu-id="ec8e6-142">Darüber hinaus nutzen wir jQuery, um Unserer Indexansicht Animationseffekte hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-142">Furthermore, we will take advantage of jQuery to add animation effects to our Index view.</span></span> <span data-ttu-id="ec8e6-143">Wir zeigen eine Animation an, wenn die neue Liste der Kontakte vom Server abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-143">We'll display an animation when the new list of contacts is being fetched from the server.</span></span>

<span data-ttu-id="ec8e6-144">Schließlich nutzen wir die ASP.NET AJAX-Frameworkunterstützung für die Verwaltung des Browserverlaufs.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-144">Finally, we'll take advantage of the ASP.NET AJAX framework support for managing browser history.</span></span> <span data-ttu-id="ec8e6-145">Wir erstellen Verlaufspunkte, wenn wir einen Ajax-Aufruf durchführen, um die Kontaktliste zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-145">We'll create history points whenever we perform an Ajax call to update the contact list.</span></span> <span data-ttu-id="ec8e6-146">Auf diese Weise funktioniert der Browser rückwärts und vorwärts Tasten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-146">That way, the browser backward and forward buttons will work.</span></span>

## <a name="why-use-ajax"></a><span data-ttu-id="ec8e6-147">Warum Ajax?</span><span class="sxs-lookup"><span data-stu-id="ec8e6-147">Why use Ajax?</span></span>

<span data-ttu-id="ec8e6-148">Die Verwendung von Ajax hat viele Vorteile.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-148">Using Ajax has many benefits.</span></span> <span data-ttu-id="ec8e6-149">Erstens führt das Hinzufügen von Ajax-Funktionalität zu einer Anwendung zu einer besseren Benutzererfahrung.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-149">First, adding Ajax functionality to an application results in a better user experience.</span></span> <span data-ttu-id="ec8e6-150">In einer normalen Webanwendung muss die gesamte Seite jedes Mal, wenn ein Benutzer eine Aktion ausführt, an den Server zurückgesendet werden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-150">In a normal web application, the entire page must be posted back to the server each and every time a user performs an action.</span></span> <span data-ttu-id="ec8e6-151">Wenn Sie eine Aktion ausführen, wird der Browser gesperrt und der Benutzer muss warten, bis die gesamte Seite abgerufen und erneut angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-151">Whenever you perform an action, the browser locks and the user must wait until the entire page is fetched and redisplayed.</span></span>

<span data-ttu-id="ec8e6-152">Dies wäre eine inakzeptable Erfahrung im Falle einer Desktop-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-152">This would be an unacceptable experience in the case of a desktop application.</span></span> <span data-ttu-id="ec8e6-153">Aber traditionell lebten wir mit dieser schlechten Benutzererfahrung im Falle einer Webanwendung, weil wir nicht wussten, dass wir es besser machen könnten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-153">But, traditionally, we lived with this bad user experience in the case of a web application because we did not know that we could do any better.</span></span> <span data-ttu-id="ec8e6-154">Wir dachten, es sei eine Einschränkung von Web-Anwendungen, wenn es in Wirklichkeit nur eine Einschränkung unserer Vorstellungskraft war.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-154">We thought it was a limitation of web applications when, in actuality, it was just a limitation of our imaginations.</span></span>

<span data-ttu-id="ec8e6-155">In einer Ajax-Anwendung müssen Sie die Benutzererfahrung nicht zum Stillstand bringen, nur um eine Seite zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-155">In an Ajax application, you don t need to bring the user experience to a halt just to update a page.</span></span> <span data-ttu-id="ec8e6-156">Stattdessen können Sie eine asynchrone Anforderung im Hintergrund ausführen, um die Seite zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-156">Instead, you can perform an asynchronous request in the background to update the page.</span></span> <span data-ttu-id="ec8e6-157">Sie zwingen den Benutzer nicht zu warten, während ein Teil der Seite aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-157">You don t force the user to wait while part of the page gets updated.</span></span>

<span data-ttu-id="ec8e6-158">Durch die Nutzung von Ajax können Sie auch die Leistung Ihrer Anwendung verbessern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-158">By taking advantage of Ajax, you also can improve the performance of your application.</span></span> <span data-ttu-id="ec8e6-159">Überlegen Sie, wie die Contact Manager-Anwendung derzeit ohne Ajax-Funktionalität funktioniert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-159">Consider how the Contact Manager application works right now without Ajax functionality.</span></span> <span data-ttu-id="ec8e6-160">Wenn Sie auf eine Kontaktgruppe klicken, muss die gesamte Indexansicht erneut angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-160">When you click a contact group, the entire Index view must be redisplayed.</span></span> <span data-ttu-id="ec8e6-161">Die Liste der Kontakte und die Liste der Kontaktgruppen müssen vom Datenbankserver abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-161">The list of contacts and list of contact groups must be retrieved from the database server.</span></span> <span data-ttu-id="ec8e6-162">Alle diese Daten müssen über das Kabel vom Webserver an den Webbrowser weitergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-162">All of this data must be passed across the wire from web server to web browser.</span></span>

<span data-ttu-id="ec8e6-163">Nachdem wir unserer Anwendung Ajax-Funktionalität hinzugefügt haben, können wir jedoch vermeiden, dass die gesamte Seite erneut angezeigt wird, wenn ein Benutzer auf eine Kontaktgruppe klickt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-163">After we add Ajax functionality to our application, however, we can avoid redisplaying the entire page when a user clicks a contact group.</span></span> <span data-ttu-id="ec8e6-164">Wir müssen die Kontaktgruppen nicht mehr aus der Datenbank holen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-164">We no longer need to grab the contact groups from the database.</span></span> <span data-ttu-id="ec8e6-165">Wir müssen auch nicht die gesamte Indexansicht über den Draht schieben.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-165">We also don t need to push the entire Index view across the wire.</span></span> <span data-ttu-id="ec8e6-166">Durch die Nutzung von Ajax reduzieren wir die Arbeit, die unser Datenbankserver leisten muss, und wir reduzieren den Netzwerkverkehr, der von unserer Anwendung benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-166">By taking advantage of Ajax, we reduce the amount of work that our database server must perform and we reduce the amount of network traffic required by our application.</span></span>

## <a name="don-t-be-afraid-of-ajax"></a><span data-ttu-id="ec8e6-167">Keine Angst vor Ajax</span><span class="sxs-lookup"><span data-stu-id="ec8e6-167">Don t be Afraid of Ajax</span></span>

<span data-ttu-id="ec8e6-168">Einige Entwickler vermeiden die Verwendung von Ajax, weil sie sich Sorgen um Downlevel-Browser machen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-168">Some developers avoid using Ajax because they worry about downlevel browsers.</span></span> <span data-ttu-id="ec8e6-169">Sie möchten sicherstellen, dass ihre Webanwendungen weiterhin funktionieren, wenn sie von einem Browser aufgerufen werden, der JavaScript nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-169">They want to make sure that their web applications will still work when accessed by a browser that does not support JavaScript.</span></span> <span data-ttu-id="ec8e6-170">Da Ajax auf JavaScript angewiesen ist, vermeiden einige Entwickler die Verwendung von Ajax.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-170">Because Ajax depends on JavaScript, some developers avoid using Ajax.</span></span>

<span data-ttu-id="ec8e6-171">Wenn Sie jedoch darauf achten, wie Sie Ajax implementieren, können Sie Anwendungen erstellen, die sowohl mit Uplevel- als auch mit Downlevel-Browsern funktionieren.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-171">However, if you are careful about how you implement Ajax then you can build applications that work with both uplevel and downlevel browsers.</span></span> <span data-ttu-id="ec8e6-172">Unsere Contact Manager-Anwendung funktioniert mit Browsern, die JavaScript unterstützen, und Browsern, die dies nicht tun.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-172">Our Contact Manager application will work with browsers that support JavaScript and browsers that do not.</span></span>

<span data-ttu-id="ec8e6-173">Wenn Sie die Contact Manager-Anwendung mit einem Browser verwenden, der JavaScript unterstützt, haben Sie eine bessere Benutzererfahrung.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-173">If you use the Contact Manager application with a browser that supports JavaScript then you will have a better user experience.</span></span> <span data-ttu-id="ec8e6-174">Wenn Sie beispielsweise auf eine Kontaktgruppe klicken, wird nur der Bereich der Seite aktualisiert, auf der Kontakte angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-174">For example, when you click a contact group, only the region of the page that displays contacts will be updated.</span></span>

<span data-ttu-id="ec8e6-175">Wenn Sie hingegen die Contact Manager-Anwendung mit einem Browser verwenden, der JavaScript nicht unterstützt (oder JavaScript deaktiviert hat), haben Sie eine etwas weniger wünschenswerte Benutzererfahrung.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-175">If, on the other hand, you use the Contact Manager application with a browser that does not support JavaScript (or that has JavaScript disabled) then you will have a slightly less desirable user experience.</span></span> <span data-ttu-id="ec8e6-176">Wenn Sie beispielsweise auf eine Kontaktgruppe klicken, muss die gesamte Indexansicht wieder an den Browser gesendet werden, um die entsprechende Kontaktliste anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-176">For example, when you click a contact group, the entire Index view must be posted back to the browser in order to display the matching list of contacts.</span></span>

## <a name="adding-the-required-javascript-files"></a><span data-ttu-id="ec8e6-177">Hinzufügen der erforderlichen JavaScript-Dateien</span><span class="sxs-lookup"><span data-stu-id="ec8e6-177">Adding the Required JavaScript Files</span></span>

<span data-ttu-id="ec8e6-178">Wir müssen drei JavaScript-Dateien verwenden, um Ajax-Funktionalität zu unserer Anwendung hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-178">We'll need to use three JavaScript files to add Ajax functionality to our application.</span></span> <span data-ttu-id="ec8e6-179">Alle drei Dateien sind im Ordner Scripts einer neuen ASP.NET MVC-Anwendung enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-179">All three of these files are included in the Scripts folder of a new ASP.NET MVC application.</span></span>

<span data-ttu-id="ec8e6-180">Wenn Sie Ajax auf mehreren Seiten in Ihrer Anwendung verwenden möchten, ist es sinnvoll, die erforderlichen JavaScript-Dateien in die Masterseite Ihrer Anwendung aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-180">If you plan to use Ajax in multiple pages in your application then it makes sense to include the required JavaScript files in your application s view master page.</span></span> <span data-ttu-id="ec8e6-181">Auf diese Weise werden die JavaScript-Dateien automatisch in allen Seiten Ihrer Anwendung enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-181">That way, the JavaScript files will be included in all of the pages in your application automatically.</span></span>

<span data-ttu-id="ec8e6-182">Fügen Sie das folgende &lt;JavaScript im Head-Tag&gt; Ihrer Ansichtmasterseite hinzu:</span><span class="sxs-lookup"><span data-stu-id="ec8e6-182">Add the following JavaScript includes inside the &lt;head&gt; tag of your view master page:</span></span>

[!code-html[Main](iteration-7-add-ajax-functionality-cs/samples/sample1.html)]

## <a name="refactoring-the-index-view-to-use-ajax"></a><span data-ttu-id="ec8e6-183">Umgestaltung der Indexansicht für die Verwendung von Ajax</span><span class="sxs-lookup"><span data-stu-id="ec8e6-183">Refactoring the Index View to use Ajax</span></span>

<span data-ttu-id="ec8e6-184">Beginnen wir, indem wir unsere Indexansicht so ändern, dass durch Klicken auf eine Kontaktgruppe nur der Bereich der Ansicht aktualisiert wird, in der Kontakte angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-184">Let s start by modifying our Index view so that clicking a contact group only updates the region of the view that displays contacts.</span></span> <span data-ttu-id="ec8e6-185">Das rote Feld in Abbildung 1 enthält die Region, die wir aktualisieren möchten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-185">The red box in Figure 1 contains the region that we want to update.</span></span>

<span data-ttu-id="ec8e6-186">[![Nur Kontakte aktualisieren](iteration-7-add-ajax-functionality-cs/_static/image1.jpg)](iteration-7-add-ajax-functionality-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-186">[![Updating only contacts](iteration-7-add-ajax-functionality-cs/_static/image1.jpg)](iteration-7-add-ajax-functionality-cs/_static/image1.png)</span></span>

<span data-ttu-id="ec8e6-187">**Abbildung 01**: Aktualisieren nur Kontakte ([Klicken Sie hier, um das Bild in voller Größe anzuzeigen](iteration-7-add-ajax-functionality-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="ec8e6-187">**Figure 01**: Updating only contacts([Click to view full-size image](iteration-7-add-ajax-functionality-cs/_static/image2.png))</span></span>

<span data-ttu-id="ec8e6-188">Der erste Schritt besteht darin, den Teil der Ansicht, den wir asynchron aktualisieren möchten, in einen separaten Teil (Benutzersteuerelement anzeigen) zu trennen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-188">The first step is to separate the part of the view that we want to update asynchronously into a separate partial (view user control).</span></span> <span data-ttu-id="ec8e6-189">Der Abschnitt der Indexansicht, in dem die Kontakttabelle angezeigt wird, wurde in die Teilliste in Liste 1 verschoben.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-189">The section of the Index view that displays the table of contacts has been moved into the partial in Listing 1.</span></span>

<span data-ttu-id="ec8e6-190">**Auflisten 1 - Ansichten- Kontakt-Kontaktliste.ascx**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-190">**Listing 1 - Views\Contact\ContactList.ascx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample2.aspx)]

<span data-ttu-id="ec8e6-191">Beachten Sie, dass der Teil in Listing 1 ein anderes Modell als die Indexansicht hat.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-191">Notice that the partial in Listing 1 has a different model than the Index view.</span></span> <span data-ttu-id="ec8e6-192">Das *Inherits-Attribut* in &lt;der&gt; Direktive "%" Seite % gibt&lt;an, dass der Teil von der ViewUserControl Group-Klasse&gt; erbt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-192">The *Inherits* attribute in the &lt;%@ Page %&gt; directive specifies that the partial inherits from the ViewUserControl&lt;Group&gt; class.</span></span>

<span data-ttu-id="ec8e6-193">Die aktualisierte Indexansicht ist in Liste 2 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-193">The updated Index view is contained in Listing 2.</span></span>

<span data-ttu-id="ec8e6-194">**Eintrag 2 - Ansichten, Kontakt, Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-194">**Listing 2 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample3.aspx)]

<span data-ttu-id="ec8e6-195">Es gibt zwei Dinge, die Sie über die aktualisierte Ansicht in Liste 2 beachten sollten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-195">There are two things that you should notice about the updated view in Listing 2.</span></span> <span data-ttu-id="ec8e6-196">Beachten Sie zunächst, dass der gesamte Inhalt, der in den Teil verschoben wurde, durch einen Aufruf von Html.RenderPartial(ersetzt wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-196">First, notice that all of the content moved into the partial is replaced with a call to Html.RenderPartial().</span></span> <span data-ttu-id="ec8e6-197">Die Html.RenderPartial()-Methode wird aufgerufen, wenn die Indexansicht zum ersten Mal angefordert wird, um den anfänglichen Satz von Kontakten anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-197">The Html.RenderPartial() method is called when the Index view is first requested in order to display the initial set of contacts.</span></span>

<span data-ttu-id="ec8e6-198">Beachten Sie zweitens, dass der Html.ActionLink(), der zum Anzeigen von Kontaktgruppen verwendet wird, durch einen Ajax.ActionLink() ersetzt wurde.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-198">Second, notice that the Html.ActionLink() used to display contact groups has been replaced with an Ajax.ActionLink().</span></span> <span data-ttu-id="ec8e6-199">Der Ajax.ActionLink() wird mit den folgenden Parametern aufgerufen:</span><span class="sxs-lookup"><span data-stu-id="ec8e6-199">The Ajax.ActionLink() is called with the following parameters:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample4.aspx)]

<span data-ttu-id="ec8e6-200">Der erste Parameter stellt den Text dar, der für die Verknüpfung angezeigt werden soll, der zweite Parameter stellt die Routenwerte und der dritte Parameter die Ajax-Optionen dar.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-200">The first parameter represents the text to display for the link, the second parameter represents the route values, and the third parameter represents the Ajax options.</span></span> <span data-ttu-id="ec8e6-201">In diesem Fall verwenden wir die Option UpdateTargetId &lt;Ajax, um auf das HTML-div-Tag&gt; zu verweisen, das wir nach Abschluss der Ajax-Anforderung aktualisieren möchten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-201">In this case, we use the UpdateTargetId Ajax option to point to the HTML &lt;div&gt; tag that we want to update after the Ajax request completes.</span></span> <span data-ttu-id="ec8e6-202">Wir möchten das &lt;&gt; div-Tag mit der neuen Kontaktliste aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-202">We want to update the &lt;div&gt; tag with the new list of contacts.</span></span>

<span data-ttu-id="ec8e6-203">Die aktualisierte Index()-Methode des Kontaktcontrollers ist in Liste 3 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-203">The updated Index() method of the Contact controller is contained in Listing 3.</span></span>

<span data-ttu-id="ec8e6-204">**Auflisten 3 - Controllers-ContactController.cs (Indexmethode)**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-204">**Listing 3 - Controllers\ContactController.cs (Index method)**</span></span>

[!code-csharp[Main](iteration-7-add-ajax-functionality-cs/samples/sample5.cs)]

<span data-ttu-id="ec8e6-205">Die aktualisierte Index()-Aktion gibt bedingt eines von zwei Dingen zurück.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-205">The updated Index() action conditionally returns one of two things.</span></span> <span data-ttu-id="ec8e6-206">Wenn die Index()-Aktion von einer Ajax-Anforderung aufgerufen wird, gibt der Controller einen Teil zurück.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-206">If the Index() action is invoked by an Ajax request then the controller returns a partial.</span></span> <span data-ttu-id="ec8e6-207">Andernfalls gibt die Index()-Aktion eine gesamte Ansicht zurück.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-207">Otherwise, the Index() action returns an entire view.</span></span>

<span data-ttu-id="ec8e6-208">Beachten Sie, dass die Index()-Aktion nicht so viele Daten zurückgeben muss, wenn sie von einer Ajax-Anforderung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-208">Notice that the Index() action does not need to return as much data when invoked by an Ajax request.</span></span> <span data-ttu-id="ec8e6-209">Im Kontext einer normalen Anforderung gibt die Indexaktion eine Liste aller Kontaktgruppen und der ausgewählten Kontaktgruppe zurück.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-209">In the context of a normal request, the Index action returns a list of all of the contact groups and the selected contact group.</span></span> <span data-ttu-id="ec8e6-210">Im Kontext einer Ajax-Anforderung gibt die Index()-Aktion nur die ausgewählte Gruppe zurück.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-210">In the context of an Ajax request, the Index() action returns only the selected group.</span></span> <span data-ttu-id="ec8e6-211">Ajax bedeutet weniger Arbeit auf Ihrem Datenbankserver.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-211">Ajax means less work on your database server.</span></span>

<span data-ttu-id="ec8e6-212">Unsere modifizierte Indexansicht funktioniert sowohl bei Uplevel- als auch downlevel-Browsern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-212">Our modified Index view works in the case of both uplevel and downlevel browsers.</span></span> <span data-ttu-id="ec8e6-213">Wenn Sie auf eine Kontaktgruppe klicken und Ihr Browser JavaScript unterstützt, wird nur der Bereich der Ansicht aktualisiert, der die Liste der Kontakte enthält.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-213">If you click a contact group, and your browser supports JavaScript, then only the region of the view that contains the list of contacts is updated.</span></span> <span data-ttu-id="ec8e6-214">Wenn Ihr Browser JavaScript hingegen nicht unterstützt, wird die gesamte Ansicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-214">If, on the other hand, your browser does not support JavaScript, then the entire view is updated.</span></span>

<span data-ttu-id="ec8e6-215">Unsere aktualisierte Indexansicht hat ein Problem.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-215">Our updated Index view has one problem.</span></span> <span data-ttu-id="ec8e6-216">Wenn Sie auf eine Kontaktgruppe klicken, wird die ausgewählte Gruppe nicht hervorgehoben.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-216">When you click a contact group, the selected group is not highlighted.</span></span> <span data-ttu-id="ec8e6-217">Da die Liste der Gruppen außerhalb der Region angezeigt wird, die während einer Ajax-Anforderung aktualisiert wird, wird die rechte Gruppe nicht hervorgehoben.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-217">Because the list of groups is displayed outside of the region that is updated during an Ajax request, the right group does not get highlighted.</span></span> <span data-ttu-id="ec8e6-218">Dieses Problem wird im nächsten Abschnitt behoben.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-218">We'll fix this issue in the next section.</span></span>

## <a name="adding-jquery-animation-effects"></a><span data-ttu-id="ec8e6-219">Hinzufügen von jQuery-Animationseffekten</span><span class="sxs-lookup"><span data-stu-id="ec8e6-219">Adding jQuery Animation Effects</span></span>

<span data-ttu-id="ec8e6-220">Wenn Sie auf einen Link auf einer Webseite klicken, können Sie die Browser-Fortschrittsleiste verwenden, um zu erkennen, ob der Browser den aktualisierten Inhalt aktiv abruft.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-220">Normally, when you click a link in a web page, you can use the browser progress bar to detect whether or not the browser is actively fetching the updated content.</span></span> <span data-ttu-id="ec8e6-221">Beim Ausführen einer Ajax-Anforderung zeigt die Browser-Fortschrittsleiste hingegen keinen Fortschritt an.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-221">When performing an Ajax request, on the other hand, the browser progress bar does not show any progress.</span></span> <span data-ttu-id="ec8e6-222">Dies kann Benutzer nervös machen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-222">This can make users nervous.</span></span> <span data-ttu-id="ec8e6-223">Woher wissen Sie, ob der Browser eingefroren wurde?</span><span class="sxs-lookup"><span data-stu-id="ec8e6-223">How do you know whether the browser has frozen?</span></span>

<span data-ttu-id="ec8e6-224">Es gibt mehrere Möglichkeiten, wie Sie einem Benutzer angeben können, dass während der Ausführung einer Ajax-Anforderung gearbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-224">There are several ways that you can indicate to a user that work is being performed while performing an Ajax request.</span></span> <span data-ttu-id="ec8e6-225">Ein Ansatz besteht darin, eine einfache Animation anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-225">One approach is to display a simple animation.</span></span> <span data-ttu-id="ec8e6-226">Sie können z. B. eine Region ausblenden, wenn eine Ajax-Anforderung beginnt, und in der Region ausblenden, wenn die Anforderung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-226">For example, you can fade out a region when an Ajax request begins and fade in the region when the request completes.</span></span>

<span data-ttu-id="ec8e6-227">Wir verwenden die jQuery-Bibliothek, die im Microsoft ASP.NET MVC-Framework enthalten ist, um die Animationseffekte zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-227">We'll use the jQuery library which is included with the Microsoft ASP.NET MVC framework, to create the animation effects.</span></span> <span data-ttu-id="ec8e6-228">Die aktualisierte Indexansicht ist in Liste 4 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-228">The updated Index view is contained in Listing 4.</span></span>

<span data-ttu-id="ec8e6-229">**Eintrag 4 - Ansichten, Kontakt, Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-229">**Listing 4 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample6.aspx)]

<span data-ttu-id="ec8e6-230">Beachten Sie, dass die aktualisierte Indexansicht drei neue JavaScript-Funktionen enthält.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-230">Notice that the updated Index view contains three new JavaScript functions.</span></span> <span data-ttu-id="ec8e6-231">Die ersten beiden Funktionen verwenden jQuery, um in der Liste der Kontakte auszublenden und auszublenden, wenn Sie auf eine neue Kontaktgruppe klicken.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-231">The first two functions use jQuery to fade out and fade in the list of contacts when you click a new contact group.</span></span> <span data-ttu-id="ec8e6-232">Die dritte Funktion zeigt eine Fehlermeldung an, wenn eine Ajax-Anforderung zu einem Fehler führt (z. B. Netzwerktimeout).</span><span class="sxs-lookup"><span data-stu-id="ec8e6-232">The third function displays an error message when an Ajax request results in an error (for example, network timeout).</span></span>

<span data-ttu-id="ec8e6-233">Die erste Funktion kümmert sich auch um die Hervorhebung der ausgewählten Gruppe.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-233">The first function also takes care of highlighting the selected group.</span></span> <span data-ttu-id="ec8e6-234">Dem übergeordneten Element (dem LI-Element) des angeklickten Elements wird ein class= selected-Attribut hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-234">A class= selected attribute is added to the parent element (the LI element) of the element clicked.</span></span> <span data-ttu-id="ec8e6-235">Auch hier macht es jQuery einfach, das richtige Element auszuwählen und die CSS-Klasse hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-235">Again, jQuery makes it easy to select the right element and add the CSS class.</span></span>

<span data-ttu-id="ec8e6-236">Diese Skripte sind mit Hilfe des Ajax.ActionLink() AjaxOptions Parameters an die Gruppenverknüpfungen gebunden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-236">These scripts are tied to the group links with the help of the Ajax.ActionLink() AjaxOptions parameter.</span></span> <span data-ttu-id="ec8e6-237">Der aktualisierte Ajax.ActionLink()-Methodenaufruf sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="ec8e6-237">The updated Ajax.ActionLink() method call looks like this:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample7.aspx)]

## <a name="adding-browser-history-support"></a><span data-ttu-id="ec8e6-238">Hinzufügen von Browserverlaufsunterstützung</span><span class="sxs-lookup"><span data-stu-id="ec8e6-238">Adding Browser History Support</span></span>

<span data-ttu-id="ec8e6-239">Wenn Sie auf einen Link klicken, um eine Seite zu aktualisieren, wird der Browserverlauf aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-239">Normally, when you click a link to update a page, your browser history is updated.</span></span> <span data-ttu-id="ec8e6-240">Auf diese Weise können Sie auf die Schaltfläche "Zurück" des Browsers klicken, um in der Zeit wieder in den vorherigen Zustand der Seite zu wechseln.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-240">That way, you can click the browser Back button to move back in time to the previous state of the page.</span></span> <span data-ttu-id="ec8e6-241">Wenn Sie beispielsweise auf die Kontaktgruppe Freunde und dann auf die Kontaktgruppe "Unternehmen" klicken, können Sie auf die Schaltfläche "Zurück" des Browsers klicken, um zurück zum Status der Seite zu navigieren, als die Kontaktgruppe Freunde ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-241">For example, if you click the Friends contact group and then click the Business contact group, you can click the browser Back button to navigate back to the state of the page when the Friends contact group was selected.</span></span>

<span data-ttu-id="ec8e6-242">Leider wird durch das Ausführen einer Ajax-Anforderung der Browserverlauf nicht automatisch aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-242">Unfortunately, performing an Ajax request does not update browser history automatically.</span></span> <span data-ttu-id="ec8e6-243">Wenn Sie auf eine Kontaktgruppe klicken und die Liste der übereinstimmenden Kontakte mit einer Ajax-Anforderung abgerufen wird, wird der Browserverlauf nicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-243">If you click a contact group, and the list of matching contacts is retrieved with an Ajax request, then the browser history is not updated.</span></span> <span data-ttu-id="ec8e6-244">Sie können die Schaltfläche "Zurück" des Browsers nicht verwenden, um nach der Auswahl einer neuen Kontaktgruppe zurück zu einer Kontaktgruppe zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-244">You cannot use the browser Back button to navigate back to a contact group after selecting a new contact group.</span></span>

<span data-ttu-id="ec8e6-245">Wenn Sie möchten, dass Benutzer die Schaltfläche "Zurück" des Browsers verwenden können, nachdem Sie Ajax-Anforderungen ausgeführt haben, müssen Sie etwas mehr Arbeit leisten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-245">If you want users to be able to use the browser Back button after performing Ajax requests then you need to perform a little more work.</span></span> <span data-ttu-id="ec8e6-246">Sie müssen die im ASP.NET AJAX Framework integrierten Browserverlaufsverwaltungsfunktionen nutzen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-246">You need to take advantage of the browser history management functionality built in the ASP.NET AJAX Framework.</span></span>

<span data-ttu-id="ec8e6-247">ASP.NET AJAX-Browserverlauf müssen Sie drei Dinge tun:</span><span class="sxs-lookup"><span data-stu-id="ec8e6-247">ASP.NET AJAX browser history, you need to do three things:</span></span>

1. <span data-ttu-id="ec8e6-248">Aktivieren Sie den Browserverlauf, indem Sie die enableBrowserHistory-Eigenschaft auf true festlegen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-248">Enable Browser History by setting the enableBrowserHistory property to true.</span></span>
2. <span data-ttu-id="ec8e6-249">Speichern Sie Verlaufspunkte, wenn sich der Status einer Ansicht ändert, indem Sie die addHistoryPoint()-Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-249">Save history points when the state of a view changes by calling the addHistoryPoint() method.</span></span>
3. <span data-ttu-id="ec8e6-250">Rekonstruieren Sie den Status der Ansicht, wenn das Navigationsereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-250">Reconstruct the state of the view when the navigate event is raised.</span></span>

<span data-ttu-id="ec8e6-251">Die aktualisierte Indexansicht ist in Liste 5 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-251">The updated Index view is contained in Listing 5.</span></span>

<span data-ttu-id="ec8e6-252">**Eintrag 5 - Ansichten, Kontakt, Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-252">**Listing 5 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample8.aspx)]

<span data-ttu-id="ec8e6-253">In Listing 5 ist der Browserverlauf in der PageInit()-Funktion aktiviert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-253">In Listing 5, Browser History is enabled in the pageInit() function.</span></span> <span data-ttu-id="ec8e6-254">Die pageInit()-Funktion wird auch verwendet, um den Ereignishandler für das navigationsereignis einzurichten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-254">The pageInit() function is also used to set up the event handler for the navigate event.</span></span> <span data-ttu-id="ec8e6-255">Das Navigationsereignis wird ausgelöst, wenn die Schaltfläche Vorwärts oder Zurück des Browsers bewirkt, dass sich der Status der Seite ändert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-255">The navigate event is raised whenever the browser Forward or Back button causes the state of the page to change.</span></span>

<span data-ttu-id="ec8e6-256">Die beginContactList()-Methode wird aufgerufen, wenn Sie auf eine Kontaktgruppe klicken.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-256">The beginContactList() method is called when you click a contact group.</span></span> <span data-ttu-id="ec8e6-257">Diese Methode erstellt einen neuen Verlaufspunkt, indem die addHistoryPoint()-Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-257">This method creates a new history point by calling the addHistoryPoint() method.</span></span> <span data-ttu-id="ec8e6-258">Die ID der aufgeklickten Kontaktgruppe wird dem Verlauf hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-258">The id of the contact group clicked is added to history.</span></span>

<span data-ttu-id="ec8e6-259">Die Gruppen-ID wird aus einem expando-Attribut auf der Kontaktgruppenverknüpfung abgerufen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-259">The group id is retrieved from an expando attribute on the contact group link.</span></span> <span data-ttu-id="ec8e6-260">Der Link wird mit dem folgenden Aufruf von Ajax.ActionLink() gerendert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-260">The link is rendered with the following call to Ajax.ActionLink().</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample9.aspx)]

<span data-ttu-id="ec8e6-261">Der letzte Parameter, der an Ajax.ActionLink() übergeben wird, fügt der Verknüpfung ein expando-Attribut namens groupid hinzu (Kleinbuchstaben für XHTML-Kompatibilität).</span><span class="sxs-lookup"><span data-stu-id="ec8e6-261">The last parameter passed to the Ajax.ActionLink() adds an expando attribute named groupid to the link (lowercase for XHTML compatibility).</span></span>

<span data-ttu-id="ec8e6-262">Wenn ein Benutzer auf die Schaltfläche "Zurück" oder "Vorwärts" des Browsers trifft, wird das Navigationsereignis ausgelöst und die navigate()-Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-262">When a user hits the browser Back or Forward button, the navigate event is raised and the navigate() method is called.</span></span> <span data-ttu-id="ec8e6-263">Diese Methode aktualisiert die auf der Seite angezeigten Kontakte so, dass sie dem Status der Seite entsprechen, die dem Browserverlaufspunkt entspricht, der an die Navigate-Methode übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-263">This method updates the contacts displayed in the page to match the state of the page that corresponds to the browser history point passed to the navigate method.</span></span>

## <a name="performing-ajax-deletes"></a><span data-ttu-id="ec8e6-264">Ausführen von Ajax-Löschvorgängen</span><span class="sxs-lookup"><span data-stu-id="ec8e6-264">Performing Ajax Deletes</span></span>

<span data-ttu-id="ec8e6-265">Um einen Kontakt zu löschen, müssen Sie derzeit auf den Link Löschen klicken und dann auf die Schaltfläche Löschen klicken, die auf der Seite Bestätigung löschen angezeigt wird (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="ec8e6-265">Currently, in order to delete a contact, you need to click on the Delete link and then click the Delete button displayed in the delete confirmation page (see Figure 2).</span></span> <span data-ttu-id="ec8e6-266">Dies scheint wie eine Menge von Seitenanfragen, um etwas Einfaches wie das Löschen eines Datenbankdatensatzes zu tun.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-266">This seems like a lot of page requests to do something simple like deleting a database record.</span></span>

<span data-ttu-id="ec8e6-267">[![Die Bestätigungsseite zum Löschen](iteration-7-add-ajax-functionality-cs/_static/image2.jpg)](iteration-7-add-ajax-functionality-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-267">[![The delete confirmation page](iteration-7-add-ajax-functionality-cs/_static/image2.jpg)](iteration-7-add-ajax-functionality-cs/_static/image3.png)</span></span>

<span data-ttu-id="ec8e6-268">**Abbildung 02**: Die Seite zur Bestätigung löschen([Klicken Sie hier, um das Bild in voller Größe anzuzeigen)](iteration-7-add-ajax-functionality-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-268">**Figure 02**: The delete confirmation page([Click to view full-size image](iteration-7-add-ajax-functionality-cs/_static/image4.png))</span></span>

<span data-ttu-id="ec8e6-269">Es ist verlockend, die Seite bestätigung löschen und einen Kontakt direkt aus der Indexansicht zu löschen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-269">It is tempting to skip the delete confirmation page and delete a contact directly from the Index view.</span></span> <span data-ttu-id="ec8e6-270">Sie sollten diese Versuchung vermeiden, da dieser Ansatz Ihre Anwendung für Sicherheitslücken öffnet.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-270">You should avoid this temptation because taking this approach opens your application to security holes.</span></span> <span data-ttu-id="ec8e6-271">Im Allgemeinen möchten Sie beim Aufrufen einer Aktion, die den Status Ihrer Webanwendung ändert, keinen HTTP GET-Vorgang ausführen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-271">In general, you don t want to perform an HTTP GET operation when invoking an action that modifies the state of your web application.</span></span> <span data-ttu-id="ec8e6-272">Wenn Sie einen Löschvorgang durchführen, möchten Sie einen HTTP-POST-Vorgang oder besser noch einen HTTP DELETE-Vorgang ausführen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-272">When performing a delete, you want to perform an HTTP POST, or better yet, an HTTP DELETE operation.</span></span>

<span data-ttu-id="ec8e6-273">Der Link Löschen ist in der ContactList-Partie enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-273">The Delete link is contained in the ContactList partial.</span></span> <span data-ttu-id="ec8e6-274">Eine aktualisierte Version der ContactList-Partie ist in Liste 6 enthalten.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-274">An updated version of the ContactList partial is contained in Listing 6.</span></span>

<span data-ttu-id="ec8e6-275">**Auflisten 6 - Ansichten- Kontakt-Kontaktliste.ascx**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-275">**Listing 6 - Views\Contact\ContactList.ascx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample10.aspx)]

<span data-ttu-id="ec8e6-276">Der Link Löschen wird mit dem folgenden Aufruf der Ajax.ImageActionLink()-Methode gerendert:</span><span class="sxs-lookup"><span data-stu-id="ec8e6-276">The Delete link is rendered with the following call to the Ajax.ImageActionLink() method:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample11.aspx)]

> [!NOTE] 
> 
> <span data-ttu-id="ec8e6-277">Der Ajax.ImageActionLink() ist kein Standardbestandteil des ASP.NET MVC-Frameworks.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-277">The Ajax.ImageActionLink() is not a standard part of the ASP.NET MVC framework.</span></span> <span data-ttu-id="ec8e6-278">Der Ajax.ImageActionLink() ist eine benutzerdefinierte Hilfsmethode, die im Contact Manager-Projekt enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-278">The Ajax.ImageActionLink() is a custom helper methods included in the Contact Manager project.</span></span>

<span data-ttu-id="ec8e6-279">Der Parameter AjaxOptions hat zwei Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-279">The AjaxOptions parameter has two properties.</span></span> <span data-ttu-id="ec8e6-280">Zunächst wird die Confirm-Eigenschaft verwendet, um ein Popup-JavaScript-Bestätigungsdialogfeld anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-280">First, the Confirm property is used to display a popup JavaScript confirmation dialog.</span></span> <span data-ttu-id="ec8e6-281">Zweitens wird die HttpMethod-Eigenschaft verwendet, um einen HTTP DELETE-Vorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-281">Second, the HttpMethod property is used to perform an HTTP DELETE operation.</span></span>

<span data-ttu-id="ec8e6-282">Liste 7 enthält eine neue AjaxDelete()-Aktion, die dem Contact-Controller hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-282">Listing 7 contains a new AjaxDelete() action that has been added to the Contact controller.</span></span>

<span data-ttu-id="ec8e6-283">**Auflisten 7 - Controller-KontaktController.cs (AjaxDelete)**</span><span class="sxs-lookup"><span data-stu-id="ec8e6-283">**Listing 7 - Controllers\ContactController.cs (AjaxDelete)**</span></span>

[!code-csharp[Main](iteration-7-add-ajax-functionality-cs/samples/sample12.cs)]

<span data-ttu-id="ec8e6-284">Die Aktion AjaxDelete() ist mit einem AcceptVerbs-Attribut versehen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-284">The AjaxDelete() action is decorated with an AcceptVerbs attribute.</span></span> <span data-ttu-id="ec8e6-285">Dieses Attribut verhindert, dass die Aktion aufgerufen wird, außer von einem anderen HTTP-Vorgang als einem HTTP DELETE-Vorgang.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-285">This attribute prevents the action from being invoked except by any HTTP operation other than an HTTP DELETE operation.</span></span> <span data-ttu-id="ec8e6-286">Insbesondere können Sie diese Aktion nicht mit einem HTTP GET aufrufen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-286">In particular, you cannot invoke this action with an HTTP GET.</span></span>

<span data-ttu-id="ec8e6-287">Nachdem Sie den Datenbankdatensatz gelöscht haben, müssen Sie die aktualisierte Liste der Kontakte anzeigen, die den gelöschten Datensatz nicht enthält.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-287">After you delete database record, you need to display the updated list of contacts that does not contain the deleted record.</span></span> <span data-ttu-id="ec8e6-288">Die AjaxDelete()-Methode gibt die ContactList teilweise und die aktualisierte Kontaktliste zurück.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-288">The AjaxDelete() method returns the ContactList partial and the updated list of contacts.</span></span>

## <a name="summary"></a><span data-ttu-id="ec8e6-289">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="ec8e6-289">Summary</span></span>

<span data-ttu-id="ec8e6-290">In dieser Iteration haben wir unserer Contact Manager-Anwendung Ajax-Funktionalität hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-290">In this iteration, we added Ajax functionality to our Contact Manager application.</span></span> <span data-ttu-id="ec8e6-291">Wir haben Ajax verwendet, um die Reaktionsfähigkeit und Leistung unserer Anwendung zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-291">We used Ajax to improve the responsiveness and performance of our application.</span></span>

<span data-ttu-id="ec8e6-292">Zuerst haben wir die Indexansicht so umgestaltet, dass durch Klicken auf eine Kontaktgruppe nicht die gesamte Ansicht aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-292">First, we refactored the Index view so that clicking a contact group does not update the entire view.</span></span> <span data-ttu-id="ec8e6-293">Wenn Sie stattdessen auf eine Kontaktgruppe klicken, wird nur die Liste der Kontakte aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-293">Instead, clicking a contact group only updates the list of contacts.</span></span>

<span data-ttu-id="ec8e6-294">Als Nächstes haben wir jQuery-Animationseffekte verwendet, um in der Liste der Kontakte auszublenden und auszublenden.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-294">Next, we used jQuery animation effects to fade out and fade in the list of contacts.</span></span> <span data-ttu-id="ec8e6-295">Das Hinzufügen von Animationen zu einer Ajax-Anwendung kann verwendet werden, um Benutzern der Anwendung das Äquivalent einer Browser-Fortschrittsleiste bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-295">Adding animation to an Ajax application can be used to provide users of the application with the equivalent of a browser progress bar.</span></span>

<span data-ttu-id="ec8e6-296">Außerdem haben wir unserer Ajax-Anwendung Browserverlaufsunterstützung hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-296">We also added browser history support to our Ajax application.</span></span> <span data-ttu-id="ec8e6-297">Wir haben Benutzern ermöglicht, auf die Schaltflächen "Zurück" und "Vorwärts" des Browsers zu klicken, um den Status der Indexansicht zu ändern.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-297">We enabled users to click the browser Back and Forward buttons to change the state of the Index view.</span></span>

<span data-ttu-id="ec8e6-298">Schließlich haben wir einen Löschlink erstellt, der HTTP DELETE-Vorgänge unterstützt.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-298">Finally, we created a delete link that supports HTTP DELETE operations.</span></span> <span data-ttu-id="ec8e6-299">Durch die Durchführung von Ajax-Löschvorgängen ermöglichen wir es Benutzern, Datenbankdatensätze zu löschen, ohne dass der Benutzer eine zusätzliche Löschbestätigungsseite anfordern muss.</span><span class="sxs-lookup"><span data-stu-id="ec8e6-299">By performing Ajax deletes, we enable users to delete database records without requiring the user to request an additional delete confirmation page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ec8e6-300">[Zurück](iteration-6-use-test-driven-development-cs.md)
> [Weiter](iteration-1-create-the-application-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ec8e6-300">[Previous](iteration-6-use-test-driven-development-cs.md)
[Next](iteration-1-create-the-application-vb.md)</span></span>
