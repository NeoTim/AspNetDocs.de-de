---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-5
title: 'Teil 5: Bearbeiten von Formularen und Vorlagen | Microsoft-Dokumentation'
author: jongalloway
description: In dieser tutorialreihe werden alle Schritte erläutert, die zum Erstellen der ASP.NET MVC Music Store-Beispielanwendung ausgeführt wurden. Teil 5 umfasst Bearbeitungs Formulare und Vorlagen.
ms.author: riande
ms.date: 04/21/2011
ms.assetid: 6b09413a-6d6a-425a-87c9-629f91b91b28
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-5
msc.type: authoredcontent
ms.openlocfilehash: 20b99cbe57b5dfa623205838a5929733a6c2d70d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78450909"
---
# <a name="part-5-edit-forms-and-templating"></a><span data-ttu-id="ddf95-104">Teil 5: Bearbeiten von Formularen und Vorlagen</span><span class="sxs-lookup"><span data-stu-id="ddf95-104">Part 5: Edit Forms and Templating</span></span>

<span data-ttu-id="ddf95-105">von [Jon Galloway](https://github.com/jongalloway)</span><span class="sxs-lookup"><span data-stu-id="ddf95-105">by [Jon Galloway](https://github.com/jongalloway)</span></span>

> <span data-ttu-id="ddf95-106">Der MVC Music Store ist eine Lernprogramm Anwendung, die Schritt für Schritt erläutert, wie ASP.NET MVC und Visual Studio für die Webentwicklung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-106">The MVC Music Store is a tutorial application that introduces and explains step-by-step how to use ASP.NET MVC and Visual Studio for web development.</span></span>  
>   
> <span data-ttu-id="ddf95-107">Der MVC Music Store ist eine einfache Beispiel Speicher Implementierung, die Musikalben online verkauft und grundlegende Funktionen für Website Verwaltung, Benutzeranmeldung und Warenkorb implementiert.</span><span class="sxs-lookup"><span data-stu-id="ddf95-107">The MVC Music Store is a lightweight sample store implementation which sells music albums online, and implements basic site administration, user sign-in, and shopping cart functionality.</span></span>
> 
> <span data-ttu-id="ddf95-108">In dieser tutorialreihe werden alle Schritte erläutert, die zum Erstellen der ASP.NET MVC Music Store-Beispielanwendung ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-108">This tutorial series details all of the steps taken to build the ASP.NET MVC Music Store sample application.</span></span> <span data-ttu-id="ddf95-109">Teil 5 umfasst Bearbeitungs Formulare und Vorlagen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-109">Part 5 covers Edit Forms and Templating.</span></span>

<span data-ttu-id="ddf95-110">Im letzten Kapitel haben wir Daten aus der Datenbank geladen und angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-110">In the past chapter, we were loading data from our database and displaying it.</span></span> <span data-ttu-id="ddf95-111">In diesem Kapitel wird auch das Bearbeiten der Daten ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="ddf95-111">In this chapter, we'll also enable editing the data.</span></span>

## <a name="creating-the-storemanagercontroller"></a><span data-ttu-id="ddf95-112">Erstellen von storemanagercontroller</span><span class="sxs-lookup"><span data-stu-id="ddf95-112">Creating the StoreManagerController</span></span>

<span data-ttu-id="ddf95-113">Zunächst erstellen wir einen neuen Controller mit dem Namen " **storemanagercontroller**".</span><span class="sxs-lookup"><span data-stu-id="ddf95-113">We'll begin by creating a new controller called **StoreManagerController**.</span></span> <span data-ttu-id="ddf95-114">Für diesen Controller werden die Gerüstbau Features genutzt, die im ASP.NET MVC 3 Tools Update verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="ddf95-114">For this controller, we will be taking advantage of the Scaffolding features available in the ASP.NET MVC 3 Tools Update.</span></span> <span data-ttu-id="ddf95-115">Legen Sie die Optionen für das Dialogfeld Controller hinzufügen wie unten dargestellt fest.</span><span class="sxs-lookup"><span data-stu-id="ddf95-115">Set the options for the Add Controller dialog as shown below.</span></span>

![](mvc-music-store-part-5/_static/image1.png)

<span data-ttu-id="ddf95-116">Wenn Sie auf die Schaltfläche Hinzufügen klicken, sehen Sie, dass der ASP.NET MVC 3-gerüstingmechanismus eine gute Menge an Arbeit für Sie erledigt:</span><span class="sxs-lookup"><span data-stu-id="ddf95-116">When you click the Add button, you'll see that the ASP.NET MVC 3 scaffolding mechanism does a good amount of work for you:</span></span>

- <span data-ttu-id="ddf95-117">Er erstellt den neuen storemanagercontroller mit einer lokalen Entity Framework Variable.</span><span class="sxs-lookup"><span data-stu-id="ddf95-117">It creates the new StoreManagerController with a local Entity Framework variable</span></span>
- <span data-ttu-id="ddf95-118">Dem Ordner "Views" des Projekts wird ein StoreManager-Ordner hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-118">It adds a StoreManager folder to the project's Views folder</span></span>
- <span data-ttu-id="ddf95-119">Sie fügt die Sicht "Create. cshtml", "Delete. cshtml", "Details. cshtml", "Edit. cshtml" und "index. cshtml" hinzu, die stark typisiert ist.</span><span class="sxs-lookup"><span data-stu-id="ddf95-119">It adds Create.cshtml, Delete.cshtml, Details.cshtml, Edit.cshtml, and Index.cshtml view, strongly typed to the Album class</span></span>

![](mvc-music-store-part-5/_static/image2.png)

<span data-ttu-id="ddf95-120">Die neue StoreManager Controller-Klasse enthält CRUD (Create, Read, Update, DELETE) Controller-Aktionen, die wissen, wie Sie mit der Album Model-Klasse arbeiten und den Entity Framework Kontext für den Datenbankzugriff verwenden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-120">The new StoreManager controller class includes CRUD (create, read, update, delete) controller actions which know how to work with the Album model class and use our Entity Framework context for database access.</span></span>

## <a name="modifying-a-scaffolded-view"></a><span data-ttu-id="ddf95-121">Ändern einer Gerüst Ansicht</span><span class="sxs-lookup"><span data-stu-id="ddf95-121">Modifying a Scaffolded View</span></span>

<span data-ttu-id="ddf95-122">Es ist wichtig zu beachten, dass dieser Code zwar für uns generiert wurde, aber auch der standardmäßige ASP.NET-MVC-Code ist, ebenso wie wir in diesem Tutorial geschrieben haben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-122">It's important to remember that, while this code was generated for us, it's standard ASP.NET MVC code, just like we've been writing throughout this tutorial.</span></span> <span data-ttu-id="ddf95-123">Sie soll Ihnen den Zeitaufwand für das Schreiben von Code für Code Bausteine und das manuelle Erstellen der stark typisierten Ansichten ersparen, aber dies ist nicht die Art des generierten Codes, den Sie möglicherweise als Präfix mit düsteren Warnungen in Kommentaren über das Ändern der Ordnung.</span><span class="sxs-lookup"><span data-stu-id="ddf95-123">It's intended to save you the time you'd spend on writing boilerplate controller code and creating the strongly typed views manually, but this isn't the kind of generated code you may have seen prefaced with dire warnings in comments about how you mustn't change the code.</span></span> <span data-ttu-id="ddf95-124">Dies ist Ihr Code, und Sie sollten ihn ändern.</span><span class="sxs-lookup"><span data-stu-id="ddf95-124">This is your code, and you're expected to change it.</span></span>

<span data-ttu-id="ddf95-125">Beginnen wir also mit einer schnellen Bearbeitung der Ansicht "StoreManager Index" (/Views/StoreManager/Index.cshtml).</span><span class="sxs-lookup"><span data-stu-id="ddf95-125">So, let's start with a quick edit to the StoreManager Index view (/Views/StoreManager/Index.cshtml).</span></span> <span data-ttu-id="ddf95-126">In dieser Ansicht wird eine Tabelle angezeigt, in der die im Store enthaltenen Alben mit den Links bearbeiten/Details/löschen aufgelistet werden und die öffentlichen Eigenschaften des Albums enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="ddf95-126">This view will display a table which lists the Albums in our store with Edit / Details / Delete links, and includes the Album's public properties.</span></span> <span data-ttu-id="ddf95-127">Wir entfernen das Feld "albumarturl", da es in dieser Anzeige nicht sehr nützlich ist.</span><span class="sxs-lookup"><span data-stu-id="ddf95-127">We'll remove the AlbumArtUrl field, as it's not very useful in this display.</span></span> <span data-ttu-id="ddf95-128">Entfernen Sie in &lt;Tabelle&gt; Abschnitt des Ansichts Codes die &lt;Th-&gt; und &lt;TD-Elemente, die die "albumarturl"-Verweise umgeben, wie in den markierten Zeilen unten aufgeführt:&gt;</span><span class="sxs-lookup"><span data-stu-id="ddf95-128">In &lt;table&gt; section of the view code, remove the &lt;th&gt; and &lt;td&gt; elements surrounding AlbumArtUrl references, as indicated by the highlighted lines below:</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample1.cshtml)]

<span data-ttu-id="ddf95-129">Der geänderte Ansichts Code wird wie folgt angezeigt:</span><span class="sxs-lookup"><span data-stu-id="ddf95-129">The modified view code will appear as follows:</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample2.cshtml)]

## <a name="a-first-look-at-the-store-manager"></a><span data-ttu-id="ddf95-130">Ein erster Blick auf den Store-Manager</span><span class="sxs-lookup"><span data-stu-id="ddf95-130">A first look at the Store Manager</span></span>

<span data-ttu-id="ddf95-131">Führen Sie nun die Anwendung aus, und navigieren Sie zu/StoreManager/.</span><span class="sxs-lookup"><span data-stu-id="ddf95-131">Now run the application and browse to /StoreManager/.</span></span> <span data-ttu-id="ddf95-132">Dadurch wird der soeben geänderte Speicher-Manager-Index angezeigt, und es wird eine Liste der Alben im Speicher mit Links zu bearbeiten, Details und löschen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-132">This displays the Store Manager Index we just modified, showing a list of the albums in the store with links to Edit, Details, and Delete.</span></span>

![](mvc-music-store-part-5/_static/image3.png)

<span data-ttu-id="ddf95-133">Wenn Sie auf den Link bearbeiten klicken, wird ein Bearbeitungs Formular mit Feldern für das Album angezeigt, einschließlich der Dropdown Liste für Genre und Künstlerin.</span><span class="sxs-lookup"><span data-stu-id="ddf95-133">Clicking the Edit link displays an edit form with fields for the Album, including dropdowns for Genre and Artist.</span></span>

![](mvc-music-store-part-5/_static/image4.png)

<span data-ttu-id="ddf95-134">Klicken Sie unten auf den Link "zurück zum Auflisten", und klicken Sie dann auf den Link Details für ein Album.</span><span class="sxs-lookup"><span data-stu-id="ddf95-134">Click the "Back to List" link at the bottom, then click on the Details link for an Album.</span></span> <span data-ttu-id="ddf95-135">Dadurch werden die Detailinformationen für ein einzelnes Album angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-135">This displays the detail information for an individual Album.</span></span>

![](mvc-music-store-part-5/_static/image5.png)

<span data-ttu-id="ddf95-136">Klicken Sie erneut auf den Link zurück zu Liste, und klicken Sie dann auf den Link löschen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-136">Again, click the Back to List link, then click on a Delete link.</span></span> <span data-ttu-id="ddf95-137">Dadurch wird ein Bestätigungs Dialogfeld angezeigt, in dem die Details des Albums angezeigt werden, und Sie werden gefragt, ob wir es löschen möchten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-137">This displays a confirmation dialog, showing the album details and asking if we're sure we want to delete it.</span></span>

![](mvc-music-store-part-5/_static/image6.png)

<span data-ttu-id="ddf95-138">Wenn Sie im unteren Bereich auf die Schaltfläche Löschen klicken, wird das Album gelöscht, und Sie kehren zur Index Seite zurück, auf der das gelöschte Album angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-138">Clicking the Delete button at the bottom will delete the album and return you to the Index page, which shows the album deleted.</span></span>

<span data-ttu-id="ddf95-139">Wir arbeiten nicht mit dem Store Manager, aber wir verfügen über einen funktionierenden Controller und zeigen Code an, von dem aus die CRUD-Vorgänge gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-139">We're not done with the Store Manager, but we have working controller and view code for the CRUD operations to start from.</span></span>

## <a name="looking-at-the-store-manager-controller-code"></a><span data-ttu-id="ddf95-140">Sehen Sie sich den Store Manager-Controller Code an</span><span class="sxs-lookup"><span data-stu-id="ddf95-140">Looking at the Store Manager Controller code</span></span>

<span data-ttu-id="ddf95-141">Der Store Manager-Controller enthält eine gute Menge an Code.</span><span class="sxs-lookup"><span data-stu-id="ddf95-141">The Store Manager Controller contains a good amount of code.</span></span> <span data-ttu-id="ddf95-142">Wir gehen dies von oben nach unten durch.</span><span class="sxs-lookup"><span data-stu-id="ddf95-142">Let's go through this from top to bottom.</span></span> <span data-ttu-id="ddf95-143">Der Controller enthält einige Standardnamespaces für einen MVC-Controller sowie einen Verweis auf den Namespace "Models".</span><span class="sxs-lookup"><span data-stu-id="ddf95-143">The controller includes some standard namespaces for an MVC controller, as well as a reference to our Models namespace.</span></span> <span data-ttu-id="ddf95-144">Der Controller verfügt über eine private Instanz von "musicstoreentities", die von den einzelnen Controller Aktionen für den Datenzugriff verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-144">The controller has a private instance of MusicStoreEntities, used by each of the controller actions for data access.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample3.cs)]

### <a name="store-manager-index-and-details-actions"></a><span data-ttu-id="ddf95-145">Speicher-Manager-Index-und Detail Aktionen</span><span class="sxs-lookup"><span data-stu-id="ddf95-145">Store Manager Index and Details actions</span></span>

<span data-ttu-id="ddf95-146">Die Index Ansicht Ruft eine Liste von Alben ab, einschließlich der referenzierten Genre-und Künstlerinformationen jedes Albums, wie zuvor bei der Arbeit an der Store-Methode zum Durchsuchen aufgetreten war.</span><span class="sxs-lookup"><span data-stu-id="ddf95-146">The index view retrieves a list of Albums, including each album's referenced Genre and Artist information, as we previously saw when working on the Store Browse method.</span></span> <span data-ttu-id="ddf95-147">Die Index Sicht folgt den verweisen auf die verknüpften Objekte, sodass Sie den Genre Namen und den Namen der einzelnen Alben anzeigen kann, sodass der Controller effizient ist und diese Informationen in der ursprünglichen Anforderung abfragt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-147">The Index view is following the references to the linked objects so that it can display each album's Genre name and Artist name, so the controller is being efficient and querying for this information in the original request.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample4.cs)]

<span data-ttu-id="ddf95-148">Die Detail Controller Aktion des StoreManager-Controllers funktioniert genau wie die zuvor geschriebene Aktion "Store Controller-Details", die mit der Find ()-Methode nach dem Album abgefragt und dann an die Ansicht zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-148">The StoreManager Controller's Details controller action works exactly the same as the Store Controller Details action we wrote previously - it queries for the Album by ID using the Find() method, then returns it to the view.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample5.cs)]

### <a name="the-create-action-methods"></a><span data-ttu-id="ddf95-149">Die Create Action-Methoden</span><span class="sxs-lookup"><span data-stu-id="ddf95-149">The Create Action Methods</span></span>

<span data-ttu-id="ddf95-150">Die Methoden zum Erstellen von Aktionen unterscheiden sich geringfügig von denen, die Sie bisher gesehen haben, da Sie Formular Eingaben verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-150">The Create action methods are a little different from ones we've seen so far, because they handle form input.</span></span> <span data-ttu-id="ddf95-151">Wenn ein Benutzer das erste Mal besucht/StoreManager/Create/wird ein leeres Formular angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-151">When a user first visits /StoreManager/Create/ they will be shown an empty form.</span></span> <span data-ttu-id="ddf95-152">Diese HTML-Seite enthält ein &lt;Formular&gt; Element, das Dropdown-und Textfeld-Eingabeelemente enthält, in denen die Details des Albums eingegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="ddf95-152">This HTML page will contain a &lt;form&gt; element that contains dropdown and textbox input elements where they can enter the album's details.</span></span>

<span data-ttu-id="ddf95-153">Nachdem der Benutzer die Album-Formular Werte ausgefüllt hat, kann er die Schaltfläche "Speichern" drücken, um diese Änderungen an die Anwendung zurückzusenden, um Sie in der Datenbank zu speichern.</span><span class="sxs-lookup"><span data-stu-id="ddf95-153">After the user fills in the Album form values, they can press the "Save" button to submit these changes back to our application to save within the database.</span></span> <span data-ttu-id="ddf95-154">Wenn der Benutzer die Schaltfläche "Speichern" drückt, wird das &lt;Formular&gt; einen HTTP-Post-Vorgang an die/StoreManager/Create/-URL durchführen und das &lt;Formular&gt; Werte als Teil von HTTP-Post senden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-154">When the user presses the "save" button the &lt;form&gt; will perform an HTTP-POST back to the /StoreManager/Create/ URL and submit the &lt;form&gt; values as part of the HTTP-POST.</span></span>

<span data-ttu-id="ddf95-155">ASP.NET MVC ermöglicht das einfache Aufteilen der Logik dieser beiden URL-Aufruf Szenarien, indem es uns ermöglicht, zwei separate "Create"-Aktionsmethoden in unserer storemanagercontroller-Klasse zu implementieren – eine, um die erste HTTP-Get-Suche zur/StoreManager/Create/-URL zu verarbeiten, und die andere, um den HTTP-Post-Vorgang der übermittelten Änderungen zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-155">ASP.NET MVC allows us to easily split up the logic of these two URL invocation scenarios by enabling us to implement two separate "Create" action methods within our StoreManagerController class – one to handle the initial HTTP-GET browse to the /StoreManager/Create/ URL, and the other to handle the HTTP-POST of the submitted changes.</span></span>

### <a name="passing-information-to-a-view-using-viewbag"></a><span data-ttu-id="ddf95-156">Übergeben von Informationen an eine Ansicht mithilfe von viewbag</span><span class="sxs-lookup"><span data-stu-id="ddf95-156">Passing information to a View using ViewBag</span></span>

<span data-ttu-id="ddf95-157">Wir haben den viewbag weiter oben in diesem Tutorial verwendet, aber noch nicht viel darüber gesprochen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-157">We've used the ViewBag earlier in this tutorial, but haven't talked much about it.</span></span> <span data-ttu-id="ddf95-158">Der viewbag ermöglicht uns, Informationen an die Ansicht zu übergeben, ohne ein stark typisiertes Modell Objekt zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-158">The ViewBag allows us to pass information to the view without using a strongly typed model object.</span></span> <span data-ttu-id="ddf95-159">In diesem Fall muss unsere Aktion zum Bearbeiten des HTTP-Get-Controllers sowohl eine Liste der Genres als auch Künstler an das Formular übergeben, um die Dropdown Listen zu füllen. die einfachste Möglichkeit hierfür ist, Sie als viewbag-Elemente zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-159">In this case, our Edit HTTP-GET controller action needs to pass both a list of Genres and Artists to the form to populate the dropdowns, and the simplest way to do that is to return them as ViewBag items.</span></span>

<span data-ttu-id="ddf95-160">Der viewbag ist ein dynamisches Objekt, d. h., Sie können "viewbag. foo" oder "viewbag. yournamehere" eingeben, ohne Code zu schreiben, um diese Eigenschaften zu definieren.</span><span class="sxs-lookup"><span data-stu-id="ddf95-160">The ViewBag is a dynamic object, meaning that you can type ViewBag.Foo or ViewBag.YourNameHere without writing code to define those properties.</span></span> <span data-ttu-id="ddf95-161">In diesem Fall verwendet der Controller Code "viewbag. GenreID" und "viewbag. artistId", sodass die mit dem Formular übermittelten Dropdown Werte GenreID und artistId sind. Dies sind die von Ihnen fest zuweisenden Album Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="ddf95-161">In this case, the controller code uses ViewBag.GenreId and ViewBag.ArtistId so that the dropdown values submitted with the form will be GenreId and ArtistId, which are the Album properties they will be setting.</span></span>

<span data-ttu-id="ddf95-162">Diese Dropdown Werte werden an das Formular zurückgegeben, indem das SelectList-Objekt verwendet wird, das nur für diesen Zweck erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-162">These dropdown values are returned to the form using the SelectList object, which is built just for that purpose.</span></span> <span data-ttu-id="ddf95-163">Dies erfolgt mithilfe von Code wie dem folgenden:</span><span class="sxs-lookup"><span data-stu-id="ddf95-163">This is done using code like this:</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample6.cs)]

<span data-ttu-id="ddf95-164">Wie Sie im Code der Aktionsmethode sehen können, werden drei Parameter verwendet, um dieses Objekt zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="ddf95-164">As you can see from the action method code, three parameters are being used to create this object:</span></span>

- <span data-ttu-id="ddf95-165">Die Liste der Elemente, die in der Dropdown Liste angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-165">The list of items the dropdown will be displaying.</span></span> <span data-ttu-id="ddf95-166">Beachten Sie, dass es sich nicht nur um eine Zeichenfolge handelt. Wir übergeben eine Liste von Genres.</span><span class="sxs-lookup"><span data-stu-id="ddf95-166">Note that this isn't just a string - we're passing a list of Genres.</span></span>
- <span data-ttu-id="ddf95-167">Der nächste Parameter, der an die SelectList übergeben wird, ist der ausgewählte Wert.</span><span class="sxs-lookup"><span data-stu-id="ddf95-167">The next parameter being passed to the SelectList is the Selected Value.</span></span> <span data-ttu-id="ddf95-168">Auf diese Weise weiß die SelectList, wie ein Element in der Liste vorab ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-168">This how the SelectList knows how to pre-select an item in the list.</span></span> <span data-ttu-id="ddf95-169">Dies ist leichter zu verstehen, wenn wir uns das Bearbeitungs Formular ansehen, das ziemlich ähnlich ist.</span><span class="sxs-lookup"><span data-stu-id="ddf95-169">This will be easier to understand when we look at the Edit form, which is pretty similar.</span></span>
- <span data-ttu-id="ddf95-170">Der letzte Parameter ist die anzuzeigende Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="ddf95-170">The final parameter is the property to be displayed.</span></span> <span data-ttu-id="ddf95-171">In diesem Fall ist dies ein Hinweis darauf, dass die Genre.Name-Eigenschaft dem Benutzer angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-171">In this case, this is indicating that the Genre.Name property is what will be shown to the user.</span></span>

<span data-ttu-id="ddf95-172">Daher ist die HTTP-Get create-Aktion ziemlich einfach. zwei selectlists werden dem viewbag hinzugefügt, und es wird kein Modell Objekt an das Formular weitergegeben (da es noch nicht erstellt wurde).</span><span class="sxs-lookup"><span data-stu-id="ddf95-172">With that in mind, then, the HTTP-GET Create action is pretty simple - two SelectLists are added to the ViewBag, and no model object is passed to the form (since it hasn't been created yet).</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample7.cs)]

### <a name="html-helpers-to-display-the-drop-downs-in-the-create-view"></a><span data-ttu-id="ddf95-173">HTML-Hilfsprogramme zum Anzeigen der Dropdown Felder in der Ansicht "erstellen"</span><span class="sxs-lookup"><span data-stu-id="ddf95-173">HTML Helpers to display the Drop Downs in the Create View</span></span>

<span data-ttu-id="ddf95-174">Da wir darüber gesprochen haben, wie die Dropdown Werte an die Ansicht übergeben werden, sehen wir uns die Ansicht genauer an, um zu sehen, wie diese Werte angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-174">Since we've talked about how the drop down values are passed to the view, let's take a quick look at the view to see how those values are displayed.</span></span> <span data-ttu-id="ddf95-175">Im Ansichts Code (/Views/StoreManager/Create.cshtml) sehen Sie, dass der folgende-Befehl zum Anzeigen der Genre-Dropdown-Datei ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-175">In the view code (/Views/StoreManager/Create.cshtml), you'll see the following call is made to display the Genre drop down.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample8.cshtml)]

<span data-ttu-id="ddf95-176">Dies wird als HTML-Hilfsobjekt bezeichnet: eine hilfsprogrammmethode, die eine gängige Ansichts Aufgabe ausführt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-176">This is known as an HTML Helper - a utility method which performs a common view task.</span></span> <span data-ttu-id="ddf95-177">HTML-Hilfsprogramme sind sehr nützlich, um unseren Ansichts Code kurz und lesbar zu halten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-177">HTML Helpers are very useful in keeping our view code concise and readable.</span></span> <span data-ttu-id="ddf95-178">Das Hilfsprogramm HTML. Dropdown List wird von ASP.NET MVC bereitgestellt, aber wie wir später sehen werden, ist es möglich, unsere eigenen Hilfsprogramme zum Anzeigen von Code zu erstellen, den wir in unserer Anwendung wieder verwenden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-178">The Html.DropDownList helper is provided by ASP.NET MVC, but as we'll see later it's possible to create our own helpers for view code we'll reuse in our application.</span></span>

<span data-ttu-id="ddf95-179">Der HTML. DropDownList-Befehl muss lediglich zwei Dinge sagen können: wo soll die Liste angezeigt werden, und welcher Wert (falls vorhanden) sollte vorab ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-179">The Html.DropDownList call just needs to be told two things - where to get the list to display, and what value (if any) should be pre-selected.</span></span> <span data-ttu-id="ddf95-180">Der erste Parameter, GenreID, teilt der Dropdown Liste mit, dass im Modell oder in der viewbag nach einem Wert mit dem Namen "GenreID" gesucht werden soll.</span><span class="sxs-lookup"><span data-stu-id="ddf95-180">The first parameter, GenreId, tells the DropDownList to look for a value named GenreId in either the model or ViewBag.</span></span> <span data-ttu-id="ddf95-181">Der zweite Parameter wird verwendet, um den Wert anzugeben, der in der Dropdown Liste anfänglich ausgewählt angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="ddf95-181">The second parameter is used to indicate the value to show as initially selected in the drop down list.</span></span> <span data-ttu-id="ddf95-182">Da dieses Formular ein Erstellungs Formular ist, gibt es keinen Wert, der vorab ausgewählt werden kann, und String. Empty wird übermittelt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-182">Since this form is a Create form, there's no value to be preselected and String.Empty is passed.</span></span>

### <a name="handling-the-posted-form-values"></a><span data-ttu-id="ddf95-183">Verarbeiten der geposteten Formular Werte</span><span class="sxs-lookup"><span data-stu-id="ddf95-183">Handling the Posted Form values</span></span>

<span data-ttu-id="ddf95-184">Wie bereits erläutert, gibt es zwei Aktionsmethoden, die mit jedem Formular verknüpft sind.</span><span class="sxs-lookup"><span data-stu-id="ddf95-184">As we discussed before, there are two action methods associated with each form.</span></span> <span data-ttu-id="ddf95-185">Der erste behandelt die HTTP-GET-Anforderung und zeigt das Formular an.</span><span class="sxs-lookup"><span data-stu-id="ddf95-185">The first handles the HTTP-GET request and displays the form.</span></span> <span data-ttu-id="ddf95-186">Die zweite verarbeitet die HTTP-POST-Anforderung, die die übermittelten Formular Werte enthält.</span><span class="sxs-lookup"><span data-stu-id="ddf95-186">The second handles the HTTP-POST request, which contains the submitted form values.</span></span> <span data-ttu-id="ddf95-187">Beachten Sie, dass die Controller Aktion über ein [HttpPost]-Attribut verfügt, das ASP.NET MVC anweist, dass es nur auf HTTP-POST-Anforderungen reagieren soll.</span><span class="sxs-lookup"><span data-stu-id="ddf95-187">Notice that controller action has an [HttpPost] attribute, which tells ASP.NET MVC that it should only respond to HTTP-POST requests.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample9.cs)]

<span data-ttu-id="ddf95-188">Diese Aktion hat vier Zuständigkeiten:</span><span class="sxs-lookup"><span data-stu-id="ddf95-188">This action has four responsibilities:</span></span>

- 1. <span data-ttu-id="ddf95-189">Lesen der Formular Werte</span><span class="sxs-lookup"><span data-stu-id="ddf95-189">Read the form values</span></span>
- 2. <span data-ttu-id="ddf95-190">Überprüfen Sie, ob die Formular Werte Validierungsregeln bestehen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-190">Check if the form values pass any validation rules</span></span>
- 3. <span data-ttu-id="ddf95-191">Wenn die Formular Übermittlung gültig ist, speichern Sie die Daten, und zeigen Sie die aktualisierte Liste an.</span><span class="sxs-lookup"><span data-stu-id="ddf95-191">If the form submission is valid, save the data and display the updated list</span></span>
- 4. <span data-ttu-id="ddf95-192">Wenn die Formular Übermittlung ungültig ist, wird das Formular mit Validierungs Fehlern erneut angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-192">If the form submission is not valid, redisplay the form with validation errors</span></span>

#### <a name="reading-form-values-with-model-binding"></a><span data-ttu-id="ddf95-193">Lesen von Formular Werten mit Modell Bindung</span><span class="sxs-lookup"><span data-stu-id="ddf95-193">Reading Form Values with Model Binding</span></span>

<span data-ttu-id="ddf95-194">Die Controller Aktion verarbeitet eine Formular Übermittlung, die Werte für GenreID und artistId (aus der Dropdown Liste) und Textfeld-Werte für Title, Price und albumarturl enthält.</span><span class="sxs-lookup"><span data-stu-id="ddf95-194">The controller action is processing a form submission that includes values for GenreId and ArtistId (from the drop down list) and textbox values for Title, Price, and AlbumArtUrl.</span></span> <span data-ttu-id="ddf95-195">Obwohl es möglich ist, direkt auf Formular Werte zuzugreifen, ist es besser, die in ASP.NET MVC integrierten Funktionen für die Modell Bindung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-195">While it's possible to directly access form values, a better approach is to use the Model Binding capabilities built into ASP.NET MVC.</span></span> <span data-ttu-id="ddf95-196">Wenn eine Controller Aktion einen Modelltyp als Parameter annimmt, versucht ASP.NET MVC, ein Objekt dieses Typs mithilfe von Formular Eingaben (sowie Routen-und QueryString-Werte) aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-196">When a controller action takes a model type as a parameter, ASP.NET MVC will attempt to populate an object of that type using form inputs (as well as route and querystring values).</span></span> <span data-ttu-id="ddf95-197">Dies geschieht, indem nach Werten gesucht wird, deren Namen mit den Eigenschaften des Modell Objekts verglichen werden, z. b. beim Festlegen des GenreID-Werts des neuen Album Objekts, der nach einer Eingabe mit dem Namen "GenreID" sucht.</span><span class="sxs-lookup"><span data-stu-id="ddf95-197">It does this by looking for values whose names match properties of the model object, e.g. when setting the new Album object's GenreId value, it looks for an input with the name GenreId.</span></span> <span data-ttu-id="ddf95-198">Wenn Sie Ansichten mithilfe der Standardmethoden in ASP.NET MVC erstellen, werden die Formulare immer mithilfe von Eigenschaftsnamen als Eingabe Feldnamen gerendert, sodass die Feldnamen nur mit den Namen der Felder identisch werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-198">When you create views using the standard methods in ASP.NET MVC, the forms will always be rendered using property names as input field names, so this the field names will just match up.</span></span>

#### <a name="validating-the-model"></a><span data-ttu-id="ddf95-199">Validieren des Modells</span><span class="sxs-lookup"><span data-stu-id="ddf95-199">Validating the Model</span></span>

<span data-ttu-id="ddf95-200">Das Modell wird mit einem einfachen Befehl von "modelstate. IsValid" überprüft.</span><span class="sxs-lookup"><span data-stu-id="ddf95-200">The model is validated with a simple call to ModelState.IsValid.</span></span> <span data-ttu-id="ddf95-201">Wir haben noch keine Validierungsregeln zu unserer Album-Klasse hinzugefügt. Dies geschieht in gewisser Weise, da diese Prüfung momentan nicht viel zu tun hat.</span><span class="sxs-lookup"><span data-stu-id="ddf95-201">We haven't added any validation rules to our Album class yet - we'll do that in a bit - so right now this check doesn't have much to do.</span></span> <span data-ttu-id="ddf95-202">Wichtig ist, dass diese modelstat. IsValid-Überprüfung an die Validierungsregeln angepasst wird, die wir in unserem Modell ablegen, sodass zukünftige Änderungen an Validierungsregeln keine Aktualisierungen des Controller Aktionscodes erfordern.</span><span class="sxs-lookup"><span data-stu-id="ddf95-202">What's important is that this ModelStat.IsValid check will adapt to the validation rules we put on our model, so future changes to validation rules won't require any updates to the controller action code.</span></span>

#### <a name="saving-the-submitted-values"></a><span data-ttu-id="ddf95-203">Speichern der übermittelten Werte</span><span class="sxs-lookup"><span data-stu-id="ddf95-203">Saving the submitted values</span></span>

<span data-ttu-id="ddf95-204">Wenn die Formular Übermittlung die Überprüfung übergibt, ist es an der Zeit, die Werte in der Datenbank zu speichern.</span><span class="sxs-lookup"><span data-stu-id="ddf95-204">If the form submission passes validation, it's time to save the values to the database.</span></span> <span data-ttu-id="ddf95-205">Bei Entity Framework muss das Modell nur der Alben-Auflistung hinzugefügt und SaveChanges aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-205">With Entity Framework, that just requires adding the model to the Albums collection and calling SaveChanges.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample10.cs)]

<span data-ttu-id="ddf95-206">Entity Framework generiert die entsprechenden SQL-Befehle, um den Wert beizubehalten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-206">Entity Framework generates the appropriate SQL commands to persist the value.</span></span> <span data-ttu-id="ddf95-207">Nachdem Sie die Daten gespeichert haben, werden wir zurück zur Liste der Alben umgeleitet, damit wir das Update sehen können.</span><span class="sxs-lookup"><span data-stu-id="ddf95-207">After saving the data, we redirect back to the list of Albums so we can see our update.</span></span> <span data-ttu-id="ddf95-208">Dies erfolgt durch die Rückgabe von redirectdeaction mit dem Namen der Controller Aktion, die angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="ddf95-208">This is done by returning RedirectToAction with the name of the controller action we want displayed.</span></span> <span data-ttu-id="ddf95-209">In diesem Fall ist dies die Index Methode.</span><span class="sxs-lookup"><span data-stu-id="ddf95-209">In this case, that's the Index method.</span></span>

#### <a name="displaying-invalid-form-submissions-with-validation-errors"></a><span data-ttu-id="ddf95-210">Anzeigen Ungültiger Formular Übermittlungen mit Validierungs Fehlern</span><span class="sxs-lookup"><span data-stu-id="ddf95-210">Displaying invalid form submissions with Validation Errors</span></span>

<span data-ttu-id="ddf95-211">Im Fall einer ungültigen Formulareingabe werden die Dropdown Werte der viewbag (wie im Fall von HTTP-Get) hinzugefügt, und die gebundenen Modell Werte werden zur Anzeige an die Ansicht zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-211">In the case of invalid form input, the dropdown values are added to the ViewBag (as in the HTTP-GET case) and the bound model values are passed back to the view for display.</span></span> <span data-ttu-id="ddf95-212">Validierungs Fehler werden automatisch mithilfe der @Html.ValidationMessageFor HTML-Hilfsobjekts angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-212">Validation errors are automatically displayed using the @Html.ValidationMessageFor HTML Helper.</span></span>

#### <a name="testing-the-create-form"></a><span data-ttu-id="ddf95-213">Testen des Formulars "erstellen"</span><span class="sxs-lookup"><span data-stu-id="ddf95-213">Testing the Create Form</span></span>

<span data-ttu-id="ddf95-214">Um dies zu testen, führen Sie die Anwendung aus, und navigieren Sie zu/StoreManager/Create/. Dadurch wird das leere Formular angezeigt, das von der StoreController Create HTTP-Get-Methode zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="ddf95-214">To test this out, run the application and browse to /StoreManager/Create/ - this will show you the blank form which was returned by the StoreController Create HTTP-GET method.</span></span>

<span data-ttu-id="ddf95-215">Geben Sie einige Werte ein, und klicken Sie auf die Schaltfläche erstellen, um das Formular zu senden</span><span class="sxs-lookup"><span data-stu-id="ddf95-215">Fill in some values and click the Create button to submit the form.</span></span>

![](mvc-music-store-part-5/_static/image7.png)

![](mvc-music-store-part-5/_static/image8.png)

### <a name="handling-edits"></a><span data-ttu-id="ddf95-216">Behandeln von Änderungen</span><span class="sxs-lookup"><span data-stu-id="ddf95-216">Handling Edits</span></span>

<span data-ttu-id="ddf95-217">Das Bearbeitungs Aktions Paar (http-Get und HTTP-Post) ähnelt den Methoden zum Erstellen von Aktionen, die wir gerade gesehen haben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-217">The Edit action pair (HTTP-GET and HTTP-POST) are very similar to the Create action methods we just looked at.</span></span> <span data-ttu-id="ddf95-218">Da das Bearbeitungs Szenario das Arbeiten mit einem vorhandenen Album umfasst, lädt die Edit HTTP-Get-Methode das Album basierend auf dem Parameter "ID", der über die Route übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-218">Since the edit scenario involves working with an existing album, the Edit HTTP-GET method loads the Album based on the "id" parameter, passed in via the route.</span></span> <span data-ttu-id="ddf95-219">Dieser Code zum Abrufen eines Albums von albumId ist das gleiche, das wir zuvor in der Aktion "Details Controller" untersucht haben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-219">This code for retrieving an album by AlbumId is the same as we've previously looked at in the Details controller action.</span></span> <span data-ttu-id="ddf95-220">Wie bei der Create/HTTP-Get-Methode werden die Dropdown Werte über den viewbag zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-220">As with the Create / HTTP-GET method, the drop down values are returned via the ViewBag.</span></span> <span data-ttu-id="ddf95-221">Dadurch können wir ein Album als Modell Objekt an die Ansicht (die stark in die Album-Klasse eingegeben wird) zurückgeben und gleichzeitig zusätzliche Daten (z. b. eine Liste von Genres) über den viewbag übergeben.</span><span class="sxs-lookup"><span data-stu-id="ddf95-221">This allows us to return an Album as our model object to the view (which is strongly typed to the Album class) while passing additional data (e.g. a list of Genres) via the ViewBag.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample11.cs)]

<span data-ttu-id="ddf95-222">Die Aktion "http-Post bearbeiten" ähnelt sehr der Aktion "http-Post erstellen".</span><span class="sxs-lookup"><span data-stu-id="ddf95-222">The Edit HTTP-POST action is very similar to the Create HTTP-POST action.</span></span> <span data-ttu-id="ddf95-223">Der einzige Unterschied besteht darin, dass kein neues Album zur Datenbank hinzugefügt wird. Alben-Auflistung. die aktuelle Instanz des Albums wird mithilfe von DB gefunden. Eintrag (Album), und legen Sie seinen Status auf geändert fest.</span><span class="sxs-lookup"><span data-stu-id="ddf95-223">The only difference is that instead of adding a new album to the db.Albums collection, we're finding the current instance of the Album using db.Entry(album) and setting its state to Modified.</span></span> <span data-ttu-id="ddf95-224">Dies weist Entity Framework an, dass wir ein vorhandenes Album ändern, anstatt ein neues zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-224">This tells Entity Framework that we are modifying an existing album as opposed to creating a new one.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample12.cs)]

<span data-ttu-id="ddf95-225">Wir können dies testen, indem Sie die Anwendung ausführen und zu/StoreManger/navigieren und dann auf den Link bearbeiten für ein Album klicken.</span><span class="sxs-lookup"><span data-stu-id="ddf95-225">We can test this out by running the application and browsing to /StoreManger/, then clicking the Edit link for an album.</span></span>

![](mvc-music-store-part-5/_static/image9.png)

<span data-ttu-id="ddf95-226">Dadurch wird das Bearbeitungs Formular angezeigt, das von der Edit HTTP-Get-Methode angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-226">This displays the Edit form shown by the Edit HTTP-GET method.</span></span> <span data-ttu-id="ddf95-227">Geben Sie einige Werte ein, und klicken Sie auf die Schaltfläche speichern.</span><span class="sxs-lookup"><span data-stu-id="ddf95-227">Fill in some values and click the Save button.</span></span>

![](mvc-music-store-part-5/_static/image10.png)

<span data-ttu-id="ddf95-228">Dadurch wird das Formular gepostet, die Werte werden gespeichert, und die Liste wird zurückgegeben, und es wird angezeigt, dass die Werte aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="ddf95-228">This posts the form, saves the values, and returns us to the Album list, showing that the values were updated.</span></span>

![](mvc-music-store-part-5/_static/image11.png)

### <a name="handling-deletion"></a><span data-ttu-id="ddf95-229">Behandeln der Löschung</span><span class="sxs-lookup"><span data-stu-id="ddf95-229">Handling Deletion</span></span>

<span data-ttu-id="ddf95-230">Das Löschen folgt dem gleichen Muster wie "Bearbeiten und erstellen", wobei eine Controller Aktion zum Anzeigen des Bestätigungs Formulars verwendet wird, und eine weitere Controller Aktion zum Verarbeiten der Formular Übermittlung.</span><span class="sxs-lookup"><span data-stu-id="ddf95-230">Deletion follows the same pattern as Edit and Create, using one controller action to display the confirmation form, and another controller action to handle the form submission.</span></span>

<span data-ttu-id="ddf95-231">Die Aktion zum Löschen des HTTP-Get-Controllers ist exakt identisch mit der vorherigen Aktion für den Store Manager-Detail Controller.</span><span class="sxs-lookup"><span data-stu-id="ddf95-231">The HTTP-GET Delete controller action is exactly the same as our previous Store Manager Details controller action.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample13.cs)]

<span data-ttu-id="ddf95-232">Mit der Vorlage "Inhalt der Inhalts Vorlage löschen" wird ein Formular angezeigt, das stark typisiert ist.</span><span class="sxs-lookup"><span data-stu-id="ddf95-232">We display a form that's strongly typed to an Album type, using the Delete view content template.</span></span>

![](mvc-music-store-part-5/_static/image12.png)

<span data-ttu-id="ddf95-233">Die Vorlage "Löschen" zeigt alle Felder für das Modell an, aber wir können das Recht etwas vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-233">The Delete template shows all the fields for the model, but we can simplify that down quite a bit.</span></span> <span data-ttu-id="ddf95-234">Ändern Sie den Ansichts Code in/views/StoreManager/DELETE.cshtml in den folgenden Code.</span><span class="sxs-lookup"><span data-stu-id="ddf95-234">Change the view code in /Views/StoreManager/Delete.cshtml to the following.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample14.cshtml)]

<span data-ttu-id="ddf95-235">Dadurch wird eine vereinfachte Lösch Bestätigung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-235">This displays a simplified Delete confirmation.</span></span>

![](mvc-music-store-part-5/_static/image13.png)

<span data-ttu-id="ddf95-236">Wenn Sie auf die Schaltfläche "Löschen" klicken, wird das Formular zurück an den Server gesendet, auf dem die deleteconfirmed-Aktion ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="ddf95-236">Clicking the Delete button causes the form to be posted back to the server, which executes the DeleteConfirmed action.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample15.cs)]

<span data-ttu-id="ddf95-237">Unsere HTTP-Post-Aktion zum Löschen des Controllers führt die folgenden Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="ddf95-237">Our HTTP-POST Delete Controller Action takes the following actions:</span></span>

- 1. <span data-ttu-id="ddf95-238">Lädt das Album nach ID.</span><span class="sxs-lookup"><span data-stu-id="ddf95-238">Loads the Album by ID</span></span>
- 2. <span data-ttu-id="ddf95-239">Löscht das Album und speichert die Änderungen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-239">Deletes it the album and save changes</span></span>
- 3. <span data-ttu-id="ddf95-240">Leitet an den Index weiter und zeigt an, dass das Album aus der Liste entfernt wurde.</span><span class="sxs-lookup"><span data-stu-id="ddf95-240">Redirects to the Index, showing that the Album was removed from the list</span></span>

<span data-ttu-id="ddf95-241">Um dies zu testen, führen Sie die Anwendung aus, und navigieren Sie zu/StoreManager.</span><span class="sxs-lookup"><span data-stu-id="ddf95-241">To test this, run the application and browse to /StoreManager.</span></span> <span data-ttu-id="ddf95-242">Wählen Sie ein Album aus der Liste aus, und klicken Sie auf den Link löschen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-242">Select an album from the list and click the Delete link.</span></span>

![](mvc-music-store-part-5/_static/image14.png)

<span data-ttu-id="ddf95-243">Dadurch wird der Bestätigungsbildschirm für den Löschvorgang angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-243">This displays our Delete confirmation screen.</span></span>

![](mvc-music-store-part-5/_static/image15.png)

<span data-ttu-id="ddf95-244">Wenn Sie auf die Schaltfläche "Löschen" klicken, wird das Album entfernt und die Seite "Store Manager Index" zurückgegeben, die anzeigt, dass das Album gelöscht wurde.</span><span class="sxs-lookup"><span data-stu-id="ddf95-244">Clicking the Delete button removes the album and returns us to the Store Manager Index page, which shows that the album has been deleted.</span></span>

![](mvc-music-store-part-5/_static/image16.png)

### <a name="using-a-custom-html-helper-to-truncate-text"></a><span data-ttu-id="ddf95-245">Verwenden eines benutzerdefinierten HTML-Hilfsprogramms zum Abschneiden von Text</span><span class="sxs-lookup"><span data-stu-id="ddf95-245">Using a custom HTML Helper to truncate text</span></span>

<span data-ttu-id="ddf95-246">Wir haben ein mögliches Problem mit unserer Store Manager-Index Seite.</span><span class="sxs-lookup"><span data-stu-id="ddf95-246">We've got one potential issue with our Store Manager Index page.</span></span> <span data-ttu-id="ddf95-247">Die Eigenschaften "Album Titel" und "Artist Name" können so lange ausreichen, dass Sie die Tabellen Formatierung auslösen könnten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-247">Our Album Title and Artist Name properties can both be long enough that they could throw off our table formatting.</span></span> <span data-ttu-id="ddf95-248">Wir erstellen ein benutzerdefiniertes HTML-Hilfsprogramm, mit dem wir diese und andere Eigenschaften in unseren Ansichten problemlos abschneiden können.</span><span class="sxs-lookup"><span data-stu-id="ddf95-248">We'll create a custom HTML Helper to allow us to easily truncate these and other properties in our Views.</span></span>

![](mvc-music-store-part-5/_static/image17.png)

<span data-ttu-id="ddf95-249">Die @helper Syntax von Razor vereinfacht das Erstellen eigener Hilfsfunktionen für die Verwendung in ihren Ansichten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-249">Razor's @helper syntax has made it pretty easy to create your own helper functions for use in your views.</span></span> <span data-ttu-id="ddf95-250">Öffnen Sie die/Views/StoreManager/Index.cshtml-Ansicht, und fügen Sie den folgenden Code direkt nach der @model Zeile ein.</span><span class="sxs-lookup"><span data-stu-id="ddf95-250">Open the /Views/StoreManager/Index.cshtml view and add the following code directly after the @model line.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample16.cshtml)]

<span data-ttu-id="ddf95-251">Diese Hilfsmethode nimmt eine Zeichenfolge und eine maximale Länge an, um dies zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-251">This helper method takes a string and a maximum length to allow.</span></span> <span data-ttu-id="ddf95-252">Wenn der angegebene Text kürzer als die angegebene Länge ist, gibt das Hilfsprogramm ihn unverändert aus.</span><span class="sxs-lookup"><span data-stu-id="ddf95-252">If the text supplied is shorter than the length specified, the helper outputs it as-is.</span></span> <span data-ttu-id="ddf95-253">Wenn er länger ist, wird der Text abgeschnitten und "..." gerendert. für den Rest.</span><span class="sxs-lookup"><span data-stu-id="ddf95-253">If it is longer, then it truncates the text and renders "…" for the remainder.</span></span>

<span data-ttu-id="ddf95-254">Nun können wir unsere TRUNCATE-Hilfsmethode verwenden, um sicherzustellen, dass die Eigenschaften "Album Titel" und "Name des Künstlers" weniger als 25 Zeichen umfassen.</span><span class="sxs-lookup"><span data-stu-id="ddf95-254">Now we can use our Truncate helper to ensure that both the Album Title and Artist Name properties are less than 25 characters.</span></span> <span data-ttu-id="ddf95-255">Der gesamte Ansichts Code, der das neue TRUNCATE Helper verwendet, wird unten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ddf95-255">The complete view code using our new Truncate helper appears below.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample17.cshtml)]

<span data-ttu-id="ddf95-256">Wenn wir nun die/StoreManager/-URL durchsuchen, werden die Alben und Titel unter unsere maximale Länge beibehalten.</span><span class="sxs-lookup"><span data-stu-id="ddf95-256">Now when we browse the /StoreManager/ URL, the albums and titles are kept below our maximum lengths.</span></span>

![](mvc-music-store-part-5/_static/image18.png)

<span data-ttu-id="ddf95-257">Hinweis: Dies zeigt die einfache Groß-/Kleinschreibung beim Erstellen und Verwenden eines-Hilfsprogramms in einer Ansicht.</span><span class="sxs-lookup"><span data-stu-id="ddf95-257">Note: This shows the simple case of creating and using a helper in one view.</span></span> <span data-ttu-id="ddf95-258">Weitere Informationen zum Erstellen von Hilfsprogrammen, die Sie in Ihrer Website verwenden können, finden Sie in meinem Blogbeitrag: [http://bit.ly/mvc3-helper-options](http://bit.ly/mvc3-helper-options)</span><span class="sxs-lookup"><span data-stu-id="ddf95-258">To learn more about creating helpers that you can use throughout your site, see my blog post: [http://bit.ly/mvc3-helper-options](http://bit.ly/mvc3-helper-options)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ddf95-259">[Zurück](mvc-music-store-part-4.md)
> [Weiter](mvc-music-store-part-6.md)</span><span class="sxs-lookup"><span data-stu-id="ddf95-259">[Previous](mvc-music-store-part-4.md)
[Next](mvc-music-store-part-6.md)</span></span>
