---
uid: web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations
title: Aktivieren von CRUD-Vorgängen in ASP.net-Web-API 1-ASP.NET 4. x
author: MikeWasson
description: Tutorial zeigt, wie CRUD-Vorgänge in einem HTTP-Dienst unterstützt werden, indem ASP.net-Web-API für ASP.NET 4. x verwendet wird.
ms.author: riande
ms.date: 01/28/2012
ms.custom: seoapril2019
ms.assetid: c125ca47-606a-4d6f-a1fc-1fc62928af93
msc.legacyurl: /web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations
msc.type: authoredcontent
ms.openlocfilehash: a096fd1c54df33b40115907a5c2517b2e3fec5b8
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74600336"
---
# <a name="enabling-crud-operations-in-aspnet-web-api-1"></a><span data-ttu-id="1cb82-103">Aktivieren von CRUD-Vorgängen in ASP.net-Web-API 1</span><span class="sxs-lookup"><span data-stu-id="1cb82-103">Enabling CRUD Operations in ASP.NET Web API 1</span></span>

<span data-ttu-id="1cb82-104">von [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="1cb82-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

[<span data-ttu-id="1cb82-105">Herunterladen des abgeschlossenen Projekts</span><span class="sxs-lookup"><span data-stu-id="1cb82-105">Download Completed Project</span></span>](https://code.msdn.microsoft.com/ASP-NET-Web-API-Tutorial-c4761894)

> <span data-ttu-id="1cb82-106">In diesem Tutorial wird gezeigt, wie CRUD-Vorgänge in einem HTTP-Dienst mithilfe von ASP.net-Web-API für ASP.NET 4. x unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="1cb82-106">This tutorial shows how to support CRUD operations in an HTTP service using ASP.NET Web API for ASP.NET 4.x.</span></span>
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="1cb82-107">Im Tutorial verwendete Software Versionen</span><span class="sxs-lookup"><span data-stu-id="1cb82-107">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="1cb82-108">Visual Studio 2012</span><span class="sxs-lookup"><span data-stu-id="1cb82-108">Visual Studio 2012</span></span>
> - <span data-ttu-id="1cb82-109">Web-API 1 (funktioniert auch mit der Web-API 2)</span><span class="sxs-lookup"><span data-stu-id="1cb82-109">Web API 1 (also works with Web API 2)</span></span>

<span data-ttu-id="1cb82-110">CRUD steht für &quot;erstellen, lesen, aktualisieren und löschen,&quot; den vier grundlegenden Daten Bank Vorgängen.</span><span class="sxs-lookup"><span data-stu-id="1cb82-110">CRUD stands for &quot;Create, Read, Update, and Delete,&quot; which are the four basic database operations.</span></span> <span data-ttu-id="1cb82-111">Viele HTTP-Dienste modellieren auch CRUD-Vorgänge über Rest-oder Rest-ähnliche APIs.</span><span class="sxs-lookup"><span data-stu-id="1cb82-111">Many HTTP services also model CRUD operations through REST or REST-like APIs.</span></span>

<span data-ttu-id="1cb82-112">In diesem Tutorial erstellen Sie eine sehr einfache Web-API, um eine Liste von Produkten zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="1cb82-112">In this tutorial, you will build a very simple web API to manage a list of products.</span></span> <span data-ttu-id="1cb82-113">Jedes Produkt enthält einen Namen, einen Preis und eine Kategorie (z. b. &quot;Toys&quot; oder &quot;Hardware&quot;) sowie eine Produkt-ID.</span><span class="sxs-lookup"><span data-stu-id="1cb82-113">Each product will contain a name, price, and category (such as &quot;toys&quot; or &quot;hardware&quot;), plus a product ID.</span></span>

<span data-ttu-id="1cb82-114">Die Products-API macht die folgenden Methoden verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1cb82-114">The products API will expose following methods.</span></span>

| <span data-ttu-id="1cb82-115">-Aktion</span><span class="sxs-lookup"><span data-stu-id="1cb82-115">Action</span></span> | <span data-ttu-id="1cb82-116">HTTP-Methode</span><span class="sxs-lookup"><span data-stu-id="1cb82-116">HTTP method</span></span> | <span data-ttu-id="1cb82-117">Relativer URI</span><span class="sxs-lookup"><span data-stu-id="1cb82-117">Relative URI</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1cb82-118">Abrufen einer Liste aller Produkte</span><span class="sxs-lookup"><span data-stu-id="1cb82-118">Get a list of all products</span></span> | <span data-ttu-id="1cb82-119">GET</span><span class="sxs-lookup"><span data-stu-id="1cb82-119">GET</span></span> | <span data-ttu-id="1cb82-120">/api/products</span><span class="sxs-lookup"><span data-stu-id="1cb82-120">/api/products</span></span> |
| <span data-ttu-id="1cb82-121">Produkt nach ID erhalten</span><span class="sxs-lookup"><span data-stu-id="1cb82-121">Get a product by ID</span></span> | <span data-ttu-id="1cb82-122">GET</span><span class="sxs-lookup"><span data-stu-id="1cb82-122">GET</span></span> | <span data-ttu-id="1cb82-123">/API/Products/-*ID*</span><span class="sxs-lookup"><span data-stu-id="1cb82-123">/api/products/*id*</span></span> |
| <span data-ttu-id="1cb82-124">Produkt nach Kategorie</span><span class="sxs-lookup"><span data-stu-id="1cb82-124">Get a product by category</span></span> | <span data-ttu-id="1cb82-125">GET</span><span class="sxs-lookup"><span data-stu-id="1cb82-125">GET</span></span> | <span data-ttu-id="1cb82-126">/API/Products? Category =*Kategorie*</span><span class="sxs-lookup"><span data-stu-id="1cb82-126">/api/products?category=*category*</span></span> |
| <span data-ttu-id="1cb82-127">Erstellen eines neuen Produkts</span><span class="sxs-lookup"><span data-stu-id="1cb82-127">Create a new product</span></span> | <span data-ttu-id="1cb82-128">POST</span><span class="sxs-lookup"><span data-stu-id="1cb82-128">POST</span></span> | <span data-ttu-id="1cb82-129">/api/products</span><span class="sxs-lookup"><span data-stu-id="1cb82-129">/api/products</span></span> |
| <span data-ttu-id="1cb82-130">Aktualisieren eines Produkts</span><span class="sxs-lookup"><span data-stu-id="1cb82-130">Update a product</span></span> | <span data-ttu-id="1cb82-131">PUT</span><span class="sxs-lookup"><span data-stu-id="1cb82-131">PUT</span></span> | <span data-ttu-id="1cb82-132">/API/Products/-*ID*</span><span class="sxs-lookup"><span data-stu-id="1cb82-132">/api/products/*id*</span></span> |
| <span data-ttu-id="1cb82-133">Löschen eines Produkts</span><span class="sxs-lookup"><span data-stu-id="1cb82-133">Delete a product</span></span> | <span data-ttu-id="1cb82-134">LÖSCHEN</span><span class="sxs-lookup"><span data-stu-id="1cb82-134">DELETE</span></span> | <span data-ttu-id="1cb82-135">/API/Products/-*ID*</span><span class="sxs-lookup"><span data-stu-id="1cb82-135">/api/products/*id*</span></span> |

<span data-ttu-id="1cb82-136">Beachten Sie, dass einige der URIs die Produkt-ID im Pfad enthalten.</span><span class="sxs-lookup"><span data-stu-id="1cb82-136">Notice that some of the URIs include the product ID in path.</span></span> <span data-ttu-id="1cb82-137">Um z. b. das Produkt mit der ID 28 zu erhalten, sendet der Client eine GET-Anforderung für `http://hostname/api/products/28`.</span><span class="sxs-lookup"><span data-stu-id="1cb82-137">For example, to get the product whose ID is 28, the client sends a GET request for `http://hostname/api/products/28`.</span></span>

### <a name="resources"></a><span data-ttu-id="1cb82-138">Ressourcen</span><span class="sxs-lookup"><span data-stu-id="1cb82-138">Resources</span></span>

<span data-ttu-id="1cb82-139">Die Products-API definiert URIs für zwei Ressourcentypen:</span><span class="sxs-lookup"><span data-stu-id="1cb82-139">The products API defines URIs for two resource types:</span></span>

| <span data-ttu-id="1cb82-140">Ressource</span><span class="sxs-lookup"><span data-stu-id="1cb82-140">Resource</span></span> | <span data-ttu-id="1cb82-141">URI</span><span class="sxs-lookup"><span data-stu-id="1cb82-141">URI</span></span> |
| --- | --- |
| <span data-ttu-id="1cb82-142">Die Liste aller Produkte.</span><span class="sxs-lookup"><span data-stu-id="1cb82-142">The list of all the products.</span></span> | <span data-ttu-id="1cb82-143">/api/products</span><span class="sxs-lookup"><span data-stu-id="1cb82-143">/api/products</span></span> |
| <span data-ttu-id="1cb82-144">Ein einzelnes Produkt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-144">An individual product.</span></span> | <span data-ttu-id="1cb82-145">/API/Products/-*ID*</span><span class="sxs-lookup"><span data-stu-id="1cb82-145">/api/products/*id*</span></span> |

### <a name="methods"></a><span data-ttu-id="1cb82-146">Methoden</span><span class="sxs-lookup"><span data-stu-id="1cb82-146">Methods</span></span>

<span data-ttu-id="1cb82-147">Die vier http-Hauptmethoden (Get, Put, Post und DELETE) können CRUD-Vorgängen folgendermaßen zugeordnet werden:</span><span class="sxs-lookup"><span data-stu-id="1cb82-147">The four main HTTP methods (GET, PUT, POST, and DELETE) can be mapped to CRUD operations as follows:</span></span>

- <span data-ttu-id="1cb82-148">Get ruft die Darstellung der Ressource an einem angegebenen URI ab.</span><span class="sxs-lookup"><span data-stu-id="1cb82-148">GET retrieves the representation of the resource at a specified URI.</span></span> <span data-ttu-id="1cb82-149">Get sollte keine Nebeneffekte auf dem Server haben.</span><span class="sxs-lookup"><span data-stu-id="1cb82-149">GET should have no side effects on the server.</span></span>
- <span data-ttu-id="1cb82-150">Put aktualisiert eine Ressource an einem angegebenen URI.</span><span class="sxs-lookup"><span data-stu-id="1cb82-150">PUT updates a resource at a specified URI.</span></span> <span data-ttu-id="1cb82-151">Put kann auch verwendet werden, um eine neue Ressource an einem angegebenen URI zu erstellen, wenn der Server es Clients ermöglicht, neue URIs anzugeben.</span><span class="sxs-lookup"><span data-stu-id="1cb82-151">PUT can also be used to create a new resource at a specified URI, if the server allows clients to specify new URIs.</span></span> <span data-ttu-id="1cb82-152">In diesem Tutorial wird die Erstellung durch Put von der API nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-152">For this tutorial, the API will not support creation through PUT.</span></span>
- <span data-ttu-id="1cb82-153">Post erstellt eine neue Ressource.</span><span class="sxs-lookup"><span data-stu-id="1cb82-153">POST creates a new resource.</span></span> <span data-ttu-id="1cb82-154">Der Server weist den URI für das neue-Objekt zu und gibt diesen URI als Teil der Antwortnachricht zurück.</span><span class="sxs-lookup"><span data-stu-id="1cb82-154">The server assigns the URI for the new object and returns this URI as part of the response message.</span></span>
- <span data-ttu-id="1cb82-155">DELETE Löscht eine Ressource an einem angegebenen URI.</span><span class="sxs-lookup"><span data-stu-id="1cb82-155">DELETE deletes a resource at a specified URI.</span></span>

<span data-ttu-id="1cb82-156">Hinweis: die Put-Methode ersetzt die gesamte Product-Entität.</span><span class="sxs-lookup"><span data-stu-id="1cb82-156">Note: The PUT method replaces the entire product entity.</span></span> <span data-ttu-id="1cb82-157">Das heißt, der Client wird erwartet, dass er eine komplette Darstellung des aktualisierten Produkts sendet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-157">That is, the client is expected to send a complete representation of the updated product.</span></span> <span data-ttu-id="1cb82-158">Wenn Sie Teil Aktualisierungen unterstützen möchten, wird die Patch-Methode bevorzugt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-158">If you want to support partial updates, the PATCH method is preferred.</span></span> <span data-ttu-id="1cb82-159">In diesem Tutorial wird Patch nicht implementiert.</span><span class="sxs-lookup"><span data-stu-id="1cb82-159">This tutorial does not implement PATCH.</span></span>

## <a name="create-a-new-web-api-project"></a><span data-ttu-id="1cb82-160">Erstellen eines neuen Web-API-Projekts</span><span class="sxs-lookup"><span data-stu-id="1cb82-160">Create a New Web API Project</span></span>

<span data-ttu-id="1cb82-161">Führen Sie zunächst Visual Studio aus, und wählen Sie auf der **Start** Seite die Option **Neues Projekt** aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-161">Start by running Visual Studio and select **New Project** from the **Start** page.</span></span> <span data-ttu-id="1cb82-162">Oder wählen Sie im Menü **Datei** die Option **neu** und dann **Projekt**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-162">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="1cb82-163">Wählen Sie im Bereich **Vorlagen** die Option **installierte Vorlagen** aus, und erweitern Sie den Knoten **visuelle C#**  Knoten.</span><span class="sxs-lookup"><span data-stu-id="1cb82-163">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="1cb82-164">Wählen Sie unter **Visualisierung C#** die Option **Web**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-164">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="1cb82-165">Wählen Sie in der Liste der Projektvorlagen die Option **ASP.NET MVC 4-Webanwendung**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-165">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="1cb82-166">Nennen Sie das Projekt &quot;productstore-&quot;, und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cb82-166">Name the project &quot;ProductStore&quot; and click **OK**.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image1.png)

<span data-ttu-id="1cb82-167">Wählen Sie im Dialogfeld **Neues ASP.NET MVC 4-Projekt** die Option **Web API** aus, und klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="1cb82-167">In the **New ASP.NET MVC 4 Project** dialog, select **Web API** and click **OK**.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image2.png)

## <a name="adding-a-model"></a><span data-ttu-id="1cb82-168">Hinzufügen eines Modells</span><span class="sxs-lookup"><span data-stu-id="1cb82-168">Adding a Model</span></span>

<span data-ttu-id="1cb82-169">Ein *Modell* ist ein Objekt, das die Daten in Ihrer Anwendung darstellt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-169">A *model* is an object that represents the data in your application.</span></span> <span data-ttu-id="1cb82-170">In ASP.net-Web-API können Sie stark typisierte CLR-Objekte als Modelle verwenden, die automatisch in XML oder JSON für den Client serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="1cb82-170">In ASP.NET Web API, you can use strongly typed CLR objects as models, and they will automatically be serialized to XML or JSON for the client.</span></span>

<span data-ttu-id="1cb82-171">Bei der productstore-API bestehen unsere Daten aus Produkten. Daher erstellen wir eine neue Klasse mit dem Namen "`Product`".</span><span class="sxs-lookup"><span data-stu-id="1cb82-171">For the ProductStore API, our data consists of products, so we'll create a new class named `Product`.</span></span>

<span data-ttu-id="1cb82-172">Wenn Projektmappen-Explorer nicht bereits sichtbar ist, klicken Sie auf das Menü **Ansicht** , und wählen Sie **Projektmappen-Explorer**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-172">If Solution Explorer is not already visible, click the **View** menu and select **Solution Explorer**.</span></span> <span data-ttu-id="1cb82-173">Klicken Sie in Projektmappen-Explorer mit der rechten Maustaste auf den Ordner **Modelle** .</span><span class="sxs-lookup"><span data-stu-id="1cb82-173">In Solution Explorer, right-click the **Models** folder.</span></span> <span data-ttu-id="1cb82-174">Klicken Sie im Kontextmenü auf **Hinzufügen**, und wählen Sie dann **Klasse**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-174">From the context menu, select **Add**, then select **Class**.</span></span> <span data-ttu-id="1cb82-175">Benennen Sie die Klasse &quot;Product&quot;.</span><span class="sxs-lookup"><span data-stu-id="1cb82-175">Name the class &quot;Product&quot;.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image3.png)

<span data-ttu-id="1cb82-176">Fügen Sie der `Product`-Klasse die folgenden Eigenschaften hinzu.</span><span class="sxs-lookup"><span data-stu-id="1cb82-176">Add the following properties to the `Product` class.</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample1.cs)]

## <a name="adding-a-repository"></a><span data-ttu-id="1cb82-177">Hinzufügen eines Repositorys</span><span class="sxs-lookup"><span data-stu-id="1cb82-177">Adding a Repository</span></span>

<span data-ttu-id="1cb82-178">Wir müssen eine Sammlung von Produkten speichern.</span><span class="sxs-lookup"><span data-stu-id="1cb82-178">We need to store a collection of products.</span></span> <span data-ttu-id="1cb82-179">Es empfiehlt sich, die Sammlung von unserer Dienst Implementierung zu trennen.</span><span class="sxs-lookup"><span data-stu-id="1cb82-179">It's a good idea to separate the collection from our service implementation.</span></span> <span data-ttu-id="1cb82-180">Auf diese Weise können wir den Sicherungs Speicher ändern, ohne die Dienstklasse neu zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="1cb82-180">That way, we can change the backing store without rewriting the service class.</span></span> <span data-ttu-id="1cb82-181">Diese Art von Entwurf wird als *Repository* -Muster bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-181">This type of design is called the *repository* pattern.</span></span> <span data-ttu-id="1cb82-182">Definieren Sie zunächst eine generische Schnittstelle für das Repository.</span><span class="sxs-lookup"><span data-stu-id="1cb82-182">Start by defining a generic interface for the repository.</span></span>

<span data-ttu-id="1cb82-183">Klicken Sie in Projektmappen-Explorer mit der rechten Maustaste auf den Ordner **Modelle** .</span><span class="sxs-lookup"><span data-stu-id="1cb82-183">In Solution Explorer, right-click the **Models** folder.</span></span> <span data-ttu-id="1cb82-184">Wählen Sie **Hinzufügen**und dann **Neues Element**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-184">Select **Add**, then select **New Item**.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image4.png)

<span data-ttu-id="1cb82-185">Wählen Sie im Bereich **Vorlagen** die Option **installierte Vorlagen** aus, C# und erweitern Sie den Knoten.</span><span class="sxs-lookup"><span data-stu-id="1cb82-185">In the **Templates** pane, select **Installed Templates** and expand the C# node.</span></span> <span data-ttu-id="1cb82-186">Wählen C#Sie unter die Option **Code**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-186">Under C#, select **Code**.</span></span> <span data-ttu-id="1cb82-187">Wählen Sie in der Liste der Code Vorlagen die Option **Schnittstelle**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-187">In the list of code templates, select **Interface**.</span></span> <span data-ttu-id="1cb82-188">Benennen Sie die Schnittstelle &quot;iproductrepository&quot;.</span><span class="sxs-lookup"><span data-stu-id="1cb82-188">Name the interface &quot;IProductRepository&quot;.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image5.png)

<span data-ttu-id="1cb82-189">Fügen Sie die folgende Implementierung hinzu:</span><span class="sxs-lookup"><span data-stu-id="1cb82-189">Add the following implementation:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample2.cs)]

<span data-ttu-id="1cb82-190">Fügen Sie nun dem Ordner Models eine weitere Klasse mit dem Namen &quot;productrepository hinzu.&quot; diese Klasse implementiert die `IProductRepository`-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="1cb82-190">Now add another class to the Models folder, named &quot;ProductRepository.&quot; This class will implement the `IProductRepository` interface.</span></span> <span data-ttu-id="1cb82-191">Fügen Sie die folgende Implementierung hinzu:</span><span class="sxs-lookup"><span data-stu-id="1cb82-191">Add the following implementation:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample3.cs)]

<span data-ttu-id="1cb82-192">Das Repository speichert die Liste im lokalen Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="1cb82-192">The repository keeps the list in local memory.</span></span> <span data-ttu-id="1cb82-193">Dies ist für ein Tutorial in Ordnung, aber in einer echten Anwendung würden Sie die Daten extern speichern. dabei handelt es sich entweder um eine Datenbank oder um einen cloudspeicher.</span><span class="sxs-lookup"><span data-stu-id="1cb82-193">This is OK for a tutorial, but in a real application, you would store the data externally, either a database or in cloud storage.</span></span> <span data-ttu-id="1cb82-194">Das Repository-Muster vereinfacht das spätere Ändern der Implementierung.</span><span class="sxs-lookup"><span data-stu-id="1cb82-194">The repository pattern will make it easier to change the implementation later.</span></span>

## <a name="adding-a-web-api-controller"></a><span data-ttu-id="1cb82-195">Hinzufügen eines Web-API-Controllers</span><span class="sxs-lookup"><span data-stu-id="1cb82-195">Adding a Web API Controller</span></span>

<span data-ttu-id="1cb82-196">Wenn Sie mit ASP.NET MVC gearbeitet haben, sind Sie bereits mit Controllern vertraut.</span><span class="sxs-lookup"><span data-stu-id="1cb82-196">If you have worked with ASP.NET MVC, then you are already familiar with controllers.</span></span> <span data-ttu-id="1cb82-197">In ASP.net-Web-API ist ein *Controller* eine Klasse, die HTTP-Anforderungen vom Client verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-197">In ASP.NET Web API, a *controller* is a class that handles HTTP requests from the client.</span></span> <span data-ttu-id="1cb82-198">Der Assistent für neue Projekte hat bei der Erstellung des Projekts zwei Controller erstellt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-198">The New Project wizard created two controllers for you when it created the project.</span></span> <span data-ttu-id="1cb82-199">Um diese anzuzeigen, erweitern Sie den Ordner Controllers in Projektmappen-Explorer.</span><span class="sxs-lookup"><span data-stu-id="1cb82-199">To see them, expand the Controllers folder in Solution Explorer.</span></span>

- <span data-ttu-id="1cb82-200">HomeController ist ein herkömmlicher ASP.NET-MVC-Controller.</span><span class="sxs-lookup"><span data-stu-id="1cb82-200">HomeController is a traditional ASP.NET MVC controller.</span></span> <span data-ttu-id="1cb82-201">Er ist verantwortlich für die Bereitstellung von HTML-Seiten für die Website und ist nicht direkt mit unserer Web-API verknüpft.</span><span class="sxs-lookup"><span data-stu-id="1cb82-201">It is responsible for serving HTML pages for the site, and is not directly related to our web API.</span></span>
- <span data-ttu-id="1cb82-202">Valuescontroller ist ein Beispiel für einen WebAPI-Controller.</span><span class="sxs-lookup"><span data-stu-id="1cb82-202">ValuesController is an example WebAPI controller.</span></span>

<span data-ttu-id="1cb82-203">Löschen Sie valuescontroller, indem Sie in Projektmappen-Explorer mit der rechten Maustaste auf die Datei klicken und dann **Löschen auswählen.**</span><span class="sxs-lookup"><span data-stu-id="1cb82-203">Go ahead and delete ValuesController, by right-clicking the file in Solution Explorer and selecting **Delete.**</span></span> <span data-ttu-id="1cb82-204">Fügen Sie nun wie folgt einen neuen Controller hinzu:</span><span class="sxs-lookup"><span data-stu-id="1cb82-204">Now add a new controller, as follows:</span></span>

<span data-ttu-id="1cb82-205">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf den Ordner Controller.</span><span class="sxs-lookup"><span data-stu-id="1cb82-205">In **Solution Explorer**, right-click the Controllers folder.</span></span> <span data-ttu-id="1cb82-206">Wählen Sie **Hinzufügen** , und wählen Sie dann **Controller**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-206">Select **Add** and then select **Controller**.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image6.png)

<span data-ttu-id="1cb82-207">Benennen Sie im Assistenten zum **Hinzufügen von Controllern** den Controller &quot;ProductController-&quot;.</span><span class="sxs-lookup"><span data-stu-id="1cb82-207">In the **Add Controller** wizard, name the controller &quot;ProductsController&quot;.</span></span> <span data-ttu-id="1cb82-208">Wählen Sie in der Dropdown Liste **Vorlage** die Option **leerer API-Controller**aus.</span><span class="sxs-lookup"><span data-stu-id="1cb82-208">In the **Template** drop-down list, select **Empty API Controller**.</span></span> <span data-ttu-id="1cb82-209">Klicken Sie anschließend auf **Hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="1cb82-209">Then click **Add**.</span></span>

![](creating-a-web-api-that-supports-crud-operations/_static/image7.png)

> [!NOTE]
> <span data-ttu-id="1cb82-210">Die Controller müssen nicht in einem Ordner mit dem Namen "Controllers" abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="1cb82-210">It is not necessary to put your controllers into a folder named Controllers.</span></span> <span data-ttu-id="1cb82-211">Der Ordnername ist nicht wichtig. Es ist einfach eine bequeme Methode zum Organisieren der Quelldateien.</span><span class="sxs-lookup"><span data-stu-id="1cb82-211">The folder name is not important; it is simply a convenient way to organize your source files.</span></span>

<span data-ttu-id="1cb82-212">Der Assistent zum **Hinzufügen** von Controllern erstellt eine Datei namens ProductsController.cs im Ordner Controllers.</span><span class="sxs-lookup"><span data-stu-id="1cb82-212">The **Add Controller** wizard will create a file named ProductsController.cs in the Controllers folder.</span></span> <span data-ttu-id="1cb82-213">Wenn diese Datei nicht bereits geöffnet ist, doppelklicken Sie auf die Datei, um Sie zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="1cb82-213">If this file is not open already, double-click the file to open it.</span></span> <span data-ttu-id="1cb82-214">Fügen Sie die folgende **using** -Anweisung hinzu:</span><span class="sxs-lookup"><span data-stu-id="1cb82-214">Add the following **using** statement:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample4.cs)]

<span data-ttu-id="1cb82-215">Fügen Sie ein Feld hinzu, das eine **iproductrepository** -Instanz enthält.</span><span class="sxs-lookup"><span data-stu-id="1cb82-215">Add a field that holds an **IProductRepository** instance.</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample5.cs)]

> [!NOTE]
> <span data-ttu-id="1cb82-216">Das Aufrufen von `new ProductRepository()` im Controller ist nicht das beste Design, da es den Controller an eine bestimmte Implementierung von `IProductRepository`bindet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-216">Calling `new ProductRepository()` in the controller is not the best design, because it ties the controller to a particular implementation of `IProductRepository`.</span></span> <span data-ttu-id="1cb82-217">Einen besseren Ansatz finden Sie unter [Verwenden des Web-API-Abhängigkeits Konflikt Lösers](../advanced/dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="1cb82-217">For a better approach, see [Using the Web API Dependency Resolver](../advanced/dependency-injection.md).</span></span>

## <a name="getting-a-resource"></a><span data-ttu-id="1cb82-218">Eine Ressource wird erhalten.</span><span class="sxs-lookup"><span data-stu-id="1cb82-218">Getting a Resource</span></span>

<span data-ttu-id="1cb82-219">Die productstore-API macht mehrere &quot;Lese&quot; Aktionen als HTTP Get-Methoden verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1cb82-219">The ProductStore API will expose several &quot;read&quot; actions as HTTP GET methods.</span></span> <span data-ttu-id="1cb82-220">Jede Aktion entspricht einer Methode in der `ProductsController`-Klasse.</span><span class="sxs-lookup"><span data-stu-id="1cb82-220">Each action will correspond to a method in the `ProductsController` class.</span></span>

| <span data-ttu-id="1cb82-221">-Aktion</span><span class="sxs-lookup"><span data-stu-id="1cb82-221">Action</span></span> | <span data-ttu-id="1cb82-222">HTTP-Methode</span><span class="sxs-lookup"><span data-stu-id="1cb82-222">HTTP method</span></span> | <span data-ttu-id="1cb82-223">Relativer URI</span><span class="sxs-lookup"><span data-stu-id="1cb82-223">Relative URI</span></span> |
| --- | --- | --- |
| <span data-ttu-id="1cb82-224">Abrufen einer Liste aller Produkte</span><span class="sxs-lookup"><span data-stu-id="1cb82-224">Get a list of all products</span></span> | <span data-ttu-id="1cb82-225">GET</span><span class="sxs-lookup"><span data-stu-id="1cb82-225">GET</span></span> | <span data-ttu-id="1cb82-226">/api/products</span><span class="sxs-lookup"><span data-stu-id="1cb82-226">/api/products</span></span> |
| <span data-ttu-id="1cb82-227">Produkt nach ID erhalten</span><span class="sxs-lookup"><span data-stu-id="1cb82-227">Get a product by ID</span></span> | <span data-ttu-id="1cb82-228">GET</span><span class="sxs-lookup"><span data-stu-id="1cb82-228">GET</span></span> | <span data-ttu-id="1cb82-229">/API/Products/-*ID*</span><span class="sxs-lookup"><span data-stu-id="1cb82-229">/api/products/*id*</span></span> |
| <span data-ttu-id="1cb82-230">Produkt nach Kategorie</span><span class="sxs-lookup"><span data-stu-id="1cb82-230">Get a product by category</span></span> | <span data-ttu-id="1cb82-231">GET</span><span class="sxs-lookup"><span data-stu-id="1cb82-231">GET</span></span> | <span data-ttu-id="1cb82-232">/API/Products? Category =*Kategorie*</span><span class="sxs-lookup"><span data-stu-id="1cb82-232">/api/products?category=*category*</span></span> |

<span data-ttu-id="1cb82-233">Fügen Sie der `ProductsController`-Klasse die folgende Methode hinzu, um die Liste aller Produkte zu erhalten:</span><span class="sxs-lookup"><span data-stu-id="1cb82-233">To get the list of all products, add this method to the `ProductsController` class:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample6.cs)]

<span data-ttu-id="1cb82-234">Der Methodenname beginnt mit &quot;Get-&quot;, sodass er den Get-Anforderungen entspricht.</span><span class="sxs-lookup"><span data-stu-id="1cb82-234">The method name starts with &quot;Get&quot;, so by convention it maps to GET requests.</span></span> <span data-ttu-id="1cb82-235">Da die Methode über keine Parameter verfügt, wird Sie auch einem URI zugeordnet, der keine *&quot;ID&quot;* Segment im Pfad enthält.</span><span class="sxs-lookup"><span data-stu-id="1cb82-235">Also, because the method has no parameters, it maps to a URI that does not contain an *&quot;id&quot;* segment in the path.</span></span>

<span data-ttu-id="1cb82-236">Fügen Sie der `ProductsController`-Klasse die folgende Methode hinzu, um ein Produkt über die ID zu erhalten:</span><span class="sxs-lookup"><span data-stu-id="1cb82-236">To get a product by ID, add this method to the `ProductsController` class:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample7.cs)]

<span data-ttu-id="1cb82-237">Dieser Methodenname beginnt auch mit &quot;Get&quot;, aber die Methode hat einen Parameter mit dem Namen " *ID*". Dieser Parameter wird der &quot;ID&quot; Segment des URI-Pfads zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-237">This method name also starts with &quot;Get&quot;, but the method has a parameter named *id*. This parameter is mapped to the &quot;id&quot; segment of the URI path.</span></span> <span data-ttu-id="1cb82-238">Das ASP.net-Web-API Framework konvertiert die ID automatisch in den richtigen Datentyp (**int**) für den-Parameter.</span><span class="sxs-lookup"><span data-stu-id="1cb82-238">The ASP.NET Web API framework automatically converts the ID to the correct data type (**int**) for the parameter.</span></span>

<span data-ttu-id="1cb82-239">Die GetProduct-Methode löst eine Ausnahme vom Typ " **httpresponcexception** " aus, wenn die *ID* ungültig ist.</span><span class="sxs-lookup"><span data-stu-id="1cb82-239">The GetProduct method throws an exception of type **HttpResponseException** if *id* is not valid.</span></span> <span data-ttu-id="1cb82-240">Diese Ausnahme wird vom Framework in einen 404-Fehler (nicht gefunden) übersetzt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-240">This exception will be translated by the framework into a 404 (Not Found) error.</span></span>

<span data-ttu-id="1cb82-241">Fügen Sie abschließend eine Methode zum Suchen nach Produkten nach Kategorie hinzu:</span><span class="sxs-lookup"><span data-stu-id="1cb82-241">Finally, add a method to find products by category:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample8.cs)]

<span data-ttu-id="1cb82-242">Wenn der Anforderungs-URI eine Abfrage Zeichenfolge aufweist, versucht die Web-API, die Abfrage Parameter mit Parametern für die Controller Methode abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="1cb82-242">If the request URI has a query string, Web API tries to match the query parameters to parameters on the controller method.</span></span> <span data-ttu-id="1cb82-243">Daher wird dieser Methode ein URI der Form "API/Products? Category =*Category*" zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-243">Therefore, a URI of the form "api/products?category=*category*" will map to this method.</span></span>

## <a name="creating-a-resource"></a><span data-ttu-id="1cb82-244">Erstellen einer Ressource</span><span class="sxs-lookup"><span data-stu-id="1cb82-244">Creating a Resource</span></span>

<span data-ttu-id="1cb82-245">Als Nächstes fügen wir der `ProductsController`-Klasse eine Methode hinzu, um ein neues Produkt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="1cb82-245">Next, we'll add a method to the `ProductsController` class to create a new product.</span></span> <span data-ttu-id="1cb82-246">Im folgenden finden Sie eine einfache Implementierung der-Methode:</span><span class="sxs-lookup"><span data-stu-id="1cb82-246">Here is a simple implementation of the method:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample9.cs)]

<span data-ttu-id="1cb82-247">Beachten Sie zwei Dinge zu dieser Methode:</span><span class="sxs-lookup"><span data-stu-id="1cb82-247">Note two things about this method:</span></span>

- <span data-ttu-id="1cb82-248">Der Methodenname beginnt mit &quot;Post...&quot;.</span><span class="sxs-lookup"><span data-stu-id="1cb82-248">The method name starts with &quot;Post...&quot;.</span></span> <span data-ttu-id="1cb82-249">Zum Erstellen eines neuen Produkts sendet der Client eine HTTP POST-Anforderung.</span><span class="sxs-lookup"><span data-stu-id="1cb82-249">To create a new product, the client sends an HTTP POST request.</span></span>
- <span data-ttu-id="1cb82-250">Die-Methode nimmt einen Parameter vom Typ "Product" an.</span><span class="sxs-lookup"><span data-stu-id="1cb82-250">The method takes a parameter of type Product.</span></span> <span data-ttu-id="1cb82-251">In der Web-API werden Parameter mit komplexen Typen aus dem Anforderungs Text deserialisiert.</span><span class="sxs-lookup"><span data-stu-id="1cb82-251">In Web API, parameters with complex types are deserialized from the request body.</span></span> <span data-ttu-id="1cb82-252">Daher erwarten wir, dass der Client eine serialisierte Darstellung eines Product-Objekts entweder im XML-oder im JSON-Format sendet.</span><span class="sxs-lookup"><span data-stu-id="1cb82-252">Therefore, we expect the client to send a serialized representation of a product object, in either XML or JSON format.</span></span>

<span data-ttu-id="1cb82-253">Diese Implementierung funktioniert, ist jedoch nicht ganz fertig.</span><span class="sxs-lookup"><span data-stu-id="1cb82-253">This implementation will work, but it is not quite complete.</span></span> <span data-ttu-id="1cb82-254">Im Idealfall möchten wir, dass die HTTP-Antwort folgendes einschließt:</span><span class="sxs-lookup"><span data-stu-id="1cb82-254">Ideally, we would like the HTTP response to include the following:</span></span>

- <span data-ttu-id="1cb82-255">**Antwort Code:** Standardmäßig legt das Web-API-Framework den Antwortstatus Code auf 200 (OK) fest.</span><span class="sxs-lookup"><span data-stu-id="1cb82-255">**Response code:** By default, the Web API framework sets the response status code to 200 (OK).</span></span> <span data-ttu-id="1cb82-256">Nach dem HTTP/1.1-Protokoll sollte der Server jedoch mit dem Status 201 (erstellt) Antworten, wenn eine Post-Anforderung zur Erstellung einer Ressource führt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-256">But according to the HTTP/1.1 protocol, when a POST request results in the creation of a resource, the server should reply with status 201 (Created).</span></span>
- <span data-ttu-id="1cb82-257">**Speicherort:** Wenn der Server eine Ressource erstellt, sollte er den URI der neuen Ressource im Location-Header der Antwort enthalten.</span><span class="sxs-lookup"><span data-stu-id="1cb82-257">**Location:** When the server creates a resource, it should include the URI of the new resource in the Location header of the response.</span></span>

<span data-ttu-id="1cb82-258">ASP.net-Web-API vereinfacht das Bearbeiten der http-Antwortnachricht.</span><span class="sxs-lookup"><span data-stu-id="1cb82-258">ASP.NET Web API makes it easy to manipulate the HTTP response message.</span></span> <span data-ttu-id="1cb82-259">Hier ist die verbesserte Implementierung:</span><span class="sxs-lookup"><span data-stu-id="1cb82-259">Here is the improved implementation:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample10.cs)]

<span data-ttu-id="1cb82-260">Beachten Sie, dass der Rückgabetyp der Methode jetzt **httpresponsmessage**ist.</span><span class="sxs-lookup"><span data-stu-id="1cb82-260">Notice that the method return type is now **HttpResponseMessage**.</span></span> <span data-ttu-id="1cb82-261">Durch das Zurückgeben einer **HttpResponseMessage** anstelle eines Produkts können wir die Details der http-Antwortnachricht steuern, einschließlich des Statuscodes und des Location-Headers.</span><span class="sxs-lookup"><span data-stu-id="1cb82-261">By returning an **HttpResponseMessage** instead of a Product, we can control the details of the HTTP response message, including the status code and the Location header.</span></span>

<span data-ttu-id="1cb82-262">Die Methode " **samateresponse** " erstellt eine **HttpResponseMessage** und schreibt automatisch eine serialisierte Darstellung des Product-Objekts in den Text der Antwortnachricht.</span><span class="sxs-lookup"><span data-stu-id="1cb82-262">The **CreateResponse** method creates an **HttpResponseMessage** and automatically writes a serialized representation of the Product object into the body fo the response message.</span></span>

> [!NOTE]
> <span data-ttu-id="1cb82-263">In diesem Beispiel werden die `Product`nicht überprüft.</span><span class="sxs-lookup"><span data-stu-id="1cb82-263">This example does not validate the `Product`.</span></span> <span data-ttu-id="1cb82-264">Weitere Informationen zur Modell Validierung finden Sie [Untermodell Validierung in ASP.net-Web-API](../formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="1cb82-264">For information about model validation, see [Model Validation in ASP.NET Web API](../formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>

## <a name="updating-a-resource"></a><span data-ttu-id="1cb82-265">Aktualisieren einer Ressource</span><span class="sxs-lookup"><span data-stu-id="1cb82-265">Updating a Resource</span></span>

<span data-ttu-id="1cb82-266">Das Aktualisieren eines Produkts mit Put ist einfach:</span><span class="sxs-lookup"><span data-stu-id="1cb82-266">Updating a product with PUT is straightforward:</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample11.cs)]

<span data-ttu-id="1cb82-267">Der Methodenname beginnt mit &quot;Put...&quot;, sodass die Web-API mit Put-Anforderungen übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-267">The method name starts with &quot;Put...&quot;, so Web API matches it to PUT requests.</span></span> <span data-ttu-id="1cb82-268">Die-Methode erfordert zwei Parameter: die Produkt-ID und das aktualisierte Produkt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-268">The method takes two parameters, the product ID and the updated product.</span></span> <span data-ttu-id="1cb82-269">Der *ID* -Parameter wird aus dem URI-Pfad entnommen, und der *Product* -Parameter wird aus dem Anforderungs Text deserialisiert.</span><span class="sxs-lookup"><span data-stu-id="1cb82-269">The *id* parameter is taken from the URI path, and the *product* parameter is deserialized from the request body.</span></span> <span data-ttu-id="1cb82-270">Standardmäßig übernimmt das ASP.net-Web-API Framework Einfache Parametertypen aus der Route und komplexen Typen aus dem Anforderungs Text.</span><span class="sxs-lookup"><span data-stu-id="1cb82-270">By default, the ASP.NET Web API framework takes simple parameter types from the route and complex types from the request body.</span></span>

## <a name="deleting-a-resource"></a><span data-ttu-id="1cb82-271">Löschen einer Ressource</span><span class="sxs-lookup"><span data-stu-id="1cb82-271">Deleting a Resource</span></span>

<span data-ttu-id="1cb82-272">Um eine Ressource zu löschen, definieren Sie ein "löschen..." anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="1cb82-272">To delete a resource, define a "Delete..." method.</span></span>

[!code-csharp[Main](creating-a-web-api-that-supports-crud-operations/samples/sample12.cs)]

<span data-ttu-id="1cb82-273">Wenn eine DELETE-Anforderung erfolgreich ist, kann Sie den Status 200 (OK) mit einem Entitäts Text zurückgeben, der den Status beschreibt. Status 202 (akzeptiert), wenn der Löschvorgang noch aussteht. oder Status 204 (kein Inhalt) ohne Entitäts Text.</span><span class="sxs-lookup"><span data-stu-id="1cb82-273">If a DELETE request succeeds, it can return status 200 (OK) with an entity-body that describes the status; status 202 (Accepted) if the deletion is still pending; or status 204 (No Content) with no entity body.</span></span> <span data-ttu-id="1cb82-274">In diesem Fall verfügt die `DeleteProduct`-Methode über einen `void` Rückgabetyp, sodass ASP.net-Web-API diese automatisch in den Statuscode 204 (kein Inhalt) übersetzt.</span><span class="sxs-lookup"><span data-stu-id="1cb82-274">In this case, the `DeleteProduct` method has a `void` return type, so ASP.NET Web API automatically translates this into status code 204 (No Content).</span></span>
