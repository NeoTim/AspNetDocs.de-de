---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: Authentifizierung und Autorisierung in ASP.NET Web-API | Microsoft Docs
author: MikeWasson
description: Gibt einen allgemeinen Überblick über die Authentifizierung und Autorisierung in ASP.NET Web-API.
ms.author: riande
ms.date: 11/27/2012
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 368d2b9456d12b2bb4063a23333e5c8837faa3b8
ms.sourcegitcommit: ce28244209db8615bc9bdd576a2e2c88174d318d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/06/2020
ms.locfileid: "80675862"
---
# <a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="d5e30-103">Authentifizierung und Autorisierung in der ASP.NET Web-API</span><span class="sxs-lookup"><span data-stu-id="d5e30-103">Authentication and Authorization in ASP.NET Web API</span></span>

<span data-ttu-id="d5e30-104">von [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="d5e30-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="d5e30-105">Sie haben eine Web-API erstellt, möchten aber jetzt den Zugriff darauf steuern.</span><span class="sxs-lookup"><span data-stu-id="d5e30-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="d5e30-106">In dieser Artikelserie werden einige Optionen zum Sichern einer Web-API vor nicht autorisierten Benutzern betrachtet.</span><span class="sxs-lookup"><span data-stu-id="d5e30-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="d5e30-107">Diese Serie umfasst sowohl die Authentifizierung als auch die Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="d5e30-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="d5e30-108">*Die Authentifizierung* ist das Wissen über die Identität des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="d5e30-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="d5e30-109">Alice meldet sich beispielsweise mit ihrem Benutzernamen und Kennwort an, und der Server verwendet das Kennwort, um Alice zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="d5e30-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="d5e30-110">*Die Autorisierung* entscheidet, ob ein Benutzer eine Aktion ausführen darf.</span><span class="sxs-lookup"><span data-stu-id="d5e30-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="d5e30-111">Alice verfügt beispielsweise über die Berechtigung, eine Ressource abzubekommen, aber keine Ressource zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="d5e30-112">Der erste Artikel der Serie gibt einen allgemeinen Überblick über Authentifizierung und Autorisierung in ASP.NET Web-API.</span><span class="sxs-lookup"><span data-stu-id="d5e30-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="d5e30-113">In anderen Themen werden allgemeine Authentifizierungsszenarien für die Web-API beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d5e30-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="d5e30-114">Danke an die Leute, die diese Serie revue passieren ließen und wertvolles Feedback gaben: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span><span class="sxs-lookup"><span data-stu-id="d5e30-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>

## <a name="authentication"></a><span data-ttu-id="d5e30-115">Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="d5e30-115">Authentication</span></span>

<span data-ttu-id="d5e30-116">Die Web-API geht davon aus, dass die Authentifizierung auf dem Host erfolgt.</span><span class="sxs-lookup"><span data-stu-id="d5e30-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="d5e30-117">Für das Webhosting ist der Host IIS, der HTTP-Module für die Authentifizierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="d5e30-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="d5e30-118">Sie können Ihr Projekt so konfigurieren, dass eines der in IIS oder ASP.NET integrierten Authentifizierungsmodule verwendet wird, oder ein eigenes HTTP-Modul schreiben, um eine benutzerdefinierte Authentifizierung durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="d5e30-119">Wenn der Host den Benutzer authentifiziert, erstellt er einen *Prinzipal*, bei dem es sich um ein [IPrincipal-Objekt](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) handelt, das den Sicherheitskontext darstellt, unter dem Code ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d5e30-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="d5e30-120">Der Host fügt den Prinzipal an den aktuellen Thread an, indem **thread.CurrentPrincipal**gesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="d5e30-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="d5e30-121">Der Prinzipal **Identity** enthält ein zugeordnetes Identity-Objekt, das Informationen über den Benutzer enthält.</span><span class="sxs-lookup"><span data-stu-id="d5e30-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="d5e30-122">Wenn der Benutzer authentifiziert ist, gibt die **Identity.IsAuthenticated-Eigenschaft** **true**zurück.</span><span class="sxs-lookup"><span data-stu-id="d5e30-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="d5e30-123">Bei anonymen Anforderungen gibt **IsAuthenticated** **false**zurück.</span><span class="sxs-lookup"><span data-stu-id="d5e30-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="d5e30-124">Weitere Informationen zu Prinzipalen finden Sie unter [Rollenbasierte Sicherheit](https://msdn.microsoft.com/library/shz8h065.aspx).</span><span class="sxs-lookup"><span data-stu-id="d5e30-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="d5e30-125">HTTP-Nachrichtenhandler für die Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="d5e30-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="d5e30-126">Anstatt den Host für die Authentifizierung zu verwenden, können Sie Authentifizierungslogik in einen [HTTP-Nachrichtenhandler eintragen.](../advanced/http-message-handlers.md)</span><span class="sxs-lookup"><span data-stu-id="d5e30-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="d5e30-127">In diesem Fall überprüft der Nachrichtenhandler die HTTP-Anforderung und legt den Prinzipal fest.</span><span class="sxs-lookup"><span data-stu-id="d5e30-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="d5e30-128">Wann sollten Sie Nachrichtenhandler für die Authentifizierung verwenden?</span><span class="sxs-lookup"><span data-stu-id="d5e30-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="d5e30-129">Hier sind einige Kompromisse:</span><span class="sxs-lookup"><span data-stu-id="d5e30-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="d5e30-130">Ein HTTP-Modul zeigt alle Anforderungen an, die die ASP.NET-Pipeline durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="d5e30-131">Ein Nachrichtenhandler sieht nur Anforderungen, die an die Web-API weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="d5e30-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="d5e30-132">Sie können Nachrichtenhandler pro Route festlegen, mit denen Sie ein Authentifizierungsschema auf eine bestimmte Route anwenden können.</span><span class="sxs-lookup"><span data-stu-id="d5e30-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="d5e30-133">HTTP-Module sind spezifisch für IIS.</span><span class="sxs-lookup"><span data-stu-id="d5e30-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="d5e30-134">Nachrichtenhandler sind host-agnostisch, sodass sie sowohl mit Webhosting als auch mit Selbsthosting verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="d5e30-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="d5e30-135">HTTP-Module nehmen an der IIS-Protokollierung, -Überwachung usw. teil.</span><span class="sxs-lookup"><span data-stu-id="d5e30-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="d5e30-136">HTTP-Module werden früher in der Pipeline ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="d5e30-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="d5e30-137">Wenn Sie die Authentifizierung in einem Nachrichtenhandler verarbeiten, wird der Prinzipal erst festgelegt, wenn der Handler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d5e30-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="d5e30-138">Darüber hinaus kehrt der Prinzipal zum vorherigen Prinzipal zurück, wenn die Antwort den Nachrichtenhandler verlässt.</span><span class="sxs-lookup"><span data-stu-id="d5e30-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="d5e30-139">Wenn Sie das Selbsthosting nicht unterstützen müssen, ist ein HTTP-Modul im Allgemeinen die bessere Option.</span><span class="sxs-lookup"><span data-stu-id="d5e30-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="d5e30-140">Wenn Sie das Selbsthosting unterstützen müssen, sollten Sie einen Nachrichtenhandler in Betracht ziehen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="d5e30-141">Festlegen des Prinzipals</span><span class="sxs-lookup"><span data-stu-id="d5e30-141">Setting the Principal</span></span>

<span data-ttu-id="d5e30-142">Wenn Ihre Anwendung eine benutzerdefinierte Authentifizierungslogik ausführt, müssen Sie den Prinzipal an zwei Stellen festlegen:</span><span class="sxs-lookup"><span data-stu-id="d5e30-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="d5e30-143">**Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="d5e30-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="d5e30-144">Diese Eigenschaft ist die Standardmethode zum Festlegen des Prinzips des Threads in .NET.</span><span class="sxs-lookup"><span data-stu-id="d5e30-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="d5e30-145">**httpContext.Current.User**.</span><span class="sxs-lookup"><span data-stu-id="d5e30-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="d5e30-146">Diese Eigenschaft ist spezifisch für ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d5e30-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="d5e30-147">Der folgende Code zeigt, wie der Prinzipal festgelegt wird:</span><span class="sxs-lookup"><span data-stu-id="d5e30-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="d5e30-148">Für Webhosting müssen Sie den Prinzipal an beiden Stellen festlegen. Andernfalls kann der Sicherheitskontext inkonsistent werden.</span><span class="sxs-lookup"><span data-stu-id="d5e30-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="d5e30-149">Für das Selbsthosting ist **HttpContext.Current** jedoch null.</span><span class="sxs-lookup"><span data-stu-id="d5e30-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="d5e30-150">Um sicherzustellen, dass Ihr Code host-agnostisch ist, überprüfen Sie daher, ob NULL ist, bevor Sie **httpContext.Current**zuweisen, wie gezeigt.</span><span class="sxs-lookup"><span data-stu-id="d5e30-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="d5e30-151">Authorization</span><span class="sxs-lookup"><span data-stu-id="d5e30-151">Authorization</span></span>

<span data-ttu-id="d5e30-152">Die Autorisierung erfolgt später in der Pipeline, näher am Controller.</span><span class="sxs-lookup"><span data-stu-id="d5e30-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="d5e30-153">Auf diese Weise können Sie detailliertere Entscheidungen treffen, wenn Sie Zugriff auf Ressourcen gewähren.</span><span class="sxs-lookup"><span data-stu-id="d5e30-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="d5e30-154">*Autorisierungsfilter* werden vor der Controlleraktion ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="d5e30-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="d5e30-155">Wenn die Anforderung nicht autorisiert ist, gibt der Filter eine Fehlerantwort zurück, und die Aktion wird nicht aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="d5e30-156">Innerhalb einer Controlleraktion können Sie den aktuellen Prinzipal aus der **ApiController.User-Eigenschaft** abrufen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="d5e30-157">Sie können z. B. eine Liste von Ressourcen basierend auf dem Benutzernamen filtern und nur die Ressourcen zurückgeben, die zu diesem Benutzer gehören.</span><span class="sxs-lookup"><span data-stu-id="d5e30-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="d5e30-158">Verwenden des [Authorize]-Attributs</span><span class="sxs-lookup"><span data-stu-id="d5e30-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="d5e30-159">Die Web-API stellt den integrierten Autorisierungsfilter [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx)bereit.</span><span class="sxs-lookup"><span data-stu-id="d5e30-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="d5e30-160">Dieser Filter überprüft, ob der Benutzer authentifiziert ist.</span><span class="sxs-lookup"><span data-stu-id="d5e30-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="d5e30-161">Ist dies nicht der Fall, wird der HTTP-Statuscode 401 (Nicht autorisiert) zurückgegeben, ohne die Aktion aufzuberufen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="d5e30-162">Sie können den Filter global, auf Controllerebene oder auf der Ebene einzelner Aktionen anwenden.</span><span class="sxs-lookup"><span data-stu-id="d5e30-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="d5e30-163">**Global:** Um den Zugriff für jeden Web-API-Controller einzuschränken, fügen Sie der globalen Filterliste den **AuthorizeAttribute-Filter** hinzu:</span><span class="sxs-lookup"><span data-stu-id="d5e30-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="d5e30-164">**Controller**: Um den Zugriff für einen bestimmten Controller einzuschränken, fügen Sie den Filter als Attribut zum Controller hinzu:</span><span class="sxs-lookup"><span data-stu-id="d5e30-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="d5e30-165">**Aktion**: Um den Zugriff für bestimmte Aktionen einzuschränken, fügen Sie das Attribut der Aktionsmethode hinzu:</span><span class="sxs-lookup"><span data-stu-id="d5e30-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="d5e30-166">Alternativ können Sie den Controller einschränken und dann anonymen Zugriff `[AllowAnonymous]` auf bestimmte Aktionen zulassen, indem Sie das Attribut verwenden.</span><span class="sxs-lookup"><span data-stu-id="d5e30-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="d5e30-167">Im folgenden Beispiel `Post` ist die Methode `Get` eingeschränkt, aber die Methode ermöglicht anonymen Zugriff.</span><span class="sxs-lookup"><span data-stu-id="d5e30-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="d5e30-168">In den vorherigen Beispielen ermöglicht der Filter jedem authentifizierten Benutzer den Zugriff auf die eingeschränkten Methoden. nur anonyme Benutzer werden ausgeschlossen. Sie können den Zugriff auch auf bestimmte Benutzer oder auf Benutzer in bestimmten Rollen beschränken:</span><span class="sxs-lookup"><span data-stu-id="d5e30-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="d5e30-169">Der **AuthorizeAttribute-Filter** für Web-API-Controller befindet sich im **Namespace System.Web.Http.**</span><span class="sxs-lookup"><span data-stu-id="d5e30-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="d5e30-170">Es gibt einen ähnlichen Filter für MVC-Controller im **Namespace System.Web.Mvc,** der nicht mit Web-API-Controllern kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="d5e30-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>

### <a name="custom-authorization-filters"></a><span data-ttu-id="d5e30-171">Benutzerdefinierte Autorisierungsfilter</span><span class="sxs-lookup"><span data-stu-id="d5e30-171">Custom Authorization Filters</span></span>

<span data-ttu-id="d5e30-172">Um einen benutzerdefinierten Autorisierungsfilter zu schreiben, leiten Sie einen der folgenden Typen ab:</span><span class="sxs-lookup"><span data-stu-id="d5e30-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="d5e30-173">**AuthorizeAttribute**.</span><span class="sxs-lookup"><span data-stu-id="d5e30-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="d5e30-174">Erweitern Sie diese Klasse, um Autorisierungslogik basierend auf dem aktuellen Benutzer und den Rollen des Benutzers auszuführen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="d5e30-175">**AuthorizationFilterAttribute**.</span><span class="sxs-lookup"><span data-stu-id="d5e30-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="d5e30-176">Erweitern Sie diese Klasse, um eine synchrone Autorisierungslogik auszuführen, die nicht unbedingt auf dem aktuellen Benutzer oder der aktuellen Rolle basiert.</span><span class="sxs-lookup"><span data-stu-id="d5e30-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="d5e30-177">**IAuthorizationFilter**.</span><span class="sxs-lookup"><span data-stu-id="d5e30-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="d5e30-178">Implementieren Sie diese Schnittstelle, um asynchrone Autorisierungslogik auszuführen. Wenn Ihre Autorisierungslogik z. B. asynchrone E/A- oder Netzwerkaufrufe ausführt.</span><span class="sxs-lookup"><span data-stu-id="d5e30-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="d5e30-179">(Wenn Ihre Autorisierungslogik CPU-gebunden ist, ist es einfacher, von **AuthorizationFilterAttribute**abzuleiten, da Sie dann keine asynchrone Methode schreiben müssen.)</span><span class="sxs-lookup"><span data-stu-id="d5e30-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="d5e30-180">Das folgende Diagramm zeigt die Klassenhierarchie für die **AuthorizeAttribute-Klasse.**</span><span class="sxs-lookup"><span data-stu-id="d5e30-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="d5e30-181">Autorisierung innerhalb einer Controller-Aktion</span><span class="sxs-lookup"><span data-stu-id="d5e30-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="d5e30-182">In einigen Fällen können Sie die Weiterführung einer Anforderung zulassen, aber das Verhalten basierend auf dem Prinzipal ändern.</span><span class="sxs-lookup"><span data-stu-id="d5e30-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="d5e30-183">Die von Ihnen zurückgegebenen Informationen können sich z. B. je nach Rolle des Benutzers ändern.</span><span class="sxs-lookup"><span data-stu-id="d5e30-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="d5e30-184">Innerhalb einer Controllermethode können Sie den aktuellen Prinzipal aus der **ApiController.User-Eigenschaft** abrufen.</span><span class="sxs-lookup"><span data-stu-id="d5e30-184">Within a controller method, you can get the current principal from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
