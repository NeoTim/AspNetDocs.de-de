---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: Authentifizierung und Autorisierung in ASP.NET Web-API | Microsoft-Dokumentation
author: MikeWasson
description: Bietet eine allgemeine Übersicht über Authentifizierung und Autorisierung in ASP.NET Web-API.
ms.author: riande
ms.date: 11/27/2012
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 368d2b9456d12b2bb4063a23333e5c8837faa3b8
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134715"
---
# <a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="3b6da-103">Authentifizierung und Autorisierung in ASP.NET Web-API</span><span class="sxs-lookup"><span data-stu-id="3b6da-103">Authentication and Authorization in ASP.NET Web API</span></span>

<span data-ttu-id="3b6da-104">durch [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="3b6da-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="3b6da-105">Sie haben eine Web-API erstellt, aber Sie möchten nun den Zugriff darauf einschränken.</span><span class="sxs-lookup"><span data-stu-id="3b6da-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="3b6da-106">In dieser Artikelreihe betrachten wir einige Optionen zum Sichern einer Webs-API von nicht autorisierten Benutzern.</span><span class="sxs-lookup"><span data-stu-id="3b6da-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="3b6da-107">Diese Reihe behandelt die Authentifizierung und Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="3b6da-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="3b6da-108">*Authentifizierung* ist die Identität des Benutzers kennen.</span><span class="sxs-lookup"><span data-stu-id="3b6da-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="3b6da-109">Zum Beispiel Alice meldet sich mit ihrem Benutzernamen und das Kennwort, und der Server verwendet das Kennwort zur Authentifizierung von Alice.</span><span class="sxs-lookup"><span data-stu-id="3b6da-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="3b6da-110">*Autorisierung* ist die Entscheidung, ob ein Benutzer zum Ausführen einer Aktion zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="3b6da-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="3b6da-111">Alice ist z. B. über die Berechtigung zum Abrufen einer Ressource, aber nicht erstellen Sie eine Ressource.</span><span class="sxs-lookup"><span data-stu-id="3b6da-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="3b6da-112">Der erste Artikel in der Reihe bietet eine allgemeine Übersicht über Authentifizierung und Autorisierung in ASP.NET Web-API.</span><span class="sxs-lookup"><span data-stu-id="3b6da-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="3b6da-113">Andere Themen werden allgemeine Szenarien mit Authentifizierung für Web-API beschrieben.</span><span class="sxs-lookup"><span data-stu-id="3b6da-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="3b6da-114">Nochmals vielen Dank an die Personen, die dieser Serie überprüft und wertvolles Feedback bereitgestellt: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span><span class="sxs-lookup"><span data-stu-id="3b6da-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>

## <a name="authentication"></a><span data-ttu-id="3b6da-115">Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="3b6da-115">Authentication</span></span>

<span data-ttu-id="3b6da-116">Web-API wird davon ausgegangen, dass die Authentifizierung auf dem Host erfolgt.</span><span class="sxs-lookup"><span data-stu-id="3b6da-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="3b6da-117">Für Webhosting ist der Host IIS, die HTTP-Module für die Authentifizierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="3b6da-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="3b6da-118">Sie können Ihr Projekt verwendet die Authentifizierungsmodule, die direkt in IIS oder ASP.NET konfigurieren, oder Sie können eigene HTTP-Modul zum Ausführen der benutzerdefinierten Authentifizierung schreiben.</span><span class="sxs-lookup"><span data-stu-id="3b6da-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="3b6da-119">Wenn der Host der Benutzer authentifiziert wird, erstellt es eine *principal*, die eine [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) -Objekt, das den Sicherheitskontext darstellt, unter dem Code ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3b6da-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="3b6da-120">Der Host fügt den Prinzipal für den aktuellen Thread durch Festlegen von **Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="3b6da-121">Der Prinzipal enthält eine zugeordnete **Identität** Objekt, das Informationen über den Benutzer enthält.</span><span class="sxs-lookup"><span data-stu-id="3b6da-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="3b6da-122">Wenn der Benutzer authentifiziert ist, die **Identity.IsAuthenticated** -Eigenschaft gibt **"true"**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="3b6da-123">Für anonyme Anforderungen **IsAuthenticated** gibt **"false"**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="3b6da-124">Weitere Informationen zu Prinzipalen finden Sie unter [rollenbasierte Sicherheit](https://msdn.microsoft.com/library/shz8h065.aspx).</span><span class="sxs-lookup"><span data-stu-id="3b6da-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="3b6da-125">HTTP-Nachrichtenhandler für die Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="3b6da-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="3b6da-126">Anstatt den Host für die Authentifizierung zu verwenden, können Sie die Authentifizierungslogik in Einfügen einer [HTTP-Nachrichtenhandler](../advanced/http-message-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="3b6da-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="3b6da-127">In diesem Fall wird der Message-Handler überprüft die HTTP-Anforderung und legt den Prinzipal fest.</span><span class="sxs-lookup"><span data-stu-id="3b6da-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="3b6da-128">Wann sollten Sie Meldungshandler für die Authentifizierung verwenden?</span><span class="sxs-lookup"><span data-stu-id="3b6da-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="3b6da-129">Hier sind einige Nachteile:</span><span class="sxs-lookup"><span data-stu-id="3b6da-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="3b6da-130">Ein HTTP-Modul sieht alle Anforderungen, die der ASP.NET-Pipeline durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="3b6da-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="3b6da-131">Ein Meldungshandler sieht nur Anforderungen, die auf Web-API weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="3b6da-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="3b6da-132">Sie können pro Route-Meldungshandler festlegen, dadurch können Sie ein anderes Authentifizierungsschema für eine bestimmte Route anwenden.</span><span class="sxs-lookup"><span data-stu-id="3b6da-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="3b6da-133">HTTP-Module gelten speziell für IIS.</span><span class="sxs-lookup"><span data-stu-id="3b6da-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="3b6da-134">Nachrichtenhandler sind Hosts gegenüber agnostisch, sodass sie mit Web-hosting und Self-hosting verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="3b6da-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="3b6da-135">HTTP-Module teilnehmen in IIS-Protokollierung, Überwachung und So weiter.</span><span class="sxs-lookup"><span data-stu-id="3b6da-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="3b6da-136">HTTP-Module, die weiter oben in der Pipeline ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="3b6da-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="3b6da-137">Authentifizierung in einem Ereignishandler für die Nachricht verarbeitet, der Prinzipal ist nicht abrufen oder festlegen, bis der Handler ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3b6da-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="3b6da-138">Darüber hinaus wird der Prinzipal auf der vorherige Prinzipal zurückgesetzt, wenn die Antwort den Message-Handler verlässt.</span><span class="sxs-lookup"><span data-stu-id="3b6da-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="3b6da-139">Wenn Sie keine Self-hosting unterstützen müssen, ist ein HTTP-Modul in der Regel eine bessere Option.</span><span class="sxs-lookup"><span data-stu-id="3b6da-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="3b6da-140">Wenn Sie Self-hosting unterstützen müssen, sollten Sie einen Meldungshandler.</span><span class="sxs-lookup"><span data-stu-id="3b6da-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="3b6da-141">Den Prinzipal festlegen</span><span class="sxs-lookup"><span data-stu-id="3b6da-141">Setting the Principal</span></span>

<span data-ttu-id="3b6da-142">Wenn Ihre Anwendung keine Logik für die benutzerdefinierte Authentifizierung durchführt, müssen Sie den Prinzipal auf zwei Stellen festlegen:</span><span class="sxs-lookup"><span data-stu-id="3b6da-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="3b6da-143">**Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="3b6da-144">Diese Eigenschaft ist das Standardverfahren zum Festlegen von den Prinzipal des Threads in .NET.</span><span class="sxs-lookup"><span data-stu-id="3b6da-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="3b6da-145">**HttpContext.Current.User**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="3b6da-146">Diese Eigenschaft ist spezifisch für ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3b6da-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="3b6da-147">Der folgende Code zeigt, wie den Prinzipal festgelegt wird:</span><span class="sxs-lookup"><span data-stu-id="3b6da-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="3b6da-148">Für Webhosting, müssen Sie den Prinzipal an beiden Orten festlegen. Andernfalls kann der Sicherheitskontext inkonsistent werden.</span><span class="sxs-lookup"><span data-stu-id="3b6da-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="3b6da-149">Für das Selbsthosting jedoch **"HttpContext.Current"** ist null.</span><span class="sxs-lookup"><span data-stu-id="3b6da-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="3b6da-150">Um sicherzustellen, dass Ihr Code Hosts gegenüber agnostisch, überprüfen Sie daher für Null-Zeichen vor dem Zuweisen zu **"HttpContext.Current"**, wie gezeigt.</span><span class="sxs-lookup"><span data-stu-id="3b6da-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="3b6da-151">Autorisierung</span><span class="sxs-lookup"><span data-stu-id="3b6da-151">Authorization</span></span>

<span data-ttu-id="3b6da-152">Autorisierung in der Pipeline später näher an den Controller.</span><span class="sxs-lookup"><span data-stu-id="3b6da-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="3b6da-153">Mit der Sie genauere Entscheidungen zu treffen, wenn Sie den Zugriff auf Ressourcen gewähren.</span><span class="sxs-lookup"><span data-stu-id="3b6da-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="3b6da-154">*Autorisierungsfilter werden also* ausführen, bevor die Controlleraktion.</span><span class="sxs-lookup"><span data-stu-id="3b6da-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="3b6da-155">Wenn die Anforderung nicht autorisiert ist, der Filter gibt eine Fehlerantwort zurück, und die Aktion wird nicht aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="3b6da-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="3b6da-156">In eine Controlleraktion, erhalten Sie den aktuellen Prinzipal aus der **ApiController.User** Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="3b6da-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="3b6da-157">Beispielsweise können Sie filtern eine Liste der Ressourcen basierend auf den Benutzernamen ein, nur die Ressourcen, die für diesen Benutzer gehören zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="3b6da-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="3b6da-158">Mithilfe der [autorisieren]-Attribut</span><span class="sxs-lookup"><span data-stu-id="3b6da-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="3b6da-159">Web-API bietet einen integrierte Autorisierungsfilter [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="3b6da-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="3b6da-160">Dieser Filter wird überprüft, ob der Benutzer authentifiziert ist.</span><span class="sxs-lookup"><span data-stu-id="3b6da-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="3b6da-161">Wenn dies nicht der Fall ist, wird die HTTP-Statuscode 401 (Unauthorized), ohne Aufrufen der Aktion zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="3b6da-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="3b6da-162">Sie können den Filter Global auf Controllerebene und auf der Ebene der einzelnen Aktionen anwenden.</span><span class="sxs-lookup"><span data-stu-id="3b6da-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="3b6da-163">**Globally**: Zum Einschränken des Zugriffs für alle Web-API-Controller Hinzufügen der **AuthorizeAttribute** Filter zur globalen Filterliste:</span><span class="sxs-lookup"><span data-stu-id="3b6da-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="3b6da-164">**Controller**: Zum Einschränken des Zugriffs für einen bestimmten Controller fügen Sie den Filter als Attribut hinzu, mit dem Controller:</span><span class="sxs-lookup"><span data-stu-id="3b6da-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="3b6da-165">**Aktion**: Fügen Sie das Attribut zur Aktionsmethode hinzu, zum Einschränken des Zugriffs für bestimmte Aktionen:</span><span class="sxs-lookup"><span data-stu-id="3b6da-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="3b6da-166">Alternativ können Sie den Controller einzuschränken und Zulassen des anonymen Zugriffs auf bestimmte Aktionen klicken Sie dann mithilfe der `[AllowAnonymous]` Attribut.</span><span class="sxs-lookup"><span data-stu-id="3b6da-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="3b6da-167">Im folgenden Beispiel die `Post` Methode ist beschränkt, aber die `Get` -Methode erlaubt anonymen Zugriff.</span><span class="sxs-lookup"><span data-stu-id="3b6da-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="3b6da-168">In den vorherigen Beispielen kann der Filter allen authentifizierten Benutzern den Zugriff auf den eingeschränkten Methoden; nur anonyme Benutzer werden Sie beibehalten. Sie können auch den Zugriff auf bestimmte Benutzer oder Benutzer in bestimmten Rollen einschränken:</span><span class="sxs-lookup"><span data-stu-id="3b6da-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="3b6da-169">Die **AuthorizeAttribute** Filter für Web-API-Controller befindet sich in der **"System.Web.http"** Namespace.</span><span class="sxs-lookup"><span data-stu-id="3b6da-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="3b6da-170">Es ist ein ähnlicher Filter für MVC-Controller im der **System.Web.Mvc** -Namespace, der mit der Web-API-Controller nicht kompatibel ist.</span><span class="sxs-lookup"><span data-stu-id="3b6da-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>

### <a name="custom-authorization-filters"></a><span data-ttu-id="3b6da-171">Benutzerdefinierte Autorisierungsfilter</span><span class="sxs-lookup"><span data-stu-id="3b6da-171">Custom Authorization Filters</span></span>

<span data-ttu-id="3b6da-172">Um einen eigenen Autorisierungsfilter schreiben, leiten Sie sich von einem dieser Typen:</span><span class="sxs-lookup"><span data-stu-id="3b6da-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="3b6da-173">**AuthorizeAttribute**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="3b6da-174">Erweitern Sie diese Klasse, um basierend auf den aktuellen Benutzer und Rollen des Benutzers Autorisierungslogik auszuführen.</span><span class="sxs-lookup"><span data-stu-id="3b6da-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="3b6da-175">**AuthorizationFilterAttribute**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="3b6da-176">Erweitern Sie diese Klasse, um synchrone Autorisierungslogik auszuführen, die nicht unbedingt auf den aktuellen Benutzer oder die Rolle basiert.</span><span class="sxs-lookup"><span data-stu-id="3b6da-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="3b6da-177">**IAuthorizationFilter**.</span><span class="sxs-lookup"><span data-stu-id="3b6da-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="3b6da-178">Implementieren Sie diese Schnittstelle, um asynchrone Autorisierungslogik auszuführen. Angenommen, Ihre Autorisierungslogik asynchrone e/A- oder Netzwerk-Aufrufe ausführt.</span><span class="sxs-lookup"><span data-stu-id="3b6da-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="3b6da-179">(Wenn der Autorisierungslogik CPU-gebunden ist, ist es einfacher, abgeleitet **AuthorizationFilterAttribute**, da müssen Sie, eine asynchrone Methode zu schreiben.)</span><span class="sxs-lookup"><span data-stu-id="3b6da-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="3b6da-180">Das folgende Diagramm zeigt die Klassenhierarchie für die **AuthorizeAttribute** Klasse.</span><span class="sxs-lookup"><span data-stu-id="3b6da-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="3b6da-181">Autorisierung in eine Controlleraktion</span><span class="sxs-lookup"><span data-stu-id="3b6da-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="3b6da-182">In einigen Fällen können Sie eine Anforderung zum Fortfahren, aber ändern das Verhalten basierend auf dem Prinzipal ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="3b6da-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="3b6da-183">Beispielsweise kann die Informationen, die Sie zurückgeben abhängig von der Benutzerrolle ändern.</span><span class="sxs-lookup"><span data-stu-id="3b6da-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="3b6da-184">Innerhalb einer Controllermethode erhalten Sie den aktuellen Prinzipal aus der **ApiController.User** Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="3b6da-184">Within a controller method, you can get the current principal from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
