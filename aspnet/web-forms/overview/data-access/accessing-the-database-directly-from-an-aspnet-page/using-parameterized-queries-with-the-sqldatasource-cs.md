---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-cs
title: Verwenden von parametrisierten Abfragen mit SqlDataSource (C#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial wird der Blick auf das SqlDataSource-Steuerelement weitergeleitet, und es wird beschrieben, wie parametrisierte Abfragen definiert werden. Die Parameter können mit "decla..." angegeben werden.
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 9128aaac-afe2-449f-84b2-bb1d035083c4
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/using-parameterized-queries-with-the-sqldatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: 241dc8c089d4faa9eb95a63684e8a56756bb302c
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74611297"
---
# <a name="using-parameterized-queries-with-the-sqldatasource-c"></a><span data-ttu-id="7403e-104">Verwenden von parametrisierten Abfragen mit dem SqlDataSource-Steuerelement (C#)</span><span class="sxs-lookup"><span data-stu-id="7403e-104">Using Parameterized Queries with the SqlDataSource (C#)</span></span>

<span data-ttu-id="7403e-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7403e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7403e-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_CS.exe) oder [PDF herunterladen](using-parameterized-queries-with-the-sqldatasource-cs/_static/datatutorial48cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7403e-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_48_CS.exe) or [Download PDF](using-parameterized-queries-with-the-sqldatasource-cs/_static/datatutorial48cs1.pdf)</span></span>

> <span data-ttu-id="7403e-107">In diesem Tutorial wird der Blick auf das SqlDataSource-Steuerelement weitergeleitet, und es wird beschrieben, wie parametrisierte Abfragen definiert werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-107">In this tutorial, we continue our look at the SqlDataSource control and learn how to define parameterized queries.</span></span> <span data-ttu-id="7403e-108">Die Parameter können sowohl deklarativ als auch Programm gesteuert angegeben werden und können aus mehreren Speicherorten (z. b. QueryString, Sitzungszustand, anderen Steuerelementen usw.) abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-108">The parameters can be specified both declaratively and programmatically, and can be pulled from a number of locations such as the querystring, Session state, other controls, and more.</span></span>

## <a name="introduction"></a><span data-ttu-id="7403e-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="7403e-109">Introduction</span></span>

<span data-ttu-id="7403e-110">Im vorherigen Tutorial wurde erläutert, wie das SqlDataSource-Steuerelement verwendet wird, um Daten direkt aus einer Datenbank abzurufen.</span><span class="sxs-lookup"><span data-stu-id="7403e-110">In the previous tutorial we saw how to use the SqlDataSource control to retrieve data directly from a database.</span></span> <span data-ttu-id="7403e-111">Mithilfe des Assistenten zum Konfigurieren von Datenquellen könnten wir die Datenbank auswählen und dann entweder die Spalten auswählen, die aus einer Tabelle oder Sicht zurückgegeben werden sollen. Geben Sie eine benutzerdefinierte SQL-Anweisung ein. oder verwenden Sie eine gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="7403e-111">Using the Configure Data Source wizard, we could choose the database and then either: pick the columns to return from a table or view; enter a custom SQL statement; or use a stored procedure.</span></span> <span data-ttu-id="7403e-112">Unabhängig davon, ob Sie Spalten aus einer Tabelle oder Sicht auswählen oder eine benutzerdefinierte SQL-Anweisung eingeben, wird der `SelectCommand`-Eigenschaft des SqlDataSource-Steuer Elements die resultierende Ad-hoc-SQL-`SELECT`-Anweisung zugewiesen. dabei handelt es sich um eine `SELECT`-Anweisung, die ausgeführt wird, wenn die SqlDataSource s-`Select()`-Methode aufgerufen wird</span><span class="sxs-lookup"><span data-stu-id="7403e-112">Whether selecting columns from a table or view or entering a custom SQL statement, the SqlDataSource control s `SelectCommand` property is assigned the resulting ad-hoc SQL `SELECT` statement and it is this `SELECT` statement that is executed when the SqlDataSource s `Select()` method is invoked (either programmatically or automatically from a data Web control).</span></span>

<span data-ttu-id="7403e-113">In den SQL `SELECT`-Anweisungen, die in den vorherigen Tutorial s verwendet wurden, fehlten `WHERE` Klauseln.</span><span class="sxs-lookup"><span data-stu-id="7403e-113">The SQL `SELECT` statements used in the previous tutorial s demos lacked `WHERE` clauses.</span></span> <span data-ttu-id="7403e-114">In einer `SELECT`-Anweisung kann die `WHERE`-Klausel verwendet werden, um die zurückgegebenen Ergebnisse einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="7403e-114">In a `SELECT` statement, the `WHERE` clause can be used to limit the results returned.</span></span> <span data-ttu-id="7403e-115">Wenn Sie z. b. die Namen von Produkten anzeigen möchten, die mehr als $50,00 enthalten, können wir die folgende Abfrage verwenden:</span><span class="sxs-lookup"><span data-stu-id="7403e-115">For example, to display the names of products costing more than $50.00, we could use the following query:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample1.sql)]

<span data-ttu-id="7403e-116">In der Regel werden die in einer `WHERE`-Klausel verwendeten Werte durch eine externe Quelle, z. b. einen QueryString-Wert, eine Sitzungs Variable oder eine Benutzereingabe von einem websteuer Element auf der Seite, bestimmt.</span><span class="sxs-lookup"><span data-stu-id="7403e-116">Typically, the values used in a `WHERE` clause are determine by some external source, such as a querystring value, a session variable, or user input from a Web control on the page.</span></span> <span data-ttu-id="7403e-117">Im Idealfall werden solche Eingaben durch die Verwendung von *Parametern*angegeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-117">Ideally, such inputs are specified through the use of *parameters*.</span></span> <span data-ttu-id="7403e-118">Bei Microsoft SQL Server werden Parameter mit `@parameterName`bezeichnet, wie in:</span><span class="sxs-lookup"><span data-stu-id="7403e-118">With Microsoft SQL Server, parameters are denoted using `@parameterName`, as in:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample2.sql)]

<span data-ttu-id="7403e-119">SqlDataSource unterstützt parametrisierte Abfragen, sowohl für `SELECT`-Anweisungen als auch für die Anweisungen `INSERT`, `UPDATE`und `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="7403e-119">The SqlDataSource supports parameterized queries, both for `SELECT` statements and `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="7403e-120">Darüber hinaus können die Parameterwerte automatisch aus einer Vielzahl von Quellen abgerufen werden: QueryString, Sitzungs Status, Steuerelemente auf der Seite usw. oder können Programm gesteuert zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-120">Moreover, the parameter values can be automatically pulled from a variety of sources the querystring, session state, controls on the page, and so on or can be assigned programmatically.</span></span> <span data-ttu-id="7403e-121">In diesem Tutorial erfahren Sie, wie Sie parametrisierte Abfragen definieren und die Parameterwerte sowohl deklarativ als auch Programm gesteuert angeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-121">In this tutorial, we'll see how to define parameterized queries as well as how to specify the parameter values both declaratively and programmatically.</span></span>

> [!NOTE]
> <span data-ttu-id="7403e-122">Im vorherigen Tutorial haben wir die ObjectDataSource verglichen, bei der es sich um die ersten 46-Tutorials mit der SqlDataSource handelt, die Ihre konzeptionellen Ähnlichkeiten notieren.</span><span class="sxs-lookup"><span data-stu-id="7403e-122">In the previous tutorial we compared the ObjectDataSource which has been our tool of choice over the first 46 tutorials with the SqlDataSource, noting their conceptual similarities.</span></span> <span data-ttu-id="7403e-123">Diese Ähnlichkeiten sind auch auf-Parameter ausgedehnt.</span><span class="sxs-lookup"><span data-stu-id="7403e-123">These similarities also extend to parameters.</span></span> <span data-ttu-id="7403e-124">Die ObjectDataSource s-Parameter, die den Eingabe Parametern für die Methoden in der Geschäftslogik Schicht zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="7403e-124">The ObjectDataSource s parameters mapped to the input parameters for the methods in the Business Logic Layer.</span></span> <span data-ttu-id="7403e-125">Mit SqlDataSource werden die Parameter direkt in der SQL-Abfrage definiert.</span><span class="sxs-lookup"><span data-stu-id="7403e-125">With the SqlDataSource, the parameters are defined directly within the SQL query.</span></span> <span data-ttu-id="7403e-126">Beide Steuerelemente verfügen über Auflistungen von Parametern für Ihre `Select()`-, `Insert()`-, `Update()`-und `Delete()`-Methoden, und beide können diese Parameterwerte aus vordefinierten Quellen (QueryString-Werte, Sitzungsvariablen usw.) füllen oder Programm gesteuert zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-126">Both controls have collections of parameters for their `Select()`, `Insert()`, `Update()`, and `Delete()` methods, and both can have these parameter values populated from pre-defined sources (querystring values, session variables, and so on) or assigned programmatically.</span></span>

## <a name="creating-a-parameterized-query"></a><span data-ttu-id="7403e-127">Erstellen einer parametrisierten Abfrage</span><span class="sxs-lookup"><span data-stu-id="7403e-127">Creating a Parameterized Query</span></span>

<span data-ttu-id="7403e-128">Der Assistent zum Konfigurieren von Datenquellen von SqlDataSource Control s bietet drei Möglichkeiten zum Definieren des Befehls, der zum Abrufen von Datenbankdaten Sätzen ausgeführt werden soll:</span><span class="sxs-lookup"><span data-stu-id="7403e-128">The SqlDataSource control s Configure Data Source wizard offers three avenues for defining the command to execute to retrieve database records:</span></span>

- <span data-ttu-id="7403e-129">Durch Auswählen der Spalten aus einer vorhandenen Tabelle oder Sicht</span><span class="sxs-lookup"><span data-stu-id="7403e-129">By picking the columns from an existing table or view,</span></span>
- <span data-ttu-id="7403e-130">Durch Eingabe einer benutzerdefinierten SQL-Anweisung oder</span><span class="sxs-lookup"><span data-stu-id="7403e-130">By entering a custom SQL statement, or</span></span>
- <span data-ttu-id="7403e-131">Durch Auswählen einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="7403e-131">By choosing a stored procedure</span></span>

<span data-ttu-id="7403e-132">Beim Auswählen von Spalten aus einer vorhandenen Tabelle oder Sicht müssen die Parameter für die `WHERE`-Klausel über das Dialogfeld `WHERE` Klausel hinzufügen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-132">When picking columns from an existing table or view, the parameters for the `WHERE` clause must be specified through the Add `WHERE` Clause dialog box.</span></span> <span data-ttu-id="7403e-133">Wenn Sie jedoch eine benutzerdefinierte SQL-Anweisung erstellen, können Sie die Parameter direkt in die `WHERE`-Klausel eingeben (wobei Sie `@parameterName` verwenden, um die einzelnen Parameter anzugeben).</span><span class="sxs-lookup"><span data-stu-id="7403e-133">When creating a custom SQL statement, however, you can enter the parameters directly into the `WHERE` clause (using `@parameterName` to denote each parameter).</span></span> <span data-ttu-id="7403e-134">Eine [gespeicherte Prozedur](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) besteht aus einer oder mehreren SQL-Anweisungen, und diese Anweisungen können parametrisiert werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-134">A [stored procedure](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1) consists of one or more SQL statements, and these statements can be parameterized.</span></span> <span data-ttu-id="7403e-135">Die in den SQL-Anweisungen verwendeten Parameter müssen jedoch als Eingabeparameter an die gespeicherte Prozedur übermittelt werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-135">The parameters used in the SQL statements, however, must be passed in as input parameters to the stored procedure.</span></span>

<span data-ttu-id="7403e-136">Da das Erstellen einer parametrisierten Abfrage davon abhängt, wie die SqlDataSource s-`SelectCommand` angegeben wird, sehen Sie sich die folgenden drei Ansätze an.</span><span class="sxs-lookup"><span data-stu-id="7403e-136">Since creating a parameterized query depends on how the SqlDataSource s `SelectCommand` is specified, let s take a look at all three approaches.</span></span> <span data-ttu-id="7403e-137">Öffnen Sie zunächst die Seite `ParameterizedQueries.aspx` im Ordner `SqlDataSource`, ziehen Sie ein SqlDataSource-Steuerelement aus der Toolbox auf den Designer, und legen Sie dessen `ID` auf `Products25BucksAndUnderDataSource`fest.</span><span class="sxs-lookup"><span data-stu-id="7403e-137">To get started, open the `ParameterizedQueries.aspx` page in the `SqlDataSource` folder, drag a SqlDataSource control from the Toolbox onto the Designer, and set its `ID` to `Products25BucksAndUnderDataSource`.</span></span> <span data-ttu-id="7403e-138">Klicken Sie anschließend auf den Link Datenquelle konfigurieren des Smarttags für Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="7403e-138">Next, click the Configure Data Source link from the control s smart tag.</span></span> <span data-ttu-id="7403e-139">Wählen Sie die zu verwendende Datenbank aus (`NORTHWINDConnectionString`), und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="7403e-139">Select the database to use (`NORTHWINDConnectionString`) and click Next.</span></span>

## <a name="step-1-adding-awhereclause-when-picking-the-columns-from-a-table-or-view"></a><span data-ttu-id="7403e-140">Schritt 1: Hinzufügen einer`WHERE`-Klausel beim Auswählen der Spalten aus einer Tabelle oder Sicht</span><span class="sxs-lookup"><span data-stu-id="7403e-140">Step 1: Adding a`WHERE`Clause When Picking the Columns from a Table or View</span></span>

<span data-ttu-id="7403e-141">Wenn Sie die Daten auswählen, die aus der Datenbank mit dem SqlDataSource-Steuerelement zurückgegeben werden sollen, können Sie mit dem Assistenten zum Konfigurieren von Datenquellen einfach die Spalten auswählen, die aus einer vorhandenen Tabelle oder Sicht zurückgegeben werden sollen (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="7403e-141">When selecting the data to return from the database with the SqlDataSource control, the Configure Data Source wizard allows us to simply pick the columns to return from an existing table or view (see Figure 1).</span></span> <span data-ttu-id="7403e-142">Dadurch wird automatisch eine SQL `SELECT`-Anweisung erstellt, die an die Datenbank gesendet wird, wenn die SqlDataSource s `Select()`-Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-142">Doing so automatically builds up a SQL `SELECT` statement, which is what is sent to the database when the SqlDataSource s `Select()` method is invoked.</span></span> <span data-ttu-id="7403e-143">Wählen Sie wie im vorherigen Tutorial in der Dropdown Liste die Tabelle Products aus, und überprüfen Sie die Spalten `ProductID`, `ProductName`und `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="7403e-143">As we did in the previous tutorial, select the Products table from the drop-down list and check the `ProductID`, `ProductName`, and `UnitPrice` columns.</span></span>

<span data-ttu-id="7403e-144">[![die Spalten auszuwählen, die aus einer Tabelle oder Sicht zurückgegeben werden sollen.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-144">[![Pick the Columns to Return from a Table or View](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image1.png)</span></span>

<span data-ttu-id="7403e-145">**Abbildung 1**: Auswählen der Spalten, die aus einer Tabelle oder Sicht zurückgegeben werden sollen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-145">**Figure 1**: Pick the Columns to Return from a Table or View ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.png))</span></span>

<span data-ttu-id="7403e-146">Wenn Sie eine `WHERE`-Klausel in die `SELECT` Anweisung einschließen möchten, klicken Sie auf die Schaltfläche `WHERE`, die das Dialogfeld `WHERE` Klausel hinzufügen öffnet (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="7403e-146">To include a `WHERE` clause in the `SELECT` statement, click the `WHERE` button, which brings up the Add `WHERE` Clause dialog box (see Figure 2).</span></span> <span data-ttu-id="7403e-147">Um einen Parameter hinzuzufügen, um die von der `SELECT` Abfrage zurückgegebenen Ergebnisse einzuschränken, wählen Sie zuerst die Spalte aus, nach der die Daten gefiltert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="7403e-147">To add a parameter to limit the results returned by the `SELECT` query, first choose the column to filter the data by.</span></span> <span data-ttu-id="7403e-148">Wählen Sie als nächstes den Operator aus, der zum Filtern verwendet werden soll (=, &lt;, &lt;=, &gt;usw.).</span><span class="sxs-lookup"><span data-stu-id="7403e-148">Next, choose the operator to use for filtering (=, &lt;, &lt;=, &gt;, and so on).</span></span> <span data-ttu-id="7403e-149">Wählen Sie schließlich die Quelle des Werts des Parameters s aus, z. b. aus dem QueryString-oder Sitzungszustand.</span><span class="sxs-lookup"><span data-stu-id="7403e-149">Finally, choose the source of the parameter s value, such as from the querystring or session state.</span></span> <span data-ttu-id="7403e-150">Nachdem Sie den Parameter konfiguriert haben, klicken Sie auf die Schaltfläche hinzufügen, um Sie in die `SELECT` Abfrage einzufügen.</span><span class="sxs-lookup"><span data-stu-id="7403e-150">After configuring the parameter, click the Add button to include it in the `SELECT` query.</span></span>

<span data-ttu-id="7403e-151">Geben Sie in diesem Beispiel nur die Ergebnisse zurück, bei denen der `UnitPrice` Wert kleiner oder gleich $25,00 ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-151">For this example, let s only return those results where the `UnitPrice` value is less than or equal to $25.00.</span></span> <span data-ttu-id="7403e-152">Wählen Sie aus der Dropdown Liste Spalte `UnitPrice` aus, und &lt;= aus der Dropdown Liste Operator aus.</span><span class="sxs-lookup"><span data-stu-id="7403e-152">Therefore, pick `UnitPrice` from the Column drop-down list and &lt;= from the Operator drop-down list.</span></span> <span data-ttu-id="7403e-153">Wenn Sie einen hart codierten Parameterwert verwenden (z. b. $25,00) oder wenn der Parameterwert Programm gesteuert angegeben werden soll, wählen Sie in der Dropdown Liste Quelle die Option keine aus.</span><span class="sxs-lookup"><span data-stu-id="7403e-153">When using a hard-coded parameter value (such as $25.00) or if the parameter value is to be specified programmatically, select None from the Source drop-down list.</span></span> <span data-ttu-id="7403e-154">Geben Sie als nächstes den hart codierten Parameterwert im Textfeld Wert 25,00 ein, und schließen Sie den Prozess ab, indem Sie auf die Schaltfläche Hinzufügen klicken.</span><span class="sxs-lookup"><span data-stu-id="7403e-154">Next, enter the hard-coded parameter value in the Value textbox 25.00 and complete the process by clicking the Add button.</span></span>

<span data-ttu-id="7403e-155">[![die im Dialog Feld WHERE-Klausel hinzufügen zurückgegebenen Ergebnisse einschränken.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-155">[![Limit the Results Returned from the Add WHERE Clause Dialog Box](using-parameterized-queries-with-the-sqldatasource-cs/_static/image2.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.png)</span></span>

<span data-ttu-id="7403e-156">**Abbildung 2**: Begrenzen der Ergebnisse, die im Dialog Feld "`WHERE` Klausel hinzufügen" zurückgegeben werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-156">**Figure 2**: Limit the Results Returned from the Add `WHERE` Clause Dialog Box ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.png))</span></span>

<span data-ttu-id="7403e-157">Klicken Sie nach dem Hinzufügen des Parameters auf OK, um zum Assistenten zum Konfigurieren von Datenquellen zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="7403e-157">After adding the parameter, click OK to return to the Configure Data Source wizard.</span></span> <span data-ttu-id="7403e-158">Die `SELECT`-Anweisung am Ende des Assistenten sollte nun eine `WHERE`-Klausel mit einem Parameter mit dem Namen `@UnitPrice`einschließen:</span><span class="sxs-lookup"><span data-stu-id="7403e-158">The `SELECT` statement at the bottom of the wizard should now include a `WHERE` clause with a parameter named `@UnitPrice`:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample3.sql)]

> [!NOTE]
> <span data-ttu-id="7403e-159">Wenn Sie im Dialogfeld `WHERE` Klausel hinzufügen mehrere Bedingungen in der `WHERE`-Klausel angeben, werden Sie vom Assistenten mit dem `AND`-Operator verbunden.</span><span class="sxs-lookup"><span data-stu-id="7403e-159">If you specify multiple conditions in the `WHERE` clause from the Add `WHERE` Clause dialog box, the wizard joins them with the `AND` operator.</span></span> <span data-ttu-id="7403e-160">Wenn Sie eine `OR` in die `WHERE`-Klausel (z. b. `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) einschließen müssen, müssen Sie die `SELECT`-Anweisung über den benutzerdefinierten SQL-Anweisungs Bildschirm erstellen.</span><span class="sxs-lookup"><span data-stu-id="7403e-160">If you need to include an `OR` in the `WHERE` clause (such as `WHERE UnitPrice <= @UnitPrice OR Discontinued = 1`) then you have to build the `SELECT` statement through the custom SQL statement screen.</span></span>

<span data-ttu-id="7403e-161">Vervollständigen Sie die Konfiguration von SqlDataSource (Klicken Sie auf weiter und dann auf Fertigstellen), und überprüfen Sie dann das deklarative Markup von SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="7403e-161">Complete configuring the SqlDataSource (click Next, then Finish) and then inspect the SqlDataSource s declarative markup.</span></span> <span data-ttu-id="7403e-162">Das Markup enthält jetzt eine `<SelectParameters>`-Auflistung, die die Quellen für die Parameter in der `SelectCommand`auslöst.</span><span class="sxs-lookup"><span data-stu-id="7403e-162">The markup now includes a `<SelectParameters>` collection, which spells out the sources for the parameters in the `SelectCommand`.</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample4.aspx)]

<span data-ttu-id="7403e-163">Wenn die SqlDataSource s-`Select()`-Methode aufgerufen wird, wird der `UnitPrice` Parameterwert (25,00) auf den `@UnitPrice`-Parameter in der `SelectCommand` angewendet, bevor er an die Datenbank gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-163">When the SqlDataSource s `Select()` method is invoked, the `UnitPrice` parameter value (25.00) is applied to the `@UnitPrice` parameter in the `SelectCommand` before being sent to the database.</span></span> <span data-ttu-id="7403e-164">Das Ergebnis ist, dass nur die Produkte, die kleiner oder gleich $25,00 sind, aus der `Products` Tabelle zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-164">The net result is that only those products less than or equal to $25.00 are returned from the `Products` table.</span></span> <span data-ttu-id="7403e-165">Um dies zu bestätigen, fügen Sie der Seite eine GridView hinzu, binden Sie an diese Datenquelle, und zeigen Sie dann die Seite über einen Browser an.</span><span class="sxs-lookup"><span data-stu-id="7403e-165">To confirm this, add a GridView to the page, bind it to this data source, and then view the page through a browser.</span></span> <span data-ttu-id="7403e-166">Es sollten nur die aufgeführten Produkte angezeigt werden, die kleiner oder gleich $25,00 sind, wie in Abbildung 3 zu sehen.</span><span class="sxs-lookup"><span data-stu-id="7403e-166">You should only see those products listed that are less than or equal to $25.00, as Figure 3 confirms.</span></span>

<span data-ttu-id="7403e-167">[![nur die Produkte, die kleiner oder gleich $25,00 sind, angezeigt.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-167">[![Only Those Products Less Than or Equal to $25.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image3.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="7403e-168">**Abbildung 3**: nur die Produkte, die kleiner oder gleich $25,00 sind, werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-168">**Figure 3**: Only Those Products Less Than or Equal to $25.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.png))</span></span>

## <a name="step-2-adding-parameters-to-a-custom-sql-statement"></a><span data-ttu-id="7403e-169">Schritt 2: Hinzufügen von Parametern zu einer benutzerdefinierten SQL-Anweisung</span><span class="sxs-lookup"><span data-stu-id="7403e-169">Step 2: Adding Parameters to a Custom SQL Statement</span></span>

<span data-ttu-id="7403e-170">Wenn Sie eine benutzerdefinierte SQL-Anweisung hinzufügen, können Sie die `WHERE`-Klausel explizit eingeben oder in der Filter Zelle des Abfrage-Generator einen Wert angeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-170">When adding a custom SQL statement you can enter the `WHERE` clause explicitly or specify a value in the Filter cell of the Query Builder.</span></span> <span data-ttu-id="7403e-171">Um dies zu veranschaulichen, lassen Sie es nur die Produkte in einer GridView anzeigen, deren Preise kleiner als ein bestimmter Schwellenwert sind.</span><span class="sxs-lookup"><span data-stu-id="7403e-171">To demonstrate this, let s display just those products in a GridView whose prices are less than a certain threshold.</span></span> <span data-ttu-id="7403e-172">Fügen Sie zunächst der Seite "`ParameterizedQueries.aspx`" ein Textfeld hinzu, um diesen Schwellenwert für den Benutzer zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="7403e-172">Start by adding a TextBox to the `ParameterizedQueries.aspx` page to collect this threshold value from the user.</span></span> <span data-ttu-id="7403e-173">Legen Sie für die Eigenschaft TextBox s `ID` den Wert `MaxPrice`fest.</span><span class="sxs-lookup"><span data-stu-id="7403e-173">Set the TextBox s `ID` property to `MaxPrice`.</span></span> <span data-ttu-id="7403e-174">Fügen Sie ein Schaltflächen-websteuer Element hinzu, und legen Sie dessen `Text`-Eigenschaft auf passende Produkte anzeigen</span><span class="sxs-lookup"><span data-stu-id="7403e-174">Add a Button Web control and set its `Text` property to Display Matching Products .</span></span>

<span data-ttu-id="7403e-175">Ziehen Sie als nächstes eine GridView auf die Seite, und wählen Sie aus dem Smarttag aus, um eine neue SqlDataSource namens `ProductsFilteredByPriceDataSource`zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="7403e-175">Next, drag a GridView onto the page and from its smart tag choose to create a new SqlDataSource named `ProductsFilteredByPriceDataSource`.</span></span> <span data-ttu-id="7403e-176">Wechseln Sie im Assistenten zum Konfigurieren von Datenquellen mit dem Bildschirm benutzerdefinierte SQL-Anweisung oder gespeicherte Prozedur angeben (siehe Abbildung 4), und geben Sie die folgende Abfrage ein:</span><span class="sxs-lookup"><span data-stu-id="7403e-176">From the Configure Data Source wizard, proceed to the Specify a custom SQL statement or stored procedure screen (see Figure 4) and enter the following query:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample5.sql)]

<span data-ttu-id="7403e-177">Klicken Sie nach dem Eingeben der Abfrage (entweder manuell oder über die Abfrage-Generator) auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="7403e-177">After entering the query (either manually or through the Query Builder), click Next.</span></span>

<span data-ttu-id="7403e-178">[![nur solche Produkte zurückgeben, die kleiner oder gleich einem Parameter Wert sind.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-178">[![Return Only Those Products Less Than or Equal to a Parameter Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image4.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.png)</span></span>

<span data-ttu-id="7403e-179">**Abbildung 4**: nur solche Produkte zurückgeben, die kleiner oder gleich einem Parameter Wert sind ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-179">**Figure 4**: Return Only Those Products Less Than or Equal to a Parameter Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.png))</span></span>

<span data-ttu-id="7403e-180">Da die Abfrage Parameter enthält, fordert der nächste Bildschirm im Assistenten die Quelle der Parameterwerte an.</span><span class="sxs-lookup"><span data-stu-id="7403e-180">Since the query includes parameters, the next screen in the wizard prompts us for the source of the parameters values.</span></span> <span data-ttu-id="7403e-181">Wählen Sie in der Dropdown Liste Parameter Quelle die Option Steuerelement aus, und `MaxPrice` (das Textfeld-Steuerelement s `ID` Wert) aus der ControlID-Dropdown Liste.</span><span class="sxs-lookup"><span data-stu-id="7403e-181">Choose Control from the Parameter source drop-down list and `MaxPrice` (the TextBox control s `ID` value) from the ControlID drop-down list.</span></span> <span data-ttu-id="7403e-182">Sie können auch einen optionalen Standardwert eingeben, der verwendet werden soll, wenn der Benutzer keinen Text in das Textfeld `MaxPrice` eingegeben hat.</span><span class="sxs-lookup"><span data-stu-id="7403e-182">You can also enter an optional default value to use in the case where the user has not entered any text into the `MaxPrice` TextBox.</span></span> <span data-ttu-id="7403e-183">Geben Sie für den Zeitpunkt keinen Standardwert ein.</span><span class="sxs-lookup"><span data-stu-id="7403e-183">For the time being, do not enter a default value.</span></span>

<span data-ttu-id="7403e-184">[![die maxprice s Text-Eigenschaft als Parameter Quelle verwendet.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-184">[![The MaxPrice TextBox s Text Property is Used as the Parameter Source](using-parameterized-queries-with-the-sqldatasource-cs/_static/image5.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="7403e-185">**Abbildung 5**: die `MaxPrice` TextBox s `Text` Eigenschaft wird als Parameter Quelle verwendet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-185">**Figure 5**: The `MaxPrice` TextBox s `Text` Property is Used as the Parameter Source ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.png))</span></span>

<span data-ttu-id="7403e-186">Klicken Sie zum Abschließen des Assistenten zum Konfigurieren von Datenquellen auf weiter und dann auf Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="7403e-186">Complete the Configure Data Source wizard by clicking Next, then Finish.</span></span> <span data-ttu-id="7403e-187">Das deklarative Markup für GridView, TextBox, Button und SqlDataSource folgt:</span><span class="sxs-lookup"><span data-stu-id="7403e-187">The declarative markup for the GridView, TextBox, Button, and SqlDataSource follows:</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample6.aspx)]

<span data-ttu-id="7403e-188">Beachten Sie, dass der Parameter im Abschnitt SqlDataSource s `<SelectParameters>` ein `ControlParameter`ist, der zusätzliche Eigenschaften wie `ControlID` und `PropertyName`enthält.</span><span class="sxs-lookup"><span data-stu-id="7403e-188">Note that the parameter within the SqlDataSource s `<SelectParameters>` section is a `ControlParameter`, which includes additional properties like `ControlID` and `PropertyName`.</span></span> <span data-ttu-id="7403e-189">Wenn die SqlDataSource s-`Select()`-Methode aufgerufen wird, greift der `ControlParameter` den Wert aus der angegebenen websteuer Element Eigenschaft ab und weist ihn dem entsprechenden Parameter in der `SelectCommand`zu.</span><span class="sxs-lookup"><span data-stu-id="7403e-189">When the SqlDataSource s `Select()` method is invoked, the `ControlParameter` grabs the value from the specified Web control property and assigns it to the corresponding parameter in the `SelectCommand`.</span></span> <span data-ttu-id="7403e-190">In diesem Beispiel wird die Text-Eigenschaft `MaxPrice` s als `@MaxPrice` Parameterwert verwendet.</span><span class="sxs-lookup"><span data-stu-id="7403e-190">In this example, the `MaxPrice` s Text property is used as the `@MaxPrice` parameter value.</span></span>

<span data-ttu-id="7403e-191">Nehmen Sie sich eine Minute Zeit, um diese Seite in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="7403e-191">Take a minute to view this page through a browser.</span></span> <span data-ttu-id="7403e-192">Wenn Sie zum ersten Mal die Seite aufrufen oder wenn im Textfeld `MaxPrice` ein Wert fehlt, werden in der GridView keine Datensätze angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7403e-192">When first visiting the page or whenever the `MaxPrice` TextBox lacks a value no records are displayed in the GridView.</span></span>

<span data-ttu-id="7403e-193">[Wenn das Textfeld maxprice leer ist, ![keine Datensätze angezeigt.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-193">[![No Records are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-cs/_static/image6.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="7403e-194">**Abbildung 6**: Es werden keine Datensätze angezeigt, wenn das `MaxPrice` Textfeld leer ist ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-194">**Figure 6**: No Records are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.png))</span></span>

<span data-ttu-id="7403e-195">Der Grund, warum keine Produkte angezeigt werden, liegt darin, dass standardmäßig eine leere Zeichenfolge für einen Parameterwert in eine Datenbank `NULL` Wert konvertiert wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-195">The reason no products are shown is because, by default, an empty string for a parameter value is converted into a database `NULL` value.</span></span> <span data-ttu-id="7403e-196">Da der Vergleich von `[UnitPrice] <= NULL` immer als false ausgewertet wird, werden keine Ergebnisse zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-196">Since the comparison of `[UnitPrice] <= NULL` always evaluates as False, no results are returned.</span></span>

<span data-ttu-id="7403e-197">Geben Sie einen Wert in das Textfeld ein, z. b. 5,00, und klicken Sie auf die Schaltfläche passende Produkte anzeigen.</span><span class="sxs-lookup"><span data-stu-id="7403e-197">Enter a value into the textbox, like 5.00, and click the Display Matching Products button.</span></span> <span data-ttu-id="7403e-198">Beim Postback teilt SqlDataSource dem GridView mit, dass sich einer seiner Parameter Quellen geändert hat.</span><span class="sxs-lookup"><span data-stu-id="7403e-198">On postback, the SqlDataSource informs the GridView that one of its parameter sources has changed.</span></span> <span data-ttu-id="7403e-199">Folglich wird die GridView an die SqlDataSource zurückgebunden und zeigt diese Produkte an, die kleiner oder gleich $5,00 sind.</span><span class="sxs-lookup"><span data-stu-id="7403e-199">Consequently, the GridView rebinds to the SqlDataSource, displaying those products less than or equal to $5.00.</span></span>

<span data-ttu-id="7403e-200">[Es werden ![Produkte angezeigt, die kleiner oder gleich $5,00 sind.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-200">[![Products Less Than or Equal to $5.00 are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image7.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.png)</span></span>

<span data-ttu-id="7403e-201">**Abbildung 7**: Produkte, die kleiner oder gleich $5,00 sind, werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-201">**Figure 7**: Products Less Than or Equal to $5.00 are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.png))</span></span>

## <a name="initially-displaying-all-products"></a><span data-ttu-id="7403e-202">Anfänglich alle Produkte anzeigen</span><span class="sxs-lookup"><span data-stu-id="7403e-202">Initially Displaying All Products</span></span>

<span data-ttu-id="7403e-203">Anstatt beim ersten Laden der Seite keine Produkte anzuzeigen, möchten wir möglicherweise *alle* Produkte anzeigen.</span><span class="sxs-lookup"><span data-stu-id="7403e-203">Rather than displaying no products when the page is first loaded, we may want to display *all* products.</span></span> <span data-ttu-id="7403e-204">Eine Möglichkeit, alle Produkte aufzulisten, wenn das `MaxPrice` Textfeld leer ist, besteht darin, den Standardwert des Parameters auf einen sehr hohen Wert, wie z. b. 1 Million, festzulegen, da es unwahrscheinlich ist, dass Northwind Traders jemals Inventuren haben wird, deren Einheitspreis $1 Million überschreitet.</span><span class="sxs-lookup"><span data-stu-id="7403e-204">One way to list all products whenever the `MaxPrice` TextBox is empty is to set the parameter s default value to some insanely high value, like 1000000, since it s unlikely that Northwind Traders will ever have inventory whose unit price exceeds $1,000,000.</span></span> <span data-ttu-id="7403e-205">Dieser Ansatz ist jedoch kurzsichtig und funktioniert möglicherweise nicht in anderen Fällen.</span><span class="sxs-lookup"><span data-stu-id="7403e-205">However, this approach is shortsighted and might not work in other situations.</span></span>

<span data-ttu-id="7403e-206">In vorherigen Tutorials: [deklarative Parameter](../basic-reporting/declarative-parameters-cs.md) und die [Master/Detail-Filterung mit einer Dropdown List](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) haben wir ein ähnliches Problem festgestellt.</span><span class="sxs-lookup"><span data-stu-id="7403e-206">In previous tutorials - [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) and [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) we were faced with a similar problem.</span></span> <span data-ttu-id="7403e-207">Unsere Lösung bestand darin, diese Logik in die Geschäftslogik Schicht zu versetzen.</span><span class="sxs-lookup"><span data-stu-id="7403e-207">Our solution there was to put this logic in the Business Logic Layer.</span></span> <span data-ttu-id="7403e-208">Insbesondere untersuchte der BLL den eingehenden Wert, und wenn er `NULL` oder ein reservierter Wert war, wurde der-Befehl an die DAL-Methode weitergeleitet, die alle Datensätze zurückgegeben hat.</span><span class="sxs-lookup"><span data-stu-id="7403e-208">Specifically, the BLL examined the incoming value and, if it was `NULL` or some reserved value, the call was routed to the DAL method that returned all records.</span></span> <span data-ttu-id="7403e-209">Wenn der eingehende Wert ein normaler Filter Wert war, wurde an der dal-Methode ein-Befehl ausgeführt, der eine SQL-Anweisung ausgeführt hat, die eine parametrisierte `WHERE`-Klausel mit dem angegebenen Wert verwendet hat.</span><span class="sxs-lookup"><span data-stu-id="7403e-209">If the incoming value was a normal filtering value, a call was made to the DAL method that executed a SQL statement that used a parameterized `WHERE` clause with the supplied value.</span></span>

<span data-ttu-id="7403e-210">Leider umgehen wir die Architektur bei Verwendung von SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="7403e-210">Unfortunately, we bypass the architecture when using the SqlDataSource.</span></span> <span data-ttu-id="7403e-211">Stattdessen muss die SQL-Anweisung angepasst werden, um alle Datensätze intelligent zu erfassen, wenn der `@MaximumPrice` Parameter `NULL` oder ein reservierter Wert ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-211">Instead, we need to customize the SQL statement to intelligently grab all records if the `@MaximumPrice` parameter is `NULL` or some reserved value.</span></span> <span data-ttu-id="7403e-212">Bei dieser Übung lassen Sie es für den Fall, dass der `@MaximumPrice` Parameter gleich `-1.0`ist, dass *alle* Datensätze zurückgegeben werden (`-1.0` funktioniert als reservierter Wert, da kein Produkt einen negativen `UnitPrice` Wert aufweisen kann).</span><span class="sxs-lookup"><span data-stu-id="7403e-212">For this exercise, let s have it so that if the `@MaximumPrice` parameter is equal to `-1.0`, then *all* of the records are to be returned (`-1.0` works as a reserved value since no product can have a negative `UnitPrice` value).</span></span> <span data-ttu-id="7403e-213">Um dies zu erreichen, können wir die folgende SQL-Anweisung verwenden:</span><span class="sxs-lookup"><span data-stu-id="7403e-213">To accomplish this we can use the following SQL statement:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample7.sql)]

<span data-ttu-id="7403e-214">Diese `WHERE`-Klausel gibt *alle* Datensätze zurück, wenn der `@MaximumPrice` Parameter `-1.0`ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-214">This `WHERE` clause returns *all* records if the `@MaximumPrice` parameter equals `-1.0`.</span></span> <span data-ttu-id="7403e-215">Wenn der Parameterwert nicht `-1.0`ist, werden nur die Produkte zurückgegeben, deren `UnitPrice` kleiner oder gleich dem `@MaximumPrice` Parameterwert ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-215">If the parameter value is not `-1.0`, only those products whose `UnitPrice` is less than or equal to the `@MaximumPrice` parameter value are returned.</span></span> <span data-ttu-id="7403e-216">Wenn Sie den Standardwert des `@MaximumPrice`-Parameters auf `-1.0`festlegen, wird beim ersten Laden der Seite (oder wenn das `MaxPrice` Textfeld leer ist) `@MaximumPrice` der Wert `-1.0` angezeigt, und alle Produkte werden angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7403e-216">By setting the default value of the `@MaximumPrice` parameter to `-1.0`, on the first page load (or whenever the `MaxPrice` TextBox is empty), `@MaximumPrice` will have a value of `-1.0` and all products will be displayed.</span></span>

<span data-ttu-id="7403e-217">[![jetzt werden alle Produkte angezeigt, wenn das Textfeld maxprice leer ist.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-217">[![Now All Products are Displayed When the MaxPrice TextBox is Empty](using-parameterized-queries-with-the-sqldatasource-cs/_static/image8.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.png)</span></span>

<span data-ttu-id="7403e-218">**Abbildung 8**: jetzt werden alle Produkte angezeigt, wenn das `MaxPrice` Textfeld leer ist ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-218">**Figure 8**: Now All Products are Displayed When the `MaxPrice` TextBox is Empty ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image16.png))</span></span>

<span data-ttu-id="7403e-219">Bei diesem Ansatz sind einige Einschränkungen zu beachten.</span><span class="sxs-lookup"><span data-stu-id="7403e-219">There are a couple of caveats to note with this approach.</span></span> <span data-ttu-id="7403e-220">Beachten Sie zunächst, dass der Datentyp des Parameters s durch die Verwendung in der SQL-Abfrage abgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-220">First, realize that the parameter s data type is inferred by it s usage in the SQL query.</span></span> <span data-ttu-id="7403e-221">Wenn Sie die `WHERE`-Klausel von `@MaximumPrice = -1.0` in `@MaximumPrice = -1`ändern, behandelt die Laufzeit den-Parameter als ganze Zahl.</span><span class="sxs-lookup"><span data-stu-id="7403e-221">If you change the `WHERE` clause from `@MaximumPrice = -1.0` to `@MaximumPrice = -1`, the runtime treats the parameter as an integer.</span></span> <span data-ttu-id="7403e-222">Wenn Sie dann versuchen, das `MaxPrice` Textfeld einem Dezimalwert zuzuweisen (z. b. 5,00), tritt ein Fehler auf, weil der Wert von 5,00 nicht in eine ganze Zahl konvertiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="7403e-222">If you then attempt to assign the `MaxPrice` TextBox to a decimal value (like 5.00 ), an error will occur because it cannot convert 5.00 to an integer.</span></span> <span data-ttu-id="7403e-223">Um dieses Problem zu beheben, stellen Sie sicher, dass Sie `@MaximumPrice = -1.0` in der `WHERE`-Klausel verwenden, oder legen Sie für die `ControlParameter` Objekt s `Type`-Eigenschaft den Wert Decimal fest.</span><span class="sxs-lookup"><span data-stu-id="7403e-223">To remedy this, either make sure that you use `@MaximumPrice = -1.0` in the `WHERE` clause or, better yet, set the `ControlParameter` object s `Type` property to Decimal .</span></span>

<span data-ttu-id="7403e-224">Durch das Hinzufügen der `OR @MaximumPrice = -1.0` zur `WHERE`-Klausel kann die Abfrage-Engine einen Index für `UnitPrice` nicht verwenden (sofern vorhanden), was zu einem Tabellenscan führt.</span><span class="sxs-lookup"><span data-stu-id="7403e-224">Secondly, by adding the `OR @MaximumPrice = -1.0` to the `WHERE` clause, the query engine cannot use an index on `UnitPrice` (assuming one exists), thereby resulting in a table scan.</span></span> <span data-ttu-id="7403e-225">Dies kann sich auf die Leistung auswirken, wenn in der `Products` Tabelle eine ausreichend große Anzahl von Datensätzen vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-225">This can impact performance if there are a sufficiently large number of records in the `Products` table.</span></span> <span data-ttu-id="7403e-226">Ein besserer Ansatz wäre, diese Logik in eine gespeicherte Prozedur zu verschieben, in der eine `IF`-Anweisung entweder eine `SELECT` Abfrage aus der `Products` Tabelle ohne eine `WHERE`-Klausel ausführen würde, wenn alle Datensätze zurückgegeben werden müssen oder eine, deren `WHERE`-Klausel nur die `UnitPrice` Kriterien enthält, sodass ein Index verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="7403e-226">A better approach would be to move this logic to a stored procedure where an `IF` statement would either perform a `SELECT` query from the `Products` table without a `WHERE` clause when all records need to be returned or one whose `WHERE` clause contains just the `UnitPrice` criteria, so that an index can be used.</span></span>

## <a name="step-3-creating-and-using-parameterized-stored-procedures"></a><span data-ttu-id="7403e-227">Schritt 3: Erstellen und Verwenden von parametrisierten gespeicherten Prozeduren</span><span class="sxs-lookup"><span data-stu-id="7403e-227">Step 3: Creating and Using Parameterized Stored Procedures</span></span>

<span data-ttu-id="7403e-228">Gespeicherte Prozeduren können einen Satz von Eingabe Parametern enthalten, die dann in den SQL-Anweisungen verwendet werden können, die in der gespeicherten Prozedur definiert werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-228">Stored procedures can include a set of input parameters that can then be used in the SQL statement(s) defined within the stored procedure.</span></span> <span data-ttu-id="7403e-229">Beim Konfigurieren von SqlDataSource für die Verwendung einer gespeicherten Prozedur, die Eingabeparameter akzeptiert, können diese Parameterwerte mit denselben Techniken wie bei Ad-hoc-SQL-Anweisungen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-229">When configuring the SqlDataSource to use a stored procedure that accepts input parameters, these parameter values can be specified using the same techniques as with ad-hoc SQL statements.</span></span>

<span data-ttu-id="7403e-230">Um die Verwendung gespeicherter Prozeduren in SqlDataSource zu veranschaulichen, erstellen Sie eine neue gespeicherte Prozedur in der Northwind-Datenbank mit dem Namen `GetProductsByCategory`, die einen Parameter mit dem Namen `@CategoryID` akzeptiert und alle Spalten der Produkte zurückgibt, deren `CategoryID` Spalte `@CategoryID`entspricht.</span><span class="sxs-lookup"><span data-stu-id="7403e-230">To illustrate using stored procedures in the SqlDataSource, let s create a new stored procedure in the Northwind database named `GetProductsByCategory`, which accepts a parameter named `@CategoryID` and returns all of the columns of the products whose `CategoryID` column matches `@CategoryID`.</span></span> <span data-ttu-id="7403e-231">Um eine gespeicherte Prozedur zu erstellen, wechseln Sie zum Server-Explorer, und führen Sie einen Drilldown in die `NORTHWND.MDF` Datenbank aus.</span><span class="sxs-lookup"><span data-stu-id="7403e-231">To create a stored procedure, go to the Server Explorer and drill down into the `NORTHWND.MDF` database.</span></span> <span data-ttu-id="7403e-232">(Wenn Ihnen die Server-Explorer angezeigt wird, klicken Sie auf das Menü Ansicht, und wählen Sie die Option Server-Explorer aus.)</span><span class="sxs-lookup"><span data-stu-id="7403e-232">(If you don t see the Server Explorer, bring it up by going to the View menu and selecting the Server Explorer option.)</span></span>

<span data-ttu-id="7403e-233">Klicken Sie in der `NORTHWND.MDF` Datenbank mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren, wählen Sie neue gespeicherte Prozedur hinzufügen aus, und geben Sie die folgende Syntax ein:</span><span class="sxs-lookup"><span data-stu-id="7403e-233">From the `NORTHWND.MDF` database, right-click on the Stored Procedures folder, choose Add New Stored Procedure, and enter the following syntax:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample8.sql)]

<span data-ttu-id="7403e-234">Klicken Sie auf das Symbol speichern (oder drücken Sie STRG + S), um die gespeicherte Prozedur zu speichern.</span><span class="sxs-lookup"><span data-stu-id="7403e-234">Click the Save icon (or Ctrl+S) to save the stored procedure.</span></span> <span data-ttu-id="7403e-235">Sie können die gespeicherte Prozedur testen, indem Sie im Ordner gespeicherte Prozeduren mit der rechten Maustaste darauf klicken und ausführen auswählen.</span><span class="sxs-lookup"><span data-stu-id="7403e-235">You can test the stored procedure by right-clicking it from the Stored Procedures folder and choosing Execute.</span></span> <span data-ttu-id="7403e-236">Dadurch werden Sie zur Eingabe der Parameter der gespeicherten Prozedur (`@CategoryID`in dieser Instanz) aufgefordert. Anschließend werden die Ergebnisse im Fenster Ausgabe angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7403e-236">This will prompt you for the stored procedure s parameters (`@CategoryID`, in this instance), after which the results will be displayed in the Output window.</span></span>

<span data-ttu-id="7403e-237">[![Sie die gespeicherte Prozedur getproducungbycategory bei Ausführung mit einer @CategoryID von 1.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-237">[![The GetProductsByCategory Stored Procedure when Executed with a @CategoryID of 1](using-parameterized-queries-with-the-sqldatasource-cs/_static/image9.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image17.png)</span></span>

<span data-ttu-id="7403e-238">**Abbildung 9**: die gespeicherte Prozedur `GetProductsByCategory` bei Ausführung mit einem `@CategoryID` von 1 ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-238">**Figure 9**: The `GetProductsByCategory` Stored Procedure when Executed with a `@CategoryID` of 1 ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image18.png))</span></span>

<span data-ttu-id="7403e-239">Verwenden Sie diese gespeicherte Prozedur, um alle Produkte in der Kategorie "Getränke" in einer GridView anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="7403e-239">Let s use this stored procedure to display all products in the Beverages category in a GridView.</span></span> <span data-ttu-id="7403e-240">Fügen Sie der Seite eine neue GridView hinzu, und binden Sie Sie an eine neue SqlDataSource mit dem Namen `BeverageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7403e-240">Add a new GridView to the page and bind it to a new SqlDataSource named `BeverageProductsDataSource`.</span></span> <span data-ttu-id="7403e-241">Fahren Sie mit dem Bildschirm benutzerdefinierte SQL-Anweisung oder gespeicherte Prozedur angeben fort, aktivieren Sie das Optionsfeld gespeicherte Prozedur, und wählen Sie in der Dropdown Liste die gespeicherte Prozedur `GetProductsByCategory` aus.</span><span class="sxs-lookup"><span data-stu-id="7403e-241">Continue to the Specify a custom SQL statement or stored procedure screen, select the Stored procedure radio button, and pick the `GetProductsByCategory` stored procedure from the drop-down list.</span></span>

<span data-ttu-id="7403e-242">[![die gespeicherte Prozedur getproductionbycategory aus der Dropdown Liste auswählen.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-242">[![Select the GetProductsByCategory Stored Procedure from the Drop-Down List](using-parameterized-queries-with-the-sqldatasource-cs/_static/image10.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image19.png)</span></span>

<span data-ttu-id="7403e-243">**Abbildung 10**: Wählen Sie in der Dropdown Liste die gespeicherte Prozedur `GetProductsByCategory` aus ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image20.png)).</span><span class="sxs-lookup"><span data-stu-id="7403e-243">**Figure 10**: Select the `GetProductsByCategory` Stored Procedure from the Drop-Down List ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image20.png))</span></span>

<span data-ttu-id="7403e-244">Da die gespeicherte Prozedur einen Eingabeparameter (`@CategoryID`) akzeptiert, werden wir durch Klicken auf "weiter" aufgefordert, die Quelle für diesen Parameterwert anzugeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-244">Since the stored procedure accepts an input parameter (`@CategoryID`), clicking Next prompts us to specify the source for this parameter s value.</span></span> <span data-ttu-id="7403e-245">Der `CategoryID` Getränke ist 1. lassen Sie daher die Dropdown Liste Parameter Quelle bei None aus, und geben Sie im Textfeld DefaultValue den Wert 1 ein.</span><span class="sxs-lookup"><span data-stu-id="7403e-245">The Beverages `CategoryID` is 1, so leave the Parameter source drop-down list at None and enter 1 into the DefaultValue textbox.</span></span>

<span data-ttu-id="7403e-246">[![einen hart codierten Wert 1 verwenden, um die Produkte in der Kategorie "Getränke" zurückzugeben.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-246">[![Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category](using-parameterized-queries-with-the-sqldatasource-cs/_static/image11.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image21.png)</span></span>

<span data-ttu-id="7403e-247">**Abbildung 11**: Verwenden eines hart codierten Werts von 1 zum Zurückgeben der Produkte in der Kategorie "Getränke" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-247">**Figure 11**: Use a Hard-Coded Value of 1 to Return the Products in the Beverages Category ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image22.png))</span></span>

<span data-ttu-id="7403e-248">Wie das folgende deklarative Markup zeigt, wird beim Verwenden einer gespeicherten Prozedur die SqlDataSource s-`SelectCommand`-Eigenschaft auf den Namen der gespeicherten Prozedur festgelegt, und die [`SelectCommandType`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) wird auf `StoredProcedure`festgelegt, was bedeutet, dass der `SelectCommand` der Name einer gespeicherten Prozedur anstelle einer Ad-hoc-SQL-Anweisung ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-248">As the following declarative markup shows, when using a stored procedure, the SqlDataSource s `SelectCommand` property is set to the name of the stored procedure and the [`SelectCommandType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommandtype.aspx) is set to `StoredProcedure`, indicating that the `SelectCommand` is the name of a stored procedure rather than an ad-hoc SQL statement.</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample9.aspx)]

<span data-ttu-id="7403e-249">Testen Sie die Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="7403e-249">Test out the page in a browser.</span></span> <span data-ttu-id="7403e-250">Nur die Produkte, die zur Kategorie Getränke gehören, werden angezeigt, obwohl *alle* Produktfelder angezeigt werden, da die gespeicherte Prozedur `GetProductsByCategory` alle Spalten aus der `Products` Tabelle zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="7403e-250">Only those products that belong to the Beverages category are displayed, although *all* of the product fields are displayed since the `GetProductsByCategory` stored procedure returns all of the columns from the `Products` table.</span></span> <span data-ttu-id="7403e-251">Wir könnten natürlich die Felder, die in der GridView angezeigt werden, im Dialogfeld "Spalten bearbeiten" in GridView einschränken oder anpassen.</span><span class="sxs-lookup"><span data-stu-id="7403e-251">We could, of course, limit or customize the fields displayed in the GridView from the GridView s Edit Columns dialog box.</span></span>

<span data-ttu-id="7403e-252">[![alle Getränke angezeigt werden](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-252">[![All of the Beverages are Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image12.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image23.png)</span></span>

<span data-ttu-id="7403e-253">**Abbildung 12**: alle Getränke werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-253">**Figure 12**: All of the Beverages are Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image24.png))</span></span>

## <a name="step-4-programmatically-invoking-a-sqldatasource-sselectstatement"></a><span data-ttu-id="7403e-254">Schritt 4: Programm gesteuertes Aufrufen einer SqlDataSource s`Select()`-Anweisung</span><span class="sxs-lookup"><span data-stu-id="7403e-254">Step 4: Programmatically Invoking a SqlDataSource s`Select()`Statement</span></span>

<span data-ttu-id="7403e-255">Die Beispiele, die wir im vorherigen Tutorial und in diesem Tutorial gesehen haben, haben die SqlDataSource-Steuerelemente direkt an eine GridView gebunden.</span><span class="sxs-lookup"><span data-stu-id="7403e-255">The examples we ve seen in the previous tutorial and this tutorial so far have bound SqlDataSource controls directly to a GridView.</span></span> <span data-ttu-id="7403e-256">Die Daten des SqlDataSource-Steuer Elements können jedoch Programm gesteuert aufgerufen und im Code aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-256">The SqlDataSource control s data, however, can be programmatically accessed and enumerated in code.</span></span> <span data-ttu-id="7403e-257">Dies kann besonders nützlich sein, wenn Sie Daten Abfragen müssen, um Sie zu überprüfen, aber Sie müssen Sie nicht anzeigen.</span><span class="sxs-lookup"><span data-stu-id="7403e-257">This can be particularly useful when you need to query data to inspect it, but don t need to display it.</span></span> <span data-ttu-id="7403e-258">Anstatt den gesamten Code Bausteine ADO.net zu schreiben, um eine Verbindung mit der Datenbank herzustellen, den Befehl anzugeben und die Ergebnisse abzurufen, kann die SqlDataSource diesen monoton Code verarbeiten lassen.</span><span class="sxs-lookup"><span data-stu-id="7403e-258">Rather than having to write all of the boilerplate ADO.NET code to connect to the database, specify the command, and retrieve the results, you can let the SqlDataSource handle this monotonous code.</span></span>

<span data-ttu-id="7403e-259">Um das programmgesteuerte arbeiten mit den SqlDataSource-Daten zu veranschaulichen, stellen Sie sich vor, dass Ihr Chef Sie mit einer Anforderung zum Erstellen einer Webseite kontaktiert hat, die den Namen einer zufällig ausgewählten Kategorie und der zugehörigen Produkte anzeigt.</span><span class="sxs-lookup"><span data-stu-id="7403e-259">To illustrate working with the SqlDataSource s data programmatically, imagine that your boss has approached you with a request to create a web page that displays the name of a randomly selected category and its associated products.</span></span> <span data-ttu-id="7403e-260">Das heißt, wenn ein Benutzer diese Seite besucht, möchten wir eine Kategorie aus der `Categories` Tabelle auswählen, den Kategorien Amen anzeigen und dann die Produkte auflisten, die zu dieser Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="7403e-260">That is, when a user visits this page, we want to randomly choose a category from the `Categories` table, display the category name, and then list the products belonging to that category.</span></span>

<span data-ttu-id="7403e-261">Um dies zu erreichen, benötigen wir zwei SqlDataSource-Steuerelemente, um eine Zufalls Kategorie aus der `Categories` Tabelle abzurufen, und eine weitere, um die Produkte der Kategorie zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="7403e-261">To accomplish this we need two SqlDataSource controls one to grab a random category from the `Categories` table and another to get the category s products.</span></span> <span data-ttu-id="7403e-262">Wir erstellen die SqlDataSource, die in diesem Schritt einen Datensatz für eine Zufalls Kategorie abruft. Schritt 5 befasst sich mit dem Erstellen der SqlDataSource, die die Produkte der Kategorie "s" abruft.</span><span class="sxs-lookup"><span data-stu-id="7403e-262">We'll build the SqlDataSource that retrieves a random category record in this step; Step 5 looks at crafting the SqlDataSource that retrieves the category s products.</span></span>

<span data-ttu-id="7403e-263">Fügen Sie zunächst ein SqlDataSource-`ParameterizedQueries.aspx` hinzu, und legen Sie dessen `ID` auf `RandomCategoryDataSource`fest.</span><span class="sxs-lookup"><span data-stu-id="7403e-263">Start by adding a SqlDataSource to `ParameterizedQueries.aspx` and set its `ID` to `RandomCategoryDataSource`.</span></span> <span data-ttu-id="7403e-264">Konfigurieren Sie Sie so, dass die folgende SQL-Abfrage verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="7403e-264">Configure it so that it uses the following SQL query:</span></span>

[!code-sql[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample10.sql)]

<span data-ttu-id="7403e-265">`ORDER BY NEWID()` gibt die in zufälliger Reihenfolge sortierten Datensätze zurück (siehe [Verwenden von `NEWID()` zum Zufalls Sortieren von Datensätzen](http://www.sqlteam.com/item.asp?ItemID=8747))</span><span class="sxs-lookup"><span data-stu-id="7403e-265">`ORDER BY NEWID()` returns the records sorted in random order (see [Using `NEWID()` to Randomly Sort Records](http://www.sqlteam.com/item.asp?ItemID=8747)).</span></span> <span data-ttu-id="7403e-266">`SELECT TOP 1` gibt den ersten Datensatz aus dem Resultset zurück.</span><span class="sxs-lookup"><span data-stu-id="7403e-266">`SELECT TOP 1` returns the first record from the result set.</span></span> <span data-ttu-id="7403e-267">Diese Abfrage gibt die `CategoryID`-und `CategoryName` Spaltenwerte aus einer einzelnen, zufällig ausgewählten Kategorie zurück.</span><span class="sxs-lookup"><span data-stu-id="7403e-267">Put together, this query returns the `CategoryID` and `CategoryName` column values from a single, randomly selected category.</span></span>

<span data-ttu-id="7403e-268">Um die Kategorie s `CategoryName` Wert anzuzeigen, fügen Sie der Seite ein Label-websteuer Element hinzu, legen Sie dessen `ID`-Eigenschaft auf `CategoryNameLabel`fest, und löschen Sie die `Text`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="7403e-268">To display the category s `CategoryName` value, add a Label Web control to the page, set its `ID` property to `CategoryNameLabel`, and clear out its `Text` property.</span></span> <span data-ttu-id="7403e-269">Zum programmgesteuerten Abrufen von Daten aus einem SqlDataSource-Steuerelement müssen wir dessen `Select()`-Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="7403e-269">To programmatically retrieve the data from a SqlDataSource control, we need to invoke its `Select()` method.</span></span> <span data-ttu-id="7403e-270">Die [`Select()`-Methode](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) erwartet einen einzelnen Eingabeparameter vom Typ " [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx)", der angibt, wie die Daten vor dem Zurückgeben der Daten übertragen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="7403e-270">The [`Select()` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.select.aspx) expects a single input parameter of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx), which specifies how the data should be messaged before being returned.</span></span> <span data-ttu-id="7403e-271">Dies kann Anweisungen zum Sortieren und Filtern der Daten beinhalten und wird von den datenweb Steuerelementen beim Sortieren oder Paging durch die Daten eines SqlDataSource-Steuer Elements verwendet.</span><span class="sxs-lookup"><span data-stu-id="7403e-271">This can include instructions on sorting and filtering the data, and is used by the data Web controls when sorting or paging through the data from a SqlDataSource control.</span></span> <span data-ttu-id="7403e-272">In unserem Beispiel benötigen wir jedoch keine Daten, die geändert werden müssen, bevor Sie zurückgegeben werden. Daher wird das `DataSourceSelectArguments.Empty` Objekt übergeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-272">For our example, though, we don t need the data to be modified before being returned, and therefore will pass in the `DataSourceSelectArguments.Empty` object.</span></span>

<span data-ttu-id="7403e-273">Die `Select()`-Methode gibt ein Objekt zurück, das `IEnumerable`implementiert.</span><span class="sxs-lookup"><span data-stu-id="7403e-273">The `Select()` method returns an object that implements `IEnumerable`.</span></span> <span data-ttu-id="7403e-274">Der genaue Typ, der zurückgegeben wird, hängt vom Wert der [`DataSourceMode`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx)des SqlDataSource-Steuer Elements ab.</span><span class="sxs-lookup"><span data-stu-id="7403e-274">The precise type returned depends on the value of the SqlDataSource control s [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx).</span></span> <span data-ttu-id="7403e-275">Wie bereits im vorherigen Tutorial erläutert, kann diese Eigenschaft auf einen Wert von `DataSet` oder `DataReader`festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-275">As discussed in the previous tutorial, this property can be set to a value of either `DataSet` or `DataReader`.</span></span> <span data-ttu-id="7403e-276">Wenn `DataSet`festgelegt ist, gibt die `Select()`-Methode ein [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) -Objekt zurück. Wenn `DataReader`festgelegt ist, wird ein Objekt zurückgegeben, das [`IDataReader`](https://msdn.microsoft.com/library/system.data.idatareader.aspx)implementiert.</span><span class="sxs-lookup"><span data-stu-id="7403e-276">If set to `DataSet`, the `Select()` method returns a [DataView](https://msdn.microsoft.com/library/01s96x0z.aspx) object; if set to `DataReader`, it returns an object that implements [`IDataReader`](https://msdn.microsoft.com/library/system.data.idatareader.aspx).</span></span> <span data-ttu-id="7403e-277">Da für den `RandomCategoryDataSource` SqlDataSource die Eigenschaft `DataSourceMode` auf `DataSet` (Standard) festgelegt ist, werden wir mit einem DataView-Objekt arbeiten.</span><span class="sxs-lookup"><span data-stu-id="7403e-277">Since the `RandomCategoryDataSource` SqlDataSource has its `DataSourceMode` property set to `DataSet` (the default), we will be working with a DataView object.</span></span>

<span data-ttu-id="7403e-278">Der folgende Code veranschaulicht, wie Sie die Datensätze aus der `RandomCategoryDataSource` SqlDataSource als DataView abrufen und den Wert der `CategoryName` Spalte aus der ersten DataView-Zeile lesen können:</span><span class="sxs-lookup"><span data-stu-id="7403e-278">The following code illustrates how to retrieve the records from the `RandomCategoryDataSource` SqlDataSource as a DataView as well as how to read the `CategoryName` column value from the first DataView row:</span></span>

[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample11.cs)]

<span data-ttu-id="7403e-279">`randomCategoryView[0]` gibt den ersten `DataRowView` in der DataView zurück.</span><span class="sxs-lookup"><span data-stu-id="7403e-279">`randomCategoryView[0]` returns the first `DataRowView` in the DataView.</span></span> <span data-ttu-id="7403e-280">`randomCategoryView[0]["CategoryName"]` gibt den Wert der `CategoryName` Spalte in dieser ersten Zeile zurück.</span><span class="sxs-lookup"><span data-stu-id="7403e-280">`randomCategoryView[0]["CategoryName"]` returns the value of the `CategoryName` column in this first row.</span></span> <span data-ttu-id="7403e-281">Beachten Sie, dass DataView lose typisiert ist.</span><span class="sxs-lookup"><span data-stu-id="7403e-281">Note that the DataView is loosely-typed.</span></span> <span data-ttu-id="7403e-282">Um auf einen bestimmten Spaltenwert zu verweisen, müssen wir den Namen der Spalte als Zeichenfolge (in diesem Fall CategoryName) übergeben.</span><span class="sxs-lookup"><span data-stu-id="7403e-282">To reference a particular column value we need to pass in the name of the column as a string ( CategoryName, in this case).</span></span> <span data-ttu-id="7403e-283">Abbildung 13 zeigt die Meldung, die beim Anzeigen der Seite in der `CategoryNameLabel` angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-283">Figure 13 shows the message displayed in the `CategoryNameLabel` when viewing the page.</span></span> <span data-ttu-id="7403e-284">Natürlich wird der tatsächliche Kategoriename nach dem Zufallsprinzip von der `RandomCategoryDataSource` SqlDataSource bei jedem Besuch der Seite (einschließlich Postbacks) ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="7403e-284">Of course, the actual category name displayed is randomly selected by the `RandomCategoryDataSource` SqlDataSource on each visit to the page (including postbacks).</span></span>

<span data-ttu-id="7403e-285">[![der zufällig ausgewählte Name der Kategorie s angezeigt wird.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-285">[![The Randomly Selected Category s Name is Displayed](using-parameterized-queries-with-the-sqldatasource-cs/_static/image13.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image25.png)</span></span>

<span data-ttu-id="7403e-286">**Abbildung 13**: der zufällig ausgewählte Name der Kategorie s wird angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-286">**Figure 13**: The Randomly Selected Category s Name is Displayed ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image26.png))</span></span>

> [!NOTE]
> <span data-ttu-id="7403e-287">Wenn die `DataSourceMode`-Eigenschaft des SqlDataSource-Steuer Elements auf `DataReader`festgelegt wurde, musste der Rückgabewert der `Select()`-Methode in `IDataReader`umgewandelt werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-287">If the SqlDataSource control s `DataSourceMode` property had been set to `DataReader`, the return value from the `Select()` method would have needed to be cast to `IDataReader`.</span></span> <span data-ttu-id="7403e-288">Um den `CategoryName` Spaltenwert aus der ersten Zeile zu lesen, verwenden wir Code wie den folgenden:</span><span class="sxs-lookup"><span data-stu-id="7403e-288">To read the `CategoryName` column value from the first row, we d use code like:</span></span>

[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample12.cs)]

<span data-ttu-id="7403e-289">Nachdem Sie SqlDataSource nach dem Zufallsprinzip eine Kategorie ausgewählt haben, können Sie das GridView-Elemente hinzufügen, das die Produkte der Kategorie auflistet.</span><span class="sxs-lookup"><span data-stu-id="7403e-289">With the SqlDataSource randomly selecting a category, we re ready to add the GridView that lists the category s products.</span></span>

> [!NOTE]
> <span data-ttu-id="7403e-290">Anstatt ein Label-websteuer Element zum Anzeigen des Namens der Kategorie zu verwenden, könnten wir der Seite eine FormView oder DetailsView hinzufügen, um Sie an SqlDataSource zu binden.</span><span class="sxs-lookup"><span data-stu-id="7403e-290">Rather than using a Label Web control to display the category s name, we could have added a FormView or DetailsView to the page, binding it to the SqlDataSource.</span></span> <span data-ttu-id="7403e-291">Mithilfe der Bezeichnung konnten wir jedoch untersuchen, wie Sie die SqlDataSource s-`Select()`-Anweisung Programm gesteuert aufrufen und mit den resultierenden Daten im Code arbeiten können.</span><span class="sxs-lookup"><span data-stu-id="7403e-291">Using the Label, however, allowed us to explore how to programmatically invoke the SqlDataSource s `Select()` statement and work with its resulting data in code.</span></span>

## <a name="step-5-assigning-parameter-values-programmatically"></a><span data-ttu-id="7403e-292">Schritt 5: Programm gesteuertes Zuweisen von Parameter Werten</span><span class="sxs-lookup"><span data-stu-id="7403e-292">Step 5: Assigning Parameter Values Programmatically</span></span>

<span data-ttu-id="7403e-293">Alle bisher in diesem Tutorial genannten Beispiele haben entweder einen hart codierten Parameterwert oder einen, der aus einer der vordefinierten Parameter Quellen entnommen wurde (ein QueryString-Wert, ein websteuer Element auf der Seite usw.) verwendet.</span><span class="sxs-lookup"><span data-stu-id="7403e-293">All of the examples we ve seen so far in this tutorial have used either a hard-coded parameter value or one taken from one of the pre-defined parameter sources (a querystring value, a Web control on the page, and so on).</span></span> <span data-ttu-id="7403e-294">Die Parameter des SqlDataSource-Steuer Elements können jedoch auch Programm gesteuert festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="7403e-294">However, the SqlDataSource control s parameters can also be set programmatically.</span></span> <span data-ttu-id="7403e-295">Um das aktuelle Beispiel abzuschließen, benötigen wir eine SqlDataSource, die alle Produkte zurückgibt, die zu einer bestimmten Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="7403e-295">To complete our current example, we need a SqlDataSource that returns all of the products belonging to a specified category.</span></span> <span data-ttu-id="7403e-296">Diese SqlDataSource verfügt über einen `CategoryID` Parameter, dessen Wert auf der Grundlage des `CategoryID` Spaltenwerts festgelegt werden muss, der von der `RandomCategoryDataSource` SqlDataSource im `Page_Load` Ereignishandler zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-296">This SqlDataSource will have a `CategoryID` parameter whose value needs to be set based on the `CategoryID` column value returned by the `RandomCategoryDataSource` SqlDataSource in the `Page_Load` event handler.</span></span>

<span data-ttu-id="7403e-297">Fügen Sie zunächst der Seite eine GridView hinzu, und binden Sie Sie an eine neue SqlDataSource mit dem Namen `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7403e-297">Start by adding a GridView to the page and bind it to a new SqlDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="7403e-298">Ähnlich wie in Schritt 3, konfigurieren Sie die SqlDataSource so, dass Sie die gespeicherte Prozedur `GetProductsByCategory` aufruft.</span><span class="sxs-lookup"><span data-stu-id="7403e-298">Much like we did in Step 3, configure the SqlDataSource so that it invokes the `GetProductsByCategory` stored procedure.</span></span> <span data-ttu-id="7403e-299">Lassen Sie die Dropdown Liste Parameter Quelle auf keine festgelegt, aber geben Sie keinen Standardwert ein, da dieser Standardwert Programm gesteuert festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="7403e-299">Leave the Parameter source drop-down list set to None, but do not enter a default value, as we will set this default value programmatically.</span></span>

<span data-ttu-id="7403e-300">[![keine Parameter Quelle oder keinen Standardwert angeben.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-300">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image14.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image27.png)</span></span>

<span data-ttu-id="7403e-301">**Abbildung 14**: keine Parameter Quelle oder keinen Standardwert angeben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-301">**Figure 14**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image28.png))</span></span>

<span data-ttu-id="7403e-302">Nachdem der SqlDataSource-Assistent abgeschlossen wurde, sollte das resultierende deklarative Markup in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="7403e-302">After completing the SqlDataSource wizard, the resulting declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample13.aspx)]

<span data-ttu-id="7403e-303">Wir können die `DefaultValue` des Parameters "`CategoryID`" Programm gesteuert im `Page_Load`-Ereignishandler zuweisen:</span><span class="sxs-lookup"><span data-stu-id="7403e-303">We can assign the `DefaultValue` of the `CategoryID` parameter programmatically in the `Page_Load` event handler:</span></span>

[!code-csharp[Main](using-parameterized-queries-with-the-sqldatasource-cs/samples/sample14.cs)]

<span data-ttu-id="7403e-304">Mit dieser Addition enthält die Seite eine GridView, in der die Produkte angezeigt werden, die der zufällig ausgewählten Kategorie zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="7403e-304">With this addition, the page includes a GridView that shows the products associated with the randomly selected category.</span></span>

<span data-ttu-id="7403e-305">[![keine Parameter Quelle oder keinen Standardwert angeben.](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="7403e-305">[![Do Not Specify a Parameter Source or Default Value](using-parameterized-queries-with-the-sqldatasource-cs/_static/image15.gif)](using-parameterized-queries-with-the-sqldatasource-cs/_static/image29.png)</span></span>

<span data-ttu-id="7403e-306">**Abbildung 15**: keine Parameter Quelle oder keinen Standardwert angeben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-parameterized-queries-with-the-sqldatasource-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="7403e-306">**Figure 15**: Do Not Specify a Parameter Source or Default Value ([Click to view full-size image](using-parameterized-queries-with-the-sqldatasource-cs/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="7403e-307">Summary</span><span class="sxs-lookup"><span data-stu-id="7403e-307">Summary</span></span>

<span data-ttu-id="7403e-308">Die SqlDataSource ermöglicht Seiten Entwicklern, parametrisierte Abfragen zu definieren, deren Parameterwerte hart codiert, aus vordefinierten Parameter Quellen abgerufen oder Programm gesteuert zugewiesen werden können.</span><span class="sxs-lookup"><span data-stu-id="7403e-308">The SqlDataSource enables page developers to define parameterized queries whose parameter values can be hard-coded, pulled from pre-defined parameter sources, or assigned programmatically.</span></span> <span data-ttu-id="7403e-309">In diesem Tutorial wurde erläutert, wie Sie eine parametrisierte Abfrage aus dem Assistenten zum Konfigurieren von Datenquellen für Ad-hoc-SQL-Abfragen und gespeicherte Prozeduren erstellen.</span><span class="sxs-lookup"><span data-stu-id="7403e-309">In this tutorial we saw how to craft a parameterized query from the Configure Data Source wizard for both ad-hoc SQL queries and stored procedures.</span></span> <span data-ttu-id="7403e-310">Außerdem haben wir uns mit der Verwendung von hart codierten Parameter Quellen, einem websteuer Element als Parameter Quelle und der programmgesteuerten Angabe des Parameter Werts beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="7403e-310">We also looked at using hard-coded parameter sources, a Web control as a parameter source, and programmatically specifying the parameter value.</span></span>

<span data-ttu-id="7403e-311">Wie bei ObjectDataSource bietet auch SqlDataSource Funktionen zum Ändern der zugrunde liegenden Daten.</span><span class="sxs-lookup"><span data-stu-id="7403e-311">Like with the ObjectDataSource, the SqlDataSource also provides capabilities to modify its underlying data.</span></span> <span data-ttu-id="7403e-312">Im nächsten Tutorial wird erläutert, wie Sie `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen mit SqlDataSource definieren.</span><span class="sxs-lookup"><span data-stu-id="7403e-312">In the next tutorial we'll look at how to define `INSERT`, `UPDATE`, and `DELETE` statements with the SqlDataSource.</span></span> <span data-ttu-id="7403e-313">Nachdem diese Anweisungen hinzugefügt wurden, können wir die integrierten Funktionen zum Einfügen, bearbeiten und Löschen verwenden, die den Steuerelementen GridView, DetailsView und FormView zugrunde liegen.</span><span class="sxs-lookup"><span data-stu-id="7403e-313">Once these statements have been added, we can utilize the built-in inserting, editing, and deleting features inherent to the GridView, DetailsView, and FormView controls.</span></span>

<span data-ttu-id="7403e-314">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="7403e-314">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7403e-315">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="7403e-315">About the Author</span></span>

<span data-ttu-id="7403e-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="7403e-316">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7403e-317">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="7403e-317">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7403e-318">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7403e-318">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7403e-319">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7403e-319">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7403e-320">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7403e-320">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7403e-321">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="7403e-321">Special Thanks To</span></span>

<span data-ttu-id="7403e-322">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="7403e-322">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7403e-323">Die führenden Reviewer für dieses Tutorial waren Scott Clyde, Randell Schmidt und Ken pespisa.</span><span class="sxs-lookup"><span data-stu-id="7403e-323">Lead reviewers for this tutorial were Scott Clyde, Randell Schmidt, and Ken Pespisa.</span></span> <span data-ttu-id="7403e-324">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="7403e-324">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7403e-325">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7403e-325">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7403e-326">[Zurück](querying-data-with-the-sqldatasource-control-cs.md)
> [Weiter](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md)</span><span class="sxs-lookup"><span data-stu-id="7403e-326">[Previous](querying-data-with-the-sqldatasource-control-cs.md)
[Next](inserting-updating-and-deleting-data-with-the-sqldatasource-cs.md)</span></span>
