---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
title: Hinzufügen von zusätzlichen DataTable-Spalten (c#) | Microsoft-Dokumentation
author: rick-anderson
description: Wenn Sie den TableAdapter-Assistenten zum Erstellen eines typisierten Datasets verwenden, enthält die entsprechende DataTable Spalten, die von der Abfrage für die Hauptdatenbank zurückgegeben. Aber es...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 615f3361-f21f-4338-8bc1-fce8ae071de9
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: 1e1751c6969f1a278ee438c3bee6171644aacdbf
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/09/2019
ms.locfileid: "59406183"
---
# <a name="adding-additional-datatable-columns-c"></a><span data-ttu-id="e2e29-104">Hinzufügen von zusätzlichen DataTable-Spalten (C#)</span><span class="sxs-lookup"><span data-stu-id="e2e29-104">Adding Additional DataTable Columns (C#)</span></span>

<span data-ttu-id="e2e29-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e2e29-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e2e29-106">[Code herunterladen](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) oder [PDF-Datei herunterladen](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e2e29-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_CS.zip) or [Download PDF](adding-additional-datatable-columns-cs/_static/datatutorial70cs1.pdf)</span></span>

> <span data-ttu-id="e2e29-107">Wenn Sie den TableAdapter-Assistenten zum Erstellen eines typisierten Datasets verwenden, enthält die entsprechende DataTable Spalten, die von der Abfrage für die Hauptdatenbank zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="e2e29-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="e2e29-108">Aber es gibt Situationen, in denen Wenn DataTable zusätzliche Spalten enthalten muss.</span><span class="sxs-lookup"><span data-stu-id="e2e29-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="e2e29-109">In diesem Tutorial wird erläutert, warum die gespeicherte Prozeduren empfohlen werden, wenn wir die zusätzliche DataTable-Spalten benötigen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="e2e29-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="e2e29-110">Introduction</span></span>

<span data-ttu-id="e2e29-111">Wenn Sie einen TableAdapter mit einem typisierten DataSet hinzufügen, wird das entsprechende DataTable-s-Schema durch die Hauptabfrage des TableAdapter s bestimmt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="e2e29-112">Wenn die Hauptabfrage Datenfelder gibt z. B. *ein*, *B*, und *C*, DataTable müssen drei entsprechende Spalten, die mit dem Namen *ein*, *B*, und *C*. Zusätzlich zu der Hauptabfrage kann ein TableAdapter zusätzliche Abfragen enthalten, die möglicherweise eine Teilmenge der Daten basierend auf einige Parameter zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e2e29-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="e2e29-113">Z. B. zusätzlich zu den `ProductsTableAdapter` s Hauptabfrage, die Informationen über alle Produkte zurückgibt, sie enthält außerdem Methoden wie `GetProductsByCategoryID(categoryID)` und `GetProductByProductID(productID)`, die bestimmte Produktinformationen auf Grundlage eines angegebenen Parameters zurück.</span><span class="sxs-lookup"><span data-stu-id="e2e29-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="e2e29-114">Das Modell der Dank der DataTable-s-Schema die Hauptabfrage des TableAdapter s entsprechend funktioniert gut, wenn alle den TableAdapter-s-Methoden die gleiche oder weniger Datenfelder als die in der Hauptabfrage zurück.</span><span class="sxs-lookup"><span data-stu-id="e2e29-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="e2e29-115">Wenn eine Methode des TableAdapter zusätzliche Datenfelder zurückgeben muss, sollten wir entsprechend das DataTable-s-Schema erweitern.</span><span class="sxs-lookup"><span data-stu-id="e2e29-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="e2e29-116">In der [Master/Detail, verwenden eine Liste mit Aufzählungszeichen Liste der Masterdatensätze mit einem DataList-Steuerelement Details](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) Tutorial, die wir hinzugefügt, dass eine Methode, um der `CategoriesTableAdapter` zurückgegebenen der `CategoryID`, `CategoryName`, und `Description` Datenfelder, die in definierten der Hauptabfrage plus `NumberOfProducts`, ein Feld zusätzliche Daten, die die Anzahl der Produkte verknüpft ist, wobei jede Kategorie gemeldet.</span><span class="sxs-lookup"><span data-stu-id="e2e29-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="e2e29-117">Wir manuell eine neue Spalte hinzugefügt der `CategoriesDataTable` zum Erfassen der `NumberOfProducts` Datenfeldwert von dieser neuen Methode.</span><span class="sxs-lookup"><span data-stu-id="e2e29-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="e2e29-118">Siehe die [Hochladen von Dateien](../working-with-binary-files/uploading-files-cs.md) Lernprogramm, große Vorsicht mit TableAdapters, die mithilfe von Ad-hoc-SQL-Anweisungen und verfügen über Methoden, deren Datenfelder nicht genau die Hauptabfrage entsprechen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-cs.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="e2e29-119">Wenn der TableAdapter-Konfigurations-Assistent erneut ausgeführt wird, aktualisiert es alle Methoden s TableAdapter, damit ihre Daten Feldliste aus die Hauptabfrage übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="e2e29-120">Daher werden keine Methoden mit benutzerdefinierten Spaltenlisten Wiederherstellen der Hauptabfrage s Spaltenliste und nicht die erwarteten Daten zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e2e29-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="e2e29-121">Dieses Problem nicht beim Verwenden gespeicherter Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="e2e29-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="e2e29-122">In diesem Tutorial werden wir ein DataTable-s-Schema um zusätzliche Spalten aufzunehmen erweitern betrachten.</span><span class="sxs-lookup"><span data-stu-id="e2e29-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="e2e29-123">Aufgrund der Fehleranfälligkeit des TableAdapter bei Verwendung von Ad-hoc-SQL-Anweisungen in diesem Tutorial werden wir gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="e2e29-124">Finden Sie in der [Erstellen neuer gespeicherter Prozeduren für die typisierte DataSet-s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) und [vorhandene gespeicherte Prozeduren verwenden, für die typisierte DataSet-s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) Lernprogramme für Weitere Informationen zu Konfigurieren einen TableAdapter um gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](https://data-access/tutorials/using-existing-stored-procedures-for-the-typed-dataset-amp-rsquo-s-tableadapters-cs) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="e2e29-125">Schritt 1: Hinzufügen einer`PriceQuartile`Spalte in der`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="e2e29-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="e2e29-126">In der *Erstellen neuer gespeicherter Prozeduren für die typisierte DataSet-s TableAdapters* Tutorial, die wir erstellt, eine typisierte DataSet mit dem Namen haben `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="e2e29-127">Dieses DataSet enthält derzeit zwei DataTables: `ProductsDataTable` und `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="e2e29-128">Die `ProductsTableAdapter` weist die folgenden drei Methoden:</span><span class="sxs-lookup"><span data-stu-id="e2e29-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- `GetProducts` <span data-ttu-id="e2e29-129">-die Hauptabfrage, wodurch alle Datensätze aus der `Products` Tabelle</span><span class="sxs-lookup"><span data-stu-id="e2e29-129">- the main query, which returns all records from the `Products` table</span></span>
- `GetProductsByCategoryID(categoryID)` <span data-ttu-id="e2e29-130">-Gibt alle Produkte mit dem angegebenen *CategoryID*.</span><span class="sxs-lookup"><span data-stu-id="e2e29-130">- returns all products with the specified *categoryID*.</span></span>
- `GetProductByProductID(productID)` <span data-ttu-id="e2e29-131">-Gibt das bestimmte Produkt mit dem angegebenen *"ProductID"*.</span><span class="sxs-lookup"><span data-stu-id="e2e29-131">- returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="e2e29-132">Der Hauptabfrage und die zwei zusätzlichen Methoden zurückgeben den gleichen Satz von Datenfeldern, d. h. alle Spalten aus der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="e2e29-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="e2e29-133">Es gibt keine korrelierten Unterabfragen oder `JOIN` s abrufen von verknüpften Daten aus der `Categories` oder `Suppliers` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="e2e29-134">Aus diesem Grund die `ProductsDataTable` verfügt über eine entsprechende Spalte für jedes Feld in der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="e2e29-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="e2e29-135">In diesem Tutorial können s eine Methode zum Hinzufügen der `ProductsTableAdapter` mit dem Namen `GetProductsWithPriceQuartile` , die alle Produkte zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="e2e29-136">Zusätzlich zu den standard-Product-Daten-Feldern `GetProductsWithPriceQuartile` umfasst auch eine `PriceQuartile` Feld "Daten", der angibt, welche Quartil der Produktpreis s zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="e2e29-137">Diese Produkte, deren Preise in dem die teuersten 25 werden % müssen z. B. eine `PriceQuartile` Wert von 1, sind diejenigen, deren Preise in der unteren 25 werden % den Wert 4.</span><span class="sxs-lookup"><span data-stu-id="e2e29-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="e2e29-138">Bevor wir das Erstellen der gespeicherten Prozedur zum Zurückgeben dieser Informationen kümmern, allerdings müssen wir zuerst zum Aktualisieren der `ProductsDataTable` auf eine Spalte zum Speichern enthalten die `PriceQuartile` Ergebnisse bei der `GetProductsWithPriceQuartile` Methode wird verwendet.</span><span class="sxs-lookup"><span data-stu-id="e2e29-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="e2e29-139">Öffnen der `NorthwindWithSprocs` DataSet mit der rechten Maustaste auf die `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="e2e29-140">Wählen Sie aus dem Kontextmenü hinzufügen, und wählen Sie dann die Spalte.</span><span class="sxs-lookup"><span data-stu-id="e2e29-140">Choose Add from the context-menu and then pick Column.</span></span>


[![A<span data-ttu-id="e2e29-141">Dd eine neue Spalte für die ProductsDataTable]</span><span class="sxs-lookup"><span data-stu-id="e2e29-141">dd a New Column to the ProductsDataTable]</span></span>(adding-additional-datatable-columns-cs/_static/image2.png)](adding-additional-datatable-columns-cs/_static/image1.png)

<span data-ttu-id="e2e29-142">**Abbildung 1**: Hinzufügen einer neuen Spalte, die `ProductsDataTable` ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image3.png))</span></span>


<span data-ttu-id="e2e29-143">Dadurch wird eine neue Spalte hinzugefügt, zu der mit dem Namen Column1 vom Typ "DataTable" `System.String`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="e2e29-144">Wir müssen dieser Spaltenname s PriceQuartile und dessen Typ zu aktualisieren `System.Int32` , da er verwendet wird, die eine Zahl zwischen 1 und 4 enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="e2e29-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="e2e29-145">Wählen Sie die neu hinzugefügte Spalte in der `ProductsDataTable` , und legen Sie im Eigenschaftenfenster die `Name` PriceQuartile Eigenschaft und die `DataType` Eigenschaft `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


[![S<span data-ttu-id="e2e29-146">u. a. der Name der neuen Spalte s und die Datentypeigenschaften für die]</span><span class="sxs-lookup"><span data-stu-id="e2e29-146">et the New Column s Name and DataType Properties]</span></span>(adding-additional-datatable-columns-cs/_static/image5.png)](adding-additional-datatable-columns-cs/_static/image4.png)

<span data-ttu-id="e2e29-147">**Abbildung 2**: Legen Sie die neue Spalte s `Name` und `DataType` Eigenschaften ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image6.png))</span></span>


<span data-ttu-id="e2e29-148">Wie in Abbildung 2 gezeigt, gibt es zusätzliche Eigenschaften, die festgelegt werden können, z. B. gibt an, ob die Werte in der Spalte eindeutig sein müssen, wenn die Spalte eine Spalte automatisch inkrementiert wird, ob Datenbank `NULL` Werte sind zulässig und so weiter.</span><span class="sxs-lookup"><span data-stu-id="e2e29-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="e2e29-149">Lassen Sie diese Werte, die auf ihre Standardwerte festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="e2e29-150">Schritt 2: Erstellen der`GetProductsWithPriceQuartile`Methode</span><span class="sxs-lookup"><span data-stu-id="e2e29-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="e2e29-151">Nun, dass die `ProductsDataTable` wurde aktualisiert und enthalten die `PriceQuartile` Spalte sind wir bereit, erstellen die `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="e2e29-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="e2e29-152">Zunächst mit der rechten Maustaste auf den TableAdapter und Abfrage hinzufügen im Kontextmenü auswählen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="e2e29-153">Dadurch wird der TableAdapter-Abfrage-Konfigurations-Assistenten, in der werden uns zuerst gefragt, ob Ad-hoc-SQL-Anweisungen oder einer neuen oder vorhandenen gespeicherten Prozedur verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="e2e29-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="e2e29-154">Da wir Einbau t zusätzlichen noch einer gespeicherten Prozedur, der Preis Quartil Daten zurückgibt, können Sie die s den TableAdapter zum Erstellen von dieser gespeicherten Prozedur für uns zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="e2e29-155">Wählen Sie die Option neue gespeicherte Prozedur erstellen, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="e2e29-155">Select the Create new stored procedure option and click Next.</span></span>


[![I<span data-ttu-id="e2e29-156">NStruct ist die TableAdapter-Assistenten, um die gespeicherte Prozedur für uns erstellen]</span><span class="sxs-lookup"><span data-stu-id="e2e29-156">nstruct the TableAdapter Wizard to Create the Stored Procedure For Us]</span></span>(adding-additional-datatable-columns-cs/_static/image8.png)](adding-additional-datatable-columns-cs/_static/image7.png)

<span data-ttu-id="e2e29-157">**Abbildung 3**: Weisen Sie den TableAdapter-Assistenten, um die gespeicherte Prozedur für uns erstellen ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image9.png))</span></span>


<span data-ttu-id="e2e29-158">Im folgenden Bildschirm dargestellt in Abbildung 4 des Assistenten werden wir gefragt, welche Art von Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="e2e29-159">Da die `GetProductsWithPriceQuartile` Methode gibt alle Spalten und Datensätzen aus der `Products` Tabelle, wählen Sie die Auswahl, welche die gibt Zeilen aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="e2e29-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


[![O<span data-ttu-id="e2e29-160">die Abfrage wird eine SELECT-Anweisung, gibt mehrere Zeilen werden]</span><span class="sxs-lookup"><span data-stu-id="e2e29-160">ur Query will be a SELECT Statement that Returns Multiple Rows]</span></span>(adding-additional-datatable-columns-cs/_static/image11.png)](adding-additional-datatable-columns-cs/_static/image10.png)

<span data-ttu-id="e2e29-161">**Abbildung 4**: Die Abfrage werden eine `SELECT` Anweisung, gibt mehrere Zeilen ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image12.png))</span></span>


<span data-ttu-id="e2e29-162">Als Nächstes werden wir dazu aufgefordert, für die `SELECT` Abfrage.</span><span class="sxs-lookup"><span data-stu-id="e2e29-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="e2e29-163">Geben Sie die folgende Abfrage in den Assistenten aus:</span><span class="sxs-lookup"><span data-stu-id="e2e29-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-cs/samples/sample1.sql)]

<span data-ttu-id="e2e29-164">Die obige Abfrage verwendet SQL Server 2005-s neue [ `NTILE` Funktion](https://msdn.microsoft.com/library/ms175126.aspx) auf die Ergebnisse in vier Gruppen zu unterteilen, die Gruppen, in denen hängen von, der `UnitPrice` Werte in absteigender Reihenfolge sortiert.</span><span class="sxs-lookup"><span data-stu-id="e2e29-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="e2e29-165">Leider den Abfrage-Generator ist nicht bekannt, wie beim Analysieren der `OVER` Schlüsselwort und wird eine Fehlermeldung angezeigt, wenn die obige Abfrage zu analysieren.</span><span class="sxs-lookup"><span data-stu-id="e2e29-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="e2e29-166">Aus diesem Grund geben Sie die obige Abfrage direkt in das Textfeld des Assistenten ohne Verwendung des Abfrage-Generators ein.</span><span class="sxs-lookup"><span data-stu-id="e2e29-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="e2e29-167">Weitere Informationen zu NTILE und SQL Server 2005-s anderen Rangfolgefunktionen zur finden Sie unter [aufgelisteten Ergebnisse zurückgeben, mit Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) und [Rangfolgefunktionen Abschnitt](https://msdn.microsoft.com/library/ms189798.aspx) aus der [SQL Server 2005-Onlinedokumentation](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="e2e29-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>


<span data-ttu-id="e2e29-168">Nach dem Eingeben der `SELECT` Abfrage ein, und klicken Sie auf Weiter, fragt der Assistent auf der einen Namen für die gespeicherte Prozedur angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e2e29-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="e2e29-169">Benennen Sie die neue gespeicherte Prozedur `Products_SelectWithPriceQuartile` , und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="e2e29-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


[![N<span data-ttu-id="e2e29-170">Ame der gespeicherten Prozedur Products_SelectWithPriceQuartile]</span><span class="sxs-lookup"><span data-stu-id="e2e29-170">ame the Stored Procedure Products_SelectWithPriceQuartile]</span></span>(adding-additional-datatable-columns-cs/_static/image14.png)](adding-additional-datatable-columns-cs/_static/image13.png)

<span data-ttu-id="e2e29-171">**Abbildung 5**: Benennen Sie die gespeicherte Prozedur `Products_SelectWithPriceQuartile` ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image15.png))</span></span>


<span data-ttu-id="e2e29-172">Schließlich sind wir aufgefordert, benennen Sie die TableAdapter-Methoden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="e2e29-173">Lassen Sie beide der Füllung eine "DataTable" und einem DataTable-Kontrollkästchen aktiviert und die Namen die Methoden zurückzugeben `FillWithPriceQuartile` und `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


[![N<span data-ttu-id="e2e29-174">Ame die TableAdapter-Methoden ein, und klicken Sie auf Fertig stellen]</span><span class="sxs-lookup"><span data-stu-id="e2e29-174">ame the TableAdapter s Methods and Click Finish]</span></span>(adding-additional-datatable-columns-cs/_static/image17.png)](adding-additional-datatable-columns-cs/_static/image16.png)

<span data-ttu-id="e2e29-175">**Abbildung 6**: Benennen Sie das s-Methoden des TableAdapter, und klicken Sie auf Fertig stellen ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image18.png))</span></span>


<span data-ttu-id="e2e29-176">Mit der `SELECT` Abfrage angegeben, und die gespeicherte Prozedur und TableAdapter-Methoden, die mit dem Namen, klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="e2e29-177">An diesem Punkt erhalten Sie möglicherweise eine Warnung oder zwei über den Assistenten, dass die `OVER` SQL-Konstrukt oder die Anweisung wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="e2e29-178">Diese Warnungen können ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-178">These warnings can be ignored.</span></span>

<span data-ttu-id="e2e29-179">Nach Abschluss des Assistenten sollte der TableAdapter enthalten die `FillWithPriceQuartile` und `GetProductsWithPriceQuartile` Methoden und die Datenbank eine gespeicherte Prozedur namens aufzunehmen `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="e2e29-180">Nehmen Sie einen Moment Zeit, um zu überprüfen, dass der TableAdapter tatsächlich diese neue Methode enthält, die gespeicherte Prozedur auf die Datenbank ordnungsgemäß hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="e2e29-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="e2e29-181">Wenn die Datenbank wird überprüft, ob die gespeicherte Prozedur versuchen Sie es mit der rechten Maustaste auf den Ordner "gespeicherte Prozeduren" und "Aktualisieren" nicht angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="e2e29-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![Stellen Sie sicher, dass eine neue Methode des TableAdapter hinzugefügt wurde](adding-additional-datatable-columns-cs/_static/image19.png)

<span data-ttu-id="e2e29-183">**Abbildung 7**: Stellen Sie sicher, dass eine neue Methode des TableAdapter hinzugefügt wurde</span><span class="sxs-lookup"><span data-stu-id="e2e29-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


[![E<span data-ttu-id="e2e29-184">darüber, dass die Datenbank die Products_SelectWithPriceQuartile gespeicherte Prozedur enthält.]</span><span class="sxs-lookup"><span data-stu-id="e2e29-184">nsure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure]</span></span>(adding-additional-datatable-columns-cs/_static/image21.png)](adding-additional-datatable-columns-cs/_static/image20.png)

<span data-ttu-id="e2e29-185">**Abbildung 8**: Sicherstellen, dass die Datenbank enthält die `Products_SelectWithPriceQuartile` Stored Procedure ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="e2e29-186">Einer der Vorteile der Verwendung gespeicherter Prozeduren anstelle von Ad-hoc-SQL-Anweisungen ist, dass es sich bei den TableAdapter-Konfigurations-Assistenten erneut ausführen der gespeicherten Prozeduren Spaltenlisten nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="e2e29-187">Überprüfen Sie dies können Sie, indem Sie mit der rechten Maustaste auf den TableAdapter, mit der Option konfigurieren aus dem Kontextmenü, um den Assistenten starten, und klicken Sie dann auf "Fertig stellen", um es abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="e2e29-188">Navigieren Sie anschließend auf die Datenbank und die Ansicht der `Products_SelectWithPriceQuartile` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="e2e29-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="e2e29-189">Beachten Sie, dass die Liste der Spalten nicht geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="e2e29-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="e2e29-190">Hatten wir genutzt haben-Ad-hoc-SQL-Anweisungen den TableAdapter-Konfigurations-Assistenten erneut ausführen würden wurden rückgängig diese Abfrage s Spaltenliste der Hauptabfrage Spaltenliste entfernen und die NTILE-Anweisung aus der Abfrage ein, die entsprechend der `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="e2e29-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="e2e29-191">Bei der Datenzugriffsebene s `GetProductsWithPriceQuartile` Methode aufgerufen wird, führt des TableAdapters die `Products_SelectWithPriceQuartile` von gespeicherten Prozeduren und fügt eine Zeile in der `ProductsDataTable` für jeden Datensatz zurückgegebenen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="e2e29-192">Die Datenfelder, die von der gespeicherten Prozedur zurückgegebenen zugeordnet sind die `ProductsDataTable` s-Spalten.</span><span class="sxs-lookup"><span data-stu-id="e2e29-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="e2e29-193">Da gibt es eine `PriceQuartile` Datenfeld zurückgegeben wird, von der gespeicherten Prozedur, dessen Wert zugewiesen wird die `ProductsDataTable` s `PriceQuartile` Spalte.</span><span class="sxs-lookup"><span data-stu-id="e2e29-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="e2e29-194">Für die TableAdapter-Methoden, deren Abfragen geben keine zurück, eine `PriceQuartile` Datenfeld, das `PriceQuartile` Spaltenwert s ist der Wert von dessen `DefaultValue` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="e2e29-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="e2e29-195">Wie in Abbildung 2 gezeigt, wird dieser Wert festgelegt, um `DBNull`, der Standardwert.</span><span class="sxs-lookup"><span data-stu-id="e2e29-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="e2e29-196">Wenn Sie einen anderen Standardwert möchten, legen Sie einfach die `DefaultValue` Eigenschaft entsprechend.</span><span class="sxs-lookup"><span data-stu-id="e2e29-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="e2e29-197">Achten Sie darauf, die die `DefaultValue` Wert ist gültig. die Spalte s `DataType` (d. h. `System.Int32` für die `PriceQuartile` Spalte).</span><span class="sxs-lookup"><span data-stu-id="e2e29-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="e2e29-198">An diesem Punkt haben wir die erforderlichen Schritte ausgeführt, für das Hinzufügen einer zusätzlichen Spalte zu einer DataTable.</span><span class="sxs-lookup"><span data-stu-id="e2e29-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="e2e29-199">Um sicherzustellen, dass diese zusätzliche Spalte wie erwartet funktioniert, können Sie s eine ASP.NET-Seite erstellen, in dem jede s Produktname, Preis und Preis Quartil angezeigt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="e2e29-200">Bevor wir dies tun, jedoch müssen wir zuerst aktualisieren Sie die Business Logic Layer, um eine Methode enthalten, die die DAL-s-nach unten Aufrufe `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="e2e29-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="e2e29-201">Wir als Nächstes aktualisieren Sie die BLL in Schritt 3, und klicken Sie dann die ASP.NET-Seite in Schritt 4 erstellen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="e2e29-202">Schritt 3: Erweitern den Geschäftslogikebene</span><span class="sxs-lookup"><span data-stu-id="e2e29-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="e2e29-203">Bevor wir die Verwendung der neuen `GetProductsWithPriceQuartile` Methode auf der Darstellungsschicht, sollten wir zuerst eine entsprechende Methode an die BLL hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="e2e29-204">Öffnen der `ProductsBLLWithSprocs` Klassendatei, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="e2e29-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-csharp[Main](adding-additional-datatable-columns-cs/samples/sample2.cs)]

<span data-ttu-id="e2e29-205">Wie andere Datenabrufmethoden in `ProductsBLLWithSprocs`, `GetProductsWithPriceQuartile` Methode ruft einfach die DAL s entspricht `GetProductsWithPriceQuartile` Methode und die Ergebnisse werden zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="e2e29-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="e2e29-206">Schritt 4: Anzeigen von Quartil Preisinformationen in einer ASP.NET-Webseite</span><span class="sxs-lookup"><span data-stu-id="e2e29-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="e2e29-207">Führen wir außerdem mit der BLL erneut bereit, um eine ASP.NET-Seite zu erstellen, die Quartile Preis für jedes Produkt anzeigt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="e2e29-208">Öffnen der `AddingColumns.aspx` auf der Seite die `AdvancedDAL` Ordner, und ziehen Sie einer GridView-Ansicht aus der Toolbox auf den Designer, Festlegen der `ID` Eigenschaft `Products`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="e2e29-209">Von GridView s Smarttags, binden Sie es an eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="e2e29-210">Konfigurieren Sie mit dem ObjectDataSource-Steuerelement die `ProductsBLLWithSprocs` Klasse s `GetProductsWithPriceQuartile` Methode.</span><span class="sxs-lookup"><span data-stu-id="e2e29-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="e2e29-211">Da dies ein nur-Lese Raster sein wird, legen Sie die Dropdownlisten in der Update-, INSERT-, und Löschen von Registerkarten (keine) aus.</span><span class="sxs-lookup"><span data-stu-id="e2e29-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


[![C<span data-ttu-id="e2e29-212">Konfigurieren der ProductsBLLWithSprocs-Klasse mit dem ObjectDataSource-Steuerelement]</span><span class="sxs-lookup"><span data-stu-id="e2e29-212">onfigure the ObjectDataSource to Use the ProductsBLLWithSprocs Class]</span></span>(adding-additional-datatable-columns-cs/_static/image24.png)](adding-additional-datatable-columns-cs/_static/image23.png)

<span data-ttu-id="e2e29-213">**Abbildung 9**: Konfigurieren Sie das "ObjectDataSource" Verwenden der `ProductsBLLWithSprocs` Klasse ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image25.png))</span></span>


[![R<span data-ttu-id="e2e29-214">Etrieve Produktinformationen aus der Methode GetProductsWithPriceQuartile]</span><span class="sxs-lookup"><span data-stu-id="e2e29-214">etrieve Product Information from the GetProductsWithPriceQuartile Method]</span></span>(adding-additional-datatable-columns-cs/_static/image27.png)](adding-additional-datatable-columns-cs/_static/image26.png)

<span data-ttu-id="e2e29-215">**Abbildung 10**: Abrufen von Produktinformationen aus der `GetProductsWithPriceQuartile` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image28.png))</span></span>


<span data-ttu-id="e2e29-216">Nach Abschluss der Konfigurieren von Datenquellen-Assistenten wird Visual Studio automatisch eine BoundField- oder CheckBoxField hinzufügen an die GridView für die einzelnen Datenfelder, die von der Methode zurückgegebenen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="e2e29-217">Ist eines dieser Datenfelder `PriceQuartile`, d.h., dass die Spalte, die wir hinzugefügt, die `ProductsDataTable` in Schritt 1.</span><span class="sxs-lookup"><span data-stu-id="e2e29-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="e2e29-218">Bearbeiten Sie die Felder GridView s, entfernen alle außer den `ProductName`, `UnitPrice`, und `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="e2e29-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="e2e29-219">Konfigurieren der `UnitPrice` BoundField, dessen Wert als Währung zu formatieren und die `UnitPrice` und `PriceQuartile` BoundFields rechts - und zentriert bzw.</span><span class="sxs-lookup"><span data-stu-id="e2e29-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="e2e29-220">Zum Schluss aktualisieren Sie die verbleibenden BoundFields `HeaderText` Eigenschaften für das Produkt, Preis und Preis Quartil, bzw.</span><span class="sxs-lookup"><span data-stu-id="e2e29-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="e2e29-221">Darüber hinaus das Kontrollkästchen Sie sortieren aktivieren aus dem GridView-s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="e2e29-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="e2e29-222">Nachdem diese Änderungen sollten GridView und "ObjectDataSource" s deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="e2e29-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-cs/samples/sample3.aspx)]

<span data-ttu-id="e2e29-223">Abbildung 11 zeigt diese Seite, wenn über einen Browser aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="e2e29-224">Beachten Sie, dass zunächst die Produkte nach Preis in absteigender Reihenfolge mit den einzelnen Produkten, die eine entsprechende zugewiesen sortiert werden `PriceQuartile` Wert.</span><span class="sxs-lookup"><span data-stu-id="e2e29-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="e2e29-225">Natürlich können diese Daten nach anderen Kriterien sortiert werden, mit dem Preis Quartil-Spaltenwert weiterhin reflektieren die Rangfolge Produkt s in Bezug auf den Preis (siehe Abbildung 12).</span><span class="sxs-lookup"><span data-stu-id="e2e29-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


[![T<span data-ttu-id="e2e29-226">seine Produkte sind nach deren Preise sortiert]</span><span class="sxs-lookup"><span data-stu-id="e2e29-226">he Products are Ordered by their Prices]</span></span>(adding-additional-datatable-columns-cs/_static/image30.png)](adding-additional-datatable-columns-cs/_static/image29.png)

<span data-ttu-id="e2e29-227">**Abbildung 11**: Die Produkte werden nach deren Preise sortiert ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image31.png))</span></span>


[![T<span data-ttu-id="e2e29-228">seine Produkte werden nach Namen sortiert]</span><span class="sxs-lookup"><span data-stu-id="e2e29-228">he Products are Ordered by their Names]</span></span>(adding-additional-datatable-columns-cs/_static/image33.png)](adding-additional-datatable-columns-cs/_static/image32.png)

<span data-ttu-id="e2e29-229">**Abbildung 12**: Die Produkte werden nach Namen sortiert ([klicken Sie, um das Bild in voller Größe anzeigen](adding-additional-datatable-columns-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="e2e29-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-cs/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="e2e29-230">Mit wenigen Codezeilen können wir GridView, damit sie die Produktzeilen, die basierend auf gefärbt erweitern ihre `PriceQuartile` Wert.</span><span class="sxs-lookup"><span data-stu-id="e2e29-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="e2e29-231">Wir können diese Produkte in das erste Quartil hellgrün, die in der zweiten Quartil eine Hosttags in Gelb, Farbe und so weiter.</span><span class="sxs-lookup"><span data-stu-id="e2e29-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="e2e29-232">Sollten Sie diese Funktionalität hinzufügen werden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="e2e29-233">Wenn Sie Ihre Kenntnisse über die Formatierung einer GridView-Ansicht benötigen, wenden Sie sich an den [benutzerdefinierte Formatierung basierend auf Daten](../custom-formatting/custom-formatting-based-upon-data-cs.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="e2e29-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="e2e29-234">Eine Alternative Methode: erstellen eine andere TableAdapter</span><span class="sxs-lookup"><span data-stu-id="e2e29-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="e2e29-235">Wie in diesem Tutorial, beim Hinzufügen einer Methode zu einem TableAdapter, die die Datenfelder als zurückgibt durch die Hauptabfrage ausgeschrieben erläutert, können wir die entsprechende Spalten der Datentabelle hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="e2e29-236">Ein solcher Ansatz, allerdings funktioniert gut, nur, wenn es gibt eine kleine Anzahl von Methoden in den TableAdapter, die verschiedenen Datenfeldern zurückgeben und diese alternativen Datenfelder nicht aus der Hauptabfrage zu stark variieren.</span><span class="sxs-lookup"><span data-stu-id="e2e29-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="e2e29-237">Anstelle der Datentabelle Spalten hinzugefügt haben, können Sie stattdessen eine andere TableAdapter zum DataSet hinzufügen, die die Methoden aus dem ersten TableAdapter enthält, die verschiedenen Datenfeldern zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="e2e29-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="e2e29-238">Für dieses Tutorial anstatt hinzuzufügen der `PriceQuartile` Spalte die `ProductsDataTable` (, in dem er dient lediglich durch die `GetProductsWithPriceQuartile` Methode), wir hätten einen zusätzlichen TableAdapter auf das DataSet mit dem Namen `ProductsWithPriceQuartileTableAdapter` , verwendet der `Products_SelectWithPriceQuartile` gespeichert die Prozedur als der Hauptabfrage.</span><span class="sxs-lookup"><span data-stu-id="e2e29-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="e2e29-239">ASP.NET-Seiten, die zum Abrufen von Produktinformationen, mit dem Preis Quartil erforderlich ist, verwenden die `ProductsWithPriceQuartileTableAdapter`, während solche, die nicht weiterhin verwenden, können die `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="e2e29-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="e2e29-240">Durch das Hinzufügen eines neuen TableAdapter, die DataTables untarnished bleiben, und ihre Spalten spiegeln genau die Datenfelder, die von ihren TableAdapter-s-Methoden zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="e2e29-241">Allerdings können zusätzliche TableAdapters sich wiederholende Aufgaben und Funktionen einführen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="e2e29-242">Z. B., wenn diese ASP.NET Seiten angezeigten der `PriceQuartile` Spalte auch erforderlich zu Einfüge-, aktualisieren und Löschen von Support, die `ProductsWithPriceQuartileTableAdapter` benötigen die `InsertCommand`, `UpdateCommand`, und `DeleteCommand` Eigenschaften ordnungsgemäß konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="e2e29-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="e2e29-243">Während diese Eigenschaften zu spiegeln, würde die `ProductsTableAdapter` s, diese Konfiguration stellt einen zusätzlichen Schritt.</span><span class="sxs-lookup"><span data-stu-id="e2e29-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="e2e29-244">Außerdem sind nun zwei Möglichkeiten, zu aktualisieren, löschen oder Hinzufügen eines Produkts mit der Datenbank - über die `ProductsTableAdapter` und `ProductsWithPriceQuartileTableAdapter` Klassen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="e2e29-245">Der Download für dieses Tutorial enthält eine `ProductsWithPriceQuartileTableAdapter` -Klasse in der `NorthwindWithSprocs` DataSet, das diese alternative Methode veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="e2e29-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="e2e29-246">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="e2e29-246">Summary</span></span>

<span data-ttu-id="e2e29-247">In den meisten Fällen den gleichen Satz von Datenfeldern alle Methoden in einem TableAdapter zurück, aber es gibt Situationen, wenn eine bestimmte Methode oder zwei möglicherweise ein zusätzliches Feld zurück.</span><span class="sxs-lookup"><span data-stu-id="e2e29-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="e2e29-248">Z. B. in der [Master/Detail, verwenden eine Liste mit Aufzählungszeichen Liste der Masterdatensätze mit einem DataList-Steuerelement Details](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) Tutorial, die wir hinzugefügt, dass eine Methode, um die `CategoriesTableAdapter` , zusätzlich zu der Hauptabfrage s Datenfelder, die zurückgegeben eine `NumberOfProducts` Datenfelds, die Anzahl der Produkte jeder Kategorie zugeordnet wird gemeldet.</span><span class="sxs-lookup"><span data-stu-id="e2e29-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="e2e29-249">In diesem Tutorial erläutert, Hinzufügen einer Methode in der `ProductsTableAdapter` zurückgegebenen eine `PriceQuartile` Feld zusätzlich zu den Feldern der Hauptabfrage s-Daten.</span><span class="sxs-lookup"><span data-stu-id="e2e29-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="e2e29-250">Zum Erfassen von zusätzlicher Daten werden Felder durch den TableAdapter-s-Methoden zurückgegeben, dass die entsprechende Spalten der Datentabelle hinzufügen möchten.</span><span class="sxs-lookup"><span data-stu-id="e2e29-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="e2e29-251">Wenn Sie manuell Spalten der Datentabelle hinzufügen möchten, empfiehlt es sich, dass der TableAdapter gespeicherte Prozeduren verwenden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="e2e29-252">Wenn Ad-hoc-SQL-Anweisungen in der TableAdapter verwendet wird, wird jedes Mal der TableAdapter-Konfigurations-Assistenten alle Methoden ausgeführt die Datenfelder, die von der main-Abfrage zurückgegebenen Daten Feldlisten wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="e2e29-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="e2e29-253">Dieses Problem erstreckt sich nicht gespeicherte Prozeduren verwendet, ist diese werden empfohlen und in diesem Tutorial verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="e2e29-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="e2e29-254">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="e2e29-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="e2e29-255">Der Autor</span><span class="sxs-lookup"><span data-stu-id="e2e29-255">About the Author</span></span>

<span data-ttu-id="e2e29-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="e2e29-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e2e29-257">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="e2e29-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e2e29-258">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e2e29-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e2e29-259">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e2e29-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e2e29-260">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e2e29-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e2e29-261">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="e2e29-261">Special Thanks To</span></span>

<span data-ttu-id="e2e29-262">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="e2e29-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e2e29-263">Führendes Prüfer für dieses Tutorial wurden Randy Schmidt, Jacky Goor, Bernadette Leigh und Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="e2e29-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="e2e29-264">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="e2e29-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e2e29-265">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e2e29-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e2e29-266">[Zurück](updating-the-tableadapter-to-use-joins-cs.md)
> [Weiter](working-with-computed-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="e2e29-266">[Previous](updating-the-tableadapter-to-use-joins-cs.md)
[Next](working-with-computed-columns-cs.md)</span></span>
