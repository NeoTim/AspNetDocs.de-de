---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/configuring-the-data-access-layer-s-connection-and-command-level-settings-cs
title: Konfigurieren der Einstellungen für die Verbindungs-und Befehls Ebene der Datenzugriffs EbeneC#() | Microsoft-Dokumentation
author: rick-anderson
description: Die TableAdapters in einem typisierten DataSet sorgen automatisch dafür, dass Sie eine Verbindung mit der Datenbank herstellen, Befehle ausgeben und eine Datentabelle mit den Ergebnissen auffüllen...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: cd330dd9-6254-4305-9351-dd727384c83b
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/configuring-the-data-access-layer-s-connection-and-command-level-settings-cs
msc.type: authoredcontent
ms.openlocfilehash: 8fe7a5a2e410b47c8c2be62851f2b7b775d60209
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74604913"
---
# <a name="configuring-the-data-access-layers-connection--and-command-level-settings-c"></a><span data-ttu-id="5586b-103">Konfigurieren von Einstellungen der Datenzugriffsschicht auf Verbindungs- und Befehlsebene (C#)</span><span class="sxs-lookup"><span data-stu-id="5586b-103">Configuring the Data Access Layer's Connection- and Command-Level Settings (C#)</span></span>

<span data-ttu-id="5586b-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5586b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5586b-105">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_72_CS.zip) oder [PDF herunterladen](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/datatutorial72cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5586b-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_72_CS.zip) or [Download PDF](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/datatutorial72cs1.pdf)</span></span>

> <span data-ttu-id="5586b-106">Die TableAdapters in einem typisierten DataSet sorgen automatisch dafür, dass Sie eine Verbindung mit der Datenbank herstellen, Befehle ausgeben und eine Datentabelle mit den Ergebnissen auffüllen.</span><span class="sxs-lookup"><span data-stu-id="5586b-106">The TableAdapters within a Typed DataSet automatically take care of connecting to the database, issuing commands, and populating a DataTable with the results.</span></span> <span data-ttu-id="5586b-107">Es gibt jedoch Fälle, in denen wir diese Details selbst berücksichtigen möchten, und in diesem Tutorial erfahren Sie, wie Sie im TableAdapter auf die Einstellungen für die Daten Bankverbindung und die Befehls Ebene zugreifen.</span><span class="sxs-lookup"><span data-stu-id="5586b-107">There are occasions however when we want to take care of these details ourselves, and in this tutorial we learn how to access the database connection- and command-level settings in the TableAdapter.</span></span>

## <a name="introduction"></a><span data-ttu-id="5586b-108">Einführung</span><span class="sxs-lookup"><span data-stu-id="5586b-108">Introduction</span></span>

<span data-ttu-id="5586b-109">In der tutorialreihe haben wir typisierte Datasets verwendet, um die Datenzugriffs Ebene und die Geschäftsobjekte unserer geschichteten Architektur zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="5586b-109">Throughout the tutorial series we have used Typed DataSets to implement the Data Access Layer and business objects of our layered architecture.</span></span> <span data-ttu-id="5586b-110">Wie im [ersten Tutorial](../introduction/creating-a-data-access-layer-cs.md)erläutert, dienen die DataTables der typisierten Datasets als Datenblatt Daten, während die TableAdapters als Wrapper fungieren, um mit der Datenbank zu kommunizieren, um die zugrunde liegenden Daten abzurufen und zu ändern.</span><span class="sxs-lookup"><span data-stu-id="5586b-110">As discussed in the [first tutorial](../introduction/creating-a-data-access-layer-cs.md), the Typed DataSet s DataTables serve as repositories of data whereas the TableAdapters act as wrappers to communicate with the database to retrieve and modify the underlying data.</span></span> <span data-ttu-id="5586b-111">Die TableAdapters Kapseln die Komplexität, die bei der Arbeit mit der Datenbank beteiligt ist, und es ist nicht erforderlich, Code zu schreiben, um eine Verbindung mit der Datenbank herzustellen, einen Befehl auszugeben oder die Ergebnisse in eine Datentabelle aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="5586b-111">The TableAdapters encapsulate the complexity involved in working with the database and saves us from having to write code to connect to the database, issue a command, or populate the results into a DataTable.</span></span>

<span data-ttu-id="5586b-112">Es gibt jedoch Zeiten, in denen wir uns in die Tiefen des TableAdapter einreihen und Code schreiben müssen, der direkt mit den ADO.NET-Objekten funktioniert.</span><span class="sxs-lookup"><span data-stu-id="5586b-112">There are times, however, when we need to burrow into the depths of the TableAdapter and write code that works directly with the ADO.NET objects.</span></span> <span data-ttu-id="5586b-113">Im Tutorial zum [Umpacken von Daten Bank Änderungen in einer Transaktion](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) haben wir z. b. Methoden zum Starten, zum Commit und zum Rollback von ADO.NET-Transaktionen zum TableAdapter hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="5586b-113">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) tutorial, for example, we added methods to the TableAdapter for beginning, committing, and rolling back ADO.NET transactions.</span></span> <span data-ttu-id="5586b-114">Diese Methoden haben ein internes, manuell erstelltes `SqlTransaction` Objekt verwendet, das den TableAdapter s `SqlCommand`-Objekten zugewiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="5586b-114">These methods used an internal, manually-created `SqlTransaction` object that was assigned to the TableAdapter s `SqlCommand` objects.</span></span>

<span data-ttu-id="5586b-115">In diesem Tutorial wird erläutert, wie Sie im TableAdapter auf die Einstellungen für die Daten Bankverbindung und auf Befehls Ebene zugreifen.</span><span class="sxs-lookup"><span data-stu-id="5586b-115">In this tutorial we will examine how to access the database connection- and command-level settings in the TableAdapter.</span></span> <span data-ttu-id="5586b-116">Insbesondere werden dem `ProductsTableAdapter` Funktionen hinzugefügt, die den Zugriff auf die zugrunde liegende Verbindungs Zeichenfolge und die Befehls Timeout Einstellungen ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="5586b-116">In particular, we will add functionality to the `ProductsTableAdapter` that enables access to the underlying connection string and command timeout settings.</span></span>

## <a name="working-with-data-using-adonet"></a><span data-ttu-id="5586b-117">Arbeiten mit Daten mithilfe von ADO.net</span><span class="sxs-lookup"><span data-stu-id="5586b-117">Working with Data Using ADO.NET</span></span>

<span data-ttu-id="5586b-118">Das Microsoft .NET Framework enthält eine Vielzahl von Klassen, die speziell für die Arbeit mit Daten entworfen wurden.</span><span class="sxs-lookup"><span data-stu-id="5586b-118">The Microsoft .NET Framework contains a plethora of classes designed specifically to work with data.</span></span> <span data-ttu-id="5586b-119">Diese Klassen, die im [`System.Data`-Namespace](https://msdn.microsoft.com/library/system.data.aspx)gefunden werden, werden als *ADO.net* -Klassen bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="5586b-119">These classes, found within the [`System.Data` namespace](https://msdn.microsoft.com/library/system.data.aspx), are referred to as the *ADO.NET* classes.</span></span> <span data-ttu-id="5586b-120">Einige der Klassen im ADO.net-Dach sind an einen bestimmten *Datenanbieter*gebunden.</span><span class="sxs-lookup"><span data-stu-id="5586b-120">Some of the classes under the ADO.NET umbrella are tied to a particular *data provider*.</span></span> <span data-ttu-id="5586b-121">Sie können sich einen Datenanbieter als Kommunikationskanal vorstellen, der den Datenfluss zwischen den ADO.NET-Klassen und dem zugrunde liegenden Datenspeicher ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="5586b-121">You can think of a data provider as a communication channel that allows information to flow between the ADO.NET classes and the underlying data store.</span></span> <span data-ttu-id="5586b-122">Es gibt generalisierte Anbieter, wie z. b. OleDb und ODBC, sowie Anbieter, die speziell für ein bestimmtes Datenbanksystem entwickelt wurden.</span><span class="sxs-lookup"><span data-stu-id="5586b-122">There are generalized providers, like OleDb and ODBC, as well as providers that are specially designed for a particular database system.</span></span> <span data-ttu-id="5586b-123">Beispielsweise ist es möglich, eine Verbindung mit einer Microsoft SQL Server Datenbank mithilfe des OLE DB-Anbieters herzustellen, aber der SqlClient-Anbieter ist viel effizienter, da er speziell für SQL Server entworfen und optimiert wurde.</span><span class="sxs-lookup"><span data-stu-id="5586b-123">For example, while it is possible to connect to a Microsoft SQL Server database using the OleDb provider, the SqlClient provider is much more efficient as it was designed and optimized specifically for SQL Server.</span></span>

<span data-ttu-id="5586b-124">Beim programmgesteuerten Zugriff auf Daten wird das folgende Muster häufig verwendet:</span><span class="sxs-lookup"><span data-stu-id="5586b-124">When programmatically accessing data, the following pattern is commonly used:</span></span>

- <span data-ttu-id="5586b-125">Stellen Sie eine Verbindung mit der Datenbank her.</span><span class="sxs-lookup"><span data-stu-id="5586b-125">Establish a connection to the database.</span></span>
- <span data-ttu-id="5586b-126">Geben Sie einen Befehl aus.</span><span class="sxs-lookup"><span data-stu-id="5586b-126">Issue a command.</span></span>
- <span data-ttu-id="5586b-127">Arbeiten Sie für `SELECT` Abfragen mit den resultierenden Datensätzen.</span><span class="sxs-lookup"><span data-stu-id="5586b-127">For `SELECT` queries, work with the resulting records.</span></span>

<span data-ttu-id="5586b-128">Es gibt separate ADO.NET-Klassen, mit denen Sie die einzelnen Schritte ausführen können.</span><span class="sxs-lookup"><span data-stu-id="5586b-128">There are separate ADO.NET classes for performing each of these steps.</span></span> <span data-ttu-id="5586b-129">Wenn Sie z. b. mithilfe des SqlClient-Anbieters eine Verbindung mit einer Datenbank herstellen möchten, verwenden Sie die [`SqlConnection`-Klasse](https://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="5586b-129">To connect to a database using the SqlClient provider, for example, use the [`SqlConnection` class](https://msdn.microsoft.com/library/system.data.sqlclient.sqlconnection(VS.80).aspx).</span></span> <span data-ttu-id="5586b-130">Verwenden Sie die [`SqlCommand`-Klasse](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.aspx), um einen `INSERT`, `UPDATE`, `DELETE`oder `SELECT` Befehl an die Datenbank auszugeben.</span><span class="sxs-lookup"><span data-stu-id="5586b-130">To issue an `INSERT`, `UPDATE`, `DELETE`, or `SELECT` command to the database, use the [`SqlCommand` class](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.aspx).</span></span>

<span data-ttu-id="5586b-131">Mit Ausnahme des Lernprogramms zum umschließen [von Daten Bank Änderungen in einer Transaktion](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) mussten wir keinen ADO.NET-Code auf niedriger Ebene schreiben, da der automatisch generierte TableAdapters-Code die Funktionen enthält, die zum Herstellen einer Verbindung mit der Datenbank, ausgeben von Befehlen, Abrufen von Daten und Auffüllen dieser Daten in DataTables benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-131">Except for the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-cs.md) tutorial, we have not had to write any low-level ADO.NET code ourselves because the TableAdapters auto-generated code includes the functionality needed to connect to the database, issue commands, retrieve data, and populate that data into DataTables.</span></span> <span data-ttu-id="5586b-132">Es kann jedoch vorkommen, dass diese Einstellungen auf niedriger Ebene angepasst werden müssen.</span><span class="sxs-lookup"><span data-stu-id="5586b-132">However, there may be times when we need to customize these low-level settings.</span></span> <span data-ttu-id="5586b-133">In den nächsten Schritten wird erläutert, wie Sie auf die ADO.NET-Objekte tippen, die intern von den TableAdapters verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-133">Over the next few steps we will examine how to tap into the ADO.NET objects used internally by the TableAdapters.</span></span>

## <a name="step-1-examining-with-the-connection-property"></a><span data-ttu-id="5586b-134">Schritt 1: untersuchen mit der Connection-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="5586b-134">Step 1: Examining with the Connection Property</span></span>

<span data-ttu-id="5586b-135">Jede TableAdapter-Klasse verfügt über eine `Connection`-Eigenschaft, die Informationen zur Datenbankverbindung angibt.</span><span class="sxs-lookup"><span data-stu-id="5586b-135">Each TableAdapter class has a `Connection` property that specifies database connection information.</span></span> <span data-ttu-id="5586b-136">Der Datentyp der Eigenschaft und der `ConnectionString` Wert werden durch die im TableAdapter-Konfigurations-Assistenten getroffenen Auswahl bestimmt.</span><span class="sxs-lookup"><span data-stu-id="5586b-136">This property s data type and `ConnectionString` value are determined by the selections made in the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="5586b-137">Beachten Sie, dass der Assistent beim ersten Hinzufügen eines TableAdapter zu einem typisierten DataSet zur Datenbankquelle aufgefordert wird (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="5586b-137">Recall that when we first add a TableAdapter to a Typed DataSet this wizard asks us for the database source (see Figure 1).</span></span> <span data-ttu-id="5586b-138">Die Dropdown Liste in diesem ersten Schritt umfasst die Datenbanken, die in der Konfigurationsdatei angegeben sind, sowie alle anderen Datenbanken in den Server-Explorer s-Datenverbindungen.</span><span class="sxs-lookup"><span data-stu-id="5586b-138">The drop-down list in this first step includes those databases specified in the configuration file as well as any other databases in the Server Explorer s Data Connections.</span></span> <span data-ttu-id="5586b-139">Wenn die zu verwendende Datenbank nicht in der Dropdown Liste vorhanden ist, können Sie eine neue Datenbankverbindung angeben, indem Sie auf die Schaltfläche neue Verbindung klicken und die erforderlichen Verbindungsinformationen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="5586b-139">If the database we want to use does not exist in the drop-down list, a new database connection can be specified by clicking the New Connection button and providing the needed connection information.</span></span>

<span data-ttu-id="5586b-140">[![des ersten Schritts des TableAdapter-Konfigurations-Assistenten](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image2.png)](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5586b-140">[![The First Step of the TableAdapter Configuration Wizard](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image2.png)](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image1.png)</span></span>

<span data-ttu-id="5586b-141">**Abbildung 1**: der erste Schritt des TableAdapter-Konfigurations-Assistenten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5586b-141">**Figure 1**: The First Step of the TableAdapter Configuration Wizard ([Click to view full-size image](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image3.png))</span></span>

<span data-ttu-id="5586b-142">Nehmen Sie sich einen Moment Zeit, um den Code für die TableAdapter s-`Connection`-Eigenschaft zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="5586b-142">Let s take a moment to inspect the code for the TableAdapter s `Connection` property.</span></span> <span data-ttu-id="5586b-143">Wie im Tutorial [Erstellen einer Datenzugriffs Ebene](../introduction/creating-a-data-access-layer-cs.md) erwähnt, können wir den automatisch generierten TableAdapter-Code anzeigen, indem wir zum Fenster "Klassenansicht" navigieren, einen Drilldown auf die entsprechende Klasse ausführen und dann auf den Elementnamen doppelklicken.</span><span class="sxs-lookup"><span data-stu-id="5586b-143">As noted in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial, we can view the auto-generated TableAdapter code by going to the Class View window, drilling down to the appropriate class, and then double-clicking the member name.</span></span>

<span data-ttu-id="5586b-144">Navigieren Sie zum Klassenansicht Fenster, indem Sie zum Menü Ansicht navigieren und Klassenansicht (oder durch Drücken von STRG + UMSCHALT + C) auswählen.</span><span class="sxs-lookup"><span data-stu-id="5586b-144">Navigate to the Class View window by going to the View menu and choosing Class View (or by typing Ctrl+Shift+C).</span></span> <span data-ttu-id="5586b-145">Führen Sie in der oberen Hälfte des Klassenansicht Fensters einen Drilldown zum `NorthwindTableAdapters`-Namespace aus, und wählen Sie die `ProductsTableAdapter`-Klasse aus.</span><span class="sxs-lookup"><span data-stu-id="5586b-145">From the top half of the Class View window, drill down to the `NorthwindTableAdapters` namespace and select the `ProductsTableAdapter` class.</span></span> <span data-ttu-id="5586b-146">Dadurch werden die `ProductsTableAdapter` s-Elemente in der unteren Hälfte des Klassenansicht angezeigt, wie in Abbildung 2 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="5586b-146">This will display the `ProductsTableAdapter` s members in the bottom half of the Class View, as shown in Figure 2.</span></span> <span data-ttu-id="5586b-147">Doppelklicken Sie auf die `Connection`-Eigenschaft, um Ihren Code anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5586b-147">Double-click the `Connection` property to see its code.</span></span>

![Doppelklicken Sie im Klassenansicht auf die Verbindungs Eigenschaft, um den automatisch generierten Code anzuzeigen.](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image4.png)

<span data-ttu-id="5586b-149">**Abbildung 2**: Doppelklicken Sie auf die Connection-Eigenschaft im Klassenansicht, um den automatisch generierten Code anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5586b-149">**Figure 2**: Double-Click the Connection Property in the Class View to View Its Auto-Generated Code</span></span>

<span data-ttu-id="5586b-150">Die TableAdapter s `Connection`-Eigenschaft und anderer Verbindungs bezogener Code folgendermaßen:</span><span class="sxs-lookup"><span data-stu-id="5586b-150">The TableAdapter s `Connection` property and other connection-related code follows:</span></span>

[!code-csharp[Main](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/samples/sample1.cs)]

<span data-ttu-id="5586b-151">Wenn die TableAdapter-Klasse instanziiert wird, ist die Element Variable `_connection` gleich `null`.</span><span class="sxs-lookup"><span data-stu-id="5586b-151">When the TableAdapter class is instantiated, the member variable `_connection` is equal to `null`.</span></span> <span data-ttu-id="5586b-152">Beim Zugriff auf die `Connection`-Eigenschaft wird zuerst überprüft, ob die `_connection` Member-Variable instanziiert wurde.</span><span class="sxs-lookup"><span data-stu-id="5586b-152">When the `Connection` property is accessed, it first checks to see if the `_connection` member variable has been instantiated.</span></span> <span data-ttu-id="5586b-153">Wenn dies nicht der Fall ist, wird die `InitConnection`-Methode aufgerufen, die `_connection` instanziiert und die `ConnectionString`-Eigenschaft auf den Wert der Verbindungs Zeichenfolge festlegt, der im ersten Schritt des TableAdapter-Konfigurations-Assistenten angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="5586b-153">If it has not, the `InitConnection` method is invoked, which instantiates `_connection` and sets its `ConnectionString` property to the connection string value specified from the TableAdapter Configuration wizard s first step.</span></span>

<span data-ttu-id="5586b-154">Die `Connection`-Eigenschaft kann auch einem `SqlConnection`-Objekt zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-154">The `Connection` property can also be assigned to a `SqlConnection` object.</span></span> <span data-ttu-id="5586b-155">Dadurch wird das neue `SqlConnection`-Objekt jedem der TableAdapter s `SqlCommand`-Objekten zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="5586b-155">Doing so associates the new `SqlConnection` object with each of the TableAdapter s `SqlCommand` objects.</span></span>

## <a name="step-2-exposing-connection-level-settings"></a><span data-ttu-id="5586b-156">Schritt 2: verfügbar machen von Einstellungen auf Verbindungs Ebene</span><span class="sxs-lookup"><span data-stu-id="5586b-156">Step 2: Exposing Connection-Level Settings</span></span>

<span data-ttu-id="5586b-157">Die Verbindungsinformationen sollten im TableAdapter gekapselt bleiben und sind nicht für andere Ebenen in der Anwendungsarchitektur zugänglich.</span><span class="sxs-lookup"><span data-stu-id="5586b-157">The connection information should remain encapsulated within the TableAdapter and not be accessible to other layers in the application architecture.</span></span> <span data-ttu-id="5586b-158">Allerdings kann es Szenarien geben, in denen die Informationen auf der Basis der TableAdapter-Informationen auf Verbindungs Ebene für eine Abfrage-, Benutzer-oder ASP.NET-Seite zugänglich sein müssen.</span><span class="sxs-lookup"><span data-stu-id="5586b-158">However, there may be scenarios when the TableAdapter s connection-level information needs to be accessible or customizable for a query, user, or ASP.NET page.</span></span>

<span data-ttu-id="5586b-159">Erweitern Sie die `ProductsTableAdapter` im `Northwind` DataSet so, dass eine `ConnectionString`-Eigenschaft enthalten ist, die von der Geschäftslogik Schicht verwendet werden kann, um die vom TableAdapter verwendete Verbindungs Zeichenfolge zu lesen oder zu ändern.</span><span class="sxs-lookup"><span data-stu-id="5586b-159">Let s extend the `ProductsTableAdapter` in the `Northwind` DataSet to include a `ConnectionString` property that can be used by the Business Logic Layer to read or change the connection string used by the TableAdapter.</span></span>

> [!NOTE]
> <span data-ttu-id="5586b-160">Eine *Verbindungs Zeichenfolge* ist eine Zeichenfolge, die Daten bankverbindungs Informationen angibt, wie z. b. den zu verwendenden Anbieter, den Speicherort der Datenbank, Anmelde Informationen für die Authentifizierung und andere datenbankbezogene Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="5586b-160">A *connection string* is a string that specifies database connection information, such as the provider to use, the location of the database, authentication credentials, and other database-related settings.</span></span> <span data-ttu-id="5586b-161">Eine Liste der Muster der Verbindungs Zeichenfolge, die von einer Vielzahl von Daten speichern und Anbietern verwendet werden, finden Sie unter [connectionStrings.com](http://www.connectionstrings.com/).</span><span class="sxs-lookup"><span data-stu-id="5586b-161">For a list of connection string patterns used by a variety of data stores and providers, see [ConnectionStrings.com](http://www.connectionstrings.com/).</span></span>

<span data-ttu-id="5586b-162">Wie im Tutorial [Erstellen einer Datenzugriffs Ebene](../introduction/creating-a-data-access-layer-cs.md) erläutert, können die automatisch generierten Klassen des typisierten Datasets durch die Verwendung von partiellen Klassen erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-162">As discussed in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial, the Typed DataSet s auto-generated classes can be extended through the use of partial classes.</span></span> <span data-ttu-id="5586b-163">Erstellen Sie zunächst einen neuen Unterordner in dem Projekt mit dem Namen `ConnectionAndCommandSettings` unterhalb des `~/App_Code/DAL` Ordners.</span><span class="sxs-lookup"><span data-stu-id="5586b-163">First, create a new subfolder in the project named `ConnectionAndCommandSettings` underneath the `~/App_Code/DAL` folder.</span></span>

![Fügen Sie einen Unterordner mit dem Namen connectionandcommandsettings hinzu.](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image5.png)

<span data-ttu-id="5586b-165">**Abbildung 3**: Hinzufügen eines unter Ordners mit dem Namen `ConnectionAndCommandSettings`</span><span class="sxs-lookup"><span data-stu-id="5586b-165">**Figure 3**: Add a Subfolder Named `ConnectionAndCommandSettings`</span></span>

<span data-ttu-id="5586b-166">Fügen Sie eine neue Klassendatei namens `ProductsTableAdapter.ConnectionAndCommandSettings.cs` hinzu, und geben Sie den folgenden Code ein:</span><span class="sxs-lookup"><span data-stu-id="5586b-166">Add a new class file named `ProductsTableAdapter.ConnectionAndCommandSettings.cs` and enter the following code:</span></span>

[!code-csharp[Main](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/samples/sample2.cs)]

<span data-ttu-id="5586b-167">Diese partielle Klasse fügt der `ProductsTableAdapter`-Klasse eine `public` Eigenschaft mit dem Namen `ConnectionString` hinzu, die es allen Ebenen ermöglicht, die Verbindungs Zeichenfolge für die zugrunde liegende Verbindung von TableAdapter zu lesen oder zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="5586b-167">This partial class adds a `public` property named `ConnectionString` to the `ProductsTableAdapter` class that allows any layer to read or update the connection string for the TableAdapter s underlying connection.</span></span>

<span data-ttu-id="5586b-168">Wenn diese partielle Klasse erstellt (und gespeichert) ist, öffnen Sie die `ProductsBLL`-Klasse.</span><span class="sxs-lookup"><span data-stu-id="5586b-168">With this partial class created (and saved), open the `ProductsBLL` class.</span></span> <span data-ttu-id="5586b-169">Wechseln Sie zu einer der vorhandenen Methoden, und geben Sie `Adapter` ein, und drücken Sie dann die Punkt Taste, um IntelliSense aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="5586b-169">Go to one of the existing methods and type in `Adapter` and then hit the period key to bring up IntelliSense.</span></span> <span data-ttu-id="5586b-170">Sie sollten sehen, dass die neue `ConnectionString`-Eigenschaft in IntelliSense verfügbar ist, was bedeutet, dass Sie diesen Wert Programm gesteuert aus der BLL lesen oder anpassen können.</span><span class="sxs-lookup"><span data-stu-id="5586b-170">You should see the new `ConnectionString` property available in IntelliSense, meaning that you can programmatically read or adjust this value from the BLL.</span></span>

## <a name="exposing-the-entire-connection-object"></a><span data-ttu-id="5586b-171">Verfügbar machen des gesamten Verbindungs Objekts</span><span class="sxs-lookup"><span data-stu-id="5586b-171">Exposing the Entire Connection Object</span></span>

<span data-ttu-id="5586b-172">Diese partielle Klasse macht nur eine Eigenschaft des zugrunde liegenden Verbindungs Objekts verfügbar: `ConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="5586b-172">This partial class exposes just one property of the underlying connection object: `ConnectionString`.</span></span> <span data-ttu-id="5586b-173">Wenn Sie das gesamte Verbindungs Objekt über die Grenzen des TableAdapter hinaus verfügbar machen möchten, können Sie alternativ die Schutz Ebene für die `Connection`-Eigenschaft ändern.</span><span class="sxs-lookup"><span data-stu-id="5586b-173">If you want to make the entire connection object available beyond the confines of the TableAdapter, you can alternatively change the `Connection` property s protection level.</span></span> <span data-ttu-id="5586b-174">Der automatisch generierte Code, den wir in Schritt 1 untersucht haben, zeigte, dass die Eigenschaft TableAdapter s `Connection` als `internal`gekennzeichnet ist, was bedeutet, dass nur Klassen in derselben Assembly darauf zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="5586b-174">The auto-generated code we examined in Step 1 showed that the TableAdapter s `Connection` property is marked as `internal`, meaning that it can only be accessed by classes in the same assembly.</span></span> <span data-ttu-id="5586b-175">Dies kann jedoch über die Eigenschaft TableAdapter s `ConnectionModifier` geändert werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-175">This can be changed, however, via the TableAdapter s `ConnectionModifier` property.</span></span>

<span data-ttu-id="5586b-176">Öffnen Sie das DataSet `Northwind`, klicken Sie im Designer auf die `ProductsTableAdapter`, und navigieren Sie zum Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="5586b-176">Open the `Northwind` DataSet, click on the `ProductsTableAdapter` in the Designer, and navigate to the Properties window.</span></span> <span data-ttu-id="5586b-177">Dort sehen Sie, dass die `ConnectionModifier` auf ihren Standardwert festgelegt ist, `Assembly`.</span><span class="sxs-lookup"><span data-stu-id="5586b-177">There you will see the `ConnectionModifier` set to its default value, `Assembly`.</span></span> <span data-ttu-id="5586b-178">Um die `Connection`-Eigenschaft außerhalb der Assembly des typisierten Datasets verfügbar zu machen, ändern Sie die Eigenschaft `ConnectionModifier` in `Public`.</span><span class="sxs-lookup"><span data-stu-id="5586b-178">To make the `Connection` property available outside of the Typed DataSet s assembly, change the `ConnectionModifier` property to `Public`.</span></span>

<span data-ttu-id="5586b-179">[![die Barrierefreiheits Stufe der Verbindungs Eigenschaft kann über die connectionmodifier-Eigenschaft konfiguriert werden.](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image7.png)](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="5586b-179">[![The Connection Property s Accessibility Level Can Be Configured via the ConnectionModifier Property](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image7.png)](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image6.png)</span></span>

<span data-ttu-id="5586b-180">**Abbildung 4**: die Barrierefreiheits Ebene der `Connection` Eigenschaft kann über die `ConnectionModifier`-Eigenschaft konfiguriert werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="5586b-180">**Figure 4**: The `Connection` Property s Accessibility Level Can Be Configured via the `ConnectionModifier` Property ([Click to view full-size image](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/_static/image8.png))</span></span>

<span data-ttu-id="5586b-181">Speichern Sie das DataSet, und kehren Sie dann zur `ProductsBLL`-Klasse zurück.</span><span class="sxs-lookup"><span data-stu-id="5586b-181">Save the DataSet and then return to the `ProductsBLL` class.</span></span> <span data-ttu-id="5586b-182">Wechseln Sie wie zuvor zu einer der vorhandenen Methoden, und geben Sie `Adapter` ein, und drücken Sie dann die Punkt Taste, um IntelliSense aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="5586b-182">As before, go to one of the existing methods and type in `Adapter` and then hit the period key to bring up IntelliSense.</span></span> <span data-ttu-id="5586b-183">Die Liste sollte eine `Connection`-Eigenschaft enthalten. Dies bedeutet, dass Sie nun Programm gesteuert alle Einstellungen auf Verbindungs Ebene aus der BLL lesen oder zuweisen können.</span><span class="sxs-lookup"><span data-stu-id="5586b-183">The list should include a `Connection` property, meaning that you can now programmatically read or assign any connection-level settings from the BLL.</span></span>

## <a name="step-3-examining-the-command-related-properties"></a><span data-ttu-id="5586b-184">Schritt 3: Untersuchen der Befehls bezogenen Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="5586b-184">Step 3: Examining the Command-Related Properties</span></span>

<span data-ttu-id="5586b-185">Ein TableAdapter besteht aus einer Haupt Abfrage, die standardmäßig automatisch generierte `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen enthält.</span><span class="sxs-lookup"><span data-stu-id="5586b-185">A TableAdapter consists of a main query that, by default, has auto-generated `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="5586b-186">Diese Abfrage `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen werden im TableAdapter-Code als ADO.NET Data Adapter-Objekt über die `Adapter`-Eigenschaft implementiert.</span><span class="sxs-lookup"><span data-stu-id="5586b-186">This main query s `INSERT`, `UPDATE`, and `DELETE` statements are implemented in the TableAdapter s code as an ADO.NET data adapter object via the `Adapter` property.</span></span> <span data-ttu-id="5586b-187">Wie bei der `Connection`-Eigenschaft wird der Datentyp `Adapter` Eigenschaft s vom verwendeten Datenanbieter bestimmt.</span><span class="sxs-lookup"><span data-stu-id="5586b-187">Like with its `Connection` property, the `Adapter` property s data type is determined by the data provider used.</span></span> <span data-ttu-id="5586b-188">Da in diesen Tutorials der SqlClient-Anbieter verwendet wird, ist die `Adapter`-Eigenschaft vom Typ [`SqlDataAdapter`](https://msdn.microsoft.com/library/system.data.sqlclient.sqldataadapter(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="5586b-188">Since these tutorials use the SqlClient provider, the `Adapter` property is of type [`SqlDataAdapter`](https://msdn.microsoft.com/library/system.data.sqlclient.sqldataadapter(VS.80).aspx).</span></span>

<span data-ttu-id="5586b-189">Die Eigenschaft TableAdapter s `Adapter` verfügt über drei Eigenschaften vom Typ `SqlCommand`, mit denen die Anweisungen `INSERT`, `UPDATE`und `DELETE` ausgestellt werden:</span><span class="sxs-lookup"><span data-stu-id="5586b-189">The TableAdapter s `Adapter` property has three properties of type `SqlCommand` that it uses to issue the `INSERT`, `UPDATE`, and `DELETE` statements:</span></span>

- `InsertCommand`
- `UpdateCommand`
- `DeleteCommand`

<span data-ttu-id="5586b-190">Ein `SqlCommand`-Objekt ist dafür verantwortlich, eine bestimmte Abfrage an die Datenbank zu senden, und verfügt über Eigenschaften wie: [`CommandText`](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.commandtext.aspx), das die auszuführende Ad-hoc-SQL-Anweisung oder gespeicherte Prozedur enthält. und [`Parameters`](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.parameters.aspx), bei dem es sich um eine Auflistung von `SqlParameter` Objekten handelt.</span><span class="sxs-lookup"><span data-stu-id="5586b-190">A `SqlCommand` object is responsible for sending a particular query to the database and has properties like: [`CommandText`](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.commandtext.aspx), which contains the ad-hoc SQL statement or stored procedure to execute; and [`Parameters`](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.parameters.aspx), which is a collection of `SqlParameter` objects.</span></span> <span data-ttu-id="5586b-191">Wie bereits im Tutorial [Erstellen einer Datenzugriffs Schicht](../introduction/creating-a-data-access-layer-cs.md) erläutert wurde, können diese Befehls Objekte über die Eigenschaftenfenster angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-191">As we saw back in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial, these command objects can be customized through the Properties window.</span></span>

<span data-ttu-id="5586b-192">Zusätzlich zu seiner Haupt Abfrage kann der TableAdapter eine Variable Anzahl von Methoden enthalten, die, wenn Sie aufgerufen wird, einen angegebenen Befehl an die Datenbank weitergeben.</span><span class="sxs-lookup"><span data-stu-id="5586b-192">In addition to its main query, the TableAdapter can include a variable number of methods that, when invoked, dispatch a specified command to the database.</span></span> <span data-ttu-id="5586b-193">Das Haupt Befehls Objekt der Abfrage s und die Befehls Objekte für alle zusätzlichen Methoden werden in der Eigenschaft TableAdapter s `CommandCollection` gespeichert.</span><span class="sxs-lookup"><span data-stu-id="5586b-193">The main query s command object and the command objects for all additional methods are stored in the TableAdapter s `CommandCollection` property.</span></span>

<span data-ttu-id="5586b-194">Nehmen Sie sich einen Moment Zeit, um sich den Code anzusehen, der vom `ProductsTableAdapter` im `Northwind` Dataset für diese beiden Eigenschaften und deren unterstützende Element Variablen und Hilfsmethoden generiert wurde:</span><span class="sxs-lookup"><span data-stu-id="5586b-194">Let s take a moment to look at the code generated by the `ProductsTableAdapter` in the `Northwind` DataSet for these two properties and their supporting member variables and helper methods:</span></span>

[!code-csharp[Main](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/samples/sample3.cs)]

<span data-ttu-id="5586b-195">Der Code für die `Adapter`-und `CommandCollection` Eigenschaften imitiert genau den Wert der `Connection`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="5586b-195">The code for the `Adapter` and `CommandCollection` properties closely mimics that of the `Connection` property.</span></span> <span data-ttu-id="5586b-196">Es gibt Element Variablen, die die Objekte enthalten, die von den Eigenschaften verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-196">There are member variables that hold the objects used by the properties.</span></span> <span data-ttu-id="5586b-197">Die Eigenschaften `get` Accessoren beginnen, indem Sie überprüfen, ob die entsprechende Element Variable `null`ist.</span><span class="sxs-lookup"><span data-stu-id="5586b-197">The properties `get` accessors start by checking to see if the corresponding member variable is `null`.</span></span> <span data-ttu-id="5586b-198">Wenn dies der Fall ist, wird eine Initialisierungs Methode aufgerufen, die eine Instanz der Element Variablen erstellt und die Haupt Befehls bezogenen Eigenschaften zuweist.</span><span class="sxs-lookup"><span data-stu-id="5586b-198">If so, an initialization method is called which creates an instance of the member variable and assigns the core command-related properties.</span></span>

## <a name="step-4-exposing-command-level-settings"></a><span data-ttu-id="5586b-199">Schritt 4: verfügbar machen von Einstellungen auf Befehls Ebene</span><span class="sxs-lookup"><span data-stu-id="5586b-199">Step 4: Exposing Command-Level Settings</span></span>

<span data-ttu-id="5586b-200">Im Idealfall sollten die Informationen auf Befehls Ebene in der Datenzugriffs Ebene gekapselt bleiben.</span><span class="sxs-lookup"><span data-stu-id="5586b-200">Ideally, the command-level information should remain encapsulated within the Data Access Layer.</span></span> <span data-ttu-id="5586b-201">Sollten diese Informationen in anderen Ebenen der Architektur benötigt werden, können Sie jedoch wie bei den Einstellungen auf Verbindungs Ebene über eine partielle Klasse verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-201">Should this information be needed in other layers of the architecture, however, it can be exposed through a partial class, just like with the connection-level settings.</span></span>

<span data-ttu-id="5586b-202">Da der TableAdapter nur über eine einzige `Connection`-Eigenschaft verfügt, ist der Code zum verfügbar machen von Einstellungen auf Verbindungs Ebene recht unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="5586b-202">Since the TableAdapter only has a single `Connection` property, the code for exposing connection-level settings is fairly straightforward.</span></span> <span data-ttu-id="5586b-203">Das Ändern der Einstellungen auf Befehls Ebene ist etwas komplizierter, da der TableAdapter mehrere Befehls Objekte aufweisen kann: eine `InsertCommand`, `UpdateCommand`und `DeleteCommand`sowie eine Variable Anzahl von Befehls Objekten in der `CommandCollection`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="5586b-203">Things are a bit more complicated when modifying command-level settings because the TableAdapter can have multiple command objects - an `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, along with a variable number of command objects in the `CommandCollection` property.</span></span> <span data-ttu-id="5586b-204">Beim Aktualisieren der Einstellungen auf Befehls Ebene müssen diese Einstellungen an alle Befehls Objekte weitergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-204">When updating command-level settings, these settings will need to be propagated to all of the command objects.</span></span>

<span data-ttu-id="5586b-205">Stellen Sie sich z. b. vor, dass im TableAdapter bestimmte Abfragen vorhanden waren, die eine außergewöhnlich lange Ausführungszeit gedauert haben.</span><span class="sxs-lookup"><span data-stu-id="5586b-205">For example, imagine that there were certain queries in the TableAdapter that took an extraordinary long time to execute.</span></span> <span data-ttu-id="5586b-206">Wenn Sie den TableAdapter verwenden, um eine dieser Abfragen auszuführen, können Sie das Command-Objekt s [`CommandTimeout`-Eigenschaft](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)erhöhen.</span><span class="sxs-lookup"><span data-stu-id="5586b-206">When using the TableAdapter to execute one of those queries, we might want to increase the command object s [`CommandTimeout` property](https://msdn.microsoft.com/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx).</span></span> <span data-ttu-id="5586b-207">Diese Eigenschaft gibt die Anzahl der Sekunden an, die auf die Ausführung des Befehls gewartet werden soll. der Standardwert ist 30.</span><span class="sxs-lookup"><span data-stu-id="5586b-207">This property specifies the number of seconds to wait for the command to execute and defaults to 30.</span></span>

<span data-ttu-id="5586b-208">Fügen Sie die folgende `public` Methode mithilfe der in Schritt 2 erstellten partiellen Klassendatei, die in Schritt 2 (`ProductsTableAdapter.ConnectionAndCommandSettings.cs`) erstellt wurde, der `ProductsDataTable` hinzu, um die Anpassung der `CommandTimeout`-Eigenschaft durch die BLL zuzulassen:</span><span class="sxs-lookup"><span data-stu-id="5586b-208">To allow the `CommandTimeout` property to be adjusted by the BLL, add the following `public` method to the `ProductsDataTable` using the partial class file created in Step 2 (`ProductsTableAdapter.ConnectionAndCommandSettings.cs`):</span></span>

[!code-csharp[Main](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs/samples/sample4.cs)]

<span data-ttu-id="5586b-209">Diese Methode kann von der BLL-oder Präsentationsebene aufgerufen werden, um das Befehls Timeout für alle Befehls Probleme dieser TableAdapter-Instanz festzulegen.</span><span class="sxs-lookup"><span data-stu-id="5586b-209">This method could be invoked from the BLL or Presentation Layer to set the command timeout for all commands issues by that TableAdapter instance.</span></span>

> [!NOTE]
> <span data-ttu-id="5586b-210">Die Eigenschaften "`Adapter`" und "`CommandCollection`" sind als `private`gekennzeichnet, d. h., auf Sie kann nur über Code innerhalb des TableAdapters zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-210">The `Adapter` and `CommandCollection` properties are marked as `private`, meaning they can only be accessed from code within the TableAdapter.</span></span> <span data-ttu-id="5586b-211">Anders als die `Connection`-Eigenschaft können diese Zugriffsmodifizierer nicht konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-211">Unlike the `Connection` property, these access modifiers are not configurable.</span></span> <span data-ttu-id="5586b-212">Wenn Sie Eigenschaften auf Befehls Ebene für andere Ebenen in der Architektur verfügbar machen müssen, müssen Sie daher den oben beschriebenen partiellen Klassen Ansatz verwenden, um eine `public` Methode oder Eigenschaft bereitzustellen, die die `private` Befehls Objekte liest oder schreibt.</span><span class="sxs-lookup"><span data-stu-id="5586b-212">Therefore, if you need to expose command-level properties to other layers in the architecture you must use the partial class approach discussed above to provide a `public` method or property that reads or writes to the `private` command objects.</span></span>

## <a name="summary"></a><span data-ttu-id="5586b-213">Summary</span><span class="sxs-lookup"><span data-stu-id="5586b-213">Summary</span></span>

<span data-ttu-id="5586b-214">Die TableAdapters in einem typisierten DataSet dienen zum Kapseln von Datenzugriffs Details und-Komplexität.</span><span class="sxs-lookup"><span data-stu-id="5586b-214">The TableAdapters within a Typed DataSet serve to encapsulate data access details and complexity.</span></span> <span data-ttu-id="5586b-215">Mithilfe von TableAdapters müssen Sie sich keine Gedanken über das Schreiben von ADO.NET-Code machen, um eine Verbindung mit der Datenbank herzustellen, einen Befehl auszugeben oder die Ergebnisse in eine Datentabelle aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="5586b-215">Using TableAdapters, we do not have to worry about writing ADO.NET code to connect to the database, issue a command, or populate the results into a DataTable.</span></span> <span data-ttu-id="5586b-216">Sie werden alle automatisch für uns verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="5586b-216">It is all handled automatically for us.</span></span>

<span data-ttu-id="5586b-217">Es kann jedoch vorkommen, dass die ADO.net-Besonderheiten auf niedriger Ebene angepasst werden müssen, z. b. das Ändern der Verbindungs Zeichenfolge oder der standardmäßigen Verbindungs-oder Befehls Timeout Werte.</span><span class="sxs-lookup"><span data-stu-id="5586b-217">However, there may be times when we need to customize the low-level ADO.NET specifics, such as changing the connection string or the default connection or command timeout values.</span></span> <span data-ttu-id="5586b-218">Der TableAdapter verfügt über automatisch generierte Eigenschaften vom Typ `Connection`, `Adapter`und `CommandCollection`, diese sind jedoch standardmäßig entweder `internal` oder `private`.</span><span class="sxs-lookup"><span data-stu-id="5586b-218">The TableAdapter has auto-generated `Connection`, `Adapter`, and `CommandCollection` properties, but these are either `internal` or `private`, by default.</span></span> <span data-ttu-id="5586b-219">Diese internen Informationen können verfügbar gemacht werden, indem der TableAdapter mithilfe von partiellen Klassen erweitert wird, um `public` Methoden oder Eigenschaften einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="5586b-219">This internal information can be exposed by extending the TableAdapter using partial classes to include `public` methods or properties.</span></span> <span data-ttu-id="5586b-220">Alternativ kann der TableAdapter s `Connection`-eigenschaftenzugriffsmodifizierer über die Eigenschaft TableAdapter s `ConnectionModifier` konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="5586b-220">Alternatively, the TableAdapter s `Connection` property access modifier can be configured through the TableAdapter s `ConnectionModifier` property.</span></span>

<span data-ttu-id="5586b-221">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="5586b-221">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5586b-222">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="5586b-222">About the Author</span></span>

<span data-ttu-id="5586b-223">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="5586b-223">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5586b-224">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="5586b-224">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5586b-225">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5586b-225">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5586b-226">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5586b-226">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5586b-227">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5586b-227">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5586b-228">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="5586b-228">Special Thanks To</span></span>

<span data-ttu-id="5586b-229">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="5586b-229">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5586b-230">Führende Prüfer für dieses Tutorial waren Burnadette Leigh, S ren Jacob Lauritsen, Teresa Murphy und Hilton geisenow.</span><span class="sxs-lookup"><span data-stu-id="5586b-230">Lead reviewers for this tutorial were Burnadette Leigh, S ren Jacob Lauritsen, Teresa Murphy, and Hilton Geisenow.</span></span> <span data-ttu-id="5586b-231">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="5586b-231">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5586b-232">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5586b-232">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5586b-233">[Zurück](working-with-computed-columns-cs.md)
> [Weiter](protecting-connection-strings-and-other-configuration-information-cs.md)</span><span class="sxs-lookup"><span data-stu-id="5586b-233">[Previous](working-with-computed-columns-cs.md)
[Next](protecting-connection-strings-and-other-configuration-information-cs.md)</span></span>
