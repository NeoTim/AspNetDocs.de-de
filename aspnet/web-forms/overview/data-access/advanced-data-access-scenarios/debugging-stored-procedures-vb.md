---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
title: Debuggen von gespeicherten Prozeduren (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Mit Visual Studio Professional-und Team System-Editionen können Sie Haltepunkte festlegen und gespeicherte Prozeduren in SQL Server schrittweise ausführen, sodass das Debuggen gespeichert wird...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 9ed8ccb5-5f31-4eb4-976d-cabf4b45ca09
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
msc.type: authoredcontent
ms.openlocfilehash: 13d213ef4baf493a4f05a82daae8d2dc3b0aa61b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78443817"
---
# <a name="debugging-stored-procedures-vb"></a><span data-ttu-id="36ab3-103">Definieren von gespeicherten Prozeduren (VB)</span><span class="sxs-lookup"><span data-stu-id="36ab3-103">Debugging Stored Procedures (VB)</span></span>

<span data-ttu-id="36ab3-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="36ab3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="36ab3-105">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) oder [PDF herunterladen](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="36ab3-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) or [Download PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span></span>

> <span data-ttu-id="36ab3-106">Mit Visual Studio Professional und Team System-Editionen können Sie Haltepunkte festlegen und gespeicherte Prozeduren in SQL Server schrittweise ausführen, sodass das Debuggen gespeicherter Prozeduren so einfach wie das Debugging von Anwendungscode</span><span class="sxs-lookup"><span data-stu-id="36ab3-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="36ab3-107">In diesem Tutorial werden das direkte Debuggen und das Debuggen von gespeicherten Prozeduren</span><span class="sxs-lookup"><span data-stu-id="36ab3-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>

## <a name="introduction"></a><span data-ttu-id="36ab3-108">Einführung</span><span class="sxs-lookup"><span data-stu-id="36ab3-108">Introduction</span></span>

<span data-ttu-id="36ab3-109">Visual Studio bietet eine umfassende debuggingdarstellung.</span><span class="sxs-lookup"><span data-stu-id="36ab3-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="36ab3-110">Mit wenigen Tastatureingaben oder Mausklicks können Haltepunkte verwendet werden, um die Ausführung eines Programms zu verhindern und dessen Zustand und Ablauf Steuerung zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="36ab3-111">Neben dem Debuggen von Anwendungscode bietet Visual Studio Unterstützung für das Debuggen gespeicherter Prozeduren in SQL Server</span><span class="sxs-lookup"><span data-stu-id="36ab3-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="36ab3-112">Ebenso wie Breakpoints innerhalb des Codes einer ASP.NET-Code Behind-Klasse oder einer Klasse für die Geschäftslogik Schicht festgelegt werden können, können Sie diese auch in gespeicherten Prozeduren platzieren.</span><span class="sxs-lookup"><span data-stu-id="36ab3-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="36ab3-113">In diesem Tutorial werden die Schritte zum Durchlaufen von gespeicherten Prozeduren aus dem Server-Explorer in Visual Studio und das Festlegen von Haltepunkten erläutert, die beim Aufrufen der gespeicherten Prozedur von der laufenden ASP.NET-Anwendung getroffen werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="36ab3-114">Leider können gespeicherte Prozeduren nur in die Professional-und Team Systems-Versionen von Visual Studio eingecheckt und debuggten werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="36ab3-115">Wenn Sie Visual Web Developer oder die Standardversion von Visual Studio verwenden, sind Sie Willkommen beim Durchlaufen der zum Debuggen gespeicherter Prozeduren erforderlichen Schritte. diese Schritte können jedoch nicht auf Ihrem Computer repliziert werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>

## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="36ab3-116">SQL Server debugkonzepte</span><span class="sxs-lookup"><span data-stu-id="36ab3-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="36ab3-117">Microsoft SQL Server 2005 wurde entwickelt, um die Integration mit der [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx)zu ermöglichen, die von allen .NET-Assemblys verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="36ab3-118">Folglich unterstützt SQL Server 2005 verwaltete Datenbankobjekte.</span><span class="sxs-lookup"><span data-stu-id="36ab3-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="36ab3-119">Das heißt, Sie können Datenbankobjekte wie gespeicherte Prozeduren und benutzerdefinierte Funktionen (User-Defined Functions, UDFs) als Methoden in einer Visual Basic Klasse erstellen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a Visual Basic class.</span></span> <span data-ttu-id="36ab3-120">Dadurch können diese gespeicherten Prozeduren und UDFs Funktionen in den .NET Framework und ihren eigenen benutzerdefinierten Klassen nutzen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="36ab3-121">SQL Server 2005 bietet auch Unterstützung für T-SQL-Datenbankobjekte.</span><span class="sxs-lookup"><span data-stu-id="36ab3-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="36ab3-122">SQL Server 2005 bietet Debugunterstützung sowohl für T-SQL-als auch für verwaltete Datenbankobjekte.</span><span class="sxs-lookup"><span data-stu-id="36ab3-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="36ab3-123">Allerdings können diese Objekte nur über die Editionen Visual Studio 2005 Professional und Team Systems deentschlbelt werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="36ab3-124">In diesem Tutorial untersuchen wir das Debuggen von T-SQL-Datenbankobjekten.</span><span class="sxs-lookup"><span data-stu-id="36ab3-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="36ab3-125">Im nachfolgenden Tutorial wird das Debuggen verwalteter Datenbankobjekte beleuchtet</span><span class="sxs-lookup"><span data-stu-id="36ab3-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="36ab3-126">Die [Übersicht über das T-SQL-und CLR-Debuggen in SQL Server 2005-](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) Blogeintrag aus dem [SQL Server 2005 CLR-Integrationsteam](https://blogs.msdn.com/sqlclr/default.aspx) zeigt die drei Möglichkeiten zum Debuggen von SQL Server 2005-Objekten aus Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="36ab3-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="36ab3-127">**Direct Database Debugging (DDD)** : von Server-Explorer aus können wir alle T-SQL-Datenbankobjekte (z. b. gespeicherte Prozeduren und UDFs) in Einzelschritten ausführen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="36ab3-128">In Schritt 1 wird DDD untersucht.</span><span class="sxs-lookup"><span data-stu-id="36ab3-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="36ab3-129">**Anwendungs Debuggen** : Wir können Breakpoints innerhalb eines Datenbankobjekts festlegen und dann unsere ASP.NET-Anwendung ausführen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="36ab3-130">Wenn das Datenbankobjekt ausgeführt wird, wird der Breakpoint gedrückt und die Steuerung wird an den Debugger übergeben.</span><span class="sxs-lookup"><span data-stu-id="36ab3-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="36ab3-131">Beachten Sie, dass wir beim Anwendungs Debuggen nicht aus dem Anwendungscode in ein Datenbankobjekt springen können.</span><span class="sxs-lookup"><span data-stu-id="36ab3-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="36ab3-132">In diesen gespeicherten Prozeduren oder UDFs müssen die Haltepunkte explizit festgelegt werden, wenn der Debugger angehalten werden soll.</span><span class="sxs-lookup"><span data-stu-id="36ab3-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="36ab3-133">Das Debuggen von Anwendungen wird ab Schritt 2 untersucht.</span><span class="sxs-lookup"><span data-stu-id="36ab3-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="36ab3-134">Das **Debuggen von einer SQL Server Projekt** -Visual Studio Professional und Team System-Editionen umfasst einen SQL Server Projekttyp, der häufig zum Erstellen von verwalteten Datenbankobjekten verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="36ab3-135">Im nächsten Tutorial wird die Verwendung von SQL Server Projekten und das Debuggen Ihres Inhalts untersucht.</span><span class="sxs-lookup"><span data-stu-id="36ab3-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="36ab3-136">Visual Studio kann gespeicherte Prozeduren auf lokalen und Remote SQL Server Instanzen Debuggen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="36ab3-137">Eine lokale SQL Server Instanz ist eine Instanz, die auf demselben Computer wie Visual Studio installiert ist.</span><span class="sxs-lookup"><span data-stu-id="36ab3-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="36ab3-138">Wenn sich die SQL Server Datenbank, die Sie verwenden, nicht auf dem Entwicklungs Computer befindet, wird Sie als Remote Instanz betrachtet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="36ab3-139">Für diese Tutorials verwenden wir lokale SQL Server Instanzen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="36ab3-140">Das Debuggen gespeicherter Prozeduren auf einer Remote Instanz von SQL Server erfordert mehr Konfigurationsschritte als beim Debuggen gespeicherter Prozeduren auf einer</span><span class="sxs-lookup"><span data-stu-id="36ab3-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="36ab3-141">Wenn Sie eine lokale SQL Server-Instanz verwenden, können Sie mit Schritt 1 beginnen und das Tutorial am Ende durcharbeiten.</span><span class="sxs-lookup"><span data-stu-id="36ab3-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="36ab3-142">Wenn Sie jedoch eine Remote SQL Server-Instanz verwenden, müssen Sie zunächst sicherstellen, dass Sie beim Debuggen auf Ihrem Entwicklungs Computer mit einem Windows-Benutzerkonto angemeldet sind, das über eine SQL Server Anmeldung auf der Remote Instanz verfügt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="36ab3-143">Außerdem müssen sowohl dieser Daten Bank Anmelde Name als auch der Daten Bank Anmelde Name, der zum Herstellen der Verbindung mit der Datenbank aus der laufenden ASP.NET-Anwendung verwendet wird, Mitglieder der `sysadmin` Rolle sein.</span><span class="sxs-lookup"><span data-stu-id="36ab3-143">Moreover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="36ab3-144">Weitere Informationen zum Konfigurieren von Visual Studio und SQL Server zum Debuggen einer Remote Instanz finden Sie im Abschnitt Debuggen von T-SQL-Datenbankobjekten auf Remote Instanzen am Ende dieses Tutorials.</span><span class="sxs-lookup"><span data-stu-id="36ab3-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="36ab3-145">Beachten Sie, dass die Debugunterstützung für T-SQL-Datenbankobjekte nicht so umfangreich ist wie die Debugunterstützung für .NET-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="36ab3-146">Haltepunkt Bedingungen und Filter werden z. b. nicht unterstützt, nur eine Teilmenge der Debuggingfenster ist verfügbar, Sie können "Bearbeiten und Fortfahren" nicht verwenden, das direkt Fenster wird als nutzlos gerendert usw.</span><span class="sxs-lookup"><span data-stu-id="36ab3-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="36ab3-147">Weitere Informationen finden Sie [unter Einschränkungen bei Debugger-Befehlen und-Funktionen](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="36ab3-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="36ab3-148">Schritt 1: direktes durchlaufen einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="36ab3-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="36ab3-149">Visual Studio erleichtert das direkte Debuggen eines Datenbankobjekts.</span><span class="sxs-lookup"><span data-stu-id="36ab3-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="36ab3-150">Sehen Sie sich an, wie Sie das Feature "Direct Database Debugging" (DDD) verwenden, um die gespeicherte Prozedur `Products_SelectByCategoryID` in der Northwind-Datenbank schrittweise auszuführen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="36ab3-151">Wie der Name schon sagt, gibt `Products_SelectByCategoryID` Produktinformationen für eine bestimmte Kategorie zurück. Es wurde im Tutorial [Verwenden vorhandener gespeicherter Prozeduren für das typisierte DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) erstellt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="36ab3-152">Wechseln Sie zunächst zum Server-Explorer, und erweitern Sie den Datenbankknoten Northwind.</span><span class="sxs-lookup"><span data-stu-id="36ab3-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="36ab3-153">Führen Sie als nächstes einen Drilldown zum Ordner gespeicherte Prozeduren aus, klicken Sie mit der rechten Maustaste auf die gespeicherte Prozedur `Products_SelectByCategoryID`, und wählen Sie im Kontextmenü die Option Einzelschritt in gespeicherte Prozedur aus.</span><span class="sxs-lookup"><span data-stu-id="36ab3-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="36ab3-154">Dadurch wird der Debugger gestartet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-154">This will start the debugger.</span></span>

<span data-ttu-id="36ab3-155">Da die gespeicherte Prozedur `Products_SelectByCategoryID` einen `@CategoryID` Eingabeparameter erwartet, werden wir aufgefordert, diesen Wert anzugeben.</span><span class="sxs-lookup"><span data-stu-id="36ab3-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="36ab3-156">Geben Sie 1 ein, wodurch Informationen zu den Getränken zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-156">Enter 1, which will return information about the beverages.</span></span>

![Verwenden Sie den Wert 1 für den @CategoryID-Parameter.](debugging-stored-procedures-vb/_static/image1.png)

<span data-ttu-id="36ab3-158">**Abbildung 1**: Verwenden des Werts 1 für den `@CategoryID`-Parameter</span><span class="sxs-lookup"><span data-stu-id="36ab3-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>

<span data-ttu-id="36ab3-159">Nachdem der Wert für den `@CategoryID`-Parameter angegeben wurde, wird die gespeicherte Prozedur ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="36ab3-160">Anstatt bis zum Abschluss auszuführen, hält der Debugger die Ausführung bei der ersten Anweisung an.</span><span class="sxs-lookup"><span data-stu-id="36ab3-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="36ab3-161">Notieren Sie sich den gelben Pfeil im Rand, der den aktuellen Speicherort in der gespeicherten Prozedur angibt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="36ab3-162">Sie können Parameterwerte über die Überwachungsfenster anzeigen und bearbeiten oder indem Sie in der gespeicherten Prozedur auf den Parameternamen zeigen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>

<span data-ttu-id="36ab3-163">[![der Debugger bei der ersten Anweisung der gespeicherten Prozedur angehalten wurde.](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span></span>

<span data-ttu-id="36ab3-164">**Abbildung 2**: der Debugger wurde bei der ersten Anweisung der gespeicherten Prozedur angehalten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="36ab3-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image4.png))</span></span>

<span data-ttu-id="36ab3-165">Klicken Sie in der Symbolleiste auf die Schaltfläche Prozedur Schritt, oder drücken Sie die Taste F10, um die gespeicherte Prozedur schrittweise durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="36ab3-166">Die gespeicherte Prozedur `Products_SelectByCategoryID` enthält eine einzige `SELECT` Anweisung. durch Drücken von F10 wird also die einzige Anweisung überschritten, und die Ausführung der gespeicherten Prozedur wird beendet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="36ab3-167">Nachdem die gespeicherte Prozedur abgeschlossen wurde, wird die Ausgabe im Fenster Ausgabe angezeigt, und der Debugger wird beendet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="36ab3-168">T-SQL-Debugging erfolgt auf Anweisungs Ebene. Sie können eine `SELECT` Anweisung nicht in Einzelschritten ausführen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-168">T-SQL debugging occurs at the statement level; you cannot step into a `SELECT` statement.</span></span>

## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="36ab3-169">Schritt 2: Konfigurieren der Website für das Debuggen von Anwendungen</span><span class="sxs-lookup"><span data-stu-id="36ab3-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="36ab3-170">Das Debuggen einer gespeicherten Prozedur direkt aus der Server-Explorer ist praktisch, aber in vielen Szenarios sind Sie eher daran interessiert, die gespeicherte Prozedur zu debuggen, wenn Sie von der ASP.NET-Anwendung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="36ab3-171">Wir können einer gespeicherten Prozedur Haltepunkte in Visual Studio hinzufügen und dann mit dem Debuggen der ASP.NET-Anwendung beginnen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="36ab3-172">Wenn eine gespeicherte Prozedur mit Breakpoints von der Anwendung aufgerufen wird, wird die Ausführung am Haltepunkt angehalten, und wir können die Parameterwerte der gespeicherten Prozedur anzeigen und ändern und die zugehörigen Anweisungen schrittweise durchlaufen, wie in Schritt 1.</span><span class="sxs-lookup"><span data-stu-id="36ab3-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="36ab3-173">Bevor wir mit dem Debuggen von gespeicherten Prozeduren beginnen können, die von der Anwendung aufgerufen werden, müssen wir die ASP.NET-Webanwendung anweisen, in den SQL Server Debugger</span><span class="sxs-lookup"><span data-stu-id="36ab3-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="36ab3-174">Klicken Sie zunächst mit der rechten Maustaste auf den Namen der Website im Projektmappen-Explorer (`ASPNET_Data_Tutorial_74_VB`).</span><span class="sxs-lookup"><span data-stu-id="36ab3-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_VB`).</span></span> <span data-ttu-id="36ab3-175">Wählen Sie im Kontextmenü die Option Eigenschaften Seiten aus, wählen Sie auf der linken Seite die Option Start Optionen aus, und aktivieren Sie das Kontrollkästchen SQL Server im Abschnitt Debuggers (siehe Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="36ab3-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>

<span data-ttu-id="36ab3-176">[![aktivieren Sie das Kontrollkästchen SQL Server in den Eigenschaften Seiten der Anwendung.](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span></span>

<span data-ttu-id="36ab3-177">**Abbildung 3**: Aktivieren Sie das Kontrollkästchen "SQL Server" in den Eigenschaften Seiten der Anwendung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image7.png)).</span><span class="sxs-lookup"><span data-stu-id="36ab3-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image7.png))</span></span>

<span data-ttu-id="36ab3-178">Außerdem müssen wir die Daten bankverbindungs Zeichenfolge aktualisieren, die von der Anwendung verwendet wird, damit das Verbindungspooling deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="36ab3-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="36ab3-179">Wenn eine Verbindung mit einer Datenbank geschlossen wird, wird das entsprechende `SqlConnection` Objekt in einem Pool verfügbarer Verbindungen platziert.</span><span class="sxs-lookup"><span data-stu-id="36ab3-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="36ab3-180">Beim Herstellen einer Verbindung mit einer Datenbank kann ein verfügbares Verbindungs Objekt aus diesem Pool abgerufen werden, anstatt eine neue Verbindung erstellen und einrichten zu müssen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="36ab3-181">Dieses Pooling von Verbindungs Objekten ist eine Leistungsverbesserung und ist standardmäßig aktiviert.</span><span class="sxs-lookup"><span data-stu-id="36ab3-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="36ab3-182">Beim Debuggen soll das Verbindungspooling jedoch deaktiviert werden, da die debugginginfrastruktur nicht ordnungsgemäß wieder hergestellt wird, wenn eine Verbindung hergestellt wird, die aus dem Pool entnommen wurde.</span><span class="sxs-lookup"><span data-stu-id="36ab3-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="36ab3-183">Um das Verbindungspooling zu deaktivieren, aktualisieren Sie das `NORTHWNDConnectionString` in `Web.config`, sodass es die Einstellung `Pooling=false` enthält.</span><span class="sxs-lookup"><span data-stu-id="36ab3-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>

[!code-xml[Main](debugging-stored-procedures-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="36ab3-184">Wenn Sie das debugSQL Server gen durch die ASP.NET-Anwendung abgeschlossen haben, stellen Sie sicher, dass Sie das Verbindungspooling wiederherstellen, indem Sie die `Pooling` Einstellung aus der Verbindungs Zeichenfolge entfernen (oder indem Sie Sie auf `Pooling=true`</span><span class="sxs-lookup"><span data-stu-id="36ab3-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>

<span data-ttu-id="36ab3-185">An diesem Punkt wurde die ASP.NET-Anwendung so konfiguriert, dass Visual Studio SQL Server Datenbankobjekte Debuggen kann, wenn Sie über die Webanwendung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="36ab3-186">Jetzt müssen Sie nur noch einen Haltepunkt zu einer gespeicherten Prozedur hinzufügen und mit dem Debuggen beginnen!</span><span class="sxs-lookup"><span data-stu-id="36ab3-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="36ab3-187">Schritt 3: Hinzufügen eines Breakpoints und Debuggens</span><span class="sxs-lookup"><span data-stu-id="36ab3-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="36ab3-188">Öffnen Sie die gespeicherte Prozedur `Products_SelectByCategoryID`, und legen Sie am Anfang der `SELECT` Anweisung einen Haltepunkt fest, indem Sie am entsprechenden Speicherort auf den Rand klicken oder den Cursor am Anfang der `SELECT`-Anweisung platzieren und F9 drücken.</span><span class="sxs-lookup"><span data-stu-id="36ab3-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="36ab3-189">Wie in Abbildung 4 dargestellt, wird der Breakpoint als roter Kreis im Rand angezeigt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>

<span data-ttu-id="36ab3-190">[![einen Haltepunkt in der Products_SelectByCategoryID gespeicherten Prozedur fest.](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span></span>

<span data-ttu-id="36ab3-191">**Abbildung 4**: Festlegen eines Breakpoints in der gespeicherten Prozedur `Products_SelectByCategoryID` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="36ab3-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image10.png))</span></span>

<span data-ttu-id="36ab3-192">Damit ein SQL-Datenbankobjekt über eine Client Anwendung debuggt werden kann, ist es zwingend erforderlich, dass die Datenbank so konfiguriert wird, dass das Anwendungs Debugging unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="36ab3-193">Wenn Sie zum ersten Mal einen Haltepunkt festlegen, sollte diese Einstellung automatisch aktiviert werden, aber es ist ratsam, Sie zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="36ab3-194">Klicken Sie mit der rechten Maustaste auf den Knoten `NORTHWND.MDF` in der Server-Explorer.</span><span class="sxs-lookup"><span data-stu-id="36ab3-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="36ab3-195">Das Kontextmenü sollte ein aktiviertes Menü Element namens Anwendungs Debuggen enthalten.</span><span class="sxs-lookup"><span data-stu-id="36ab3-195">The context menu should include a checked menu item named Application Debugging .</span></span>

![Sicherstellen, dass die Option zum Debuggen von Anwendungen](debugging-stored-procedures-vb/_static/image11.png)

<span data-ttu-id="36ab3-197">**Abbildung 5**: sicherstellen, dass die Option zum Debuggen von Anwendungen aktiviert</span><span class="sxs-lookup"><span data-stu-id="36ab3-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>

<span data-ttu-id="36ab3-198">Wenn die Haltepunkt Gruppe und die Option zum Debuggen von Anwendungen aktiviert sind, können Sie die gespeicherte Prozedur Debuggen, wenn Sie von der ASP.NET-Anwendung aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="36ab3-199">Starten Sie den Debugger, indem Sie im Menü Debuggen die Option Debuggen starten auswählen, drücken Sie F5, oder klicken Sie auf das grüne Wiedergabe Symbol auf der Symbolleiste.</span><span class="sxs-lookup"><span data-stu-id="36ab3-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="36ab3-200">Dadurch wird der Debugger gestartet und die Website gestartet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="36ab3-201">Die gespeicherte Prozedur `Products_SelectByCategoryID` wurde im Tutorial [Verwenden vorhandener gespeicherter Prozeduren für das typisierte DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) erstellt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="36ab3-202">Die zugehörige Webseite (`~/AdvancedDAL/ExistingSprocs.aspx`) enthält eine GridView, in der die von dieser gespeicherten Prozedur zurückgegebenen Ergebnisse angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="36ab3-203">Besuchen Sie diese Seite über den Browser.</span><span class="sxs-lookup"><span data-stu-id="36ab3-203">Visit this page through the browser.</span></span> <span data-ttu-id="36ab3-204">Wenn Sie die Seite erreichen, wird der Breakpoint in der `Products_SelectByCategoryID` gespeicherten Prozedur erreicht und die Steuerung an Visual Studio zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="36ab3-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="36ab3-205">Ebenso wie in Schritt 1 können Sie die Anweisungen der gespeicherten Prozedur durchlaufen und die Parameterwerte anzeigen und ändern.</span><span class="sxs-lookup"><span data-stu-id="36ab3-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>

<span data-ttu-id="36ab3-206">[![auf der Seite existingsprocs. aspx werden zunächst die Getränke angezeigt.](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span></span>

<span data-ttu-id="36ab3-207">**Abbildung 6**: auf der Seite "`ExistingSprocs.aspx`" werden zunächst die Getränke angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="36ab3-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image14.png))</span></span>

<span data-ttu-id="36ab3-208">[![der Breakpoint der gespeicherten Prozedur wurde erreicht.](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span></span>

<span data-ttu-id="36ab3-209">**Abbildung 7**: der Breakpoint der gespeicherten Prozedur wurde erreicht ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="36ab3-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-vb/_static/image17.png))</span></span>

<span data-ttu-id="36ab3-210">Wie das Überwachungsfenster in Abbildung 7 zeigt, ist der Wert des `@CategoryID`-Parameters 1.</span><span class="sxs-lookup"><span data-stu-id="36ab3-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="36ab3-211">Dies liegt daran, dass auf der `ExistingSprocs.aspx` Seite anfänglich Produkte in der Kategorie Getränke angezeigt werden, die den `CategoryID` Wert 1 aufweist.</span><span class="sxs-lookup"><span data-stu-id="36ab3-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="36ab3-212">Wählen Sie eine andere Kategorie aus der Dropdown Liste aus.</span><span class="sxs-lookup"><span data-stu-id="36ab3-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="36ab3-213">Dies führt zu einem Postback und führt die gespeicherte Prozedur `Products_SelectByCategoryID` erneut aus.</span><span class="sxs-lookup"><span data-stu-id="36ab3-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="36ab3-214">Der Breakpoint wird wiederholt, aber dieses Mal gibt der Wert des `@CategoryID`-Parameters den ausgewählten Dropdown Listenelement-`CategoryID`an.</span><span class="sxs-lookup"><span data-stu-id="36ab3-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>

<span data-ttu-id="36ab3-215">[![wählen Sie eine andere Kategorie aus der Dropdown Liste aus.](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span></span>

<span data-ttu-id="36ab3-216">**Abbildung 8**: Auswählen einer anderen Kategorie aus der Dropdown Liste ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="36ab3-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-vb/_static/image20.png))</span></span>

<span data-ttu-id="36ab3-217">[![der @CategoryID Parameter die von der Webseite ausgewählte Kategorie widerspiegelt.](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="36ab3-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span></span>

<span data-ttu-id="36ab3-218">**Abbildung 9**: der `@CategoryID` Parameter spiegelt die von der Webseite ausgewählte Kategorie wider ([Klicken Sie, um das Bild in voller Größe anzuzeigen](debugging-stored-procedures-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="36ab3-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-vb/_static/image23.png))</span></span>

> [!NOTE]
> <span data-ttu-id="36ab3-219">Wenn der Haltepunkt in der `Products_SelectByCategoryID` gespeicherten Prozedur beim Aufrufen der `ExistingSprocs.aspx` Seite nicht angezeigt wird, stellen Sie sicher, dass das Kontrollkästchen SQL Server im Abschnitt Debuggers der Eigenschaften Seite der ASP.NET-Anwendung aktiviert ist, dass das Verbindungspooling deaktiviert wurde und dass die Option zum Debuggen von Datenbankanwendungen aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="36ab3-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="36ab3-220">Wenn weiterhin Probleme auftreten, starten Sie Visual Studio neu, und versuchen Sie es erneut.</span><span class="sxs-lookup"><span data-stu-id="36ab3-220">If you re still having problems, restart Visual Studio and try again.</span></span>

## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="36ab3-221">Debuggen von T-SQL-Datenbankobjekten auf Remote Instanzen</span><span class="sxs-lookup"><span data-stu-id="36ab3-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="36ab3-222">Das Debuggen von Datenbankobjekten über Visual Studio ist recht unkompliziert, wenn sich die SQL Server-Daten Bank Instanz auf demselben Computer wie Visual Studio befindet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="36ab3-223">Wenn sich SQL Server und Visual Studio jedoch auf unterschiedlichen Computern befinden, ist eine sorgfältige Konfiguration erforderlich, damit alles ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="36ab3-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="36ab3-224">Es gibt zwei grundlegende Aufgaben, mit denen wir konfrontiert sind:</span><span class="sxs-lookup"><span data-stu-id="36ab3-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="36ab3-225">Stellen Sie sicher, dass der Anmelde Name, der für die Verbindung mit der Datenbank über ADO.NET verwendet wird, zur `sysadmin` Rolle gehört</span><span class="sxs-lookup"><span data-stu-id="36ab3-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="36ab3-226">Stellen Sie sicher, dass das Windows-Benutzerkonto, das von Visual Studio auf dem Entwicklungs Computer verwendet wird, ein gültiges SQL Server Anmelde Konto ist, das zur `sysadmin` Rolle gehört.</span><span class="sxs-lookup"><span data-stu-id="36ab3-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="36ab3-227">Der erste Schritt ist relativ unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="36ab3-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="36ab3-228">Identifizieren Sie zunächst das Benutzerkonto, das zum Herstellen einer Verbindung mit der Datenbank aus der ASP.NET-Anwendung verwendet wird, und fügen Sie dann von SQL Server Management Studio dieses Anmelde Konto der `sysadmin`-Rolle hinzu.</span><span class="sxs-lookup"><span data-stu-id="36ab3-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="36ab3-229">Die zweite Aufgabe erfordert, dass das Windows-Benutzerkonto, das Sie zum Debuggen der Anwendung verwenden, ein gültiger Anmelde Name in der Remote Datenbank ist.</span><span class="sxs-lookup"><span data-stu-id="36ab3-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="36ab3-230">Allerdings ist die Wahrscheinlichkeit, dass das Windows-Konto, mit dem Sie sich bei Ihrer Arbeitsstation angemeldet haben, keine gültige Anmeldung auf SQL Server.</span><span class="sxs-lookup"><span data-stu-id="36ab3-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="36ab3-231">Anstatt ihr bestimmtes Anmelde Konto SQL Server hinzuzufügen, empfiehlt es sich, ein Windows-Benutzerkonto als SQL Server Debugging-Konto festzulegen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="36ab3-232">Wenn Sie dann die Datenbankobjekte einer Remote SQL Server Instanz debuggen möchten, führen Sie Visual Studio mit den Anmelde Informationen für das Windows-Anmelde Konto aus.</span><span class="sxs-lookup"><span data-stu-id="36ab3-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="36ab3-233">Ein Beispiel sollte Ihnen helfen, Dinge zu verdeutlichen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-233">An example should help clarify things.</span></span> <span data-ttu-id="36ab3-234">Stellen Sie sich vor, dass in der Windows-Domäne ein Windows-Konto namens `SQLDebug` vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="36ab3-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="36ab3-235">Dieses Konto muss der Remote SQL Server Instanz als gültiger Anmelde Name und als Mitglied der `sysadmin`-Rolle hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="36ab3-236">Um die Remote SQL Server Instanz von Visual Studio aus zu debuggen, müssen wir Visual Studio als `SQLDebug` Benutzer ausführen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="36ab3-237">Zu diesem Zweck können Sie sich von der Arbeitsstation abmelden, sich als `SQLDebug`wieder anmelden und dann Visual Studio starten. ein einfacherer Ansatz wäre jedoch, sich mit unseren eigenen Anmelde Informationen bei der Arbeitsstation anzumelden und dann `runas.exe` zu starten, um Visual Studio als `SQLDebug` Benutzer zu starten.</span><span class="sxs-lookup"><span data-stu-id="36ab3-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="36ab3-238">`runas.exe` ermöglicht die Ausführung einer bestimmten Anwendung im Rahmen eines anderen Benutzerkontos.</span><span class="sxs-lookup"><span data-stu-id="36ab3-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="36ab3-239">Wenn Sie Visual Studio als `SQLDebug`starten möchten, können Sie die folgende Anweisung in der Befehlszeile eingeben:</span><span class="sxs-lookup"><span data-stu-id="36ab3-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>

[!code-console[Main](debugging-stored-procedures-vb/samples/sample2.cmd)]

<span data-ttu-id="36ab3-240">Eine ausführlichere Erläuterung zu diesem Prozess finden Sie unter " [William R. Vaughn](http://betav.com/BLOG/billva/) s" *-Handbuch zu Visual Studio und SQL Server, Siebte Edition* sowie Gewusst wie [: Festlegen von SQL Server Berechtigungen für das Debuggen](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="36ab3-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="36ab3-241">Wenn auf Ihrem Entwicklungs Computer Windows XP Service Pack 2 ausgeführt wird, müssen Sie die Internet Connection Firewall so konfigurieren, dass Remote Debugging zugelassen wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="36ab3-242">[Im Artikel Gewusst wie: Aktivieren von SQL Server 2005-Debuggen](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) wird beschrieben, dass dies zwei Schritte umfasst: (a) auf dem Visual Studio-Host Computer müssen Sie `Devenv.exe` zur Ausnahmeliste hinzufügen und den TCP 135-Port öffnen. und (b) auf dem Remote Computer (SQL) müssen Sie den TCP 135-Port öffnen und der Ausnahmeliste `sqlservr.exe` hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="36ab3-243">Wenn Ihre Domänen Richtlinie die Netzwerkkommunikation über IPSec erfordert, müssen Sie die Ports UDP 4500 und UDP 500 öffnen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>

## <a name="summary"></a><span data-ttu-id="36ab3-244">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="36ab3-244">Summary</span></span>

<span data-ttu-id="36ab3-245">Neben der Unterstützung von Debuggingunterstützung für .NET-Anwendungscode bietet Visual Studio auch eine Vielzahl von Debugoptionen für SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="36ab3-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="36ab3-246">In diesem Tutorial haben wir zwei der folgenden Optionen untersucht: direktes Debuggen von Datenbanken und Anwendungs Debuggen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="36ab3-247">Zum direkten Debuggen eines T-SQL-Datenbankobjekts suchen Sie das Objekt über die Server-Explorer klicken Sie dann mit der rechten Maustaste darauf, und wählen Sie Einzelschritt aus.</span><span class="sxs-lookup"><span data-stu-id="36ab3-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="36ab3-248">Dadurch wird der Debugger gestartet und bei der ersten Anweisung im Datenbankobjekt angehalten. an diesem Punkt können Sie die Objekt-e-Anweisungen schrittweise durchlaufen und Parameterwerte anzeigen und ändern.</span><span class="sxs-lookup"><span data-stu-id="36ab3-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="36ab3-249">In Schritt 1 haben wir diese Vorgehensweise verwendet, um die gespeicherte Prozedur `Products_SelectByCategoryID` schrittweise auszuführen.</span><span class="sxs-lookup"><span data-stu-id="36ab3-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="36ab3-250">Beim Anwendungs Debuggen können Breakpoints direkt innerhalb der Datenbankobjekte festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="36ab3-251">Wenn ein Datenbankobjekt mit Breakpoints von einer Client Anwendung (z. b. einer ASP.NET-Webanwendung) aufgerufen wird, wird das Programm angehalten, während der Debugger Sie übernimmt.</span><span class="sxs-lookup"><span data-stu-id="36ab3-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="36ab3-252">Das Debuggen von Anwendungen ist nützlich, da es deutlicher anzeigt, welche Anwendungs Aktion bewirkt, dass ein bestimmtes Datenbankobjekt aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="36ab3-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="36ab3-253">Es ist jedoch etwas mehr Konfiguration und Einrichtung als das direkte Debuggen von Datenbanken erforderlich.</span><span class="sxs-lookup"><span data-stu-id="36ab3-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="36ab3-254">Datenbankobjekte können auch über SQL Server Projekte deentschlbelt werden.</span><span class="sxs-lookup"><span data-stu-id="36ab3-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="36ab3-255">Im nächsten Tutorial wird die Verwendung von SQL Server Projekten und deren Verwendung zum Erstellen und Debuggen verwalteter Datenbankobjekte erläutert.</span><span class="sxs-lookup"><span data-stu-id="36ab3-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="36ab3-256">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="36ab3-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="36ab3-257">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="36ab3-257">About the Author</span></span>

<span data-ttu-id="36ab3-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="36ab3-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="36ab3-259">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="36ab3-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="36ab3-260">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="36ab3-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="36ab3-261">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="36ab3-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="36ab3-262">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="36ab3-262">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="36ab3-263">[Zurück](protecting-connection-strings-and-other-configuration-information-vb.md)
> [Weiter](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span><span class="sxs-lookup"><span data-stu-id="36ab3-263">[Previous](protecting-connection-strings-and-other-configuration-information-vb.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span></span>
