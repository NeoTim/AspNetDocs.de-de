---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Aktualisieren des TableAdapter für die Verwendung von Joins (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Beim Arbeiten mit einer Datenbank ist es üblich, Daten anzufordern, die auf mehrere Tabellen verteilt sind. Zum Abrufen von Daten aus zwei verschiedenen Tabellen können wir beide...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c94baa99b126cdd24d69afc3d02bfe8b069419b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78427527"
---
# <a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="55ea5-104">Aktualisieren des TableAdapter-Steuerelements für die Verwendung von Verknüpfungen (VB)</span><span class="sxs-lookup"><span data-stu-id="55ea5-104">Updating the TableAdapter to Use JOINs (VB)</span></span>

<span data-ttu-id="55ea5-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="55ea5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="55ea5-106">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) oder [PDF herunterladen](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="55ea5-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="55ea5-107">Beim Arbeiten mit einer Datenbank ist es üblich, Daten anzufordern, die auf mehrere Tabellen verteilt sind.</span><span class="sxs-lookup"><span data-stu-id="55ea5-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="55ea5-108">Zum Abrufen von Daten aus zwei verschiedenen Tabellen können wir entweder eine korrelierte Unterabfrage oder eine Join-Operation verwenden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="55ea5-109">In diesem Tutorial vergleichen Sie korrelierte Unterabfragen und die joinsyntax, bevor Sie sehen, wie Sie einen TableAdapter erstellen, der einen Join in der Haupt Abfrage enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="55ea5-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="55ea5-110">Introduction</span></span>

<span data-ttu-id="55ea5-111">Bei relationalen Datenbanken sind die Daten, mit denen wir arbeiten möchten, häufig auf mehrere Tabellen verteilt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="55ea5-112">Wenn Sie z. b. Produktinformationen anzeigen, möchten wir wahrscheinlich jeden Produkt die entsprechenden Kategorien und Lieferanten Namen auflisten.</span><span class="sxs-lookup"><span data-stu-id="55ea5-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="55ea5-113">Die `Products` Tabelle enthält `CategoryID`-und `SupplierID` Werte, aber die tatsächlichen Kategorie-und Lieferanten Namen befinden sich jeweils in den Tabellen `Categories` und `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="55ea5-114">Zum Abrufen von Informationen aus einer anderen verknüpften Tabelle können wir entweder *korrelierte Unterabfragen* oder `JOIN`*s*verwenden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="55ea5-115">Eine korrelierte Unterabfrage ist eine `SELECT` Abfrage, die auf Spalten in der äußeren Abfrage verweist.</span><span class="sxs-lookup"><span data-stu-id="55ea5-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="55ea5-116">Beispielsweise wurden im Tutorial [Erstellen einer Datenzugriffs Ebene](../introduction/creating-a-data-access-layer-vb.md) zwei korrelierte Unterabfragen in der Haupt Abfrage `ProductsTableAdapter` s verwendet, um die Kategorien-und Lieferanten Namen für jedes Produkt zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="55ea5-117">Ein `JOIN` ist ein SQL-Konstrukt, mit dem verknüpfte Zeilen aus zwei verschiedenen Tabellen zusammengeführt werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="55ea5-118">Wir haben eine `JOIN` im Tutorial [Abfragen von Daten mit dem SqlDataSource-Steuer](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) Element verwendet, um neben den einzelnen Produkten Kategorieinformationen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="55ea5-119">Der Grund für die Verwendung von `JOIN` s mit TableAdapters liegt darin, dass der TableAdapter s-Assistent für die automatische Generierung entsprechender `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="55ea5-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="55ea5-120">Genauer gesagt: Wenn die Haupt Abfrage des TableAdapter s `JOIN` s enthält, kann der TableAdapter die Ad-hoc-SQL-Anweisungen oder gespeicherten Prozeduren für die `InsertCommand`-, `UpdateCommand`-und `DeleteCommand` Eigenschaften nicht automatisch erstellen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="55ea5-121">In diesem Tutorial vergleichen und vergleichen Sie korrelierte Unterabfragen und `JOIN` en kurz vor dem Erstellen eines TableAdapter, der `JOIN` s in der Haupt Abfrage enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="55ea5-122">Vergleichen und vergleichen korrelierter Unterabfragen und`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="55ea5-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="55ea5-123">Beachten Sie, dass die `ProductsTableAdapter`, die im ersten Lernprogramm im `Northwind` DataSet erstellt werden, korrelierte Unterabfragen verwendet, um die entsprechenden Kategorie-und Lieferanten Namen für die einzelnen Produkte zurückzuführen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="55ea5-124">Die Haupt Abfrage `ProductsTableAdapter` s ist unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="55ea5-125">Die beiden korrelierten Unterabfragen-`(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` und `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` sind `SELECT` Abfragen, die einen einzelnen Wert pro Produkt als zusätzliche Spalte in der Spaltenliste der äußeren `SELECT` Anweisung zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="55ea5-126">Alternativ kann ein `JOIN` verwendet werden, um die einzelnen Lieferanten und Kategorien amen der Produkte zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="55ea5-127">Die folgende Abfrage gibt dieselbe Ausgabe wie die obige aus, verwendet jedoch `JOIN` s anstelle von Unterabfragen:</span><span class="sxs-lookup"><span data-stu-id="55ea5-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="55ea5-128">Mit einem `JOIN` werden die Datensätze aus einer Tabelle mit Datensätzen aus einer anderen Tabelle basierend auf einigen Kriterien zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="55ea5-129">In der obigen Abfrage weist z. b. die `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` SQL Server an, jeden Produktdaten Satz mit dem Kategoriedatensatz zusammenzuführen, dessen `CategoryID` Wert mit dem `CategoryID` Wert des Produkts übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="55ea5-130">Mit dem zusammengeführten Ergebnis können wir mit den entsprechenden Kategoriefeldern für jedes Produkt arbeiten (z. b. `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="55ea5-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="55ea5-131">`JOIN` s werden häufig beim Abfragen von Daten aus relationalen Datenbanken verwendet.</span><span class="sxs-lookup"><span data-stu-id="55ea5-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="55ea5-132">Wenn Sie mit der `JOIN`-Syntax noch nicht vertraut sind oder ein bisschen auf die Verwendung von Pinseln müssen, empfiehlt es sich, das [SQL Join-Tutorial](http://www.w3schools.com/sql/sql_join.asp) bei [W3 Schools](http://www.w3schools.com/)zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="55ea5-133">Lesen Sie außerdem die Abschnitte [`JOIN` Grundlagen](https://msdn.microsoft.com/library/ms191517.aspx) und [Unterabfragen](https://msdn.microsoft.com/library/ms189575.aspx) der [SQL-Online](https://msdn.microsoft.com/library/ms130214.aspx)Dokumentation.</span><span class="sxs-lookup"><span data-stu-id="55ea5-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="55ea5-134">Da `JOIN` s und korrelierte Unterabfragen zum Abrufen von verknüpften Daten aus anderen Tabellen verwendet werden können, bleiben viele Entwickler an den Köpfen und Fragen sich, welcher Ansatz verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="55ea5-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="55ea5-135">Alle SQL-Gurus, mit denen ich gesprochen habe, haben ungefähr das gleiche gesagt, dass es keine Rolle spielt, da SQL Server ungefähr identische Ausführungspläne erzeugt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="55ea5-136">Ihre Ratschläge sind dann die Methode, mit der Sie und Ihr Team am bequemsten sind.</span><span class="sxs-lookup"><span data-stu-id="55ea5-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="55ea5-137">Es ist zu beachten, dass diese Experten nach dem Durchlaufen dieser Ratschläge sofort Ihre Präferenz `JOIN` s über korrelierte Unterabfragen ausgedrückt haben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="55ea5-138">Beim Aufbau einer Datenzugriffs Ebene mithilfe typisierter Datasets funktionieren die Tools besser, wenn Unterabfragen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="55ea5-139">Der TableAdapter s-Assistent generiert die entsprechenden `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen nicht automatisch, wenn die Haupt Abfrage `JOIN` s enthält. diese Anweisungen werden jedoch automatisch generiert, wenn korrelierte Unterabfragen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="55ea5-140">Um dieses Manko zu untersuchen, erstellen Sie ein temporäres typisiertes DataSet im `~/App_Code/DAL` Ordner.</span><span class="sxs-lookup"><span data-stu-id="55ea5-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="55ea5-141">Wählen Sie im TableAdapter-Konfigurations-Assistenten aus, dass Sie Ad-hoc-SQL-Anweisungen verwenden, und geben Sie die folgende `SELECT` Abfrage ein (siehe Abbildung 1):</span><span class="sxs-lookup"><span data-stu-id="55ea5-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]

<span data-ttu-id="55ea5-142">[![geben Sie eine Haupt Abfrage ein, die Joins enthält.](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="55ea5-143">**Abbildung 1**: Geben Sie eine Haupt Abfrage ein, die `JOIN` s enthält ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="55ea5-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>

<span data-ttu-id="55ea5-144">Standardmäßig erstellt der TableAdapter automatisch `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen basierend auf der Haupt Abfrage.</span><span class="sxs-lookup"><span data-stu-id="55ea5-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="55ea5-145">Wenn Sie auf die Schaltfläche Erweitert klicken, sehen Sie, dass diese Funktion aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="55ea5-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="55ea5-146">Trotz dieser Einstellung kann der TableAdapter die Anweisungen `INSERT`, `UPDATE`und `DELETE` nicht erstellen, da die Haupt Abfrage einen `JOIN`enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Geben Sie eine Haupt Abfrage ein, die Joins enthält.](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="55ea5-148">**Abbildung 2**: Geben Sie eine Haupt Abfrage ein, die `JOIN` s enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="55ea5-149">Klicken Sie auf Fertigstellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="55ea5-150">An diesem Punkt enthält Ihr Dataset s-Designer einen einzelnen TableAdapter mit einer Datentabelle mit Spalten für jedes der Felder, die in der Spaltenliste der `SELECT` Abfrage s zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="55ea5-151">Dies schließt die `CategoryName` und `SupplierName`ein, wie in Abbildung 3 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![Die Datentabelle enthält eine Spalte für jedes Feld, das in der Spaltenliste zurückgegeben wird.](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="55ea5-153">**Abbildung 3**: die Datentabelle enthält eine Spalte für jedes Feld, das in der Spaltenliste zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="55ea5-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="55ea5-154">Obwohl die Datentabelle über die entsprechenden Spalten verfügt, fehlen im TableAdapter Werte für die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="55ea5-155">Um dies zu bestätigen, klicken Sie im Designer auf den TableAdapter und dann auf den Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="55ea5-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="55ea5-156">Dort sehen Sie, dass die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand` auf (keine) festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="55ea5-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="55ea5-157">[![die Eigenschaften InsertCommand, UpdateCommand und DeleteCommand auf (keine) festgelegt.](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="55ea5-158">**Abbildung 4**: die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand` sind auf (keine) festgelegt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>

<span data-ttu-id="55ea5-159">Um dieses Problem zu umgehen, können Sie die SQL-Anweisungen und Parameter für die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand` über den Eigenschaftenfenster manuell bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="55ea5-160">Alternativ könnten Sie zunächst die Haupt Abfrage des TableAdapter s so konfigurieren, dass *Sie keine `JOIN`* s enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="55ea5-161">Dies ermöglicht es, dass die Anweisungen `INSERT`, `UPDATE`und `DELETE` für uns automatisch generiert werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="55ea5-162">Nachdem Sie den Assistenten abgeschlossen haben, können wir die TableAdapter s-`SelectCommand` vom Eigenschaftenfenster manuell aktualisieren, sodass Sie die `JOIN`-Syntax enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="55ea5-163">Obwohl dieser Ansatz funktioniert, ist er bei der Verwendung von Ad-hoc-SQL-Abfragen sehr anfällig, da jedes Mal, wenn die Haupt Abfrage des TableAdapter s über den Assistenten neu konfiguriert wird, die automatisch generierten `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen neu erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="55ea5-164">Dies bedeutet, dass alle Anpassungen, die wir später vorgenommen haben, verloren gehen würden, wenn wir mit der rechten Maustaste auf den TableAdapter klicken, im Kontextmenü Konfigurieren auswählen und den Assistenten erneut abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="55ea5-165">Die `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen des TableAdapter s, die automatisch generiert werden, sind glücklicherweise auf Ad-hoc-SQL-Anweisungen beschränkt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="55ea5-166">Wenn der TableAdapter gespeicherte Prozeduren verwendet, können Sie die `SelectCommand`, die `InsertCommand`, `UpdateCommand`oder `DeleteCommand` gespeicherten Prozeduren anpassen und den TableAdapter-Konfigurations-Assistenten erneut ausführen, ohne zu befürchten, dass die gespeicherten Prozeduren geändert werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="55ea5-167">In den nächsten Schritten erstellen wir einen TableAdapter, der anfänglich eine Haupt Abfrage verwendet, in der alle `JOIN` en ausgelassen werden, damit die entsprechenden gespeicherten Prozeduren INSERT, Update und DELETE automatisch generiert werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="55ea5-168">Anschließend aktualisieren wir die `SelectCommand`, sodass ein `JOIN` verwendet, das zusätzliche Spalten aus verknüpften Tabellen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="55ea5-169">Schließlich erstellen wir eine zugehörige Klasse für die Geschäftslogik Schicht und veranschaulichen die Verwendung des TableAdapter auf einer ASP.NET-Webseite.</span><span class="sxs-lookup"><span data-stu-id="55ea5-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="55ea5-170">Schritt 1: Erstellen des TableAdapters mit einer vereinfachten Haupt Abfrage</span><span class="sxs-lookup"><span data-stu-id="55ea5-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="55ea5-171">Für dieses Tutorial fügen wir einen TableAdapter und eine stark typisierte Datentabelle für die `Employees` Tabelle im `NorthwindWithSprocs` Dataset hinzu.</span><span class="sxs-lookup"><span data-stu-id="55ea5-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="55ea5-172">Die `Employees` Tabelle enthält ein `ReportsTo` Feld, in dem die `EmployeeID` des Mitarbeiter-Managers angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="55ea5-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="55ea5-173">Beispielsweise hat der Mitarbeiter Anne dodsvalue den `ReportTo` Wert 5, der `EmployeeID` von Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="55ea5-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="55ea5-174">Folglich berichtet er an Steven, seinen Vorgesetzten.</span><span class="sxs-lookup"><span data-stu-id="55ea5-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="55ea5-175">Zusammen mit der Berichterstellung für die einzelnen Mitarbeiter `ReportsTo` Wert können wir auch den Namen des Vorgesetzten abrufen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="55ea5-176">Dies kann mithilfe einer `JOIN`erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="55ea5-177">Wenn Sie jedoch eine `JOIN` verwenden, wenn der TableAdapter erstmalig erstellt wird, verhindert der Assistent automatisch die entsprechenden INSERT-, Update-und DELETE-Funktionen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="55ea5-178">Daher wird zunächst ein TableAdapter erstellt, dessen Haupt Abfrage keine `JOIN` s enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="55ea5-179">Anschließend aktualisieren wir in Schritt 2 die gespeicherte Prozedur der Haupt Abfrage, um den Namen der Manager-s über eine `JOIN`abzurufen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="55ea5-180">Öffnen Sie zunächst das `NorthwindWithSprocs` DataSet im Ordner `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="55ea5-181">Klicken Sie mit der rechten Maustaste auf den Designer, wählen Sie im Kontextmenü die Option hinzufügen aus, und wählen Sie das Menü Element TableAdapter aus.</span><span class="sxs-lookup"><span data-stu-id="55ea5-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="55ea5-182">Dadurch wird der TableAdapter-Konfigurations-Assistent gestartet.</span><span class="sxs-lookup"><span data-stu-id="55ea5-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="55ea5-183">Wie in Abbildung 5 dargestellt, lassen Sie den Assistenten neue gespeicherte Prozeduren erstellen, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="55ea5-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="55ea5-184">Ein Aktualisierungs Programm für das Erstellen neuer gespeicherter Prozeduren mit dem TableAdapter-Assistenten finden Sie unter [Erstellen neuer gespeicherter Prozeduren für das Lernprogramm für typisierte Datasets](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="55ea5-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="55ea5-185">[Wählen Sie ![die Option neue gespeicherte Prozeduren erstellen.](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="55ea5-186">**Abbildung 5**: Wählen Sie die Option neue gespeicherte Prozeduren erstellen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>

<span data-ttu-id="55ea5-187">Verwenden Sie die folgende `SELECT`-Anweisung für die Haupt Abfrage des TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="55ea5-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="55ea5-188">Da diese Abfrage keine `JOIN` s enthält, erstellt der TableAdapter-Assistent automatisch gespeicherte Prozeduren mit entsprechenden `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen sowie eine gespeicherte Prozedur zum Ausführen der Haupt Abfrage.</span><span class="sxs-lookup"><span data-stu-id="55ea5-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="55ea5-189">Mit dem folgenden Schritt können wir den TableAdapter-gespeicherten Prozeduren benennen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="55ea5-190">Verwenden Sie die Namen `Employees_Select`, `Employees_Insert`, `Employees_Update`und `Employees_Delete`, wie in Abbildung 6 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="55ea5-191">[![die gespeicherten Prozeduren der TableAdapter-Prozedur.](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="55ea5-192">**Abbildung 6**: Benennen der TableAdapter s-gespeicherten Prozeduren ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>

<span data-ttu-id="55ea5-193">Im letzten Schritt werden wir aufgefordert, die TableAdapter s-Methoden zu benennen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="55ea5-194">Verwenden Sie `Fill` und `GetEmployees` als Methodennamen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="55ea5-195">Stellen Sie außerdem sicher, dass das Kontrollkästchen zum Senden von Updates direkt an die Datenbank (GenerateDBDirectMethods) aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="55ea5-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="55ea5-196">[![benennen Sie die TableAdapter s-Methoden Fill und GetEmployees.](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="55ea5-197">**Abbildung 7**: Benennen der TableAdapter s-Methoden `Fill` und `GetEmployees` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>

<span data-ttu-id="55ea5-198">Nehmen Sie sich nach Abschluss des Assistenten einen Moment Zeit, um die gespeicherten Prozeduren in der Datenbank zu untersuchen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="55ea5-199">Es sollten vier neue angezeigt werden: `Employees_Select`, `Employees_Insert`, `Employees_Update`und `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="55ea5-200">Überprüfen Sie als nächstes die `EmployeesDataTable`, und `EmployeesTableAdapter` Sie soeben erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="55ea5-201">Die Datentabelle enthält eine Spalte für jedes Feld, das von der Haupt Abfrage zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="55ea5-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="55ea5-202">Klicken Sie auf den TableAdapter, und wechseln Sie dann zum Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="55ea5-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="55ea5-203">Dort sehen Sie, dass die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand` ordnungsgemäß konfiguriert sind, um die entsprechenden gespeicherten Prozeduren aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="55ea5-204">[![der TableAdapter Einfügungs-, Aktualisierungs-und Löschfunktionen enthält.](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="55ea5-205">**Abbildung 8**: der TableAdapter umfasst Einfüge-, Aktualisierungs-und Löschfunktionen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>

<span data-ttu-id="55ea5-206">Nachdem die gespeicherten Prozeduren INSERT, Update und DELETE automatisch erstellt und die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand` ordnungsgemäß konfiguriert wurden, können wir die gespeicherte Prozedur `SelectCommand` s anpassen, um zusätzliche Informationen zu den einzelnen Vorgesetzten der Mitarbeiter zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="55ea5-207">Insbesondere müssen Sie die gespeicherte Prozedur `Employees_Select` aktualisieren, um eine `JOIN` zu verwenden, und die `FirstName` und `LastName` Werte des Managers zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="55ea5-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="55ea5-208">Nachdem die gespeicherte Prozedur aktualisiert wurde, müssen wir die Datentabelle aktualisieren, damit Sie diese zusätzlichen Spalten enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="55ea5-209">Wir behandeln diese beiden Aufgaben in den Schritten 2 und 3.</span><span class="sxs-lookup"><span data-stu-id="55ea5-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="55ea5-210">Schritt 2: Anpassen der gespeicherten Prozedur zum Einschließen einer`JOIN`</span><span class="sxs-lookup"><span data-stu-id="55ea5-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="55ea5-211">Beginnen Sie mit dem Server-Explorer, und starten Sie den Ordner "gespeicherte Prozeduren" der Northwind-Datenbank, und öffnen Sie die gespeicherte Prozedur `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="55ea5-212">Wenn diese gespeicherte Prozedur nicht angezeigt wird, klicken Sie mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren, und wählen Sie aktualisieren aus.</span><span class="sxs-lookup"><span data-stu-id="55ea5-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="55ea5-213">Aktualisieren Sie die gespeicherte Prozedur so, dass Sie eine `LEFT JOIN` verwendet, um den vor-und Nachnamen des Vorgesetzten zurückzugeben:</span><span class="sxs-lookup"><span data-stu-id="55ea5-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="55ea5-214">Nachdem Sie die `SELECT`-Anweisung aktualisiert haben, speichern Sie die Änderungen, indem Sie im Menü Datei auf Speichern `Employees_Select`klicken.</span><span class="sxs-lookup"><span data-stu-id="55ea5-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="55ea5-215">Alternativ dazu können Sie auf das Symbol Speichern auf der Symbolleiste klicken oder STRG + S drücken.</span><span class="sxs-lookup"><span data-stu-id="55ea5-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="55ea5-216">Nachdem Sie die Änderungen gespeichert haben, klicken Sie mit der rechten Maustaste auf die gespeicherte Prozedur `Employees_Select` im Server-Explorer, und wählen Sie ausführen aus.</span><span class="sxs-lookup"><span data-stu-id="55ea5-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="55ea5-217">Dadurch wird die gespeicherte Prozedur ausgeführt, und die Ergebnisse werden im Ausgabefenster angezeigt (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="55ea5-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="55ea5-218">[![werden die Ergebnisse gespeicherter Prozeduren in der Ausgabefenster angezeigt.](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="55ea5-219">**Abbildung 9**: die Ergebnisse gespeicherter Prozeduren werden in der Ausgabefenster angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="55ea5-220">Schritt 3: Aktualisieren der Spalten der Datentabelle</span><span class="sxs-lookup"><span data-stu-id="55ea5-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="55ea5-221">An diesem Punkt gibt die gespeicherte Prozedur `Employees_Select` `ManagerFirstName` und `ManagerLastName` Werte zurück, aber der `EmployeesDataTable` fehlen diese Spalten.</span><span class="sxs-lookup"><span data-stu-id="55ea5-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="55ea5-222">Diese fehlenden Spalten können auf eine von zwei Arten der Datentabelle hinzugefügt werden:</span><span class="sxs-lookup"><span data-stu-id="55ea5-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="55ea5-223">Klicken Sie **manuell** mit der rechten Maustaste auf die Datentabelle im DataSet-Designer, und wählen Sie im Menü hinzufügen die Option Spalte aus.</span><span class="sxs-lookup"><span data-stu-id="55ea5-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="55ea5-224">Anschließend können Sie die Spalte benennen und deren Eigenschaften entsprechend festlegen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="55ea5-225">**Automatisch** : der TableAdapter-Konfigurations-Assistent aktualisiert die Spalten der Datentabelle, um die Felder widerzuspiegeln, die von der gespeicherten Prozedur `SelectCommand` zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="55ea5-226">Wenn Sie Ad-hoc-SQL-Anweisungen verwenden, werden vom Assistenten auch die Eigenschaften `InsertCommand`, `UpdateCommand`und `DeleteCommand` entfernt, da das `SelectCommand` nun eine `JOIN`enthält.</span><span class="sxs-lookup"><span data-stu-id="55ea5-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="55ea5-227">Wenn Sie jedoch gespeicherte Prozeduren verwenden, bleiben diese Befehls Eigenschaften intakt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="55ea5-228">Wir haben das manuelle Hinzufügen von Daten Tabellenspalten in vorherigen Tutorials untersucht, einschließlich [Master/Detail mithilfe einer Auflistungs Liste von Master Datensätzen mit einem DataList-DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) und [Hochladen von Dateien](../working-with-binary-files/uploading-files-vb.md). dieser Prozess wird im nächsten Tutorial ausführlicher erläutert.</span><span class="sxs-lookup"><span data-stu-id="55ea5-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="55ea5-229">In diesem Tutorial können Sie jedoch die automatische Vorgehensweise über den TableAdapter-Konfigurations-Assistenten verwenden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="55ea5-230">Klicken Sie zunächst mit der rechten Maustaste auf die `EmployeesTableAdapter`, und wählen Sie im Kontextmenü die Option konfigurieren aus.</span><span class="sxs-lookup"><span data-stu-id="55ea5-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="55ea5-231">Dadurch wird der TableAdapter-Konfigurations-Assistent geöffnet, der die gespeicherten Prozeduren auflistet, die zum auswählen, einfügen, aktualisieren und Löschen verwendet werden, zusammen mit den zugehörigen Rückgabe Werten und Parametern (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="55ea5-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="55ea5-232">Abbildung 10 zeigt den Assistenten.</span><span class="sxs-lookup"><span data-stu-id="55ea5-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="55ea5-233">Hier sehen Sie, dass die gespeicherte Prozedur `Employees_Select` nun die Felder `ManagerFirstName` und `ManagerLastName` zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="55ea5-234">[![der Assistent die aktualisierte Spaltenliste für die gespeicherte Prozedur Employees_Select anzeigt](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="55ea5-235">**Abbildung 10**: der Assistent zeigt die aktualisierte Spaltenliste für die gespeicherte Prozedur `Employees_Select` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>

<span data-ttu-id="55ea5-236">Beenden Sie den Assistenten, indem Sie auf Fertigstellen klicken.</span><span class="sxs-lookup"><span data-stu-id="55ea5-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="55ea5-237">Wenn Sie zum DataSet-Designer zurückkehren, enthält die `EmployeesDataTable` zwei zusätzliche Spalten: `ManagerFirstName` und `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="55ea5-238">[![die Mitarbeiterdaten Tabelle zwei neue Spalten enthält.](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="55ea5-239">**Abbildung 11**: die `EmployeesDataTable` enthält zwei neue Spalten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>

<span data-ttu-id="55ea5-240">Um zu veranschaulichen, dass die aktualisierte gespeicherte Prozedur `Employees_Select` in Kraft ist und die Einfüge-, Aktualisierungs-und Löschfunktionen des TableAdapters weiterhin funktionsfähig sind, können Sie eine Webseite erstellen, die es Benutzern ermöglicht, Mitarbeiter anzuzeigen und zu löschen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="55ea5-241">Bevor wir eine solche Seite erstellen, müssen wir jedoch zunächst eine neue Klasse in der Geschäftslogik Schicht erstellen, um mit Mitarbeitern aus dem `NorthwindWithSprocs` DataSet zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="55ea5-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="55ea5-242">In Schritt 4 erstellen wir eine `EmployeesBLLWithSprocs`-Klasse.</span><span class="sxs-lookup"><span data-stu-id="55ea5-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="55ea5-243">In Schritt 5 wird diese Klasse von einer ASP.NET-Seite verwendet.</span><span class="sxs-lookup"><span data-stu-id="55ea5-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="55ea5-244">Schritt 4: Implementieren der Geschäftslogik Ebene</span><span class="sxs-lookup"><span data-stu-id="55ea5-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="55ea5-245">Erstellen Sie eine neue Klassendatei im Ordner "`~/App_Code/BLL`" mit dem Namen `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="55ea5-246">Diese Klasse imitiert die Semantik der vorhandenen `EmployeesBLL`-Klasse, nur diese neue stellt weniger Methoden bereit und verwendet das `NorthwindWithSprocs` DataSet (anstelle des `Northwind` Datasets).</span><span class="sxs-lookup"><span data-stu-id="55ea5-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="55ea5-247">Fügen Sie der `EmployeesBLLWithSprocs` -Klasse den folgenden Code hinzu.</span><span class="sxs-lookup"><span data-stu-id="55ea5-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="55ea5-248">Die `EmployeesBLLWithSprocs` Class s `Adapter`-Eigenschaft gibt eine Instanz der `EmployeesTableAdapter``NorthwindWithSprocs` Datasets zurück.</span><span class="sxs-lookup"><span data-stu-id="55ea5-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="55ea5-249">Diese wird von der `GetEmployees`-und `DeleteEmployee`-Methode der-Klasse verwendet.</span><span class="sxs-lookup"><span data-stu-id="55ea5-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="55ea5-250">Die `GetEmployees`-Methode ruft die `EmployeesTableAdapter` s der entsprechenden `GetEmployees`-Methode auf, die die gespeicherte Prozedur `Employees_Select` aufruft und die Ergebnisse in einer `EmployeeDataTable`auffüllt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="55ea5-251">Die `DeleteEmployee`-Methode ruft auf ähnliche Weise die `EmployeesTableAdapter` s `Delete`-Methode auf, die die gespeicherte Prozedur `Employees_Delete` aufruft.</span><span class="sxs-lookup"><span data-stu-id="55ea5-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="55ea5-252">Schritt 5: Arbeiten mit den Daten in der Darstellungs Schicht</span><span class="sxs-lookup"><span data-stu-id="55ea5-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="55ea5-253">Wenn die `EmployeesBLLWithSprocs`-Klasse abgeschlossen ist, können wir mit den Mitarbeiterdaten über eine ASP.NET Seite wieder arbeiten.</span><span class="sxs-lookup"><span data-stu-id="55ea5-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="55ea5-254">Öffnen Sie die Seite `JOINs.aspx` im Ordner `AdvancedDAL`, und ziehen Sie eine GridView aus der Toolbox auf den Designer, und legen Sie die Eigenschaft `ID` auf `Employees`fest.</span><span class="sxs-lookup"><span data-stu-id="55ea5-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="55ea5-255">Binden Sie anschließend aus dem GridView s-Smarttag das Raster an ein neues ObjectDataSource-Steuerelement mit dem Namen `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="55ea5-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="55ea5-256">Konfigurieren Sie ObjectDataSource so, dass die `EmployeesBLLWithSprocs`-Klasse verwendet wird, und stellen Sie auf der Registerkarte auswählen und löschen sicher, dass die Methoden `GetEmployees` und `DeleteEmployee` in den Dropdown Listen ausgewählt sind.</span><span class="sxs-lookup"><span data-stu-id="55ea5-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="55ea5-257">Klicken Sie auf Fertigstellen, um die Konfiguration von ObjectDataSource abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="55ea5-258">[![Konfigurieren von ObjectDataSource für die Verwendung der Klasse Mitarbeiter bllwithsprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="55ea5-259">**Abbildung 12**: Konfigurieren von ObjectDataSource für die Verwendung der `EmployeesBLLWithSprocs`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>

<span data-ttu-id="55ea5-260">[![die ObjectDataSource die GetEmployees-Methode und die DeleteEmployee-Methode verwenden.](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="55ea5-261">**Abbildung 13**: Verwenden von ObjectDataSource zum `GetEmployees` und `DeleteEmployee` Methoden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>

<span data-ttu-id="55ea5-262">Visual Studio fügt der GridView für jede der `EmployeesDataTable` s-Spalten ein BoundField-Element hinzu.</span><span class="sxs-lookup"><span data-stu-id="55ea5-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="55ea5-263">Entfernen Sie alle diese boundfields-Objekte mit Ausnahme von `Title`, `LastName`, `FirstName`, `ManagerFirstName`und `ManagerLastName`, und benennen Sie die `HeaderText` Eigenschaften für die letzten vier boundfields in Nachname, Vorname, Manager-Vorname und Nachname des Vorgesetzten um.</span><span class="sxs-lookup"><span data-stu-id="55ea5-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="55ea5-264">Um Benutzern das Löschen von Mitarbeitern auf dieser Seite zu gestatten, müssen Sie zwei Dinge tun.</span><span class="sxs-lookup"><span data-stu-id="55ea5-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="55ea5-265">Weisen Sie zunächst die GridView zum Bereitstellen von Löschfunktionen an, indem Sie die Option zum Aktivieren der Löschung von Ihrem Smarttag aktivieren.</span><span class="sxs-lookup"><span data-stu-id="55ea5-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="55ea5-266">Ändern Sie anschließend die ObjectDataSource s `OldValuesParameterFormatString`-Eigenschaft von dem Wert, der vom ObjectDataSource-Assistenten (`original_{0}`) festgelegt wurde, auf den Standardwert (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="55ea5-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="55ea5-267">Nachdem Sie diese Änderungen vorgenommen haben, sollten das deklarative Markup von GridView und ObjectDataSource in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="55ea5-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="55ea5-268">Testen Sie die Seite, indem Sie Sie über einen Browser aufrufen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="55ea5-269">Wie in Abbildung 14 gezeigt, werden auf der Seite die einzelnen Mitarbeiter und deren Name (sofern vorhanden) aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="55ea5-270">[![der Join in der Employees_Select gespeicherten Prozedur den Namen des Vorgesetzten zurück.](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="55ea5-271">**Abbildung 14**: der `JOIN` in der `Employees_Select` gespeicherten Prozedur gibt den Namen des Vorgesetzten zurück ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>

<span data-ttu-id="55ea5-272">Wenn Sie auf die Schaltfläche Löschen klicken, wird der Lösch Workflow gestartet, der in der Ausführung der gespeicherten Prozedur `Employees_Delete` gipfiert.</span><span class="sxs-lookup"><span data-stu-id="55ea5-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="55ea5-273">Allerdings schlägt die versuchte `DELETE` Anweisung in der gespeicherten Prozedur aufgrund einer Verletzung der FOREIGN KEY-Einschränkung fehl (siehe Abbildung 15).</span><span class="sxs-lookup"><span data-stu-id="55ea5-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="55ea5-274">Insbesondere verfügt jeder Mitarbeiter über einen oder mehrere Datensätze in der `Orders` Tabelle, wodurch der Löschvorgang fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="55ea5-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="55ea5-275">[![Löschen eines Mitarbeiters, der über entsprechende Aufträge verfügt, führt zu einer Verletzung der FOREIGN KEY-Einschränkung.](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="55ea5-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="55ea5-276">**Abbildung 15**: Löschen eines Mitarbeiters, der über entsprechende Bestellungen verfügt, führt zu einer Verletzung der Fremdschlüssel Einschränkung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="55ea5-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>

<span data-ttu-id="55ea5-277">Damit ein Mitarbeiter gelöscht werden kann, können Sie folgende Aktionen ausführen:</span><span class="sxs-lookup"><span data-stu-id="55ea5-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="55ea5-278">Aktualisieren Sie die FOREIGN KEY-Einschränkung in Kaskadierte Löschvorgänge.</span><span class="sxs-lookup"><span data-stu-id="55ea5-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="55ea5-279">Löschen Sie die Datensätze manuell aus der `Orders` Tabelle für die Mitarbeiter, die Sie löschen möchten, oder</span><span class="sxs-lookup"><span data-stu-id="55ea5-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="55ea5-280">Aktualisieren Sie die gespeicherte Prozedur `Employees_Delete`, um zuerst die zugehörigen Datensätze aus der `Orders` Tabelle zu löschen, bevor Sie den `Employees` Datensatz löschen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="55ea5-281">Diese Vorgehensweise wurde im Tutorial [Verwenden vorhandener gespeicherter Prozeduren für das typisierte DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) erläutert.</span><span class="sxs-lookup"><span data-stu-id="55ea5-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="55ea5-282">Ich lasse dies als Übung für den Reader aus.</span><span class="sxs-lookup"><span data-stu-id="55ea5-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="55ea5-283">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="55ea5-283">Summary</span></span>

<span data-ttu-id="55ea5-284">Beim Arbeiten mit relationalen Datenbanken kommt es häufig vor, dass Abfragen Ihre Daten aus mehreren verknüpften Tabellen abrufen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="55ea5-285">Korrelierte Unterabfragen und `JOIN` s bieten zwei verschiedene Techniken für den Zugriff auf Daten aus verknüpften Tabellen in einer Abfrage.</span><span class="sxs-lookup"><span data-stu-id="55ea5-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="55ea5-286">In vorherigen Tutorials haben wir am häufigsten korrelierte Unterabfragen verwendet, da der TableAdapter `INSERT`-, `UPDATE`-und `DELETE`-Anweisungen für Abfragen, die `JOIN` s betreffen, nicht automatisch generieren kann.</span><span class="sxs-lookup"><span data-stu-id="55ea5-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="55ea5-287">Diese Werte können bei Verwendung von Ad-hoc-SQL-Anweisungen manuell bereitgestellt werden, wenn der TableAdapter-Konfigurations-Assistent abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="55ea5-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="55ea5-288">Glücklicherweise haben TableAdapters, die mithilfe gespeicherter Prozeduren erstellt wurden, nicht denselben Platzhalter wie solche, die mithilfe von Ad-hoc-SQL-Anweisungen erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="55ea5-289">Daher ist es möglich, einen TableAdapter zu erstellen, dessen Haupt Abfrage eine `JOIN` bei der Verwendung gespeicherter Prozeduren verwendet.</span><span class="sxs-lookup"><span data-stu-id="55ea5-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="55ea5-290">In diesem Tutorial haben Sie erfahren, wie Sie einen solchen TableAdapter erstellen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="55ea5-291">Wir haben mit einer `JOIN`losen `SELECT` Abfrage für die Haupt Abfrage des TableAdapter s begonnen, sodass die entsprechenden gespeicherten INSERT-, Update-und DELETE-Prozeduren automatisch erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="55ea5-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="55ea5-292">Nach Abschluss der Erstkonfiguration von TableAdapter wurde die gespeicherte Prozedur `SelectCommand` so erweitert, dass ein `JOIN` verwendet wird, und der TableAdapter-Konfigurations-Assistent wird erneut ausgeführt, um die `EmployeesDataTable` s-Spalten zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="55ea5-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="55ea5-293">Beim erneuten Ausführen des TableAdapter-Konfigurations-Assistenten wurden die `EmployeesDataTable` Spalten automatisch aktualisiert, um die von der gespeicherten Prozedur `Employees_Select` zurückgegebenen Datenfelder widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="55ea5-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="55ea5-294">Alternativ können wir diese Spalten der Datentabelle manuell hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="55ea5-295">Im nächsten Tutorial wird erläutert, wie Sie der Datentabelle manuell Spalten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="55ea5-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="55ea5-296">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="55ea5-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="55ea5-297">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="55ea5-297">About the Author</span></span>

<span data-ttu-id="55ea5-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="55ea5-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="55ea5-299">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="55ea5-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="55ea5-300">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="55ea5-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="55ea5-301">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="55ea5-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="55ea5-302">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="55ea5-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="55ea5-303">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="55ea5-303">Special Thanks To</span></span>

<span data-ttu-id="55ea5-304">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="55ea5-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="55ea5-305">Die führenden Reviewer für dieses Tutorial waren Hilton geisenow, David suru und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="55ea5-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="55ea5-306">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="55ea5-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="55ea5-307">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="55ea5-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="55ea5-308">[Zurück](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Weiter](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="55ea5-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
