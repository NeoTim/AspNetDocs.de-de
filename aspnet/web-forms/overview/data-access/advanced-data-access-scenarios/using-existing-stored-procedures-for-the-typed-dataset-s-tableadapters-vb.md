---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: Verwenden vorhandener gespeicherter Prozeduren für die TableAdapters des typisierten Datasets (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Im vorherigen Tutorial haben Sie erfahren, wie Sie den TableAdapter-Assistenten verwenden, um neue gespeicherte Prozeduren zu generieren. In diesem Tutorial erfahren Sie, wie der gleiche TableAdapter...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: e35c3d6a98516a07f6119e6cb9dbeb99bc28fe33
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78427125"
---
# <a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="026a7-104">Verwenden von vorhandenen gespeicherten Prozeduren für die TableAdapter-Steuerelemente des typisierten DataSet (VB)</span><span class="sxs-lookup"><span data-stu-id="026a7-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>

<span data-ttu-id="026a7-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="026a7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="026a7-106">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) oder [PDF herunterladen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="026a7-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="026a7-107">Im vorherigen Tutorial haben Sie erfahren, wie Sie den TableAdapter-Assistenten verwenden, um neue gespeicherte Prozeduren zu generieren.</span><span class="sxs-lookup"><span data-stu-id="026a7-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="026a7-108">In diesem Tutorial erfahren Sie, wie der TableAdapter-Assistent mit vorhandenen gespeicherten Prozeduren arbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="026a7-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="026a7-109">Außerdem wird beschrieben, wie Sie der Datenbank manuell neue gespeicherte Prozeduren hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="026a7-109">We also learn how to manually add new stored procedures to our database.</span></span>

## <a name="introduction"></a><span data-ttu-id="026a7-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="026a7-110">Introduction</span></span>

<span data-ttu-id="026a7-111">Im [vorherigen Tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) haben wir gesehen, wie die TableAdapters für typisierte Datasets für die Verwendung gespeicherter Prozeduren für den Zugriff auf Daten anstelle von Ad-hoc-SQL-Anweisungen konfiguriert werden können.</span><span class="sxs-lookup"><span data-stu-id="026a7-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="026a7-112">Insbesondere wurde untersucht, wie der TableAdapter-Assistent diese gespeicherten Prozeduren automatisch erstellt.</span><span class="sxs-lookup"><span data-stu-id="026a7-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="026a7-113">Beim Portieren einer Legacy Anwendung auf ASP.NET 2,0 oder beim Aufbau einer ASP.NET 2,0-Website um ein vorhandenes Datenmodell besteht die Wahrscheinlichkeit, dass die Datenbank bereits die gespeicherten Prozeduren enthält, die wir benötigen.</span><span class="sxs-lookup"><span data-stu-id="026a7-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="026a7-114">Alternativ empfiehlt es sich, die gespeicherten Prozeduren mit einem anderen Tool als dem TableAdapter-Assistenten zu erstellen, der automatisch die gespeicherten Prozeduren generiert.</span><span class="sxs-lookup"><span data-stu-id="026a7-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="026a7-115">In diesem Tutorial wird erläutert, wie Sie den TableAdapter für die Verwendung vorhandener gespeicherter Prozeduren konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="026a7-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="026a7-116">Da die Northwind-Datenbank nur über einen kleinen Satz integrierter gespeicherter Prozeduren verfügt, werden auch die erforderlichen Schritte zum manuellen Hinzufügen neuer gespeicherter Prozeduren zur Datenbank über die Visual Studio-Umgebung erläutert.</span><span class="sxs-lookup"><span data-stu-id="026a7-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="026a7-117">Legen Sie Los!</span><span class="sxs-lookup"><span data-stu-id="026a7-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="026a7-118">Im Tutorial [Wrapping von Daten Bank Änderungen innerhalb einer Transaktion](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) haben wir dem TableAdapter Methoden hinzugefügt, um Transaktionen (`BeginTransaction`, `CommitTransaction`usw.) zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="026a7-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="026a7-119">Alternativ können Transaktionen vollständig in einer gespeicherten Prozedur verwaltet werden, für die keine Änderungen am Code der Datenzugriffs Schicht erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="026a7-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="026a7-120">In diesem Tutorial untersuchen wir die T-SQL-Befehle, die zum Ausführen von Anweisungen für gespeicherte Prozeduren innerhalb des Gültigkeits Bereichs einer Transaktion verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="026a7-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>

## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="026a7-121">Schritt 1: Hinzufügen gespeicherter Prozeduren zur Datenbank Northwind</span><span class="sxs-lookup"><span data-stu-id="026a7-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="026a7-122">Visual Studio erleichtert das Hinzufügen neuer gespeicherter Prozeduren zu einer Datenbank.</span><span class="sxs-lookup"><span data-stu-id="026a7-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="026a7-123">Fügen Sie der Northwind-Datenbank eine neue gespeicherte Prozedur hinzu, die alle Spalten aus der `Products` Tabelle für diejenigen mit einem bestimmten `CategoryID` Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="026a7-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="026a7-124">Erweitern Sie im Fenster Server-Explorer die Datenbank Northwind, sodass Ihre Ordner Daten Bank Diagramme, Tabellen, Sichten usw. angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="026a7-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="026a7-125">Wie bereits im vorherigen Tutorial gezeigt, enthält der Ordner gespeicherte Prozeduren die vorhandenen gespeicherten Prozeduren der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="026a7-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="026a7-126">Um eine neue gespeicherte Prozedur hinzuzufügen, klicken Sie einfach mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren, und wählen Sie im Kontextmenü die Option neue gespeicherte Prozedur hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="026a7-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>

<span data-ttu-id="026a7-127">[![mit der rechten Maustaste auf den Ordner gespeicherte Prozeduren, und fügen Sie eine neue gespeicherte Prozedur](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="026a7-128">**Abbildung 1**: Klicken Sie[mit](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png)der rechten Maustaste auf den Ordner gespeicherte Prozeduren, und fügen Sie eine neue gespeicherte Prozedur hinzu.</span><span class="sxs-lookup"><span data-stu-id="026a7-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>

<span data-ttu-id="026a7-129">Wie in Abbildung 1 gezeigt, wird durch Auswählen der Option neue gespeicherte Prozedur hinzufügen ein Skript Fenster in Visual Studio mit der Gliederung des SQL-Skripts geöffnet, das zum Erstellen der gespeicherten Prozedur erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="026a7-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="026a7-130">Es ist unsere Aufgabe, dieses Skript zu erstellen und auszuführen. zu diesem Zeitpunkt wird die gespeicherte Prozedur der Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="026a7-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="026a7-131">Geben Sie das folgende Skript ein:</span><span class="sxs-lookup"><span data-stu-id="026a7-131">Enter the following script:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="026a7-132">Bei der Ausführung dieses Skripts wird der Northwind-Datenbank mit dem Namen `Products_SelectByCategoryID`eine neue gespeicherte Prozedur hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="026a7-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="026a7-133">Diese gespeicherte Prozedur akzeptiert einen einzelnen Eingabeparameter (`@CategoryID`vom Typ `int`) und gibt alle Felder für diese Produkte mit einem übereinstimmenden `CategoryID` Wert zurück.</span><span class="sxs-lookup"><span data-stu-id="026a7-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="026a7-134">Um dieses `CREATE PROCEDURE` Skript auszuführen und die gespeicherte Prozedur der Datenbank hinzuzufügen, klicken Sie auf das Symbol Speichern auf der Symbolleiste, oder drücken Sie STRG + S.</span><span class="sxs-lookup"><span data-stu-id="026a7-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="026a7-135">Anschließend wird der Ordner für gespeicherte Prozeduren aktualisiert und zeigt die neu erstellte gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="026a7-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="026a7-136">Außerdem ändert das Skript im-Fenster die Feinheiten von `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` in `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="026a7-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="026a7-137">`CREATE PROCEDURE` fügt der Datenbank eine neue gespeicherte Prozedur hinzu, während `ALTER PROCEDURE` eine vorhandene gespeicherte Prozedur aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="026a7-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="026a7-138">Da der Start des Skripts in `ALTER PROCEDURE`geändert wurde, wird die gespeicherte Prozedur durch Ändern der Eingabeparameter oder SQL-Anweisungen für gespeicherte Prozeduren und durch Klicken auf das Symbol "Speichern" mit diesen Änderungen aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="026a7-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="026a7-139">Abbildung 2 zeigt Visual Studio, nachdem die gespeicherte Prozedur `Products_SelectByCategoryID` gespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="026a7-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>

<span data-ttu-id="026a7-140">[![die gespeicherte Prozedur Products_SelectByCategoryID der Datenbank hinzugefügt wurde.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="026a7-141">**Abbildung 2**: die gespeicherte Prozedur `Products_SelectByCategoryID` wurde der Datenbank hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>

## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="026a7-142">Schritt 2: Konfigurieren des TableAdapters für die Verwendung einer vorhandenen gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="026a7-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="026a7-143">Nachdem die gespeicherte Prozedur `Products_SelectByCategoryID` der Datenbank hinzugefügt wurde, können wir die Datenzugriffs Ebene so konfigurieren, dass diese gespeicherte Prozedur verwendet wird, wenn eine ihrer Methoden aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="026a7-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="026a7-144">Insbesondere fügen wir der `ProductsTableAdapter` im `NorthwindWithSprocs` typisierten DataSet, das die soeben erstellte `Products_SelectByCategoryID` gespeicherte Prozedur aufruft, eine `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->`-Methode hinzu.</span><span class="sxs-lookup"><span data-stu-id="026a7-144">In particular, we will add a `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="026a7-145">Öffnen Sie zunächst das `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="026a7-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="026a7-146">Klicken Sie mit der rechten Maustaste auf den `ProductsTableAdapter`, und wählen Sie Abfrage hinzufügen aus, um den Assistenten für die Konfiguration von TableAdapter</span><span class="sxs-lookup"><span data-stu-id="026a7-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="026a7-147">Im [vorherigen Tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) haben wir entschieden, dass der TableAdapter eine neue gespeicherte Prozedur für uns erstellt.</span><span class="sxs-lookup"><span data-stu-id="026a7-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="026a7-148">In diesem Tutorial möchten wir jedoch die neue TableAdapter-Methode an die vorhandene gespeicherte Prozedur `Products_SelectByCategoryID` übertragen.</span><span class="sxs-lookup"><span data-stu-id="026a7-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="026a7-149">Wählen Sie daher die Option vorhandene gespeicherte Prozedur verwenden im ersten Schritt des Assistenten aus, und klicken Sie dann auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="026a7-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>

<span data-ttu-id="026a7-150">[Wählen Sie die Option vorhandene gespeicherte Prozedur verwenden ![aus.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="026a7-151">**Abbildung 3**: Auswählen der Option zum Verwenden vorhandener gespeicherter Prozeduren ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>

<span data-ttu-id="026a7-152">Der folgende Bildschirm enthält eine Dropdown Liste mit den gespeicherten Prozeduren der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="026a7-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="026a7-153">Wenn Sie eine gespeicherte Prozedur auswählen, werden die Eingabeparameter auf der linken Seite und die zurückgegebenen Datenfelder (sofern vorhanden) auf der rechten Seite aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="026a7-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="026a7-154">Wählen Sie in der Liste die gespeicherte Prozedur `Products_SelectByCategoryID` aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="026a7-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>

<span data-ttu-id="026a7-155">[![die gespeicherte Prozedur Products_SelectByCategoryID auswählen.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="026a7-156">**Abbildung 4**: Auswählen der gespeicherten Prozedur `Products_SelectByCategoryID` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>

<span data-ttu-id="026a7-157">Im nächsten Bildschirm werden wir gefragt, welche Art von Daten von der gespeicherten Prozedur zurückgegeben wird, und unsere Antwort hier bestimmt den Typ, der von der TableAdapter s-Methode zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="026a7-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="026a7-158">Wenn wir z. b. angeben, dass Tabellendaten zurückgegeben werden, gibt die Methode eine `ProductsDataTable` Instanz zurück, die mit den von der gespeicherten Prozedur zurückgegebenen Datensätzen aufgefüllt wurde.</span><span class="sxs-lookup"><span data-stu-id="026a7-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="026a7-159">Wenn wir dagegen angeben, dass diese gespeicherte Prozedur einen einzelnen Wert zurückgibt, gibt der TableAdapter einen `Object` zurück, dem der Wert in der ersten Spalte des ersten Datensatzes zugewiesen wird, der von der gespeicherten Prozedur zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="026a7-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="026a7-160">Da die gespeicherte Prozedur `Products_SelectByCategoryID` alle Produkte zurückgibt, die zu einer bestimmten Kategorie gehören, wählen Sie die erste Antwort-tabellarische Daten aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="026a7-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>

<span data-ttu-id="026a7-161">[![anzeigen, dass die gespeicherte Prozedur Tabellendaten zurückgibt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="026a7-162">**Abbildung 5**: angeben, dass die gespeicherte Prozedur Tabellendaten zurückgibt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>

<span data-ttu-id="026a7-163">Sie müssen nur noch angeben, welche Methoden Muster verwendet werden sollen, gefolgt von den Namen für diese Methoden.</span><span class="sxs-lookup"><span data-stu-id="026a7-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="026a7-164">Lassen Sie die Option Datentabelle ausfüllen, und geben Sie eine Datentabelle zurück, die aktiviert ist, aber benennen Sie die Methoden in `FillByCategoryID` und `GetProductsByCategoryID`um.</span><span class="sxs-lookup"><span data-stu-id="026a7-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="026a7-165">Klicken Sie dann auf Weiter, um eine Zusammenfassung der Aufgaben zu überprüfen, die der Assistent ausführt.</span><span class="sxs-lookup"><span data-stu-id="026a7-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="026a7-166">Wenn alles korrekt aussieht, klicken Sie auf Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="026a7-166">If everything looks correct, click Finish.</span></span>

<span data-ttu-id="026a7-167">[![den Namen der Methoden fillbycategoryid und getproductbycategoryid.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="026a7-168">**Abbildung 6**: Benennen der Methoden `FillByCategoryID` und `GetProductsByCategoryID` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="026a7-169">Die soeben erstellten TableAdapter-Methoden `FillByCategoryID` und `GetProductsByCategoryID`erwarten einen Eingabeparameter vom Typ `Integer`.</span><span class="sxs-lookup"><span data-stu-id="026a7-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="026a7-170">Dieser Eingabeparameter Wert wird über seinen `@CategoryID`-Parameter an die gespeicherte Prozedur übergeben.</span><span class="sxs-lookup"><span data-stu-id="026a7-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="026a7-171">Wenn Sie die Parameter der `Products_SelectByCategory` gespeicherten Prozedur ändern, müssen Sie auch die Parameter für diese TableAdapter-Methoden aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="026a7-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="026a7-172">Wie bereits im [vorherigen Tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)erläutert, kann dies auf eine von zwei Arten erfolgen: durch manuelles Hinzufügen oder Entfernen von Parametern aus der Parameter Auflistung oder durch erneutes Ausführen des TableAdapter-Assistenten.</span><span class="sxs-lookup"><span data-stu-id="026a7-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>

## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="026a7-173">Schritt 3: Hinzufügen einer`GetProductsByCategoryID(categoryID)`Methode zum BLL</span><span class="sxs-lookup"><span data-stu-id="026a7-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="026a7-174">Wenn die `GetProductsByCategoryID` dal-Methode fertiggestellt ist, besteht der nächste Schritt in der Bereitstellung des Zugriffs auf diese Methode in der Geschäftslogik Schicht.</span><span class="sxs-lookup"><span data-stu-id="026a7-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="026a7-175">Öffnen Sie die Datei `ProductsBLLWithSprocs`-Klasse, und fügen Sie die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="026a7-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>

[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="026a7-176">Diese BLL-Methode gibt einfach die `ProductsDataTable` zurück, die von der `ProductsTableAdapter` s `GetProductsByCategoryID`-Methode zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="026a7-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="026a7-177">Das `DataObjectMethodAttribute`-Attribut stellt Metadaten bereit, die vom Assistenten zum Konfigurieren von Datenquellen für ObjectDataSource s verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="026a7-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="026a7-178">Diese Methode wird insbesondere in der Dropdown Liste Registerkarte auswählen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="026a7-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="026a7-179">Schritt 4: Anzeigen von Produkten nach Kategorie</span><span class="sxs-lookup"><span data-stu-id="026a7-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="026a7-180">Wenn Sie die neu hinzugefügte gespeicherte Prozedur `Products_SelectByCategoryID` und die entsprechenden dal-und BLL-Methoden testen möchten, erstellen Sie eine ASP.NET-Seite, die eine Dropdown List und eine GridView enthält.</span><span class="sxs-lookup"><span data-stu-id="026a7-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="026a7-181">In der Dropdown Liste werden alle Kategorien in der Datenbank aufgelistet, während in der GridView die Produkte angezeigt werden, die zur ausgewählten Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="026a7-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="026a7-182">Wir haben in vorherigen Tutorials mithilfe von Dropdown Listen Master-/Detail-Schnittstellen erstellt.</span><span class="sxs-lookup"><span data-stu-id="026a7-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="026a7-183">Ausführliche Informationen zum Implementieren eines solchen Master/Detail-Berichts finden Sie im Tutorial [Master/Detail-Filterung mit einem Dropdown List](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) -Tutorial.</span><span class="sxs-lookup"><span data-stu-id="026a7-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>

<span data-ttu-id="026a7-184">Öffnen Sie die Seite `ExistingSprocs.aspx` im Ordner `AdvancedDAL`, und ziehen Sie eine Dropdown List aus der Toolbox auf den Designer.</span><span class="sxs-lookup"><span data-stu-id="026a7-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="026a7-185">Legen Sie die Eigenschaft DropDownList s `ID` auf `Categories` und deren `AutoPostBack`-Eigenschaft auf `True`fest.</span><span class="sxs-lookup"><span data-stu-id="026a7-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="026a7-186">Binden Sie als nächstes die Dropdown Liste aus dem Smarttag an eine neue ObjectDataSource mit dem Namen `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="026a7-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="026a7-187">Konfigurieren Sie die ObjectDataSource so, dass die Daten aus der `CategoriesBLL` Klasse `GetCategories` Methode abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="026a7-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="026a7-188">Legen Sie die Dropdown Listen auf den Registerkarten aktualisieren, einfügen und löschen auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="026a7-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="026a7-189">[![Abrufen von Daten aus der Methode "GetCategories" der kategoriesbll-Klasse](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="026a7-190">**Abbildung 7**: Abrufen von Daten aus der `CategoriesBLL`-Klasse `GetCategories`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>

<span data-ttu-id="026a7-191">[![die Dropdown Listen auf den Registerkarten aktualisieren, einfügen und löschen auf (keine) festgelegt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="026a7-192">**Abbildung 8**: Festlegen der Dropdown Listen auf den Registerkarten "Aktualisieren", "Einfügen" und "Löschen" auf "(keine)" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>

<span data-ttu-id="026a7-193">Nachdem Sie den ObjectDataSource-Assistenten abgeschlossen haben, konfigurieren Sie die Dropdown Liste, um das `CategoryName` Datenfeld anzuzeigen und das `CategoryID` Feld als `Value` für jede `ListItem`zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="026a7-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="026a7-194">An diesem Punkt sollten das deklarative Markup DropDownList und ObjectDataSource s in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="026a7-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="026a7-195">Ziehen Sie als nächstes eine GridView-Ansicht auf den Designer, und platzieren Sie Sie unterhalb der Dropdown Liste.</span><span class="sxs-lookup"><span data-stu-id="026a7-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="026a7-196">Legen Sie die `ID` GridView s auf `ProductsByCategory` fest, und binden Sie das Smarttag an eine neue ObjectDataSource mit dem Namen `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="026a7-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="026a7-197">Konfigurieren Sie die `ProductsByCategoryDataSource` ObjectDataSource so, dass Sie die `ProductsBLLWithSprocs`-Klasse verwendet, damit Sie Ihre Daten mithilfe der `GetProductsByCategoryID(categoryID)`-Methode abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="026a7-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="026a7-198">Da diese GridView nur zum Anzeigen von Daten verwendet wird, legen Sie die Dropdown Listen auf den Registerkarten aktualisieren, einfügen und löschen auf (keine) fest, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="026a7-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>

<span data-ttu-id="026a7-199">[![konfigurieren Sie ObjectDataSource für die Verwendung der productbllwithsprocs-Klasse.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="026a7-200">**Abbildung 9**: Konfigurieren von ObjectDataSource für die Verwendung der `ProductsBLLWithSprocs`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>

<span data-ttu-id="026a7-201">[![Abrufen von Daten von der getproduczbycategoryid (CategoryID)-Methode](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="026a7-202">**Abbildung 10**: Abrufen von Daten aus der `GetProductsByCategoryID(categoryID)`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>

<span data-ttu-id="026a7-203">Die auf der Registerkarte auswählen ausgewählte Methode erwartet einen Parameter, daher werden Sie im letzten Schritt des Assistenten aufgefordert, den Parameter s Quelle einzugeben.</span><span class="sxs-lookup"><span data-stu-id="026a7-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="026a7-204">Legen Sie in der Dropdown Liste Parameter Quelle die Option Control fest, und wählen Sie in der Dropdown Liste ControlID das `Categories` Steuerelement aus.</span><span class="sxs-lookup"><span data-stu-id="026a7-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="026a7-205">Klicken Sie auf Fertigstellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="026a7-205">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="026a7-206">[![die Dropdown List Kategorien als Quelle für den CategoryID-Parameter verwenden.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="026a7-207">**Abbildung 11**: Verwenden der Dropdown List-`Categories` als Quelle des `categoryID`-Parameters ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>

<span data-ttu-id="026a7-208">Nachdem Sie den ObjectDataSource-Assistenten abgeschlossen haben, fügt Visual Studio boundfields und ein CheckBoxField für jedes der Product Data-Felder hinzu.</span><span class="sxs-lookup"><span data-stu-id="026a7-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="026a7-209">Sie können diese Felder beliebig anpassen.</span><span class="sxs-lookup"><span data-stu-id="026a7-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="026a7-210">Besuchen Sie die Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="026a7-210">Visit the page through a browser.</span></span> <span data-ttu-id="026a7-211">Beim Besuch der Seite wird die Kategorie Getränke und die entsprechenden Produkte im Raster angezeigt.</span><span class="sxs-lookup"><span data-stu-id="026a7-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="026a7-212">Wenn Sie die Dropdown Liste in eine Alternative Kategorie ändern, wie in Abbildung 12 gezeigt, wird ein Postback ausgelöst und das Raster mit den Produkten der neu ausgewählten Kategorie erneut geladen.</span><span class="sxs-lookup"><span data-stu-id="026a7-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>

<span data-ttu-id="026a7-213">[![werden die Produkte in der Kategorie "Produkte" angezeigt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="026a7-214">**Abbildung 12**: die Produkte in der Kategorie "Produkte" werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>

## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="026a7-215">Schritt 5: Umlagern von s-Anweisungen einer gespeicherten Prozedur innerhalb des Gültigkeits Bereichs einer Transaktion</span><span class="sxs-lookup"><span data-stu-id="026a7-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="026a7-216">Im Tutorial zum [Umpacken von Daten Bank Änderungen in einer Transaktion](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) wurden Techniken zum Ausführen einer Reihe von Daten Bank Änderungs Anweisungen im Rahmen einer Transaktion erläutert.</span><span class="sxs-lookup"><span data-stu-id="026a7-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="026a7-217">Beachten Sie, dass die Änderungen, die mit dem Rahmen einer Transaktion ausgeführt werden, entweder alle erfolgreich verlaufen oder alle fehlschlagen, was Atomizität garantiert.</span><span class="sxs-lookup"><span data-stu-id="026a7-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="026a7-218">Zu den Verfahren für die Verwendung von Transaktionen gehören:</span><span class="sxs-lookup"><span data-stu-id="026a7-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="026a7-219">Mithilfe der Klassen im `System.Transactions`-Namespace</span><span class="sxs-lookup"><span data-stu-id="026a7-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="026a7-220">Wenn die Datenzugriffs Ebene verwendet wird, verwenden Sie ADO.NET-Klassen wie `SqlTransaction`und</span><span class="sxs-lookup"><span data-stu-id="026a7-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="026a7-221">Direktes Hinzufügen der T-SQL-Transaktions Befehle in der gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="026a7-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="026a7-222">Im Tutorial zum *Umwickeln von Daten Bank Änderungen in einer Transaktion* wurden die ADO.NET-Klassen in der dal verwendet.</span><span class="sxs-lookup"><span data-stu-id="026a7-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="026a7-223">Im restlichen Teil dieses Tutorials wird untersucht, wie eine Transaktion mithilfe von T-SQL-Befehlen aus einer gespeicherten Prozedur verwaltet wird.</span><span class="sxs-lookup"><span data-stu-id="026a7-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="026a7-224">Die drei wichtigsten SQL-Befehle zum manuellen Starten, Ausführen eines Commits und Rollbacks für eine Transaktion sind `BEGIN TRANSACTION`, `COMMIT TRANSACTION`bzw. `ROLLBACK TRANSACTION`.</span><span class="sxs-lookup"><span data-stu-id="026a7-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="026a7-225">Wie beim ADO.net-Ansatz müssen wir bei der Verwendung von Transaktionen innerhalb einer gespeicherten Prozedur das folgende Muster anwenden:</span><span class="sxs-lookup"><span data-stu-id="026a7-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="026a7-226">Geben Sie den Start einer Transaktion an.</span><span class="sxs-lookup"><span data-stu-id="026a7-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="026a7-227">Führen Sie die SQL-Anweisungen aus, die die Transaktion umfassen.</span><span class="sxs-lookup"><span data-stu-id="026a7-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="026a7-228">Wenn in einer der Anweisungen aus Schritt 2 ein Fehler auftritt, führen Sie ein Rollback für die Transaktion aus.</span><span class="sxs-lookup"><span data-stu-id="026a7-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="026a7-229">Wenn alle Anweisungen aus Schritt 2 ohne Fehler abgeschlossen werden, führen Sie einen Commit für die Transaktion aus.</span><span class="sxs-lookup"><span data-stu-id="026a7-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="026a7-230">Dieses Muster kann in der T-SQL-Syntax mithilfe der folgenden Vorlage implementiert werden:</span><span class="sxs-lookup"><span data-stu-id="026a7-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="026a7-231">Die Vorlage beginnt mit der Definition eines `TRY...CATCH` Blocks, einem neuen Konstrukt in SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="026a7-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="026a7-232">Wie bei `Try...Catch` Blöcken in Visual Basic führt der SQL-`TRY...CATCH` Block die Anweisungen im `TRY` Block aus.</span><span class="sxs-lookup"><span data-stu-id="026a7-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="026a7-233">Wenn eine Anweisung einen Fehler auslöst, wird die Steuerung sofort an den `CATCH`-Block übertragen.</span><span class="sxs-lookup"><span data-stu-id="026a7-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="026a7-234">Wenn keine Fehler auftreten, die die SQL-Anweisungen ausführen, mit denen die Transaktion zusammengeführt wird, führt die `COMMIT TRANSACTION` Anweisung einen Commit für die Änderungen aus und schließt die Transaktion</span><span class="sxs-lookup"><span data-stu-id="026a7-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="026a7-235">Wenn jedoch eine der-Anweisungen zu einem Fehler führt, gibt die `ROLLBACK TRANSACTION` im `CATCH`-Block die Datenbank vor dem Start der Transaktion in ihren Zustand zurück.</span><span class="sxs-lookup"><span data-stu-id="026a7-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="026a7-236">Die gespeicherte Prozedur löst auch einen Fehler mit dem [Befehl RAISERROR](https://msdn.microsoft.com/library/ms178592.aspx)aus, der bewirkt, dass eine `SqlException` in der Anwendung ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="026a7-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="026a7-237">Da der `TRY...CATCH`-Block neu in SQL Server 2005 ist, funktioniert die obige Vorlage nicht, wenn Sie ältere Versionen von Microsoft SQL Server verwenden.</span><span class="sxs-lookup"><span data-stu-id="026a7-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="026a7-238">Wenn Sie nicht SQL Server 2005 verwenden, lesen Sie [Verwalten von Transaktionen in SQL Server gespeicherten Prozeduren](http://www.4guysfromrolla.com/webtech/080305-1.shtml) für eine Vorlage, die mit anderen Versionen von SQL Server funktioniert.</span><span class="sxs-lookup"><span data-stu-id="026a7-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>

<span data-ttu-id="026a7-239">Betrachten wir ein konkretes Beispiel.</span><span class="sxs-lookup"><span data-stu-id="026a7-239">Let s look at a concrete example.</span></span> <span data-ttu-id="026a7-240">Eine FOREIGN KEY-Einschränkung besteht zwischen den Tabellen "`Categories`" und "`Products`", was bedeutet, dass jedes `CategoryID` Feld in der `Products` Tabelle einem `CategoryID` Wert in der `Categories` Tabelle zugeordnet werden muss.</span><span class="sxs-lookup"><span data-stu-id="026a7-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="026a7-241">Jede Aktion, die gegen diese Einschränkung verstoßen würde, z. b. der Versuch, eine Kategorie zu löschen, die über zugeordnete Produkte verfügt, führt zu einer Verletzung der Fremdschlüssel Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="026a7-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="026a7-242">Um dies zu überprüfen, besuchen Sie das Beispiel aktualisieren und Löschen vorhandener Binärdaten im Abschnitt Arbeiten mit Binärdaten (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="026a7-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="026a7-243">Auf dieser Seite werden die einzelnen Kategorien im System zusammen mit den Schaltflächen Bearbeiten und löschen aufgelistet (siehe Abbildung 13). Wenn Sie jedoch versuchen, eine Kategorie zu löschen, die über zugeordnete Produkte verfügt, z. b. Getränke, schlägt der Löschvorgang aufgrund einer Verletzung der Fremdschlüssel Einschränkung fehl (siehe Abbildung 14).</span><span class="sxs-lookup"><span data-stu-id="026a7-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>

<span data-ttu-id="026a7-244">[![jede Kategorie in einer GridView mit den Schaltflächen "Bearbeiten" und "Löschen" angezeigt wird](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="026a7-245">**Abbildung 13**: jede Kategorie wird in einer GridView mit den Schaltflächen "Bearbeiten" und "Löschen" angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>

<span data-ttu-id="026a7-246">[![Sie keine Kategorie löschen können, die über vorhandene Produkte verfügt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="026a7-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="026a7-247">**Abbildung 14**: Sie können keine Kategorie löschen, die über vorhandene Produkte verfügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="026a7-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>

<span data-ttu-id="026a7-248">Stellen Sie sich jedoch vor, dass Kategorien gelöscht werden sollen, unabhängig davon, ob Sie über zugeordnete Produkte verfügen.</span><span class="sxs-lookup"><span data-stu-id="026a7-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="026a7-249">Wenn eine Kategorie mit Produkten gelöscht werden soll, stellen Sie sich vor, dass wir auch die vorhandenen Produkte löschen möchten (eine andere Möglichkeit wäre, die Produkte einfach `CategoryID` Werte auf `NULL`) festzulegen.</span><span class="sxs-lookup"><span data-stu-id="026a7-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="026a7-250">Diese Funktion kann durch die kaskadierenden Regeln der FOREIGN KEY-Einschränkung implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="026a7-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="026a7-251">Alternativ könnten Sie eine gespeicherte Prozedur erstellen, die einen `@CategoryID` Eingabeparameter akzeptiert und beim Aufrufen explizit alle zugeordneten Produkte und dann die angegebene Kategorie löscht.</span><span class="sxs-lookup"><span data-stu-id="026a7-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="026a7-252">Der erste Versuch einer solchen gespeicherten Prozedur könnte wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="026a7-252">Our first attempt at such a stored procedure might look like the following:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="026a7-253">Die zugeordneten Produkte und die Kategorie werden zwar definitiv gelöscht, dies erfolgt jedoch nicht unter dem Rahmen einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="026a7-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="026a7-254">Angenommen, es gibt eine andere FOREIGN KEY-Einschränkung für `Categories`, die das Löschen eines bestimmten `@CategoryID` Werts untersagt.</span><span class="sxs-lookup"><span data-stu-id="026a7-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="026a7-255">Das Problem besteht darin, dass in einem solchen Fall alle Produkte gelöscht werden, bevor Sie versuchen, die Kategorie zu löschen.</span><span class="sxs-lookup"><span data-stu-id="026a7-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="026a7-256">Das Ergebnis ist, dass diese gespeicherte Prozedur für eine solche Kategorie alle Produkte entfernen würde, während die Kategorie verbleibt, da Sie noch über verwandte Datensätze in einer anderen Tabelle verfügt.</span><span class="sxs-lookup"><span data-stu-id="026a7-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="026a7-257">Wenn die gespeicherte Prozedur jedoch in den Gültigkeitsbereich einer Transaktion umschließt, wird für die `Products` Tabelle bei einem fehlerhaften Löschvorgang auf `Categories`ein Rollback ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="026a7-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="026a7-258">Das folgende Skript für gespeicherte Prozeduren verwendet eine Transaktion, um die Atomizität zwischen den beiden `DELETE`-Anweisungen sicherzustellen:</span><span class="sxs-lookup"><span data-stu-id="026a7-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="026a7-259">Nehmen Sie sich einen Moment Zeit, um die gespeicherte Prozedur `Categories_Delete` der Northwind-Datenbank hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="026a7-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="026a7-260">Weitere Informationen zum Hinzufügen gespeicherter Prozeduren zu einer Datenbank finden Sie in Schritt 1.</span><span class="sxs-lookup"><span data-stu-id="026a7-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="026a7-261">Schritt 6: Aktualisieren der`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="026a7-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="026a7-262">Obwohl die gespeicherte Prozedur `Categories_Delete` der-Datenbank hinzugefügt wurde, ist die DAL zurzeit so konfiguriert, dass Sie Ad-hoc-SQL-Anweisungen verwendet, um den Löschvorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="026a7-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="026a7-263">Wir müssen den `CategoriesTableAdapter` aktualisieren und ihn anweisen, stattdessen die gespeicherte Prozedur `Categories_Delete` zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="026a7-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="026a7-264">An früherer Stelle in diesem Tutorial haben wir mit dem `NorthwindWithSprocs` DataSet gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="026a7-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="026a7-265">Dieses Dataset verfügt jedoch nur über eine einzige Entität, `ProductsDataTable`, und wir müssen mit Kategorien arbeiten.</span><span class="sxs-lookup"><span data-stu-id="026a7-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="026a7-266">Daher wird für den Rest dieses Tutorials die Datenzugriffs Schicht i m, die auf das `Northwind` DataSet verweist, das erste, das wir im Tutorial [Erstellen einer Datenzugriffs Ebene](../introduction/creating-a-data-access-layer-vb.md) erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="026a7-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>

<span data-ttu-id="026a7-267">Öffnen Sie das Northwind-DataSet, wählen Sie das `CategoriesTableAdapter`aus, und wechseln Sie zum Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="026a7-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="026a7-268">In der Eigenschaftenfenster werden die `InsertCommand`, `UpdateCommand`, `DeleteCommand`und `SelectCommand`, die vom TableAdapter verwendet werden, sowie der Name und die Verbindungsinformationen aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="026a7-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="026a7-269">Erweitern Sie die `DeleteCommand`-Eigenschaft, um deren Details anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="026a7-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="026a7-270">Wie in Abbildung 15 dargestellt, wird die Eigenschaft `DeleteCommand` s `CommandType` auf Text festgelegt, der Sie anweist, den Text in der `CommandText`-Eigenschaft als Ad-hoc-SQL-Abfrage zu senden.</span><span class="sxs-lookup"><span data-stu-id="026a7-270">As Figure 15 shows, the `DeleteCommand` s `CommandType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>

![Wählen Sie im Designer den categoriestableadapter aus, um seine Eigenschaften im Eigenschaften Fenster anzuzeigen.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="026a7-272">**Abbildung 15**: Auswählen des `CategoriesTableAdapter` im Designer, um seine Eigenschaften im Eigenschaften Fenster anzuzeigen</span><span class="sxs-lookup"><span data-stu-id="026a7-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>

<span data-ttu-id="026a7-273">Um diese Einstellungen zu ändern, wählen Sie den Text (DeleteCommand) im Eigenschaftenfenster aus, und wählen Sie (neu) aus der Dropdown Liste aus.</span><span class="sxs-lookup"><span data-stu-id="026a7-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="026a7-274">Dadurch werden die Einstellungen für die Eigenschaften "`CommandText`", "`CommandType`" und "`Parameters`" gelöscht.</span><span class="sxs-lookup"><span data-stu-id="026a7-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="026a7-275">Legen Sie als nächstes die `CommandType`-Eigenschaft auf `StoredProcedure` fest, und geben Sie dann den Namen der gespeicherten Prozedur für die `CommandText` ein (`dbo.Categories_Delete`).</span><span class="sxs-lookup"><span data-stu-id="026a7-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="026a7-276">Wenn Sie sicherstellen, dass die Eigenschaften in dieser Reihenfolge eingegeben werden, geben Sie zuerst die `CommandType` und dann die `CommandText`-Visual Studio automatisch die Parameter Auflistung ein.</span><span class="sxs-lookup"><span data-stu-id="026a7-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="026a7-277">Wenn Sie diese Eigenschaften nicht in dieser Reihenfolge eingeben, müssen Sie die Parameter manuell über den Parameter Sammlungs-Editor hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="026a7-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="026a7-278">In beiden Fällen ist es ratsam, auf die Ellipsen in der Parameters-Eigenschaft zu klicken, um den Parameter Auflistungs-Editor anzuzeigen, um zu überprüfen, ob die korrekten Änderungen an den Parametereinstellungen vorgenommen wurden (siehe Abbildung 16).</span><span class="sxs-lookup"><span data-stu-id="026a7-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="026a7-279">Wenn im Dialogfeld keine Parameter angezeigt werden, fügen Sie den `@CategoryID`-Parameter manuell hinzu (Sie müssen den `@RETURN_VALUE`-Parameter nicht hinzufügen).</span><span class="sxs-lookup"><span data-stu-id="026a7-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>

![Stellen Sie sicher, dass die Parametereinstellungen richtig sind.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="026a7-281">**Abbildung 16**: sicherstellen, dass die Parametereinstellungen richtig sind</span><span class="sxs-lookup"><span data-stu-id="026a7-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>

<span data-ttu-id="026a7-282">Nachdem die DAL aktualisiert wurde, werden durch das Löschen einer Kategorie automatisch alle zugehörigen Produkte gelöscht. Dies geschieht unter dem Rahmen einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="026a7-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="026a7-283">Um dies zu überprüfen, kehren Sie zur Seite aktualisieren und Löschen vorhandener Binärdaten zurück, und klicken Sie auf die Schaltfläche Löschen für eine der Kategorien.</span><span class="sxs-lookup"><span data-stu-id="026a7-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="026a7-284">Mit einem einzigen Mausklick werden die Kategorie und alle zugehörigen Produkte gelöscht.</span><span class="sxs-lookup"><span data-stu-id="026a7-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="026a7-285">Vor dem Testen der gespeicherten Prozedur `Categories_Delete`, mit der eine Reihe von Produkten zusammen mit der ausgewählten Kategorie gelöscht werden, kann es ratsam sein, eine Sicherungskopie der Datenbank zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="026a7-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="026a7-286">Wenn Sie die `NORTHWND.MDF`-Datenbank in `App_Data`verwenden, schließen Sie einfach Visual Studio, und kopieren Sie die MDF-und LDF-Dateien in `App_Data` in einen anderen Ordner.</span><span class="sxs-lookup"><span data-stu-id="026a7-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="026a7-287">Nachdem Sie die Funktionalität getestet haben, können Sie die Datenbank wiederherstellen, indem Sie Visual Studio schließen und die aktuellen MDF-und LDF-Dateien in `App_Data` durch die Sicherungskopien ersetzen.</span><span class="sxs-lookup"><span data-stu-id="026a7-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>

## <a name="summary"></a><span data-ttu-id="026a7-288">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="026a7-288">Summary</span></span>

<span data-ttu-id="026a7-289">Während der Assistent für TableAdapter s automatisch gespeicherte Prozeduren für uns generiert, gibt es einige Zeiten, in denen diese gespeicherten Prozeduren möglicherweise bereits erstellt wurden oder stattdessen manuell oder mit anderen Tools erstellt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="026a7-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="026a7-290">Um derartige Szenarios zu ermöglichen, kann der TableAdapter auch so konfiguriert werden, dass er auf eine vorhandene gespeicherte Prozedur verweist.</span><span class="sxs-lookup"><span data-stu-id="026a7-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="026a7-291">In diesem Tutorial haben wir uns mit dem manuellen Hinzufügen gespeicherter Prozeduren zu einer Datenbank über die Visual Studio-Umgebung und der Übertragung der TableAdapter s-Methoden an diese gespeicherten Prozeduren beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="026a7-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="026a7-292">Wir haben auch die T-SQL-Befehle und das Skript Muster untersucht, die zum Starten, zum Commit und zum Rollback von Transaktionen innerhalb einer gespeicherten Prozedur verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="026a7-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="026a7-293">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="026a7-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="026a7-294">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="026a7-294">About the Author</span></span>

<span data-ttu-id="026a7-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="026a7-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="026a7-296">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="026a7-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="026a7-297">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="026a7-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="026a7-298">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="026a7-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="026a7-299">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="026a7-299">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="026a7-300">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="026a7-300">Special Thanks To</span></span>

<span data-ttu-id="026a7-301">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="026a7-301">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="026a7-302">Die führenden Reviewer für dieses Tutorial waren Hilton geisenow, S ren Jacob Lauritsen und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="026a7-302">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="026a7-303">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="026a7-303">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="026a7-304">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="026a7-304">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="026a7-305">[Zurück](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Weiter](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="026a7-305">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>
