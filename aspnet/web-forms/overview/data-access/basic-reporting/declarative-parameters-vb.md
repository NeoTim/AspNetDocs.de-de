---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Deklarative Parameter (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial wird veranschaulicht, wie Sie einen Parameter, der auf einen hart codierten Wert festgelegt ist, verwenden, um die Daten auszuwählen, die in einem DetailsView-Steuerelement angezeigt werden.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78483129"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="04f5e-103">Deklarative Parameter (VB)</span><span class="sxs-lookup"><span data-stu-id="04f5e-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="04f5e-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="04f5e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="04f5e-105">[Beispiel-app herunterladen](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) oder [PDF herunterladen](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="04f5e-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="04f5e-106">In diesem Tutorial wird veranschaulicht, wie Sie einen Parameter, der auf einen hart codierten Wert festgelegt ist, verwenden, um die Daten auszuwählen, die in einem DetailsView-Steuerelement angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="04f5e-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="04f5e-107">Introduction</span></span>

<span data-ttu-id="04f5e-108">Im [letzten Tutorial](displaying-data-with-the-objectdatasource-vb.md) haben wir uns mit der Anzeige von Daten mit den Steuerelementen GridView, DetailsView und FormView befasst, die an ein ObjectDataSource-Steuerelement gebunden sind, das die `GetProducts()`-Methode aus der `ProductsBLL`-Klasse aufgerufen hat.</span><span class="sxs-lookup"><span data-stu-id="04f5e-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="04f5e-109">Die `GetProducts()`-Methode gibt eine stark typisierte Datentabelle zurück, die mit allen Datensätzen aus der `Products` Tabelle der Northwind-Datenbank aufgefüllt wurde.</span><span class="sxs-lookup"><span data-stu-id="04f5e-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="04f5e-110">Die `ProductsBLL`-Klasse enthält zusätzliche Methoden zum Zurückgeben von nur Teilmengen der Products-`GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`und `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="04f5e-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="04f5e-111">Diese drei Methoden erwarten einen Eingabeparameter, der angibt, wie die zurückgegebenen Produktinformationen gefiltert werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="04f5e-112">Die ObjectDataSource kann verwendet werden, um Methoden aufzurufen, die Eingabeparameter erwarten. hierfür müssen wir jedoch angeben, wo die Werte für diese Parameter stammen.</span><span class="sxs-lookup"><span data-stu-id="04f5e-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="04f5e-113">Die Parameterwerte können hart codiert sein oder aus einer Vielzahl dynamischer Quellen stammen, wie z. b. QueryString-Werte, Sitzungsvariablen, den Eigenschafts Wert eines websteuer Elements auf der Seite oder andere.</span><span class="sxs-lookup"><span data-stu-id="04f5e-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="04f5e-114">In diesem Tutorial wird veranschaulicht, wie Sie einen Parameter verwenden, der auf einen hart codierten Wert festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="04f5e-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="04f5e-115">Insbesondere wird das Hinzufügen einer DetailsView zu der Seite untersucht, die Informationen zu einem bestimmten Produkt anzeigt, d. h. die Gumbo-Mischung von Chef Anton, die eine `ProductID` von 5 hat.</span><span class="sxs-lookup"><span data-stu-id="04f5e-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="04f5e-116">Als Nächstes erfahren Sie, wie der Parameterwert auf Grundlage eines websteuer Elements festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="04f5e-117">Insbesondere verwenden wir ein Textfeld, um den Benutzer in ein Land einzugeben. Anschließend können Sie auf eine Schaltfläche klicken, um die Liste der Lieferanten in diesem Land anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="04f5e-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="04f5e-118">Verwenden eines hart codierten Parameter Werts</span><span class="sxs-lookup"><span data-stu-id="04f5e-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="04f5e-119">Beginnen Sie im ersten Beispiel mit dem Hinzufügen eines DetailsView-Steuer Elements zur Seite `DeclarativeParams.aspx` im `BasicReporting`-Ordner.</span><span class="sxs-lookup"><span data-stu-id="04f5e-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="04f5e-120">Wählen Sie aus der Dropdown Liste aus dem Smarttag der DetailsView &lt;neuen Datenquellen&gt; aus, und wählen Sie die Option ObjectDataSource hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="04f5e-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="04f5e-121">[![der Seite eine ObjectDataSource hinzufügen](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="04f5e-122">**Abbildung 1**: Hinzufügen von ObjectDataSource zur Seite ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="04f5e-123">Dadurch wird automatisch der Assistent zum Auswählen von Datenquellen des ObjectDataSource-Steuer Elements gestartet.</span><span class="sxs-lookup"><span data-stu-id="04f5e-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="04f5e-124">Wählen Sie auf dem ersten Bildschirm des Assistenten die `ProductsBLL` Klasse aus.</span><span class="sxs-lookup"><span data-stu-id="04f5e-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="04f5e-125">[![wählen Sie die productbll-Klasse aus.](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="04f5e-126">**Abbildung 2**: Auswählen der `ProductsBLL` Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="04f5e-127">Da wir Informationen zu einem bestimmten Produktanzeigen möchten, möchten wir die `GetProductByProductID(productID)`-Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="04f5e-128">[![wählen Sie die Methode getproductbyproductid (ProductID) aus.](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="04f5e-129">**Abbildung 3**: Auswählen der `GetProductByProductID(productID)` Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="04f5e-130">Da die ausgewählte Methode einen Parameter enthält, gibt es einen weiteren Bildschirm für den Assistenten, bei dem wir aufgefordert werden, den Wert zu definieren, der für den Parameter verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="04f5e-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="04f5e-131">Die Liste auf der linken Seite zeigt alle Parameter für die ausgewählte Methode an.</span><span class="sxs-lookup"><span data-stu-id="04f5e-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="04f5e-132">Für `GetProductByProductID(productID)` gibt es nur eine `productID`.</span><span class="sxs-lookup"><span data-stu-id="04f5e-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="04f5e-133">Auf der rechten Seite können Sie den Wert für den ausgewählten Parameter angeben.</span><span class="sxs-lookup"><span data-stu-id="04f5e-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="04f5e-134">Die Dropdown Liste Parameter Quelle listet die verschiedenen möglichen Quellen für den Parameterwert auf.</span><span class="sxs-lookup"><span data-stu-id="04f5e-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="04f5e-135">Da wir für den `productID` Parameter einen hart codierten Wert von "5" angeben möchten, belassen Sie die Parameter Quelle "None", und geben Sie 5 in das Textfeld "DefaultValue" ein.</span><span class="sxs-lookup"><span data-stu-id="04f5e-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="04f5e-136">[![ein hart codierter Parameter Wert von 5 für den ProductID-Parameter verwendet wird.](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="04f5e-137">**Abbildung 4**: der hart codierte Parameterwert 5 wird für den `productID` Parameter verwendet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="04f5e-138">Nach Abschluss des Assistenten zum Konfigurieren von Datenquellen enthält das deklarative Markup des ObjectDataSource-Steuer Elements ein `Parameter` Objekt in der `SelectParameters` Auflistung für jeden der Eingabeparameter, die von der in der `SelectMethod`-Eigenschaft definierten Methode erwartet werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="04f5e-139">Da die Methode, die wir in diesem Beispiel verwenden, nur einen Eingabeparameter erwartet (`parameterID`), gibt es hier nur einen Eintrag.</span><span class="sxs-lookup"><span data-stu-id="04f5e-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="04f5e-140">Die `SelectParameters`-Auflistung kann jede Klasse enthalten, die von der `Parameter`-Klasse im `System.Web.UI.WebControls`-Namespace abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="04f5e-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="04f5e-141">Für hart codierte Parameterwerte wird die Basis `Parameter` Klasse verwendet, aber für die anderen Parameter Quell Optionen wird eine abgeleitete `Parameter` Klasse verwendet; Sie können bei Bedarf auch eigene [benutzerdefinierte Parametertypen](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)erstellen.</span><span class="sxs-lookup"><span data-stu-id="04f5e-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="04f5e-142">Wenn Sie auf Ihrem Computer daran arbeiten, kann das deklarative Markup, das Sie zu diesem Zeitpunkt sehen, Werte für die Eigenschaften `InsertMethod`, `UpdateMethod`und `DeleteMethod` sowie `DeleteParameters`enthalten.</span><span class="sxs-lookup"><span data-stu-id="04f5e-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="04f5e-143">Der Assistent zum Auswählen von Datenquellen von ObjectDataSource gibt automatisch die Methoden aus dem `ProductBLL` an, die zum Einfügen, aktualisieren und Löschen verwendet werden sollen. Wenn Sie diese also nicht explizit löschen, werden Sie im obigen Markup enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="04f5e-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="04f5e-144">Wenn Sie diese Seite aufrufen, ruft das datenweb-Steuerelement die `Select`-Methode von ObjectDataSource auf, die die `GetProductByProductID(productID)`-Methode der `ProductsBLL` Klasse aufruft, indem der hart codierte Wert 5 für den `productID` Eingabeparameter verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="04f5e-145">Die Methode gibt ein stark typisiertes `ProductDataTable` Objekt zurück, das eine einzelne Zeile mit Informationen über die Gumbo-Mischung von Chef Anton (das Produkt mit `ProductID` 5) enthält.</span><span class="sxs-lookup"><span data-stu-id="04f5e-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="04f5e-146">[die ![Informationen zur Gumbo-Mischung von Chef Anton werden angezeigt.](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="04f5e-147">**Abbildung 5**: Informationen zur Gumbo-Mischung von Chef Anton werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="04f5e-148">Festlegen des Parameter Werts auf den Eigenschafts Wert eines websteuer Elements</span><span class="sxs-lookup"><span data-stu-id="04f5e-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="04f5e-149">Die Parameterwerte der ObjectDataSource können auch basierend auf dem Wert eines websteuer Elements auf der Seite festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="04f5e-150">Um dies zu veranschaulichen, haben wir eine GridView, die alle Lieferanten auflistet, die sich in einem Land befinden, das vom Benutzer angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="04f5e-151">Um dies zu erreichen, fügen Sie der Seite, in die der Benutzer einen Ländernamen eingeben kann, ein Textfeld hinzu.</span><span class="sxs-lookup"><span data-stu-id="04f5e-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="04f5e-152">Legen Sie die `ID`-Eigenschaft dieses Textfeld-Steuer Elements auf `CountryName`fest.</span><span class="sxs-lookup"><span data-stu-id="04f5e-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="04f5e-153">Fügen Sie auch ein Schaltflächen-websteuer Element hinzu.</span><span class="sxs-lookup"><span data-stu-id="04f5e-153">Also add a Button Web control.</span></span>

<span data-ttu-id="04f5e-154">[![der Seite mit der ID CountryName ein Textfeld hinzufügen](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="04f5e-155">**Abbildung 6**: Hinzufügen eines Textfelds zur Seite mit `ID` `CountryName` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="04f5e-156">Fügen Sie als nächstes der Seite ein GridView-Objekt hinzu, und wählen Sie aus dem Smarttag eine neue ObjectDataSource hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="04f5e-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="04f5e-157">Da wir Lieferanteninformationen anzeigen möchten, wählen Sie die `SuppliersBLL`-Klasse auf dem ersten Bildschirm des Assistenten aus.</span><span class="sxs-lookup"><span data-stu-id="04f5e-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="04f5e-158">Wählen Sie auf dem zweiten Bildschirm die `GetSuppliersByCountry(country)`-Methode aus.</span><span class="sxs-lookup"><span data-stu-id="04f5e-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="04f5e-159">[![wählen Sie die getsuppliersbycountry (Country)-Methode aus.](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="04f5e-160">**Abbildung 7**: Auswählen der `GetSuppliersByCountry(country)` Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="04f5e-161">Da die `GetSuppliersByCountry(country)`-Methode über einen Eingabeparameter verfügt, enthält der Assistent erneut einen letzten Bildschirm zum Auswählen des Parameter Werts.</span><span class="sxs-lookup"><span data-stu-id="04f5e-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="04f5e-162">Legen Sie dieses Mal die Parameter Quelle auf Control fest.</span><span class="sxs-lookup"><span data-stu-id="04f5e-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="04f5e-163">Dadurch wird die ControlID-Dropdown Liste mit den Namen der Steuerelemente auf der Seite aufgefüllt. Wählen Sie das `CountryName` Steuerelement aus der Liste aus.</span><span class="sxs-lookup"><span data-stu-id="04f5e-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="04f5e-164">Beim ersten Besuch der Seite ist das Textfeld `CountryName` leer, sodass keine Ergebnisse zurückgegeben werden und nichts angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="04f5e-165">Wenn Sie einige Ergebnisse standardmäßig anzeigen möchten, legen Sie das Textfeld DefaultValue entsprechend fest.</span><span class="sxs-lookup"><span data-stu-id="04f5e-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="04f5e-166">[![legen Sie den Parameter Wert auf den CountryName-Steuerelement Wert fest.](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="04f5e-167">**Abbildung 8**: Festlegen des Parameter Werts auf den Wert des `CountryName` Steuer Elements ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="04f5e-168">Das deklarative Markup von ObjectDataSource unterscheidet sich geringfügig vom ersten Beispiel mithilfe eines [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) anstelle des Standard-`Parameter` Objekts.</span><span class="sxs-lookup"><span data-stu-id="04f5e-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="04f5e-169">Ein `ControlParameter` verfügt über zusätzliche Eigenschaften, um die `ID` des websteuer Elements und den Eigenschafts Wert anzugeben, der für den Parameter (`PropertyName`) verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="04f5e-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="04f5e-170">Der Assistent zum Konfigurieren von Datenquellen war intelligent genug, um zu bestimmen, dass für ein Textfeld wahrscheinlich die `Text`-Eigenschaft für den Parameterwert verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="04f5e-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="04f5e-171">Wenn Sie jedoch einen anderen Eigenschafts Wert aus dem websteuer Element verwenden möchten, können Sie den `PropertyName` Wert hier ändern oder indem Sie im Assistenten auf den Link Erweiterte Eigenschaften anzeigen klicken.</span><span class="sxs-lookup"><span data-stu-id="04f5e-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="04f5e-172">Wenn Sie die Seite zum ersten Mal aufrufen, ist das `CountryName` Textfeld leer.</span><span class="sxs-lookup"><span data-stu-id="04f5e-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="04f5e-173">Die `Select`-Methode von ObjectDataSource wird weiterhin von der GridView aufgerufen, aber der Wert `Nothing` wird an die `GetSuppliersByCountry(country)`-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="04f5e-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="04f5e-174">Der TableAdapter konvertiert die `Nothing` in einen Daten Bank `NULL` Wert (`DBNull.Value`), aber die von der `GetSuppliersByCountry(country)`-Methode verwendete Abfrage wird so geschrieben, dass Sie keine Werte zurückgibt, wenn ein `NULL` Wert für den `@CategoryID` Parameter angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="04f5e-175">Kurz gesagt, es werden keine Lieferanten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="04f5e-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="04f5e-176">Nachdem der Besucher in ein Land gelangt ist und auf die Schaltfläche Suppliers anzeigen klickt, um ein Postback auszulösen, wird die `Select`-Methode von ObjectDataSource angefordert, und der `Text` Wert des TextBox-Steuer Elements wird als `country`-Parameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="04f5e-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="04f5e-177">[![diese Lieferanten aus Kanada angezeigt werden](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="04f5e-178">**Abbildung 9**: die Lieferanten aus Kanada werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="04f5e-179">Standardmäßige Anzeige aller Lieferanten</span><span class="sxs-lookup"><span data-stu-id="04f5e-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="04f5e-180">Anstatt den Anbietern anzuzeigen, wenn Sie die Seite zum ersten Mal anzeigen, möchten wir ggf. *alle* Lieferanten zuerst anzeigen, sodass der Benutzer die Liste durch Eingeben eines Länder namens in das Textfeld durchlaufen kann.</span><span class="sxs-lookup"><span data-stu-id="04f5e-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="04f5e-181">Wenn das Textfeld leer ist, wird die `GetSuppliersByCountry(country)`-Methode der `SuppliersBLL` Klasse `Nothing` für den *`country`* Eingabeparameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="04f5e-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="04f5e-182">Dieser `Nothing` Wert wird dann in die `GetSupplierByCountry(country)`-Methode der dal weitergegeben, wo er in eine Datenbank `NULL` Wert für den `@Country`-Parameter in der folgenden Abfrage übersetzt wird:</span><span class="sxs-lookup"><span data-stu-id="04f5e-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="04f5e-183">Der Ausdruck `Country = NULL` gibt immer false zurück, auch für Datensätze, deren `Country` Spalte einen `NULL` Wert aufweist. aus diesem Grund werden keine Datensätze zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="04f5e-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="04f5e-184">Um *alle* Lieferanten zurückzugeben, wenn das Textfeld Country leer ist, können wir die `GetSuppliersByCountry(country)`-Methode in der BLL erweitern, um die `GetSuppliers()`-Methode aufzurufen, wenn der Country-Parameter `Nothing` ist, und andernfalls die `GetSuppliersByCountry(country)` Methode der dal aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="04f5e-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="04f5e-185">Dies hat den Effekt, dass alle Lieferanten zurückgegeben werden, wenn kein Land angegeben ist, und die entsprechende Teilmenge der Lieferanten, wenn der Country-Parameter eingeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="04f5e-186">Ändern Sie die `GetSuppliersByCountry(country)`-Methode in der `SuppliersBLL`-Klasse wie folgt:</span><span class="sxs-lookup"><span data-stu-id="04f5e-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="04f5e-187">Mit dieser Änderung werden auf der `DeclarativeParams.aspx` Seite alle Lieferanten angezeigt, wenn Sie zum ersten Mal besucht werden (oder wenn das `CountryName` Textfeld leer ist).</span><span class="sxs-lookup"><span data-stu-id="04f5e-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="04f5e-188">[![alle Lieferanten jetzt standardmäßig angezeigt werden](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="04f5e-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="04f5e-189">**Abbildung 10**: alle Lieferanten werden jetzt standardmäßig angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="04f5e-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="04f5e-190">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="04f5e-190">Summary</span></span>

<span data-ttu-id="04f5e-191">Um Methoden mit Eingabe Parametern verwenden zu können, müssen die Werte für die Parameter in der `SelectParameters` Auflistung von ObjectDataSource angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="04f5e-192">Verschiedene Typen von Parametern ermöglichen, dass der Parameterwert aus unterschiedlichen Quellen abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="04f5e-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="04f5e-193">Der Standard Parametertyp verwendet einen hart codierten Wert, aber ebenso einfach (und ohne eine Codezeile) können Parameterwerte aus der QueryString, den Sitzungsvariablen, Cookies und sogar vom Benutzer eingegebenen Werten aus den websteuer Elementen auf der Seite abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="04f5e-194">In den Beispielen in diesem Tutorial wurde gezeigt, wie deklarative Parameterwerte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="04f5e-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="04f5e-195">Es kann jedoch vorkommen, dass eine Parameter Quelle verwendet werden muss, die nicht verfügbar ist, z. b. das aktuelle Datum und die Uhrzeit, oder wenn unsere Website die Mitgliedschaft verwendet hat, die Benutzer-ID des Besuchers.</span><span class="sxs-lookup"><span data-stu-id="04f5e-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="04f5e-196">In solchen Szenarien können die Parameterwerte Programm gesteuert festgelegt werden, bevor ObjectDataSource die-Methode des zugrunde liegenden Objekts aufruft.</span><span class="sxs-lookup"><span data-stu-id="04f5e-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="04f5e-197">Im [nächsten Tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)erfahren Sie, wie Sie dies erreichen.</span><span class="sxs-lookup"><span data-stu-id="04f5e-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="04f5e-198">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="04f5e-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="04f5e-199">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="04f5e-199">About the Author</span></span>

<span data-ttu-id="04f5e-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="04f5e-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="04f5e-201">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="04f5e-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="04f5e-202">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="04f5e-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="04f5e-203">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="04f5e-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="04f5e-204">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="04f5e-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="04f5e-205">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="04f5e-205">Special Thanks To</span></span>

<span data-ttu-id="04f5e-206">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="04f5e-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="04f5e-207">Der Lead Prüfer für dieses Tutorial war Hilton giesreviewer.</span><span class="sxs-lookup"><span data-stu-id="04f5e-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="04f5e-208">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="04f5e-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="04f5e-209">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="04f5e-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="04f5e-210">[Zurück](displaying-data-with-the-objectdatasource-vb.md)
> [Weiter](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="04f5e-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
