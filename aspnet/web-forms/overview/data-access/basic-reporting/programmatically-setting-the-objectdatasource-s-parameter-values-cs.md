---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: Programmgesteuertes Festlegen von Parameterwerten für dem ObjectDataSource-Steuerelement (c#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial betrachten wir das Hinzufügen einer Methode für unsere DAL und BLL, die einen einzelnen Eingabeparameter akzeptiert und gibt Daten zurück. Im Beispiel wird dieser Parameter wird festgelegt...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 5d9419053b433f501212783d1cd3d9fb4734d63d
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2019
ms.locfileid: "65133129"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="3c765-104">Programmgesteuertes Festlegen der Parameterwerte des ObjectDataSource-Steuerelements (C#)</span><span class="sxs-lookup"><span data-stu-id="3c765-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="3c765-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3c765-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3c765-106">[Beispiel-App herunter](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) oder [PDF-Datei herunterladen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3c765-106">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="3c765-107">In diesem Tutorial betrachten wir das Hinzufügen einer Methode für unsere DAL und BLL, die einen einzelnen Eingabeparameter akzeptiert und gibt Daten zurück.</span><span class="sxs-lookup"><span data-stu-id="3c765-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="3c765-108">Im Beispiel wird dieser Parameter programmgesteuert festlegen.</span><span class="sxs-lookup"><span data-stu-id="3c765-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="3c765-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="3c765-109">Introduction</span></span>

<span data-ttu-id="3c765-110">Wie wir, in gesehen der [vorherigen Tutorial](declarative-parameters-cs.md), eine Reihe von Optionen für das Übergeben von Parameterwerten deklarativ an Methoden mit dem ObjectDataSource-Steuerelement verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="3c765-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="3c765-111">Wenn der Wert des Parameters hartcodiert ist, stammt aus einer Websteuerelement auf der Seite oder befindet sich in einer anderen Quelle, die von einer Datenquelle gelesen werden kann `Parameter` Objekt zu verwenden, z. B., dass der Wert an den Eingabeparameter gebunden werden kann, ohne eine einzige Zeile Code schreiben zu müssen.</span><span class="sxs-lookup"><span data-stu-id="3c765-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="3c765-112">Möglicherweise gibt es jedoch vorkommen, wenn der Wert des Parameters aus einer Quelle, die noch nicht berücksichtigt, von einem der integrierten Datenquelle stammt `Parameter` Objekte.</span><span class="sxs-lookup"><span data-stu-id="3c765-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="3c765-113">Wenn unsere Website Benutzerkonten unterstützt, sollten wir legen Sie den Parameter, die basierend auf dem aktuell angemeldeten des Besuchers Benutzer-ID</span><span class="sxs-lookup"><span data-stu-id="3c765-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="3c765-114">Oder es muss der Wert des Parameters vor dem Senden an dem ObjectDataSource-Steuerelement zugrunde liegende Objekt die Methode anpassen.</span><span class="sxs-lookup"><span data-stu-id="3c765-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="3c765-115">Wenn dem ObjectDataSource-Steuerelement `Select` Methode wird aufgerufen, löst Sie zunächst dem ObjectDataSource-Steuerelement seine [auswählen-Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="3c765-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="3c765-116">Anschließend wird die Methode mit dem ObjectDataSource-Steuerelement zugrunde liegende Objekt aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="3c765-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="3c765-117">Nach Abschluss des dem ObjectDataSource-Steuerelement [ausgewählte Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) ausgelöst wird (Abbildung 1 zeigt diese Abfolge von Ereignissen).</span><span class="sxs-lookup"><span data-stu-id="3c765-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="3c765-118">Die Methode mit dem ObjectDataSource-Steuerelement zugrunde liegende Objekt übergebenen Parameterwerte werden festgelegt oder nach Anpassung können in einem Ereignishandler für die `Selecting` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="3c765-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="3c765-119">[![Dem ObjectDataSource-Steuerelement ausgewählt und Auswählen von Ereignissen auslösen vor und nach einem zugrunde liegenden Objekts-Methode wird aufgerufen.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="3c765-120">**Abbildung 1**: Das "ObjectDataSource" `Selected` und `Selecting` Fire Ereignisse vor und nach einem zugrunde liegenden Objekts-Methode wird aufgerufen ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="3c765-121">In diesem Tutorial betrachten wir das Hinzufügen einer Methode für unsere DAL und BLL, die einen einzelnen Eingabeparameter akzeptiert `Month`, des Typs `int` und gibt eine `EmployeesDataTable` diejenigen Mitarbeiter, die die stellenausschreibung Anniversary in das angegebene Objekt `Month`.</span><span class="sxs-lookup"><span data-stu-id="3c765-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="3c765-122">In unserem Beispiel wird dieser Parameter programmgesteuert basierend auf dem aktuellen Monat mit einer Liste von "Employee Geburtstage in diesem Monat." festgelegt.</span><span class="sxs-lookup"><span data-stu-id="3c765-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="3c765-123">Fangen wir an!</span><span class="sxs-lookup"><span data-stu-id="3c765-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="3c765-124">Schritt 1: Hinzufügen einer Methode`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="3c765-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="3c765-125">Unserem ersten Beispiel müssen wir eine Möglichkeit zum Abrufen von diejenigen Mitarbeiter hinzufügen, deren `HireDate` in einem angegebenen Monat aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="3c765-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="3c765-126">Diese Funktionalität gemäß unserer Architektur bereitstellen, wir zuerst erstellen Sie eine Methode in müssen `EmployeesTableAdapter` , der die richtigen SQL-Anweisung zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="3c765-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="3c765-127">Zu diesem Zweck öffnen Sie zunächst der typisierte Datasets Northwind.</span><span class="sxs-lookup"><span data-stu-id="3c765-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="3c765-128">Mit der rechten Maustaste auf die `EmployeesTableAdapter` bezeichnen, und wählen Sie die Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="3c765-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="3c765-129">[![Fügen Sie eine neue Abfrage hinzu, um die EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="3c765-130">**Abbildung 2**: Fügen Sie eine neue Abfrage, die `EmployeesTableAdapter` ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="3c765-131">Wählen Sie eine SQL­Anweisung hinzufügen, die Zeilen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="3c765-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="3c765-132">Sie beim Erreichen der Specify eine `SELECT` Anweisung Bildschirm standardmäßig `SELECT` -Anweisung für die `EmployeesTableAdapter` werden bereits geladen.</span><span class="sxs-lookup"><span data-stu-id="3c765-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="3c765-133">Fügen Sie einfach die `WHERE` Klausel: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="3c765-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="3c765-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) wird eine T-SQL-Funktion, die einen bestimmtes Datumsteil gibt eine `datetime` geben; in diesem Fall verwenden wir `DATEPART` den Monat des zurückzugebenden der `HireDate` Spalte.</span><span class="sxs-lookup"><span data-stu-id="3c765-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="3c765-135">[![Nur die Zeilen, in dem das HireDate-Spalte "Return" ist kleiner als oder gleich der @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="3c765-136">**Abbildung 3**: Nur die Zeilen, in dem Zurückgeben der `HireDate` Spalte ist kleiner als oder gleich der `@HiredBeforeDate` Parameter ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="3c765-137">Ändern Sie schließlich die `FillBy` und `GetDataBy` Methode zeichenfolgeneigenschaftsnamen `FillByHiredDateMonth` und `GetEmployeesByHiredDateMonth`bzw.</span><span class="sxs-lookup"><span data-stu-id="3c765-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="3c765-138">[![Wählen Sie geeignetere Methodennamen als FillBy und GetDataBy aus](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="3c765-139">**Abbildung 4**: Wählen Sie besser geeignete Methode Namen als `FillBy` und `GetDataBy` ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="3c765-140">Klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen und zurück auf das DataSet-Entwurfsoberfläche.</span><span class="sxs-lookup"><span data-stu-id="3c765-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="3c765-141">Die `EmployeesTableAdapter` enthalten sollte nun einen neuen Satz von Methoden für den Zugriff auf Mitarbeiter in einem angegebenen Monat eingestellt.</span><span class="sxs-lookup"><span data-stu-id="3c765-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="3c765-142">[![Die neuen Methoden werden in das DataSet-Entwurfsoberfläche angezeigt.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="3c765-143">**Abbildung 5**: Die neuen Methoden werden in des Datasets-Entwurfsoberfläche ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="3c765-144">Schritt 2: Hinzufügen der`GetEmployeesByHiredDateMonth(month)`Methode, um die Geschäftslogikebene</span><span class="sxs-lookup"><span data-stu-id="3c765-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="3c765-145">Da unsere Anwendung Architektur verwendet eine Separate Ebene für die Geschäftslogik und Daten Logik zuzugreifen, müssen wir unsere BLL eine Methode hinzufügen, die Aufrufe auf die DAL zum Abrufen von Mitarbeitern vor einem bestimmten Datum eingestellt.</span><span class="sxs-lookup"><span data-stu-id="3c765-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="3c765-146">Öffnen der `EmployeesBLL.cs` Datei, und fügen Sie die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="3c765-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="3c765-147">Wie bei unseren anderen Methoden in dieser Klasse `GetEmployeesByHiredDateMonth(month)` ruft einfach in die DAL nach unten, und die Ergebnisse zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="3c765-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="3c765-148">Schritt 3: Anzeigen von Mitarbeitern, die diesem Monat besteht darin, deren Einstellung Anniversary</span><span class="sxs-lookup"><span data-stu-id="3c765-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="3c765-149">Der letzte Schritt in diesem Beispiel werden die Mitarbeiter angezeigt, deren Einstellung Jahrestag in diesem Monat besteht.</span><span class="sxs-lookup"><span data-stu-id="3c765-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="3c765-150">Durch das Hinzufügen einer GridView-Ansicht zum Starten der `ProgrammaticParams.aspx` auf der Seite die `BasicReporting` Ordner, und fügen Sie eine neue "ObjectDataSource" als Datenquelle hinzu.</span><span class="sxs-lookup"><span data-stu-id="3c765-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="3c765-151">Konfigurieren Sie mit dem ObjectDataSource-Steuerelement die `EmployeesBLL` -Klasse mit der `SelectMethod` festgelegt `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="3c765-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="3c765-152">[![Verwenden Sie die EmployeesBLL-Klasse](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="3c765-153">**Abbildung 6**: Verwenden der `EmployeesBLL` Klasse ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="3c765-154">[![Wählen Sie aus der GetEmployeesByHiredDateMonth(month)-Methode](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="3c765-155">**Abbildung 7**: Wählen Sie aus der `GetEmployeesByHiredDateMonth(month)` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="3c765-156">Der letzten Seite fordert uns die Bereitstellung der `month` Parameterwert der Quelle.</span><span class="sxs-lookup"><span data-stu-id="3c765-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="3c765-157">Da wir diesen Wert programmgesteuert festgelegt werden, lassen Sie die Quelle des Parameters auf den Standardwert None festgelegt aus, und klicken Sie auf "Fertig stellen".</span><span class="sxs-lookup"><span data-stu-id="3c765-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="3c765-158">[![Behalten Sie die Parameter die Quelle auf "None"](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="3c765-159">**Abbildung 8**: Lassen Sie die Parameter Quelle festgelegt auf "None" ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="3c765-160">Dadurch entsteht eine `Parameter` Objekt in das "ObjectDataSource" `SelectParameters` -Auflistung, die kein Wert angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="3c765-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="3c765-161">Um diesen Wert programmgesteuert festzulegen, müssen wir einen Ereignishandler für das ObjectDataSource-Steuerelement erstellen `Selecting` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="3c765-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="3c765-162">Um dies zu erreichen, navigieren Sie zur Entwurfsansicht, und doppelklicken Sie auf dem ObjectDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="3c765-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="3c765-163">Alternativ wählen Sie das "ObjectDataSource", wechseln Sie zu dem Fenster "Eigenschaften", und klicken Sie auf das Blitzsymbol.</span><span class="sxs-lookup"><span data-stu-id="3c765-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="3c765-164">Als Nächstes entweder Doppelklicken Sie in das Textfeld neben der `Selecting` Ereignis- oder geben Sie den Namen der Ereignishandler, die Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="3c765-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![Klicken Sie auf das Blitzsymbol im Fenster "Eigenschaften" eines Websteuerelements Ereignisse auflisten](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="3c765-166">**Abbildung 9**: Klicken Sie auf das Blitzsymbol im Fenster "Eigenschaften" eines Websteuerelements Ereignisse auflisten</span><span class="sxs-lookup"><span data-stu-id="3c765-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="3c765-167">Beide Ansätze fügen Sie einen neuen Ereignishandler für das "ObjectDataSource" `Selecting` Ereignis auf der Seite Code-Behind-Klasse.</span><span class="sxs-lookup"><span data-stu-id="3c765-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="3c765-168">In diesem Ereignishandler können gelesen und geschrieben werden, der Parameterwerte mit `e.InputParameters[parameterName]`, wobei *`parameterName`* ist der Wert des der `Name` -Attribut in der `<asp:Parameter>` Tag (die `InputParameters` Auflistung kann auch sein, Ordnungszahl, wie in indizierten `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="3c765-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="3c765-169">Festlegen der `month` fügen Sie den folgenden Parameter, um den aktuellen Monat die `Selecting` -Ereignishandler:</span><span class="sxs-lookup"><span data-stu-id="3c765-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="3c765-170">Beim Zugriff auf diese Seite über einen Browser sehen wir, nur ein Mitarbeiter eingestellt wurde in diesem Monat (März) Laura Callahan, die in der Firma seit 1994 wurde.</span><span class="sxs-lookup"><span data-stu-id="3c765-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="3c765-171">[![Diejenigen Mitarbeiter, deren Geburtstage in diesem Monat angezeigt werden](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="3c765-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="3c765-172">**Abbildung 10**: Diese Mitarbeiter, deren Geburtstage dieses Monats werden angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="3c765-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="3c765-173">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="3c765-173">Summary</span></span>

<span data-ttu-id="3c765-174">Während Werte für die der ObjectDataSource gewöhnlich deklarativ festgelegt werden können ohne eine einzige Zeile Code, ist es einfach, die Parameterwerte programmgesteuert festzulegen.</span><span class="sxs-lookup"><span data-stu-id="3c765-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="3c765-175">Wir müssen lediglich einen Ereignishandler für das ObjectDataSource-Steuerelement erstellen `Selecting` -Ereignis, das ausgelöst wird, bevor die Methode des zugrunde liegenden Objekts aufgerufen wird, und Manuelles Festlegen der Werte für einen oder mehrere Parameter über die `InputParameters` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="3c765-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="3c765-176">Dieses Lernprogramm schließt das Kapitel zur grundlegenden Berichterstellung.</span><span class="sxs-lookup"><span data-stu-id="3c765-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="3c765-177">Die [nächsten Tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) startet im Abschnitt filtern und Master / Detail-Szenarien, in dem wir Techniken für das Zulassen des Besuchers zum Filtern von Daten und einen Drilldown aus einem master-Bericht in einen Bericht.</span><span class="sxs-lookup"><span data-stu-id="3c765-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="3c765-178">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="3c765-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3c765-179">Der Autor</span><span class="sxs-lookup"><span data-stu-id="3c765-179">About the Author</span></span>

<span data-ttu-id="3c765-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="3c765-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3c765-181">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="3c765-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3c765-182">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3c765-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3c765-183">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3c765-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3c765-184">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3c765-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3c765-185">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="3c765-185">Special Thanks To</span></span>

<span data-ttu-id="3c765-186">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="3c765-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3c765-187">Führendes Prüfer für dieses Tutorial ist Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="3c765-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="3c765-188">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="3c765-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3c765-189">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3c765-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3c765-190">[Zurück](declarative-parameters-cs.md)
> [Weiter](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3c765-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
