---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: Programm gesteuertes Festlegen der Parameter Werte von ObjectDataSourceC#() | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial wird das Hinzufügen einer Methode zu "Dal" und "BLL" untersucht, die einen einzelnen Eingabeparameter annimmt und Daten zurückgibt. Im Beispiel wird dieser Parameter festgelegt...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 8aa57172abcfc779fa74b128ad76d42c41dc5b98
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78465939"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="fa2ea-104">Programmgesteuertes Festlegen der Parameterwerte des ObjectDataSource-Steuerelements (C#)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="fa2ea-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fa2ea-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) oder [PDF herunterladen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-106">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="fa2ea-107">In diesem Tutorial wird das Hinzufügen einer Methode zu "Dal" und "BLL" untersucht, die einen einzelnen Eingabeparameter annimmt und Daten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="fa2ea-108">Im Beispiel wird dieser Parameter Programm gesteuert festgelegt.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="fa2ea-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="fa2ea-109">Introduction</span></span>

<span data-ttu-id="fa2ea-110">Wie bereits im [vorherigen Tutorial](declarative-parameters-cs.md)gezeigt, stehen eine Reihe von Optionen für die deklarative Übergabe von Parameterwerten an die Methoden von ObjectDataSource zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="fa2ea-111">Wenn der Parameterwert hart codiert ist, von einem websteuer Element auf der Seite stammt oder sich in einer anderen Quelle befindet, die von einer Datenquelle `Parameter` Objekt gelesen werden kann, kann dieser Wert z. b. an den Eingabeparameter gebunden werden, ohne dass eine Codezeile geschrieben werden muss.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="fa2ea-112">Es kann jedoch vorkommen, dass der Parameterwert aus einer Quelle stammt, die nicht bereits von einer der integrierten Datenquellen `Parameter`-Objekten berücksichtigt wird.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="fa2ea-113">Wenn unsere Website Benutzerkonten unterstützt, möchten wir möglicherweise den Parameter basierend auf der Benutzer-ID des aktuell angemeldeten Besuchers festlegen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="fa2ea-114">Möglicherweise müssen Sie auch den Parameterwert anpassen, bevor Sie ihn an die-Methode des zugrunde liegenden Objekts von ObjectDataSource senden.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="fa2ea-115">Wenn die `Select`-Methode von ObjectDataSource aufgerufen wird, löst ObjectDataSource zuerst das [auswählende Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx)aus.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="fa2ea-116">Die-Methode des zugrunde liegenden Objekts von ObjectDataSource wird dann aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="fa2ea-117">Nach Abschluss dieses Vorgangs wird das [ausgewählte Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) von ObjectDataSource ausgelöst (Abbildung 1 veranschaulicht diese Abfolge von Ereignissen).</span><span class="sxs-lookup"><span data-stu-id="fa2ea-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="fa2ea-118">Die Parameterwerte, die an die-Methode des zugrunde liegenden Objekts von ObjectDataSource übergeben werden, können in einem Ereignishandler für das `Selecting`-Ereignis festgelegt oder angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="fa2ea-119">[![das ausgewählte ObjectDataSource-Ereignis und das Auswählen von Ereignissen vor und nach dem Aufrufen der-Methode des zugrunde liegenden Objekts ausgelöst werden.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="fa2ea-120">**Abbildung 1**: die `Selected`-und `Selecting` Ereignisse von ObjectDataSource werden vor und nach dem Aufrufen der-Methode des zugrunde liegenden Objekts ausgelöst ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="fa2ea-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="fa2ea-121">In diesem Tutorial wird das Hinzufügen einer Methode zu unserer dal und BLL beschrieben, die einen einzelnen Eingabeparameter `Month`vom Typ `int` akzeptiert und ein `EmployeesDataTable` Objekt zurückgibt, das mit den Mitarbeitern aufgefüllt wird, deren Einstellungs Jahrestag in der angegebenen `Month`ist.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="fa2ea-122">In unserem Beispiel wird dieser Parameter Programm gesteuert basierend auf dem aktuellen Monat festgelegt, und es wird eine Liste der "Mitarbeiter Jubiläen in diesem Monat" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="fa2ea-123">Erste Schritte</span><span class="sxs-lookup"><span data-stu-id="fa2ea-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="fa2ea-124">Schritt 1: Hinzufügen einer Methode zum`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="fa2ea-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="fa2ea-125">Im ersten Beispiel müssen wir eine Möglichkeit zum Abrufen der Mitarbeiter hinzufügen, deren `HireDate` in einem bestimmten Monat aufgetreten sind.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="fa2ea-126">Um diese Funktionalität in Übereinstimmung mit unserer Architektur bereitzustellen, müssen wir zunächst eine Methode in `EmployeesTableAdapter` erstellen, die der entsprechenden SQL-Anweisung zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="fa2ea-127">Um dies zu erreichen, öffnen Sie zunächst das typisierte Northwind-DataSet.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="fa2ea-128">Klicken Sie mit der rechten Maustaste auf die `EmployeesTableAdapter` Bezeichnung, und wählen Sie Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="fa2ea-129">[![dem Mitarbeiter Adapter eine neue Abfrage hinzufügen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="fa2ea-130">**Abbildung 2**: Hinzufügen einer neuen Abfrage zum `EmployeesTableAdapter` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="fa2ea-131">Fügen Sie eine SQL-Anweisung hinzu, die Zeilen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="fa2ea-132">Wenn Sie den Bildschirm `SELECT` Anweisung angeben erreichen, wird die standardmäßige `SELECT` Anweisung für die `EmployeesTableAdapter` bereits geladen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="fa2ea-133">Fügen Sie einfach in der `WHERE`-Klausel hinzu: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="fa2ea-134">[Datepart](https://msdn.microsoft.com/library/ms174420.aspx) ist eine T-SQL-Funktion, die einen bestimmten Datums Teil eines `datetime` Typs zurückgibt. in diesem Fall verwenden wir `DATEPART`, um den Monat der `HireDate` Spalte zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="fa2ea-135">[![nur die Zeilen zurückgeben, bei denen die HireDate-Spalte kleiner oder gleich dem Parameter @HiredBeforeDate ist.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="fa2ea-136">**Abbildung 3**: nur die Zeilen zurückgeben, bei denen die `HireDate` Spalte kleiner oder gleich dem Parameter "`@HiredBeforeDate`" ist ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="fa2ea-137">Ändern Sie abschließend die `FillBy`-und `GetDataBy` Methodennamen in `FillByHiredDateMonth` bzw. `GetEmployeesByHiredDateMonth`.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="fa2ea-138">[Wählen Sie ![geeignetere Methodennamen als FillBy und GetDataBy aus.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="fa2ea-139">**Abbildung 4**: Wählen Sie besser geeignete Methodennamen als `FillBy` und `GetDataBy` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="fa2ea-140">Klicken Sie auf Fertigstellen, um den Assistenten abzuschließen und zur Entwurfs Oberfläche des Datasets zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="fa2ea-141">Der `EmployeesTableAdapter` sollte nun einen neuen Satz von Methoden für den Zugriff auf Mitarbeiter enthalten, die in einem bestimmten Monat eingestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="fa2ea-142">[![die neuen Methoden in der Designoberfläche des Datasets angezeigt werden.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="fa2ea-143">**Abbildung 5**: die neuen Methoden werden im Designoberfläche des Datasets angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="fa2ea-144">Schritt 2: Hinzufügen der`GetEmployeesByHiredDateMonth(month)`Methode zur Geschäftslogik Schicht</span><span class="sxs-lookup"><span data-stu-id="fa2ea-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="fa2ea-145">Da unsere Anwendungsarchitektur eine separate Ebene für die Geschäftslogik und die Datenzugriffs Logik verwendet, muss unserer BLL eine Methode hinzugefügt werden, die zum Abrufen von Mitarbeitern verwendet wird, die vor einem bestimmten Datum eingestellt wurden.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="fa2ea-146">Öffnen Sie die Datei `EmployeesBLL.cs`, und fügen Sie die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="fa2ea-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="fa2ea-147">Wie bei den anderen Methoden in dieser Klasse ruft `GetEmployeesByHiredDateMonth(month)` einfach die DAL auf und gibt die Ergebnisse zurück.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="fa2ea-148">Schritt 3: Anzeigen von Mitarbeitern, deren Einstellungs Jahrestag dieser Monat ist</span><span class="sxs-lookup"><span data-stu-id="fa2ea-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="fa2ea-149">Der letzte Schritt in diesem Beispiel besteht darin, die Mitarbeiter anzuzeigen, deren Einstellungs Jahrestag in diesem Monat liegt.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="fa2ea-150">Fügen Sie zunächst der Seite `ProgrammaticParams.aspx` im `BasicReporting` Ordner eine GridView hinzu, und fügen Sie eine neue ObjectDataSource als Datenquelle hinzu.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="fa2ea-151">Konfigurieren Sie ObjectDataSource so, dass die `EmployeesBLL`-Klasse verwendet wird, wobei die `SelectMethod` auf `GetEmployeesByHiredDateMonth(month)`festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="fa2ea-152">[![die Klasse "Mitarbeiter-BLL" verwenden](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="fa2ea-153">**Abbildung 6**: Verwenden der `EmployeesBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="fa2ea-154">[![aus der getemployeesbyhireddatemonth (month)-Methode auswählen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="fa2ea-155">**Abbildung 7**: auswählen aus der `GetEmployeesByHiredDateMonth(month)`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="fa2ea-156">Im letzten Bildschirm werden wir aufgefordert, die Quelle des `month` Parameter Werts anzugeben.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="fa2ea-157">Da dieser Wert Programm gesteuert festgelegt wird, lassen Sie die Parameter Quelle auf die Standardoption None fest, und klicken Sie auf Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="fa2ea-158">[![lassen Sie die Parameter Quelle auf keine fest.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="fa2ea-159">**Abbildung 8**: belassen der Parameter Quelle auf "None" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="fa2ea-160">Dadurch wird ein `Parameter` Objekt in der `SelectParameters` Auflistung von ObjectDataSource erstellt, für das kein Wert angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="fa2ea-161">Um diesen Wert Programm gesteuert festzulegen, müssen wir einen Ereignishandler für das `Selecting`-Ereignis von ObjectDataSource erstellen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="fa2ea-162">Um dies zu erreichen, wechseln Sie zum Designansicht, und doppelklicken Sie auf ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="fa2ea-163">Wählen Sie alternativ ObjectDataSource aus, wechseln Sie zum Eigenschaftenfenster, und klicken Sie dann auf das Blitz Symbol.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="fa2ea-164">Doppelklicken Sie anschließend entweder auf das Textfeld neben dem `Selecting`-Ereignis, oder geben Sie den Namen des Ereignis Handlers ein, den Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![Klicken Sie im Eigenschaften Fenster auf das Blitz Symbol, um die Ereignisse eines websteuer Elements aufzulisten.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="fa2ea-166">**Abbildung 9**: Klicken Sie im Eigenschaften Fenster auf das Blitz Symbol, um die Ereignisse eines websteuer Elements aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="fa2ea-167">Beide Ansätze fügen einen neuen Ereignishandler für das `Selecting` Ereignis von ObjectDataSource zur Code Behind-Klasse der Seite hinzu.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="fa2ea-168">In diesem Ereignishandler können wir mit `e.InputParameters[parameterName]`Lese-und Schreibvorgänge für die Parameterwerte durchführen, wobei *`parameterName`* der Wert des `Name`-Attributs im `<asp:Parameter>`-Tag ist (die `InputParameters` Auflistung kann auch ordnungsgemäß indiziert werden, wie in `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="fa2ea-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="fa2ea-169">Um den `month`-Parameter auf den aktuellen Monat festzulegen, fügen Sie dem `Selecting`-Ereignishandler Folgendes hinzu:</span><span class="sxs-lookup"><span data-stu-id="fa2ea-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="fa2ea-170">Wenn Sie diese Seite über einen Browser besuchen, sehen wir, dass nur ein Mitarbeiter diesen Monat (März) Laura Callahan eingestellt hat, der seit 1994 seit.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="fa2ea-171">[![Sie die Mitarbeiter, deren Jubiläen in diesem Monat angezeigt werden.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="fa2ea-172">**Abbildung 10**: Mitarbeiter, deren Jubiläen in diesem Monat angezeigt werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="fa2ea-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="fa2ea-173">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="fa2ea-173">Summary</span></span>

<span data-ttu-id="fa2ea-174">Obwohl die Parameterwerte der ObjectDataSource in der Regel deklarativ festgelegt werden können, ohne dass eine Codezeile erforderlich ist, ist es einfach, die Parameterwerte Programm gesteuert festzulegen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="fa2ea-175">Wir müssen lediglich einen Ereignishandler für das `Selecting`-Ereignis von ObjectDataSource erstellen, das ausgelöst wird, bevor die-Methode des zugrunde liegenden Objekts aufgerufen wird, und die Werte für einen oder mehrere Parameter manuell über die `InputParameters` Auflistung festlegen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="fa2ea-176">Dieses Tutorial schließt den grundlegenden Bericht Erstellungs Abschnitt ab.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="fa2ea-177">Im [nächsten Tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) wird der Abschnitt Filter und Master-Details-Szenarios vorgestellt, in dem wir die Verfahren zum Filtern von Daten und Ausführen eines Drilldowns von einem Master Bericht in einen Detail Bericht untersuchen.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="fa2ea-178">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="fa2ea-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="fa2ea-179">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="fa2ea-179">About the Author</span></span>

<span data-ttu-id="fa2ea-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fa2ea-181">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fa2ea-182">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="fa2ea-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="fa2ea-183">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="fa2ea-184">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="fa2ea-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="fa2ea-185">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="fa2ea-185">Special Thanks To</span></span>

<span data-ttu-id="fa2ea-186">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fa2ea-187">Der Lead Prüfer für dieses Tutorial war Hilton giesreviewer.</span><span class="sxs-lookup"><span data-stu-id="fa2ea-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="fa2ea-188">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="fa2ea-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fa2ea-189">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fa2ea-190">[Zurück](declarative-parameters-cs.md)
> [Weiter](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="fa2ea-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
