---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: Zwischenspeichern von Daten mit dem ObjectDataSource-Objekt (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Caching kann den Unterschied zwischen einer langsamen und einer schnellen Webanwendung bedeuten. Dieses Tutorial ist der erste von vier, bei dem Sie sich ausführlich mit dem Caching in ASP.net beschäftigen...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 16f20d9a0f4f677073174d680418b278dba40b07
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78443145"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="4ba31-104">Zwischenspeichern von Daten mit dem ObjectDataSource-Steuerelement (VB)</span><span class="sxs-lookup"><span data-stu-id="4ba31-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="4ba31-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4ba31-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4ba31-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) oder [PDF herunterladen](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4ba31-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="4ba31-107">Caching kann den Unterschied zwischen einer langsamen und einer schnellen Webanwendung bedeuten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="4ba31-108">Dieses Tutorial ist der erste von vier, in dem Sie sich ausführlich mit dem Caching in ASP.net beschäftigen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="4ba31-109">Lernen Sie die wichtigsten Konzepte der Zwischenspeicherung und das Anwenden der Zwischenspeicherung auf die Darstellungs Schicht über das ObjectDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="4ba31-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="4ba31-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="4ba31-110">Introduction</span></span>

<span data-ttu-id="4ba31-111">In Informatik ist das zwischen *Speichern* der Prozess, bei dem Daten oder Informationen, die teuer sind, zum Abrufen und Speichern einer Kopie der Daten an einem Speicherort, der schneller zugänglich ist, zu finden sind.</span><span class="sxs-lookup"><span data-stu-id="4ba31-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="4ba31-112">Bei datengesteuerten Anwendungen verbrauchen große und komplexe Abfragen in der Regel den Großteil der Ausführungszeit der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4ba31-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="4ba31-113">Die Leistung einer solchen Anwendung kann dann häufig verbessert werden, indem die Ergebnisse kostspieliger Datenbankabfragen im Arbeitsspeicher der Anwendung gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="4ba31-114">ASP.NET 2,0 bietet eine Vielzahl von Optionen für das Zwischenspeichern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="4ba31-115">Ein gesamtes gerendertes Markup einer Webseite oder eines Benutzer Steuer Elements kann über das *Ausgabe Caching*zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="4ba31-116">Die ObjectDataSource-und SqlDataSource-Steuerelemente stellen ebenfalls zwischen Speicherungs Funktionen bereit und ermöglichen so das Zwischenspeichern von Daten auf der Steuerungsebene.</span><span class="sxs-lookup"><span data-stu-id="4ba31-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="4ba31-117">Und ASP.net s *Data Cache* bietet eine umfassende Caching-API, mit der Seiten Entwickler Objekte Programm gesteuert Zwischenspeichern können.</span><span class="sxs-lookup"><span data-stu-id="4ba31-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="4ba31-118">In diesem Tutorial und den nächsten drei untersuchen wir die Verwendung der ObjectDataSource s-Cachingfeatures und des Daten Caches.</span><span class="sxs-lookup"><span data-stu-id="4ba31-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="4ba31-119">Außerdem wird erläutert, wie Sie Anwendungs weite Daten beim Start Zwischenspeichern und zwischengespeicherte Daten durch die Verwendung von SQL-Cache Abhängigkeiten neu speichern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="4ba31-120">In diesen Tutorials wird das Ausgabe Caching nicht untersucht.</span><span class="sxs-lookup"><span data-stu-id="4ba31-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="4ba31-121">Ausführliche Informationen zum Ausgabe Caching finden Sie unterausgabe Zwischenspeicherung [in ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="4ba31-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="4ba31-122">Zwischenspeicherung kann an beliebiger Stelle in der Architektur, von der Datenzugriffs Ebene bis hin zur Präsentationsschicht, angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="4ba31-123">In diesem Tutorial wird das Anwenden der Zwischenspeicherung auf die Darstellungs Ebene über das ObjectDataSource-Steuerelement untersucht.</span><span class="sxs-lookup"><span data-stu-id="4ba31-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="4ba31-124">Im nächsten Tutorial untersuchen wir das Zwischenspeichern von Daten auf der Geschäftslogik Ebene.</span><span class="sxs-lookup"><span data-stu-id="4ba31-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="4ba31-125">Schlüssel Caching-Konzepte</span><span class="sxs-lookup"><span data-stu-id="4ba31-125">Key Caching Concepts</span></span>

<span data-ttu-id="4ba31-126">Das Caching kann die Gesamtleistung und Skalierbarkeit einer Anwendung erheblich verbessern, indem Daten, die teuer zu generieren und zu speichern sind, an einem Speicherort gespeichert werden, der effizienter auf Sie zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="4ba31-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="4ba31-127">Da der Cache nur eine Kopie der tatsächlichen, zugrunde liegenden Daten enthält, kann er veraltet oder veraltet sein, *Wenn sich die*zugrunde liegenden Daten ändern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="4ba31-128">Um dies zu bekämpfen, kann ein Seiten Entwickler Kriterien angeben, mit denen das Cache Element *aus dem Cache entfernt wird,* indem Sie Folgendes verwenden:</span><span class="sxs-lookup"><span data-stu-id="4ba31-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="4ba31-129">**Zeitbasierte Kriterien** für eine absolute oder gleitende Dauer können dem Cache ein Element hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="4ba31-130">Ein Seiten Entwickler kann z. b. eine Dauer von etwa 60 Sekunden angeben.</span><span class="sxs-lookup"><span data-stu-id="4ba31-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="4ba31-131">Bei einer absoluten Dauer wird das zwischengespeicherte Element 60 Sekunden nach dem Hinzufügen zum Cache entfernt, unabhängig davon, wie häufig darauf zugegriffen wurde.</span><span class="sxs-lookup"><span data-stu-id="4ba31-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="4ba31-132">Bei einer gleitenden Dauer wird das zwischengespeicherte Element 60 Sekunden nach dem letzten Zugriff entfernt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="4ba31-133">**Abhängigkeitsbasiertes Kriterium** : eine Abhängigkeit kann einem Element zugeordnet werden, wenn es dem Cache hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="4ba31-134">Wenn die Abhängigkeit des Elements geändert wird, wird Sie aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="4ba31-135">Bei der Abhängigkeit kann es sich um eine Datei, ein anderes Cache Element oder eine Kombination der beiden handelt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="4ba31-136">ASP.NET 2,0 lässt auch SQL-Cache Abhängigkeiten zu, die es Entwicklern ermöglichen, dem Cache ein Element hinzuzufügen und zu entfernen, wenn sich die zugrunde liegenden Datenbankdaten ändern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="4ba31-137">Die SQL-Cache Abhängigkeiten werden im nächsten Tutorial zum [Verwenden von SQL-Cache Abhängigkeiten](using-sql-cache-dependencies-vb.md) untersucht.</span><span class="sxs-lookup"><span data-stu-id="4ba31-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="4ba31-138">Unabhängig von den angegebenen Entfernungs Kriterien kann ein Element im *Cache vor dem* erreichen der zeitbasierten oder Abhängigkeits basierten Kriterien geleert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="4ba31-139">Wenn der Cache seine Kapazität erreicht hat, müssen vorhandene Elemente entfernt werden, bevor neue Werte hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="4ba31-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="4ba31-140">Folglich ist es beim programmgesteuerten Arbeiten mit zwischengespeicherten Daten wichtig, dass Sie immer davon ausgehen, dass die zwischengespeicherten Daten möglicherweise nicht vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="4ba31-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="4ba31-141">Wir betrachten das Muster für den programmgesteuerten Zugriff auf Daten aus dem Cache im nächsten Tutorial, *das Zwischenspeichern von Daten in der Architektur*verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="4ba31-142">Caching bietet ein wirtschaftliches Mittel, um die Leistung einer Anwendung zu unterdrücken.</span><span class="sxs-lookup"><span data-stu-id="4ba31-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="4ba31-143">Wie [Steven Smith](http://aspadvice.com/blogs/ssmith/) in seinem Artikel [ASP.NET Caching: Techniken und bewährte Methoden](https://msdn.microsoft.com/library/aa478965.aspx)erläutert:</span><span class="sxs-lookup"><span data-stu-id="4ba31-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="4ba31-144">Caching kann eine gute Möglichkeit sein, eine gute Leistung zu erzielen, ohne viel Zeit und Analyse zu benötigen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="4ba31-145">Der Arbeitsspeicher ist kostengünstig. Wenn Sie also die benötigte Leistung abrufen können, indem Sie die Ausgabe 30 Sekunden lang Zwischenspeichern, anstatt einen Tag oder eine Woche zu investieren, um den Code oder die Datenbank zu optimieren, führen Sie die cachinglösung aus (vorausgesetzt, dass die 30 Sekunden alten Daten in Ordnung sind) und weiter.</span><span class="sxs-lookup"><span data-stu-id="4ba31-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="4ba31-146">Schließlich sollten Sie sich bei schlechten Entwürfen wahrscheinlich an Sie richten. Sie sollten also natürlich versuchen, Ihre Anwendungen richtig zu entwerfen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="4ba31-147">Wenn Sie jedoch noch heute eine gute Leistung erzielen müssen, kann das Caching ein hervorragender [Ansatz] sein, um Ihnen Zeit zu bieten, Ihre Anwendung zu einem späteren Zeitpunkt zu umgestalten, wenn Sie die Zeit dafür haben.</span><span class="sxs-lookup"><span data-stu-id="4ba31-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="4ba31-148">Während die Zwischenspeicherung spürbare Leistungsverbesserungen bieten kann, ist Sie nicht in allen Situationen anwendbar, wie z. b. bei Anwendungen, die Echtzeitdaten verwenden, häufig verwendete Daten oder auch in kurzlebigen veralteten Daten sind nicht akzeptabel.</span><span class="sxs-lookup"><span data-stu-id="4ba31-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="4ba31-149">Für die meisten Anwendungen sollte jedoch Caching verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="4ba31-150">Weitere Hintergrundinformationen zum Zwischenspeichern in ASP.NET 2,0 finden Sie im Abschnitt [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) der [Schnellstart-Tutorials zu ASP.NET 2,0](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="4ba31-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="4ba31-151">Schritt 1: Erstellen der Caching-Webseiten</span><span class="sxs-lookup"><span data-stu-id="4ba31-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="4ba31-152">Bevor wir mit der Untersuchung der ObjectDataSource s-Cache Features beginnen, nehmen Sie sich zunächst einen Moment Zeit, um die ASP.NET-Seiten in unserem Website Projekt zu erstellen, die wir für dieses Tutorial benötigen, und die nächsten drei.</span><span class="sxs-lookup"><span data-stu-id="4ba31-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="4ba31-153">Fügen Sie zunächst einen neuen Ordner mit dem Namen `Caching`hinzu.</span><span class="sxs-lookup"><span data-stu-id="4ba31-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="4ba31-154">Fügen Sie dann die folgenden ASP.NET-Seiten zu diesem Ordner hinzu, und stellen Sie sicher, dass Sie die einzelnen Seiten der `Site.master` Master Seite zuordnen:</span><span class="sxs-lookup"><span data-stu-id="4ba31-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![Fügen Sie die ASP.NET-Seiten für die Caching-bezogenen Tutorials hinzu.](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="4ba31-156">**Abbildung 1**: Hinzufügen der ASP.NET-Seiten für die Caching-bezogenen Tutorials</span><span class="sxs-lookup"><span data-stu-id="4ba31-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="4ba31-157">Wie in den anderen Ordnern werden `Default.aspx` im Ordner `Caching` die Lernprogramme in diesem Abschnitt auflisten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="4ba31-158">Denken Sie daran, dass das `SectionLevelTutorialListing.ascx` Benutzer Steuerelement diese Funktionalität bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="4ba31-159">Fügen Sie dieses Benutzer Steuerelement daher `Default.aspx` hinzu, indem Sie es aus dem Projektmappen-Explorer auf die Seite s Designansicht ziehen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="4ba31-160">[![Abbildung 2: Hinzufügen des Benutzer Steuer Elements "sectionleveltutoriallisting. ascx" zu "default. aspx"](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="4ba31-161">**Abbildung 2**: Abbildung 2: Hinzufügen des `SectionLevelTutorialListing.ascx` Benutzer Steuer Elements zu `Default.aspx` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="4ba31-162">Fügen Sie diese Seiten schließlich als Einträge zur `Web.sitemap` Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="4ba31-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="4ba31-163">Fügen Sie insbesondere nach dem `<siteMapNode>`arbeiten mit binären Daten das folgende Markup hinzu:</span><span class="sxs-lookup"><span data-stu-id="4ba31-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="4ba31-164">Nehmen Sie sich nach dem Aktualisieren `Web.sitemap`einen Moment Zeit, um die Tutorials-Website über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="4ba31-165">Das Menü auf der linken Seite enthält jetzt Elemente für die Caching-Tutorials.</span><span class="sxs-lookup"><span data-stu-id="4ba31-165">The menu on the left now includes items for the caching tutorials.</span></span>

![Die Site Übersicht enthält jetzt Einträge für die Caching-Tutorials.](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="4ba31-167">**Abbildung 3**: die Site Übersicht enthält jetzt Einträge für die Caching-Tutorials.</span><span class="sxs-lookup"><span data-stu-id="4ba31-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="4ba31-168">Schritt 2: Anzeigen einer Liste von Produkten in einer Webseite</span><span class="sxs-lookup"><span data-stu-id="4ba31-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="4ba31-169">In diesem Tutorial wird erläutert, wie Sie die integrierten Caching-Features von ObjectDataSource-Steuerelementen verwenden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="4ba31-170">Bevor wir uns diese Features ansehen können, benötigen wir jedoch zuerst eine Seite, aus der wir arbeiten können.</span><span class="sxs-lookup"><span data-stu-id="4ba31-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="4ba31-171">Erstellen Sie eine Webseite, die eine GridView zum Auflisten von Produktinformationen verwendet, die von einer ObjectDataSource aus der `ProductsBLL`-Klasse abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="4ba31-172">Öffnen Sie zunächst die Seite `ObjectDataSource.aspx` im Ordner `Caching`.</span><span class="sxs-lookup"><span data-stu-id="4ba31-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="4ba31-173">Ziehen Sie eine GridView aus der Toolbox auf den Designer, legen Sie die `ID`-Eigenschaft auf `Products`fest, und wählen Sie aus dem smarttagtag aus, dass es an ein neues ObjectDataSource-Steuerelement mit dem Namen `ProductsDataSource`gebunden werden soll.</span><span class="sxs-lookup"><span data-stu-id="4ba31-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="4ba31-174">Konfigurieren Sie die ObjectDataSource, um mit der `ProductsBLL`-Klasse zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="4ba31-175">[![konfigurieren Sie ObjectDataSource für die Verwendung der productbll-Klasse.](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="4ba31-176">**Abbildung 4**: Konfigurieren von ObjectDataSource für die Verwendung der `ProductsBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="4ba31-177">Erstellen Sie auf dieser Seite eine bearbeitbare GridView, damit wir überprüfen können, was geschieht, wenn die in ObjectDataSource zwischengespeicherten Daten über die GridView s-Schnittstelle geändert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="4ba31-178">Belassen Sie in der Dropdown Liste auf der Registerkarte auswählen den Standardwert `GetProducts()`, aber ändern Sie das ausgewählte Element auf der Registerkarte Update in die `UpdateProduct` Überladung, die `productName`, `unitPrice`und `productID` als Eingabeparameter akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="4ba31-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="4ba31-179">[![die Dropdown Liste "Update Registerkarte" auf die entsprechende UpdateProduct-Überladung festlegen](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="4ba31-180">**Abbildung 5**: Festlegen der Dropdown Liste der Registerkarte "Aktualisieren" auf die entsprechende `UpdateProduct` Überladung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>

<span data-ttu-id="4ba31-181">Legen Sie abschließend die Dropdown Listen auf den Registerkarten einfügen und löschen auf (keine) fest, und klicken Sie auf Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="4ba31-182">Nach dem Abschließen des Assistenten zum Konfigurieren von Datenquellen legt Visual Studio die Eigenschaft ObjectDataSource s `OldValuesParameterFormatString` auf `original_{0}`fest.</span><span class="sxs-lookup"><span data-stu-id="4ba31-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="4ba31-183">Wie in der Übersicht über das [Einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) erläutert, muss diese Eigenschaft aus der deklarativen Syntax entfernt oder auf ihren Standardwert zurückgesetzt werden, `{0}`, damit der Update-Workflow ohne Fehler fortgesetzt werden kann.</span><span class="sxs-lookup"><span data-stu-id="4ba31-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="4ba31-184">Außerdem fügt Visual Studio nach Abschluss des Assistenten der GridView ein Feld für jedes der Product Data-Felder hinzu.</span><span class="sxs-lookup"><span data-stu-id="4ba31-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="4ba31-185">Entfernen Sie alle außer die `ProductName`, `CategoryName`und `UnitPrice` boundfields.</span><span class="sxs-lookup"><span data-stu-id="4ba31-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="4ba31-186">Aktualisieren Sie als nächstes die `HeaderText` Eigenschaften der einzelnen boundfields-Elemente auf "Product", "Category" bzw. "Price".</span><span class="sxs-lookup"><span data-stu-id="4ba31-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="4ba31-187">Da das Feld "`ProductName`" erforderlich ist, konvertieren Sie das BoundField in ein TemplateField-Element, und fügen Sie dem `EditItemTemplate`ein "Requirements dfieldvalidator"-Element hinzu</span><span class="sxs-lookup"><span data-stu-id="4ba31-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="4ba31-188">Außerdem konvertieren Sie den `UnitPrice` BoundField in ein TemplateField-Element und fügen ein CompareValidator hinzu, um sicherzustellen, dass der vom Benutzer eingegebene Wert ein gültiger Currency-Wert ist, der größer oder gleich 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="4ba31-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="4ba31-189">Zusätzlich zu diesen Änderungen können Sie beliebige ästhetische Änderungen durchführen, z. b. den `UnitPrice` Wert rechts ausrichten oder die Formatierung für den `UnitPrice` Text in seinen schreibgeschützten und Bearbeitungs Schnittstellen angeben.</span><span class="sxs-lookup"><span data-stu-id="4ba31-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="4ba31-190">Aktivieren Sie die GridView, indem Sie das Kontrollkästchen zum Aktivieren der Bearbeitung in der GridView s-Smarttag aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="4ba31-191">Aktivieren Sie auch die Kontrollkästchen Paging aktivieren und Sortierung aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="4ba31-192">Benötigen Sie einen Überblick über die Anpassung der GridView s-Bearbeitungs Schnittstelle?</span><span class="sxs-lookup"><span data-stu-id="4ba31-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="4ba31-193">Wenn dies der Fall ist, lesen Sie das Tutorial [Anpassen der Daten Änderungs Schnittstelle](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="4ba31-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="4ba31-194">[![Aktivieren der GridView-Unterstützung für das Bearbeiten, Sortieren und Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="4ba31-195">**Abbildung 6**: Aktivieren der GridView-Unterstützung für das Bearbeiten, Sortieren und Paging ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>

<span data-ttu-id="4ba31-196">Nachdem Sie diese GridView-Änderungen vorgenommen haben, sollten das deklarative Markup von GridView und ObjectDataSource in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="4ba31-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="4ba31-197">Wie in Abbildung 7 gezeigt, listet die bearbeitbare GridView den Namen, die Kategorie und den Preis der einzelnen Produkte in der Datenbank auf.</span><span class="sxs-lookup"><span data-stu-id="4ba31-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="4ba31-198">Nehmen Sie sich einen Moment Zeit, um die Seitenfunktionen zu testen und die Ergebnisse zu sortieren und einen Datensatz zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="4ba31-199">[![die Namen, Kategorien und Preise der einzelnen Produkte in einer sortierbaren, kostenpflichtigen, bearbeitbaren GridView aufgeführt.](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="4ba31-200">**Abbildung 7**: die Namen, Kategorien und Preise der Produkte werden in einer sortierbaren, kostenpflichtigen, bearbeitbaren GridView aufgelistet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image17.png)).</span><span class="sxs-lookup"><span data-stu-id="4ba31-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="4ba31-201">Schritt 3: untersuchen, wann die ObjectDataSource Daten anfordert</span><span class="sxs-lookup"><span data-stu-id="4ba31-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="4ba31-202">Die `Products` GridView ruft die anzuzeigenden Daten ab, indem Sie die `Select`-Methode der `ProductsDataSource` ObjectDataSource aufruft.</span><span class="sxs-lookup"><span data-stu-id="4ba31-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="4ba31-203">Diese ObjectDataSource erstellt eine Instanz der Geschäftslogik Schicht s `ProductsBLL`-Klasse und ruft Ihre `GetProducts()`-Methode auf, die wiederum die Datenzugriffs Schicht s `ProductsTableAdapter` s `GetProducts()`-Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="4ba31-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="4ba31-204">Die DAL-Methode stellt eine Verbindung mit der Northwind-Datenbank her und gibt die konfigurierte `SELECT` Abfrage aus.</span><span class="sxs-lookup"><span data-stu-id="4ba31-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="4ba31-205">Diese Daten werden dann an die DAL zurückgegeben, die Sie in einem `NorthwindDataTable`verpackt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="4ba31-206">Das Datentabelle-Objekt wird an die BLL zurückgegeben, die es an die ObjectDataSource zurückgibt, die es an die GridView zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="4ba31-207">Dann erstellt das GridView-Objekt für jede `DataRow` in der Datentabelle ein `GridViewRow` Objekt, und jedes `GridViewRow` wird schließlich in den HTML-Code gerendert, der an den Client zurückgegeben und im Browser des Besuchers angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="4ba31-208">Diese Ereignis Sequenz findet jedes Mal statt, wenn die GridView an die zugrunde liegenden Daten gebunden werden muss.</span><span class="sxs-lookup"><span data-stu-id="4ba31-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="4ba31-209">Dies geschieht beim ersten Besuch der Seite, bei der Umstellung von einer Datenseite auf eine andere, beim Sortieren der GridView oder beim Ändern der GridView-Daten mithilfe der integrierten Bearbeitungs-oder Lösch Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="4ba31-210">Wenn der GridView s-Ansichts Zustand deaktiviert ist, wird die GridView bei jedem und jedem Postback ebenfalls wieder gebunden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="4ba31-211">Die GridView kann auch durch Aufrufen der `DataBind()`-Methode explizit auf die Daten zurück gehandelt werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="4ba31-212">Wenn Sie die Häufigkeit, mit der die Daten aus der Datenbank abgerufen werden, vollständig einschätzen möchten, können Sie eine Meldung anzeigen, die anzeigt, wann die Daten erneut abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="4ba31-213">Fügen Sie ein Label-websteuer Element oberhalb der GridView mit dem Namen `ODSEvents`hinzu.</span><span class="sxs-lookup"><span data-stu-id="4ba31-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="4ba31-214">Löschen Sie die `Text`-Eigenschaft, und legen Sie die `EnableViewState`-Eigenschaft auf `False`fest.</span><span class="sxs-lookup"><span data-stu-id="4ba31-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="4ba31-215">Fügen Sie unterhalb der Bezeichnung ein Button-websteuer Element hinzu, und legen Sie dessen `Text`-Eigenschaft auf Postback fest.</span><span class="sxs-lookup"><span data-stu-id="4ba31-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="4ba31-216">[![der Seite oberhalb der GridView eine Bezeichnung und eine Schaltfläche Hinzufügen](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="4ba31-217">**Abbildung 8**: Hinzufügen einer Bezeichnung und Schaltfläche zur Seite oberhalb der GridView ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="4ba31-218">Während des Datenzugriffs Workflows wird das ObjectDataSource s-`Selecting` Ereignis ausgelöst, bevor das zugrunde liegende Objekt erstellt und die konfigurierte Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="4ba31-219">Erstellen Sie einen Ereignishandler für dieses Ereignis, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="4ba31-219">Create an event handler for this event and add the following code:</span></span>

[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="4ba31-220">Jedes Mal, wenn die ObjectDataSource eine Anforderung an die Architektur für Daten sendet, zeigt die Bezeichnung den Text an, in dem das Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="4ba31-221">Besuchen Sie diese Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="4ba31-221">Visit this page in a browser.</span></span> <span data-ttu-id="4ba31-222">Beim ersten Besuch der Seite wird der Text für die Auslösung des Ereignisses angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="4ba31-223">Klicken Sie auf die Schaltfläche Postback, und beachten Sie, dass der Text nicht mehr angezeigt wird (vorausgesetzt, dass die GridView s `EnableViewState`-Eigenschaft auf `True`, die Standardeinstellung)</span><span class="sxs-lookup"><span data-stu-id="4ba31-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="4ba31-224">Dies liegt daran, dass beim Postback das GridView-Objekt anhand seines Ansichts Zustands rekonstruiert wird und daher nicht für seine Daten die ObjectDataSource-Datenquelle verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ba31-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="4ba31-225">Das Sortieren, Paging oder Bearbeiten der Daten bewirkt jedoch, dass die GridView erneut an die zugehörige Datenquelle gebunden wird. aus diesem Grund wird der Text ausgelöste Ereignis ausgelöste Text erneut angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="4ba31-226">[![immer dann, wenn die GridView auf die Datenquelle zurückgeht, wird die Auswahl von Ereignis ausgelöst angezeigt.](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="4ba31-227">**Abbildung 9**: jedes Mal, wenn die GridView auf die Datenquelle zurückgeht, wird die Auswahl von Ereignis ausgelöst angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image23.png)).</span><span class="sxs-lookup"><span data-stu-id="4ba31-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>

<span data-ttu-id="4ba31-228">[![klicken auf die Schaltfläche "Postback" bewirkt, dass die GridView aus dem Ansichts Zustand rekonstruiert wird.](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="4ba31-229">**Abbildung 10**: durch Klicken auf die Schaltfläche "Postback" wird die GridView aus dem Ansichts Zustand rekonstruiert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>

<span data-ttu-id="4ba31-230">Es mag verschwenderisch sein, die Datenbankdaten jedes Mal abzurufen, wenn die Daten über oder sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="4ba31-231">Da wir Standard-Paging wieder verwenden, hat ObjectDataSource alle Datensätze beim Anzeigen der ersten Seite abgerufen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="4ba31-232">Auch wenn die GridView keine Sortier-und Pagingunterstützung bereitstellt, müssen die Daten jedes Mal aus der Datenbank abgerufen werden, wenn die Seite zum ersten Mal von einem beliebigen Benutzer besucht wird (und bei jedem Postback, wenn der Ansichts Zustand deaktiviert ist).</span><span class="sxs-lookup"><span data-stu-id="4ba31-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="4ba31-233">Wenn in der GridView jedoch die gleichen Daten für alle Benutzer angezeigt werden, sind diese zusätzlichen Datenbankanforderungen überflüssig.</span><span class="sxs-lookup"><span data-stu-id="4ba31-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="4ba31-234">Warum werden die von der `GetProducts()`-Methode zurückgegebenen Ergebnisse nicht zwischengespeichert, und die GridView wird an diese zwischengespeicherten Ergebnisse gebunden?</span><span class="sxs-lookup"><span data-stu-id="4ba31-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="4ba31-235">Schritt 4: Zwischenspeichern der Daten mithilfe von ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="4ba31-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="4ba31-236">Durch einfaches Festlegen einiger Eigenschaften kann die ObjectDataSource so konfiguriert werden, dass die abgerufenen Daten automatisch in den ASP.NET-Daten Cache zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="4ba31-237">In der folgenden Liste werden die Cache bezogenen Eigenschaften von ObjectDataSource zusammengefasst:</span><span class="sxs-lookup"><span data-stu-id="4ba31-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="4ba31-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) muss auf `True` festgelegt werden, um das Zwischenspeichern zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="4ba31-239">Der Standardwert lautet `False`.</span><span class="sxs-lookup"><span data-stu-id="4ba31-239">The default is `False`.</span></span>
- <span data-ttu-id="4ba31-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) die Zeitspanne (in Sekunden), in der die Daten zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="4ba31-241">Die Standardeinstellung ist 0.</span><span class="sxs-lookup"><span data-stu-id="4ba31-241">The default is 0.</span></span> <span data-ttu-id="4ba31-242">Die ObjectDataSource speichert nur dann Daten zwischen, wenn `EnableCaching` `True` ist und `CacheDuration` auf einen Wert größer als 0 (null) festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="4ba31-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="4ba31-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) kann auf `Absolute` oder `Sliding`festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="4ba31-244">Wenn `Absolute`, speichert die ObjectDataSource die abgerufenen Daten für `CacheDuration` Sekunden zwischen. Wenn `Sliding`, laufen die Daten erst ab, nachdem seit `CacheDuration` Sekunden auf Sie zugegriffen wurde.</span><span class="sxs-lookup"><span data-stu-id="4ba31-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="4ba31-245">Der Standardwert lautet `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="4ba31-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="4ba31-246">[Cachekeyabhängigkeit](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) verwenden Sie diese Eigenschaft, um die ObjectDataSource s-Cache Einträge einer vorhandenen Cache Abhängigkeit zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="4ba31-247">Die Dateneinträge von ObjectDataSource s können vorzeitig aus dem Cache entfernt werden, indem die zugehörigen `CacheKeyDependency`entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="4ba31-248">Diese Eigenschaft wird am häufigsten verwendet, um eine SQL-Cache Abhängigkeit mit dem ObjectDataSource s-Cache zuzuordnen. Dies ist ein Thema, das wir in der Zukunft [mithilfe von SQL-Cache Abhängigkeiten](using-sql-cache-dependencies-vb.md) untersuchen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="4ba31-249">Konfigurieren Sie den `ProductsDataSource` ObjectDataSource so, dass seine Daten 30 Sekunden lang in einer absoluten Skalierung zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="4ba31-250">Legen Sie die Eigenschaft ObjectDataSource s `EnableCaching` auf `True` und deren `CacheDuration`-Eigenschaft auf 30 fest.</span><span class="sxs-lookup"><span data-stu-id="4ba31-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="4ba31-251">Belassen Sie die `CacheExpirationPolicy`-Eigenschaft auf den Standardwert `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="4ba31-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="4ba31-252">[![die ObjectDataSource so konfigurieren, dass Ihre Daten 30 Sekunden lang zwischengespeichert werden.](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="4ba31-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="4ba31-253">**Abbildung 11**: Konfigurieren von ObjectDataSource zum Zwischenspeichern der zugehörigen Daten für 30 Sekunden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="4ba31-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>

<span data-ttu-id="4ba31-254">Speichern Sie die Änderungen, und besuchen Sie diese Seite in einem Browser erneut.</span><span class="sxs-lookup"><span data-stu-id="4ba31-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="4ba31-255">Der Text ausgelöste Ereignis Auslösung wird angezeigt, wenn Sie zum ersten Mal die Seite aufrufen, da sich die Daten nicht im Cache befinden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="4ba31-256">Nachfolgende Postbacks, die durch Klicken auf die Schaltfläche "Postback", sortieren, Paging oder klicken auf die Schaltflächen "Bearbeiten" oder "Abbrechen" ausgelöst werden, zeigen jedoch *nicht* den ausgelösten Ereignis Text</span><span class="sxs-lookup"><span data-stu-id="4ba31-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="4ba31-257">Dies liegt daran, dass das `Selecting` Ereignis nur ausgelöst wird, wenn die ObjectDataSource die Daten aus dem zugrunde liegenden Objekt abruft. Das `Selecting` Ereignis wird nicht ausgelöst, wenn die Daten aus dem Daten Cache abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="4ba31-258">Nach 30 Sekunden werden die Daten aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="4ba31-259">Die Daten werden auch aus dem Cache entfernt, wenn die Methoden `Insert`, `Update`oder `Delete` von ObjectDataSource aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="4ba31-260">Folglich wird, nachdem 30 Sekunden vergangen sind oder auf die Schaltfläche Aktualisieren geklickt wurde, das Sortieren, Paging oder klicken auf die Schaltflächen Bearbeiten und Abbrechen bewirkt, dass ObjectDataSource seine Daten aus dem zugrunde liegenden Objekt ablegt und das ausgelöste Ereignis auswählt, wenn das `Selecting` Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="4ba31-261">Diese zurückgegebenen Ergebnisse werden wieder in den Daten Cache eingefügt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="4ba31-262">Wenn das ausgelöste Ereignis Text häufig ausgelöst angezeigt wird, kann es sein, dass auch dann, wenn die ObjectDataSource mit zwischengespeicherten Daten verwendet werden soll, aufgrund von Speicher Einschränkungen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="4ba31-263">Wenn nicht genügend freier Arbeitsspeicher verfügbar ist, wurden die Daten, die von ObjectDataSource dem Cache hinzugefügt wurden, möglicherweise geleert.</span><span class="sxs-lookup"><span data-stu-id="4ba31-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="4ba31-264">Wenn ObjectDataSource die Daten nicht ordnungsgemäß zwischenspeichert oder die Daten nur sporadisch zwischenspeichert, schließen Sie einige Anwendungen, um Arbeitsspeicher freizugeben, und versuchen Sie es noch mal.</span><span class="sxs-lookup"><span data-stu-id="4ba31-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="4ba31-265">Abbildung 12 zeigt den ObjectDataSource s Caching-Workflow.</span><span class="sxs-lookup"><span data-stu-id="4ba31-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="4ba31-266">Wenn der Text ausgelöste Ereignis Auslösung auf dem Bildschirm angezeigt wird, liegt dies daran, dass die Daten nicht im Cache enthalten waren und aus dem zugrunde liegenden Objekt abgerufen werden mussten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="4ba31-267">Wenn dieser Text jedoch fehlt, ist er, weil die Daten aus dem Cache verfügbar waren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="4ba31-268">Wenn die Daten aus dem Cache zurückgegeben werden, gibt es keinen Aufrufen an das zugrunde liegende Objekt, sodass keine Datenbankabfrage ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![Der ObjectDataSource speichert seine Daten und ruft Sie aus dem Daten Cache ab.](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="4ba31-270">**Abbildung 12**: die ObjectDataSource speichert Ihre Daten und ruft Sie aus dem Daten Cache ab.</span><span class="sxs-lookup"><span data-stu-id="4ba31-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="4ba31-271">Jede ASP.NET-Anwendung verfügt über eine eigene Daten Cache Instanz, die von allen Seiten und Besuchern gemeinsam genutzt wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="4ba31-272">Dies bedeutet, dass die im Daten Cache von ObjectDataSource gespeicherten Daten gleichermaßen für alle Benutzer freigegeben werden, die die Seite besuchen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="4ba31-273">Um dies zu überprüfen, öffnen Sie die Seite `ObjectDataSource.aspx` in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="4ba31-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="4ba31-274">Beim ersten Besuch der Seite wird der Text ausgelöste Ereignis Auslösung angezeigt (vorausgesetzt, dass die Daten, die durch vorherige Tests dem Cache hinzugefügt wurden, jetzt entfernt wurden).</span><span class="sxs-lookup"><span data-stu-id="4ba31-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="4ba31-275">Öffnen Sie eine zweite Browser Instanz, kopieren Sie die URL von der ersten Browser Instanz in die zweite, und fügen Sie Sie ein.</span><span class="sxs-lookup"><span data-stu-id="4ba31-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="4ba31-276">In der zweiten Browser Instanz wird der Text ausgelöste Ereignis Auslösung nicht angezeigt, da er die gleichen zwischengespeicherten Daten wie der erste verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ba31-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="4ba31-277">Beim Einfügen der abgerufenen Daten in den Cache verwendet ObjectDataSource einen Cache Schlüsselwert, der Folgendes enthält: die `CacheDuration`-und `CacheExpirationPolicy`-Eigenschaftswerte. der Typ des zugrunde liegenden Geschäftsobjekts, das von ObjectDataSource verwendet wird, das über die [`TypeName`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) angegeben wird (in diesem Beispiel`ProductsBLL`); der Wert der `SelectMethod`-Eigenschaft und der Name und die Werte der Parameter in der `SelectParameters` Auflistung. und die Werte der Eigenschaften `StartRowIndex` und `MaximumRows`, die beim Implementieren von [benutzerdefiniertem Paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md)verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="4ba31-278">Wenn Sie den Cache Schlüsselwert als eine Kombination dieser Eigenschaften erstellen, wird ein eindeutiger Cache Eintrag sichergestellt, da sich diese Werte ändern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="4ba31-279">In den vorherigen Tutorials haben wir uns z. b. mit der Verwendung der `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)`beschäftigt, die alle Produkte für eine bestimmte Kategorie zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="4ba31-280">Ein Benutzer kann auf die Seite wechseln und Getränke anzeigen, die eine `CategoryID` von 1 haben.</span><span class="sxs-lookup"><span data-stu-id="4ba31-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="4ba31-281">Wenn die ObjectDataSource ihre Ergebnisse ohne Berücksichtigung der `SelectParameters` Werte zwischengespeichert hat und ein anderer Benutzer auf die Seite kam, um die Bedingungen anzuzeigen, während sich die Getränkeprodukte im Cache befanden, sehen Sie die zwischengespeicherten Getränkeprodukte anstelle von Bedingungen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="4ba31-282">Durch die Variation des Cache Schlüssels durch diese Eigenschaften, die die Werte der `SelectParameters`enthalten, behält ObjectDataSource einen separaten Cache Eintrag für Getränke und Bedingungen bei.</span><span class="sxs-lookup"><span data-stu-id="4ba31-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="4ba31-283">Probleme mit veralteten Daten</span><span class="sxs-lookup"><span data-stu-id="4ba31-283">Stale Data Concerns</span></span>

<span data-ttu-id="4ba31-284">Die ObjectDataSource entfernt ihre Elemente automatisch aus dem Cache, wenn eine ihrer `Insert`-, `Update`-oder `Delete` Methoden aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4ba31-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="4ba31-285">Dies trägt zum Schutz vor veralteten Daten bei, indem die Cache Einträge gelöscht werden, wenn die Daten auf der Seite geändert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="4ba31-286">Es ist jedoch möglich, dass eine ObjectDataSource, die die Zwischenspeicherung verwendet, weiterhin veraltete Daten anzeigt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="4ba31-287">Im einfachsten Fall kann dies darauf zurückzuführen sein, dass sich die Daten direkt innerhalb der Datenbank ändern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="4ba31-288">Möglicherweise hat ein Datenbankadministrator soeben ein Skript ausgeführt, mit dem einige der Datensätze in der Datenbank geändert werden.</span><span class="sxs-lookup"><span data-stu-id="4ba31-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="4ba31-289">Dieses Szenario kann sich auch auf eine detailliertere Weise entwickeln.</span><span class="sxs-lookup"><span data-stu-id="4ba31-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="4ba31-290">Während die ObjectDataSource ihre Elemente aus dem Cache entfernt, wenn eine Ihrer Daten Änderungs Methoden aufgerufen wird, sind die zwischengespeicherten Elemente, die entfernt werden, für die ObjectDataSource-Eigenschaft eine bestimmte Kombination von Eigenschafts Werten (`CacheDuration`, `TypeName`, `SelectMethod`usw.).</span><span class="sxs-lookup"><span data-stu-id="4ba31-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="4ba31-291">Wenn Sie über zwei objectdatasources verfügen, die unterschiedliche `SelectMethods` oder `SelectParameters`verwenden, aber trotzdem dieselben Daten aktualisieren können, kann ein ObjectDataSource-Objekt eine Zeile aktualisieren und seine eigenen Cache Einträge für ungültig erklären, aber die entsprechende Zeile für die zweite ObjectDataSource wird weiterhin vom zwischengespeicherten bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="4ba31-292">Ich empfehle Ihnen, Seiten zu erstellen, um diese Funktionalität zu präsentieren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="4ba31-293">Erstellen Sie eine Seite, auf der eine bearbeitbare GridView angezeigt wird, die Ihre Daten aus einer ObjectDataSource abruft, die Caching verwendet und so konfiguriert ist, dass Sie Daten aus der `ProductsBLL` Class s `GetProducts()`-Methode abrufen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="4ba31-294">Fügen Sie dieser Seite (oder einem anderen) weitere bearbeitbare GridView-und ObjectDataSource-Objekte hinzu, aber für diese zweite ObjectDataSource wird die `GetProductsByCategoryID(categoryID)`-Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ba31-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="4ba31-295">Da sich die beiden Eigenschaften von objectdatasources `SelectMethod` unterscheiden, verfügen Sie jeweils über eigene zwischengespeicherte Werte.</span><span class="sxs-lookup"><span data-stu-id="4ba31-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="4ba31-296">Wenn Sie ein Produkt in einem Raster bearbeiten, werden bei der nächsten Bindung der Daten an das andere Raster (durch auslagern, sortieren usw.) weiterhin die alten, zwischengespeicherten Daten verarbeitet und nicht die vom anderen Raster vorgenommene Änderung widerspiegeln.</span><span class="sxs-lookup"><span data-stu-id="4ba31-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="4ba31-297">Verwenden Sie kurz gesagt nur zeitbasierte Abläufe, wenn Sie bereit sind, das Potenzial veralteter Daten zu haben, und verwenden Sie kürzere Abläufe für Szenarien, in denen die Aktualität der Daten wichtig ist.</span><span class="sxs-lookup"><span data-stu-id="4ba31-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="4ba31-298">Wenn veraltete Daten nicht zulässig sind, müssen Sie entweder das verzichten-Caching oder SQL-Cache Abhängigkeiten verwenden (vorausgesetzt, es handelt sich um Datenbankdaten, die Sie neu</span><span class="sxs-lookup"><span data-stu-id="4ba31-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="4ba31-299">In einem zukünftigen Tutorial untersuchen wir SQL-Cache Abhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="4ba31-300">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="4ba31-300">Summary</span></span>

<span data-ttu-id="4ba31-301">In diesem Tutorial haben wir die integrierten Caching-Funktionen von ObjectDataSource untersucht.</span><span class="sxs-lookup"><span data-stu-id="4ba31-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="4ba31-302">Durch einfaches Festlegen einiger Eigenschaften können wir die ObjectDataSource anweisen, die vom angegebenen `SelectMethod` zurückgegebenen Ergebnisse in den ASP.NET-Daten Cache zwischenzuspeichern.</span><span class="sxs-lookup"><span data-stu-id="4ba31-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="4ba31-303">Die Eigenschaften `CacheDuration` und `CacheExpirationPolicy` geben an, wie lange das Element zwischengespeichert wird und ob es sich um einen absoluten oder gleitenden Ablauf handelt.</span><span class="sxs-lookup"><span data-stu-id="4ba31-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="4ba31-304">Die `CacheKeyDependency`-Eigenschaft ordnet alle ObjectDataSource s-Cache Einträge einer vorhandenen Cache Abhängigkeit zu.</span><span class="sxs-lookup"><span data-stu-id="4ba31-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="4ba31-305">Dies kann verwendet werden, um die ObjectDataSource s-Einträge aus dem Cache zu entfernen, bevor der zeitbasierte Ablauf erreicht wird. Sie wird in der Regel mit SQL-Cache Abhängigkeiten verwendet.</span><span class="sxs-lookup"><span data-stu-id="4ba31-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="4ba31-306">Da die Werte von ObjectDataSource einfach in den Daten Cache zwischengespeichert werden, können Sie die integrierte ObjectDataSource-Funktion Programm gesteuert replizieren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="4ba31-307">Es ist nicht sinnvoll, dies auf der Präsentationsebene zu tun, da die ObjectDataSource diese Funktionalität standardmäßig bietet, aber wir können zwischen Speicherungs Funktionen in einer separaten Ebene der Architektur implementieren.</span><span class="sxs-lookup"><span data-stu-id="4ba31-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="4ba31-308">Zu diesem Zweck müssen wir dieselbe von ObjectDataSource verwendete Logik wiederholen.</span><span class="sxs-lookup"><span data-stu-id="4ba31-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="4ba31-309">In unserem nächsten Tutorial wird erläutert, wie Sie Programm gesteuert mit dem Daten Cache in der Architektur arbeiten.</span><span class="sxs-lookup"><span data-stu-id="4ba31-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="4ba31-310">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="4ba31-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="4ba31-311">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="4ba31-311">Further Reading</span></span>

<span data-ttu-id="4ba31-312">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="4ba31-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4ba31-313">ASP.NET Caching: Techniken und bewährte Methoden</span><span class="sxs-lookup"><span data-stu-id="4ba31-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="4ba31-314">Leitfaden zum Zwischenspeichern von Architekturen für .NET Framework Anwendungen</span><span class="sxs-lookup"><span data-stu-id="4ba31-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="4ba31-315">Ausgabe Zwischenspeicherung in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="4ba31-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="4ba31-316">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="4ba31-316">About the Author</span></span>

<span data-ttu-id="4ba31-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="4ba31-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4ba31-318">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="4ba31-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4ba31-319">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4ba31-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4ba31-320">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4ba31-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="4ba31-321">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4ba31-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="4ba31-322">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="4ba31-322">Special Thanks To</span></span>

<span data-ttu-id="4ba31-323">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="4ba31-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4ba31-324">Lead Reviewer für dieses Tutorial war Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="4ba31-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="4ba31-325">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="4ba31-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4ba31-326">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4ba31-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4ba31-327">[Zurück](using-sql-cache-dependencies-cs.md)
> [Weiter](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4ba31-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
