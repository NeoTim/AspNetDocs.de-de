---
uid: web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-cs
title: Verwenden von SQL-CacheC#Abhängigkeiten () | Microsoft-Dokumentation
author: rick-anderson
description: Die einfachste Strategie zum Zwischenspeichern besteht darin, die zwischengespeicherten Daten nach einem bestimmten Zeitraum ablaufen zu lassen. Diese einfache Vorgehensweise bedeutet aber, dass die zwischengespeicherten Daten maintai...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 0e91842c-7f10-4aed-8c23-4ee3e2774014
msc.legacyurl: /web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-cs
msc.type: authoredcontent
ms.openlocfilehash: 5bc27a08e39606c25b8f99d6ea057d2a853f08a6
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74611950"
---
# <a name="using-sql-cache-dependencies-c"></a><span data-ttu-id="e1d46-104">Verwenden von SQL-Cacheabhängigkeiten (C#)</span><span class="sxs-lookup"><span data-stu-id="e1d46-104">Using SQL Cache Dependencies (C#)</span></span>

<span data-ttu-id="e1d46-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e1d46-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e1d46-106">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_CS.zip) oder [PDF herunterladen](using-sql-cache-dependencies-cs/_static/datatutorial61cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e1d46-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_CS.zip) or [Download PDF](using-sql-cache-dependencies-cs/_static/datatutorial61cs1.pdf)</span></span>

> <span data-ttu-id="e1d46-107">Die einfachste Strategie zum Zwischenspeichern besteht darin, die zwischengespeicherten Daten nach einem bestimmten Zeitraum ablaufen zu lassen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-107">The simplest caching strategy is to allow cached data to expire after a specified period of time.</span></span> <span data-ttu-id="e1d46-108">Diese einfache Vorgehensweise bedeutet aber, dass die zwischengespeicherten Daten nicht mit der zugrunde liegenden Datenquelle zusammengeführt werden. Dies führt zu veralteten Daten, die zu lange dauern, oder aktuelle Daten, die zu bald abgelaufen sind.</span><span class="sxs-lookup"><span data-stu-id="e1d46-108">But this simple approach means that the cached data maintains no association with its underlying data source, resulting in stale data that is held too long or current data that is expired too soon.</span></span> <span data-ttu-id="e1d46-109">Ein besserer Ansatz ist die Verwendung der sqlcachedepend-Klasse, damit die Daten zwischengespeichert bleiben, bis die zugrunde liegenden Daten in der SQL-Datenbank geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-109">A better approach is to use the SqlCacheDependency class so that data remains cached until its underlying data has been modified in the SQL database.</span></span> <span data-ttu-id="e1d46-110">In diesem Tutorial wird gezeigt, wie Sie.</span><span class="sxs-lookup"><span data-stu-id="e1d46-110">This tutorial shows you how.</span></span>

## <a name="introduction"></a><span data-ttu-id="e1d46-111">Einführung</span><span class="sxs-lookup"><span data-stu-id="e1d46-111">Introduction</span></span>

<span data-ttu-id="e1d46-112">Die zwischen Speicherungs Techniken, die unter zwischen [Speichern von Daten mit der ObjectDataSource](caching-data-with-the-objectdatasource-cs.md) und zwischen [Speichern von Daten in den Architektur](caching-data-in-the-architecture-cs.md) Lernprogrammen untersucht wurden, verwendeten einen zeitbasierten Ablauf, um die Daten aus dem Cache nach einem bestimmten Zeitraum zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-112">The caching techniques examined in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-cs.md) and [Caching Data in the Architecture](caching-data-in-the-architecture-cs.md) tutorials used a time-based expiry to evict the data from the cache after a specified period.</span></span> <span data-ttu-id="e1d46-113">Diese Vorgehensweise ist die einfachste Methode, um die Leistungssteigerungen der Zwischenspeicherung gegen Daten Veraltung auszugleichen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-113">This approach is the simplest way to balance the performance gains of caching against data staleness.</span></span> <span data-ttu-id="e1d46-114">Durch die Auswahl eines Zeitverlaufs von *x* Sekunden gibt ein Seiten Entwickler an, dass Sie die Leistungsvorteile der Zwischenspeicherung nur für *x* Sekunden genießen, aber Sie können sich darauf verlassen, dass Ihre Daten nie länger als maximal *x* Sekunden abgelaufen sind.</span><span class="sxs-lookup"><span data-stu-id="e1d46-114">By selecting a time expiry of *x* seconds, a page developer concedes to enjoy the performance benefits of caching for only *x* seconds, but can rest easy that her data will never be stale longer than a maximum of *x* seconds.</span></span> <span data-ttu-id="e1d46-115">Natürlich kann *x* für statische Daten auf die Lebensdauer der Webanwendung erweitert werden, wie im Tutorial zwischen [Speichern von Daten beim Anwendungsstart](caching-data-at-application-startup-cs.md) untersucht.</span><span class="sxs-lookup"><span data-stu-id="e1d46-115">Of course, for static data, *x* can be extended to the lifetime of the web application, as was examined in the [Caching Data at Application Startup](caching-data-at-application-startup-cs.md) tutorial.</span></span>

<span data-ttu-id="e1d46-116">Beim Zwischenspeichern von Datenbankdaten wird häufig eine zeitbasierte Ablaufzeit für die einfache Verwendung ausgewählt, aber häufig eine unzureichende Lösung.</span><span class="sxs-lookup"><span data-stu-id="e1d46-116">When caching database data, a time-based expiry is often chosen for its ease of use but is frequently an inadequate solution.</span></span> <span data-ttu-id="e1d46-117">Im Idealfall bleiben die Datenbankdaten so lange zwischengespeichert, bis die zugrunde liegenden Daten in der Datenbank geändert wurden. nur dann würde der Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-117">Ideally, the database data would remain cached until the underlying data has been modified in the database; only then would the cache be evicted.</span></span> <span data-ttu-id="e1d46-118">Durch diese Vorgehensweise werden die Leistungsvorteile der Zwischenspeicherung maximiert und die Dauer veralteter Daten minimiert.</span><span class="sxs-lookup"><span data-stu-id="e1d46-118">This approach maximizes the performance benefits of caching and minimizes the duration of stale data.</span></span> <span data-ttu-id="e1d46-119">Um diese Vorteile nutzen zu können, muss jedoch ein System vorhanden sein, das weiß, wann die zugrunde liegenden Datenbankdaten geändert wurden, und die entsprechenden Elemente aus dem Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-119">However, in order to enjoy these benefits there must be some system in place that knows when the underlying database data has been modified and evicts the corresponding items from the cache.</span></span> <span data-ttu-id="e1d46-120">Vor ASP.NET 2,0 waren Seiten Entwickler für die Implementierung dieses Systems verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="e1d46-120">Prior to ASP.NET 2.0, page developers were responsible for implementing this system.</span></span>

<span data-ttu-id="e1d46-121">ASP.NET 2,0 bietet eine [`SqlCacheDependency`-Klasse](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) und die erforderliche-Infrastruktur, um zu bestimmen, wann eine Änderung in der Datenbank aufgetreten ist, sodass die entsprechenden zwischengespeicherten Elemente entfernt werden können.</span><span class="sxs-lookup"><span data-stu-id="e1d46-121">ASP.NET 2.0 provides a [`SqlCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) and the necessary infrastructure to determine when a change has occurred in the database so that the corresponding cached items can be evicted.</span></span> <span data-ttu-id="e1d46-122">Es gibt zwei Verfahren, um zu bestimmen, wann sich die zugrunde liegenden Daten geändert haben: Benachrichtigung und Abruf.</span><span class="sxs-lookup"><span data-stu-id="e1d46-122">There are two techniques for determining when the underlying data has changed: notification and polling.</span></span> <span data-ttu-id="e1d46-123">Nach der Erörterung der Unterschiede zwischen Benachrichtigung und Abruf erstellen wir die Infrastruktur, die für die Unterstützung von Abruf erforderlich ist, und untersuchen dann die Verwendung der `SqlCacheDependency`-Klasse in deklarativen und programmgesteuerten Szenarien.</span><span class="sxs-lookup"><span data-stu-id="e1d46-123">After discussing the differences between notification and polling, we'll create the infrastructure necessary to support polling and then explore how to use the `SqlCacheDependency` class in declarative and programmatically scenarios.</span></span>

## <a name="understanding-notification-and-polling"></a><span data-ttu-id="e1d46-124">Informationen zu Benachrichtigungen und Abruf</span><span class="sxs-lookup"><span data-stu-id="e1d46-124">Understanding Notification and Polling</span></span>

<span data-ttu-id="e1d46-125">Es gibt zwei Techniken, mit denen bestimmt werden kann, wann die Daten in einer Datenbank geändert wurden: Benachrichtigung und Abruf.</span><span class="sxs-lookup"><span data-stu-id="e1d46-125">There are two techniques that can be used to determine when the data in a database has been modified: notification and polling.</span></span> <span data-ttu-id="e1d46-126">Bei der Benachrichtigung wird die ASP.NET-Laufzeit automatisch von der Datenbank benachrichtigt, wenn die Ergebnisse einer bestimmten Abfrage seit der letzten Ausführung der Abfrage geändert wurden. zu diesem Zeitpunkt werden die der Abfrage zugeordneten zwischengespeicherten Elemente entfernt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-126">With notification, the database automatically alerts the ASP.NET runtime when the results of a particular query have been changed since the query was last executed, at which point the cached items associated with the query are evicted.</span></span> <span data-ttu-id="e1d46-127">Beim Abrufen behält der Datenbankserver Informationen darüber bei, wann bestimmte Tabellen zuletzt aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-127">With polling, the database server maintains information about when particular tables have last been updated.</span></span> <span data-ttu-id="e1d46-128">Die ASP.NET-Laufzeit fragt regelmäßig die Datenbank ab, um zu überprüfen, welche Tabellen geändert wurden, seit Sie in den Cache eingegeben wurden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-128">The ASP.NET runtime periodically polls the database to check what tables have changed since they were entered into the cache.</span></span> <span data-ttu-id="e1d46-129">Bei den Tabellen, deren Daten geändert wurden, werden die zugehörigen Cache Elemente entfernt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-129">Those tables whose data has been modified have their associated cache items evicted.</span></span>

<span data-ttu-id="e1d46-130">Die Benachrichtigungs Option erfordert weniger Setup als Abruf und ist präziser, da Änderungen auf Abfrage Ebene und nicht auf Tabellenebene nachverfolgt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-130">The notification option requires less setup than polling and is more granular since it tracks changes at the query level rather than at the table level.</span></span> <span data-ttu-id="e1d46-131">Leider sind Benachrichtigungen nur in den vollständigen Editionen von Microsoft SQL Server 2005 verfügbar (d. h. die nicht-Express-Editionen).</span><span class="sxs-lookup"><span data-stu-id="e1d46-131">Unfortunately, notifications are only available in the full editions of Microsoft SQL Server 2005 (i.e., the non-Express editions).</span></span> <span data-ttu-id="e1d46-132">Die Abruf Option kann jedoch für alle Versionen von Microsoft SQL Server von 7,0 bis 2005 verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-132">However, the polling option can be used for all versions of Microsoft SQL Server from 7.0 to 2005.</span></span> <span data-ttu-id="e1d46-133">Da in diesen Tutorials die Express Edition von SQL Server 2005 verwendet wird, konzentrieren wir uns auf das Einrichten und Verwenden der Abruf Option.</span><span class="sxs-lookup"><span data-stu-id="e1d46-133">Since these tutorials use the Express edition of SQL Server 2005, we will focus on setting up and using the polling option.</span></span> <span data-ttu-id="e1d46-134">Weitere Informationen zu SQL Server von Benachrichtigungsfunktionen von 2005 s finden Sie im Abschnitt weiter unten in diesem Tutorial.</span><span class="sxs-lookup"><span data-stu-id="e1d46-134">Consult the Further Reading section at the end of this tutorial for further resources on SQL Server 2005 s notification capabilities.</span></span>

<span data-ttu-id="e1d46-135">Beim Abrufen muss die Datenbank so konfiguriert werden, dass eine Tabelle mit dem Namen `AspNet_SqlCacheTablesForChangeNotification` mit drei Spalten `tableName`, `notificationCreated`und `changeId`enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="e1d46-135">With polling, the database must be configured to include a table named `AspNet_SqlCacheTablesForChangeNotification` that has three columns - `tableName`, `notificationCreated`, and `changeId`.</span></span> <span data-ttu-id="e1d46-136">Diese Tabelle enthält eine Zeile für jede Tabelle, die Daten enthält, die möglicherweise in einer SQL-Cache Abhängigkeit in der-Webanwendung verwendet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-136">This table contains a row for each table that has data that might need to be used in a SQL cache dependency in the web application.</span></span> <span data-ttu-id="e1d46-137">Die Spalte `tableName` gibt den Namen der Tabelle an, während `notificationCreated` das Datum und die Uhrzeit angibt, zu der die Zeile der Tabelle hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="e1d46-137">The `tableName` column specifies the name of the table while `notificationCreated` indicates the date and time the row was added to the table.</span></span> <span data-ttu-id="e1d46-138">Die `changeId` Spalte ist vom Typ `int` und hat den Anfangswert 0.</span><span class="sxs-lookup"><span data-stu-id="e1d46-138">The `changeId` column is of type `int` and has an initial value of 0.</span></span> <span data-ttu-id="e1d46-139">Der Wert wird bei jeder Änderung der Tabelle inkrementiert.</span><span class="sxs-lookup"><span data-stu-id="e1d46-139">Its value is incremented with each modification to the table.</span></span>

<span data-ttu-id="e1d46-140">Zusätzlich zur `AspNet_SqlCacheTablesForChangeNotification` Tabelle muss die Datenbank auch Trigger für jede der Tabellen enthalten, die möglicherweise in einer SQL-Cache Abhängigkeit angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-140">In addition to the `AspNet_SqlCacheTablesForChangeNotification` table, the database also needs to include triggers on each of the tables that may appear in a SQL cache dependency.</span></span> <span data-ttu-id="e1d46-141">Diese Trigger werden immer dann ausgeführt, wenn eine Zeile eingefügt, aktualisiert oder gelöscht und der Wert der Tabelle s `changeId` in `AspNet_SqlCacheTablesForChangeNotification`erhöht wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-141">These triggers are executed whenever a row is inserted, updated, or deleted and increment the table s `changeId` value in `AspNet_SqlCacheTablesForChangeNotification`.</span></span>

<span data-ttu-id="e1d46-142">Die ASP.NET-Laufzeit verfolgt beim Zwischenspeichern von Daten mit einem `SqlCacheDependency`-Objekt den aktuellen `changeId` für eine Tabelle.</span><span class="sxs-lookup"><span data-stu-id="e1d46-142">The ASP.NET runtime tracks the current `changeId` for a table when caching data using a `SqlCacheDependency` object.</span></span> <span data-ttu-id="e1d46-143">Die Datenbank wird in regelmäßigen Abständen überprüft, und alle `SqlCacheDependency` Objekte, deren `changeId` sich vom Wert in der Datenbank unterscheidet, werden entfernt, da ein abweichender `changeId` Wert angibt, dass seit der Zwischenspeicherung der Daten eine Änderung an der Tabelle vorgenommen wurde.</span><span class="sxs-lookup"><span data-stu-id="e1d46-143">The database is periodically checked and any `SqlCacheDependency` objects whose `changeId` differs from the value in the database are evicted since a differing `changeId` value indicates that there has been a change to the table since the data was cached.</span></span>

## <a name="step-1-exploring-theaspnet_regsqlexecommand-line-program"></a><span data-ttu-id="e1d46-144">Schritt 1: Untersuchen des`aspnet_regsql.exe`Befehlszeilen Programms</span><span class="sxs-lookup"><span data-stu-id="e1d46-144">Step 1: Exploring the`aspnet_regsql.exe`Command Line Program</span></span>

<span data-ttu-id="e1d46-145">Beim Abruf Ansatz muss die Datenbank so eingerichtet werden, dass Sie die oben beschriebene Infrastruktur enthält: eine vordefinierte Tabelle (`AspNet_SqlCacheTablesForChangeNotification`), eine Handvoll gespeicherter Prozeduren und Trigger für jede Tabelle, die in SQL-Cache Abhängigkeiten in der Webanwendung verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="e1d46-145">With the polling approach the database must be setup to contain the infrastructure described above: a predefined table (`AspNet_SqlCacheTablesForChangeNotification`), a handful of stored procedures, and triggers on each of the tables that may be used in SQL cache dependencies in the web application.</span></span> <span data-ttu-id="e1d46-146">Diese Tabellen, gespeicherten Prozeduren und Trigger können über das Befehlszeilenprogramm `aspnet_regsql.exe`erstellt werden, das sich im Ordner `$WINDOWS$\Microsoft.NET\Framework\version` befindet.</span><span class="sxs-lookup"><span data-stu-id="e1d46-146">These tables, stored procedures, and triggers can be created through the command line program `aspnet_regsql.exe`, which is found in the `$WINDOWS$\Microsoft.NET\Framework\version` folder.</span></span> <span data-ttu-id="e1d46-147">Um die `AspNet_SqlCacheTablesForChangeNotification` Tabelle und die zugehörigen gespeicherten Prozeduren zu erstellen, führen Sie den folgenden Befehl über die Befehlszeile aus:</span><span class="sxs-lookup"><span data-stu-id="e1d46-147">To create the `AspNet_SqlCacheTablesForChangeNotification` table and associated stored procedures, run the following from the command line:</span></span>

[!code-console[Main](using-sql-cache-dependencies-cs/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="e1d46-148">Um diese Befehle auszuführen, muss sich die angegebene Daten Bank Anmeldung in den Rollen [`db_securityadmin`](https://msdn.microsoft.com/library/ms188685.aspx) und [`db_ddladmin`](https://msdn.microsoft.com/library/ms190667.aspx) befinden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-148">To execute these commands the specified database login must be in the [`db_securityadmin`](https://msdn.microsoft.com/library/ms188685.aspx) and [`db_ddladmin`](https://msdn.microsoft.com/library/ms190667.aspx) roles.</span></span> <span data-ttu-id="e1d46-149">Informationen zum Überprüfen des T-SQL, das vom `aspnet_regsql.exe` Befehlszeilenprogramm an die Datenbank gesendet wird, finden Sie in [diesem Blogeintrag](http://scottonwriting.net/sowblog/posts/10709.aspx).</span><span class="sxs-lookup"><span data-stu-id="e1d46-149">To examine the T-SQL sent to the database by the `aspnet_regsql.exe` command line program, refer to [this blog entry](http://scottonwriting.net/sowblog/posts/10709.aspx).</span></span>

<span data-ttu-id="e1d46-150">Wenn Sie z. b. die Infrastruktur zum Abrufen einer Microsoft SQL Server Datenbank mit dem Namen `pubs` auf einem Daten Bank Server mit dem Namen `ScottsServer` mithilfe der Windows-Authentifizierung hinzufügen möchten, navigieren Sie zum entsprechenden Verzeichnis, und geben Sie in der Befehlszeile Folgendes ein:</span><span class="sxs-lookup"><span data-stu-id="e1d46-150">For example, to add the infrastructure for polling to a Microsoft SQL Server database named `pubs` on a database server named `ScottsServer` using Windows Authentication, navigate to the appropriate directory and, from the command line, enter:</span></span>

[!code-console[Main](using-sql-cache-dependencies-cs/samples/sample2.cmd)]

<span data-ttu-id="e1d46-151">Nachdem die Infrastruktur auf Datenbankebene hinzugefügt wurde, müssen die Trigger den Tabellen hinzugefügt werden, die in SQL-Cache Abhängigkeiten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-151">After the database-level infrastructure has been added, we need to add the triggers to those tables that will be used in SQL cache dependencies.</span></span> <span data-ttu-id="e1d46-152">Verwenden Sie das `aspnet_regsql.exe` Befehlszeilenprogramm erneut, geben Sie den Tabellennamen jedoch mithilfe des `-t`-Schalters an, und verwenden Sie anstelle des `-ed` Schalters `-et`wie folgt:</span><span class="sxs-lookup"><span data-stu-id="e1d46-152">Use the `aspnet_regsql.exe` command line program again, but specify the table name using the `-t` switch and instead of using the `-ed` switch use `-et`, like so:</span></span>

[!code-html[Main](using-sql-cache-dependencies-cs/samples/sample3.html)]

<span data-ttu-id="e1d46-153">Verwenden Sie zum Hinzufügen der Trigger zum `authors` und `titles` Tabellen in der `pubs`-Datenbank auf `ScottsServer`Folgendes:</span><span class="sxs-lookup"><span data-stu-id="e1d46-153">To add the triggers to the `authors` and `titles` tables on the `pubs` database on `ScottsServer`, use:</span></span>

[!code-console[Main](using-sql-cache-dependencies-cs/samples/sample4.cmd)]

<span data-ttu-id="e1d46-154">Fügen Sie für dieses Tutorial die Trigger zu den Tabellen `Products`, `Categories`und `Suppliers` hinzu.</span><span class="sxs-lookup"><span data-stu-id="e1d46-154">For this tutorial add the triggers to the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="e1d46-155">Wir sehen uns die Befehlszeilen Syntax in Schritt 3 an.</span><span class="sxs-lookup"><span data-stu-id="e1d46-155">We'll look at the particular command line syntax in Step 3.</span></span>

## <a name="step-2-referencing-a-microsoft-sql-server-2005-express-edition-database-inapp_data"></a><span data-ttu-id="e1d46-156">Schritt 2: verweisen auf eine Microsoft SQL Server 2005 Express Edition-Datenbank in`App_Data`</span><span class="sxs-lookup"><span data-stu-id="e1d46-156">Step 2: Referencing a Microsoft SQL Server 2005 Express Edition Database in`App_Data`</span></span>

<span data-ttu-id="e1d46-157">Das `aspnet_regsql.exe`-Befehlszeilenprogramm erfordert den Datenbank-und Servernamen, um die erforderliche Abruf Infrastruktur hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-157">The `aspnet_regsql.exe` command line program requires the database and server name in order to add the necessary polling infrastructure.</span></span> <span data-ttu-id="e1d46-158">Aber wie lautet der Datenbank-und Servername für eine Microsoft SQL Server 2005 Express-Datenbank, die sich im Ordner "`App_Data`" befindet?</span><span class="sxs-lookup"><span data-stu-id="e1d46-158">But what is the database and server name for a Microsoft SQL Server 2005 Express database that resides in the `App_Data` folder?</span></span> <span data-ttu-id="e1d46-159">Anstatt die Namen der Datenbank und des Servers zu ermitteln, habe ich festgestellt, dass der einfachste Ansatz darin besteht, die Datenbank an die `localhost\SQLExpress` Daten Bank Instanz anzufügen und die Daten mithilfe [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx)umzubenennen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-159">Rather than having to discover what the database and server names are, I ve found that the simplest approach is to attach the database to the `localhost\SQLExpress` database instance and rename the data using [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span></span> <span data-ttu-id="e1d46-160">Wenn eine der Vollversionen von SQL Server 2005 auf Ihrem Computer installiert ist, haben Sie wahrscheinlich bereits SQL Server Management Studio auf dem Computer installiert.</span><span class="sxs-lookup"><span data-stu-id="e1d46-160">If you have one of the full versions of SQL Server 2005 installed on your machine, then you likely already have SQL Server Management Studio installed on your computer.</span></span> <span data-ttu-id="e1d46-161">Wenn Sie nur über die Express Edition verfügen, können Sie die kostenlose [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796)herunterladen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-161">If you only have the Express edition, you can download the free [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span></span>

<span data-ttu-id="e1d46-162">Beginnen Sie mit dem Schließen von Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e1d46-162">Start by closing Visual Studio.</span></span> <span data-ttu-id="e1d46-163">Öffnen Sie als nächstes SQL Server Management Studio, und wählen Sie mithilfe der Windows-Authentifizierung eine Verbindung mit dem `localhost\SQLExpress` Server aus.</span><span class="sxs-lookup"><span data-stu-id="e1d46-163">Next, open SQL Server Management Studio and choose to connect to the `localhost\SQLExpress` server using Windows Authentication.</span></span>

![Anfügen an den localhost\SQLExpress-Server](using-sql-cache-dependencies-cs/_static/image1.gif)

<span data-ttu-id="e1d46-165">**Abbildung 1**: Anfügen an den `localhost\SQLExpress` Server</span><span class="sxs-lookup"><span data-stu-id="e1d46-165">**Figure 1**: Attach to the `localhost\SQLExpress` Server</span></span>

<span data-ttu-id="e1d46-166">Nach dem Herstellen einer Verbindung mit dem Server zeigt Management Studio den Server an und enthält Unterordner für die Datenbanken, Sicherheit usw.</span><span class="sxs-lookup"><span data-stu-id="e1d46-166">After connecting to the server, Management Studio will show the server and have subfolders for the databases, security, and so forth.</span></span> <span data-ttu-id="e1d46-167">Klicken Sie mit der rechten Maustaste auf den Ordner Datenbanken, und wählen Sie die Option anhängen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-167">Right-click on the Databases folder and choose the Attach option.</span></span> <span data-ttu-id="e1d46-168">Dadurch wird das Dialogfeld Datenbanken anfügen angezeigt (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="e1d46-168">This will bring up the Attach Databases dialog box (see Figure 2).</span></span> <span data-ttu-id="e1d46-169">Klicken Sie auf die Schaltfläche hinzufügen, und wählen Sie im Ordner `App_Data` der Webanwendung den Ordner `NORTHWND.MDF` Datenbank aus.</span><span class="sxs-lookup"><span data-stu-id="e1d46-169">Click the Add button and select the `NORTHWND.MDF` database folder in your web application s `App_Data` folder.</span></span>

<span data-ttu-id="e1d46-170">[![das Northwnd anfügen. MDF-Datenbank aus dem Ordner "App_Data"](using-sql-cache-dependencies-cs/_static/image2.gif)](using-sql-cache-dependencies-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-170">[![Attach the NORTHWND.MDF Database from the App_Data Folder](using-sql-cache-dependencies-cs/_static/image2.gif)](using-sql-cache-dependencies-cs/_static/image1.png)</span></span>

<span data-ttu-id="e1d46-171">**Abbildung 2**: Anfügen der `NORTHWND.MDF` Datenbank aus dem Ordner "`App_Data`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-171">**Figure 2**: Attach the `NORTHWND.MDF` Database from the `App_Data` Folder ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image2.png))</span></span>

<span data-ttu-id="e1d46-172">Dadurch wird die Datenbank dem Ordner Datenbanken hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-172">This will add the database to the Databases folder.</span></span> <span data-ttu-id="e1d46-173">Der Datenbankname ist möglicherweise der vollständige Pfad zur Datenbankdatei oder der vollständige Pfad, dem eine [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)vorangesteht ist.</span><span class="sxs-lookup"><span data-stu-id="e1d46-173">The database name might be the full path to the database file or the full path prepended with a [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span></span> <span data-ttu-id="e1d46-174">Um zu vermeiden, dass Sie diesen langwierigen Datenbanknamen bei Verwendung des Befehlszeilen Tools ASPNET\_RegSql. exe eingeben müssen, benennen Sie die Datenbank in einen benutzerfreundlicheren Namen um, indem Sie mit der rechten Maustaste auf die soeben angefügte Datenbank klicken und Umbenennen auswählen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-174">To avoid having to type in this lengthy database name when using the aspnet\_regsql.exe command line tool, rename the database to a more human-friendly name by right-clicking on database just attached and choosing Rename.</span></span> <span data-ttu-id="e1d46-175">Ich habe meine Datenbank in "datatutorials" umbenannt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-175">I ve renamed my database to DataTutorials .</span></span>

![Benennen Sie die angefügte Datenbank in einen benutzerfreundlicheren Namen um.](using-sql-cache-dependencies-cs/_static/image3.gif)

<span data-ttu-id="e1d46-177">**Abbildung 3**: Umbenennen der angefügten Datenbank in einen benutzerfreundlicheren Namen</span><span class="sxs-lookup"><span data-stu-id="e1d46-177">**Figure 3**: Rename the Attached Database to a More Human-Friendly Name</span></span>

## <a name="step-3-adding-the-polling-infrastructure-to-the-northwind-database"></a><span data-ttu-id="e1d46-178">Schritt 3: Hinzufügen der Abruf Infrastruktur zur Northwind-Datenbank</span><span class="sxs-lookup"><span data-stu-id="e1d46-178">Step 3: Adding the Polling Infrastructure to the Northwind Database</span></span>

<span data-ttu-id="e1d46-179">Nachdem wir nun die `NORTHWND.MDF` Datenbank aus dem Ordner "`App_Data`" angefügt haben, können wir die Abruf Infrastruktur hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-179">Now that we have attached the `NORTHWND.MDF` database from the `App_Data` folder, we re ready to add the polling infrastructure.</span></span> <span data-ttu-id="e1d46-180">Wenn Sie die Datenbank in datatutorials umbenannt haben, führen Sie die folgenden vier Befehle aus:</span><span class="sxs-lookup"><span data-stu-id="e1d46-180">Assuming that you ve renamed the database to DataTutorials, run the following four commands:</span></span>

[!code-console[Main](using-sql-cache-dependencies-cs/samples/sample5.cmd)]

<span data-ttu-id="e1d46-181">Nachdem Sie diese vier Befehle ausgeführt haben, klicken Sie in Management Studio mit der rechten Maustaste auf den Datenbanknamen, navigieren Sie zum Untermenü Tasks, und wählen Sie trennen aus.</span><span class="sxs-lookup"><span data-stu-id="e1d46-181">After running these four commands, right-click on the database name in Management Studio, go to the Tasks submenu, and choose Detach.</span></span> <span data-ttu-id="e1d46-182">Schließen Sie dann Management Studio, und öffnen Sie Visual Studio erneut.</span><span class="sxs-lookup"><span data-stu-id="e1d46-182">Then close Management Studio and reopen Visual Studio.</span></span>

<span data-ttu-id="e1d46-183">Nachdem Visual Studio erneut geöffnet wurde, führen Sie einen Drilldown in die Datenbank durch Server-Explorer aus.</span><span class="sxs-lookup"><span data-stu-id="e1d46-183">Once Visual Studio has reopened, drill into the database through the Server Explorer.</span></span> <span data-ttu-id="e1d46-184">Beachten Sie die neue Tabelle (`AspNet_SqlCacheTablesForChangeNotification`), die neuen gespeicherten Prozeduren und die Trigger in den Tabellen "`Products`", "`Categories`" und "`Suppliers`".</span><span class="sxs-lookup"><span data-stu-id="e1d46-184">Note the new table (`AspNet_SqlCacheTablesForChangeNotification`), the new stored procedures, and the triggers on the `Products`, `Categories`, and `Suppliers` tables.</span></span>

![Die Datenbank enthält jetzt die erforderliche Abruf Infrastruktur.](using-sql-cache-dependencies-cs/_static/image4.gif)

<span data-ttu-id="e1d46-186">**Abbildung 4**: die Datenbank enthält jetzt die erforderliche Abruf Infrastruktur</span><span class="sxs-lookup"><span data-stu-id="e1d46-186">**Figure 4**: The Database Now Includes the Necessary Polling Infrastructure</span></span>

## <a name="step-4-configuring-the-polling-service"></a><span data-ttu-id="e1d46-187">Schritt 4: Konfigurieren des Abruf dienstanweises</span><span class="sxs-lookup"><span data-stu-id="e1d46-187">Step 4: Configuring the Polling Service</span></span>

<span data-ttu-id="e1d46-188">Nachdem Sie die erforderlichen Tabellen, Trigger und gespeicherten Prozeduren in der Datenbank erstellt haben, ist der letzte Schritt die Konfiguration des Abruf Dienstanbieter, der durch `Web.config` durch Angabe der zu verwendenden Datenbanken und der Abruf Häufigkeit in Millisekunden erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-188">After creating the needed tables, triggers, and stored procedures in the database, the final step is to configure the polling service, which is done through `Web.config` by specifying the databases to use and the polling frequency in milliseconds.</span></span> <span data-ttu-id="e1d46-189">Das folgende Markup fragt die Northwind-Datenbank einmal pro Sekunde ab.</span><span class="sxs-lookup"><span data-stu-id="e1d46-189">The following markup polls the Northwind database once every second.</span></span>

[!code-xml[Main](using-sql-cache-dependencies-cs/samples/sample6.xml)]

<span data-ttu-id="e1d46-190">Der `name` Wert im `<add>`-Element (northwinddb) ordnet einen lesbaren Namen einer bestimmten Datenbank zu.</span><span class="sxs-lookup"><span data-stu-id="e1d46-190">The `name` value in the `<add>` element ( NorthwindDB ) associates a human-readable name with a particular database.</span></span> <span data-ttu-id="e1d46-191">Beim Arbeiten mit SQL-Cache Abhängigkeiten müssen wir auf den hier definierten Datenbanknamen sowie auf die Tabelle verweisen, auf der die zwischengespeicherten Daten basieren.</span><span class="sxs-lookup"><span data-stu-id="e1d46-191">When working with SQL cache dependencies, we'll need to refer to the database name defined here as well as the table that the cached data is based on.</span></span> <span data-ttu-id="e1d46-192">Wir sehen, wie Sie die `SqlCacheDependency`-Klasse verwenden, um zwischengespeicherten Daten in Schritt 6 Programm gesteuert SQL-Cache Abhängigkeiten zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-192">We'll see how to use the `SqlCacheDependency` class to programmatically associate SQL cache dependencies with cached data in Step 6.</span></span>

<span data-ttu-id="e1d46-193">Nachdem eine SQL-Cache Abhängigkeit hergestellt wurde, stellt das Abrufsystem eine Verbindung mit den Datenbanken her, die in den `<databases>` Elementen alle `pollTime` Millisekunden definiert sind, und führt die gespeicherte Prozedur `AspNet_SqlCachePollingStoredProcedure` aus.</span><span class="sxs-lookup"><span data-stu-id="e1d46-193">Once a SQL cache dependency has been established, the polling system will connect to the databases defined in the `<databases>` elements every `pollTime` milliseconds and execute the `AspNet_SqlCachePollingStoredProcedure` stored procedure.</span></span> <span data-ttu-id="e1d46-194">Diese gespeicherte Prozedur, die in Schritt 3 mithilfe des Befehlszeilen Tools `aspnet_regsql.exe` hinzugefügt wurde, gibt die `tableName`-und `changeId` Werte für jeden Datensatz in `AspNet_SqlCacheTablesForChangeNotification`zurück.</span><span class="sxs-lookup"><span data-stu-id="e1d46-194">This stored procedure - which was added back in Step 3 using the `aspnet_regsql.exe` command line tool - returns the `tableName` and `changeId` values for each record in `AspNet_SqlCacheTablesForChangeNotification`.</span></span> <span data-ttu-id="e1d46-195">Veraltete SQL-Cache Abhängigkeiten werden aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-195">Outdated SQL cache dependencies are evicted from the cache.</span></span>

<span data-ttu-id="e1d46-196">Die `pollTime` Einstellung führt zu einem Kompromiss zwischen Leistung und Daten Veraltung.</span><span class="sxs-lookup"><span data-stu-id="e1d46-196">The `pollTime` setting introduces a tradeoff between performance and data staleness.</span></span> <span data-ttu-id="e1d46-197">Ein kleiner `pollTime` Wert erhöht die Anzahl der Anforderungen an die Datenbank, aber es werden schneller veraltete Daten aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-197">A small `pollTime` value increases the number of requests to the database, but more quickly evicts stale data from the cache.</span></span> <span data-ttu-id="e1d46-198">Ein größerer `pollTime` Wert reduziert die Anzahl der Datenbankanforderungen, erhöht jedoch die Verzögerung zwischen dem Zeitpunkt, zu dem die Back-End-Daten geändert werden, und dem Entfernen der zugehörigen Cache Elemente.</span><span class="sxs-lookup"><span data-stu-id="e1d46-198">A larger `pollTime` value reduces the number of database requests, but increases the delay between when the backend data changes and when the related cache items are evicted.</span></span> <span data-ttu-id="e1d46-199">Glücklicherweise führt die Daten Bank Anforderung eine einfache gespeicherte Prozedur aus, die nur wenige Zeilen aus einer einfachen, einfachen Tabelle zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-199">Fortunately, the database request is executing a simple stored procedure that s returning just a few rows from a simple, lightweight table.</span></span> <span data-ttu-id="e1d46-200">Experimentieren Sie jedoch mit unterschiedlichen `pollTime` Werten, um ein optimales Gleichgewicht zwischen Datenbankzugriff und Daten Veraltung für Ihre Anwendung zu finden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-200">But do experiment with different `pollTime` values to find an ideal balance between database access and data staleness for your application.</span></span> <span data-ttu-id="e1d46-201">Der kleinste `pollTime` zulässige Wert ist 500.</span><span class="sxs-lookup"><span data-stu-id="e1d46-201">The smallest `pollTime` value allowed is 500.</span></span>

> [!NOTE]
> <span data-ttu-id="e1d46-202">Im obigen Beispiel wird ein einzelner `pollTime` Wert im `<sqlCacheDependency>`-Element bereitstellt, aber Sie können optional den `pollTime` Wert im `<add>`-Element angeben.</span><span class="sxs-lookup"><span data-stu-id="e1d46-202">The above example provides a single `pollTime` value in the `<sqlCacheDependency>` element, but you can optionally specify the `pollTime` value in the `<add>` element.</span></span> <span data-ttu-id="e1d46-203">Dies ist hilfreich, wenn Sie mehrere Datenbanken angegeben haben und die Abruf Häufigkeit pro Datenbank anpassen möchten.</span><span class="sxs-lookup"><span data-stu-id="e1d46-203">This is useful if you have multiple databases specified and want to customize the polling frequency per database.</span></span>

## <a name="step-5-declaratively-working-with-sql-cache-dependencies"></a><span data-ttu-id="e1d46-204">Schritt 5: Deklaratives arbeiten mit SQL-Cache Abhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="e1d46-204">Step 5: Declaratively Working with SQL Cache Dependencies</span></span>

<span data-ttu-id="e1d46-205">In den Schritten 1 bis 4 haben wir uns mit dem Einrichten der erforderlichen Datenbankinfrastruktur und der Konfiguration des Abruf Systems beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-205">In Steps 1 through 4 we looked at how to setup the necessary database infrastructure and configure the polling system.</span></span> <span data-ttu-id="e1d46-206">Mit dieser Infrastruktur können jetzt dem Daten Cache Elemente mit einer zugehörigen SQL-Cache Abhängigkeit mithilfe Programm gesteuerter oder deklarativer Verfahren hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-206">With this infrastructure in place, we can now add items to the data cache with an associated SQL cache dependency using either programmatic or declarative techniques.</span></span> <span data-ttu-id="e1d46-207">In diesem Schritt untersuchen wir die deklarative Arbeit mit SQL-Cache Abhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="e1d46-207">In this step we'll examine how to declaratively work with SQL cache dependencies.</span></span> <span data-ttu-id="e1d46-208">In Schritt 6 betrachten wir die programmgesteuerte Vorgehensweise.</span><span class="sxs-lookup"><span data-stu-id="e1d46-208">In Step 6 we'll look at the programmatic approach.</span></span>

<span data-ttu-id="e1d46-209">Im Tutorial zum zwischen [Speichern von Daten mit dem ObjectDataSource](caching-data-with-the-objectdatasource-cs.md) -Tutorial wurden die deklarativen zwischen Speicherungs Funktionen von ObjectDataSource untersucht.</span><span class="sxs-lookup"><span data-stu-id="e1d46-209">The [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-cs.md) tutorial explored the declarative caching capabilities of the ObjectDataSource.</span></span> <span data-ttu-id="e1d46-210">Wenn Sie einfach die `EnableCaching`-Eigenschaft auf `true` und die `CacheDuration`-Eigenschaft auf ein bestimmtes Zeitintervall festlegen, werden die Daten, die vom zugrunde liegenden-Objekt für das angegebene Intervall zurückgegeben werden, von ObjectDataSource automatisch zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="e1d46-210">By simply setting the `EnableCaching` property to `true` and the `CacheDuration` property to some time interval, the ObjectDataSource will automatically cache the data returned from its underlying object for the specified interval.</span></span> <span data-ttu-id="e1d46-211">Von ObjectDataSource können auch mindestens eine SQL-Cache Abhängigkeit verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-211">The ObjectDataSource can also use one or more SQL cache dependencies.</span></span>

<span data-ttu-id="e1d46-212">Um die deklarative Verwendung von SQL-Cache Abhängigkeiten zu veranschaulichen, öffnen Sie die Seite `SqlCacheDependencies.aspx` im Ordner `Caching`, und ziehen Sie eine GridView aus der Toolbox auf den Designer.</span><span class="sxs-lookup"><span data-stu-id="e1d46-212">To demonstrate using SQL cache dependencies declaratively, open the `SqlCacheDependencies.aspx` page in the `Caching` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="e1d46-213">Legen Sie die `ID` GridView s auf `ProductsDeclarative` fest, und wählen Sie aus dem smarttagtag aus, dass es an eine neue ObjectDataSource mit dem Namen `ProductsDataSourceDeclarative`gebunden werden soll.</span><span class="sxs-lookup"><span data-stu-id="e1d46-213">Set the GridView s `ID` to `ProductsDeclarative` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSourceDeclarative`.</span></span>

<span data-ttu-id="e1d46-214">[![erstellen Sie eine neue ObjectDataSource namens productdatasourcedeclarative.](using-sql-cache-dependencies-cs/_static/image5.gif)](using-sql-cache-dependencies-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-214">[![Create a New ObjectDataSource Named ProductsDataSourceDeclarative](using-sql-cache-dependencies-cs/_static/image5.gif)](using-sql-cache-dependencies-cs/_static/image3.png)</span></span>

<span data-ttu-id="e1d46-215">**Abbildung 5**: Erstellen einer neuen ObjectDataSource mit dem Namen "`ProductsDataSourceDeclarative`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-215">**Figure 5**: Create a New ObjectDataSource Named `ProductsDataSourceDeclarative` ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image4.png))</span></span>

<span data-ttu-id="e1d46-216">Konfigurieren Sie ObjectDataSource so, dass die `ProductsBLL`-Klasse verwendet wird, und legen Sie die Dropdown Liste auf der Registerkarte auswählen auf `GetProducts()`fest.</span><span class="sxs-lookup"><span data-stu-id="e1d46-216">Configure the ObjectDataSource to use the `ProductsBLL` class and set the drop-down list in the SELECT tab to `GetProducts()`.</span></span> <span data-ttu-id="e1d46-217">Wählen Sie auf der Registerkarte Update die `UpdateProduct` Überladung mit drei Eingabe Parametern aus: `productName`, `unitPrice`und `productID`.</span><span class="sxs-lookup"><span data-stu-id="e1d46-217">In the UPDATE tab, choose the `UpdateProduct` overload with three input parameters - `productName`, `unitPrice`, and `productID`.</span></span> <span data-ttu-id="e1d46-218">Legen Sie die Dropdown Liste auf der Registerkarte Einfügen und löschen auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="e1d46-218">Set the drop-down lists to (None) in the INSERT and DELETE tabs.</span></span>

<span data-ttu-id="e1d46-219">[![die UpdateProduct-Überladung mit drei Eingabe Parametern verwenden](using-sql-cache-dependencies-cs/_static/image6.gif)](using-sql-cache-dependencies-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-219">[![Use the UpdateProduct Overload with Three Input Parameters](using-sql-cache-dependencies-cs/_static/image6.gif)](using-sql-cache-dependencies-cs/_static/image5.png)</span></span>

<span data-ttu-id="e1d46-220">**Abbildung 6**: Verwenden der UpdateProduct-Überladung mit drei Eingabe Parametern ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-220">**Figure 6**: Use the UpdateProduct Overload with Three Input Parameters ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image6.png))</span></span>

<span data-ttu-id="e1d46-221">[![die Dropdown Liste für die Registerkarten einfügen und löschen auf (keine) festlegen.](using-sql-cache-dependencies-cs/_static/image7.gif)](using-sql-cache-dependencies-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-221">[![Set the Drop-Down List to (None) for the INSERT and DELETE Tabs](using-sql-cache-dependencies-cs/_static/image7.gif)](using-sql-cache-dependencies-cs/_static/image7.png)</span></span>

<span data-ttu-id="e1d46-222">**Abbildung 7**: Festlegen der Dropdown Liste auf (keine) für die Registerkarten "Einfügen" und "Löschen" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-222">**Figure 7**: Set the Drop-Down List to (None) for the INSERT and DELETE Tabs ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image8.png))</span></span>

<span data-ttu-id="e1d46-223">Nach dem Abschließen des Assistenten zum Konfigurieren von Datenquellen erstellt Visual Studio boundfields und checkboxfields in der GridView für jedes der Datenfelder.</span><span class="sxs-lookup"><span data-stu-id="e1d46-223">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="e1d46-224">Entfernen Sie alle Felder, jedoch `ProductName`, `CategoryName`und `UnitPrice`, und formatieren Sie diese Felder wie angezeigt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-224">Remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="e1d46-225">Aktivieren Sie aus dem GridView s-Smarttag die Kontrollkästchen Paging aktivieren, Sortierung aktivieren und Bearbeiten aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e1d46-225">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="e1d46-226">In Visual Studio wird die Eigenschaft ObjectDataSource s `OldValuesParameterFormatString` auf `original_{0}`festgelegt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-226">Visual Studio will set the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="e1d46-227">Damit die Funktion zum Bearbeiten von GridView-Funktionen ordnungsgemäß funktioniert, entfernen Sie diese Eigenschaft vollständig aus der deklarativen Syntax, oder legen Sie Sie auf den Standardwert zurück, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="e1d46-227">In order for the GridView s edit feature to work properly, either remove this property entirely from the declarative syntax or set it back to its default value, `{0}`.</span></span>

<span data-ttu-id="e1d46-228">Fügen Sie schließlich über der GridView ein Label-websteuer Element hinzu, und legen Sie dessen `ID`-Eigenschaft auf `ODSEvents` und dessen `EnableViewState`-Eigenschaft auf `false`fest.</span><span class="sxs-lookup"><span data-stu-id="e1d46-228">Finally, add a Label Web control above the GridView and set its `ID` property to `ODSEvents` and its `EnableViewState` property to `false`.</span></span> <span data-ttu-id="e1d46-229">Nachdem Sie diese Änderungen vorgenommen haben, sollte das deklarative Markup der Seite in etwa wie folgt aussehen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-229">After making these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="e1d46-230">Beachten Sie, dass ich einige ästhetische Anpassungen an den GridView-Feldern vorgenommen habe, die nicht erforderlich sind, um die SQL-Cache-Abhängigkeits Funktionalität zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-230">Note that I ve made a number of aesthetic customizations to the GridView fields that are not necessary to demonstrate the SQL cache dependency functionality.</span></span>

[!code-aspx[Main](using-sql-cache-dependencies-cs/samples/sample7.aspx)]

<span data-ttu-id="e1d46-231">Erstellen Sie als nächstes einen Ereignishandler für das Ereignis "ObjectDataSource s `Selecting`", und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="e1d46-231">Next, create an event handler for the ObjectDataSource s `Selecting` event and in it add the following code:</span></span>

[!code-csharp[Main](using-sql-cache-dependencies-cs/samples/sample8.cs)]

<span data-ttu-id="e1d46-232">Beachten Sie, dass das ObjectDataSource s-`Selecting` Ereignis nur beim Abrufen von Daten aus dem zugrunde liegenden-Objekt ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-232">Recall that the ObjectDataSource s `Selecting` event fires only when retrieving data from its underlying object.</span></span> <span data-ttu-id="e1d46-233">Wenn die ObjectDataSource auf die Daten aus dem eigenen Cache zugreift, wird dieses Ereignis nicht ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="e1d46-233">If the ObjectDataSource accesses the data from its own cache, this event is not fired.</span></span>

<span data-ttu-id="e1d46-234">Besuchen Sie diese Seite nun über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="e1d46-234">Now, visit this page through a browser.</span></span> <span data-ttu-id="e1d46-235">Da wir noch keine Zwischenspeicherung implementieren müssen, sollte die Seite jedes Mal, wenn Sie das Raster bearbeiten, Sortieren oder bearbeiten, den Text anzeigen. Wählen Sie dann Ereignis ausgelöst aus, wie in Abbildung 8 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-235">Since we ve yet to implement any caching, each time you page, sort, or edit the grid the page should display the text, �Selecting event fired, as Figure 8 shows.</span></span>

<span data-ttu-id="e1d46-236">[![das Ereignis zum Auswählen von ObjectDataSource s bei jedem Pager, bearbeiten oder Sortieren der GridView ausgelöst wird.](using-sql-cache-dependencies-cs/_static/image8.gif)](using-sql-cache-dependencies-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-236">[![The ObjectDataSource s Selecting Event Fires Each Time the GridView is Paged, Edited, or Sorted](using-sql-cache-dependencies-cs/_static/image8.gif)](using-sql-cache-dependencies-cs/_static/image9.png)</span></span>

<span data-ttu-id="e1d46-237">**Abbildung 8**: das Ereignis "ObjectDataSource s `Selecting`" wird jedes Mal ausgelöst, wenn die GridView per Pager, bearbeitet oder sortiert wird ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image10.png)).</span><span class="sxs-lookup"><span data-stu-id="e1d46-237">**Figure 8**: The ObjectDataSource s `Selecting` Event Fires Each Time the GridView is Paged, Edited, or Sorted ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image10.png))</span></span>

<span data-ttu-id="e1d46-238">Wie im Tutorial zwischen [Speichern von Daten mit dem ObjectDataSource](caching-data-with-the-objectdatasource-cs.md) -Tutorial gezeigt, wird durch das Festlegen der `EnableCaching`-Eigenschaft auf `true` bewirkt, dass ObjectDataSource seine Daten für die Dauer zwischenspeichert, die von der `CacheDuration`-Eigenschaft angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-238">As we saw in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-cs.md) tutorial, setting the `EnableCaching` property to `true` causes the ObjectDataSource to cache its data for the duration specified by its `CacheDuration` property.</span></span> <span data-ttu-id="e1d46-239">ObjectDataSource verfügt auch über eine [`SqlCacheDependency`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), die den zwischengespeicherten Daten mithilfe des folgenden Musters eine oder mehrere SQL-Cache Abhängigkeiten hinzufügt:</span><span class="sxs-lookup"><span data-stu-id="e1d46-239">The ObjectDataSource also has a [`SqlCacheDependency` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), which adds one or more SQL cache dependencies to the cached data using the pattern:</span></span>

[!code-css[Main](using-sql-cache-dependencies-cs/samples/sample9.css)]

<span data-ttu-id="e1d46-240">Dabei ist *DatabaseName* der Name der Datenbank, wie im `name`-Attribut des `<add>`-Elements in `Web.config`angegeben, und *TableName* ist der Name der Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="e1d46-240">Where *databaseName* is the name of the database as specified in the `name` attribute of the `<add>` element in `Web.config`, and *tableName* is the name of the database table.</span></span> <span data-ttu-id="e1d46-241">Um z. b. eine ObjectDataSource zu erstellen, die Daten unbegrenzt auf der Grundlage einer SQL-Cache Abhängigkeit von der Northwind s-`Products` Tabelle speichert, legen Sie die Eigenschaft ObjectDataSource s `EnableCaching` auf `true` und deren `SqlCacheDependency`-Eigenschaft auf northwinddb: Products fest.</span><span class="sxs-lookup"><span data-stu-id="e1d46-241">For example, to create an ObjectDataSource that caches data indefinitely based on a SQL cache dependency against the Northwind s `Products` table, set the ObjectDataSource s `EnableCaching` property to `true` and its `SqlCacheDependency` property to NorthwindDB:Products .</span></span>

> [!NOTE]
> <span data-ttu-id="e1d46-242">Sie können eine SQL-Cache Abhängigkeit *und* einen zeitbasierten Ablauf verwenden, indem Sie `EnableCaching` auf `true`festlegen, auf das Zeitintervall `CacheDuration` und `SqlCacheDependency` auf die Datenbank und den Tabellennamen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-242">You can use a SQL cache dependency *and* a time-based expiry by setting `EnableCaching` to `true`, `CacheDuration` to the time interval, and `SqlCacheDependency` to the database and table name(s).</span></span> <span data-ttu-id="e1d46-243">Die ObjectDataSource entfernt die Daten, wenn der zeitbasierte Ablauf erreicht wird, oder wenn das Abrufsystem feststellt, dass sich die zugrunde liegenden Datenbankdaten geändert haben, je nachdem, welcher Vorgang zuerst ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-243">The ObjectDataSource will evict its data when the time-based expiry is reached or when the polling system notes that the underlying database data has changed, whichever happens first.</span></span>

<span data-ttu-id="e1d46-244">Die GridView in `SqlCacheDependencies.aspx` zeigt Daten aus zwei Tabellen an, `Products` und `Categories` (das `CategoryName` Feld Product s wird über eine `JOIN` auf `Categories`abgerufen).</span><span class="sxs-lookup"><span data-stu-id="e1d46-244">The GridView in `SqlCacheDependencies.aspx` displays data from two tables - `Products` and `Categories` (the product s `CategoryName` field is retrieved via a `JOIN` on `Categories`).</span></span> <span data-ttu-id="e1d46-245">Daher möchten wir zwei SQL-Cache Abhängigkeiten angeben: northwinddb: Products; Northwinddb: Kategorien.</span><span class="sxs-lookup"><span data-stu-id="e1d46-245">Therefore, we want to specify two SQL cache dependencies: NorthwindDB:Products;NorthwindDB:Categories .</span></span>

<span data-ttu-id="e1d46-246">[![Konfigurieren von ObjectDataSource zur Unterstützung der Zwischenspeicherung mithilfe von SQL-Cache Abhängigkeiten von Produkten und Kategorien](using-sql-cache-dependencies-cs/_static/image9.gif)](using-sql-cache-dependencies-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-246">[![Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on Products and Categories](using-sql-cache-dependencies-cs/_static/image9.gif)](using-sql-cache-dependencies-cs/_static/image11.png)</span></span>

<span data-ttu-id="e1d46-247">**Abbildung 9**: Konfigurieren von ObjectDataSource zur Unterstützung der Zwischenspeicherung mithilfe von SQL-Cache Abhängigkeiten auf `Products` und `Categories` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-247">**Figure 9**: Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on `Products` and `Categories` ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image12.png))</span></span>

<span data-ttu-id="e1d46-248">Nach dem Konfigurieren von ObjectDataSource zur Unterstützung der Zwischenspeicherung überprüfen Sie die Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="e1d46-248">After configuring the ObjectDataSource to support caching, revisit the page through a browser.</span></span> <span data-ttu-id="e1d46-249">Der Text, der auswählt, sollte beim ersten Besuch der Seite angezeigt werden, sollte jedoch beim Paging, beim Sortieren oder beim Klicken auf die Schaltflächen "Bearbeiten" oder "Abbrechen" entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-249">Again, the text �Selecting event fired should appear on the first page visit, but should go away when paging, sorting, or clicking the Edit or Cancel buttons.</span></span> <span data-ttu-id="e1d46-250">Dies liegt daran, dass nach dem Laden der Daten in den ObjectDataSource s-Cache diese beibehalten werden, bis die `Products`-oder `Categories` Tabellen geändert werden oder die Daten über die GridView aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-250">This is because after the data is loaded into the ObjectDataSource s cache, it remains there until the `Products` or `Categories` tables are modified or the data is updated through the GridView.</span></span>

<span data-ttu-id="e1d46-251">Öffnen Sie nach dem Paging durch das Raster und dem Hinweis, dass der Text ausgelöste Ereignis Auslösung nicht mehr angezeigt wird. Öffnen Sie ein neues Browserfenster, und navigieren Sie im Abschnitt bearbeiten, einfügen und löschen (`~/EditInsertDelete/Basics.aspx`) zum Grundlagen-Tutorial.</span><span class="sxs-lookup"><span data-stu-id="e1d46-251">After paging through the grid and noting the lack of the �Selecting event fired text, open a new browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="e1d46-252">Aktualisieren Sie den Namen oder den Preis eines Produkts.</span><span class="sxs-lookup"><span data-stu-id="e1d46-252">Update the name or price of a product.</span></span> <span data-ttu-id="e1d46-253">Zeigen Sie dann in das erste Browserfenster eine andere Datenseite an, Sortieren Sie das Raster, oder klicken Sie auf die Schaltfläche zum Bearbeiten von Zeilen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-253">Then, from to the first browser window, view a different page of data, sort the grid, or click a row s Edit button.</span></span> <span data-ttu-id="e1d46-254">Diesmal sollte das ausgelöste Ereignis erneut angezeigt werden, da die zugrunde liegenden Datenbankdaten geändert wurden (siehe Abbildung 10).</span><span class="sxs-lookup"><span data-stu-id="e1d46-254">This time, the �Selecting event fired should reappear, as the underlying database data has been modified (see Figure 10).</span></span> <span data-ttu-id="e1d46-255">Wenn der Text nicht angezeigt wird, warten Sie einen Moment, und versuchen Sie es noch mal.</span><span class="sxs-lookup"><span data-stu-id="e1d46-255">If the text does not appear, wait a few moments and try again.</span></span> <span data-ttu-id="e1d46-256">Beachten Sie, dass der Abruf Dienst alle `pollTime` Millisekunden auf Änderungen an der `Products` Tabelle prüft. es gibt also eine Verzögerung zwischen dem Zeitpunkt, zu dem die zugrunde liegenden Daten aktualisiert werden, und dem Zeitpunkt, zu dem die zwischengespeicherten Daten entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-256">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>

<span data-ttu-id="e1d46-257">[![Ändern der Products-Tabelle werden die zwischengespeicherten Produktdaten entfernt.](using-sql-cache-dependencies-cs/_static/image10.gif)](using-sql-cache-dependencies-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-257">[![Modifying the Products Table Evicts the Cached Product Data](using-sql-cache-dependencies-cs/_static/image10.gif)](using-sql-cache-dependencies-cs/_static/image13.png)</span></span>

<span data-ttu-id="e1d46-258">**Abbildung 10**: Ändern der Products-Tabelle entfernt die zwischengespeicherten Produktdaten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-258">**Figure 10**: Modifying the Products Table Evicts the Cached Product Data ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image14.png))</span></span>

## <a name="step-6-programmatically-working-with-thesqlcachedependencyclass"></a><span data-ttu-id="e1d46-259">Schritt 6: Programm gesteuertes arbeiten mit der`SqlCacheDependency`-Klasse</span><span class="sxs-lookup"><span data-stu-id="e1d46-259">Step 6: Programmatically Working with the`SqlCacheDependency`Class</span></span>

<span data-ttu-id="e1d46-260">Im Tutorial zum zwischen [Speichern von Daten in der Architektur](caching-data-in-the-architecture-cs.md) wurden die Vorteile der Verwendung einer separaten Cache Schicht in der Architektur behandelt, anstatt das Zwischenspeichern eng mit der ObjectDataSource zu koppeln.</span><span class="sxs-lookup"><span data-stu-id="e1d46-260">The [Caching Data in the Architecture](caching-data-in-the-architecture-cs.md) tutorial looked at the benefits of using a separate Caching Layer in the architecture as opposed to tightly coupling the caching with the ObjectDataSource.</span></span> <span data-ttu-id="e1d46-261">In diesem Tutorial haben wir eine `ProductsCL` Klasse erstellt, um die programmgesteuerte Arbeit mit dem Daten Cache zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-261">In that tutorial we created a `ProductsCL` class to demonstrate programmatically working with the data cache.</span></span> <span data-ttu-id="e1d46-262">Verwenden Sie die `SqlCacheDependency`-Klasse, um SQL-Cache Abhängigkeiten in der zwischen Speicherungs Ebene zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-262">To utilize SQL cache dependencies in the Caching Layer, use the `SqlCacheDependency` class.</span></span>

<span data-ttu-id="e1d46-263">Beim Abrufsystem muss ein `SqlCacheDependency` Objekt einer bestimmten Datenbank und einem Tabellen Paar zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-263">With the polling system, a `SqlCacheDependency` object must be associated with a particular database and table pair.</span></span> <span data-ttu-id="e1d46-264">Der folgende Code erstellt z. b. ein `SqlCacheDependency` Objekt, das auf der Northwind-Datenbank s `Products` Tabelle basiert:</span><span class="sxs-lookup"><span data-stu-id="e1d46-264">The following code, for example, creates a `SqlCacheDependency` object based on the Northwind database s `Products` table:</span></span>

[!code-csharp[Main](using-sql-cache-dependencies-cs/samples/sample10.cs)]

<span data-ttu-id="e1d46-265">Die beiden Eingabeparameter für den `SqlCacheDependency` s-Konstruktor sind die Datenbank bzw. die Tabellennamen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-265">The two input parameters to the `SqlCacheDependency` s constructor are the database and table names, respectively.</span></span> <span data-ttu-id="e1d46-266">Wie bei der ObjectDataSource s `SqlCacheDependency`-Eigenschaft entspricht der verwendete Datenbankname dem Wert, der im `name`-Attribut des `<add>`-Elements in `Web.config`angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="e1d46-266">Like with the ObjectDataSource s `SqlCacheDependency` property, the database name used is the same as the value specified in the `name` attribute of the `<add>` element in `Web.config`.</span></span> <span data-ttu-id="e1d46-267">Der Tabellenname ist der tatsächliche Name der Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="e1d46-267">The table name is the actual name of the database table.</span></span>

<span data-ttu-id="e1d46-268">Um einem Element, das dem Daten Cache hinzugefügt wurde, eine `SqlCacheDependency` zuzuordnen, verwenden Sie eine der `Insert` Methoden Überladungen, die eine Abhängigkeit annehmen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-268">To associate a `SqlCacheDependency` with an item added to the data cache, use one of the `Insert` method overloads that accepts a dependency.</span></span> <span data-ttu-id="e1d46-269">Der folgende Code fügt dem Daten Cache für eine unbestimmte Dauer einen *Wert* hinzu, ordnet ihn jedoch einer `SqlCacheDependency` in der `Products` Tabelle zu.</span><span class="sxs-lookup"><span data-stu-id="e1d46-269">The following code adds *value* to the data cache for an indefinite duration, but associates it with a `SqlCacheDependency` on the `Products` table.</span></span> <span data-ttu-id="e1d46-270">Kurz gesagt verbleiben *Werte* im Cache, bis Sie aufgrund von Arbeitsspeicher Einschränkungen entfernt werden oder das Abrufsystem festgestellt hat, dass die `Products` Tabelle seit der Zwischenspeicherung geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="e1d46-270">In short, *value* will remain in the cache until it is evicted due to memory constraints or because the polling system has detected that the `Products` table has changed since it was cached.</span></span>

[!code-csharp[Main](using-sql-cache-dependencies-cs/samples/sample11.cs)]

<span data-ttu-id="e1d46-271">Die `ProductsCL` Klasse der zwischen Speicherungs Schicht speichert aktuell Daten aus der `Products` Tabelle mithilfe eines zeitbasierten Ablaufs von 60 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-271">The Caching Layer s `ProductsCL` class currently caches data from the `Products` table using a time-based expiry of 60 seconds.</span></span> <span data-ttu-id="e1d46-272">Aktualisieren Sie diese Klasse, sodass stattdessen SQL-Cache Abhängigkeiten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-272">Let s update this class so that it uses SQL cache dependencies instead.</span></span> <span data-ttu-id="e1d46-273">Die `ProductsCL` Class s `AddCacheItem`-Methode, die für das Hinzufügen der Daten zum Cache zuständig ist, enthält derzeit den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="e1d46-273">The `ProductsCL` class s `AddCacheItem` method, which is responsible for adding the data to the cache, currently contains the following code:</span></span>

[!code-csharp[Main](using-sql-cache-dependencies-cs/samples/sample12.cs)]

<span data-ttu-id="e1d46-274">Aktualisieren Sie diesen Code, sodass anstelle der `MasterCacheKeyArray` Cache Abhängigkeit ein `SqlCacheDependency` Objekt verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="e1d46-274">Update this code to use a `SqlCacheDependency` object instead of the `MasterCacheKeyArray` cache dependency:</span></span>

[!code-csharp[Main](using-sql-cache-dependencies-cs/samples/sample13.cs)]

<span data-ttu-id="e1d46-275">Um diese Funktionalität zu testen, fügen Sie der Seite unterhalb der vorhandenen `ProductsDeclarative` GridView eine GridView hinzu.</span><span class="sxs-lookup"><span data-stu-id="e1d46-275">To test this functionality, add a GridView to the page beneath the existing `ProductsDeclarative` GridView.</span></span> <span data-ttu-id="e1d46-276">Legen Sie die neue GridView s-`ID` auf `ProductsProgrammatic` fest, und binden Sie Sie über das Smarttag an eine neue ObjectDataSource mit dem Namen `ProductsDataSourceProgrammatic`.</span><span class="sxs-lookup"><span data-stu-id="e1d46-276">Set this new GridView s `ID` to `ProductsProgrammatic` and, through its smart tag, bind it to a new ObjectDataSource named `ProductsDataSourceProgrammatic`.</span></span> <span data-ttu-id="e1d46-277">Konfigurieren Sie ObjectDataSource für die Verwendung der `ProductsCL`-Klasse, und legen Sie die Dropdown Listen auf den Registerkarten auswählen und Aktualisieren auf `GetProducts` bzw. `UpdateProduct`fest.</span><span class="sxs-lookup"><span data-stu-id="e1d46-277">Configure the ObjectDataSource to use the `ProductsCL` class, setting the drop-down lists in the SELECT and UPDATE tabs to `GetProducts` and `UpdateProduct`, respectively.</span></span>

<span data-ttu-id="e1d46-278">[![Konfigurieren von ObjectDataSource für die Verwendung der productscl-Klasse](using-sql-cache-dependencies-cs/_static/image11.gif)](using-sql-cache-dependencies-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-278">[![Configure the ObjectDataSource to Use the ProductsCL Class](using-sql-cache-dependencies-cs/_static/image11.gif)](using-sql-cache-dependencies-cs/_static/image15.png)</span></span>

<span data-ttu-id="e1d46-279">**Abbildung 11**: Konfigurieren von ObjectDataSource für die Verwendung der `ProductsCL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-279">**Figure 11**: Configure the ObjectDataSource to Use the `ProductsCL` Class ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image16.png))</span></span>

<span data-ttu-id="e1d46-280">[![in der Dropdown Liste "Registerkarte auswählen" die Methode "GetProducts" auswählen](using-sql-cache-dependencies-cs/_static/image12.gif)](using-sql-cache-dependencies-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-280">[![Select the GetProducts Method from the SELECT Tab s Drop-Down List](using-sql-cache-dependencies-cs/_static/image12.gif)](using-sql-cache-dependencies-cs/_static/image17.png)</span></span>

<span data-ttu-id="e1d46-281">**Abbildung 12**: Auswählen der `GetProducts`-Methode aus der Dropdown Liste "Registerkarte auswählen" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-281">**Figure 12**: Select the `GetProducts` Method from the SELECT Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image18.png))</span></span>

<span data-ttu-id="e1d46-282">[![wählen Sie die UpdateProduct-Methode aus der Dropdown Liste der Registerkarte "Aktualisieren" aus.](using-sql-cache-dependencies-cs/_static/image13.gif)](using-sql-cache-dependencies-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e1d46-282">[![Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List](using-sql-cache-dependencies-cs/_static/image13.gif)](using-sql-cache-dependencies-cs/_static/image19.png)</span></span>

<span data-ttu-id="e1d46-283">**Abbildung 13**: Auswählen der UpdateProduct-Methode aus der Dropdown Liste der Registerkarte "Aktualisieren" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](using-sql-cache-dependencies-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="e1d46-283">**Figure 13**: Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-cs/_static/image20.png))</span></span>

<span data-ttu-id="e1d46-284">Nach dem Abschließen des Assistenten zum Konfigurieren von Datenquellen erstellt Visual Studio boundfields und checkboxfields in der GridView für jedes der Datenfelder.</span><span class="sxs-lookup"><span data-stu-id="e1d46-284">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="e1d46-285">Entfernen Sie wie bei der ersten GridView, die dieser Seite hinzugefügt wurde, alle Felder, jedoch `ProductName`, `CategoryName`und `UnitPrice`, und formatieren Sie diese Felder wie gewünscht.</span><span class="sxs-lookup"><span data-stu-id="e1d46-285">Like with the first GridView added to this page, remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="e1d46-286">Aktivieren Sie aus dem GridView s-Smarttag die Kontrollkästchen Paging aktivieren, Sortierung aktivieren und Bearbeiten aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e1d46-286">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="e1d46-287">Wie bei der `ProductsDataSourceDeclarative` ObjectDataSource legt Visual Studio die `ProductsDataSourceProgrammatic` ObjectDataSource-Eigenschaft `OldValuesParameterFormatString` auf `original_{0}`fest.</span><span class="sxs-lookup"><span data-stu-id="e1d46-287">As with the `ProductsDataSourceDeclarative` ObjectDataSource, Visual Studio will set the `ProductsDataSourceProgrammatic` ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="e1d46-288">Damit die Funktion zum Bearbeiten von GridView-Funktionen ordnungsgemäß funktioniert, legen Sie diese Eigenschaft auf `{0}` zurück (oder entfernen Sie die Eigenschafts Zuweisung aus der deklarativen Syntax vollständig).</span><span class="sxs-lookup"><span data-stu-id="e1d46-288">In order for the GridView s edit feature to work properly, set this property back to `{0}` (or remove the property assignment from the declarative syntax altogether).</span></span>

<span data-ttu-id="e1d46-289">Nachdem Sie diese Aufgaben abgeschlossen haben, sollten das resultierende GridView-und ObjectDataSource-Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="e1d46-289">After completing these tasks, the resulting GridView and ObjectDataSource declarative markup should look like the following:</span></span>

[!code-aspx[Main](using-sql-cache-dependencies-cs/samples/sample14.aspx)]

<span data-ttu-id="e1d46-290">Um die SQL-Cache Abhängigkeit in der zwischen Speicherungs Ebene zu testen, legen Sie einen Haltepunkt in der `ProductCL`-Klasse `AddCacheItem` Methode fest, und starten Sie das Debugging.</span><span class="sxs-lookup"><span data-stu-id="e1d46-290">To test the SQL cache dependency in the Caching Layer set a breakpoint in the `ProductCL` class s `AddCacheItem` method and then start debugging.</span></span> <span data-ttu-id="e1d46-291">Wenn Sie `SqlCacheDependencies.aspx`zum ersten Mal besuchen, sollte der Haltepunkt getroffen werden, wenn die Daten zum ersten Mal angefordert und im Cache abgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-291">When you first visit `SqlCacheDependencies.aspx`, the breakpoint should be hit as the data is requested for the first time and placed into the cache.</span></span> <span data-ttu-id="e1d46-292">Wechseln Sie als nächstes zu einer anderen Seite in der GridView, oder sortieren Sie eine der Spalten.</span><span class="sxs-lookup"><span data-stu-id="e1d46-292">Next, move to another page in the GridView or sort one of the columns.</span></span> <span data-ttu-id="e1d46-293">Dies bewirkt, dass die GridView Ihre Daten anweist, die Daten jedoch im Cache gefunden werden, da die `Products` Datenbanktabelle nicht geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="e1d46-293">This causes the GridView to requery its data, but the data should be found in the cache since the `Products` database table has not been modified.</span></span> <span data-ttu-id="e1d46-294">Wenn die Daten wiederholt nicht im Cache gefunden werden, stellen Sie sicher, dass genügend Arbeitsspeicher auf dem Computer verfügbar ist, und wiederholen Sie den Vorgang.</span><span class="sxs-lookup"><span data-stu-id="e1d46-294">If the data is repeatedly not found in the cache, make sure there is sufficient memory available on your computer and try again.</span></span>

<span data-ttu-id="e1d46-295">Öffnen Sie nach dem Paging durch einige Seiten der GridView ein zweites Browserfenster, und navigieren Sie im Abschnitt bearbeiten, einfügen und löschen (`~/EditInsertDelete/Basics.aspx`) zum Grundlagen-Tutorial.</span><span class="sxs-lookup"><span data-stu-id="e1d46-295">After paging through a few pages of the GridView, open a second browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="e1d46-296">Aktualisieren Sie einen Datensatz in der Tabelle Products, und zeigen Sie dann im ersten Browserfenster eine neue Seite an, oder klicken Sie auf einen der Sortier Header.</span><span class="sxs-lookup"><span data-stu-id="e1d46-296">Update a record from the Products table and then, from the first browser window, view a new page or click on one of the sorting headers.</span></span>

<span data-ttu-id="e1d46-297">In diesem Szenario wird eine der beiden folgenden Punkte angezeigt: entweder wird der Breakpoint gedrückt, und es wird angegeben, dass die zwischengespeicherten Daten aufgrund der Änderung in der Datenbank entfernt wurden. oder der Breakpoint wird nicht gedrückt, was bedeutet, dass `SqlCacheDependencies.aspx` jetzt veraltete Daten anzeigt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-297">In this scenario you will see one of two things: either the breakpoint will be hit, indicating that the cached data was evicted due to the change in the database; or, the breakpoint will not be hit, meaning that `SqlCacheDependencies.aspx` is now showing stale data.</span></span> <span data-ttu-id="e1d46-298">Wenn der Haltepunkt nicht gedrückt wird, liegt dies wahrscheinlich daran, dass der Abruf Dienst noch nicht ausgelöst wurde, da die Daten geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-298">If the breakpoint is not hit, it is likely because the polling service has not yet fired since the data was changed.</span></span> <span data-ttu-id="e1d46-299">Beachten Sie, dass der Abruf Dienst alle `pollTime` Millisekunden auf Änderungen an der `Products` Tabelle prüft. es gibt also eine Verzögerung zwischen dem Zeitpunkt, zu dem die zugrunde liegenden Daten aktualisiert werden, und dem Zeitpunkt, zu dem die zwischengespeicherten Daten entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-299">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>

> [!NOTE]
> <span data-ttu-id="e1d46-300">Diese Verzögerung wird eher angezeigt, wenn eines der Produkte über die GridView in `SqlCacheDependencies.aspx`bearbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-300">This delay is more likely to appear when editing one of the products through the GridView in `SqlCacheDependencies.aspx`.</span></span> <span data-ttu-id="e1d46-301">Im Tutorial zum zwischen [Speichern von Daten in der Architektur](caching-data-in-the-architecture-cs.md) haben wir die `MasterCacheKeyArray` Cache Abhängigkeit hinzugefügt, um sicherzustellen, dass die Daten, die über die `ProductsCL` Class s `UpdateProduct`-Methode bearbeitet wurden, aus dem Cache entfernt wurden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-301">In the [Caching Data in the Architecture](caching-data-in-the-architecture-cs.md) tutorial we added the `MasterCacheKeyArray` cache dependency to ensure that the data being edited through the `ProductsCL` class s `UpdateProduct` method was evicted from the cache.</span></span> <span data-ttu-id="e1d46-302">Wir haben diese Cache Abhängigkeit jedoch ersetzt, wenn wir die `AddCacheItem` Methode weiter oben in diesem Schritt geändert haben. Daher zeigt die `ProductsCL` Klasse die zwischengespeicherten Daten so lange an, bis das Abrufsystem die Änderung an der `Products` Tabelle notiert.</span><span class="sxs-lookup"><span data-stu-id="e1d46-302">However, we replaced this cache dependency when modifying the `AddCacheItem` method earlier in this step and therefore the `ProductsCL` class will continue to show the cached data until the polling system notes the change to the `Products` table.</span></span> <span data-ttu-id="e1d46-303">Wir sehen uns an, wie Sie die `MasterCacheKeyArray` Cache Abhängigkeit in Schritt 7 erneut einführen können.</span><span class="sxs-lookup"><span data-stu-id="e1d46-303">We'll see how to reintroduce the `MasterCacheKeyArray` cache dependency in Step 7.</span></span>

## <a name="step-7-associating-multiple-dependencies-with-a-cached-item"></a><span data-ttu-id="e1d46-304">Schritt 7: Zuordnen mehrerer Abhängigkeiten zu einem zwischengespeicherten Element</span><span class="sxs-lookup"><span data-stu-id="e1d46-304">Step 7: Associating Multiple Dependencies with a Cached Item</span></span>

<span data-ttu-id="e1d46-305">Beachten Sie, dass die `MasterCacheKeyArray` Cache Abhängigkeit verwendet wird, um sicherzustellen, dass *alle* produktbezogenen Daten aus dem Cache entfernt werden, wenn ein einzelnes Element, das in ihr verknüpft ist, aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-305">Recall that the `MasterCacheKeyArray` cache dependency is used to ensure that *all* product-related data is evicted from the cache when any single item associated within it is updated.</span></span> <span data-ttu-id="e1d46-306">Beispielsweise speichert die `GetProductsByCategoryID(categoryID)`-Methode `ProductsDataTables` Instanzen für jeden eindeutigen *CategoryID* -Wert zwischen.</span><span class="sxs-lookup"><span data-stu-id="e1d46-306">For example, the `GetProductsByCategoryID(categoryID)` method caches `ProductsDataTables` instances for each unique *categoryID* value.</span></span> <span data-ttu-id="e1d46-307">Wenn eines dieser Objekte entfernt wird, gewährleistet die `MasterCacheKeyArray` Cache Abhängigkeit, dass die anderen ebenfalls entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-307">If one of these objects is evicted, the `MasterCacheKeyArray` cache dependency ensures that the others are also removed.</span></span> <span data-ttu-id="e1d46-308">Ohne diese Cache Abhängigkeit ist es möglich, dass andere zwischengespeicherte Produktdaten veraltet sind, wenn die zwischengespeicherten Daten geändert werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-308">Without this cache dependency, when the cached data is modified the possibility exists that other cached product data may be out of date.</span></span> <span data-ttu-id="e1d46-309">Folglich ist es wichtig, dass die `MasterCacheKeyArray` Cache Abhängigkeit bei Verwendung von SQL-Cache Abhängigkeiten beibehalten wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-309">Consequently, it s important that we maintain the `MasterCacheKeyArray` cache dependency when using SQL cache dependencies.</span></span> <span data-ttu-id="e1d46-310">Die `Insert`-Methode des Daten Caches ermöglicht jedoch nur ein einzelnes Abhängigkeits Objekt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-310">However, the data cache s `Insert` method only allows for a single dependency object.</span></span>

<span data-ttu-id="e1d46-311">Außerdem müssen bei der Arbeit mit SQL-Cache Abhängigkeiten möglicherweise mehrere Datenbanktabellen als Abhängigkeiten verknüpft werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-311">Furthermore, when working with SQL cache dependencies we may need to associate multiple database tables as dependencies.</span></span> <span data-ttu-id="e1d46-312">Beispielsweise enthält die `ProductsDataTable`, die in der `ProductsCL`-Klasse zwischengespeichert ist, die Kategorien-und Lieferanten Namen für jedes Produkt, aber die `AddCacheItem`-Methode verwendet nur eine Abhängigkeit von `Products`.</span><span class="sxs-lookup"><span data-stu-id="e1d46-312">For example, the `ProductsDataTable` cached in the `ProductsCL` class contains the category and supplier names for each product, but the `AddCacheItem` method only uses a dependency on `Products`.</span></span> <span data-ttu-id="e1d46-313">Wenn der Benutzer den Namen einer Kategorie oder eines Lieferanten aktualisiert, verbleiben die zwischengespeicherten Produktdaten in dieser Situation im Cache und sind veraltet.</span><span class="sxs-lookup"><span data-stu-id="e1d46-313">In this situation, if the user updates the name of a category or supplier, the cached product data will remain in the cache and be out of date.</span></span> <span data-ttu-id="e1d46-314">Daher möchten wir, dass die zwischengespeicherten Produktdaten nicht nur von der `Products` Tabelle, sondern auch von den Tabellen `Categories` und `Suppliers` abhängig sind.</span><span class="sxs-lookup"><span data-stu-id="e1d46-314">Therefore, we want to make the cached product data dependent on not only the `Products` table, but on the `Categories` and `Suppliers` tables as well.</span></span>

<span data-ttu-id="e1d46-315">Die [`AggregateCacheDependency`-Klasse](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) bietet eine Möglichkeit zum Zuordnen mehrerer Abhängigkeiten zu einem Cache Element.</span><span class="sxs-lookup"><span data-stu-id="e1d46-315">The [`AggregateCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) provides a means for associating multiple dependencies with a cache item.</span></span> <span data-ttu-id="e1d46-316">Beginnen Sie mit dem Erstellen einer `AggregateCacheDependency`-Instanz.</span><span class="sxs-lookup"><span data-stu-id="e1d46-316">Start by creating an `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="e1d46-317">Fügen Sie als nächstes den Satz von Abhängigkeiten hinzu, indem Sie die `AggregateCacheDependency` s `Add`-Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-317">Next, add the set of dependencies using the `AggregateCacheDependency` s `Add` method.</span></span> <span data-ttu-id="e1d46-318">Wenn Sie das Element anschließend in den Daten Cache einfügen, übergeben Sie die `AggregateCacheDependency`-Instanz.</span><span class="sxs-lookup"><span data-stu-id="e1d46-318">When inserting the item into the data cache thereafter, pass in the `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="e1d46-319">Wenn sich *eine* der Abhängigkeiten der `AggregateCacheDependency` Instanz ändert, wird das zwischengespeicherte Element entfernt.</span><span class="sxs-lookup"><span data-stu-id="e1d46-319">When *any* of the `AggregateCacheDependency` instance s dependencies change, the cached item will be evicted.</span></span>

<span data-ttu-id="e1d46-320">Der folgende Code zeigt den aktualisierten Code für die `ProductsCL`-Klasse `AddCacheItem`-Methode.</span><span class="sxs-lookup"><span data-stu-id="e1d46-320">The following shows the updated code for the `ProductsCL` class s `AddCacheItem` method.</span></span> <span data-ttu-id="e1d46-321">Die-Methode erstellt die `MasterCacheKeyArray` Cache Abhängigkeit zusammen mit `SqlCacheDependency`-Objekten für die Tabellen `Products`, `Categories`und `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="e1d46-321">The method creates the `MasterCacheKeyArray` cache dependency along with `SqlCacheDependency` objects for the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="e1d46-322">Diese werden alle in einem `AggregateCacheDependency` Objekt mit dem Namen `aggregateDependencies`kombiniert, das dann an die `Insert`-Methode weitergegeben wird.</span><span class="sxs-lookup"><span data-stu-id="e1d46-322">These are all combined into one `AggregateCacheDependency` object named `aggregateDependencies`, which is then passed into the `Insert` method.</span></span>

[!code-csharp[Main](using-sql-cache-dependencies-cs/samples/sample15.cs)]

<span data-ttu-id="e1d46-323">Testen Sie diesen neuen Code. Änderungen an den Tabellen `Products`, `Categories`oder `Suppliers` bewirken nun, dass die zwischengespeicherten Daten entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-323">Test this new code out. Now changes to the `Products`, `Categories`, or `Suppliers` tables cause the cached data to be evicted.</span></span> <span data-ttu-id="e1d46-324">Außerdem wird die `MasterCacheKeyArray` Cache Abhängigkeit entfernt, wenn die `ProductsCL`-Klasse `UpdateProduct` Methode, die beim Bearbeiten eines Produkts über die GridView aufgerufen wird, die Cache Abhängigkeit entfernt, was bewirkt, dass die zwischengespeicherten `ProductsDataTable` entfernt werden und die Daten bei der nächsten Anforderung erneut abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-324">Moreover, the `ProductsCL` class s `UpdateProduct` method, which is called when editing a product through the GridView, evicts the `MasterCacheKeyArray` cache dependency, which causes the cached `ProductsDataTable` to be evicted and the data to be re-retrieved on the next request.</span></span>

> [!NOTE]
> <span data-ttu-id="e1d46-325">SQL-Cache Abhängigkeiten können auch mit der [Ausgabe](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx)Zwischenspeicherung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-325">SQL cache dependencies can also be used with [output caching](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span></span> <span data-ttu-id="e1d46-326">Eine Demonstration dieser Funktionalität finden Sie unter Verwenden von [ASP.net Output Caching with SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="e1d46-326">For a demonstration of this functionality, see: [Using ASP.NET Output Caching with SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="e1d46-327">Summary</span><span class="sxs-lookup"><span data-stu-id="e1d46-327">Summary</span></span>

<span data-ttu-id="e1d46-328">Beim Zwischenspeichern von Datenbankdaten verbleiben die Daten idealerweise im Cache, bis Sie in der Datenbank geändert werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-328">When caching database data, the data will ideally remain in the cache until it is modified in the database.</span></span> <span data-ttu-id="e1d46-329">Mit ASP.NET 2,0 können SQL-Cache Abhängigkeiten in deklarativen und programmgesteuerten Szenarien erstellt und verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-329">With ASP.NET 2.0, SQL cache dependencies can be created and used in both declarative and programmatic scenarios.</span></span> <span data-ttu-id="e1d46-330">Eine der Herausforderungen bei diesem Ansatz besteht darin, herauszufinden, wann die Daten geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-330">One of the challenges with this approach is in discovering when the data has been modified.</span></span> <span data-ttu-id="e1d46-331">Die vollständigen Versionen von Microsoft SQL Server 2005 bieten Benachrichtigungsfunktionen, die eine Anwendung Benachrichtigen können, wenn sich ein Abfrageergebnis geändert hat.</span><span class="sxs-lookup"><span data-stu-id="e1d46-331">The full versions of Microsoft SQL Server 2005 provide notification capabilities that can alert an application when a query result has changed.</span></span> <span data-ttu-id="e1d46-332">Für die Express Edition von SQL Server 2005 und älteren Versionen von SQL Server muss stattdessen ein Abrufsystem verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="e1d46-332">For the Express Edition of SQL Server 2005 and older versions of SQL Server, a polling system must be used instead.</span></span> <span data-ttu-id="e1d46-333">Glücklicherweise ist das Einrichten der erforderlichen Abruf Infrastruktur recht unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="e1d46-333">Fortunately, setting up the necessary polling infrastructure is fairly straightforward.</span></span>

<span data-ttu-id="e1d46-334">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="e1d46-334">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="e1d46-335">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="e1d46-335">Further Reading</span></span>

<span data-ttu-id="e1d46-336">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="e1d46-336">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e1d46-337">Verwenden von Abfrage Benachrichtigungen in Microsoft SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="e1d46-337">Using Query Notifications in Microsoft SQL Server 2005</span></span>](https://msdn.microsoft.com/library/ms175110.aspx)
- [<span data-ttu-id="e1d46-338">Erstellen einer Abfrage Benachrichtigung</span><span class="sxs-lookup"><span data-stu-id="e1d46-338">Creating a Query Notification</span></span>](https://msdn.microsoft.com/library/ms188669.aspx)
- <span data-ttu-id="e1d46-339">[Caching in ASP.net mit der `SqlCacheDependency`-Klasse](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="e1d46-339">[Caching in ASP.NET with the `SqlCacheDependency` Class](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span></span>
- <span data-ttu-id="e1d46-340">[ASP.NET SQL Server Registrierungs Tool (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="e1d46-340">[ASP.NET SQL Server Registration Tool (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span></span>
- [<span data-ttu-id="e1d46-341">Übersicht über `SqlCacheDependency`</span><span class="sxs-lookup"><span data-stu-id="e1d46-341">Overview of `SqlCacheDependency`</span></span>](http://www.aspnetresources.com/blog/sql_cache_depedency_overview.aspx)

## <a name="about-the-author"></a><span data-ttu-id="e1d46-342">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="e1d46-342">About the Author</span></span>

<span data-ttu-id="e1d46-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="e1d46-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e1d46-344">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="e1d46-344">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e1d46-345">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e1d46-345">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e1d46-346">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e1d46-346">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e1d46-347">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e1d46-347">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e1d46-348">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="e1d46-348">Special Thanks To</span></span>

<span data-ttu-id="e1d46-349">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="e1d46-349">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e1d46-350">Die führenden Reviewer für dieses Tutorial waren Marko Rangel, Teresa Murphy und Hilton giesreviewer.</span><span class="sxs-lookup"><span data-stu-id="e1d46-350">Lead reviewers for this tutorial were Marko Rangel, Teresa Murphy, and Hilton Giesenow.</span></span> <span data-ttu-id="e1d46-351">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="e1d46-351">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e1d46-352">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e1d46-352">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e1d46-353">[Zurück](caching-data-at-application-startup-cs.md)
> [Weiter](caching-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="e1d46-353">[Previous](caching-data-at-application-startup-cs.md)
[Next](caching-data-with-the-objectdatasource-vb.md)</span></span>
