---
uid: web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-vb
title: Verwenden von SQL-Cacheabhängigkeiten (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Die einfachste zwischenspeicherstrategie werden zwischengespeicherte Daten nach einer angegebenen Zeitspanne ablaufen können. Aber diese einfache Vorgehensweise bedeutet, dass die zwischengespeicherten Daten Maintai...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: bd347d93-4251-4532-801c-a36f2dfa7f96
msc.legacyurl: /web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-vb
msc.type: authoredcontent
ms.openlocfilehash: b1660c0d20b76d97ee00acf1080c3eca1f596be2
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/17/2019
ms.locfileid: "59412670"
---
# <a name="using-sql-cache-dependencies-vb"></a><span data-ttu-id="4f04d-104">Verwenden von SQL-Cacheabhängigkeiten (VB)</span><span class="sxs-lookup"><span data-stu-id="4f04d-104">Using SQL Cache Dependencies (VB)</span></span>

<span data-ttu-id="4f04d-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4f04d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4f04d-106">[Code herunterladen](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_VB.zip) oder [PDF-Datei herunterladen](using-sql-cache-dependencies-vb/_static/datatutorial61vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4f04d-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_VB.zip) or [Download PDF](using-sql-cache-dependencies-vb/_static/datatutorial61vb1.pdf)</span></span>

> <span data-ttu-id="4f04d-107">Die einfachste zwischenspeicherstrategie werden zwischengespeicherte Daten nach einer angegebenen Zeitspanne ablaufen können.</span><span class="sxs-lookup"><span data-stu-id="4f04d-107">The simplest caching strategy is to allow cached data to expire after a specified period of time.</span></span> <span data-ttu-id="4f04d-108">Dieser einfache Ansatz bedeutet jedoch, dass die zwischengespeicherten Daten verwaltet, mit der zugrunde liegenden Datenquelle, sodass sich die veraltete Daten zu lang oder aktuelle Daten, die zu früh abgelaufen ist.</span><span class="sxs-lookup"><span data-stu-id="4f04d-108">But this simple approach means that the cached data maintains no association with its underlying data source, resulting in stale data that is held too long or current data that is expired too soon.</span></span> <span data-ttu-id="4f04d-109">Ein besserer Ansatz ist die Verwendung die SqlCacheDependency-Klasse, damit Daten zwischengespeichert bleiben, bis die zugrunde liegenden Daten in der SQL-Datenbank geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-109">A better approach is to use the SqlCacheDependency class so that data remains cached until its underlying data has been modified in the SQL database.</span></span> <span data-ttu-id="4f04d-110">In diesem Tutorial erfahren Sie, wie.</span><span class="sxs-lookup"><span data-stu-id="4f04d-110">This tutorial shows you how.</span></span>


## <a name="introduction"></a><span data-ttu-id="4f04d-111">Einführung</span><span class="sxs-lookup"><span data-stu-id="4f04d-111">Introduction</span></span>

<span data-ttu-id="4f04d-112">Die Zwischenspeicherung Techniken untersucht, der [Zwischenspeichern von Daten mit dem ObjectDataSource-Steuerelement](caching-data-with-the-objectdatasource-vb.md) und [Zwischenspeichern von Daten in der Architektur](caching-data-in-the-architecture-vb.md) Tutorials verwendet eine zeitbasierte Ablauf So entfernen Sie die Daten aus dem Cache nach einem angegebenen Zeitraum.</span><span class="sxs-lookup"><span data-stu-id="4f04d-112">The caching techniques examined in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) and [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorials used a time-based expiry to evict the data from the cache after a specified period.</span></span> <span data-ttu-id="4f04d-113">Dieser Ansatz ist die einfachste Möglichkeit, die leistungsverbesserungen von Zwischenspeichern für Daten "begrenzte Veraltung" auszugleichen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-113">This approach is the simplest way to balance the performance gains of caching against data staleness.</span></span> <span data-ttu-id="4f04d-114">Durch Auswahl einer Zeit-Ablauf der *x* Sekunden, Seitenentwickler concedes genießen Sie die Leistungsvorteile des caching für nur *x* in Sekunden, aber können verlassen Sie sich, dass ihre Daten nie länger als maximal veraltet sein werden der *x* Sekunden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-114">By selecting a time expiry of *x* seconds, a page developer concedes to enjoy the performance benefits of caching for only *x* seconds, but can rest easy that her data will never be stale longer than a maximum of *x* seconds.</span></span> <span data-ttu-id="4f04d-115">Natürlich für statische Daten die *x* kann erweitert werden und die Lebensdauer der Webanwendung, wie in untersucht wurde die [Zwischenspeichern von Daten beim Anwendungsstart](caching-data-at-application-startup-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="4f04d-115">Of course, for static data, *x* can be extended to the lifetime of the web application, as was examined in the [Caching Data at Application Startup](caching-data-at-application-startup-vb.md) tutorial.</span></span>

<span data-ttu-id="4f04d-116">Beim Zwischenspeichern von Daten wird eine zeitbasierte Ablauf wird häufig für die einfache Verwendung ausgewählt, jedoch ist häufig eine unzureichende Lösung.</span><span class="sxs-lookup"><span data-stu-id="4f04d-116">When caching database data, a time-based expiry is often chosen for its ease of use but is frequently an inadequate solution.</span></span> <span data-ttu-id="4f04d-117">Im Idealfall würde Daten in der Datenbank zwischengespeicherte bleiben, bis die zugrunde liegenden Daten in der Datenbank geändert wurde; erst dann würde der Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-117">Ideally, the database data would remain cached until the underlying data has been modified in the database; only then would the cache be evicted.</span></span> <span data-ttu-id="4f04d-118">Dieser Ansatz maximiert die Leistungsvorteile des caching und die Dauer der veraltete Daten minimiert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-118">This approach maximizes the performance benefits of caching and minimizes the duration of stale data.</span></span> <span data-ttu-id="4f04d-119">Allerdings müssen um diese Vorteile gibt es einige System vorhanden sein, die bekannt sind, wenn die zugrunde liegenden Datenbankdaten geändert wurde, und die entsprechenden Werte aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-119">However, in order to enjoy these benefits there must be some system in place that knows when the underlying database data has been modified and evicts the corresponding items from the cache.</span></span> <span data-ttu-id="4f04d-120">Vor ASP.NET 2.0 waren Seitenentwickler, die für die Implementierung dieses Systems verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="4f04d-120">Prior to ASP.NET 2.0, page developers were responsible for implementing this system.</span></span>

<span data-ttu-id="4f04d-121">ASP.NET 2.0 bietet eine [ `SqlCacheDependency` Klasse](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) und entfernt, die notwendige Infrastruktur, um zu bestimmen, wenn eine Änderung in der Datenbank aufgetreten ist, damit die entsprechenden Elemente zwischengespeichert werden kann.</span><span class="sxs-lookup"><span data-stu-id="4f04d-121">ASP.NET 2.0 provides a [`SqlCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) and the necessary infrastructure to determine when a change has occurred in the database so that the corresponding cached items can be evicted.</span></span> <span data-ttu-id="4f04d-122">Es gibt zwei Verfahren, um zu bestimmen, wenn die zugrunde liegenden Daten geändert haben: Benachrichtigung und abrufen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-122">There are two techniques for determining when the underlying data has changed: notification and polling.</span></span> <span data-ttu-id="4f04d-123">Nach der Erläuterung der Unterschiede zwischen Benachrichtigung und abrufen, erstellen wir die Infrastruktur zum Abruf zu unterstützen, und klicken Sie dann die Informationen zur Verwendung der `SqlCacheDependency` Klasse in deklarativen und die programmgesteuerte Szenarien.</span><span class="sxs-lookup"><span data-stu-id="4f04d-123">After discussing the differences between notification and polling, we'll create the infrastructure necessary to support polling and then explore how to use the `SqlCacheDependency` class in declarative and programmatically scenarios.</span></span>

## <a name="understanding-notification-and-polling"></a><span data-ttu-id="4f04d-124">Grundlegendes zur Benachrichtigung und Abrufen</span><span class="sxs-lookup"><span data-stu-id="4f04d-124">Understanding Notification and Polling</span></span>

<span data-ttu-id="4f04d-125">Es gibt zwei Techniken, die verwendet werden können, um zu bestimmen, wann die Daten in einer Datenbank geändert wurde: Benachrichtigung und abrufen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-125">There are two techniques that can be used to determine when the data in a database has been modified: notification and polling.</span></span> <span data-ttu-id="4f04d-126">Benachrichtigung die Datenbank wird automatisch die ASP.NET-Laufzeit benachrichtigt, wenn die Ergebnisse einer bestimmten Abfrage geändert wurden, seit der letzten der Abfrage Ausführung aus, an diesem Punkt werden die zwischengespeicherten Elemente, die der Abfrage zugeordnet werden entfernt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-126">With notification, the database automatically alerts the ASP.NET runtime when the results of a particular query have been changed since the query was last executed, at which point the cached items associated with the query are evicted.</span></span> <span data-ttu-id="4f04d-127">Mit der Abruf behält die Datenbank-Server Informationen, wenn bestimmte Tabellen zuletzt aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-127">With polling, the database server maintains information about when particular tables have last been updated.</span></span> <span data-ttu-id="4f04d-128">Die ASP.NET-Laufzeit ruft regelmäßig die Datenbank aus, um zu überprüfen, welche Tabellen geändert haben, da sie in den Cache eingegeben wurden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-128">The ASP.NET runtime periodically polls the database to check what tables have changed since they were entered into the cache.</span></span> <span data-ttu-id="4f04d-129">Diese Tabellen, deren Daten geändert wurden, haben, ihre zugehörigen Cache-Elemente, die entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="4f04d-129">Those tables whose data has been modified have their associated cache items evicted.</span></span>

<span data-ttu-id="4f04d-130">Die Benachrichtigungsoption erfordert weniger Einrichtung als abrufen und eine feiner abgestimmte ist, da es sich um die Änderungen nicht auf Tabellenebene, sondern auch auf Abfrageebene verfolgt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-130">The notification option requires less setup than polling and is more granular since it tracks changes at the query level rather than at the table level.</span></span> <span data-ttu-id="4f04d-131">Leider sind Benachrichtigungen nur in den vollständigen Editionen von Microsoft SQL Server 2005 (d. h., der nicht-Express-Editionen) zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="4f04d-131">Unfortunately, notifications are only available in the full editions of Microsoft SQL Server 2005 (i.e., the non-Express editions).</span></span> <span data-ttu-id="4f04d-132">Allerdings kann die Abrufoption für alle Versionen von Microsoft SQL Server von 7.0 auf 2005 verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-132">However, the polling option can be used for all versions of Microsoft SQL Server from 7.0 to 2005.</span></span> <span data-ttu-id="4f04d-133">Da diese Tutorials die Express-Edition von SQL Server 2005 verwenden, konzentrieren wir uns auf das Einrichten und verwenden die Abrufoption.</span><span class="sxs-lookup"><span data-stu-id="4f04d-133">Since these tutorials use the Express edition of SQL Server 2005, we will focus on setting up and using the polling option.</span></span> <span data-ttu-id="4f04d-134">Prüfen Sie im Abschnitt weiter lesen am Ende dieses Tutorials Weitere Ressourcen für SQL Server 2005-s-Benachrichtigungsfunktionen aus.</span><span class="sxs-lookup"><span data-stu-id="4f04d-134">Consult the Further Reading section at the end of this tutorial for further resources on SQL Server 2005 s notification capabilities.</span></span>

<span data-ttu-id="4f04d-135">Mit abrufen, die Datenbank konfiguriert werden muss, um eine Tabelle mit dem Namen einzuschließen `AspNet_SqlCacheTablesForChangeNotification` Listenfeldsteuerelement mit drei Spalten - `tableName`, `notificationCreated`, und `changeId`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-135">With polling, the database must be configured to include a table named `AspNet_SqlCacheTablesForChangeNotification` that has three columns - `tableName`, `notificationCreated`, and `changeId`.</span></span> <span data-ttu-id="4f04d-136">Diese Tabelle enthält eine Zeile für jede Tabelle, die Daten enthält, die möglicherweise in einer SQL-Cacheabhängigkeit in der Webanwendung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-136">This table contains a row for each table that has data that might need to be used in a SQL cache dependency in the web application.</span></span> <span data-ttu-id="4f04d-137">Die `tableName` Spalte gibt den Namen der Tabelle beim `notificationCreated` gibt an, das Datum und Uhrzeit, die die Zeile der Tabelle hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-137">The `tableName` column specifies the name of the table while `notificationCreated` indicates the date and time the row was added to the table.</span></span> <span data-ttu-id="4f04d-138">Die `changeId` Spalte ist vom Typ `int` und einen Anfangswert von 0 hat.</span><span class="sxs-lookup"><span data-stu-id="4f04d-138">The `changeId` column is of type `int` and has an initial value of 0.</span></span> <span data-ttu-id="4f04d-139">Der Wert wird mit jeder Änderung an der Tabelle erhöht.</span><span class="sxs-lookup"><span data-stu-id="4f04d-139">Its value is incremented with each modification to the table.</span></span>

<span data-ttu-id="4f04d-140">Zusätzlich zu den `AspNet_SqlCacheTablesForChangeNotification` Tabelle muss die Datenbank auch Trigger für jede der Tabellen, die angezeigt werden, möglicherweise in einer SQL-Cacheabhängigkeit einschließen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-140">In addition to the `AspNet_SqlCacheTablesForChangeNotification` table, the database also needs to include triggers on each of the tables that may appear in a SQL cache dependency.</span></span> <span data-ttu-id="4f04d-141">Diese Trigger werden ausgeführt, wenn eine Zeile eingefügt, aktualisiert oder gelöscht wird, und erhöhen Sie die Tabelle s `changeId` Wert `AspNet_SqlCacheTablesForChangeNotification`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-141">These triggers are executed whenever a row is inserted, updated, or deleted and increment the table s `changeId` value in `AspNet_SqlCacheTablesForChangeNotification`.</span></span>

<span data-ttu-id="4f04d-142">Die ASP.NET-Laufzeit verfolgt die aktuelle `changeId` für eine Tabelle, die beim Zwischenspeichern von Daten mithilfe einer `SqlCacheDependency` Objekt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-142">The ASP.NET runtime tracks the current `changeId` for a table when caching data using a `SqlCacheDependency` object.</span></span> <span data-ttu-id="4f04d-143">Die Datenbank in regelmäßigen Abständen aktiviert ist und ein beliebiger `SqlCacheDependency` Objekte, deren `changeId` unterscheidet sich von dem Wert in der Datenbank entfernt werden, da eine abweichende `changeId` Wert gibt an, es wurde eine Änderung an der Tabelle, da die Daten zwischengespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-143">The database is periodically checked and any `SqlCacheDependency` objects whose `changeId` differs from the value in the database are evicted since a differing `changeId` value indicates that there has been a change to the table since the data was cached.</span></span>

## <a name="step-1-exploring-theaspnetregsqlexecommand-line-program"></a><span data-ttu-id="4f04d-144">Schritt 1: Untersuchen der`aspnet_regsql.exe`Befehlszeilenprogramm</span><span class="sxs-lookup"><span data-stu-id="4f04d-144">Step 1: Exploring the`aspnet_regsql.exe`Command Line Program</span></span>

<span data-ttu-id="4f04d-145">Die Datenbank muss mit dem Abruf Ansatz Setup, um die Infrastruktur, die oben beschriebenen enthalten sein: einer vordefinierten-Tabelle (`AspNet_SqlCacheTablesForChangeNotification`), eine Reihe von gespeicherten Prozeduren und Trigger für jede der Tabellen, die in SQL-cacheabhängigkeiten im Web verwendet werden können die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4f04d-145">With the polling approach the database must be setup to contain the infrastructure described above: a predefined table (`AspNet_SqlCacheTablesForChangeNotification`), a handful of stored procedures, and triggers on each of the tables that may be used in SQL cache dependencies in the web application.</span></span> <span data-ttu-id="4f04d-146">Diese Tabellen, gespeicherten Prozeduren und Trigger können über das Programm über die Befehlszeile erstellt werden `aspnet_regsql.exe`, befindet sich der `$WINDOWS$\Microsoft.NET\Framework\version` Ordner.</span><span class="sxs-lookup"><span data-stu-id="4f04d-146">These tables, stored procedures, and triggers can be created through the command line program `aspnet_regsql.exe`, which is found in the `$WINDOWS$\Microsoft.NET\Framework\version` folder.</span></span> <span data-ttu-id="4f04d-147">Zum Erstellen der `AspNet_SqlCacheTablesForChangeNotification` Tabelle und der zugehörigen gespeicherten Prozeduren, führen Sie den folgenden von der Befehlszeile aus:</span><span class="sxs-lookup"><span data-stu-id="4f04d-147">To create the `AspNet_SqlCacheTablesForChangeNotification` table and associated stored procedures, run the following from the command line:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="4f04d-148">Um diese Befehle auszuführen, der angegebenen Datenbank-Anmeldename in muss, der [ `db_securityadmin` ](https://msdn.microsoft.com/library/ms188685.aspx) und [ `db_ddladmin` ](https://msdn.microsoft.com/library/ms190667.aspx) Rollen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-148">To execute these commands the specified database login must be in the [`db_securityadmin`](https://msdn.microsoft.com/library/ms188685.aspx) and [`db_ddladmin`](https://msdn.microsoft.com/library/ms190667.aspx) roles.</span></span> <span data-ttu-id="4f04d-149">Untersuchen Sie das T-SQL-gesendet, um die Datenbank, indem die `aspnet_regsql.exe` Befehl Zeile Programm, beziehen sich auf [in diesem Blogeintrag](http://scottonwriting.net/sowblog/posts/10709.aspx).</span><span class="sxs-lookup"><span data-stu-id="4f04d-149">To examine the T-SQL sent to the database by the `aspnet_regsql.exe` command line program, refer to [this blog entry](http://scottonwriting.net/sowblog/posts/10709.aspx).</span></span>


<span data-ttu-id="4f04d-150">Beispielsweise fügen die Infrastruktur für den Abruf mit einer Microsoft SQL Server-Datenbank mit dem Namen `pubs` auf einem Datenbankserver mit dem Namen `ScottsServer` mithilfe der Windows-Authentifizierung, navigieren Sie in das entsprechende Verzeichnis und, über die Befehlszeile eingeben:</span><span class="sxs-lookup"><span data-stu-id="4f04d-150">For example, to add the infrastructure for polling to a Microsoft SQL Server database named `pubs` on a database server named `ScottsServer` using Windows Authentication, navigate to the appropriate directory and, from the command line, enter:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample2.cmd)]

<span data-ttu-id="4f04d-151">Nachdem die Datenbankebene-Infrastruktur hinzugefügt wurde, müssen wir den Trigger auf diese Tabellen hinzufügen, die in SQL-cacheabhängigkeiten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-151">After the database-level infrastructure has been added, we need to add the triggers to those tables that will be used in SQL cache dependencies.</span></span> <span data-ttu-id="4f04d-152">Verwenden der `aspnet_regsql.exe` über die Befehlszeile erneut programmieren, aber geben Sie den Tabellennamen mit der `-t` wechseln und anstatt der `-ed` wechseln verwenden `-et`, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="4f04d-152">Use the `aspnet_regsql.exe` command line program again, but specify the table name using the `-t` switch and instead of using the `-ed` switch use `-et`, like so:</span></span>


[!code-html[Main](using-sql-cache-dependencies-vb/samples/sample3.html)]

<span data-ttu-id="4f04d-153">Die Trigger Hinzufügen der `authors` und `titles` Tabellen auf die `pubs` Datenbank auf `ScottsServer`, verwenden Sie:</span><span class="sxs-lookup"><span data-stu-id="4f04d-153">To add the triggers to the `authors` and `titles` tables on the `pubs` database on `ScottsServer`, use:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample4.cmd)]

<span data-ttu-id="4f04d-154">In diesem Tutorial fügen Sie die Trigger die `Products`, `Categories`, und `Suppliers` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-154">For this tutorial add the triggers to the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="4f04d-155">Wir werden die bestimmten Befehlszeilensyntax in Schritt 3 betrachten.</span><span class="sxs-lookup"><span data-stu-id="4f04d-155">We'll look at the particular command line syntax in Step 3.</span></span>

## <a name="step-2-referencing-a-microsoft-sql-server-2005-express-edition-database-inappdata"></a><span data-ttu-id="4f04d-156">Schritt 2: Verweisen auf in einer Microsoft SQL Server 2005 Express Edition-Datenbank`App_Data`</span><span class="sxs-lookup"><span data-stu-id="4f04d-156">Step 2: Referencing a Microsoft SQL Server 2005 Express Edition Database in`App_Data`</span></span>

<span data-ttu-id="4f04d-157">Die `aspnet_regsql.exe` Befehlszeilenprogramm erforderlich, dass die Datenbank- und Servername, fügen die erforderlichen Abruf-Infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="4f04d-157">The `aspnet_regsql.exe` command line program requires the database and server name in order to add the necessary polling infrastructure.</span></span> <span data-ttu-id="4f04d-158">Aber was die Datenbank- und Servername, für eine Microsoft SQL Server 2005 Express-Datenbank ist, die in befinden die `App_Data` Ordner?</span><span class="sxs-lookup"><span data-stu-id="4f04d-158">But what is the database and server name for a Microsoft SQL Server 2005 Express database that resides in the `App_Data` folder?</span></span> <span data-ttu-id="4f04d-159">Anstatt zu ermitteln, was die Datenbank und Server-Namen sind, ich Ve gefunden wird, dass der einfachste Ansatz zum Anfügen der Datenbank, ist die `localhost\SQLExpress` Instanz der Datenbank, und benennen Sie die Daten mithilfe [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span><span class="sxs-lookup"><span data-stu-id="4f04d-159">Rather than having to discover what the database and server names are, I ve found that the simplest approach is to attach the database to the `localhost\SQLExpress` database instance and rename the data using [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span></span> <span data-ttu-id="4f04d-160">Wenn Sie eine Vollversion von SQL Server 2005 auf Ihrem Computer installiert haben, müssen Sie wahrscheinlich bereits SQL Server Management Studio auf Ihrem Computer installiert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-160">If you have one of the full versions of SQL Server 2005 installed on your machine, then you likely already have SQL Server Management Studio installed on your computer.</span></span> <span data-ttu-id="4f04d-161">Wenn Sie nur die Express Edition haben, können Sie die kostenlose Herunterladen [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span><span class="sxs-lookup"><span data-stu-id="4f04d-161">If you only have the Express edition, you can download the free [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span></span>

<span data-ttu-id="4f04d-162">Schließen Sie Visual Studio starten.</span><span class="sxs-lookup"><span data-stu-id="4f04d-162">Start by closing Visual Studio.</span></span> <span data-ttu-id="4f04d-163">Öffnen Sie SQL Server Management Studio, und wählen Sie zum Herstellen einer Verbindung mit der `localhost\SQLExpress` Server mithilfe der Windows-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="4f04d-163">Next, open SQL Server Management Studio and choose to connect to the `localhost\SQLExpress` server using Windows Authentication.</span></span>


![Fügen Sie an den Server Localhost\SQLExpress an](using-sql-cache-dependencies-vb/_static/image1.gif)

<span data-ttu-id="4f04d-165">**Abbildung 1**: Fügen Sie an der `localhost\SQLExpress` Server</span><span class="sxs-lookup"><span data-stu-id="4f04d-165">**Figure 1**: Attach to the `localhost\SQLExpress` Server</span></span>


<span data-ttu-id="4f04d-166">Nach dem Herstellen einer Verbindung mit dem Server, Management Studio zeigt den Server und Unterordner für die Datenbanken, Sicherheit und So weiter.</span><span class="sxs-lookup"><span data-stu-id="4f04d-166">After connecting to the server, Management Studio will show the server and have subfolders for the databases, security, and so forth.</span></span> <span data-ttu-id="4f04d-167">Mit der rechten Maustaste auf den Ordner "Datenbanken", und wählen Sie die Attach-Option.</span><span class="sxs-lookup"><span data-stu-id="4f04d-167">Right-click on the Databases folder and choose the Attach option.</span></span> <span data-ttu-id="4f04d-168">Hierdurch wird das Dialogfeld "Datenbanken anfügen" (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="4f04d-168">This will bring up the Attach Databases dialog box (see Figure 2).</span></span> <span data-ttu-id="4f04d-169">Klicken Sie auf die Schaltfläche "hinzufügen", und wählen Sie die `NORTHWND.MDF` Datenbankordner in Ihrem Web-Anwendung s. `App_Data` Ordner.</span><span class="sxs-lookup"><span data-stu-id="4f04d-169">Click the Add button and select the `NORTHWND.MDF` database folder in your web application s `App_Data` folder.</span></span>


<span data-ttu-id="4f04d-170">[![Fügen Sie die NORTHWND an. MDF-Datenbank aus dem Ordner "App_Data"](using-sql-cache-dependencies-vb/_static/image2.gif)](using-sql-cache-dependencies-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-170">[![Attach the NORTHWND.MDF Database from the App_Data Folder](using-sql-cache-dependencies-vb/_static/image2.gif)](using-sql-cache-dependencies-vb/_static/image1.png)</span></span>

<span data-ttu-id="4f04d-171">**Abbildung 2**: Fügen Sie der `NORTHWND.MDF` -Datenbank von der `App_Data` Ordner ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-171">**Figure 2**: Attach the `NORTHWND.MDF` Database from the `App_Data` Folder ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image2.png))</span></span>


<span data-ttu-id="4f04d-172">Dadurch wird die Datenbank auf den Ordner "Datenbanken" hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-172">This will add the database to the Databases folder.</span></span> <span data-ttu-id="4f04d-173">Der Name der Datenbank ist möglicherweise den vollständigen Pfad zur Datei oder der vollständige Pfad mit vorangestelltem eine [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span><span class="sxs-lookup"><span data-stu-id="4f04d-173">The database name might be the full path to the database file or the full path prepended with a [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span></span> <span data-ttu-id="4f04d-174">Zu vermeiden, geben Sie in diesen lange Datenbanknamen Verwendung das Aspnet\_regsql.exe-Befehlszeilentool, benennen Sie die Datenbank in einen mehr Benutzerfreundlicher Namen mit der rechten Maustaste auf die Datenbank gerade angefügt und Auswahl umbenennen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-174">To avoid having to type in this lengthy database name when using the aspnet\_regsql.exe command line tool, rename the database to a more human-friendly name by right-clicking on database just attached and choosing Rename.</span></span> <span data-ttu-id="4f04d-175">Ich Ve DataTutorials Meine Datenbank umbenannt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-175">I ve renamed my database to DataTutorials .</span></span>


![Benennen Sie die angefügte Datenbank in einer mehr Benutzerfreundlicher Namen](using-sql-cache-dependencies-vb/_static/image3.gif)

<span data-ttu-id="4f04d-177">**Abbildung 3**: Benennen Sie die angefügte Datenbank in einer mehr Benutzerfreundlicher Namen</span><span class="sxs-lookup"><span data-stu-id="4f04d-177">**Figure 3**: Rename the Attached Database to a More Human-Friendly Name</span></span>


## <a name="step-3-adding-the-polling-infrastructure-to-the-northwind-database"></a><span data-ttu-id="4f04d-178">Schritt 3: Die Abruf-Infrastruktur hinzufügen zur Northwind-Datenbank</span><span class="sxs-lookup"><span data-stu-id="4f04d-178">Step 3: Adding the Polling Infrastructure to the Northwind Database</span></span>

<span data-ttu-id="4f04d-179">Nun, wir angefügt haben die `NORTHWND.MDF` -Datenbank von der `App_Data` Ordner wir erneut kann jetzt die Abruf-Infrastruktur hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-179">Now that we have attached the `NORTHWND.MDF` database from the `App_Data` folder, we re ready to add the polling infrastructure.</span></span> <span data-ttu-id="4f04d-180">Angenommen, Sie haben die Datenbank zu DataTutorials umbenannt werden, führen Sie die folgenden vier Befehle aus:</span><span class="sxs-lookup"><span data-stu-id="4f04d-180">Assuming that you ve renamed the database to DataTutorials, run the following four commands:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample5.cmd)]

<span data-ttu-id="4f04d-181">Klicken Sie nach dem Ausführen dieser vier Befehle, mit der rechten Maustaste auf den Datenbanknamen in Management Studio, wechseln Sie zu dem Untermenü Tasks, und wählen Sie trennen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-181">After running these four commands, right-click on the database name in Management Studio, go to the Tasks submenu, and choose Detach.</span></span> <span data-ttu-id="4f04d-182">Klicken Sie dann schließen Sie Management Studio, und öffnen Sie Visual Studio erneut.</span><span class="sxs-lookup"><span data-stu-id="4f04d-182">Then close Management Studio and reopen Visual Studio.</span></span>

<span data-ttu-id="4f04d-183">Sobald Visual Studio erneut geöffnet wurde, einen Drilldown in die Datenbank über den Server-Explorer.</span><span class="sxs-lookup"><span data-stu-id="4f04d-183">Once Visual Studio has reopened, drill into the database through the Server Explorer.</span></span> <span data-ttu-id="4f04d-184">Beachten Sie die neue Tabelle (`AspNet_SqlCacheTablesForChangeNotification`), die neue gespeicherte Prozeduren und Trigger auf die `Products`, `Categories`, und `Suppliers` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-184">Note the new table (`AspNet_SqlCacheTablesForChangeNotification`), the new stored procedures, and the triggers on the `Products`, `Categories`, and `Suppliers` tables.</span></span>


![Die Datenbank enthält jetzt die erforderlichen Abruf-Infrastruktur](using-sql-cache-dependencies-vb/_static/image4.gif)

<span data-ttu-id="4f04d-186">**Abbildung 4**: Die Datenbank enthält jetzt die erforderlichen Abruf-Infrastruktur</span><span class="sxs-lookup"><span data-stu-id="4f04d-186">**Figure 4**: The Database Now Includes the Necessary Polling Infrastructure</span></span>


## <a name="step-4-configuring-the-polling-service"></a><span data-ttu-id="4f04d-187">Schritt 4: Konfigurieren des Diensts abrufen</span><span class="sxs-lookup"><span data-stu-id="4f04d-187">Step 4: Configuring the Polling Service</span></span>

<span data-ttu-id="4f04d-188">Nach dem Erstellen der erforderlichen Tabellen, Trigger und gespeicherte Prozeduren in der Datenbank an, der der letzte Schritt ist so konfigurieren Sie den Dienst abrufen, das erfolgt über `Web.config` durch Angeben der Datenbanken verwenden und das Abrufintervall in Millisekunden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-188">After creating the needed tables, triggers, and stored procedures in the database, the final step is to configure the polling service, which is done through `Web.config` by specifying the databases to use and the polling frequency in milliseconds.</span></span> <span data-ttu-id="4f04d-189">Das folgende Markup fragt den Northwind-Datenbank einmal pro Sekunde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-189">The following markup polls the Northwind database once every second.</span></span>


[!code-xml[Main](using-sql-cache-dependencies-vb/samples/sample6.xml)]

<span data-ttu-id="4f04d-190">Die `name` Wert in der `<add>` Element (NorthwindDB) ordnet einen lesbaren Namen mit einer bestimmten Datenbank.</span><span class="sxs-lookup"><span data-stu-id="4f04d-190">The `name` value in the `<add>` element ( NorthwindDB ) associates a human-readable name with a particular database.</span></span> <span data-ttu-id="4f04d-191">Bei der Arbeit mit SQL-cacheabhängigkeiten müssen wir verweisen auf den Namen der hier definierten sowie die Tabelle, der die zwischengespeicherten Daten basiert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-191">When working with SQL cache dependencies, we'll need to refer to the database name defined here as well as the table that the cached data is based on.</span></span> <span data-ttu-id="4f04d-192">Wir sehen, wie Sie mit der `SqlCacheDependency` Klasse Programmgesteuertes Verbinden von SQL-cacheabhängigkeiten mit zwischengespeicherten Daten in Schritt 6.</span><span class="sxs-lookup"><span data-stu-id="4f04d-192">We'll see how to use the `SqlCacheDependency` class to programmatically associate SQL cache dependencies with cached data in Step 6.</span></span>

<span data-ttu-id="4f04d-193">Nach eine SQL-Cacheabhängigkeit eingerichtet wurde, den Abruf-System eine Verbindung mit der Datenbanken, die definiert, der `<databases>` Elemente jeder `pollTime` Millisekunden und führen Sie die `AspNet_SqlCachePollingStoredProcedure` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="4f04d-193">Once a SQL cache dependency has been established, the polling system will connect to the databases defined in the `<databases>` elements every `pollTime` milliseconds and execute the `AspNet_SqlCachePollingStoredProcedure` stored procedure.</span></span> <span data-ttu-id="4f04d-194">Diese gespeicherte Prozedur - hinzugefügten zurück, in Schritt 3: Verwenden der `aspnet_regsql.exe` Befehlszeilentool - gibt die `tableName` und `changeId` Werte für jeden Datensatz in `AspNet_SqlCacheTablesForChangeNotification`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-194">This stored procedure - which was added back in Step 3 using the `aspnet_regsql.exe` command line tool - returns the `tableName` and `changeId` values for each record in `AspNet_SqlCacheTablesForChangeNotification`.</span></span> <span data-ttu-id="4f04d-195">Veraltete SQL-cacheabhängigkeiten, die aus dem Cache entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-195">Outdated SQL cache dependencies are evicted from the cache.</span></span>

<span data-ttu-id="4f04d-196">Die `pollTime` Einstellung führt einen Kompromiss zwischen Leistung und Daten "begrenzte Veraltung".</span><span class="sxs-lookup"><span data-stu-id="4f04d-196">The `pollTime` setting introduces a tradeoff between performance and data staleness.</span></span> <span data-ttu-id="4f04d-197">Eine kleine `pollTime` Wert erhöht die Anzahl der Anforderungen an die Datenbank, aber mehr schnell veraltete Daten aus dem Cache entfernt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-197">A small `pollTime` value increases the number of requests to the database, but more quickly evicts stale data from the cache.</span></span> <span data-ttu-id="4f04d-198">Eine größere `pollTime` Wert verringert die Anzahl der Anforderungen, erhöht aber die Verzögerung zwischen den Back-End-bei datenänderungen und wenn die zugehörigen Elementen entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-198">A larger `pollTime` value reduces the number of database requests, but increases the delay between when the backend data changes and when the related cache items are evicted.</span></span> <span data-ttu-id="4f04d-199">Glücklicherweise wird die datenbankanforderung einer einfachen gespeicherten Prozedur, s, die nur wenige Zeilen zurückgeben, aus einer Tabelle einfacher, ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-199">Fortunately, the database request is executing a simple stored procedure that s returning just a few rows from a simple, lightweight table.</span></span> <span data-ttu-id="4f04d-200">Jedoch Experimentieren mit verschiedenen `pollTime` Werten, um einen optimalen Kompromiss zwischen zwischen ermitteln Datenbank zugreifen und Daten "begrenzte Veraltung" für Ihre Anwendung.</span><span class="sxs-lookup"><span data-stu-id="4f04d-200">But do experiment with different `pollTime` values to find an ideal balance between database access and data staleness for your application.</span></span> <span data-ttu-id="4f04d-201">Die kleinste `pollTime` zulässige Wert ist 500.</span><span class="sxs-lookup"><span data-stu-id="4f04d-201">The smallest `pollTime` value allowed is 500.</span></span>

> [!NOTE]
> <span data-ttu-id="4f04d-202">Das obige Beispiel enthält eine einzelne `pollTime` Wert in der `<sqlCacheDependency>` -Element, aber Sie können optional angeben, die `pollTime` Wert in der `<add>` Element.</span><span class="sxs-lookup"><span data-stu-id="4f04d-202">The above example provides a single `pollTime` value in the `<sqlCacheDependency>` element, but you can optionally specify the `pollTime` value in the `<add>` element.</span></span> <span data-ttu-id="4f04d-203">Dies ist nützlich, wenn Sie mehrere Datenbanken angegeben haben, und der abrufhäufigkeit pro Datenbank angepasst werden soll.</span><span class="sxs-lookup"><span data-stu-id="4f04d-203">This is useful if you have multiple databases specified and want to customize the polling frequency per database.</span></span>


## <a name="step-5-declaratively-working-with-sql-cache-dependencies"></a><span data-ttu-id="4f04d-204">Schritt 5: Deklarativ arbeiten mit SQL-Cacheabhängigkeiten</span><span class="sxs-lookup"><span data-stu-id="4f04d-204">Step 5: Declaratively Working with SQL Cache Dependencies</span></span>

<span data-ttu-id="4f04d-205">In Schritt 1 bis 4 erläutert, wie die notwendige Infrastruktur einrichten und Konfigurieren des Systems abrufen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-205">In Steps 1 through 4 we looked at how to setup the necessary database infrastructure and configure the polling system.</span></span> <span data-ttu-id="4f04d-206">Mit dieser Infrastruktur vorhanden ist können wir nun, das dem Datencache Elemente mit einer zugeordneten SQL-Cacheabhängigkeit mithilfe von deklarativen oder programmtechnischen Techniken hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-206">With this infrastructure in place, we can now add items to the data cache with an associated SQL cache dependency using either programmatic or declarative techniques.</span></span> <span data-ttu-id="4f04d-207">In diesem Schritt untersuchen wir deklarativ arbeiten mit SQL-cacheabhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="4f04d-207">In this step we'll examine how to declaratively work with SQL cache dependencies.</span></span> <span data-ttu-id="4f04d-208">In Schritt 6 betrachten wir der programmgesteuerte Ansatz.</span><span class="sxs-lookup"><span data-stu-id="4f04d-208">In Step 6 we'll look at the programmatic approach.</span></span>

<span data-ttu-id="4f04d-209">Die [Zwischenspeichern von Daten mit dem ObjectDataSource-Steuerelement](caching-data-with-the-objectdatasource-vb.md) Tutorial untersucht die deklarative Zwischenspeichern Funktionen von dem ObjectDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="4f04d-209">The [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) tutorial explored the declarative caching capabilities of the ObjectDataSource.</span></span> <span data-ttu-id="4f04d-210">Legen Sie ganz einfach die `EnableCaching` Eigenschaft `True` und `CacheDuration` Eigenschaft einige Zeitintervall, das "ObjectDataSource" werden die Daten, die von des zugrunde liegenden Objekts zurückgegeben wird, für das angegebene Intervall automatisch zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-210">By simply setting the `EnableCaching` property to `True` and the `CacheDuration` property to some time interval, the ObjectDataSource will automatically cache the data returned from its underlying object for the specified interval.</span></span> <span data-ttu-id="4f04d-211">Dem ObjectDataSource-Steuerelement können auch eine oder mehrere SQL-cacheabhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="4f04d-211">The ObjectDataSource can also use one or more SQL cache dependencies.</span></span>

<span data-ttu-id="4f04d-212">Um deklarativ mithilfe von SQL-cacheabhängigkeiten zu demonstrieren, öffnen Sie die `SqlCacheDependencies.aspx` auf der Seite die `Caching` Ordner, und ziehen Sie einer GridView-Ansicht aus der Toolbox in den Designer.</span><span class="sxs-lookup"><span data-stu-id="4f04d-212">To demonstrate using SQL cache dependencies declaratively, open the `SqlCacheDependencies.aspx` page in the `Caching` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="4f04d-213">Legen Sie die GridView s `ID` zu `ProductsDeclarative` und sein Smarttag, auswählen, um die Bindung an eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSourceDeclarative`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-213">Set the GridView s `ID` to `ProductsDeclarative` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSourceDeclarative`.</span></span>


<span data-ttu-id="4f04d-214">[![Erstellen Sie eine neue, mit dem Namen ProductsDataSourceDeclarative "ObjectDataSource"](using-sql-cache-dependencies-vb/_static/image5.gif)](using-sql-cache-dependencies-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-214">[![Create a New ObjectDataSource Named ProductsDataSourceDeclarative](using-sql-cache-dependencies-vb/_static/image5.gif)](using-sql-cache-dependencies-vb/_static/image3.png)</span></span>

<span data-ttu-id="4f04d-215">**Abbildung 5**: Erstellen Sie eine neue "ObjectDataSource" mit dem Namen `ProductsDataSourceDeclarative` ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-215">**Figure 5**: Create a New ObjectDataSource Named `ProductsDataSourceDeclarative` ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image4.png))</span></span>


<span data-ttu-id="4f04d-216">Konfigurieren Sie mit dem ObjectDataSource-Steuerelement die `ProductsBLL` Klasse, und legen Sie die Dropdownliste in der Registerkarte "SELECT" `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-216">Configure the ObjectDataSource to use the `ProductsBLL` class and set the drop-down list in the SELECT tab to `GetProducts()`.</span></span> <span data-ttu-id="4f04d-217">Wählen Sie in der Registerkarte "Updates" der `UpdateProduct` -Überladung mit drei Eingabeparameter - `productName`, `unitPrice`, und `productID`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-217">In the UPDATE tab, choose the `UpdateProduct` overload with three input parameters - `productName`, `unitPrice`, and `productID`.</span></span> <span data-ttu-id="4f04d-218">Legen Sie die Dropdownlisten auf (keine), auf den Registerkarten INSERT- und DELETE.</span><span class="sxs-lookup"><span data-stu-id="4f04d-218">Set the drop-down lists to (None) in the INSERT and DELETE tabs.</span></span>


<span data-ttu-id="4f04d-219">[![Verwenden Sie die UpdateProduct-Überladung mit drei Eingabeparameter](using-sql-cache-dependencies-vb/_static/image6.gif)](using-sql-cache-dependencies-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-219">[![Use the UpdateProduct Overload with Three Input Parameters](using-sql-cache-dependencies-vb/_static/image6.gif)](using-sql-cache-dependencies-vb/_static/image5.png)</span></span>

<span data-ttu-id="4f04d-220">**Abbildung 6**: Verwenden der UpdateProduct-Überladung, mit drei Eingabeparameter ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-220">**Figure 6**: Use the UpdateProduct Overload with Three Input Parameters ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image6.png))</span></span>


<span data-ttu-id="4f04d-221">[![Legen Sie die Dropdown-Liste auf (keine) für die INSERT- und DELETE-Registerkarten](using-sql-cache-dependencies-vb/_static/image7.gif)](using-sql-cache-dependencies-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-221">[![Set the Drop-Down List to (None) for the INSERT and DELETE Tabs](using-sql-cache-dependencies-vb/_static/image7.gif)](using-sql-cache-dependencies-vb/_static/image7.png)</span></span>

<span data-ttu-id="4f04d-222">**Abbildung 7**: Legen Sie die Dropdown-Liste (keine) für die einfügen und Löschen von Registerkarten ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-222">**Figure 7**: Set the Drop-Down List to (None) for the INSERT and DELETE Tabs ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image8.png))</span></span>


<span data-ttu-id="4f04d-223">Nach Abschluss der Konfigurieren von Datenquellen-Assistenten werden Visual Studio BoundFields und CheckBoxFields in den GridView-Ansicht für die einzelnen Datenfelder erstellt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-223">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="4f04d-224">Entfernen Sie alle Felder jedoch `ProductName`, `CategoryName`, und `UnitPrice`, und formatieren Sie diese Felder nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="4f04d-224">Remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="4f04d-225">GridView s Smarttags überprüfen Sie die Kontrollkästchen Paging aktivieren, aktivieren Sie sortieren und Bearbeiten aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4f04d-225">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="4f04d-226">Visual Studio wird festgelegt, das "ObjectDataSource"-s `OldValuesParameterFormatString` Eigenschaft `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-226">Visual Studio will set the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="4f04d-227">In der Reihenfolge für die GridView s bearbeiten-Funktion ordnungsgemäß funktioniert, entweder entfernen Sie diese Eigenschaft vollständig aus die deklarative Syntax oder wieder auf den Standardwert `{0}`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-227">In order for the GridView s edit feature to work properly, either remove this property entirely from the declarative syntax or set it back to its default value, `{0}`.</span></span>

<span data-ttu-id="4f04d-228">Fügen Sie schließlich ein Label-Steuerelement über das GridView und seine `ID` Eigenschaft `ODSEvents` und die zugehörige `EnableViewState` Eigenschaft `False`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-228">Finally, add a Label Web control above the GridView and set its `ID` property to `ODSEvents` and its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="4f04d-229">Nach diesen Änderungen sollte im deklarativen Markup Ihrer Seite s etwa wie folgt aussehen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-229">After making these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="4f04d-230">Beachten Sie, dass haben eine Reihe von ästhetischen angepasst werden, um die GridView-Felder, die nicht zur Veranschaulichung der Abhängigkeit-Funktionalität in SQL-Cache erforderlich sind vorgenommen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-230">Note that I ve made a number of aesthetic customizations to the GridView fields that are not necessary to demonstrate the SQL cache dependency functionality.</span></span>


[!code-aspx[Main](using-sql-cache-dependencies-vb/samples/sample7.aspx)]

<span data-ttu-id="4f04d-231">Als Nächstes erstellen Sie einen Ereignishandler für das "ObjectDataSource"-s `Selecting` Ereignis und in fügen sie den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="4f04d-231">Next, create an event handler for the ObjectDataSource s `Selecting` event and in it add the following code:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample8.vb)]

<span data-ttu-id="4f04d-232">Bedenken Sie, dass das "ObjectDataSource"-s `Selecting` Ereignis ausgelöst wird, nur beim Abrufen von Daten aus der zugrunde liegende Objekt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-232">Recall that the ObjectDataSource s `Selecting` event fires only when retrieving data from its underlying object.</span></span> <span data-ttu-id="4f04d-233">Wenn es sich bei dem ObjectDataSource-Steuerelement, der von seinen eigenen Cache auf die Daten zugreift, wird dieses Ereignis nicht ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="4f04d-233">If the ObjectDataSource accesses the data from its own cache, this event is not fired.</span></span>

<span data-ttu-id="4f04d-234">Besuchen Sie diese Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="4f04d-234">Now, visit this page through a browser.</span></span> <span data-ttu-id="4f04d-235">Seit es sollte noch in der Implementierung der Zwischenspeicherung, jedes Mal, Sie Seite, zu sortieren oder bearbeiten das Raster der Seite, speichern wie in Abbildung 8 dargestellt anzeigen, der Text, die auswählen-Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="4f04d-235">Since we ve yet to implement any caching, each time you page, sort, or edit the grid the page should display the text, �Selecting event fired, as Figure 8 shows.</span></span>


<span data-ttu-id="4f04d-236">[![Das "ObjectDataSource"-s-Auswahl-Ereignis ausgelöst wird, jedes Mal, die die GridView bearbeitet, ausgelagert wird, oder die sortiert](using-sql-cache-dependencies-vb/_static/image8.gif)](using-sql-cache-dependencies-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-236">[![The ObjectDataSource s Selecting Event Fires Each Time the GridView is Paged, Edited, or Sorted](using-sql-cache-dependencies-vb/_static/image8.gif)](using-sql-cache-dependencies-vb/_static/image9.png)</span></span>

<span data-ttu-id="4f04d-237">**Abbildung 8**: Das "ObjectDataSource"-s `Selecting` löst jede Ereigniszeit GridView werden ausgelagert, bearbeiteter oder sortiert ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-237">**Figure 8**: The ObjectDataSource s `Selecting` Event Fires Each Time the GridView is Paged, Edited, or Sorted ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image10.png))</span></span>


<span data-ttu-id="4f04d-238">Wie in beschrieben der [Zwischenspeichern von Daten mit dem ObjectDataSource-Steuerelement](caching-data-with-the-objectdatasource-vb.md) Tutorial Festlegen der `EnableCaching` Eigenschaft `True` bewirkt, dass dem ObjectDataSource-Steuerelement zum Zwischenspeichern von Daten für die Dauer angegeben, die von der `CacheDuration` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="4f04d-238">As we saw in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) tutorial, setting the `EnableCaching` property to `True` causes the ObjectDataSource to cache its data for the duration specified by its `CacheDuration` property.</span></span> <span data-ttu-id="4f04d-239">Dem ObjectDataSource-Steuerelement verfügt auch über eine [ `SqlCacheDependency` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), die eine oder mehrere SQL-cacheabhängigkeiten hinzufügt, auf die zwischengespeicherten Daten, die mit dem Muster:</span><span class="sxs-lookup"><span data-stu-id="4f04d-239">The ObjectDataSource also has a [`SqlCacheDependency` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), which adds one or more SQL cache dependencies to the cached data using the pattern:</span></span>


[!code-css[Main](using-sql-cache-dependencies-vb/samples/sample9.css)]

<span data-ttu-id="4f04d-240">In denen *DatabaseName* ist der Name der Datenbank gemäß der `name` Attribut der `<add>` Element im `Web.config`, und *TableName* ist der Name der Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="4f04d-240">Where *databaseName* is the name of the database as specified in the `name` attribute of the `<add>` element in `Web.config`, and *tableName* is the name of the database table.</span></span> <span data-ttu-id="4f04d-241">Z. B. ein ObjectDataSource-Steuerelement zu erstellen, die auf unbestimmte Zeit zwischenspeichert, die basierend auf einer SQL-Cacheabhängigkeit für die Northwind-s `Products` Tabelle, legen Sie das "ObjectDataSource"-s `EnableCaching` Eigenschaft `True` und die zugehörige `SqlCacheDependency` Eigenschaft NorthwindDB:Products.</span><span class="sxs-lookup"><span data-stu-id="4f04d-241">For example, to create an ObjectDataSource that caches data indefinitely based on a SQL cache dependency against the Northwind s `Products` table, set the ObjectDataSource s `EnableCaching` property to `True` and its `SqlCacheDependency` property to NorthwindDB:Products .</span></span>

> [!NOTE]
> <span data-ttu-id="4f04d-242">Können Sie eine SQL-Cacheabhängigkeit *und* eine zeitbasierte Ablauf durch Festlegen von `EnableCaching` zu `True`, `CacheDuration` auf das Zeitintervall und `SqlCacheDependency` zu den Datenbank- und Namen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-242">You can use a SQL cache dependency *and* a time-based expiry by setting `EnableCaching` to `True`, `CacheDuration` to the time interval, and `SqlCacheDependency` to the database and table name(s).</span></span> <span data-ttu-id="4f04d-243">Dem ObjectDataSource-Steuerelement entfernen seine Daten, wenn die zeitbasierte Ablaufzeit erreicht ist oder die Abruf-System fest, dass die zugrunde liegenden Datenbankdaten geändert wurde, je nachdem, was zuerst eintritt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-243">The ObjectDataSource will evict its data when the time-based expiry is reached or when the polling system notes that the underlying database data has changed, whichever happens first.</span></span>


<span data-ttu-id="4f04d-244">GridView in `SqlCacheDependencies.aspx` zeigt Daten aus zwei Tabellen – `Products` und `Categories` (das Produkt s `CategoryName` Feld abgerufen wird, über eine `JOIN` auf `Categories`).</span><span class="sxs-lookup"><span data-stu-id="4f04d-244">The GridView in `SqlCacheDependencies.aspx` displays data from two tables - `Products` and `Categories` (the product s `CategoryName` field is retrieved via a `JOIN` on `Categories`).</span></span> <span data-ttu-id="4f04d-245">Aus diesem Grund sollten zwei SQL-cacheabhängigkeiten angeben: NorthwindDB:Products; NorthwindDB:Categories.</span><span class="sxs-lookup"><span data-stu-id="4f04d-245">Therefore, we want to specify two SQL cache dependencies: NorthwindDB:Products;NorthwindDB:Categories .</span></span>


<span data-ttu-id="4f04d-246">[![Konfigurieren Sie das "ObjectDataSource", um Unterstützung für das Zwischenspeichern mithilfe von SQL-Cacheabhängigkeiten für die Kategorien und Produkte](using-sql-cache-dependencies-vb/_static/image9.gif)](using-sql-cache-dependencies-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-246">[![Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on Products and Categories](using-sql-cache-dependencies-vb/_static/image9.gif)](using-sql-cache-dependencies-vb/_static/image11.png)</span></span>

<span data-ttu-id="4f04d-247">**Abbildung 9**: Konfigurieren Sie auf dem ObjectDataSource-Steuerelement, unterstützen das Zwischenspeichern mithilfe von SQL-Cacheabhängigkeiten `Products` und `Categories` ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-247">**Figure 9**: Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on `Products` and `Categories` ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image12.png))</span></span>


<span data-ttu-id="4f04d-248">Rufen Sie nach dem Konfigurieren der "ObjectDataSource", um Unterstützung für das Zwischenspeichern wird die Seite über einen Browser ein.</span><span class="sxs-lookup"><span data-stu-id="4f04d-248">After configuring the ObjectDataSource to support caching, revisit the page through a browser.</span></span> <span data-ttu-id="4f04d-249">In diesem Fall das Text-Auswahl-Ereignis wird ausgelöst, sollte auf der ersten Besuch der Seite angezeigt werden, jedoch sollte verschwinden beim paging, sortieren oder durch Klicken auf die bearbeiten "oder" Abbrechen ".</span><span class="sxs-lookup"><span data-stu-id="4f04d-249">Again, the text �Selecting event fired should appear on the first page visit, but should go away when paging, sorting, or clicking the Edit or Cancel buttons.</span></span> <span data-ttu-id="4f04d-250">Dies ist, da die Daten in den "ObjectDataSource"-s-Cache geladen werden, gibt es erst er bleibt die `Products` oder `Categories` Tabellen geändert werden, oder die Daten über die GridView aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-250">This is because after the data is loaded into the ObjectDataSource s cache, it remains there until the `Products` or `Categories` tables are modified or the data is updated through the GridView.</span></span>

<span data-ttu-id="4f04d-251">Nach dem Auslösen von paging für das Raster, und beachten Sie den Mangel an das Ereignis auswählen Text, öffnen Sie ein neues Browserfenster, und navigieren Sie zu den Grundlagen-Lernprogramm, in der bearbeiten, einfügen und Löschen im Abschnitt (`~/EditInsertDelete/Basics.aspx`).</span><span class="sxs-lookup"><span data-stu-id="4f04d-251">After paging through the grid and noting the lack of the �Selecting event fired text, open a new browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="4f04d-252">Aktualisieren Sie den Namen oder den Preis eines Produkts.</span><span class="sxs-lookup"><span data-stu-id="4f04d-252">Update the name or price of a product.</span></span> <span data-ttu-id="4f04d-253">Klicken Sie dann auf den ersten Browserfenster anzeigen einer anderen Seite der Daten, Sortieren des Rasters, oder klicken Sie auf eine Zeile s-Schaltfläche "Bearbeiten".</span><span class="sxs-lookup"><span data-stu-id="4f04d-253">Then, from to the first browser window, view a different page of data, sort the grid, or click a row s Edit button.</span></span> <span data-ttu-id="4f04d-254">Dieses Mal die auswählen-Ereignis ausgelöst wird, sollte erneut angezeigt, als die zugrunde liegenden Datenbank, die Daten wurden (siehe Abbildung 10) geändert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-254">This time, the �Selecting event fired should reappear, as the underlying database data has been modified (see Figure 10).</span></span> <span data-ttu-id="4f04d-255">Wenn der Text nicht angezeigt wird, warten Sie einige Minuten, und versuchen Sie es noch mal.</span><span class="sxs-lookup"><span data-stu-id="4f04d-255">If the text does not appear, wait a few moments and try again.</span></span> <span data-ttu-id="4f04d-256">Beachten Sie, dass Änderungen an der Dienst abrufen Prüfungen der `Products` Tabelle alle `pollTime` Millisekunden, daher besteht eine Verzögerung zwischen Wenn die zugrunde liegenden Daten aktualisiert wird und wenn die zwischengespeicherten Daten entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="4f04d-256">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>


<span data-ttu-id="4f04d-257">[![Ändern die Products-Tabelle entfernt die zwischengespeicherten Produktdaten](using-sql-cache-dependencies-vb/_static/image10.gif)](using-sql-cache-dependencies-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-257">[![Modifying the Products Table Evicts the Cached Product Data](using-sql-cache-dependencies-vb/_static/image10.gif)](using-sql-cache-dependencies-vb/_static/image13.png)</span></span>

<span data-ttu-id="4f04d-258">**Abbildung 10**: Ändern die Products-Tabelle entfernt die zwischengespeicherten Produktdaten ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-258">**Figure 10**: Modifying the Products Table Evicts the Cached Product Data ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image14.png))</span></span>


## <a name="step-6-programmatically-working-with-thesqlcachedependencyclass"></a><span data-ttu-id="4f04d-259">Schritt 6: Programmgesteuertes Arbeiten mit der`SqlCacheDependency`Klasse</span><span class="sxs-lookup"><span data-stu-id="4f04d-259">Step 6: Programmatically Working with the`SqlCacheDependency`Class</span></span>

<span data-ttu-id="4f04d-260">Die [Zwischenspeichern von Daten in der Architektur](caching-data-in-the-architecture-vb.md) Tutorial erläutert die Vorteile der Verwendung einer separaten Caching-Schicht in der Architektur im Gegensatz zu eng gekoppelt, das Zwischenspeichern mit dem ObjectDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="4f04d-260">The [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorial looked at the benefits of using a separate Caching Layer in the architecture as opposed to tightly coupling the caching with the ObjectDataSource.</span></span> <span data-ttu-id="4f04d-261">In diesem Lernprogramm erstellt es einen `ProductsCL` Klasse, um zu veranschaulichen, mit dem Datencache programmgesteuert arbeiten.</span><span class="sxs-lookup"><span data-stu-id="4f04d-261">In that tutorial we created a `ProductsCL` class to demonstrate programmatically working with the data cache.</span></span> <span data-ttu-id="4f04d-262">Um SQL-cacheabhängigkeiten in der Caching-Schicht zu nutzen, verwenden Sie die `SqlCacheDependency` Klasse.</span><span class="sxs-lookup"><span data-stu-id="4f04d-262">To utilize SQL cache dependencies in the Caching Layer, use the `SqlCacheDependency` class.</span></span>

<span data-ttu-id="4f04d-263">Mit dem Abruf-System eine `SqlCacheDependency` Objekt muss ein bestimmtes Paar aus Datenbank und Tabelle zugeordnet sein.</span><span class="sxs-lookup"><span data-stu-id="4f04d-263">With the polling system, a `SqlCacheDependency` object must be associated with a particular database and table pair.</span></span> <span data-ttu-id="4f04d-264">Der folgende Code erstellt z.B. eine `SqlCacheDependency` -Objekt auf Grundlage der Northwind-Datenbank s `Products` Tabelle:</span><span class="sxs-lookup"><span data-stu-id="4f04d-264">The following code, for example, creates a `SqlCacheDependency` object based on the Northwind database s `Products` table:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample10.vb)]

<span data-ttu-id="4f04d-265">Die beiden Eingabeparameter der `SqlCacheDependency` s Konstruktor sind bzw. den Datenbank- und Tabellennamen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-265">The two input parameters to the `SqlCacheDependency` s constructor are the database and table names, respectively.</span></span> <span data-ttu-id="4f04d-266">Wie Sie mit der "ObjectDataSource"-s `SqlCacheDependency` -Eigenschaft, der Datenbanknamen verwendet, ist identisch mit dem im angegebenen Wert der `name` Attribut des der `<add>` Element im `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-266">Like with the ObjectDataSource s `SqlCacheDependency` property, the database name used is the same as the value specified in the `name` attribute of the `<add>` element in `Web.config`.</span></span> <span data-ttu-id="4f04d-267">Der Tabellenname ist der tatsächliche Name der Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="4f04d-267">The table name is the actual name of the database table.</span></span>

<span data-ttu-id="4f04d-268">Zuordnen einer `SqlCacheDependency` mit einem Element, das dem Datencache hinzugefügt wird, gehen Sie die `Insert` methodenüberladungen, die eine Abhängigkeit akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-268">To associate a `SqlCacheDependency` with an item added to the data cache, use one of the `Insert` method overloads that accepts a dependency.</span></span> <span data-ttu-id="4f04d-269">Der folgende Code fügt *Wert* , das dem Datencache für eine unbestimmte Dauer, ordnet jedoch mit einem `SqlCacheDependency` auf die `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="4f04d-269">The following code adds *value* to the data cache for an indefinite duration, but associates it with a `SqlCacheDependency` on the `Products` table.</span></span> <span data-ttu-id="4f04d-270">Kurz gesagt, *Wert* wird im Cache verbleiben, bis es aufgrund von arbeitsspeicherbeschränkungen entfernt wird, oder da, die der Abruf-System erkannt hat die `Products` Tabelle wurde geändert, da er zwischengespeichert wurde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-270">In short, *value* will remain in the cache until it is evicted due to memory constraints or because the polling system has detected that the `Products` table has changed since it was cached.</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample11.vb)]

<span data-ttu-id="4f04d-271">Die Caching-Schicht s `ProductsCL` Klasse speichert derzeit Daten aus der `Products` Tabelle über eine zeitbasierte Ablauf von 60 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-271">The Caching Layer s `ProductsCL` class currently caches data from the `Products` table using a time-based expiry of 60 seconds.</span></span> <span data-ttu-id="4f04d-272">Lassen Sie s, die dieser Klasse zu aktualisieren, sodass sie stattdessen SQL-cacheabhängigkeiten verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f04d-272">Let s update this class so that it uses SQL cache dependencies instead.</span></span> <span data-ttu-id="4f04d-273">Die `ProductsCL` Klasse s `AddCacheItem` -Methode, die für das Hinzufügen von Daten in den Cache verantwortlich ist, enthält derzeit den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="4f04d-273">The `ProductsCL` class s `AddCacheItem` method, which is responsible for adding the data to the cache, currently contains the following code:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample12.vb)]

<span data-ttu-id="4f04d-274">Aktualisieren Sie diesen Code mit einer `SqlCacheDependency` Objekt, sondern mit der `MasterCacheKeyArray` Zwischenspeichern Abhängigkeit:</span><span class="sxs-lookup"><span data-stu-id="4f04d-274">Update this code to use a `SqlCacheDependency` object instead of the `MasterCacheKeyArray` cache dependency:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample13.vb)]

<span data-ttu-id="4f04d-275">Um diese Funktionalität zu testen, fügen Sie einer GridView-Ansicht auf der Seite unterhalb der vorhandenen `ProductsDeclarative` GridView.</span><span class="sxs-lookup"><span data-stu-id="4f04d-275">To test this functionality, add a GridView to the page beneath the existing `ProductsDeclarative` GridView.</span></span> <span data-ttu-id="4f04d-276">Legen Sie diese neuen GridView s `ID` zu `ProductsProgrammatic` und durch sein Smarttag, binden Sie es an eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSourceProgrammatic`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-276">Set this new GridView s `ID` to `ProductsProgrammatic` and, through its smart tag, bind it to a new ObjectDataSource named `ProductsDataSourceProgrammatic`.</span></span> <span data-ttu-id="4f04d-277">Konfigurieren Sie mit dem ObjectDataSource-Steuerelement die `ProductsCL` Klasse. dabei wird die Dropdownlisten in der SELECT und UPDATE-Registerkarten, um `GetProducts` und `UpdateProduct`bzw.</span><span class="sxs-lookup"><span data-stu-id="4f04d-277">Configure the ObjectDataSource to use the `ProductsCL` class, setting the drop-down lists in the SELECT and UPDATE tabs to `GetProducts` and `UpdateProduct`, respectively.</span></span>


<span data-ttu-id="4f04d-278">[![Konfigurieren von dem ObjectDataSource-Steuerelement zur Verwendung der ProductsCL-Klasse](using-sql-cache-dependencies-vb/_static/image11.gif)](using-sql-cache-dependencies-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-278">[![Configure the ObjectDataSource to Use the ProductsCL Class](using-sql-cache-dependencies-vb/_static/image11.gif)](using-sql-cache-dependencies-vb/_static/image15.png)</span></span>

<span data-ttu-id="4f04d-279">**Abbildung 11**: Konfigurieren Sie das "ObjectDataSource" Verwenden der `ProductsCL` Klasse ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-279">**Figure 11**: Configure the ObjectDataSource to Use the `ProductsCL` Class ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image16.png))</span></span>


<span data-ttu-id="4f04d-280">[![Wählen Sie die GetProducts-Methode aus der Registerkarte "SELECT" s Dropdown-Liste](using-sql-cache-dependencies-vb/_static/image12.gif)](using-sql-cache-dependencies-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-280">[![Select the GetProducts Method from the SELECT Tab s Drop-Down List](using-sql-cache-dependencies-vb/_static/image12.gif)](using-sql-cache-dependencies-vb/_static/image17.png)</span></span>

<span data-ttu-id="4f04d-281">**Abbildung 12**: Wählen Sie die `GetProducts` Methode aus der Registerkarte "Wählen Sie" s Dropdown-Liste ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-281">**Figure 12**: Select the `GetProducts` Method from the SELECT Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image18.png))</span></span>


<span data-ttu-id="4f04d-282">[![Wählen Sie aus der Updateliste Registerkarte s Dropdown-Liste der UpdateProduct-Methode](using-sql-cache-dependencies-vb/_static/image13.gif)](using-sql-cache-dependencies-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4f04d-282">[![Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List](using-sql-cache-dependencies-vb/_static/image13.gif)](using-sql-cache-dependencies-vb/_static/image19.png)</span></span>

<span data-ttu-id="4f04d-283">**Abbildung 13**: Wählen Sie aus der Registerkarte "UPDATE"-s-Dropdown-Liste der UpdateProduct-Methode ([klicken Sie, um das Bild in voller Größe anzeigen](using-sql-cache-dependencies-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="4f04d-283">**Figure 13**: Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image20.png))</span></span>


<span data-ttu-id="4f04d-284">Nach Abschluss der Konfigurieren von Datenquellen-Assistenten werden Visual Studio BoundFields und CheckBoxFields in den GridView-Ansicht für die einzelnen Datenfelder erstellt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-284">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="4f04d-285">Wie Sie mit der ersten GridView, die auf dieser Seite hinzugefügt, entfernen Sie alle Felder jedoch `ProductName`, `CategoryName`, und `UnitPrice`, und formatieren Sie diese Felder nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="4f04d-285">Like with the first GridView added to this page, remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="4f04d-286">GridView s Smarttags überprüfen Sie die Kontrollkästchen Paging aktivieren, aktivieren Sie sortieren und Bearbeiten aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4f04d-286">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="4f04d-287">Wie bei der `ProductsDataSourceDeclarative` "ObjectDataSource", Visual Studio wird festgelegt. die `ProductsDataSourceProgrammatic` "ObjectDataSource" s `OldValuesParameterFormatString` Eigenschaft `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-287">As with the `ProductsDataSourceDeclarative` ObjectDataSource, Visual Studio will set the `ProductsDataSourceProgrammatic` ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="4f04d-288">In der Reihenfolge für die GridView s bearbeiten-Funktion ordnungsgemäß funktioniert, legen Sie diese Eigenschaft zurück, in `{0}` (oder entfernen Sie die eigenschaftenzuweisung vollständig aus der deklarativen Syntax).</span><span class="sxs-lookup"><span data-stu-id="4f04d-288">In order for the GridView s edit feature to work properly, set this property back to `{0}` (or remove the property assignment from the declarative syntax altogether).</span></span>

<span data-ttu-id="4f04d-289">Nach Abschluss dieser Aufgaben, sollte das daraus resultierende GridView und "ObjectDataSource" deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="4f04d-289">After completing these tasks, the resulting GridView and ObjectDataSource declarative markup should look like the following:</span></span>


[!code-aspx[Main](using-sql-cache-dependencies-vb/samples/sample14.aspx)]

<span data-ttu-id="4f04d-290">So testen Sie die SQL-Cacheabhängigkeit in der Caching-Schicht, legen Sie einen Haltepunkt der `ProductCL` Klasse s `AddCacheItem` -Methode, und klicken Sie dann dem Debuggen beginnen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-290">To test the SQL cache dependency in the Caching Layer set a breakpoint in the `ProductCL` class s `AddCacheItem` method and then start debugging.</span></span> <span data-ttu-id="4f04d-291">Wenn Sie zum ersten Mal besuchen `SqlCacheDependencies.aspx`, sollte der Haltepunkt erreicht werden, wie die Daten zum ersten Mal angefordert und im Cache platziert wurden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-291">When you first visit `SqlCacheDependencies.aspx`, the breakpoint should be hit as the data is requested for the first time and placed into the cache.</span></span> <span data-ttu-id="4f04d-292">Klicken Sie anschließend auf eine andere Seite der GridView zu verschieben, oder eine der Spalten zu sortieren.</span><span class="sxs-lookup"><span data-stu-id="4f04d-292">Next, move to another page in the GridView or sort one of the columns.</span></span> <span data-ttu-id="4f04d-293">Dies bewirkt, dass der GridView, die Daten erneut abzufragen, aber die Daten gefunden werden sollte, im Cache seit dem `Products` Datenbanktabelle wurde nicht geändert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-293">This causes the GridView to requery its data, but the data should be found in the cache since the `Products` database table has not been modified.</span></span> <span data-ttu-id="4f04d-294">Wenn die Daten wiederholt nicht im Cache gefunden werden, stellen Sie sicher, dass auf Ihrem Computer über ausreichend Arbeitsspeicher verfügbar ist, und versuchen Sie es erneut.</span><span class="sxs-lookup"><span data-stu-id="4f04d-294">If the data is repeatedly not found in the cache, make sure there is sufficient memory available on your computer and try again.</span></span>

<span data-ttu-id="4f04d-295">Öffnen Sie nach dem Paging durch ein paar Seiten der GridView, ein zweites Browserfenster, und navigieren Sie zu den Grundlagen-Lernprogramm, in der bearbeiten, einfügen und Löschen im Abschnitt (`~/EditInsertDelete/Basics.aspx`).</span><span class="sxs-lookup"><span data-stu-id="4f04d-295">After paging through a few pages of the GridView, open a second browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="4f04d-296">Aktualisieren eines Datensatzes aus der Tabelle Products und zeigen Sie anschließend aus dem ersten Browserfenster, eine neue Seite, oder klicken Sie auf einen der Sortierung-Header.</span><span class="sxs-lookup"><span data-stu-id="4f04d-296">Update a record from the Products table and then, from the first browser window, view a new page or click on one of the sorting headers.</span></span>

<span data-ttu-id="4f04d-297">In diesem Szenario sehen Sie zwei Möglichkeiten: entweder der Haltepunkt wird erreicht, gibt an, dass die zwischengespeicherten Daten aufgrund der Änderung in der Datenbank entfernt wurde oder der Haltepunkt wird nicht erreicht, was bedeutet, dass `SqlCacheDependencies.aspx` ist nun veraltete Daten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-297">In this scenario you will see one of two things: either the breakpoint will be hit, indicating that the cached data was evicted due to the change in the database; or, the breakpoint will not be hit, meaning that `SqlCacheDependencies.aspx` is now showing stale data.</span></span> <span data-ttu-id="4f04d-298">Wenn der Haltepunkt nicht getroffen wird, ist es wahrscheinlich, da der Abruf-Dienst noch nicht ausgelöst wurde, da die Daten geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-298">If the breakpoint is not hit, it is likely because the polling service has not yet fired since the data was changed.</span></span> <span data-ttu-id="4f04d-299">Beachten Sie, dass Änderungen an der Dienst abrufen Prüfungen der `Products` Tabelle alle `pollTime` Millisekunden, daher besteht eine Verzögerung zwischen Wenn die zugrunde liegenden Daten aktualisiert wird und wenn die zwischengespeicherten Daten entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="4f04d-299">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>

> [!NOTE]
> <span data-ttu-id="4f04d-300">Diese Verzögerung ist eher angezeigt werden, wenn eines der Produkte über die GridView in Bearbeitung `SqlCacheDependencies.aspx`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-300">This delay is more likely to appear when editing one of the products through the GridView in `SqlCacheDependencies.aspx`.</span></span> <span data-ttu-id="4f04d-301">In der [Zwischenspeichern von Daten in der Architektur](caching-data-in-the-architecture-vb.md) Tutorial, die wir hinzugefügt, die `MasterCacheKeyArray` Zwischenspeichern Abhängigkeit, um sicherzustellen, dass die Daten, die bearbeitet wird, über die `ProductsCL` s-Klasse `UpdateProduct` Methode aus dem Cache entfernt wurde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-301">In the [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorial we added the `MasterCacheKeyArray` cache dependency to ensure that the data being edited through the `ProductsCL` class s `UpdateProduct` method was evicted from the cache.</span></span> <span data-ttu-id="4f04d-302">Allerdings ersetzt diese Cacheabhängigkeit beim Ändern der `AddCacheItem` Methode weiter oben in diesem Schritt und somit die `ProductsCL` Klasse werden weiterhin die zwischengespeicherten Daten angezeigt, bis die Abruf-System die Änderung fest der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="4f04d-302">However, we replaced this cache dependency when modifying the `AddCacheItem` method earlier in this step and therefore the `ProductsCL` class will continue to show the cached data until the polling system notes the change to the `Products` table.</span></span> <span data-ttu-id="4f04d-303">Erfahren Sie, wie auf die Rückmeldung der `MasterCacheKeyArray` Zwischenspeichern Abhängigkeit in Schritt 7.</span><span class="sxs-lookup"><span data-stu-id="4f04d-303">We'll see how to reintroduce the `MasterCacheKeyArray` cache dependency in Step 7.</span></span>


## <a name="step-7-associating-multiple-dependencies-with-a-cached-item"></a><span data-ttu-id="4f04d-304">Schritt 7: Ein zwischengespeichertes Element mehrere Abhängigkeiten zugeordnet</span><span class="sxs-lookup"><span data-stu-id="4f04d-304">Step 7: Associating Multiple Dependencies with a Cached Item</span></span>

<span data-ttu-id="4f04d-305">Bedenken Sie, dass die `MasterCacheKeyArray` Cacheabhängigkeit wird verwendet, um sicherzustellen, dass *alle* produktbezogene Daten aus dem Cache entfernt werden, wenn ein Element in diesem Zusammenhang aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="4f04d-305">Recall that the `MasterCacheKeyArray` cache dependency is used to ensure that *all* product-related data is evicted from the cache when any single item associated within it is updated.</span></span> <span data-ttu-id="4f04d-306">Z. B. die `GetProductsByCategoryID(categoryID)` Methode Caches `ProductsDataTables` Instanzen für jeden eindeutigen *CategoryID* Wert.</span><span class="sxs-lookup"><span data-stu-id="4f04d-306">For example, the `GetProductsByCategoryID(categoryID)` method caches `ProductsDataTables` instances for each unique *categoryID* value.</span></span> <span data-ttu-id="4f04d-307">Wenn eines dieser Objekte entfernt wird, die `MasterCacheKeyArray` Cacheabhängigkeit wird sichergestellt, dass die anderen auch entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-307">If one of these objects is evicted, the `MasterCacheKeyArray` cache dependency ensures that the others are also removed.</span></span> <span data-ttu-id="4f04d-308">Wenn die zwischengespeicherten Daten geändert werden, besteht die Möglichkeit ohne diese Cacheabhängigkeit, dass andere zwischengespeicherte Produktdaten möglicherweise veraltet.</span><span class="sxs-lookup"><span data-stu-id="4f04d-308">Without this cache dependency, when the cached data is modified the possibility exists that other cached product data may be out of date.</span></span> <span data-ttu-id="4f04d-309">Daher es wichtig, dass wir verwalten die `MasterCacheKeyArray` Abhängigkeit den Zwischenspeicher bei Verwendung von SQL-cacheabhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="4f04d-309">Consequently, it s important that we maintain the `MasterCacheKeyArray` cache dependency when using SQL cache dependencies.</span></span> <span data-ttu-id="4f04d-310">Allerdings speichern die Daten s `Insert` Methode kann nur ein einzelnes Abhängigkeitsobjekt.</span><span class="sxs-lookup"><span data-stu-id="4f04d-310">However, the data cache s `Insert` method only allows for a single dependency object.</span></span>

<span data-ttu-id="4f04d-311">Bei der Arbeit mit SQL-cacheabhängigkeiten müssen wir darüber hinaus mehreren Datenbanktabellen als Abhängigkeiten zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-311">Furthermore, when working with SQL cache dependencies we may need to associate multiple database tables as dependencies.</span></span> <span data-ttu-id="4f04d-312">Z. B. die `ProductsDataTable` zwischengespeicherte in die `ProductsCL` -Klasse enthält die Kategorie und Lieferanten Namen für jedes Produkt, aber die `AddCacheItem` Methode verwendet nur eine Abhängigkeit auf `Products`.</span><span class="sxs-lookup"><span data-stu-id="4f04d-312">For example, the `ProductsDataTable` cached in the `ProductsCL` class contains the category and supplier names for each product, but the `AddCacheItem` method only uses a dependency on `Products`.</span></span> <span data-ttu-id="4f04d-313">In diesem Fall, wenn der Benutzer den Namen der Kategorie oder Lieferant, aktualisiert die zwischengespeicherten Produktdaten werden im Cache verbleiben und veraltet sein.</span><span class="sxs-lookup"><span data-stu-id="4f04d-313">In this situation, if the user updates the name of a category or supplier, the cached product data will remain in the cache and be out of date.</span></span> <span data-ttu-id="4f04d-314">Aus diesem Grund werden wir die Produktdaten an zwischengespeicherte Objekt abhängig machen soll nicht nur die `Products` -Tabelle jedoch in der `Categories` und `Suppliers` auch Tabellen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-314">Therefore, we want to make the cached product data dependent on not only the `Products` table, but on the `Categories` and `Suppliers` tables as well.</span></span>

<span data-ttu-id="4f04d-315">Die [ `AggregateCacheDependency` Klasse](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) bietet eine Möglichkeit für ein Element im Cache mehrere Abhängigkeiten zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="4f04d-315">The [`AggregateCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) provides a means for associating multiple dependencies with a cache item.</span></span> <span data-ttu-id="4f04d-316">Erstellen Sie zunächst eine `AggregateCacheDependency` Instanz.</span><span class="sxs-lookup"><span data-stu-id="4f04d-316">Start by creating an `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="4f04d-317">Fügen Sie den Satz von Abhängigkeiten mithilfe der `AggregateCacheDependency` s `Add` Methode.</span><span class="sxs-lookup"><span data-stu-id="4f04d-317">Next, add the set of dependencies using the `AggregateCacheDependency` s `Add` method.</span></span> <span data-ttu-id="4f04d-318">Wenn das Element in Datencache danach einfügen möchten, übergeben die `AggregateCacheDependency` Instanz.</span><span class="sxs-lookup"><span data-stu-id="4f04d-318">When inserting the item into the data cache thereafter, pass in the `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="4f04d-319">Wenn *alle* von der `AggregateCacheDependency` s-Instanz Abhängigkeiten ändern, wird das zwischengespeicherte Element entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-319">When *any* of the `AggregateCacheDependency` instance s dependencies change, the cached item will be evicted.</span></span>

<span data-ttu-id="4f04d-320">Das folgende Beispiel zeigt den aktualisierten Code für die `ProductsCL` Klasse s `AddCacheItem` Methode.</span><span class="sxs-lookup"><span data-stu-id="4f04d-320">The following shows the updated code for the `ProductsCL` class s `AddCacheItem` method.</span></span> <span data-ttu-id="4f04d-321">Die Methode erstellt die `MasterCacheKeyArray` Zwischenspeichern Abhängigkeit zusammen mit `SqlCacheDependency` von Objekten für die die `Products`, `Categories`, und `Suppliers` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="4f04d-321">The method creates the `MasterCacheKeyArray` cache dependency along with `SqlCacheDependency` objects for the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="4f04d-322">Diese werden alle in einer kombiniert `AggregateCacheDependency` Objekt mit dem Namen `aggregateDependencies`, die übergeben wird dann in der `Insert` Methode.</span><span class="sxs-lookup"><span data-stu-id="4f04d-322">These are all combined into one `AggregateCacheDependency` object named `aggregateDependencies`, which is then passed into the `Insert` method.</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample15.vb)]

<span data-ttu-id="4f04d-323">Testen Sie diesen neuen Code heraus. Jetzt wird nun die `Products`, `Categories`, oder `Suppliers` Tabellen dazu führen, dass die zwischengespeicherten Daten entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-323">Test this new code out. Now changes to the `Products`, `Categories`, or `Suppliers` tables cause the cached data to be evicted.</span></span> <span data-ttu-id="4f04d-324">Darüber hinaus die `ProductsCL` s-Klasse `UpdateProduct` -Methode, die aufgerufen wird, beim Bearbeiten eines Produkts über GridView, entfernt der `MasterCacheKeyArray` Zwischenspeichern Abhängigkeit, wodurch die zwischengespeicherten `ProductsDataTable` entfernt werden und die Daten erneut auf dem nächsten abgerufen werden sollen Anforderung.</span><span class="sxs-lookup"><span data-stu-id="4f04d-324">Moreover, the `ProductsCL` class s `UpdateProduct` method, which is called when editing a product through the GridView, evicts the `MasterCacheKeyArray` cache dependency, which causes the cached `ProductsDataTable` to be evicted and the data to be re-retrieved on the next request.</span></span>

> [!NOTE]
> <span data-ttu-id="4f04d-325">SQL-cacheabhängigkeiten können auch verwendet werden, mit [ausgabezwischenspeicherung](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span><span class="sxs-lookup"><span data-stu-id="4f04d-325">SQL cache dependencies can also be used with [output caching](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span></span> <span data-ttu-id="4f04d-326">Eine Demonstration dieser Funktion finden Sie unter: [Mithilfe von ASP.NET mit SQLServer Ausgabezwischenspeicherung](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="4f04d-326">For a demonstration of this functionality, see: [Using ASP.NET Output Caching with SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="4f04d-327">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="4f04d-327">Summary</span></span>

<span data-ttu-id="4f04d-328">Beim Zwischenspeichern von Daten werden im Idealfall die Daten im Cache verbleiben, bis er in der Datenbank geändert wird.</span><span class="sxs-lookup"><span data-stu-id="4f04d-328">When caching database data, the data will ideally remain in the cache until it is modified in the database.</span></span> <span data-ttu-id="4f04d-329">Mit ASP.NET 2.0 können SQL-cacheabhängigkeiten erstellt und in deklarativ und programmatisch Szenarien verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-329">With ASP.NET 2.0, SQL cache dependencies can be created and used in both declarative and programmatic scenarios.</span></span> <span data-ttu-id="4f04d-330">Eine der Herausforderungen bei diesem Ansatz wird ermittelt, wenn Sie die Daten geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="4f04d-330">One of the challenges with this approach is in discovering when the data has been modified.</span></span> <span data-ttu-id="4f04d-331">Die Vollversionen von Microsoft SQL Server 2005 bieten Notification-Funktionen, die eine Anwendung warnen können, wenn ein Ergebnis der Abfrage geändert hat.</span><span class="sxs-lookup"><span data-stu-id="4f04d-331">The full versions of Microsoft SQL Server 2005 provide notification capabilities that can alert an application when a query result has changed.</span></span> <span data-ttu-id="4f04d-332">Für die Express Edition von SQL Server 2005 und älteren Versionen von SQL Server muss stattdessen ein Abruf-System verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f04d-332">For the Express Edition of SQL Server 2005 and older versions of SQL Server, a polling system must be used instead.</span></span> <span data-ttu-id="4f04d-333">Einrichten der erforderlichen Abruf-Infrastruktur ist recht einfach.</span><span class="sxs-lookup"><span data-stu-id="4f04d-333">Fortunately, setting up the necessary polling infrastructure is fairly straightforward.</span></span>

<span data-ttu-id="4f04d-334">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="4f04d-334">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="4f04d-335">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="4f04d-335">Further Reading</span></span>

<span data-ttu-id="4f04d-336">Weitere Informationen zu den Themen in diesem Tutorial erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="4f04d-336">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4f04d-337">Verwenden von Abfragebenachrichtigungen in Microsoft SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="4f04d-337">Using Query Notifications in Microsoft SQL Server 2005</span></span>](https://msdn.microsoft.com/library/ms175110.aspx)
- [<span data-ttu-id="4f04d-338">Erstellen eine Abfragebenachrichtigung</span><span class="sxs-lookup"><span data-stu-id="4f04d-338">Creating a Query Notification</span></span>](https://msdn.microsoft.com/library/ms188669.aspx)
- <span data-ttu-id="4f04d-339">[Ausgabezwischenspeicherung in ASP.NET mit der `SqlCacheDependency` Klasse](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="4f04d-339">[Caching in ASP.NET with the `SqlCacheDependency` Class](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span></span>
- <span data-ttu-id="4f04d-340">[ASP.NET SQL Server-Registrierungstool (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="4f04d-340">[ASP.NET SQL Server Registration Tool (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span></span>
- [<span data-ttu-id="4f04d-341">Übersicht über die `SqlCacheDependency`</span><span class="sxs-lookup"><span data-stu-id="4f04d-341">Overview of `SqlCacheDependency`</span></span>](http://www.aspnetresources.com/blog/sql_cache_depedency_overview.aspx)

## <a name="about-the-author"></a><span data-ttu-id="4f04d-342">Der Autor</span><span class="sxs-lookup"><span data-stu-id="4f04d-342">About the Author</span></span>

<span data-ttu-id="4f04d-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="4f04d-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4f04d-344">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="4f04d-344">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4f04d-345">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4f04d-345">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4f04d-346">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4f04d-346">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="4f04d-347">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4f04d-347">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="4f04d-348">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="4f04d-348">Special Thanks To</span></span>

<span data-ttu-id="4f04d-349">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="4f04d-349">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4f04d-350">Führendes Prüfer für dieses Tutorial wurden Marko Rangel Teresa Murphy und Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="4f04d-350">Lead reviewers for this tutorial were Marko Rangel, Teresa Murphy, and Hilton Giesenow.</span></span> <span data-ttu-id="4f04d-351">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="4f04d-351">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4f04d-352">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4f04d-352">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="4f04d-353">Vorherige</span><span class="sxs-lookup"><span data-stu-id="4f04d-353">Previous</span></span>](caching-data-at-application-startup-vb.md)
