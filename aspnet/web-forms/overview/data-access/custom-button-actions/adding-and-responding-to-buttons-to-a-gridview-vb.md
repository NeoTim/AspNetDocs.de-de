---
uid: web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
title: Hinzufügen und reagieren auf Schaltflächen zu einem GridView-(VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial wird erläutert, wie Sie benutzerdefinierte Schaltflächen, sowohl einer Vorlage als auch den Feldern eines GridView-Steuer Elements oder DetailsView-Steuer Elements hinzufügen. Wir werden uns vor allem
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 06c6bbd2-4bdc-435b-87a3-df2c868f4baa
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
msc.type: authoredcontent
ms.openlocfilehash: 8727d8faead02340d223c75845bf29f63d1a0834
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78442275"
---
# <a name="adding-and-responding-to-buttons-to-a-gridview-vb"></a><span data-ttu-id="97e7e-104">Hinzufügen von Schaltflächen zu einem GridView-Steuerelement und Zuweisen von Funktionen für diese Schaltflächen (VB)</span><span class="sxs-lookup"><span data-stu-id="97e7e-104">Adding and Responding to Buttons to a GridView (VB)</span></span>

<span data-ttu-id="97e7e-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="97e7e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="97e7e-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) oder [PDF herunterladen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="97e7e-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) or [Download PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span></span>

> <span data-ttu-id="97e7e-107">In diesem Tutorial wird erläutert, wie Sie benutzerdefinierte Schaltflächen, sowohl einer Vorlage als auch den Feldern eines GridView-Steuer Elements oder DetailsView-Steuer Elements hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-107">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="97e7e-108">Insbesondere erstellen wir eine Schnittstelle mit einer FormView, mit der der Benutzer die Seite durch die Lieferanten durchlaufen kann.</span><span class="sxs-lookup"><span data-stu-id="97e7e-108">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span>

## <a name="introduction"></a><span data-ttu-id="97e7e-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="97e7e-109">Introduction</span></span>

<span data-ttu-id="97e7e-110">Obwohl viele Berichterstattungs Szenarien schreibgeschützten Zugriff auf die Berichtsdaten beinhalten, ist es für Berichte nicht ungewöhnlich, dass Sie auf der Grundlage der angezeigten Daten Aktionen ausführen können.</span><span class="sxs-lookup"><span data-stu-id="97e7e-110">While many reporting scenarios involve read-only access to the report data, it s not uncommon for reports to include the ability to perform actions based upon the data displayed.</span></span> <span data-ttu-id="97e7e-111">In der Regel umfasste dies das Hinzufügen eines Schaltflächen-, LinkButton-oder ImageButton-websteuer Elements mit jedem Datensatz, der im Bericht angezeigt wird. Wenn Sie darauf klicken, wird ein Postback ausgelöst und ein serverseitiger Code aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-111">Typically this involved adding a Button, LinkButton, or ImageButton Web control with each record displayed in the report that, when clicked, causes a postback and invokes some server-side code.</span></span> <span data-ttu-id="97e7e-112">Das häufigste Beispiel ist das Bearbeiten und Löschen der Daten auf Datensatz-Basis.</span><span class="sxs-lookup"><span data-stu-id="97e7e-112">Editing and deleting the data on a record-by-record basis is the most common example.</span></span> <span data-ttu-id="97e7e-113">Wie wir bereits mit der [Übersicht über das Einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) Lernprogrammen begonnen haben, ist das Bearbeiten und löschen so üblich, dass die Steuerelemente GridView, DetailsView und FormView diese Funktionalität unterstützen können, ohne dass eine einzige Codezeile geschrieben werden muss.</span><span class="sxs-lookup"><span data-stu-id="97e7e-113">In fact, as we saw starting with the [Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, editing and deleting is so common that the GridView, DetailsView, and FormView controls can support such functionality without the need for writing a single line of code.</span></span>

<span data-ttu-id="97e7e-114">Zusätzlich zu den Schaltflächen Bearbeiten und löschen können auch das GridView-Steuerelement, das DetailsView-Steuerelement und das FormView-Steuerelement Schaltflächen, LinkButtons oder imagebuttons enthalten, die beim Klicken auf eine benutzerdefinierte serverseitige Logik durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-114">In addition to Edit and Delete buttons, the GridView, DetailsView, and FormView controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="97e7e-115">In diesem Tutorial wird erläutert, wie Sie benutzerdefinierte Schaltflächen, sowohl einer Vorlage als auch den Feldern eines GridView-Steuer Elements oder DetailsView-Steuer Elements hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-115">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="97e7e-116">Insbesondere erstellen wir eine Schnittstelle mit einer FormView, mit der der Benutzer die Seite durch die Lieferanten durchlaufen kann.</span><span class="sxs-lookup"><span data-stu-id="97e7e-116">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span> <span data-ttu-id="97e7e-117">Für einen bestimmten Lieferanten zeigt die FormView Informationen über den Lieferanten zusammen mit einem Schaltflächen-websteuer Element an, das, wenn darauf geklickt wird, alle zugehörigen Produkte als nicht mehr unterstützt markiert.</span><span class="sxs-lookup"><span data-stu-id="97e7e-117">For a given supplier, the FormView will show information about the supplier along with a Button Web control that, if clicked, will mark all of their associated products as discontinued.</span></span> <span data-ttu-id="97e7e-118">Außerdem listet eine GridView die Produkte auf, die vom ausgewählten Lieferanten bereitgestellt werden, wobei jede Zeile die Schaltflächen Preis Preis und Preisnachlass Preis enthält, die, wenn Sie darauf geklickt haben, das Produkt s `UnitPrice` um 10% erhöhen oder verringern (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="97e7e-118">Additionally, a GridView lists those products provided by the selected supplier, with each row containing Increase Price and Discount Price Buttons that, if clicked, raise or reduce the product s `UnitPrice` by 10% (see Figure 1).</span></span>

<span data-ttu-id="97e7e-119">[![der FormView und GridView Schaltflächen enthalten, die benutzerdefinierte Aktionen ausführen.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-119">[![Both the FormView and GridView Contain Buttons That Perform Custom Actions](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span></span>

<span data-ttu-id="97e7e-120">**Abbildung 1**: die Form View und die GridView enthalten Schaltflächen, die benutzerdefinierte Aktionen ausführen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-120">**Figure 1**: Both the FormView and GridView Contain Buttons That Perform Custom Actions ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span></span>

## <a name="step-1-adding-the-button-tutorial-web-pages"></a><span data-ttu-id="97e7e-121">Schritt 1: Hinzufügen der Schaltflächen-tutorialwebseiten</span><span class="sxs-lookup"><span data-stu-id="97e7e-121">Step 1: Adding the Button Tutorial Web Pages</span></span>

<span data-ttu-id="97e7e-122">Bevor wir uns ansehen, wie Sie benutzerdefinierte Schaltflächen hinzufügen, nehmen Sie sich zunächst einen Moment Zeit, um die ASP.NET-Seiten in unserem Website Projekt zu erstellen, die wir für dieses Tutorial benötigen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-122">Before we look at how to add a custom buttons, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="97e7e-123">Fügen Sie zunächst einen neuen Ordner mit dem Namen `CustomButtons`hinzu.</span><span class="sxs-lookup"><span data-stu-id="97e7e-123">Start by adding a new folder named `CustomButtons`.</span></span> <span data-ttu-id="97e7e-124">Fügen Sie dann die folgenden beiden ASP.NET-Seiten zu diesem Ordner hinzu, und stellen Sie sicher, dass Sie die einzelnen Seiten der `Site.master` Master Seite zuordnen:</span><span class="sxs-lookup"><span data-stu-id="97e7e-124">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`

![Hinzufügen der ASP.NET-Seiten für benutzerdefinierte Schaltflächen bezogene Tutorials](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image4.png)

<span data-ttu-id="97e7e-126">**Abbildung 2**: Hinzufügen der ASP.NET-Seiten für benutzerdefinierte Schaltflächen bezogene Tutorials</span><span class="sxs-lookup"><span data-stu-id="97e7e-126">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>

<span data-ttu-id="97e7e-127">Wie in den anderen Ordnern werden `Default.aspx` im Ordner `CustomButtons` die Lernprogramme in diesem Abschnitt auflisten.</span><span class="sxs-lookup"><span data-stu-id="97e7e-127">Like in the other folders, `Default.aspx` in the `CustomButtons` folder will list the tutorials in its section.</span></span> <span data-ttu-id="97e7e-128">Denken Sie daran, dass das `SectionLevelTutorialListing.ascx` Benutzer Steuerelement diese Funktionalität bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="97e7e-128">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="97e7e-129">Fügen Sie dieses Benutzer Steuerelement daher `Default.aspx` hinzu, indem Sie es aus dem Projektmappen-Explorer auf die Seite s Designansicht ziehen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-129">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="97e7e-130">[![das Benutzer Steuerelement "sectionleveltutoriallisting. ascx" zu "default. aspx" hinzufügen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-130">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span></span>

<span data-ttu-id="97e7e-131">**Abbildung 3**: Hinzufügen des `SectionLevelTutorialListing.ascx` Benutzer Steuer Elements zu `Default.aspx` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-131">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span></span>

<span data-ttu-id="97e7e-132">Fügen Sie abschließend die Seiten als Einträge zur `Web.sitemap` Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="97e7e-132">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="97e7e-133">Fügen Sie insbesondere nach dem `<siteMapNode>`Paging und Sortieren das folgende Markup hinzu:</span><span class="sxs-lookup"><span data-stu-id="97e7e-133">Specifically, add the following markup after the Paging and Sorting `<siteMapNode>`:</span></span>

[!code-xml[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample1.xml)]

<span data-ttu-id="97e7e-134">Nehmen Sie sich nach dem Aktualisieren `Web.sitemap`einen Moment Zeit, um die Tutorials-Website über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-134">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="97e7e-135">Das Menü auf der linken Seite enthält jetzt Elemente für die Tutorials zum Bearbeiten, einfügen und löschen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-135">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![Die Site Übersicht enthält jetzt den Eintrag für das Tutorial benutzerdefinierte Schaltflächen.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image8.png)

<span data-ttu-id="97e7e-137">**Abbildung 4**: die Site Übersicht enthält jetzt den Eintrag für das Tutorial zu benutzerdefinierten Schaltflächen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-137">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>

## <a name="step-2-adding-a-formview-that-lists-the-suppliers"></a><span data-ttu-id="97e7e-138">Schritt 2: Hinzufügen einer FormView, die die Lieferanten auflistet</span><span class="sxs-lookup"><span data-stu-id="97e7e-138">Step 2: Adding a FormView that Lists the Suppliers</span></span>

<span data-ttu-id="97e7e-139">Beginnen Sie mit diesem Tutorial, indem Sie die FormView hinzufügen, die die Lieferanten auflistet.</span><span class="sxs-lookup"><span data-stu-id="97e7e-139">Let s get started with this tutorial by adding the FormView that lists the suppliers.</span></span> <span data-ttu-id="97e7e-140">Wie in der Einführung erläutert, ermöglicht diese FormView dem Benutzer das Durchlaufen der Lieferanten und zeigt die Produkte an, die vom Lieferanten in einer GridView bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-140">As discussed in the Introduction, this FormView will allow the user to page through the suppliers, showing the products provided by the supplier in a GridView.</span></span> <span data-ttu-id="97e7e-141">Außerdem enthält diese FormView eine Schaltfläche, mit der alle Lieferanten Produkte als nicht mehr unterstützt gekennzeichnet werden, wenn darauf geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-141">Additionally, this FormView will include a Button that, when clicked, will mark all of the supplier s products as discontinued.</span></span> <span data-ttu-id="97e7e-142">Bevor wir uns mit dem Hinzufügen der benutzerdefinierten Schaltfläche zu "FormView" befassen, erstellen Sie zuerst die FormView, sodass die Lieferanteninformationen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-142">Before we concern ourselves with adding the custom button to the FormView, let s first just create the FormView so that it displays the supplier information.</span></span>

<span data-ttu-id="97e7e-143">Öffnen Sie zunächst die Seite `CustomButtons.aspx` im Ordner `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="97e7e-143">Start by opening the `CustomButtons.aspx` page in the `CustomButtons` folder.</span></span> <span data-ttu-id="97e7e-144">Fügen Sie der Seite eine FormView hinzu, indem Sie Sie aus der Toolbox auf den Designer ziehen und deren `ID`-Eigenschaft auf `Suppliers`festlegen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-144">Add a FormView to the page by dragging it from the Toolbox onto the Designer and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="97e7e-145">Wählen Sie aus dem FormView s-Smarttag aus, dass Sie eine neue ObjectDataSource mit dem Namen `SuppliersDataSource`erstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="97e7e-145">From the FormView s smart tag, opt to create a new ObjectDataSource named `SuppliersDataSource`.</span></span>

<span data-ttu-id="97e7e-146">[![erstellen Sie eine neue ObjectDataSource mit dem Namen "suppliersdatasource".](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-146">[![Create a New ObjectDataSource Named SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span></span>

<span data-ttu-id="97e7e-147">**Abbildung 5**: Erstellen einer neuen ObjectDataSource mit dem Namen "`SuppliersDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-147">**Figure 5**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span></span>

<span data-ttu-id="97e7e-148">Konfigurieren Sie diese neue ObjectDataSource so, dass Sie von der `SuppliersBLL` Klasse `GetSuppliers()`-Methode abgefragt wird (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="97e7e-148">Configure this new ObjectDataSource such that it queries from the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 6).</span></span> <span data-ttu-id="97e7e-149">Da diese FormView keine Schnittstelle zum Aktualisieren der Lieferanteninformationen bereitstellt, wählen Sie in der Dropdown Liste auf der Registerkarte aktualisieren die Option (keine) aus.</span><span class="sxs-lookup"><span data-stu-id="97e7e-149">Since this FormView does not provide an interface for updating the supplier information, select the (None) option from the drop-down list in the UPDATE tab.</span></span>

<span data-ttu-id="97e7e-150">[![die Datenquelle so konfigurieren, dass die suppliersbll Class s getsuppliers ()-Methode verwendet wird.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-150">[![Configure the Data Source to use the SuppliersBLL Class s GetSuppliers() Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span></span>

<span data-ttu-id="97e7e-151">**Abbildung 6**: Konfigurieren der Datenquelle für die Verwendung der `GetSuppliers()` Methode der `SuppliersBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-151">**Figure 6**: Configure the Data Source to use the `SuppliersBLL` Class s `GetSuppliers()` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span></span>

<span data-ttu-id="97e7e-152">Nach dem Konfigurieren von ObjectDataSource generiert Visual Studio eine `InsertItemTemplate`, `EditItemTemplate`und `ItemTemplate` für die Form View.</span><span class="sxs-lookup"><span data-stu-id="97e7e-152">After configuring the ObjectDataSource, Visual Studio will generate an `InsertItemTemplate`, `EditItemTemplate`, and `ItemTemplate` for the FormView.</span></span> <span data-ttu-id="97e7e-153">Entfernen Sie die `InsertItemTemplate`, und `EditItemTemplate` und ändern Sie die `ItemTemplate`, sodass nur der Firmenname und die Telefonnummer des Lieferanten angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-153">Remove the `InsertItemTemplate` and `EditItemTemplate` and modify the `ItemTemplate` so that it displays just the supplier s company name and phone number.</span></span> <span data-ttu-id="97e7e-154">Aktivieren Sie schließlich die Paging-Unterstützung für die FormView, indem Sie das Kontrollkästchen Paging aktivieren des Smarttags aktivieren (oder indem Sie die `AllowPaging`-Eigenschaft auf `True`festlegen).</span><span class="sxs-lookup"><span data-stu-id="97e7e-154">Finally, turn on paging support for the FormView by checking the Enable Paging checkbox from its smart tag (or by setting its `AllowPaging` property to `True`).</span></span> <span data-ttu-id="97e7e-155">Nachdem diese Änderungen vorgenommen wurden, sollte das deklarative Markup der Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="97e7e-155">After these changes your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample2.aspx)]

<span data-ttu-id="97e7e-156">Abbildung 7 zeigt die Seite custombuttons. aspx, wenn Sie in einem Browser angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-156">Figure 7 shows the CustomButtons.aspx page when viewed through a browser.</span></span>

<span data-ttu-id="97e7e-157">[![FormView listet die Felder "CompanyName" und "Phone" des aktuell ausgewählten Lieferanten auf.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-157">[![The FormView Lists the CompanyName and Phone Fields from the Currently Selected Supplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span></span>

<span data-ttu-id="97e7e-158">**Abbildung 7**: FormView listet die Felder "`CompanyName`" und "`Phone`" des aktuell ausgewählten Lieferanten auf ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-158">**Figure 7**: The FormView Lists the `CompanyName` and `Phone` Fields from the Currently Selected Supplier ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span></span>

## <a name="step-3-adding-a-gridview-that-lists-the-selected-supplier-s-products"></a><span data-ttu-id="97e7e-159">Schritt 3: Hinzufügen einer GridView, in der die Produkte des ausgewählten Lieferanten aufgeführt sind</span><span class="sxs-lookup"><span data-stu-id="97e7e-159">Step 3: Adding a GridView that Lists the Selected Supplier s Products</span></span>

<span data-ttu-id="97e7e-160">Bevor wir der FormView s-Vorlage die Schaltfläche Alle Produkte einstellen hinzufügen, können Sie zuerst eine GridView unter der Form Ansicht hinzufügen, in der die Produkte des ausgewählten Lieferanten aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="97e7e-160">Before we add the Discontinue All Products Button to the FormView s template, let s first add a GridView beneath the FormView that lists the products provided by the selected supplier.</span></span> <span data-ttu-id="97e7e-161">Fügen Sie hierzu der Seite eine GridView hinzu, legen Sie die `ID`-Eigenschaft auf `SuppliersProducts`fest, und fügen Sie eine neue ObjectDataSource mit dem Namen `SuppliersProductsDataSource`hinzu.</span><span class="sxs-lookup"><span data-stu-id="97e7e-161">To accomplish this, add a GridView to the page, set its `ID` property to `SuppliersProducts`, and add a new ObjectDataSource named `SuppliersProductsDataSource`.</span></span>

<span data-ttu-id="97e7e-162">[![erstellen Sie eine neue ObjectDataSource mit dem Namen "suppliersproduczdatasource".](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-162">[![Create a New ObjectDataSource Named SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span></span>

<span data-ttu-id="97e7e-163">**Abbildung 8**: Erstellen einer neuen ObjectDataSource mit dem Namen "`SuppliersProductsDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-163">**Figure 8**: Create a New ObjectDataSource Named `SuppliersProductsDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span></span>

<span data-ttu-id="97e7e-164">Konfigurieren Sie diese ObjectDataSource für die Verwendung der productbll Class s `GetProductsBySupplierID(supplierID)`-Methode (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="97e7e-164">Configure this ObjectDataSource to use the ProductsBLL class s `GetProductsBySupplierID(supplierID)` method (see Figure 9).</span></span> <span data-ttu-id="97e7e-165">Obwohl diese GridView den Preis eines Product s anpassen kann, werden die integrierten Funktionen zum Bearbeiten oder Löschen von GridView nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="97e7e-165">While this GridView will allow for a product s price to be adjusted, it won't be using the built-in editing or deleting features from the GridView.</span></span> <span data-ttu-id="97e7e-166">Daher können wir die Dropdown Liste für die Registerkarten Update, INSERT und DELETE von ObjectDataSource auf (keine) festlegen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-166">Therefore, we can set the drop-down list to (None) for the ObjectDataSource s UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="97e7e-167">[![konfigurieren Sie die Datenquelle für die Verwendung der Methode getproductbysupplierid (SupplierID) der productbll-Klasse.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-167">[![Configure the Data Source to use the ProductsBLL Class s GetProductsBySupplierID(supplierID) Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span></span>

<span data-ttu-id="97e7e-168">**Abbildung 9**: Konfigurieren der Datenquelle für die Verwendung der `GetProductsBySupplierID(supplierID)` Methode der `ProductsBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-168">**Figure 9**: Configure the Data Source to use the `ProductsBLL` Class s `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span></span>

<span data-ttu-id="97e7e-169">Da die `GetProductsBySupplierID(supplierID)`-Methode einen Eingabeparameter akzeptiert, fordert der ObjectDataSource-Assistent die Quelle dieses Parameter Werts an.</span><span class="sxs-lookup"><span data-stu-id="97e7e-169">Since the `GetProductsBySupplierID(supplierID)` method accepts an input parameter, the ObjectDataSource wizard prompts us for the source of this parameter value.</span></span> <span data-ttu-id="97e7e-170">Um den `SupplierID` Wert aus der Form Ansicht zu übergeben, legen Sie die Dropdown Liste Parameter Quelle auf Control und die ControlID-Dropdown Liste auf `Suppliers` (die ID der in Schritt 2 erstellten Form Ansicht) fest.</span><span class="sxs-lookup"><span data-stu-id="97e7e-170">To pass in the `SupplierID` value from the FormView, set the Parameter source drop-down list to Control and the ControlID drop-down list to `Suppliers` (the ID of the FormView created in Step 2).</span></span>

<span data-ttu-id="97e7e-171">[![angeben, dass der SupplierID-Parameter vom Suppliers-FormView-Steuerelement stammen soll.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-171">[![Indicate that the supplierID Parameter Should Come from the Suppliers FormView Control](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span></span>

<span data-ttu-id="97e7e-172">**Abbildung 10**: Geben Sie an, dass der *`supplierID`* Parameter aus dem `Suppliers` FormView-Steuerelement stammen soll ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png)).</span><span class="sxs-lookup"><span data-stu-id="97e7e-172">**Figure 10**: Indicate that the *`supplierID`* Parameter Should Come from the `Suppliers` FormView Control ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span></span>

<span data-ttu-id="97e7e-173">Nachdem Sie den ObjectDataSource-Assistenten abgeschlossen haben, enthält das GridView-Objekt ein BoundField-oder CheckBoxField-Objekt für jedes der Product s-Datenfelder.</span><span class="sxs-lookup"><span data-stu-id="97e7e-173">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product s data fields.</span></span> <span data-ttu-id="97e7e-174">Lassen Sie diese nach unten kürzen, um nur die `ProductName` und `UnitPrice` boundfields zusammen mit dem `Discontinued` CheckBoxField anzuzeigen. Außerdem können Sie das `UnitPrice` BoundField so formatieren, dass sein Text als Währung formatiert ist.</span><span class="sxs-lookup"><span data-stu-id="97e7e-174">Let s trim this down to show just the `ProductName` and `UnitPrice` BoundFields along with the `Discontinued` CheckBoxField; furthermore, let s format the `UnitPrice` BoundField such that its text is formatted as a currency.</span></span> <span data-ttu-id="97e7e-175">Das deklarative Markup von GridView und `SuppliersProductsDataSource` ObjectDataSource s sollte in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="97e7e-175">Your GridView and `SuppliersProductsDataSource` ObjectDataSource s declarative markup should look similar to the following markup:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample3.aspx)]

<span data-ttu-id="97e7e-176">An dieser Stelle zeigt unser Tutorial einen Master-/Detailbericht an, der es dem Benutzer ermöglicht, einen Lieferanten aus der FormView oben auszuwählen und die Produkte anzuzeigen, die von diesem Lieferanten über die GridView im unteren Bereich bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-176">At this point our tutorial displays a master/details report, allowing the user to pick a supplier from the FormView at the top and to view the products provided by that supplier through the GridView at the bottom.</span></span> <span data-ttu-id="97e7e-177">Abbildung 11 zeigt einen Screenshot dieser Seite, wenn Sie den Tokyo Traders-Lieferanten aus der FormView auswählen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-177">Figure 11 shows a screen shot of this page when selecting the Tokyo Traders supplier from the FormView.</span></span>

<span data-ttu-id="97e7e-178">[![die ausgewählten Lieferanten Produkte in der GridView angezeigt werden.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-178">[![The Selected Supplier s Products are Displayed in the GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span></span>

<span data-ttu-id="97e7e-179">**Abbildung 11**: die ausgewählten Lieferanten Produkte werden in der GridView angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-179">**Figure 11**: The Selected Supplier s Products are Displayed in the GridView ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span></span>

## <a name="step-4-creating-dal-and-bll-methods-to-discontinue-all-products-for-a-supplier"></a><span data-ttu-id="97e7e-180">Schritt 4: Erstellen von Dal-und BLL-Methoden, um alle Produkte für einen Lieferanten einzustellen</span><span class="sxs-lookup"><span data-stu-id="97e7e-180">Step 4: Creating DAL and BLL Methods to Discontinue All Products for a Supplier</span></span>

<span data-ttu-id="97e7e-181">Bevor wir der FormView eine Schaltfläche hinzufügen können, die alle Lieferanten Produkte entfernt, wenn darauf geklickt wird, müssen wir der dal und der BLL, die diese Aktion ausführt, zunächst eine Methode hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-181">Before we can add a Button to the FormView that, when clicked, discontinues all of the supplier s products, we first need to add a method to both the DAL and BLL that performs this action.</span></span> <span data-ttu-id="97e7e-182">Insbesondere wird diese Methode mit dem Namen `DiscontinueAllProductsForSupplier(supplierID)`benannt.</span><span class="sxs-lookup"><span data-stu-id="97e7e-182">In particular, this method will be named `DiscontinueAllProductsForSupplier(supplierID)`.</span></span> <span data-ttu-id="97e7e-183">Beim Klicken auf die Schaltfläche FormView s rufen wir diese Methode in der Geschäftslogik Schicht auf und übergeben dabei den ausgewählten Lieferanten s `SupplierID`; die BLL ruft dann die entsprechende Datenzugriffs Schicht-Methode auf, die eine `UPDATE`-Anweisung für die Datenbank ausgibt, die die angegebenen Lieferanten Produkte nicht mehr fortsetzt.</span><span class="sxs-lookup"><span data-stu-id="97e7e-183">When the FormView s Button is clicked, we'll invoke this method in the Business Logic Layer, passing in the selected supplier s `SupplierID`; the BLL will then call down to the corresponding Data Access Layer method, which will issue an `UPDATE` statement to the database that discontinues the specified supplier s products.</span></span>

<span data-ttu-id="97e7e-184">Wie in den vorherigen Tutorials beschrieben, verwenden wir einen Bottom-up-Ansatz, beginnend mit dem Erstellen der dal-Methode, der BLL-Methode und schließlich der Implementierung der Funktionalität auf der ASP.NET-Seite.</span><span class="sxs-lookup"><span data-stu-id="97e7e-184">As we have done in our previous tutorials, we'll use a bottom-up approach, starting with creating the DAL method, then the BLL method, and finally implementing the functionality in the ASP.NET page.</span></span> <span data-ttu-id="97e7e-185">Öffnen Sie das `Northwind.xsd` typisierte DataSet im Ordner `App_Code/DAL`, und fügen Sie dem `ProductsTableAdapter` eine neue Methode hinzu (Klicken Sie mit der rechten Maustaste auf das `ProductsTableAdapter`, und wählen Sie Abfrage hinzufügen).</span><span class="sxs-lookup"><span data-stu-id="97e7e-185">Open the `Northwind.xsd` Typed DataSet in the `App_Code/DAL` folder and add a new method to the `ProductsTableAdapter` (right-click on the `ProductsTableAdapter` and choose Add Query).</span></span> <span data-ttu-id="97e7e-186">Dadurch wird der Konfigurations-Assistent für TableAdapter-Abfragen angezeigt, der uns durch den Prozess des Hinzufügens der neuen Methode führt.</span><span class="sxs-lookup"><span data-stu-id="97e7e-186">Doing so will bring up the TableAdapter Query Configuration wizard, which walks us through the process of adding the new method.</span></span> <span data-ttu-id="97e7e-187">Beginnen Sie mit der Angabe, dass unsere dal-Methode eine Ad-hoc-SQL-Anweisung verwendet.</span><span class="sxs-lookup"><span data-stu-id="97e7e-187">Start by indicating that our DAL method will use an ad-hoc SQL statement.</span></span>

<span data-ttu-id="97e7e-188">[![Erstellen der dal-Methode mithilfe einer Ad-hoc-SQL-Anweisung](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-188">[![Create the DAL Method Using an Ad-Hoc SQL Statement](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span></span>

<span data-ttu-id="97e7e-189">**Abbildung 12**: Erstellen der dal-Methode mithilfe einer Ad-hoc-SQL-Anweisung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-189">**Figure 12**: Create the DAL Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span></span>

<span data-ttu-id="97e7e-190">Im nächsten Schritt werden wir vom Assistenten aufgefordert, den Typ der zu erstellenden Abfrage zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-190">Next, the wizard prompts us as to what type of query to create.</span></span> <span data-ttu-id="97e7e-191">Da die `DiscontinueAllProductsForSupplier(supplierID)`-Methode die `Products` Datenbanktabelle aktualisieren muss, muss das `Discontinued` Feld für alle Produkte, die vom angegebenen *`supplierID`* bereitgestellt werden, auf 1 festgelegt werden. es muss eine Abfrage erstellt werden, mit der Daten aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-191">Since the `DiscontinueAllProductsForSupplier(supplierID)` method will need to update the `Products` database table, setting the `Discontinued` field to 1 for all products provided by the specified *`supplierID`*, we need to create a query that updates data.</span></span>

<span data-ttu-id="97e7e-192">[![wählen Sie den Typ der Update Abfrage aus.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-192">[![Choose the UPDATE Query Type](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span></span>

<span data-ttu-id="97e7e-193">**Abbildung 13**: Auswählen des Abfragetyps "Update" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-193">**Figure 13**: Choose the UPDATE Query Type ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span></span>

<span data-ttu-id="97e7e-194">Der nächste Assistent zeigt den TableAdapter s-`UPDATE`-Anweisung an, die jedes der Felder aktualisiert, die in der `Products` Datentabelle definiert sind.</span><span class="sxs-lookup"><span data-stu-id="97e7e-194">The next wizard screen provides the TableAdapter s existing `UPDATE` statement, which updates each of the fields defined in the `Products` DataTable.</span></span> <span data-ttu-id="97e7e-195">Ersetzen Sie diesen Abfragetext durch die folgende Anweisung:</span><span class="sxs-lookup"><span data-stu-id="97e7e-195">Replace this query text with the following statement:</span></span>

[!code-sql[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample4.sql)]

<span data-ttu-id="97e7e-196">Nachdem Sie diese Abfrage eingegeben und auf "weiter" geklickt haben, werden Sie auf der letzten Seite des Assistenten aufgefordert, den Namen der neuen Methode `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="97e7e-196">After entering this query and clicking Next, the last wizard screen asks for the new method s name use `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="97e7e-197">Beenden Sie den Assistenten durch Klicken auf die Schaltfläche Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-197">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="97e7e-198">Wenn Sie zum DataSet-Designer zurückkehren, sollte in der `ProductsTableAdapter` mit dem Namen `DiscontinueAllProductsForSupplier(@SupplierID)`eine neue Methode angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-198">Upon returning to the DataSet Designer you should see a new method in the `ProductsTableAdapter` named `DiscontinueAllProductsForSupplier(@SupplierID)`.</span></span>

<span data-ttu-id="97e7e-199">[![den Namen der neuen dal-Methode discontinueallproductforsupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-199">[![Name the New DAL Method DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span></span>

<span data-ttu-id="97e7e-200">**Abbildung 14**: Benennen der neuen dal-Methode `DiscontinueAllProductsForSupplier` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-200">**Figure 14**: Name the New DAL Method `DiscontinueAllProductsForSupplier` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span></span>

<span data-ttu-id="97e7e-201">Wenn die `DiscontinueAllProductsForSupplier(supplierID)`-Methode in der Datenzugriffs Ebene erstellt wurde, besteht die nächste Aufgabe darin, die `DiscontinueAllProductsForSupplier(supplierID)`-Methode in der Geschäftslogik Ebene zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-201">With the `DiscontinueAllProductsForSupplier(supplierID)` method created in the Data Access Layer, our next task is to create the `DiscontinueAllProductsForSupplier(supplierID)` method in the Business Logic Layer.</span></span> <span data-ttu-id="97e7e-202">Öffnen Sie hierzu die Datei `ProductsBLL`-Klasse, und fügen Sie Folgendes hinzu:</span><span class="sxs-lookup"><span data-stu-id="97e7e-202">To accomplish this, open the `ProductsBLL` class file and add the following:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample5.vb)]

<span data-ttu-id="97e7e-203">Diese Methode ruft einfach die `DiscontinueAllProductsForSupplier(supplierID)`-Methode in der DAL auf und übergibt den bereitgestellten *`supplierID`* Parameterwert.</span><span class="sxs-lookup"><span data-stu-id="97e7e-203">This method simply calls down to the `DiscontinueAllProductsForSupplier(supplierID)` method in the DAL, passing along the provided *`supplierID`* parameter value.</span></span> <span data-ttu-id="97e7e-204">Wenn Geschäftsregeln vorhanden waren, die nur unter bestimmten Umständen das Unternehmen der Produkte eines Lieferanten waren, sollten diese Regeln hier in der BLL implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-204">If there were any business rules that only allowed a supplier s products to be discontinued under certain circumstances, those rules should be implemented here, in the BLL.</span></span>

> [!NOTE]
> <span data-ttu-id="97e7e-205">Im Gegensatz zu den `UpdateProduct` Überladungen in der `ProductsBLL`-Klasse enthält die Signatur der `DiscontinueAllProductsForSupplier(supplierID)`-Methode das `DataObjectMethodAttribute`-Attribut (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`) nicht.</span><span class="sxs-lookup"><span data-stu-id="97e7e-205">Unlike the `UpdateProduct` overloads in the `ProductsBLL` class, the `DiscontinueAllProductsForSupplier(supplierID)` method signature does not include the `DataObjectMethodAttribute` attribute (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span></span> <span data-ttu-id="97e7e-206">Dadurch wird die `DiscontinueAllProductsForSupplier(supplierID)`-Methode aus der Dropdown Liste Datenquellen-Assistent für Datenquellen konfigurieren von ObjectDataSource auf der Registerkarte Update ausgeschlossen. Dieses Attribut wurde ausgelassen, da wir die `DiscontinueAllProductsForSupplier(supplierID)` Methode direkt von einem Ereignishandler auf unserer ASP.NET-Seite aufrufen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-206">This precludes the `DiscontinueAllProductsForSupplier(supplierID)` method from the ObjectDataSource s Configure Data Source wizard s drop-down list in the UPDATE tab. I ve omitted this attribute because we'll be calling the `DiscontinueAllProductsForSupplier(supplierID)` method directly from an event handler in our ASP.NET page.</span></span>

## <a name="step-5-adding-a-discontinue-all-products-button-to-the-formview"></a><span data-ttu-id="97e7e-207">Schritt 5: Hinzufügen einer Schaltfläche "alle Produkte" zu "FormView"</span><span class="sxs-lookup"><span data-stu-id="97e7e-207">Step 5: Adding a Discontinue All Products Button to the FormView</span></span>

<span data-ttu-id="97e7e-208">Wenn die `DiscontinueAllProductsForSupplier(supplierID)`-Methode in der BLL und Dal abgeschlossen ist, besteht der letzte Schritt zum Hinzufügen der Möglichkeit, alle Produkte für den ausgewählten Lieferanten einzustellen, das Hinzufügen eines Schaltflächen-websteuer Elements zum FormView s-`ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="97e7e-208">With the `DiscontinueAllProductsForSupplier(supplierID)` method in the BLL and DAL complete, the final step for adding the ability to discontinue all products for the selected supplier is to add a Button Web control to the FormView s `ItemTemplate`.</span></span> <span data-ttu-id="97e7e-209">Fügen Sie mit dem Schaltflächen Text unter der Telefonnummer des Lieferanten eine solche Schaltfläche hinzu, und setzen Sie alle Produkte und einen `ID`-Eigenschafts Wert `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="97e7e-209">Let s add such a Button below the supplier s phone number with the button text, Discontinue All Products and an `ID` property value of `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="97e7e-210">Sie können dieses Schaltflächen-websteuer Element über den Designer hinzufügen, indem Sie auf den Link Vorlagen bearbeiten im Smarttag der FormView s (siehe Abbildung 15) oder direkt über die deklarative Syntax klicken.</span><span class="sxs-lookup"><span data-stu-id="97e7e-210">You can add this Button Web control through the Designer by clicking on the Edit Templates link in the FormView s smart tag (see Figure 15), or directly through the declarative syntax.</span></span>

<span data-ttu-id="97e7e-211">[![das Schaltflächen-websteuer Element "alle Produkte" für "FormView s ItemTemplate" hinzufügen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-211">[![Add a Discontinue All Products Button Web Control to the FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span></span>

<span data-ttu-id="97e7e-212">**Abbildung 15**: Hinzufügen eines websteuer Elements mit der Schaltfläche "alle Produkte" in der Form View s `ItemTemplate` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-212">**Figure 15**: Add a Discontinue All Products Button Web Control to the FormView s `ItemTemplate` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span></span>

<span data-ttu-id="97e7e-213">Wenn ein Benutzer auf die Schaltfläche klickt, wird ein Postback und das Formular View s [`ItemCommand`-Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="97e7e-213">When the Button is clicked by a user visiting the page, a postback ensues and the FormView s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.itemcommand.aspx) fires.</span></span> <span data-ttu-id="97e7e-214">Zum Ausführen von benutzerdefiniertem Code als Antwort auf die Schaltfläche, auf die geklickt wird, können wir einen Ereignishandler für dieses Ereignis erstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-214">To execute custom code in response to this Button being clicked, we can create an event handler for this event.</span></span> <span data-ttu-id="97e7e-215">Beachten Sie jedoch, dass das `ItemCommand`-Ereignis ausgelöst wird, wenn in der FormView auf eine Schaltfläche, ein LinkButton oder *ein* ImageButton-websteuer Element geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-215">Understand, though, that the `ItemCommand` event fires whenever *any* Button, LinkButton, or ImageButton Web control is clicked within the FormView.</span></span> <span data-ttu-id="97e7e-216">Dies bedeutet, dass das `ItemCommand` Ereignis ausgelöst wird, wenn der Benutzer in der Form Ansicht von einer Seite zu einem anderen wechselt. Dies ist der Fall, wenn der Benutzer in einer FormView, die das Einfügen, aktualisieren oder löschen unterstützt, auf neu, bearbeiten oder Löschen klickt.</span><span class="sxs-lookup"><span data-stu-id="97e7e-216">That means that when the user moves from one page to another in the FormView, the `ItemCommand` event fires; same thing when the user clicks New, Edit, or Delete in a FormView that supports inserting, updating, or deleting.</span></span>

<span data-ttu-id="97e7e-217">Da der `ItemCommand` unabhängig von der Schaltfläche, auf die geklickt wird, ausgelöst wird, benötigen wir im Ereignishandler eine Methode, um zu bestimmen, ob auf die Schaltfläche Alle Produkte Abbrechen geklickt wurde oder ob es sich um eine andere Schaltfläche handelt</span><span class="sxs-lookup"><span data-stu-id="97e7e-217">Since the `ItemCommand` fires regardless of what button is clicked, in the event handler we need a way to determine if the Discontinue All Products Button was clicked or if it was some other button.</span></span> <span data-ttu-id="97e7e-218">Um dies zu erreichen, können wir das Schaltflächen-websteuer Element s `CommandName`-Eigenschaft auf einen identifizierenden Wert festlegen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-218">To accomplish this, we can set the Button Web control s `CommandName` property to some identifying value.</span></span> <span data-ttu-id="97e7e-219">Wenn auf die Schaltfläche geklickt wird, wird dieser `CommandName` Wert an den `ItemCommand`-Ereignishandler übermittelt, sodass wir bestimmen können, ob auf die Schaltfläche Alle Produkte einstellen geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="97e7e-219">When the Button is clicked, this `CommandName` value is passed into the `ItemCommand` event handler, enabling us to determine whether the Discontinue All Products Button was the button clicked.</span></span> <span data-ttu-id="97e7e-220">Legen Sie die Schaltfläche Alle Produkte einstellen `CommandName` Eigenschaft auf discontinueproducts fest.</span><span class="sxs-lookup"><span data-stu-id="97e7e-220">Set the Discontinue All Products Button s `CommandName` property to DiscontinueProducts .</span></span>

<span data-ttu-id="97e7e-221">Verwenden Sie abschließend ein Client seitiges Dialogfeld bestätigen, um sicherzustellen, dass der Benutzer die Produkte des ausgewählten Lieferanten wirklich einstellen möchte.</span><span class="sxs-lookup"><span data-stu-id="97e7e-221">Finally, let s use a client-side confirm dialog box to ensure that the user really wants to discontinue the selected supplier s products.</span></span> <span data-ttu-id="97e7e-222">Wie im Lernprogramm zum [Hinzufügen von Client seitiger Bestätigung beim Löschen](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) gesehen, kann dies mit etwas JavaScript erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-222">As we saw in the [Adding Client-Side Confirmation When Deleting](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) tutorial, this can be accomplished with a bit of JavaScript.</span></span> <span data-ttu-id="97e7e-223">Legen Sie insbesondere die Eigenschaft OnClientClick des Schaltflächen-websteuer Elements auf `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span><span class="sxs-lookup"><span data-stu-id="97e7e-223">In particular, set the Button Web control s OnClientClick property to `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span></span>

<span data-ttu-id="97e7e-224">Nachdem Sie diese Änderungen vorgenommen haben, sollte die deklarative Syntax von FormView s wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="97e7e-224">After making these changes, the FormView s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample6.aspx)]

<span data-ttu-id="97e7e-225">Erstellen Sie als nächstes einen Ereignishandler für das Ereignis "FormView s `ItemCommand`".</span><span class="sxs-lookup"><span data-stu-id="97e7e-225">Next, create an event handler for the FormView s `ItemCommand` event.</span></span> <span data-ttu-id="97e7e-226">In diesem Ereignishandler muss zuerst festgestellt werden, ob auf die Schaltfläche Alle Produkte Abbrechen geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="97e7e-226">In this event handler we need to first determine whether the Discontinue All Products Button was clicked.</span></span> <span data-ttu-id="97e7e-227">Wenn dies der Fall ist, möchten wir eine Instanz der `ProductsBLL` Klasse erstellen und ihre `DiscontinueAllProductsForSupplier(supplierID)`-Methode aufrufen, indem wir die `SupplierID` der ausgewählten FormView übergeben:</span><span class="sxs-lookup"><span data-stu-id="97e7e-227">If so, we want to create an instance of the `ProductsBLL` class and invoke its `DiscontinueAllProductsForSupplier(supplierID)` method, passing in the `SupplierID` of the selected FormView:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample7.vb)]

<span data-ttu-id="97e7e-228">Beachten Sie, dass der Zugriff auf die `SupplierID` des aktuellen ausgewählten Lieferanten in FormView mithilfe der FormView s [`SelectedValue`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx)möglich ist.</span><span class="sxs-lookup"><span data-stu-id="97e7e-228">Note that the `SupplierID` of the current selected supplier in the FormView can be accessed using the FormView s [`SelectedValue` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span></span> <span data-ttu-id="97e7e-229">Die `SelectedValue`-Eigenschaft gibt den ersten Datenschlüssel Wert für den Datensatz zurück, der in der FormView angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-229">The `SelectedValue` property returns the first data key value for the record being displayed in the FormView.</span></span> <span data-ttu-id="97e7e-230">Die FormView s [`DataKeyNames`-Eigenschaft](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), die die Datenfelder angibt, aus denen die Datenschlüssel Werte abgerufen werden, wurde automatisch auf `SupplierID` von Visual Studio festgelegt, wenn die ObjectDataSource an die FormView zurück in Schritt 2 gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-230">The FormView s [`DataKeyNames` property](https://msdn.microsoft.com/system.web.ui.webcontrols.formview.datakeynames.aspx), which indicates the data fields from which the data key values are pulled from, was automatically set to `SupplierID` by Visual Studio when binding the ObjectDataSource to the FormView back in Step 2.</span></span>

<span data-ttu-id="97e7e-231">Wenn der `ItemCommand`-Ereignishandler erstellt wurde, nehmen Sie sich einen Moment Zeit, um die Seite zu testen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-231">With the `ItemCommand` event handler created, take a moment to test out the page.</span></span> <span data-ttu-id="97e7e-232">Navigieren Sie zum Lieferanten von "Cooperativa de Quesos" las Cabras "(es ist der fünfte Lieferant in der FormView für mich).</span><span class="sxs-lookup"><span data-stu-id="97e7e-232">Browse to the Cooperativa de Quesos 'Las Cabras' supplier (it s the fifth supplier in the FormView for me).</span></span> <span data-ttu-id="97e7e-233">Dieser Lieferant stellt zwei Produkte bereit: Queso Cabrales und Queso mandego La Pastora, die beide *nicht* eingestellt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-233">This supplier provides two products, Queso Cabrales and Queso Manchego La Pastora, both of which are *not* discontinued.</span></span>

<span data-ttu-id="97e7e-234">Stellen Sie sich vor, dass kooperative ATIVA de Quesos "las Cabras" aus dem Unternehmen entfernt wurde und daher die Produkte eingestellt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-234">Imagine that Cooperativa de Quesos 'Las Cabras' has gone out of business and therefore its products are to be discontinued.</span></span> <span data-ttu-id="97e7e-235">Klicken Sie auf die Schaltfläche Alle Produkte einstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-235">Click the Discontinue All Products Button.</span></span> <span data-ttu-id="97e7e-236">Dadurch wird das Dialogfeld Client seitiges bestätigen angezeigt (siehe Abbildung 16).</span><span class="sxs-lookup"><span data-stu-id="97e7e-236">This will display the client-side confirm dialog box (see Figure 16).</span></span>

<span data-ttu-id="97e7e-237">[![Cooperativa de Quesos las Cabras liefert zwei aktive Produkte](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-237">[![Cooperativa de Quesos Las Cabras Supplies Two Active Products](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span></span>

<span data-ttu-id="97e7e-238">**Abbildung 16**: Kooperativa de Quesos las Cabras stellt zwei aktive Produkte bereit ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-238">**Figure 16**: Cooperativa de Quesos Las Cabras Supplies Two Active Products ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span></span>

<span data-ttu-id="97e7e-239">Wenn Sie im Dialogfeld Client seitige Bestätigung auf OK klicken, wird die Übermittlung des Formulars fortgesetzt. Dies führt zu einem Postback, bei dem das FormView s `ItemCommand`-Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-239">If you click OK in the client-side confirm dialog box, the form submission will proceed, causing a postback in which the FormView s `ItemCommand` event will fire.</span></span> <span data-ttu-id="97e7e-240">Der von uns erstellte Ereignishandler wird dann ausgeführt, wobei die `DiscontinueAllProductsForSupplier(supplierID)`-Methode aufgerufen und sowohl die Queso-Cabrales-als auch die Queso-Klasse "Pastora" nicht mehr fortgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-240">The event handler we created will then execute, invoking the `DiscontinueAllProductsForSupplier(supplierID)` method and discontinuing both the Queso Cabrales and Queso Manchego La Pastora products.</span></span>

<span data-ttu-id="97e7e-241">Wenn Sie den Ansichts Zustand von GridView deaktiviert haben, wird die GridView bei jedem Postback an den zugrunde liegenden Datenspeicher zurückgegeben und wird daher sofort aktualisiert, um anzuzeigen, dass diese beiden Produkte nun eingestellt werden (siehe Abbildung 17).</span><span class="sxs-lookup"><span data-stu-id="97e7e-241">If you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect that these two products are now discontinued (see Figure 17).</span></span> <span data-ttu-id="97e7e-242">Wenn Sie jedoch den Ansichts Zustand in der GridView nicht deaktiviert haben, müssen Sie die Daten nach dem vornehmen der Änderung manuell an die GridView-Ansicht binden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-242">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="97e7e-243">Um dies zu erreichen, führen Sie einfach nach dem Aufrufen der `DiscontinueAllProductsForSupplier(supplierID)`-Methode einen Aufruf an die GridView s `DataBind()`-Methode aus.</span><span class="sxs-lookup"><span data-stu-id="97e7e-243">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `DiscontinueAllProductsForSupplier(supplierID)` method.</span></span>

<span data-ttu-id="97e7e-244">[![nach dem Klicken auf die Schaltfläche Alle Produkte einstellen werden die Produkte der Lieferanten Produkte entsprechend aktualisiert.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-244">[![After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span></span>

<span data-ttu-id="97e7e-245">**Abbildung 17**: nach dem Klicken auf die Schaltfläche Alle Produkte einstellen werden die Produkte der Lieferanten Produkte entsprechend aktualisiert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-245">**Figure 17**: After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span></span>

## <a name="step-6-creating-an-updateproduct-overload-in-the-business-logic-layer-for-adjusting-a-product-s-price"></a><span data-ttu-id="97e7e-246">Schritt 6: Erstellen einer UpdateProduct-Überladung in der Geschäftslogik Schicht zum Anpassen eines Product s Preises</span><span class="sxs-lookup"><span data-stu-id="97e7e-246">Step 6: Creating an UpdateProduct Overload in the Business Logic Layer for Adjusting a Product s Price</span></span>

<span data-ttu-id="97e7e-247">Wie bei der Schaltfläche Alle Produkte einstellen in FormView müssen Sie zum Hinzufügen von Schaltflächen zum erhöhen und verringern des Preises für ein Produkt in der GridView zunächst die entsprechenden Methoden für die Datenzugriffs Ebene und die Geschäftslogik Schicht hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-247">Like with the Discontinue All Products Button in the FormView, in order to add buttons for increasing and decreasing the price for a product in the GridView we need to first add the appropriate Data Access Layer and Business Logic Layer methods.</span></span> <span data-ttu-id="97e7e-248">Da wir bereits über eine Methode verfügen, die eine einzelne Produkt Zeile in der dal aktualisiert, können wir eine solche Funktionalität bereitstellen, indem wir eine neue Überladung für die `UpdateProduct`-Methode in der BLL erstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-248">Since we already have a method that updates a single product row in the DAL, we can provide such functionality by creating a new overload for the `UpdateProduct` method in the BLL.</span></span>

<span data-ttu-id="97e7e-249">Unsere bisherigen `UpdateProduct` Überladungen haben einige Kombinationen von Produkt Feldern als skalare Eingabewerte übernommen und dann nur die Felder für das angegebene Produkt aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="97e7e-249">Our past `UpdateProduct` overloads have taken in some combination of product fields as scalar input values and have then updated just those fields for the specified product.</span></span> <span data-ttu-id="97e7e-250">Bei dieser Überladung variieren wir geringfügig von diesem Standard und übergeben stattdessen die Product s `ProductID` und den Prozentsatz, um den die `UnitPrice` angepasst werden soll (im Gegensatz zur Übergabe der neuen, angepassten `UnitPrice` selbst).</span><span class="sxs-lookup"><span data-stu-id="97e7e-250">For this overload we'll vary slightly from this standard and instead pass in the product s `ProductID` and the percentage by which to adjust the `UnitPrice` (as opposed to passing in the new, adjusted `UnitPrice` itself).</span></span> <span data-ttu-id="97e7e-251">Diese Vorgehensweise vereinfacht den Code, den wir in der Code Behind-Klasse der ASP.NET-Seite schreiben müssen, da wir uns nicht mit der Bestimmung der aktuellen Product s `UnitPrice`beschäftigen müssen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-251">This approach will simplify the code we need to write in the ASP.NET page code-behind class, since we don t have to bother with determining the current product s `UnitPrice`.</span></span>

<span data-ttu-id="97e7e-252">Die `UpdateProduct` Überladung für dieses Tutorial wird unten dargestellt:</span><span class="sxs-lookup"><span data-stu-id="97e7e-252">The `UpdateProduct` overload for this tutorial is shown below:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample8.vb)]

<span data-ttu-id="97e7e-253">Diese Überladung ruft Informationen über das angegebene Produkt über die DAL s-`GetProductByProductID(productID)`-Methode ab.</span><span class="sxs-lookup"><span data-stu-id="97e7e-253">This overload retrieves information about the specified product through the DAL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="97e7e-254">Anschließend wird überprüft, ob dem Product s `UnitPrice` eine Datenbank `NULL` Wert zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-254">It then checks to see whether the product s `UnitPrice` is assigned a database `NULL` value.</span></span> <span data-ttu-id="97e7e-255">Wenn dies der Fall ist, bleibt der Preis unverändert.</span><span class="sxs-lookup"><span data-stu-id="97e7e-255">If it is, the price is left unaltered.</span></span> <span data-ttu-id="97e7e-256">Wenn jedoch ein nicht`NULL` `UnitPrice` Wert vorhanden ist, aktualisiert die-Methode die Produkt-s `UnitPrice` um den angegebenen Prozentsatz (`unitPriceAdjustmentPercent`).</span><span class="sxs-lookup"><span data-stu-id="97e7e-256">If, however, there is a non-`NULL` `UnitPrice` value, the method updates the product s `UnitPrice` by the specified percent (`unitPriceAdjustmentPercent`).</span></span>

## <a name="step-7-adding-the-increase-and-decrease-buttons-to-the-gridview"></a><span data-ttu-id="97e7e-257">Schritt 7: Hinzufügen der Schaltflächen "vergrößern" und "verringern" zur GridView</span><span class="sxs-lookup"><span data-stu-id="97e7e-257">Step 7: Adding the Increase and Decrease Buttons to the GridView</span></span>

<span data-ttu-id="97e7e-258">Die GridView (und DetailsView) bestehen aus einer Auflistung von Feldern.</span><span class="sxs-lookup"><span data-stu-id="97e7e-258">The GridView (and DetailsView) are both made up of a collection of fields.</span></span> <span data-ttu-id="97e7e-259">Zusätzlich zu boundfields, checkboxfields und templatefields enthält ASP.NET das Button Field, das, wie der Name schon sagt, als Spalte mit einer Schaltfläche, einem LinkButton oder einem ImageButton für jede Zeile gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-259">In addition to BoundFields, CheckBoxFields, and TemplateFields, ASP.NET includes the ButtonField, which, as its name implies, renders as a column with a Button, LinkButton, or ImageButton for each row.</span></span> <span data-ttu-id="97e7e-260">Ähnlich wie bei der FormView führt das Klicken auf eine *beliebige* Schaltfläche in den GridView-Pagingschaltflächen, das Bearbeiten oder Löschen von Schaltflächen, das Sortieren von Schaltflächen usw. zu einem Postback und löst das [`RowCommand` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)GridView s aus.</span><span class="sxs-lookup"><span data-stu-id="97e7e-260">Similar to the FormView, clicking *any* button within the GridView paging buttons, Edit or Delete buttons, sorting buttons, and so on causes a postback and raises the GridView s [`RowCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span></span>

<span data-ttu-id="97e7e-261">Das ButtonField-Objekt verfügt über eine `CommandName`-Eigenschaft, die den angegebenen Wert den einzelnen Schaltflächen `CommandName` Eigenschaften zuweist.</span><span class="sxs-lookup"><span data-stu-id="97e7e-261">The ButtonField has a `CommandName` property that assigns the specified value to each of its Buttons `CommandName` properties.</span></span> <span data-ttu-id="97e7e-262">Wie bei der FormView wird der `CommandName` Wert vom `RowCommand`-Ereignishandler verwendet, um zu bestimmen, auf welche Schaltfläche geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="97e7e-262">Like with the FormView, the `CommandName` value is used by the `RowCommand` event handler to determine which button was clicked.</span></span>

<span data-ttu-id="97e7e-263">Fügen Sie der GridView zwei neue Schaltflächen hinzu, eine mit einem Schaltflächen-textpreis + 10% und die andere mit dem Text Price-10%.</span><span class="sxs-lookup"><span data-stu-id="97e7e-263">Let s add two new ButtonFields to the GridView, one with a button text Price +10% and the other with the text Price -10%.</span></span> <span data-ttu-id="97e7e-264">Wenn Sie diese Schaltflächen hinzufügen möchten, klicken Sie auf den Link Spalten bearbeiten im GridView s-Smarttag, wählen Sie in der Liste in der oberen linken Ecke den Feldtyp ButtonField aus, und klicken Sie auf die Schaltfläche hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-264">To add these ButtonFields, click on the Edit Columns link from the GridView s smart tag, select the ButtonField field type from the list in the upper left and click the Add button.</span></span>

![Fügen Sie der GridView zwei buttonfields-Felder hinzu.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image48.png)

<span data-ttu-id="97e7e-266">**Abbildung 18**: Hinzufügen von zwei buttonfields zur GridView</span><span class="sxs-lookup"><span data-stu-id="97e7e-266">**Figure 18**: Add Two ButtonFields to the GridView</span></span>

<span data-ttu-id="97e7e-267">Verschieben Sie die beiden buttonfields, sodass Sie als die ersten beiden GridView-Felder angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-267">Move the two ButtonFields so that they appear as the first two GridView fields.</span></span> <span data-ttu-id="97e7e-268">Legen Sie als nächstes die `Text` Eigenschaften dieser beiden Button Fields auf Price + 10% und Price-10% fest, und legen Sie die `CommandName`-Eigenschaften auf "Erhöhung Price" bzw. "dekreaseprice" fest.</span><span class="sxs-lookup"><span data-stu-id="97e7e-268">Next, set the `Text` properties of these two ButtonFields to Price +10% and Price -10% and the `CommandName` properties to IncreasePrice and DecreasePrice, respectively.</span></span> <span data-ttu-id="97e7e-269">Standardmäßig rendert ein ButtonField seine Spalte mit Schaltflächen als LinkButtons.</span><span class="sxs-lookup"><span data-stu-id="97e7e-269">By default, a ButtonField renders its column of buttons as LinkButtons.</span></span> <span data-ttu-id="97e7e-270">Dies kann jedoch über die Button Field s- [`ButtonType`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx)geändert werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-270">This can be changed, however, through the ButtonField s [`ButtonType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span></span> <span data-ttu-id="97e7e-271">Lassen Sie zu, dass diese beiden Schaltflächen als reguläre pushschaltflächen gerendert werden. Legen Sie daher die `ButtonType`-Eigenschaft auf `Button`fest.</span><span class="sxs-lookup"><span data-stu-id="97e7e-271">Let s have these two ButtonFields rendered as regular push buttons; therefore, set the `ButtonType` property to `Button`.</span></span> <span data-ttu-id="97e7e-272">Abbildung 19 zeigt das Dialogfeld "Felder", nachdem diese Änderungen vorgenommen wurden. Im folgenden wird das deklarative Markup von GridView s angezeigt.</span><span class="sxs-lookup"><span data-stu-id="97e7e-272">Figure 19 shows the Fields dialog box after these changes have been made; following that is the GridView s declarative markup.</span></span>

![Konfigurieren der Eigenschaften Button Fields Text, CommandName und ButtonType](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image49.png)

<span data-ttu-id="97e7e-274">**Abbildung 19**: Konfigurieren der Eigenschaften Button Fields `Text`, `CommandName`und `ButtonType`</span><span class="sxs-lookup"><span data-stu-id="97e7e-274">**Figure 19**: Configure the ButtonFields `Text`, `CommandName`, and `ButtonType` Properties</span></span>

[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample9.aspx)]

<span data-ttu-id="97e7e-275">Wenn diese buttonfields erstellt wurden, ist der letzte Schritt das Erstellen eines Ereignis Handlers für das GridView s `RowCommand`-Ereignis.</span><span class="sxs-lookup"><span data-stu-id="97e7e-275">With these ButtonFields created, the final step is to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="97e7e-276">Wenn Sie auf die Schaltflächen "Preis + 10%" oder "Preis-10%" geklickt haben, muss dieser Ereignishandler die `ProductID` für die Zeile ermitteln, auf deren Schaltfläche geklickt wurde, und dann die `ProductsBLL` Class-`UpdateProduct`-Methode aufrufen und dabei die entsprechende `UnitPrice` Prozentsatz Anpassung zusammen mit der `ProductID`übergeben.</span><span class="sxs-lookup"><span data-stu-id="97e7e-276">This event handler, if fired because either the Price +10% or Price -10% buttons were clicked, needs to determine the `ProductID` for the row whose button was clicked and then invoke the `ProductsBLL` class s `UpdateProduct` method, passing in the appropriate `UnitPrice` percentage adjustment along with the `ProductID`.</span></span> <span data-ttu-id="97e7e-277">Der folgende Code führt diese Aufgaben aus:</span><span class="sxs-lookup"><span data-stu-id="97e7e-277">The following code performs these tasks:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample10.vb)]

<span data-ttu-id="97e7e-278">Um die `ProductID` für die Zeile zu ermitteln, deren Preis + 10% oder die Schaltfläche "Price-10%" angeklickt wurde, müssen wir die `DataKeys` Auflistung der GridView s.</span><span class="sxs-lookup"><span data-stu-id="97e7e-278">In order to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we need to consult the GridView s `DataKeys` collection.</span></span> <span data-ttu-id="97e7e-279">Diese Auflistung enthält die Werte der Felder, die in der `DataKeyNames`-Eigenschaft für jede GridView-Zeile angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-279">This collection holds the values of the fields specified in the `DataKeyNames` property for each GridView row.</span></span> <span data-ttu-id="97e7e-280">Da die Eigenschaft "GridView s `DataKeyNames`" von Visual Studio auf "ProductID" festgelegt wurde, wenn die ObjectDataSource an die GridView gebunden wurde, stellt `DataKeys(rowIndex).Value` den `ProductID` für den angegebenen *rowIndex*bereit.</span><span class="sxs-lookup"><span data-stu-id="97e7e-280">Since the GridView s `DataKeyNames` property was set to ProductID by Visual Studio when binding the ObjectDataSource to the GridView, `DataKeys(rowIndex).Value` provides the `ProductID` for the specified *rowIndex*.</span></span>

<span data-ttu-id="97e7e-281">Das ButtonField übergibt automatisch den *rowIndex* der Zeile, deren Schaltfläche durch den `e.CommandArgument`-Parameter geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="97e7e-281">The ButtonField automatically passes in the *rowIndex* of the row whose button was clicked through the `e.CommandArgument` parameter.</span></span> <span data-ttu-id="97e7e-282">Zum Ermitteln der `ProductID` für die Zeile, auf die die Schaltfläche Price + 10% oder Price-10% geklickt wurde, wird daher: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`verwendet.</span><span class="sxs-lookup"><span data-stu-id="97e7e-282">Therefore, to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we use: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span></span>

<span data-ttu-id="97e7e-283">Wenn Sie den Ansichts Zustand von GridView (alle Produkte) deaktiviert haben, wird die GridView bei jedem Postback an den zugrunde liegenden Datenspeicher zurückgegeben und daher sofort aktualisiert, um eine Preisänderung zu berücksichtigen, die durch Klicken auf eine der Schaltflächen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-283">As with the Discontinue All Products button, if you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect a price change that occurs from clicking either of the buttons.</span></span> <span data-ttu-id="97e7e-284">Wenn Sie jedoch den Ansichts Zustand in der GridView nicht deaktiviert haben, müssen Sie die Daten nach dem vornehmen der Änderung manuell an die GridView-Ansicht binden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-284">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="97e7e-285">Um dies zu erreichen, führen Sie einfach nach dem Aufrufen der `UpdateProduct`-Methode einen Aufruf an die GridView s `DataBind()`-Methode aus.</span><span class="sxs-lookup"><span data-stu-id="97e7e-285">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `UpdateProduct` method.</span></span>

<span data-ttu-id="97e7e-286">Abbildung 20 zeigt die Seite, wenn Sie die Produkte anzeigen, die von Oma Kelly Homestead bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-286">Figure 20 shows the page when viewing the products provided by Grandma Kelly's Homestead.</span></span> <span data-ttu-id="97e7e-287">In Abbildung 21 werden die Ergebnisse angezeigt, nachdem auf die Schaltfläche Price + 10% zweimal geklickt wurde, um die boysenberry-Verteilung von Oma und die Schaltfläche Price-10% einmal für Northwoods Cranberry-Sauce anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-287">Figure 21 shows the results after the Price +10% button has been clicked twice for Grandma's Boysenberry Spread and the Price -10% button once for Northwoods Cranberry Sauce.</span></span>

<span data-ttu-id="97e7e-288">[![die GridView-Schaltflächen Preis + 10% und Preis-10% enthält.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-288">[![The GridView Includes Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span></span>

<span data-ttu-id="97e7e-289">**Abbildung 20**: GridView enthält die Schaltflächen Price + 10% und Price-10% ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="97e7e-289">**Figure 20**: The GridView Includes Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span></span>

<span data-ttu-id="97e7e-290">[![die Preise für das erste und dritte Produkt über die Schaltflächen Price + 10% und Price-10% aktualisiert.](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="97e7e-290">[![The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span></span>

<span data-ttu-id="97e7e-291">**Abbildung 21**: die Preise für das erste und dritte Produkt wurden über die Schaltflächen Price + 10% und Price-10% aktualisiert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png)).</span><span class="sxs-lookup"><span data-stu-id="97e7e-291">**Figure 21**: The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span></span>

> [!NOTE]
> <span data-ttu-id="97e7e-292">Der GridView (und DetailsView) können auch Schaltflächen, LinkButtons oder imagebuttons hinzugefügt werden, die zu ihren templatefields-Vorlagen hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="97e7e-292">The GridView (and DetailsView) can also have Buttons, LinkButtons, or ImageButtons added to their TemplateFields.</span></span> <span data-ttu-id="97e7e-293">Wie bei dem BoundField auslösen diese Schaltflächen, wenn darauf geklickt wird, ein Postback, wodurch das GridView s `RowCommand`-Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="97e7e-293">As with the BoundField, these Buttons, when clicked, will induce a postback, raising the GridView s `RowCommand` event.</span></span> <span data-ttu-id="97e7e-294">Beim Hinzufügen von Schaltflächen in einem TemplateField wird die Schaltfläche s `CommandArgument` jedoch nicht automatisch auf den Index der Zeile festgelegt, wie es bei Verwendung von Button Fields der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="97e7e-294">When adding buttons in a TemplateField, however, the Button s `CommandArgument` is not automatically set to the index of the row as it is when using ButtonFields.</span></span> <span data-ttu-id="97e7e-295">Wenn Sie den Zeilen Index der Schaltfläche ermitteln müssen, auf die innerhalb des `RowCommand` Ereignis Handlers geklickt wurde, müssen Sie die Schaltfläche s `CommandArgument` Eigenschaft in der deklarativen Syntax in TemplateField manuell mithilfe von Code wie dem folgenden festlegen:</span><span class="sxs-lookup"><span data-stu-id="97e7e-295">If you need to determine the row index of the button that was clicked within the `RowCommand` event handler, you'll need to manually set the Button s `CommandArgument` property in its declarative syntax within the TemplateField, using code like:</span></span>  
> <span data-ttu-id="97e7e-296">[https://login.microsoftonline.com/consumers/](`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`).</span><span class="sxs-lookup"><span data-stu-id="97e7e-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span></span>

## <a name="summary"></a><span data-ttu-id="97e7e-297">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="97e7e-297">Summary</span></span>

<span data-ttu-id="97e7e-298">Die Steuerelemente GridView, DetailsView und FormView können alle Schaltflächen, LinkButtons oder imagebuttons enthalten.</span><span class="sxs-lookup"><span data-stu-id="97e7e-298">The GridView, DetailsView, and FormView controls all can include Buttons, LinkButtons, or ImageButtons.</span></span> <span data-ttu-id="97e7e-299">Wenn Sie auf diese Schaltflächen klicken, wird ein Postback ausgelöst und das `ItemCommand`-Ereignis in den Steuerelementen FormView und DetailsView sowie das `RowCommand`-Ereignis in der GridView ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="97e7e-299">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event in the FormView and DetailsView controls and the `RowCommand` event in the GridView.</span></span> <span data-ttu-id="97e7e-300">Diese datenweb Steuerelemente verfügen über integrierte Funktionen zum Verarbeiten allgemeiner Befehls bezogener Aktionen, wie z. b. das Löschen oder Bearbeiten von Datensätzen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-300">These data Web controls have built-in functionality to handle common command-related actions, such as deleting or editing records.</span></span> <span data-ttu-id="97e7e-301">Wir können jedoch auch Schaltflächen verwenden, die beim Klicken auf die Ausführung unseres eigenen benutzerdefinierten Codes reagieren.</span><span class="sxs-lookup"><span data-stu-id="97e7e-301">However, we can also use buttons that, when clicked, respond with executing our own custom code.</span></span>

<span data-ttu-id="97e7e-302">Um dies zu erreichen, müssen wir einen Ereignishandler für das `ItemCommand`-oder `RowCommand`-Ereignis erstellen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-302">To accomplish this, we need to create an event handler for the `ItemCommand` or `RowCommand` event.</span></span> <span data-ttu-id="97e7e-303">In diesem Ereignishandler überprüfen wir zuerst den Wert eingehender `CommandName`, um zu bestimmen, auf welche Schaltfläche geklickt wurde, und dann die entsprechende benutzerdefinierte Aktion auszuführen.</span><span class="sxs-lookup"><span data-stu-id="97e7e-303">In this event handler we first check the incoming `CommandName` value to determine which button was clicked and then take appropriate custom action.</span></span> <span data-ttu-id="97e7e-304">In diesem Tutorial haben Sie erfahren, wie Sie mithilfe von Schaltflächen und buttonfields alle Produkte für einen bestimmten Lieferanten einstellen oder den Preis eines bestimmten Produkts um 10% erhöhen oder verringern.</span><span class="sxs-lookup"><span data-stu-id="97e7e-304">In this tutorial we saw how to use buttons and ButtonFields to discontinue all products for a specified supplier or to increase or decrease the price of a particular product by 10%.</span></span>

<span data-ttu-id="97e7e-305">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="97e7e-305">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="97e7e-306">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="97e7e-306">About the Author</span></span>

<span data-ttu-id="97e7e-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="97e7e-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="97e7e-308">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="97e7e-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="97e7e-309">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="97e7e-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="97e7e-310">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="97e7e-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="97e7e-311">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="97e7e-311">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="97e7e-312">Previous</span><span class="sxs-lookup"><span data-stu-id="97e7e-312">Previous</span></span>](adding-and-responding-to-buttons-to-a-gridview-cs.md)
