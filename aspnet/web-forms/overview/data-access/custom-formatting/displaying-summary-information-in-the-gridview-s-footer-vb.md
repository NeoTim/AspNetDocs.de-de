---
uid: web-forms/overview/data-access/custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb
title: Anzeigen von Zusammenfassungs Informationen im GridView-Footer (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Zusammenfassungs Informationen werden häufig im unteren Bereich des Berichts in einer Zusammenfassungs Zeile angezeigt. Das GridView-Steuerelement kann eine Footerzeile enthalten, in deren Zellen wir PR haben können...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 41c818b7-603a-402b-8847-890a63547b6f
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: c208b4a756f5700be46eec924d8cf8f49b9d2507
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78482079"
---
# <a name="displaying-summary-information-in-the-gridviews-footer-vb"></a><span data-ttu-id="a85c5-104">Anzeigen von Zusammenfassungsinformationen im GridView-Fuß (VB)</span><span class="sxs-lookup"><span data-stu-id="a85c5-104">Displaying Summary Information in the GridView's Footer (VB)</span></span>

<span data-ttu-id="a85c5-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a85c5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a85c5-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_15_VB.exe) oder [PDF herunterladen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/datatutorial15vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a85c5-106">[Download Sample App](https://download.microsoft.com/download/5/7/0/57084608-dfb3-4781-991c-407d086e2adc/ASPNET_Data_Tutorial_15_VB.exe) or [Download PDF](displaying-summary-information-in-the-gridview-s-footer-vb/_static/datatutorial15vb1.pdf)</span></span>

> <span data-ttu-id="a85c5-107">Zusammenfassungs Informationen werden häufig im unteren Bereich des Berichts in einer Zusammenfassungs Zeile angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a85c5-107">Summary information is often displayed at the bottom of the report in a summary row.</span></span> <span data-ttu-id="a85c5-108">Das GridView-Steuerelement kann eine Footerzeile enthalten, in deren Zellen wir Programm gesteuert Aggregatdaten einfügen können.</span><span class="sxs-lookup"><span data-stu-id="a85c5-108">The GridView control can include a footer row into whose cells we can programmatically inject aggregate data.</span></span> <span data-ttu-id="a85c5-109">In diesem Tutorial wird erläutert, wie Aggregatdaten in dieser Footerzeile angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-109">In this tutorial we'll see how to display aggregate data in this footer row.</span></span>

## <a name="introduction"></a><span data-ttu-id="a85c5-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="a85c5-110">Introduction</span></span>

<span data-ttu-id="a85c5-111">Zusätzlich zum Anzeigen der Preise der Produkte, Einheiten in Aktien, Einheiten in der Bestellung und Neuanordnung der Ebenen kann ein Benutzer auch an Aggregat Informationen interessiert sein, z. b. den Durchschnittspreis, die Gesamtzahl der Einheiten im Lager usw.</span><span class="sxs-lookup"><span data-stu-id="a85c5-111">In addition to seeing each of the products' prices, units in stock, units on order, and reorder levels, a user might also be interested in aggregate information, such as the average price, the total number of units in stock, and so on.</span></span> <span data-ttu-id="a85c5-112">Diese Zusammenfassungs Informationen werden häufig in einer Zusammenfassungs Zeile unten im Bericht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a85c5-112">Such summary information is often displayed at the bottom of the report in a summary row.</span></span> <span data-ttu-id="a85c5-113">Das GridView-Steuerelement kann eine Footerzeile enthalten, in deren Zellen wir Programm gesteuert Aggregatdaten einfügen können.</span><span class="sxs-lookup"><span data-stu-id="a85c5-113">The GridView control can include a footer row into whose cells we can programmatically inject aggregate data.</span></span>

<span data-ttu-id="a85c5-114">Diese Aufgabe stellt drei Herausforderungen dar:</span><span class="sxs-lookup"><span data-stu-id="a85c5-114">This task presents us with three challenges:</span></span>

1. <span data-ttu-id="a85c5-115">Konfigurieren der GridView zum Anzeigen der Footerzeile</span><span class="sxs-lookup"><span data-stu-id="a85c5-115">Configuring the GridView to display its footer row</span></span>
2. <span data-ttu-id="a85c5-116">Bestimmen der Zusammenfassungs Daten; Das heißt, wie berechnen wir den Durchschnittspreis oder die Summe der Einheiten im Lager?</span><span class="sxs-lookup"><span data-stu-id="a85c5-116">Determining the summary data; that is, how do we compute the average price or the total of the units in stock?</span></span>
3. <span data-ttu-id="a85c5-117">Einfügen der Zusammenfassungs Daten in die entsprechenden Zellen der Footerzeile</span><span class="sxs-lookup"><span data-stu-id="a85c5-117">Injecting the summary data into the appropriate cells of the footer row</span></span>

<span data-ttu-id="a85c5-118">In diesem Tutorial erfahren Sie, wie Sie diese Herausforderungen meistern können.</span><span class="sxs-lookup"><span data-stu-id="a85c5-118">In this tutorial we'll see how to overcome these challenges.</span></span> <span data-ttu-id="a85c5-119">Insbesondere erstellen wir eine Seite, die die Kategorien in einer Dropdown Liste mit den in einer GridView angezeigten Produkten der ausgewählten Kategorie auflistet.</span><span class="sxs-lookup"><span data-stu-id="a85c5-119">Specifically, we'll create a page that lists the categories in a drop-down list with the selected category's products displayed in a GridView.</span></span> <span data-ttu-id="a85c5-120">Die GridView enthält eine Footerzeile, in der der Durchschnittspreis und die Gesamtzahl der Einheiten in der Bestellung und die Reihenfolge der Produkte in dieser Kategorie angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-120">The GridView will include a footer row that shows the average price and total number of units in stock and on order for products in that category.</span></span>

<span data-ttu-id="a85c5-121">[![Zusammenfassungs Informationen werden in der Fußzeile der GridView angezeigt.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image2.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-121">[![Summary Information is Displayed in the GridView's Footer Row](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image2.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="a85c5-122">**Abbildung 1**: zusammenfassende Informationen werden in der Fußzeile der GridView angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-122">**Figure 1**: Summary Information is Displayed in the GridView's Footer Row ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image3.png))</span></span>

<span data-ttu-id="a85c5-123">In diesem Tutorial mit der Kategorie "Produkte Master/Detail Interface" werden die Konzepte erläutert, die in der vorherigen [Master/Detail-Filterung mit einem DropDownList-](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) Tutorial behandelt wurden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-123">This tutorial, with its category to products master/detail interface, builds upon the concepts covered in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) tutorial.</span></span> <span data-ttu-id="a85c5-124">Wenn Sie noch nicht mit dem vorherigen Tutorial gearbeitet haben, sollten Sie dies tun, bevor Sie mit diesem Tutorial fortfahren.</span><span class="sxs-lookup"><span data-stu-id="a85c5-124">If you've not yet worked through the earlier tutorial, please do so before continuing on with this one.</span></span>

## <a name="step-1-adding-the-categories-dropdownlist-and-products-gridview"></a><span data-ttu-id="a85c5-125">Schritt 1: Hinzufügen der Kategorien DropDownList und Products GridView</span><span class="sxs-lookup"><span data-stu-id="a85c5-125">Step 1: Adding the Categories DropDownList and Products GridView</span></span>

<span data-ttu-id="a85c5-126">Bevor wir uns mit dem Hinzufügen von Zusammenfassungs Informationen zum Footer von GridView befassen, erstellen wir zunächst einfach den Master-/Detailbericht.</span><span class="sxs-lookup"><span data-stu-id="a85c5-126">Before concerning ourselves with adding summary information to the GridView's footer, let's first simply build the master/detail report.</span></span> <span data-ttu-id="a85c5-127">Nachdem wir diesen ersten Schritt abgeschlossen haben, sehen wir uns an, wie Zusammenfassungs Daten eingeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-127">Once we've completed this first step, we'll look at how to include summary data.</span></span>

<span data-ttu-id="a85c5-128">Öffnen Sie zunächst die Seite `SummaryDataInFooter.aspx` im Ordner `CustomFormatting`.</span><span class="sxs-lookup"><span data-stu-id="a85c5-128">Start by opening the `SummaryDataInFooter.aspx` page in the `CustomFormatting` folder.</span></span> <span data-ttu-id="a85c5-129">Fügen Sie ein Dropdown List-Steuerelement hinzu, und legen Sie dessen `ID` auf `Categories`</span><span class="sxs-lookup"><span data-stu-id="a85c5-129">Add a DropDownList control and set its `ID` to `Categories`.</span></span> <span data-ttu-id="a85c5-130">Klicken Sie anschließend auf den Link Datenquelle auswählen aus dem Smarttag DropDownList, und wählen Sie das Hinzufügen einer neuen ObjectDataSource namens `CategoriesDataSource` aus, die die `GetCategories()`-Methode der `CategoriesBLL` Klasse aufruft.</span><span class="sxs-lookup"><span data-stu-id="a85c5-130">Next, click on the Choose Data Source link from the DropDownList's smart tag and opt to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="a85c5-131">[![eine neue ObjectDataSource mit dem Namen "categoriesdatasource" hinzufügen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image5.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-131">[![Add a New ObjectDataSource Named CategoriesDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image5.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image4.png)</span></span>

<span data-ttu-id="a85c5-132">**Abbildung 2**: Hinzufügen einer neuen ObjectDataSource mit dem Namen "`CategoriesDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-132">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="a85c5-133">[![, dass ObjectDataSource die GetCategories ()-Methode der kategoriesbll-Klasse aufruft.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image8.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-133">[![Have the ObjectDataSource Invoke the CategoriesBLL Class's GetCategories() Method](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image8.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="a85c5-134">**Abbildung 3**: lassen Sie die `GetCategories()` Methode der `CategoriesBLL` Klasse von ObjectDataSource aufrufen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-134">**Figure 3**: Have the ObjectDataSource Invoke the `CategoriesBLL` Class's `GetCategories()` Method ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image9.png))</span></span>

<span data-ttu-id="a85c5-135">Nach dem Konfigurieren von ObjectDataSource kehrt der Assistent zum Konfigurationsassistenten für Datenquellen von DropDownList zurück, von dem aus angegeben werden muss, welcher Daten Feldwert angezeigt werden soll und welcher dem Wert der `ListItem` s der DropDownList entsprechen soll.</span><span class="sxs-lookup"><span data-stu-id="a85c5-135">After configuring the ObjectDataSource, the wizard returns us to the DropDownList's Data Source Configuration wizard from which we need to specify what data field value should be displayed and which one should correspond to the value of the DropDownList's `ListItem` s.</span></span> <span data-ttu-id="a85c5-136">Lassen Sie das `CategoryName` Feld angezeigt, und verwenden Sie die `CategoryID` als Wert.</span><span class="sxs-lookup"><span data-stu-id="a85c5-136">Have the `CategoryName` field displayed and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="a85c5-137">[![die Felder "CategoryName" und "CategoryID" als Text und Wert für die "ListItems"-Werte verwenden.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image11.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-137">[![Use the CategoryName and CategoryID Fields as the Text and Value for the ListItems, Respectively](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image11.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image10.png)</span></span>

<span data-ttu-id="a85c5-138">**Abbildung 4**: Verwenden der Felder "`CategoryName`" und "`CategoryID`" als `Text` und `Value` für die `ListItem` e ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-138">**Figure 4**: Use the `CategoryName` and `CategoryID` Fields as the `Text` and `Value` for the `ListItem` s, Respectively ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="a85c5-139">An dieser Stelle haben wir eine Dropdown List (`Categories`), in der die Kategorien im System aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="a85c5-139">At this point we have a DropDownList (`Categories`) that lists the categories in the system.</span></span> <span data-ttu-id="a85c5-140">Wir müssen nun eine GridView-Ansicht hinzufügen, die die Produkte auflistet, die zur ausgewählten Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="a85c5-140">We now need to add a GridView that lists those products that belong to the selected category.</span></span> <span data-ttu-id="a85c5-141">Nehmen Sie sich jedoch einen Moment Zeit, um das Kontrollkästchen AutoPostBack aktivieren im Smarttag DropDownList zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="a85c5-141">Before we do, though, take a moment to check the Enable AutoPostBack checkbox in the DropDownList's smart tag.</span></span> <span data-ttu-id="a85c5-142">Wie im Tutorial *Master/Detail Filtering with a DropDownList* erläutert, legen Sie die `AutoPostBack`-Eigenschaft von DropDownList auf fest, `True` die Seite jedes Mal zurückgesendet wird, wenn der Dropdown List-Wert geändert wird.</span><span class="sxs-lookup"><span data-stu-id="a85c5-142">As discussed in the *Master/Detail Filtering With a DropDownList* tutorial, by setting the DropDownList's `AutoPostBack` property to `True` the page will be posted back each time the DropDownList value is changed.</span></span> <span data-ttu-id="a85c5-143">Dadurch wird die GridView aktualisiert und zeigt die Produkte für die neu ausgewählte Kategorie an.</span><span class="sxs-lookup"><span data-stu-id="a85c5-143">This will cause the GridView to be refreshed, showing those products for the newly selected category.</span></span> <span data-ttu-id="a85c5-144">Wenn die `AutoPostBack`-Eigenschaft auf `False` (Standardeinstellung) festgelegt ist, führt das Ändern der Kategorie nicht zu einem Postback und aktualisiert daher die aufgelisteten Produkte nicht.</span><span class="sxs-lookup"><span data-stu-id="a85c5-144">If the `AutoPostBack` property is set to `False` (the default), changing the category won't cause a postback and therefore won't update the listed products.</span></span>

<span data-ttu-id="a85c5-145">[![aktivieren Sie das Kontrollkästchen AutoPostBack aktivieren im Smarttag DropDownList.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image14.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-145">[![Check the Enable AutoPostBack Checkbox in the DropDownList's Smart Tag](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image14.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="a85c5-146">**Abbildung 5**: Aktivieren Sie das Kontrollkästchen AutoPostBack aktivieren im Smarttag DropDownList ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="a85c5-146">**Figure 5**: Check the Enable AutoPostBack Checkbox in the DropDownList's Smart Tag ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image15.png))</span></span>

<span data-ttu-id="a85c5-147">Fügen Sie der Seite ein GridView-Steuerelement hinzu, um die Produkte für die ausgewählte Kategorie anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-147">Add a GridView control to the page in order to display the products for the selected category.</span></span> <span data-ttu-id="a85c5-148">Legen Sie den `ID` der GridView auf `ProductsInCategory`, und binden Sie ihn an eine neue ObjectDataSource mit dem Namen `ProductsInCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a85c5-148">Set the GridView's `ID` to `ProductsInCategory` and bind it to a new ObjectDataSource named `ProductsInCategoryDataSource`.</span></span>

<span data-ttu-id="a85c5-149">[![eine neue ObjectDataSource mit dem Namen productsincategorydatasource hinzufügen.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image17.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-149">[![Add a New ObjectDataSource Named ProductsInCategoryDataSource](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image17.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image16.png)</span></span>

<span data-ttu-id="a85c5-150">**Abbildung 6**: Hinzufügen einer neuen ObjectDataSource mit dem Namen "`ProductsInCategoryDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-150">**Figure 6**: Add a New ObjectDataSource Named `ProductsInCategoryDataSource` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image18.png))</span></span>

<span data-ttu-id="a85c5-151">Konfigurieren Sie die ObjectDataSource so, dass Sie die `GetProductsByCategoryID(categoryID)`-Methode der `ProductsBLL` Klasse aufruft.</span><span class="sxs-lookup"><span data-stu-id="a85c5-151">Configure the ObjectDataSource so that it invokes the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="a85c5-152">[![von ObjectDataSource die getproductbycategoryid (CategoryID)-Methode aufrufen.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image20.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-152">[![Have the ObjectDataSource Invoke the GetProductsByCategoryID(categoryID) Method](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image20.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="a85c5-153">**Abbildung 7**: lassen Sie die `GetProductsByCategoryID(categoryID)` Methode von ObjectDataSource aufrufen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-153">**Figure 7**: Have the ObjectDataSource Invoke the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image21.png))</span></span>

<span data-ttu-id="a85c5-154">Da die `GetProductsByCategoryID(categoryID)`-Methode einen Eingabeparameter annimmt, können Sie im letzten Schritt des Assistenten die Quelle des Parameter Werts angeben.</span><span class="sxs-lookup"><span data-stu-id="a85c5-154">Since the `GetProductsByCategoryID(categoryID)` method takes in an input parameter, in the final step of the wizard we can specify the source of the parameter value.</span></span> <span data-ttu-id="a85c5-155">Um diese Produkte aus der ausgewählten Kategorie anzuzeigen, lassen Sie den Parameter aus der Dropdown Liste `Categories`.</span><span class="sxs-lookup"><span data-stu-id="a85c5-155">In order to display those products from the selected category, have the parameter pulled from the `Categories` DropDownList.</span></span>

<span data-ttu-id="a85c5-156">[![den Wert für den CategoryID-Parameter aus den Dropdown Listen "ausgewählte Kategorien"](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image23.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-156">[![Get the categoryID Parameter Value from the Selected Categories DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image23.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image22.png)</span></span>

<span data-ttu-id="a85c5-157">**Abbildung 8: ermitteln**des *`categoryID`* Parameter Werts aus der Dropdown Liste Ausgewählte Kategorien ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-157">**Figure 8**: Get the *`categoryID`* Parameter Value from the Selected Categories DropDownList ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image24.png))</span></span>

<span data-ttu-id="a85c5-158">Nachdem Sie den Assistenten abgeschlossen haben, verfügt die GridView über ein BoundField für jede der Produkteigenschaften.</span><span class="sxs-lookup"><span data-stu-id="a85c5-158">After completing the wizard the GridView will have a BoundField for each of the product properties.</span></span> <span data-ttu-id="a85c5-159">Wir bereinigen diese boundfields, damit nur die `ProductName`, `UnitPrice`, `UnitsInStock`und `UnitsOnOrder` boundfields angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-159">Let's clean up these BoundFields so that only the `ProductName`, `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields are displayed.</span></span> <span data-ttu-id="a85c5-160">Sie können den verbleibenden boundfields-Einstellungen auf Feldebene hinzufügen (z. b. das `UnitPrice` als Währung formatieren).</span><span class="sxs-lookup"><span data-stu-id="a85c5-160">Feel free to add any field-level settings to the remaining BoundFields (such as formatting the `UnitPrice` as a currency).</span></span> <span data-ttu-id="a85c5-161">Nachdem Sie diese Änderungen vorgenommen haben, sollte das deklarative Markup der GridView in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="a85c5-161">After making these changes, the GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="a85c5-162">Zu diesem Zeitpunkt verfügen wir über einen voll funktionsfähigen Master/Detail-Bericht, in dem der Name, der Einheitspreis, die Einheiten im Lager und die Einheiten für die Produkte, die zur ausgewählten Kategorie gehören, angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-162">At this point we have a fully functioning master/detail report that shows the name, unit price, units in stock, and units on order for those products that belong to the selected category.</span></span>

<span data-ttu-id="a85c5-163">[![den Wert für den CategoryID-Parameter aus den Dropdown Listen "ausgewählte Kategorien"](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image26.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-163">[![Get the categoryID Parameter Value from the Selected Categories DropDownList](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image26.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image25.png)</span></span>

<span data-ttu-id="a85c5-164">**Abbildung 9**: Anzeigen des *`categoryID`* Parameter Werts aus den Dropdown Listen für ausgewählte Kategorien ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-164">**Figure 9**: Get the *`categoryID`* Parameter Value from the Selected Categories DropDownList ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image27.png))</span></span>

## <a name="step-2-displaying-a-footer-in-the-gridview"></a><span data-ttu-id="a85c5-165">Schritt 2: Anzeigen einer Fußzeile in der GridView</span><span class="sxs-lookup"><span data-stu-id="a85c5-165">Step 2: Displaying a Footer in the GridView</span></span>

<span data-ttu-id="a85c5-166">Das GridView-Steuerelement kann eine Kopf-und eine Footerzeile anzeigen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-166">The GridView control can display both a header and footer row.</span></span> <span data-ttu-id="a85c5-167">Diese Zeilen werden abhängig von den Werten der Eigenschaften `ShowHeader` und `ShowFooter` angezeigt, wobei `ShowHeader` standardmäßig `True` und `ShowFooter` `False`.</span><span class="sxs-lookup"><span data-stu-id="a85c5-167">These rows are displayed depending on the values of the `ShowHeader` and `ShowFooter` properties, respectively, with `ShowHeader` defaulting to `True` and `ShowFooter` to `False`.</span></span> <span data-ttu-id="a85c5-168">Wenn Sie eine Fußzeile in die GridView einschließen möchten, legen Sie einfach die `ShowFooter`-Eigenschaft auf `True`fest.</span><span class="sxs-lookup"><span data-stu-id="a85c5-168">To include a footer in the GridView simply set its `ShowFooter` property to `True`.</span></span>

<span data-ttu-id="a85c5-169">[![legen Sie die ShowFooter-Eigenschaft der GridView auf "true" fest.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image29.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-169">[![Set the GridView's ShowFooter Property to True](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image29.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image28.png)</span></span>

<span data-ttu-id="a85c5-170">**Abbildung 10**: Festlegen der `ShowFooter`-Eigenschaft der GridView auf `True` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-170">**Figure 10**: Set the GridView's `ShowFooter` Property to `True` ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image30.png))</span></span>

<span data-ttu-id="a85c5-171">Die Footerzeile enthält eine Zelle für jedes der Felder, die in der GridView definiert sind. Diese Zellen sind jedoch standardmäßig leer.</span><span class="sxs-lookup"><span data-stu-id="a85c5-171">The footer row has a cell for each of the fields defined in the GridView; however, these cells are empty by default.</span></span> <span data-ttu-id="a85c5-172">Nehmen Sie sich einen Moment Zeit, um den Fortschritt in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-172">Take a moment to view our progress in a browser.</span></span> <span data-ttu-id="a85c5-173">Wenn die `ShowFooter`-Eigenschaft jetzt auf `True`festgelegt ist, enthält die GridView eine leere Footerzeile.</span><span class="sxs-lookup"><span data-stu-id="a85c5-173">With the `ShowFooter` property now set to `True`, the GridView includes an empty footer row.</span></span>

<span data-ttu-id="a85c5-174">[![die GridView nun eine Footerzeile enthält.](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image32.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-174">[![The GridView Now Includes a Footer Row](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image32.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image31.png)</span></span>

<span data-ttu-id="a85c5-175">**Abbildung 11**: die GridView enthält jetzt eine Footerzeile ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-175">**Figure 11**: The GridView Now Includes a Footer Row ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image33.png))</span></span>

<span data-ttu-id="a85c5-176">Die Footerzeile in Abbildung 11 steht nicht aus, da Sie einen weißen Hintergrund hat.</span><span class="sxs-lookup"><span data-stu-id="a85c5-176">The footer row in Figure 11 doesn't stand out, as it has a white background.</span></span> <span data-ttu-id="a85c5-177">Erstellen Sie eine `FooterStyle` CSS-Klasse in `Styles.css`, die einen dunkelroten Hintergrund angibt, und konfigurieren Sie dann die `GridView.skin` Skin-Datei im `DataWebControls` Design, um diese CSS-Klasse der `FooterStyle`-Eigenschaft der GridView zuzuweisen.`CssClass`</span><span class="sxs-lookup"><span data-stu-id="a85c5-177">Let's create a `FooterStyle` CSS class in `Styles.css` that specifies a dark red background and then configure the `GridView.skin` Skin file in the `DataWebControls` Theme to assign this CSS class to the GridView's `FooterStyle`'s `CssClass` property.</span></span> <span data-ttu-id="a85c5-178">Wenn Sie für Skins und Designs einen Pinsel einrichten müssen, lesen Sie das Tutorial [Anzeigen von Daten mit dem ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) -Tutorial.</span><span class="sxs-lookup"><span data-stu-id="a85c5-178">If you need to brush up on Skins and Themes, refer back to the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md) tutorial.</span></span>

<span data-ttu-id="a85c5-179">Fügen Sie zunächst die folgende CSS-Klasse zu `Styles.css`hinzu:</span><span class="sxs-lookup"><span data-stu-id="a85c5-179">Start by adding the following CSS class to `Styles.css`:</span></span>

[!code-css[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample2.css)]

<span data-ttu-id="a85c5-180">Die `FooterStyle` CSS-Klasse ähnelt der-Klasse für die `HeaderStyle`-Klasse. die Hintergrundfarbe des `HeaderStyle`ist jedoch dunkler, und der Text wird in Fett Schrift angezeigt.</span><span class="sxs-lookup"><span data-stu-id="a85c5-180">The `FooterStyle` CSS class is similar in style to the `HeaderStyle` class, although the `HeaderStyle`'s background color is subtlety darker and its text is displayed in a bold font.</span></span> <span data-ttu-id="a85c5-181">Außerdem wird der Text in der Fußzeile rechtsbündig ausgerichtet, während der Text des Headers zentriert ist.</span><span class="sxs-lookup"><span data-stu-id="a85c5-181">Furthermore, the text in the footer is right-aligned whereas the header's text is centered.</span></span>

<span data-ttu-id="a85c5-182">Um diese CSS-Klasse jedem GridView-Footer zuzuordnen, öffnen Sie die Datei `GridView.skin` im `DataWebControls` Design, und legen Sie die `CssClass`-Eigenschaft des `FooterStyle`fest.</span><span class="sxs-lookup"><span data-stu-id="a85c5-182">Next, to associate this CSS class with every GridView's footer, open the `GridView.skin` file in the `DataWebControls` Theme and set the `FooterStyle`'s `CssClass` property.</span></span> <span data-ttu-id="a85c5-183">Nach dieser Addition sollte das Markup der Datei wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="a85c5-183">After this addition the file's markup should look like:</span></span>

[!code-aspx[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="a85c5-184">Wie der Screenshot unten zeigt, macht diese Änderung den Fußzeile deutlicher.</span><span class="sxs-lookup"><span data-stu-id="a85c5-184">As the screen shot below shows, this change makes the footer stand out more clearly.</span></span>

<span data-ttu-id="a85c5-185">[![die Footerzeile der GridView jetzt eine rot-Hintergrundfarbe](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image35.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-185">[![The GridView's Footer Row Now Has a Reddish Background Color](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image35.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image34.png)</span></span>

<span data-ttu-id="a85c5-186">**Abbildung 12**: die Footerzeile der GridView weist jetzt eine farbige Hintergrundfarbe auf ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-186">**Figure 12**: The GridView's Footer Row Now Has a Reddish Background Color ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image36.png))</span></span>

## <a name="step-3-computing-the-summary-data"></a><span data-ttu-id="a85c5-187">Schritt 3: Berechnen der Zusammenfassungs Daten</span><span class="sxs-lookup"><span data-stu-id="a85c5-187">Step 3: Computing the Summary Data</span></span>

<span data-ttu-id="a85c5-188">Wenn die Fußzeile der GridView angezeigt wird, besteht die nächste Herausforderung darin, wie die Zusammenfassungs Daten berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-188">With the GridView's footer displayed, the next challenge facing us is how to compute the summary data.</span></span> <span data-ttu-id="a85c5-189">Diese Aggregat Informationen können auf zwei Arten berechnet werden:</span><span class="sxs-lookup"><span data-stu-id="a85c5-189">There are two ways to compute this aggregate information:</span></span>

1. <span data-ttu-id="a85c5-190">Über eine SQL-Abfrage könnten wir eine zusätzliche Abfrage an die Datenbank ausgeben, um die Zusammenfassungs Daten für eine bestimmte Kategorie zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-190">Through a SQL query we could issue an additional query to the database to compute the summary data for a particular category.</span></span> <span data-ttu-id="a85c5-191">SQL enthält eine Reihe von Aggregatfunktionen zusammen mit einer `GROUP BY`-Klausel, um die Daten anzugeben, über die die Daten zusammengefasst werden sollen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-191">SQL includes a number of aggregate functions along with a `GROUP BY` clause to specify the data over which the data should be summarized.</span></span> <span data-ttu-id="a85c5-192">Die folgende SQL-Abfrage würde die benötigten Informationen zurückbringen:</span><span class="sxs-lookup"><span data-stu-id="a85c5-192">The following SQL query would bring back the needed information:</span></span>  

    [!code-sql[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample4.sql)]

    <span data-ttu-id="a85c5-193">Natürlich sollten Sie diese Abfrage nicht direkt über die `SummaryDataInFooter.aspx` Seite ausgeben, sondern indem Sie eine Methode in der `ProductsTableAdapter` und der `ProductsBLL`erstellen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-193">Of course you wouldn't want to issue this query directly from the `SummaryDataInFooter.aspx` page, but rather by creating a method in the `ProductsTableAdapter` and the `ProductsBLL`.</span></span>
2. <span data-ttu-id="a85c5-194">Berechnen Sie diese Informationen, während Sie der GridView hinzugefügt werden, wie unter [benutzerdefinierte Formatierung basierend auf datentutorial](custom-formatting-based-upon-data-cs.md) erläutert wird. der `RowDataBound` Ereignishandler von GridView wird für jede Zeile, die der GridView hinzugefügt wurde, nach der Datenbindung einmal ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="a85c5-194">Compute this information as it's being added to the GridView as discussed in [Custom Formatting Based Upon Data](custom-formatting-based-upon-data-cs.md) tutorial, the GridView's `RowDataBound` event handler fires once for each row being added to the GridView after its been databound.</span></span> <span data-ttu-id="a85c5-195">Durch das Erstellen eines Ereignis Handlers für dieses Ereignis können wir eine laufende Summe der zu aggregierenden Werte beibehalten.</span><span class="sxs-lookup"><span data-stu-id="a85c5-195">By creating an event handler for this event we can keep a running total of the values we want to aggregate.</span></span> <span data-ttu-id="a85c5-196">Nachdem die letzte Daten Zeile an die GridView gebunden wurde, verfügen wir über die Summen und die erforderlichen Informationen, um den Durchschnitt zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-196">After the last data row has been bound to the GridView we have the totals and the information needed to compute the average.</span></span>

<span data-ttu-id="a85c5-197">Ich verwende in der Regel den zweiten Ansatz, da eine Fahrt zur Datenbank und der Aufwand zum Implementieren der Zusammenfassungs Funktionalität in der Datenzugriffs Schicht und in der Geschäftslogik Schicht erforderlich ist, aber beide Vorgehensweisen sind ausreichend.</span><span class="sxs-lookup"><span data-stu-id="a85c5-197">I typically employ the second approach as it saves a trip to the database and the effort needed to implement the summary functionality in the Data Access Layer and Business Logic Layer, but either approach would suffice.</span></span> <span data-ttu-id="a85c5-198">Verwenden Sie für dieses Tutorial die zweite Option, und verfolgen Sie die laufende Summe mithilfe des `RowDataBound`-Ereignis Handlers.</span><span class="sxs-lookup"><span data-stu-id="a85c5-198">For this tutorial let's use the second option and keep track of the running total using the `RowDataBound` event handler.</span></span>

<span data-ttu-id="a85c5-199">Erstellen Sie einen `RowDataBound` Ereignishandler für das GridView-Ereignis, indem Sie im Designer das GridView-Symbol auswählen, auf das Blitz Symbol des Eigenschaftenfenster klicken und auf das `RowDataBound`-Ereignis doppelklicken.</span><span class="sxs-lookup"><span data-stu-id="a85c5-199">Create a `RowDataBound` event handler for the GridView by selecting the GridView in the Designer, clicking the lightning bolt icon from the Properties window, and double-clicking the `RowDataBound` event.</span></span> <span data-ttu-id="a85c5-200">Alternativ können Sie das GridView-Ereignis und das zugehörige rowdatabosereignis aus den Dropdown Listen am Anfang der ASP.NET-Code Behind-Klassendatei auswählen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-200">Alternatively, you can select the GridView and its RowDataBound event from the drop-down lists at the top of the ASP.NET code-behind class file.</span></span> <span data-ttu-id="a85c5-201">Dadurch wird ein neuer Ereignishandler mit dem Namen `ProductsInCategory_RowDataBound` in der Code Behind-Klasse der `SummaryDataInFooter.aspx` Seite erstellt.</span><span class="sxs-lookup"><span data-stu-id="a85c5-201">This will create a new event handler named `ProductsInCategory_RowDataBound` in the `SummaryDataInFooter.aspx` page's code-behind class.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample5.vb)]

<span data-ttu-id="a85c5-202">Um eine laufende Summe beizubehalten, müssen wir Variablen außerhalb des Gültigkeits Bereichs des Ereignis Handlers definieren.</span><span class="sxs-lookup"><span data-stu-id="a85c5-202">In order to maintain a running total we need to define variables outside of the scope of the event handler.</span></span> <span data-ttu-id="a85c5-203">Erstellen Sie die folgenden vier Variablen auf Seitenebene:</span><span class="sxs-lookup"><span data-stu-id="a85c5-203">Create the following four page-level variables:</span></span>

- <span data-ttu-id="a85c5-204">`_totalUnitPrice`vom Typ `Decimal`</span><span class="sxs-lookup"><span data-stu-id="a85c5-204">`_totalUnitPrice`, of type `Decimal`</span></span>
- <span data-ttu-id="a85c5-205">`_totalNonNullUnitPriceCount`vom Typ `Integer`</span><span class="sxs-lookup"><span data-stu-id="a85c5-205">`_totalNonNullUnitPriceCount`, of type `Integer`</span></span>
- <span data-ttu-id="a85c5-206">`_totalUnitsInStock`vom Typ `Integer`</span><span class="sxs-lookup"><span data-stu-id="a85c5-206">`_totalUnitsInStock`, of type `Integer`</span></span>
- <span data-ttu-id="a85c5-207">`_totalUnitsOnOrder`vom Typ `Integer`</span><span class="sxs-lookup"><span data-stu-id="a85c5-207">`_totalUnitsOnOrder`, of type `Integer`</span></span>

<span data-ttu-id="a85c5-208">Schreiben Sie als nächstes den Code, um diese drei Variablen für jede Daten Zeile zu erhöhen, die im `RowDataBound`-Ereignishandler gefunden wurde.</span><span class="sxs-lookup"><span data-stu-id="a85c5-208">Next, write the code to increment these three variables for each data row encountered in the `RowDataBound` event handler.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample6.vb)]

<span data-ttu-id="a85c5-209">Der `RowDataBound` Ereignishandler stellt sicher, dass wir mit einer DataRow arbeiten.</span><span class="sxs-lookup"><span data-stu-id="a85c5-209">The `RowDataBound` event handler starts by ensuring that we're dealing with a DataRow.</span></span> <span data-ttu-id="a85c5-210">Nachdem dieser festgelegt wurde, wird die `Northwind.ProductsRow`-Instanz, die nur an das `GridViewRow`-Objekt in `e.Row` gebunden war, in der Variablen `product`gespeichert.</span><span class="sxs-lookup"><span data-stu-id="a85c5-210">Once that's been established, the `Northwind.ProductsRow` instance that was just bound to the `GridViewRow` object in `e.Row` is stored in the variable `product`.</span></span> <span data-ttu-id="a85c5-211">Als nächstes wird das Ausführen von Gesamt Variablen durch die entsprechenden Werte des aktuellen Produkts erhöht (vorausgesetzt, dass Sie keinen Daten Bank `NULL` Wert enthalten).</span><span class="sxs-lookup"><span data-stu-id="a85c5-211">Next, running total variables are incremented by the current product's corresponding values (assuming that they don't contain a database `NULL` value).</span></span> <span data-ttu-id="a85c5-212">Wir verfolgen sowohl den laufenden `UnitPrice` insgesamt als auch die Anzahl der nicht`NULL` `UnitPrice` Datensätze, da der Durchschnittspreis der Quotienten dieser beiden Zahlen ist.</span><span class="sxs-lookup"><span data-stu-id="a85c5-212">We keep track of both the running `UnitPrice` total and the number of non-`NULL` `UnitPrice` records because the average price is the quotient of these two numbers.</span></span>

## <a name="step-4-displaying-the-summary-data-in-the-footer"></a><span data-ttu-id="a85c5-213">Schritt 4: Anzeigen der Zusammenfassungs Daten in der Fußzeile</span><span class="sxs-lookup"><span data-stu-id="a85c5-213">Step 4: Displaying the Summary Data in the Footer</span></span>

<span data-ttu-id="a85c5-214">Wenn die Zusammenfassungs Daten summiert sind, besteht der letzte Schritt darin, Sie in der Fußzeile der GridView anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-214">With the summary data totaled, the last step is to display it in the GridView's footer row.</span></span> <span data-ttu-id="a85c5-215">Diese Aufgabe kann auch Programm gesteuert über den `RowDataBound`-Ereignishandler ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-215">This task, too, can be accomplished programmatically through the `RowDataBound` event handler.</span></span> <span data-ttu-id="a85c5-216">Beachten Sie, dass der `RowDataBound` Ereignishandler für *jede* Zeile ausgelöst wird, die an die GridView gebunden ist, einschließlich der Footerzeile.</span><span class="sxs-lookup"><span data-stu-id="a85c5-216">Recall that the `RowDataBound` event handler fires for *every* row that's bound to the GridView, including the footer row.</span></span> <span data-ttu-id="a85c5-217">Daher können wir den Ereignishandler erweitern, um die Daten in der Footerzeile mithilfe des folgenden Codes anzuzeigen:</span><span class="sxs-lookup"><span data-stu-id="a85c5-217">Therefore, we can augment our event handler to display the data in the footer row using the following code:</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="a85c5-218">Da die Footerzeile der GridView hinzugefügt wird, nachdem alle Daten Zeilen hinzugefügt wurden, können wir sicher sein, dass Sie bis zum Anzeigen der Zusammenfassungs Daten in der Fußzeile sicher sind, dass die laufenden gesamten Berechnungen abgeschlossen sind.</span><span class="sxs-lookup"><span data-stu-id="a85c5-218">Since the footer row is added to the GridView after all of the data rows have been added, we can be confident that by the time we're ready to display the summary data in the footer the running total calculations will have completed.</span></span> <span data-ttu-id="a85c5-219">Der letzte Schritt besteht darin, diese Werte in den Zellen des Footers festzulegen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-219">The last step, then, is to set these values in the footer's cells.</span></span>

<span data-ttu-id="a85c5-220">Zum Anzeigen von Text in einer bestimmten footerzelle verwenden Sie `e.Row.Cells(index).Text = value`, bei dem die `Cells` Indizierung bei 0 beginnt.</span><span class="sxs-lookup"><span data-stu-id="a85c5-220">To display text in a particular footer cell, use `e.Row.Cells(index).Text = value`, where the `Cells` indexing starts at 0.</span></span> <span data-ttu-id="a85c5-221">Der folgende Code berechnet den Durchschnittspreis (der Gesamtpreis dividiert durch die Anzahl der Produkte) und zeigt ihn zusammen mit der Gesamtanzahl der Einheiten im Lager und den Einheiten in den entsprechenden Fußzeilen Zellen der GridView an.</span><span class="sxs-lookup"><span data-stu-id="a85c5-221">The following code computes the average price (the total price divided by the number of products) and displays it along with the total number of units in stock and units on order in the appropriate footer cells of the GridView.</span></span>

[!code-vb[Main](displaying-summary-information-in-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="a85c5-222">Abbildung 13 zeigt den Bericht, nachdem dieser Code hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="a85c5-222">Figure 13 shows the report after this code has been added.</span></span> <span data-ttu-id="a85c5-223">Beachten Sie, dass der `ToString("c")` bewirkt, dass die Informationen zur durchschnittlichen Preis Zusammenfassung wie eine Währung formatiert werden.</span><span class="sxs-lookup"><span data-stu-id="a85c5-223">Note how the `ToString("c")` causes the average price summary information to be formatted like a currency.</span></span>

<span data-ttu-id="a85c5-224">[![die Footerzeile der GridView jetzt eine rot-Hintergrundfarbe](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image38.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="a85c5-224">[![The GridView's Footer Row Now Has a Reddish Background Color](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image38.png)](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image37.png)</span></span>

<span data-ttu-id="a85c5-225">**Abbildung 13**: die Footerzeile der GridView weist jetzt eine farbige Hintergrundfarbe auf ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="a85c5-225">**Figure 13**: The GridView's Footer Row Now Has a Reddish Background Color ([Click to view full-size image](displaying-summary-information-in-the-gridview-s-footer-vb/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="a85c5-226">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="a85c5-226">Summary</span></span>

<span data-ttu-id="a85c5-227">Das Anzeigen von Zusammenfassungs Daten ist eine gängige Berichts Anforderung, und das GridView-Steuerelement erleichtert das einschließen derartiger Informationen in der Footerzeile.</span><span class="sxs-lookup"><span data-stu-id="a85c5-227">Displaying summary data is a common report requirement, and the GridView control makes it easy to include such information in its footer row.</span></span> <span data-ttu-id="a85c5-228">Die Footerzeile wird angezeigt, wenn die `ShowFooter`-Eigenschaft der GridView auf `True` festgelegt ist und der Text in den Zellen Programm gesteuert über den `RowDataBound`-Ereignishandler festgelegt werden kann.</span><span class="sxs-lookup"><span data-stu-id="a85c5-228">The footer row is displayed when the GridView's `ShowFooter` property is set to `True` and can have the text in its cells set programmatically through the `RowDataBound` event handler.</span></span> <span data-ttu-id="a85c5-229">Das Berechnen der Zusammenfassungs Daten kann entweder durch erneutes Abfragen der Datenbank oder durch Verwendung von Code in der Code Behind-Klasse der ASP.NET-Seite erfolgen, um die Zusammenfassungs Daten Programm gesteuert zu berechnen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-229">Computing the summary data can either be done by re-querying the database or by using code in the ASP.NET page's code-behind class to programmatically compute the summary data.</span></span>

<span data-ttu-id="a85c5-230">In diesem Tutorial wird die Prüfung der benutzerdefinierten Formatierung mit den Steuerelementen GridView, DetailsView und FormView abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="a85c5-230">This tutorial concludes our examination of custom formatting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="a85c5-231">Im nächsten Tutorial wird das Einfügen, aktualisieren und Löschen von Daten mit denselben Steuerelementen untersucht.</span><span class="sxs-lookup"><span data-stu-id="a85c5-231">Our next tutorial kicks off our exploration of inserting, updating, and deleting data using these same controls.</span></span>

<span data-ttu-id="a85c5-232">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="a85c5-232">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a85c5-233">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="a85c5-233">About the Author</span></span>

<span data-ttu-id="a85c5-234">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="a85c5-234">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a85c5-235">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="a85c5-235">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a85c5-236">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a85c5-236">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a85c5-237">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a85c5-237">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a85c5-238">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a85c5-238">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="a85c5-239">Previous</span><span class="sxs-lookup"><span data-stu-id="a85c5-239">Previous</span></span>](using-the-formview-s-templates-vb.md)
