---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
title: Formatieren von DataList und Repeater auf der Grundlage von Daten (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial werden Beispiele für das Formatieren der Darstellung der DataList-und Repeater-Steuerelemente mithilfe von Formatierungsfunktionen mit...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: e2f401ae-37bb-4b19-aa97-d6b385d40f88
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb
msc.type: authoredcontent
ms.openlocfilehash: c9b60e4dacd992962942034e84c01cb82e039c81
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74636668"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-vb"></a><span data-ttu-id="d85d2-103">Formatieren des DataList- und Wiederholungssteuerelements auf Datenbasis (VB)</span><span class="sxs-lookup"><span data-stu-id="d85d2-103">Formatting the DataList and Repeater Based Upon Data (VB)</span></span>

<span data-ttu-id="d85d2-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d85d2-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d85d2-105">[Beispiel-app herunterladen](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) oder [PDF herunterladen](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d85d2-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_VB.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/datatutorial30vb1.pdf)</span></span>

> <span data-ttu-id="d85d2-106">In diesem Tutorial werden Beispiele für das Formatieren der Darstellung der DataList-und Repeater-Steuerelemente erläutert, entweder mithilfe von Formatierungsfunktionen in Vorlagen oder durch Behandeln des Daten gebundenen Ereignisses.</span><span class="sxs-lookup"><span data-stu-id="d85d2-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>

## <a name="introduction"></a><span data-ttu-id="d85d2-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="d85d2-107">Introduction</span></span>

<span data-ttu-id="d85d2-108">Wie wir im vorherigen Tutorial gesehen haben, bietet der DataList eine Reihe von Stil bezogenen Eigenschaften, die sich auf seine Darstellung auswirken.</span><span class="sxs-lookup"><span data-stu-id="d85d2-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="d85d2-109">Insbesondere wurde erläutert, wie den Eigenschaften `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`und `SelectedItemStyle` von DataList Standard-CSS-Klassen zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="d85d2-110">Zusätzlich zu diesen vier Eigenschaften enthält der DataList eine Reihe von anderen Stil bezogenen Eigenschaften, z. b. `Font`, `ForeColor`, `BackColor`und `BorderWidth`, um nur einige zu nennen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="d85d2-111">Das Repeater-Steuerelement enthält keine Stil bezogenen Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="d85d2-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="d85d2-112">Alle diese Stileinstellungen müssen direkt innerhalb des Markups in den Wiederholungs Vorlagen erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="d85d2-113">Häufig hängt jedoch von den Daten ab, wie die Daten formatiert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="d85d2-114">Wenn Sie z. b. Produkte auflisten, möchten wir möglicherweise die Produktinformationen in einer hellgrauen Schriftfarbe anzeigen, wenn Sie nicht mehr unterstützt wird, oder Sie möchten den `UnitsInStock` Wert hervorheben, wenn der Wert 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="d85d2-115">Wie in den vorherigen Tutorials gezeigt, bieten GridView, DetailsView und FormView zwei verschiedene Möglichkeiten, ihre Darstellung basierend auf Ihren Daten zu formatieren:</span><span class="sxs-lookup"><span data-stu-id="d85d2-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="d85d2-116">**Das `DataBound`-Ereignis** erstellt einen Ereignishandler für das entsprechende `DataBound`-Ereignis, das ausgelöst wird, nachdem die Daten an die einzelnen Elemente gebunden wurden (für das GridView-Objekt war es das `RowDataBound`-Ereignis; für das DataList-und das Repeater ist es das `ItemDataBound` Ereignis).</span><span class="sxs-lookup"><span data-stu-id="d85d2-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="d85d2-117">In diesem Ereignishandler können die Daten, die gerade gebunden sind, überprüft und Formatierungs Entscheidungen getroffen werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="d85d2-118">Wir haben dieses Verfahren im Tutorial [benutzerdefinierte Formatierung basierend auf Daten](../custom-formatting/custom-formatting-based-upon-data-vb.md) untersucht.</span><span class="sxs-lookup"><span data-stu-id="d85d2-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>
- <span data-ttu-id="d85d2-119">**Formatieren von Funktionen in Vorlagen** bei Verwendung von templatefields in den DetailsView-oder GridView-Steuerelementen oder einer Vorlage im FormView-Steuerelement können wir eine Formatierungsfunktion zur Code-Behind-Klasse der ASP.net page s, der Geschäftslogik Ebene oder einer beliebigen anderen Klassenbibliothek hinzufügen, auf die von der Webanwendung aus zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="d85d2-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="d85d2-120">Diese Formatierungsfunktion kann eine beliebige Anzahl von Eingabe Parametern akzeptieren, muss jedoch den HTML-Code zum Rendering in der Vorlage zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="d85d2-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="d85d2-121">Formatierungsfunktionen wurden zunächst im Tutorial [Verwenden von templatefields im GridView-Steuer](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) Element untersucht.</span><span class="sxs-lookup"><span data-stu-id="d85d2-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="d85d2-122">Beide Formatierungs Techniken sind mit den Steuerelementen DataList und Repeater verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d85d2-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="d85d2-123">In diesem Tutorial werden Beispiele für die Verwendung beider Techniken für beide Steuerelemente erläutert.</span><span class="sxs-lookup"><span data-stu-id="d85d2-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="d85d2-124">Verwenden des`ItemDataBound`-Ereignis Handlers</span><span class="sxs-lookup"><span data-stu-id="d85d2-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="d85d2-125">Wenn Daten an einen DataList gebunden werden, entweder aus einem Datenquellen-Steuerelement oder durch Programm gesteuertes Zuweisen von Daten an das Steuerelement s `DataSource`-Eigenschaft und Aufrufen der `DataBind()`-Methode, wird das DataList-`DataBinding`-Ereignis ausgelöst, die Datenquelle aufgezählt und jeder Daten Satz an den DataList gebunden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="d85d2-126">Der DataList erstellt für jeden Datensatz in der Datenquelle ein [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) Objekt, das dann an den aktuellen Datensatz gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="d85d2-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="d85d2-127">Während dieses Prozesses löst der DataList zwei Ereignisse aus:</span><span class="sxs-lookup"><span data-stu-id="d85d2-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="d85d2-128">**`ItemCreated`** ausgelöst, nachdem die `DataListItem` erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="d85d2-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="d85d2-129">**`ItemDataBound`** ausgelöst, nachdem der aktuelle Datensatz an das-`DataListItem` gebunden wurde.</span><span class="sxs-lookup"><span data-stu-id="d85d2-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="d85d2-130">Die folgenden Schritte beschreiben den Daten Bindungsprozess für das DataList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="d85d2-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="d85d2-131">Das DataList s- [`DataBinding` Ereignis](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="d85d2-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="d85d2-132">Die Daten sind an den DataList gebunden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="d85d2-133">Für jeden Datensatz in der Datenquelle</span><span class="sxs-lookup"><span data-stu-id="d85d2-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="d85d2-134">Erstellen eines `DataListItem` Objekts</span><span class="sxs-lookup"><span data-stu-id="d85d2-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="d85d2-135">[`ItemCreated` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx) auslösen</span><span class="sxs-lookup"><span data-stu-id="d85d2-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="d85d2-136">Binden Sie den Datensatz an den `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="d85d2-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="d85d2-137">[`ItemDataBound` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx) auslösen</span><span class="sxs-lookup"><span data-stu-id="d85d2-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="d85d2-138">Fügen Sie die `DataListItem` der `Items` Sammlung hinzu.</span><span class="sxs-lookup"><span data-stu-id="d85d2-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="d85d2-139">Beim Binden von Daten an das Repeater-Steuerelement wird die gleiche Abfolge von Schritten durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="d85d2-140">Der einzige Unterschied besteht darin, dass der Repeater [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s verwendet, anstatt `DataListItem` Instanzen erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="d85d2-141">Der aufgeweckter Reader hat möglicherweise eine geringfügige Anomalieerkennung zwischen der Abfolge von Schritten bemerkt, die durchlaufen werden, wenn DataList und Repeater an Daten gebunden sind, und wenn die GridView an Daten gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="d85d2-142">Am Ende des Daten Bindungs Prozesses löst das GridView-Ereignis das `DataBound`-Ereignis aus. Allerdings hat weder das DataList-Steuerelement noch das Repeater-Steuerelement ein derartiges Ereignis.</span><span class="sxs-lookup"><span data-stu-id="d85d2-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="d85d2-143">Dies liegt daran, dass die DataList-und Repeater-Steuerelemente im ASP.NET 1. x-Zeitrahmen erstellt wurden, bevor das Ereignishandlermuster vor und nach der Ebene üblich geworden ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>

<span data-ttu-id="d85d2-144">Wie bei GridView besteht eine Option für die Formatierung auf der Grundlage der Daten darin, einen Ereignishandler für das `ItemDataBound`-Ereignis zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="d85d2-145">Dieser Ereignishandler prüft die Daten, die gerade an die `DataListItem` oder `RepeaterItem` gebunden waren, und wirkt sich bei Bedarf auf die Formatierung des Steuer Elements aus.</span><span class="sxs-lookup"><span data-stu-id="d85d2-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="d85d2-146">Für das DataList-Steuerelement können Formatierungs Änderungen für das gesamte Element mithilfe der Eigenschaften des `DataListItem` s-Stils implementiert werden, einschließlich der Standard `Font`, `ForeColor`, `BackColor`, `CssClass`usw.</span><span class="sxs-lookup"><span data-stu-id="d85d2-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="d85d2-147">Um die Formatierung bestimmter websteuer Elemente in der DataList-Vorlage zu beeinflussen, müssen wir den Stil dieser websteuer Elemente Programm gesteuert aufrufen und ändern.</span><span class="sxs-lookup"><span data-stu-id="d85d2-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="d85d2-148">Wir haben gesehen, wie Sie dies in der *benutzerdefinierten Formatierung basierend auf datentutorial* durchführen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="d85d2-149">Wie das Repeater-Steuerelement hat die `RepeaterItem`-Klasse keine Stil bezogenen Eigenschaften. Daher müssen alle Stil bezogenen Änderungen, die an einem `RepeaterItem` im `ItemDataBound`-Ereignishandler vorgenommen werden, durch Programm gesteuertes zugreifen auf und Aktualisieren von websteuer Elementen in der Vorlage erfolgen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="d85d2-150">Da die `ItemDataBound` Formatierungs Technik für DataList und Repeater praktisch identisch ist, konzentriert sich unser Beispiel auf die Verwendung von DataList.</span><span class="sxs-lookup"><span data-stu-id="d85d2-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="d85d2-151">Schritt 1: Anzeigen von Produktinformationen im DataList</span><span class="sxs-lookup"><span data-stu-id="d85d2-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="d85d2-152">Bevor wir uns über die Formatierung Gedanken machen, erstellen Sie zunächst eine Seite, die einen DataList zum Anzeigen von Produktinformationen verwendet.</span><span class="sxs-lookup"><span data-stu-id="d85d2-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="d85d2-153">Im [vorherigen Tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) haben wir einen DataList erstellt, dessen `ItemTemplate` die einzelnen Produktnamen, Kategorie, Lieferant, Menge pro Einheit und Preis angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d85d2-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-vb.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="d85d2-154">Wiederholen Sie diese Funktion hier in diesem Tutorial.</span><span class="sxs-lookup"><span data-stu-id="d85d2-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="d85d2-155">Um dies zu erreichen, können Sie entweder den DataList und dessen ObjectDataSource neu erstellen, oder Sie können die Steuerelemente auf der Seite, die Sie im vorherigen Tutorial (`Basics.aspx`) erstellt haben, kopieren und auf der Seite für dieses Tutorial (`Formatting.aspx`) einfügen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="d85d2-156">Nachdem Sie die DataList-und ObjectDataSource-Funktionalität von `Basics.aspx` in `Formatting.aspx`repliziert haben, nehmen Sie sich einen Moment Zeit, um die DataList-Eigenschaft `ID` von `DataList1` in eine beschreibende `ItemDataBoundFormattingExample`zu ändern.</span><span class="sxs-lookup"><span data-stu-id="d85d2-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="d85d2-157">Sehen Sie sich als nächstes den DataList in einem Browser an.</span><span class="sxs-lookup"><span data-stu-id="d85d2-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="d85d2-158">Wie in Abbildung 1 gezeigt, besteht der einzige Formatierungs Unterschied zwischen den einzelnen Produkten darin, dass die Hintergrundfarbe wechselt.</span><span class="sxs-lookup"><span data-stu-id="d85d2-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>

<span data-ttu-id="d85d2-159">[![die Produkte im DataList-Steuerelement aufgelistet sind.](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d85d2-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="d85d2-160">**Abbildung 1**: die Produkte sind im DataList-Steuerelement aufgelistet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d85d2-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="d85d2-161">Im Rahmen dieses Tutorials können Sie den DataList so formatieren, dass alle Produkte mit einem Preis, der kleiner als $20,00 ist, den Namen und den Einheiten Preis gelb hervorheben.</span><span class="sxs-lookup"><span data-stu-id="d85d2-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="d85d2-162">Schritt 2: Programm gesteuertes bestimmen des Werts der Daten im itemdatdent-Ereignis Handler</span><span class="sxs-lookup"><span data-stu-id="d85d2-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="d85d2-163">Da nur für Produkte mit einem Preis unter $20,00 die benutzerdefinierte Formatierung angewendet wird, müssen wir den Preis jedes Produkts ermitteln können.</span><span class="sxs-lookup"><span data-stu-id="d85d2-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="d85d2-164">Beim Binden von Daten an einen DataList listet der DataList die Datensätze in der Datenquelle auf und erstellt für jeden Datensatz eine `DataListItem`-Instanz, die den Datenquellen Daten Satz an die `DataListItem`bindet.</span><span class="sxs-lookup"><span data-stu-id="d85d2-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="d85d2-165">Nachdem die Daten des jeweiligen Datensatzes an das aktuelle `DataListItem` Objekt gebunden wurden, wird das DataList s `ItemDataBound`-Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="d85d2-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="d85d2-166">Wir können einen Ereignishandler für dieses Ereignis erstellen, um die Datenwerte für die aktuelle `DataListItem` zu überprüfen. basierend auf diesen Werten nehmen Sie alle erforderlichen Formatierungs Änderungen vor.</span><span class="sxs-lookup"><span data-stu-id="d85d2-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="d85d2-167">Erstellen Sie ein `ItemDataBound` Ereignis für den DataList, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="d85d2-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample1.vb)]

<span data-ttu-id="d85d2-168">Obwohl das Konzept und die Semantik hinter dem DataList s `ItemDataBound`-Ereignishandler mit denen des GridView s `RowDataBound`-Ereignis Handlers in der *benutzerdefinierten Formatierung auf der Grundlage von datenlern* Programmen identisch sind, unterscheidet sich die Syntax leicht.</span><span class="sxs-lookup"><span data-stu-id="d85d2-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="d85d2-169">Wenn das `ItemDataBound`-Ereignis ausgelöst wird, werden die `DataListItem`, die nur an Daten gebunden sind, über `e.Item` an den entsprechenden Ereignishandler geleitet (anstatt `e.Row`, wie bei dem GridView s `RowDataBound`-Ereignishandler).</span><span class="sxs-lookup"><span data-stu-id="d85d2-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="d85d2-170">Der DataList s `ItemDataBound`-Ereignishandler wird für *jede* Zeile ausgelöst, die dem DataList hinzugefügt wird, einschließlich Header Zeilen, footerzeilen und Trennzeichen Zeilen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="d85d2-171">Die Produktinformationen sind jedoch nur an die Daten Zeilen gebunden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="d85d2-172">Wenn Sie das `ItemDataBound`-Ereignis verwenden, um die Daten zu überprüfen, die an den DataList gebunden sind, müssen wir daher zunächst sicherstellen, dass wir mit einem Datenelement arbeiten.</span><span class="sxs-lookup"><span data-stu-id="d85d2-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="d85d2-173">Dies können Sie erreichen, indem Sie die `DataListItem` s [`ItemType`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx)überprüfen, die einen der [folgenden acht Werte](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx)aufweisen kann:</span><span class="sxs-lookup"><span data-stu-id="d85d2-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="d85d2-174">Sowohl `Item` als auch `AlternatingItem``DataListItem` s werden die Datenelemente der DataList-Datenelemente zusammen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="d85d2-175">Wenn wir mit einer `Item` oder `AlternatingItem`arbeiten, greifen wir auf die tatsächliche `ProductsRow` Instanz zu, die an den aktuellen `DataListItem`gebunden war.</span><span class="sxs-lookup"><span data-stu-id="d85d2-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="d85d2-176">Die `DataListItem` s [`DataItem`-Eigenschaft](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) enthält einen Verweis auf das `DataRowView`-Objekt, dessen `Row`-Eigenschaft einen Verweis auf das tatsächliche `ProductsRow` Objekt bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="d85d2-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="d85d2-177">Als nächstes überprüfen wir die `ProductsRow` Instanz s `UnitPrice`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d85d2-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="d85d2-178">Da in der Tabelle "Products" der Tabelle "`UnitPrice`" `NULL` Werte zulässig sind, sollten Sie vor dem Zugriff auf die `UnitPrice` Eigenschaft zunächst überprüfen, ob Sie über einen `NULL` Wert verfügt, indem Sie die `IsUnitPriceNull()`-Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="d85d2-179">Wenn der `UnitPrice` Wert nicht `NULL`ist, überprüfen wir, ob er kleiner als $20,00 ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="d85d2-180">Wenn Sie tatsächlich unter $20,00 ist, müssen wir die benutzerdefinierte Formatierung anwenden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="d85d2-181">Schritt 3: Hervorheben des Namens und des Preises des Produkts</span><span class="sxs-lookup"><span data-stu-id="d85d2-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="d85d2-182">Sobald wir wissen, dass der Preis eines Produkts kleiner als $20,00 ist, muss nur noch der Name und der Preis hervorgehoben werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="d85d2-183">Um dies zu erreichen, müssen wir zunächst in den `ItemTemplate`, die den Namen und den Preis des Produkts anzeigen, Programm gesteuert auf die Bezeichnungs Steuerelemente verweisen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="d85d2-184">Als nächstes müssen Sie einen gelben Hintergrund anzeigen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="d85d2-185">Diese Formatierungsinformationen können angewendet werden, indem die Bezeichnungen `BackColor` Eigenschaften (`LabelID.BackColor = Color.Yellow`) direkt geändert werden. im Idealfall sollten jedoch alle Anzeige bezogenen Aspekte über Cascading Stylesheets ausgedrückt werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="d85d2-186">Tatsächlich verfügen wir bereits über ein Stylesheet, das die gewünschte Formatierung bereitstellt, die in `Styles.css` - `AffordablePriceEmphasis`definiert ist, die im Tutorial *benutzerdefinierte Formatierung basierend auf Daten* erstellt und erläutert wurde.</span><span class="sxs-lookup"><span data-stu-id="d85d2-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="d85d2-187">Um die Formatierung anzuwenden, legen Sie einfach die zwei Beschriftungs-websteuer Elemente `CssClass` Eigenschaften auf `AffordablePriceEmphasis`fest, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="d85d2-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample2.vb)]

<span data-ttu-id="d85d2-188">Nachdem der `ItemDataBound`-Ereignishandler abgeschlossen ist, überprüfen Sie die `Formatting.aspx` Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="d85d2-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="d85d2-189">Wie Abbildung 2 zeigt, werden für diese Produkte mit einem Preis unter $20,00 sowohl der Name als auch der Preis hervorgehoben.</span><span class="sxs-lookup"><span data-stu-id="d85d2-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>

<span data-ttu-id="d85d2-190">[![diese Produkte, die kleiner als $20,00 sind, hervorgehoben](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d85d2-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image4.png)</span></span>

<span data-ttu-id="d85d2-191">**Abbildung 2**: diese Produkte, die kleiner als $20,00 sind, werden hervorgehoben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d85d2-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d85d2-192">Da der DataList als HTML-`<table>`gerendert wird, verfügen seine `DataListItem` Instanzen über Stil bezogene Eigenschaften, die so festgelegt werden können, dass ein bestimmter Stil auf das gesamte Element angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="d85d2-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="d85d2-193">Wenn beispielsweise das *gesamte* Element gelb hervorgehoben werden soll, wenn der Preis kleiner als $20,00 ist, könnten wir den Code ersetzen, der auf die Bezeichnungen verwiesen hat, und ihre `CssClass` Eigenschaften mit der folgenden Codezeile festlegen: `e.Item.CssClass = "AffordablePriceEmphasis"` (siehe Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="d85d2-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>

<span data-ttu-id="d85d2-194">Die `RepeaterItem` en, die das Repeater-Steuerelement bilden, bieten jedoch keine Eigenschaften auf Stilebene.</span><span class="sxs-lookup"><span data-stu-id="d85d2-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="d85d2-195">Daher erfordert das Anwenden der benutzerdefinierten Formatierung auf den Repeater die Anwendung der Stileigenschaften auf die websteuer Elemente innerhalb der Repeater s-Vorlagen, wie in Abbildung 2 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d85d2-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>

<span data-ttu-id="d85d2-196">[![das gesamte Produkt Element für Produkte unter $20,00 hervorgehoben ist](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d85d2-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image7.png)</span></span>

<span data-ttu-id="d85d2-197">**Abbildung 3**: das gesamte Produkt Element wird für Produkte unter $20,00 hervorgehoben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d85d2-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image9.png))</span></span>

## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="d85d2-198">Verwenden von Formatierungsfunktionen innerhalb der Vorlage</span><span class="sxs-lookup"><span data-stu-id="d85d2-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="d85d2-199">Im Tutorial *Verwenden von templatefields im GridView-Steuer* Element wurde erläutert, wie Sie eine Formatierungsfunktion innerhalb eines GridView-TemplateField verwenden können, um eine benutzerdefinierte Formatierung basierend auf den Daten, die an die GridView s-Zeilen gebunden sind, anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="d85d2-200">Eine Formatierungsfunktion ist eine Methode, die aus einer Vorlage aufgerufen werden kann, und gibt den HTML-Code zurück, der an seiner Stelle ausgegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="d85d2-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="d85d2-201">Formatierungsfunktionen können sich in der Code Behind-Klasse der ASP.net page s befinden oder in Klassendateien im `App_Code` Ordner oder in einem separaten Klassen Bibliotheksprojekt zentralisiert werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="d85d2-202">Das Verschieben der Formatierungsfunktion aus der Code Behind-Klasse der ASP.net page s ist ideal, wenn Sie die gleiche Formatierungsfunktion auf mehreren ASP.NET-Seiten oder in anderen ASP.NET-Webanwendungen verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="d85d2-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="d85d2-203">Um Formatierungsfunktionen zu veranschaulichen, lassen Sie die Produktinformationen den Text [nicht eingestellt] neben dem Namen des Produkts enthalten, wenn er nicht mehr unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="d85d2-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="d85d2-204">Lassen Sie außerdem den Preis gelb hervorheben, wenn er kleiner als $20,00 ist (wie im Beispiel für den `ItemDataBound` Ereignishandler). Wenn der Preis $20,00 oder höher ist, lassen Sie den tatsächlichen Preis nicht anzeigen, sondern geben Sie für ein Preisangebot ein.</span><span class="sxs-lookup"><span data-stu-id="d85d2-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="d85d2-205">Abbildung 4 zeigt einen Screenshot der Produkt Auflistung, auf die diese Formatierungs Regeln angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>

<span data-ttu-id="d85d2-206">[![für teure Produkte wird der Preis durch den Text ersetzt. Rufen Sie ein Preisangebot auf.](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d85d2-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image10.png)</span></span>

<span data-ttu-id="d85d2-207">**Abbildung 4**: für teure Produkte wird der Preis durch den Text ersetzt. Rufen Sie ein Preisangebot auf ([Klicken Sie, um das Bild in voller Größe anzuzeigen](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="d85d2-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image12.png))</span></span>

## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="d85d2-208">Schritt 1: Erstellen der Formatierungsfunktionen</span><span class="sxs-lookup"><span data-stu-id="d85d2-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="d85d2-209">Für dieses Beispiel benötigen wir zwei Formatierungsfunktionen: eine, die den Produktnamen zusammen mit dem Text anzeigt, bei Bedarf, und einen weiteren, der entweder einen hervorgehobenen Preis anzeigt, wenn er kleiner als $20,00 ist, oder den Text, um ein Preisangebot zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="d85d2-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="d85d2-210">Erstellen Sie diese Funktionen in der Code Behind-Klasse der ASP.net page s, und benennen Sie Sie `DisplayProductNameAndDiscontinuedStatus` und `DisplayPrice`.</span><span class="sxs-lookup"><span data-stu-id="d85d2-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="d85d2-211">Beide Methoden müssen den HTML-Code zurückgeben, der als Zeichenfolge dargestellt werden soll, und beide müssen `Protected` (oder `Public`) markiert werden, damit Sie aus dem deklarativen Syntax Bereich der ASP.net page s aufgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="d85d2-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="d85d2-212">Der Code für diese beiden Methoden folgt:</span><span class="sxs-lookup"><span data-stu-id="d85d2-212">The code for these two methods follows:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample3.vb)]

<span data-ttu-id="d85d2-213">Beachten Sie, dass die `DisplayProductNameAndDiscontinuedStatus`-Methode die Werte der Datenfelder `productName` und `discontinued` als skalare Werte akzeptiert, während die `DisplayPrice`-Methode eine `ProductsRow` Instanz akzeptiert (anstatt einen `unitPrice` skalaren Wert).</span><span class="sxs-lookup"><span data-stu-id="d85d2-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="d85d2-214">Beide Vorgehensweisen funktionieren. Wenn die Formatierungsfunktion jedoch mit Skalarwerten arbeitet, die Datenbank-`NULL` Werte enthalten können (z. b. `UnitPrice`, weder `ProductName` noch `Discontinued` `NULL` Werte zulassen), muss bei der Verarbeitung dieser skalaren Eingaben besonders darauf geachtet werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="d85d2-215">Insbesondere muss der Eingabeparameter vom Typ "`Object`" sein, da der eingehende Wert möglicherweise eine `DBNull` Instanz anstelle des erwarteten Datentyps ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="d85d2-216">Außerdem muss überprüft werden, ob der eingehende Wert ein Daten Bank `NULL` Wert ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="d85d2-217">Das heißt, wenn die `DisplayPrice`-Methode den Preis als Skalarwert akzeptieren soll, müssen wir den folgenden Code verwenden:</span><span class="sxs-lookup"><span data-stu-id="d85d2-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>

[!code-vb[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample4.vb)]

<span data-ttu-id="d85d2-218">Beachten Sie, dass der `unitPrice` Eingabeparameter vom Typ `Object` ist und dass die bedingte Anweisung geändert wurde, um zu ermitteln, ob `unitPrice` `DBNull` ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="d85d2-219">Da der `unitPrice` Eingabeparameter als `Object`übergeben wird, muss er außerdem in einen Dezimalwert umgewandelt werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="d85d2-220">Schritt 2: Aufrufen der Formatierungsfunktion aus dem DataList ItemTemplate-Element</span><span class="sxs-lookup"><span data-stu-id="d85d2-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="d85d2-221">Mit den Formatierungsfunktionen, die der ASP.net page s Code-Behind-Klasse hinzugefügt werden, besteht nur noch das Aufrufen dieser Formatierungsfunktionen aus dem DataList-`ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d85d2-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="d85d2-222">Um eine Formatierungsfunktion aus einer Vorlage aufzurufen, platzieren Sie den Funktions Aufrufsatz in der Datenbindung-Syntax:</span><span class="sxs-lookup"><span data-stu-id="d85d2-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample5.aspx)]

<span data-ttu-id="d85d2-223">In den DataList s `ItemTemplate` das websteuer Element `ProductNameLabel` Bezeichnung den Namen des Produkts zurzeit anzeigt, indem er seine `Text`-Eigenschaft dem Ergebnis `<%# Eval("ProductName") %>`zuweist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="d85d2-224">Um den Namen und den Text [nicht eingestellt] anzuzeigen, aktualisieren Sie ggf. die deklarative Syntax, sodass Sie stattdessen die `Text`-Eigenschaft dem Wert der `DisplayProductNameAndDiscontinuedStatus`-Methode zuweist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="d85d2-225">Dabei müssen wir den Namen des Produkts und die nicht mehr unterstützten Werte mithilfe der `Eval("columnName")`-Syntax übergeben.</span><span class="sxs-lookup"><span data-stu-id="d85d2-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="d85d2-226">`Eval` gibt einen Wert vom Typ `Object`zurück, aber die `DisplayProductNameAndDiscontinuedStatus`-Methode erwartet Eingabeparameter vom Typ `String` und `Boolean`; Daher müssen wir die von der `Eval`-Methode zurückgegebenen Werte wie folgt in die erwarteten Eingabeparameter Typen umwandeln:</span><span class="sxs-lookup"><span data-stu-id="d85d2-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample6.aspx)]

<span data-ttu-id="d85d2-227">Um den Preis anzuzeigen, können wir einfach die `UnitPriceLabel` Bezeichnung s `Text`-Eigenschaft auf den Wert festlegen, der von der `DisplayPrice`-Methode zurückgegeben wird, ebenso wie bei der Anzeige des Product s-namens und des [nicht mehr unterstützten] Texts.</span><span class="sxs-lookup"><span data-stu-id="d85d2-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="d85d2-228">Anstatt jedoch die `UnitPrice` als skalaren Eingabeparameter zu übergeben, übergeben wir stattdessen die gesamte `ProductsRow` Instanz:</span><span class="sxs-lookup"><span data-stu-id="d85d2-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-vb/samples/sample7.aspx)]

<span data-ttu-id="d85d2-229">Nehmen Sie mit den Aufrufen der Formatierungsfunktionen einen Moment Zeit, um den Fortschritt in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="d85d2-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="d85d2-230">Ihr Bildschirm sollte in etwa wie in Abbildung 5 aussehen, wobei die nicht mehr unterstützten Produkte, einschließlich des Texts [nicht eingestellt], und der Produkte, die mehr als $20,00 haben, mit dem entsprechenden Preis durch den Text für ein Preisangebot ersetzt werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>

<span data-ttu-id="d85d2-231">[![für teure Produkte wird der Preis durch den Text ersetzt. Rufen Sie ein Preisangebot auf.](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d85d2-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image13.png)</span></span>

<span data-ttu-id="d85d2-232">**Abbildung 5**: für teure Produkte wird der Preis durch den Text ersetzt. Rufen Sie ein Preisangebot auf ([Klicken Sie, um das Bild in voller Größe anzuzeigen](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="d85d2-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-vb/_static/image15.png))</span></span>

## <a name="summary"></a><span data-ttu-id="d85d2-233">Summary</span><span class="sxs-lookup"><span data-stu-id="d85d2-233">Summary</span></span>

<span data-ttu-id="d85d2-234">Das Formatieren des Inhalts eines DataList-oder Repeater-Steuer Elements basierend auf den Daten kann mithilfe von zwei Verfahren durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="d85d2-235">Die erste Methode ist das Erstellen eines Ereignis Handlers für das `ItemDataBound`-Ereignis, das ausgelöst wird, wenn jeder Datensatz in der Datenquelle an einen neuen `DataListItem` oder `RepeaterItem`gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="d85d2-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="d85d2-236">Im `ItemDataBound`-Ereignishandler können die aktuellen Elementdaten untersucht werden, und dann kann die Formatierung auf den Inhalt der Vorlage oder, für `DataListItem` s, auf das gesamte Element selbst angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="d85d2-237">Alternativ kann die benutzerdefinierte Formatierung durch Formatierungsfunktionen realisiert werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="d85d2-238">Eine Formatierungsfunktion ist eine Methode, die aus den Vorlagen DataList oder Repeater s aufgerufen werden kann, die den HTML-Code zurückgibt, der an seiner Stelle ausgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="d85d2-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="d85d2-239">Häufig wird der von einer Formatierungsfunktion zurückgegebene HTML-Wert durch die Werte bestimmt, die an das aktuelle Element gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="d85d2-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="d85d2-240">Diese Werte können an die Formatierungsfunktion übergeben werden, entweder als skalare Werte oder durch Übergeben des gesamten Objekts, das an das Element gebunden ist (z. b. die `ProductsRow` Instanz).</span><span class="sxs-lookup"><span data-stu-id="d85d2-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="d85d2-241">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="d85d2-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d85d2-242">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="d85d2-242">About the Author</span></span>

<span data-ttu-id="d85d2-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="d85d2-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d85d2-244">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="d85d2-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d85d2-245">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d85d2-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d85d2-246">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d85d2-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d85d2-247">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d85d2-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d85d2-248">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="d85d2-248">Special Thanks To</span></span>

<span data-ttu-id="d85d2-249">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="d85d2-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d85d2-250">Führende Prüfer für dieses Tutorial waren Yaakov Ellis, Randy Schmidt und Liz shulok.</span><span class="sxs-lookup"><span data-stu-id="d85d2-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="d85d2-251">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="d85d2-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d85d2-252">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d85d2-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d85d2-253">[Zurück](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
> [Weiter](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d85d2-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-vb.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-vb.md)</span></span>
