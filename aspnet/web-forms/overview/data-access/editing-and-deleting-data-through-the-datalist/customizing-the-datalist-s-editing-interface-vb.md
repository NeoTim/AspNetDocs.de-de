---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
title: Anpassen der Bearbeitungs Schnittstelle von DataList (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial erstellen wir eine umfassendere Bearbeitungs Schnittstelle für DataList, eine mit Dropdown Listen und ein Kontrollkästchen.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 718628e2-224c-455f-b33a-a41efd48d5a0
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: adee419764cff2f39ee16962080c24b52553aa14
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78480459"
---
# <a name="customizing-the-datalists-editing-interface-vb"></a><span data-ttu-id="67e6c-103">Anpassen der Oberfläche für die Bearbeitung von DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="67e6c-103">Customizing the DataList's Editing Interface (VB)</span></span>

<span data-ttu-id="67e6c-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="67e6c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="67e6c-105">[Beispiel-app herunterladen](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) oder [PDF herunterladen](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="67e6c-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) or [Download PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span></span>

> <span data-ttu-id="67e6c-106">In diesem Tutorial erstellen wir eine umfassendere Bearbeitungs Schnittstelle für DataList, eine mit Dropdown Listen und ein Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-106">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span>

## <a name="introduction"></a><span data-ttu-id="67e6c-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="67e6c-107">Introduction</span></span>

<span data-ttu-id="67e6c-108">Das Markup und die websteuer Elemente in den DataList-`EditItemTemplate` definieren seine bearbeitbare Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="67e6c-108">The markup and Web controls in the DataList s `EditItemTemplate` define its editable interface.</span></span> <span data-ttu-id="67e6c-109">In allen bearbeitbaren DataList-Beispielen, die wir bisher geprüft haben, besteht die editierbare Schnittstelle aus TextBox-websteuer Elementen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-109">In all of the editable DataList examples we ve examined thus far, the editable interface has been composed of TextBox Web controls.</span></span> <span data-ttu-id="67e6c-110">Im [vorangehenden Tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) haben wir die Benutzeroberflächen zur Bearbeitungszeit durch Hinzufügen von Validierungs Steuerelementen verbessert.</span><span class="sxs-lookup"><span data-stu-id="67e6c-110">In the [preceding tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) we improved the edit-time user experience by adding validation controls.</span></span>

<span data-ttu-id="67e6c-111">Der `EditItemTemplate` kann erweitert werden, um andere websteuer Elemente als das Textfeld einzuschließen, z. b. Dropdown Listen, RadioButton Lists, Kalender usw.</span><span class="sxs-lookup"><span data-stu-id="67e6c-111">The `EditItemTemplate` can be further expanded to include Web controls other than the TextBox, such as DropDownLists, RadioButtonLists, Calendars, and so on.</span></span> <span data-ttu-id="67e6c-112">Wie bei Textfeldern können Sie die folgenden Schritte ausführen, wenn Sie die Bearbeitungs Schnittstelle anpassen, um andere websteuer Elemente einzuschließen:</span><span class="sxs-lookup"><span data-stu-id="67e6c-112">As with TextBoxes, when customizing the editing interface to include other Web controls, employ the following steps:</span></span>

1. <span data-ttu-id="67e6c-113">Fügen Sie dem `EditItemTemplate`das websteuer Element hinzu.</span><span class="sxs-lookup"><span data-stu-id="67e6c-113">Add the Web control to the `EditItemTemplate`.</span></span>
2. <span data-ttu-id="67e6c-114">Verwenden Sie die Datenbindung-Syntax, um der entsprechenden Eigenschaft den entsprechenden Daten Feldwert zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-114">Use databinding syntax to assign the corresponding data field value to the appropriate property.</span></span>
3. <span data-ttu-id="67e6c-115">Greifen Sie im `UpdateCommand`-Ereignishandler Programm gesteuert auf den Wert des websteuer Elements zu, und übergeben Sie ihn an die entsprechende BLL-Methode.</span><span class="sxs-lookup"><span data-stu-id="67e6c-115">In the `UpdateCommand` event handler, programmatically access the Web control value and pass it into the appropriate BLL method.</span></span>

<span data-ttu-id="67e6c-116">In diesem Tutorial erstellen wir eine umfassendere Bearbeitungs Schnittstelle für DataList, eine mit Dropdown Listen und ein Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-116">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span> <span data-ttu-id="67e6c-117">Insbesondere erstellen wir einen DataList, der Produktinformationen auflistet und es gestattet, dass der Name, der Lieferant, die Kategorie und der nicht mehr unterstützte Status aktualisiert werden (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="67e6c-117">In particular, we'll create a DataList that lists product information and permits the product s name, supplier, category, and discontinued status to be updated (see Figure 1).</span></span>

<span data-ttu-id="67e6c-118">[![die Bearbeitungs Schnittstelle ein Textfeld, zwei Dropdown Listen und ein Kontrollkästchen enthält.](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-118">[![The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="67e6c-119">**Abbildung 1**: die Bearbeitungs Schnittstelle enthält ein Textfeld, zwei Dropdown Listen und ein Kontrollkästchen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="67e6c-119">**Figure 1**: The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="67e6c-120">Schritt 1: Anzeigen von Produktinformationen</span><span class="sxs-lookup"><span data-stu-id="67e6c-120">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="67e6c-121">Bevor wir die editierbare Schnittstelle von DataList erstellen können, müssen wir zuerst die schreibgeschützte Schnittstelle erstellen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-121">Before we can create the DataList s editable interface, we first need to build the read-only interface.</span></span> <span data-ttu-id="67e6c-122">Öffnen Sie zunächst die Seite `CustomizedUI.aspx` aus dem Ordner `EditDeleteDataList`, und fügen Sie im Designer der Seite einen DataList hinzu, und legen Sie dessen `ID`-Eigenschaft auf `Products`fest.</span><span class="sxs-lookup"><span data-stu-id="67e6c-122">Start by opening the `CustomizedUI.aspx` page from the `EditDeleteDataList` folder and, from the Designer, add a DataList to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="67e6c-123">Erstellen Sie aus dem DataList s Smarttags eine neue ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="67e6c-123">From the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="67e6c-124">Benennen Sie diese neue ObjectDataSource-`ProductsDataSource`, und konfigurieren Sie Sie so, dass Sie Daten aus der `ProductsBLL` Class s `GetProducts`-Methode abruft.</span><span class="sxs-lookup"><span data-stu-id="67e6c-124">Name this new ObjectDataSource `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="67e6c-125">Wie bei den vorherigen bearbeitbaren DataList-Lernprogrammen aktualisieren wir die bearbeiteten Produkt-e-Informationen, indem wir direkt zur Geschäftslogik Schicht gehen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-125">As with the previous editable DataList tutorials, we'll update the edited product s information by going directly to the Business Logic Layer.</span></span> <span data-ttu-id="67e6c-126">Legen Sie entsprechend die Dropdown Listen auf den Registerkarten Update, INSERT und DELETE auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="67e6c-126">Accordingly, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span>

<span data-ttu-id="67e6c-127">[![die Dropdown Listen Update, INSERT und DELETE Registerkarten auf (keine) festgelegt.](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-127">[![Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="67e6c-128">**Abbildung 2**: Festlegen der Dropdown Listen für das Aktualisieren, einfügen und Löschen von Registerkarten auf (keine) ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-128">**Figure 2**: Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>

<span data-ttu-id="67e6c-129">Nach dem Konfigurieren von ObjectDataSource erstellt Visual Studio eine Standard `ItemTemplate` für den DataList, der den Namen und den Wert für jedes der zurückgegebenen Datenfelder auflistet.</span><span class="sxs-lookup"><span data-stu-id="67e6c-129">After configuring the ObjectDataSource, Visual Studio will create a default `ItemTemplate` for the DataList that lists the name and value for each of the data fields returned.</span></span> <span data-ttu-id="67e6c-130">Ändern Sie die `ItemTemplate` so, dass die Vorlage den Produktnamen in einem `<h4>`-Element zusammen mit dem Kategoriename, dem Lieferanten Namen, dem Preis und dem Status "eingestellt" auflistet.</span><span class="sxs-lookup"><span data-stu-id="67e6c-130">Modify the `ItemTemplate` so that the template lists the product name in an `<h4>` element along with the category name, supplier name, price, and discontinued status.</span></span> <span data-ttu-id="67e6c-131">Fügen Sie außerdem eine Bearbeitungs Schaltfläche hinzu, um sicherzustellen, dass die `CommandName`-Eigenschaft auf Bearbeiten festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="67e6c-131">Moreover, add an Edit button, making sure that its `CommandName` property is set to Edit.</span></span> <span data-ttu-id="67e6c-132">Das deklarative Markup für meine `ItemTemplate` folgt:</span><span class="sxs-lookup"><span data-stu-id="67e6c-132">The declarative markup for my `ItemTemplate` follows:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="67e6c-133">Das obige Markup legt die Produktinformationen mithilfe einer &lt;H4-&gt; Überschrift für den Product s-Namen und eine vier spaltige `<table>` für die restlichen Felder fest.</span><span class="sxs-lookup"><span data-stu-id="67e6c-133">The above markup lays out the product information using an &lt;h4&gt; heading for the product s name and a four-column `<table>` for the remaining fields.</span></span> <span data-ttu-id="67e6c-134">Die `ProductPropertyLabel`-und `ProductPropertyValue` CSS-Klassen, die in `Styles.css`definiert sind, wurden in den vorherigen Tutorials erläutert.</span><span class="sxs-lookup"><span data-stu-id="67e6c-134">The `ProductPropertyLabel` and `ProductPropertyValue` CSS classes, defined in `Styles.css`, have been discussed in previous tutorials.</span></span> <span data-ttu-id="67e6c-135">In Abbildung 3 wird der Fortschritt angezeigt, wenn ein Browser angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="67e6c-135">Figure 3 shows our progress when viewed through a browser.</span></span>

<span data-ttu-id="67e6c-136">[![der Name, der Lieferant, die Kategorie, der nicht mehr unterstützte Status und der Preis der einzelnen Produkte angezeigt.](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-136">[![The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="67e6c-137">**Abbildung 3**: der Name, der Lieferant, die Kategorie, der nicht mehr unterstützte Status und der Preis der einzelnen Produkte werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-137">**Figure 3**: The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>

## <a name="step-2-adding-the-web-controls-to-the-editing-interface"></a><span data-ttu-id="67e6c-138">Schritt 2: Hinzufügen der websteuer Elemente zur Bearbeitungs Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="67e6c-138">Step 2: Adding the Web Controls to the Editing Interface</span></span>

<span data-ttu-id="67e6c-139">Der erste Schritt beim Aufbau der angepassten DataList-Bearbeitungs Schnittstelle besteht darin, dem `EditItemTemplate`die erforderlichen websteuer Elemente hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-139">The first step in building the customized DataList editing interface is to add the needed Web controls to the `EditItemTemplate`.</span></span> <span data-ttu-id="67e6c-140">Insbesondere benötigen wir eine Dropdown List für die Kategorie, eine für den Lieferanten und ein Kontrollkästchen für den nicht unterstützten Zustand.</span><span class="sxs-lookup"><span data-stu-id="67e6c-140">In particular, we need a DropDownList for the category, another for the supplier, and a CheckBox for the discontinued state.</span></span> <span data-ttu-id="67e6c-141">Da der Preis des Produkts in diesem Beispiel nicht bearbeitbar ist, können wir ihn mit einem Label-websteuer Element weiter anzeigen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-141">Since the product s price is not editable in this example, we can continue displaying it using a Label Web control.</span></span>

<span data-ttu-id="67e6c-142">Um die Bearbeitungs Schnittstelle anzupassen, klicken Sie auf den Link Vorlagen bearbeiten des Smarttags DataList s, und wählen Sie die Option `EditItemTemplate` aus der Dropdown Liste aus.</span><span class="sxs-lookup"><span data-stu-id="67e6c-142">To customize the editing interface, click on the Edit Templates link from the DataList s smart tag and choose the `EditItemTemplate` option from the drop-down list.</span></span> <span data-ttu-id="67e6c-143">Fügen Sie dem `EditItemTemplate` eine DropDownList hinzu, und legen Sie dessen `ID` auf `Categories`fest.</span><span class="sxs-lookup"><span data-stu-id="67e6c-143">Add a DropDownList to the `EditItemTemplate` and set its `ID` to `Categories`.</span></span>

<span data-ttu-id="67e6c-144">[![eine Dropdown Liste für die Kategorien hinzufügen.](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-144">[![Add a DropDownList for the Categories](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="67e6c-145">**Abbildung 4**: Hinzufügen einer Dropdown Liste für die Kategorien ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-145">**Figure 4**: Add a DropDownList for the Categories ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>

<span data-ttu-id="67e6c-146">Wählen Sie als nächstes im Smarttags DropDownList s die Option Datenquelle auswählen aus, und erstellen Sie eine neue ObjectDataSource mit dem Namen `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="67e6c-146">Next, from the DropDownList s smart tag, select the Choose Data Source option and create a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="67e6c-147">Konfigurieren Sie diese ObjectDataSource für die Verwendung der `CategoriesBLL` Class `GetCategories()`-Methode (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="67e6c-147">Configure this ObjectDataSource to use the `CategoriesBLL` class s `GetCategories()` method (see Figure 5).</span></span> <span data-ttu-id="67e6c-148">Anschließend fordert der Assistent zum Konfigurieren der Dropdown List s-Datenquelle die Datenfelder an, die für die einzelnen `ListItem` s `Text` und `Value` Eigenschaften verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-148">Next, the DropDownList s Data Source Configuration Wizard prompts for the data fields to use for each `ListItem` s `Text` and `Value` properties.</span></span> <span data-ttu-id="67e6c-149">Legen Sie in der Dropdown Liste das Feld für die `CategoryName` Daten und die `CategoryID` als Wert, wie in Abbildung 6 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-149">Have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value, as shown in Figure 6.</span></span>

<span data-ttu-id="67e6c-150">[![erstellen Sie eine neue ObjectDataSource mit dem Namen "categoriesdatasource".](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-150">[![Create a New ObjectDataSource Named CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="67e6c-151">**Abbildung 5**: Erstellen einer neuen ObjectDataSource mit dem Namen "`CategoriesDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-151">**Figure 5**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>

<span data-ttu-id="67e6c-152">[![die Felder "DropDownList s Display" und "Value" konfigurieren.](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-152">[![Configure the DropDownList s Display and Value Fields](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="67e6c-153">**Abbildung 6**: Konfigurieren der Felder "DropDownList s Display" und "Value" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-153">**Figure 6**: Configure the DropDownList s Display and Value Fields ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>

<span data-ttu-id="67e6c-154">Wiederholen Sie diese Schritte, um eine Dropdown List für die Lieferanten zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-154">Repeat this series of steps to create a DropDownList for the suppliers.</span></span> <span data-ttu-id="67e6c-155">Legen Sie den `ID` für diese Dropdown Liste auf `Suppliers` fest, und benennen Sie die ObjectDataSource-`SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="67e6c-155">Set the `ID` for this DropDownList to `Suppliers` and name its ObjectDataSource `SuppliersDataSource`.</span></span>

<span data-ttu-id="67e6c-156">Nachdem Sie die beiden Dropdown Listen hinzugefügt haben, fügen Sie ein Kontrollkästchen für den Status "eingestellt" und ein Textfeld für den Namen des Produkts hinzu.</span><span class="sxs-lookup"><span data-stu-id="67e6c-156">After adding the two DropDownLists, add a CheckBox for the discontinued state and a TextBox for the product s name.</span></span> <span data-ttu-id="67e6c-157">Legen Sie die `ID` s für das Kontrollkästchen und Textfeld auf `Discontinued` bzw. `ProductName`fest.</span><span class="sxs-lookup"><span data-stu-id="67e6c-157">Set the `ID` s for the CheckBox and TextBox to `Discontinued` and `ProductName`, respectively.</span></span> <span data-ttu-id="67e6c-158">Fügen Sie ein "Requirements dfieldvalidator" hinzu, um sicherzustellen, dass der Benutzer einen Wert für den Namen des Produkts bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-158">Add a RequiredFieldValidator to ensure that the user provides a value for the product s name.</span></span>

<span data-ttu-id="67e6c-159">Fügen Sie abschließend die Schaltflächen aktualisieren und Abbrechen hinzu.</span><span class="sxs-lookup"><span data-stu-id="67e6c-159">Lastly, add the Update and Cancel buttons.</span></span> <span data-ttu-id="67e6c-160">Beachten Sie, dass es für diese beiden Schaltflächen zwingend erforderlich ist, dass die `CommandName` Eigenschaften auf aktualisieren bzw. Abbrechen festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="67e6c-160">Remember that for these two buttons it is imperative that their `CommandName` properties are set to Update and Cancel, respectively.</span></span>

<span data-ttu-id="67e6c-161">Sie können die Bearbeitungs Schnittstelle beliebig gestalten.</span><span class="sxs-lookup"><span data-stu-id="67e6c-161">Feel free to lay out the editing interface however you like.</span></span> <span data-ttu-id="67e6c-162">Ich habe mich für die Verwendung desselben vier spaltigen `<table>` Layouts von der schreibgeschützten Oberfläche entschieden, wie die folgende deklarative Syntax und der folgende Screenshot veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="67e6c-162">I ve opted to use the same four-column `<table>` layout from the read-only interface, as the following declarative syntax and screen shot illustrates:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample2.aspx)]

<span data-ttu-id="67e6c-163">[![die Bearbeitungs Schnittstelle wie die schreibgeschützte Schnittstelle angelegt ist.](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-163">[![The Editing Interface is Laid Out like the Read-Only Interface](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span></span>

<span data-ttu-id="67e6c-164">**Abbildung 7**: die Bearbeitungs Schnittstelle wird wie die schreibgeschützte Schnittstelle angeordnet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-164">**Figure 7**: The Editing Interface is Laid Out like the Read-Only Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span></span>

## <a name="step-3-creating-the-editcommand-and-cancelcommand-event-handlers"></a><span data-ttu-id="67e6c-165">Schritt 3: Erstellen der Ereignishandler EditCommand und CancelCommand</span><span class="sxs-lookup"><span data-stu-id="67e6c-165">Step 3: Creating the EditCommand and CancelCommand Event Handlers</span></span>

<span data-ttu-id="67e6c-166">Derzeit gibt es keine Datenbindung-Syntax in der `EditItemTemplate` (mit Ausnahme des `UnitPriceLabel`, das aus der `ItemTemplate`kopiert wurde).</span><span class="sxs-lookup"><span data-stu-id="67e6c-166">Currently, there is no databinding syntax in the `EditItemTemplate` (except for the `UnitPriceLabel`, which was copied over verbatim from the `ItemTemplate`).</span></span> <span data-ttu-id="67e6c-167">Die Datenbindung-Syntax wird vorübergehend hinzugefügt, aber zuerst werden die Ereignishandler für die DataList-`EditCommand` und `CancelCommand` Ereignisse erstellt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-167">We'll add the databinding syntax momentarily, but first let s create the event handlers for the DataList s `EditCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="67e6c-168">Beachten Sie, dass die Aufgabe des `EditCommand` Ereignis Handlers darin besteht, die Bearbeitungs Schnittstelle für das DataList-Element zu rendernden, auf dessen Bearbeitungs Schaltfläche geklickt wurde, während der `CancelCommand` s-Auftrag den DataList in den Zustand der vorabbearbeitung zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-168">Recall that the responsibility of the `EditCommand` event handler is to render the editing interface for the DataList item whose Edit button was clicked, whereas the `CancelCommand` s job is to return the DataList to its pre-editing state.</span></span>

<span data-ttu-id="67e6c-169">Erstellen Sie diese beiden Ereignishandler, und verwenden Sie den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="67e6c-169">Create these two event handlers and have them use the following code:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample3.vb)]

<span data-ttu-id="67e6c-170">Wenn diese beiden Ereignishandler vorhanden sind, wird durch Klicken auf die Schaltfläche Bearbeiten die Bearbeitungs Schnittstelle angezeigt. Wenn Sie auf die Schaltfläche Abbrechen klicken, wird das bearbeitete Element in den schreibgeschützten Modus zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="67e6c-170">With these two event handlers in place, clicking the Edit button displays the editing interface and clicking the Cancel button returns the edited item to its read-only mode.</span></span> <span data-ttu-id="67e6c-171">Abbildung 8 zeigt den DataList nach dem Klicken auf die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="67e6c-171">Figure 8 shows the DataList after the Edit button has been clicked for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="67e6c-172">Da wir eine beliebige Datenbindung-Syntax zur Bearbeitungs Schnittstelle hinzugefügt haben, ist das Textfeld `ProductName` leer, das Kontrollkästchen `Discontinued` deaktiviert und die ersten Elemente, die aus den Dropdown Listen `Categories` und `Suppliers` ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="67e6c-172">Since we ve yet to add any databinding syntax to the editing interface, the `ProductName` TextBox is blank, the `Discontinued` CheckBox unchecked, and the first items selected from the `Categories` and `Suppliers` DropDownLists.</span></span>

<span data-ttu-id="67e6c-173">[![klicken auf die Schaltfläche "Bearbeiten" zeigt die Bearbeitungs Schnittstelle an](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-173">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span></span>

<span data-ttu-id="67e6c-174">**Abbildung 8**: Klicken auf die Schaltfläche "Bearbeiten" zeigt die Bearbeitungs Schnittstelle[an (Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-174">**Figure 8**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span></span>

## <a name="step-4-adding-the-databinding-syntax-to-the-editing-interface"></a><span data-ttu-id="67e6c-175">Schritt 4: Hinzufügen der DataBinding-Syntax zur Bearbeitungs Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="67e6c-175">Step 4: Adding the DataBinding Syntax to the Editing Interface</span></span>

<span data-ttu-id="67e6c-176">Damit die Bearbeitungs Schnittstelle die aktuellen Product s-Werte anzeigt, müssen wir die Daten Feldwerte mithilfe der Datenbindung-Syntax den entsprechenden websteuer Element Werten zuweisen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-176">To have the editing interface display the current product s values, we need to use databinding syntax to assign the data field values to the appropriate Web control values.</span></span> <span data-ttu-id="67e6c-177">Die Datenbindung-Syntax kann über den Designer angewendet werden, indem Sie auf den Bildschirm Vorlagen bearbeiten klicken und den Link DataBindings bearbeiten aus den Smarttags für websteuer Elemente auswählen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-177">The databinding syntax can be applied through the Designer by going to the Edit Templates screen and selecting the Edit DataBindings link from the Web controls smart tags.</span></span> <span data-ttu-id="67e6c-178">Alternativ kann die Datenbindung-Syntax direkt dem deklarativen Markup hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="67e6c-178">Alternatively, the databinding syntax can be added directly to the declarative markup.</span></span>

<span data-ttu-id="67e6c-179">Weisen Sie den Wert `ProductName` Data Field der Eigenschaft `ProductName` TextBox s `Text`, die `CategoryID`-und `SupplierID` Daten Feldwerte den `Categories` Eigenschaften `Suppliers` und `SelectedValue` Dropdown Listen zu, und legen Sie den Wert `Discontinued` Daten Feldwert der `Discontinued`-Eigenschaft `Checked` CheckBox s.</span><span class="sxs-lookup"><span data-stu-id="67e6c-179">Assign the `ProductName` data field value to the `ProductName` TextBox s `Text` property, the `CategoryID` and `SupplierID` data field values to the `Categories` and `Suppliers` DropDownLists `SelectedValue` properties, and the `Discontinued` data field value to the `Discontinued` CheckBox s `Checked` property.</span></span> <span data-ttu-id="67e6c-180">Nachdem Sie diese Änderungen vorgenommen haben, entweder über den Designer oder direkt über das deklarative Markup, besuchen Sie die Seite über einen Browser, und klicken Sie auf die Schaltfläche Bearbeiten für Chef Anton s Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="67e6c-180">After making these changes, either through the Designer or directly through the declarative markup, revisit the page through a browser and click the Edit button for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="67e6c-181">Wie Abbildung 9 zeigt, hat die Datenbindung-Syntax die aktuellen Werte in das Textfeld, DropDownLists und CheckBox eingefügt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-181">As Figure 9 shows, the databinding syntax has added the current values into the TextBox, DropDownLists, and CheckBox.</span></span>

<span data-ttu-id="67e6c-182">[![klicken auf die Schaltfläche "Bearbeiten" zeigt die Bearbeitungs Schnittstelle an](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-182">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span></span>

<span data-ttu-id="67e6c-183">**Abbildung 9**: Klicken auf die Schaltfläche "Bearbeiten" zeigt die Bearbeitungs Schnittstelle[an (Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-183">**Figure 9**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span></span>

## <a name="step-5-saving-the-user-s-changes-in-the-updatecommand-event-handler"></a><span data-ttu-id="67e6c-184">Schritt 5: Speichern der Benutzer-e-Änderungen im UpdateCommand-Ereignis Handler</span><span class="sxs-lookup"><span data-stu-id="67e6c-184">Step 5: Saving the User s Changes in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="67e6c-185">Wenn der Benutzer ein Produkt bearbeitet und auf die Schaltfläche Aktualisieren klickt, erfolgt ein Postback, und das DataList s-`UpdateCommand` Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="67e6c-185">When the user edits a product and clicks the Update button, a postback occurs and the DataList s `UpdateCommand` event fires.</span></span> <span data-ttu-id="67e6c-186">Im-Ereignishandler müssen die Werte aus den websteuer Elementen in der `EditItemTemplate` und der Schnittstelle mit der BLL gelesen werden, um das Produkt in der Datenbank zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="67e6c-186">In the event handler, we need to read the values from the Web controls in the `EditItemTemplate` and interface with the BLL to update the product in the database.</span></span> <span data-ttu-id="67e6c-187">Wie bereits in den vorherigen Tutorials gezeigt, ist der `ProductID` des aktualisierten Produkts über die `DataKeys` Sammlung erreichbar.</span><span class="sxs-lookup"><span data-stu-id="67e6c-187">As we ve seen in previous tutorials, the `ProductID` of the updated product is accessible through the `DataKeys` collection.</span></span> <span data-ttu-id="67e6c-188">Der Zugriff auf die Benutzer eingegebenen Felder erfolgt durch Programm gesteuertes verweisen auf die websteuer Elemente mithilfe von `FindControl("controlID")`, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="67e6c-188">The user-entered fields are accessed by programmatically referencing the Web controls using `FindControl("controlID")`, as the following code shows:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample4.vb)]

<span data-ttu-id="67e6c-189">Der Code beginnt mit der `Page.IsValid`-Eigenschaft, um sicherzustellen, dass alle Validierungs Steuerelemente auf der Seite gültig sind.</span><span class="sxs-lookup"><span data-stu-id="67e6c-189">The code starts out by consulting the `Page.IsValid` property to ensure that all the validation controls on the page are valid.</span></span> <span data-ttu-id="67e6c-190">Wenn `Page.IsValid` `True`ist, wird der bearbeitete Product s `ProductID` Wert aus der `DataKeys` Auflistung gelesen, und auf die Dateneingabe-websteuer Elemente im `EditItemTemplate` wird Programm gesteuert verwiesen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-190">If `Page.IsValid` is `True`, the edited product s `ProductID` value is read from the `DataKeys` collection and the data entry Web controls in the `EditItemTemplate` are programmatically referenced.</span></span> <span data-ttu-id="67e6c-191">Als nächstes werden die Werte dieser websteuer Elemente in Variablen eingelesen, die dann an die entsprechende `UpdateProduct` Überladung weitergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="67e6c-191">Next, the values from these Web controls are read into variables that are then passed into the appropriate `UpdateProduct` overload.</span></span> <span data-ttu-id="67e6c-192">Nach dem Aktualisieren der Daten wird der DataList in den Zustand der vorabbearbeitung zurückversetzt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-192">After updating the data, the DataList is returned to its pre-editing state.</span></span>

> [!NOTE]
> <span data-ttu-id="67e6c-193">Ich habe die Ausnahme Behandlungs Logik ausgelassen, die im Tutorial [Behandlung von BLL-und Dal-Ebene-Ausnahmen](handling-bll-and-dal-level-exceptions-vb.md) hinzugefügt wurde, um den Code und dieses Beispiel im Fokus zu halten.</span><span class="sxs-lookup"><span data-stu-id="67e6c-193">I ve omitted the exception handling logic added in the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial in order to keep the code and this example focused.</span></span> <span data-ttu-id="67e6c-194">Als Übung fügen Sie diese Funktion nach Abschluss dieses Tutorials hinzu.</span><span class="sxs-lookup"><span data-stu-id="67e6c-194">As an exercise, add this functionality after completing this tutorial.</span></span>

## <a name="step-6-handling-null-categoryid-and-supplierid-values"></a><span data-ttu-id="67e6c-195">Schritt 6: Behandeln von NULL-CategoryID-und SupplierID-Werten</span><span class="sxs-lookup"><span data-stu-id="67e6c-195">Step 6: Handling NULL CategoryID and SupplierID Values</span></span>

<span data-ttu-id="67e6c-196">Die Northwind-Datenbank ermöglicht das `NULL` von Werten für die `Products` Tabellen `CategoryID` und `SupplierID` Spalten.</span><span class="sxs-lookup"><span data-stu-id="67e6c-196">The Northwind database allows for `NULL` values for the `Products` table s `CategoryID` and `SupplierID` columns.</span></span> <span data-ttu-id="67e6c-197">Die Bearbeitungs Schnittstelle unternimmt jedoch derzeit keine `NULL` Werte.</span><span class="sxs-lookup"><span data-stu-id="67e6c-197">However, our editing interface doesn t currently accommodate `NULL` values.</span></span> <span data-ttu-id="67e6c-198">Wenn Sie versuchen, ein Produkt zu bearbeiten, das einen `NULL` Wert für die `CategoryID`-oder `SupplierID` Spalten hat, erhalten Sie eine `ArgumentOutOfRangeException` mit einer Fehlermeldung ähnlich der folgenden: *"categories" weist einen "SelectedValue" auf, der ungültig ist, weil er nicht in der Liste der Elemente vorhanden ist.*</span><span class="sxs-lookup"><span data-stu-id="67e6c-198">If we attempt to edit a product that has a `NULL` value for either its `CategoryID` or `SupplierID` columns, we'll get an `ArgumentOutOfRangeException` with an error message similar to: *'Categories' has a SelectedValue which is invalid because it does not exist in the list of items.*</span></span> <span data-ttu-id="67e6c-199">Außerdem gibt es derzeit keine Möglichkeit, die Kategorie oder den Lieferanten Wert eines Produkts von einem Wert, der nicht`NULL` ist, in einen `NULL` zu ändern.</span><span class="sxs-lookup"><span data-stu-id="67e6c-199">Also, there s currently no way to change a product s category or supplier value from a non-`NULL` value to a `NULL` one.</span></span>

<span data-ttu-id="67e6c-200">Um `NULL` Werte für die Dropdown Listen Kategorie und Lieferanten zu unterstützen, müssen wir ein zusätzliches `ListItem`hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-200">To support `NULL` values for the category and supplier DropDownLists, we need to add an additional `ListItem`.</span></span> <span data-ttu-id="67e6c-201">Ich habe mich für die Verwendung von (keine) als `Text` Wert für diese `ListItem`entschieden, aber Sie können ihn in etwas anderes ändern (z. b. eine leere Zeichenfolge).</span><span class="sxs-lookup"><span data-stu-id="67e6c-201">I ve chosen to use (None) as the `Text` value for this `ListItem`, but you can change it to something else (such as an empty string) if you d like.</span></span> <span data-ttu-id="67e6c-202">Vergessen Sie schließlich nicht, die DropDownLists-`AppendDataBoundItems` auf `True`festzulegen. Wenn Sie dies vergessen, überschreiben die an die Dropdown Liste gebundenen Kategorien und Lieferanten die statisch hinzugefügten `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="67e6c-202">Finally, remember to set the DropDownLists `AppendDataBoundItems` to `True`; if you forget to do so, the categories and suppliers bound to the DropDownList will overwrite the statically-added `ListItem`.</span></span>

<span data-ttu-id="67e6c-203">Nachdem Sie diese Änderungen vorgenommen haben, sollte das DropDownLists-Markup in der DataList s-`EditItemTemplate` in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="67e6c-203">After making these changes, the DropDownLists markup in the DataList s `EditItemTemplate` should look similar to the following:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="67e6c-204">Statische `ListItem` s können einer Dropdown List über den Designer oder direkt über die deklarative Syntax hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="67e6c-204">Static `ListItem` s can be added to a DropDownList through the Designer or directly through the declarative syntax.</span></span> <span data-ttu-id="67e6c-205">Stellen Sie beim Hinzufügen eines Dropdown List-Elements zur Darstellung eines Daten Bank `NULL` Werts sicher, dass Sie die `ListItem` über die deklarative Syntax hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-205">When adding a DropDownList item to represent a database `NULL` value, be sure to add the `ListItem` through the declarative syntax.</span></span> <span data-ttu-id="67e6c-206">Wenn Sie den `ListItem` Auflistungs-Editor im-Designer verwenden, wird die `Value` Einstellung von der generierten deklarativen Syntax nicht vollständig ausgelassen, wenn eine leere Zeichenfolge zugewiesen wird, wobei deklaratives Markup wie folgt erstellt wird: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="67e6c-206">If you use the `ListItem` Collection Editor in the Designer, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="67e6c-207">Obwohl dies harmlos aussehen kann, bewirkt das fehlende `Value`, dass die Dropdown List den `Text`-Eigenschafts Wert verwendet.</span><span class="sxs-lookup"><span data-stu-id="67e6c-207">While this may look harmless, the missing `Value` causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="67e6c-208">Dies bedeutet Folgendes: Wenn diese `NULL` `ListItem` ausgewählt ist, wird der Wert (None) dem Feld "Product Data" (`CategoryID` oder `SupplierID`in diesem Tutorial) zugewiesen, was zu einer Ausnahme führt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-208">That means that if this `NULL` `ListItem` is selected, the value (None) will be attempted to be assigned to the product data field (`CategoryID` or `SupplierID`, in this tutorial), which will result in an exception.</span></span> <span data-ttu-id="67e6c-209">Wenn Sie `Value=""`explizit festlegen, wird dem Feld "Product Data" ein `NULL` Wert zugewiesen, wenn der `NULL` `ListItem` ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="67e6c-209">By explicitly setting `Value=""`, a `NULL` value will be assigned to the product data field when the `NULL` `ListItem` is selected.</span></span>

<span data-ttu-id="67e6c-210">Nehmen Sie sich einen Moment Zeit, um den Fortschritt über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="67e6c-210">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="67e6c-211">Beachten Sie beim Bearbeiten eines Produkts, dass die Dropdown Listen `Categories` und `Suppliers` beide eine (None)-Option am Anfang der Dropdown List haben.</span><span class="sxs-lookup"><span data-stu-id="67e6c-211">When editing a product, note that the `Categories` and `Suppliers` DropDownLists both have a (None) option at the start of the DropDownList.</span></span>

<span data-ttu-id="67e6c-212">[![die Dropdown Listen Kategorien und Lieferanten enthalten die Option (None).](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="67e6c-212">[![The Categories and Suppliers DropDownLists include a (None) Option](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span></span>

<span data-ttu-id="67e6c-213">**Abbildung 10**: die Dropdown Listen `Categories` und `Suppliers` enthalten die Option (keine) ([Klicken Sie, um das Bild in voller Größe anzuzeigen](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="67e6c-213">**Figure 10**: The `Categories` and `Suppliers` DropDownLists include a (None) Option ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span></span>

<span data-ttu-id="67e6c-214">Zum Speichern der Option (None) als Daten Bank `NULL` Wert müssen wir zum `UpdateCommand`-Ereignishandler zurückkehren.</span><span class="sxs-lookup"><span data-stu-id="67e6c-214">To save the (None) option as a database `NULL` value, we need to return to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="67e6c-215">Ändern Sie die `categoryIDValue`-und `supplierIDValue` Variablen in Werte, die auf NULL festgelegt werden können, und weisen Sie Ihnen einen anderen Wert als `Nothing` zu, wenn die DropDownList s-`SelectedValue` keine leere Zeichenfolge ist:</span><span class="sxs-lookup"><span data-stu-id="67e6c-215">Change the `categoryIDValue` and `supplierIDValue` variables to be nullable integers and assign them a value other than `Nothing` only if the DropDownList s `SelectedValue` is not an empty string:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample6.vb)]

<span data-ttu-id="67e6c-216">Mit dieser Änderung wird der Wert `Nothing` an die `UpdateProduct` BLL-Methode übermittelt, wenn der Benutzer die Option (None) aus einer der Dropdown Listen ausgewählt hat, die einem `NULL` Daten Bank Wert entspricht.</span><span class="sxs-lookup"><span data-stu-id="67e6c-216">With this change, a value of `Nothing` will be passed into the `UpdateProduct` BLL method if the user selected the (None) option from either of the drop-down lists, which corresponds to a `NULL` database value.</span></span>

## <a name="summary"></a><span data-ttu-id="67e6c-217">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="67e6c-217">Summary</span></span>

<span data-ttu-id="67e6c-218">In diesem Tutorial wurde erläutert, wie eine komplexere DataList-Bearbeitungs Schnittstelle erstellt wird, die drei verschiedene websteuer Elemente für Eingaben, zwei Dropdown Listen und ein Kontrollkästchen mit Validierungs Steuerelementen enthielt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-218">In this tutorial we saw how to create a more complex DataList editing interface that included three different input Web controls a TextBox, two DropDownLists, and a CheckBox along with validation controls.</span></span> <span data-ttu-id="67e6c-219">Wenn Sie die Bearbeitungs Schnittstelle entwickeln, sind die Schritte unabhängig von den verwendeten websteuer Elementen identisch: beginnen Sie mit dem Hinzufügen der websteuer Elemente zum DataList-`EditItemTemplate`; Verwenden Sie die Datenbindung-Syntax, um die entsprechenden Daten Feldwerte den entsprechenden websteuer Element Eigenschaften zuzuweisen. und in der `UpdateCommand` Ereignishandler Programm gesteuert auf die websteuer Elemente und die entsprechenden Eigenschaften zugreifen, wobei ihre Werte an die BLL übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="67e6c-219">When building the editing interface, the steps are the same regardless of the Web controls being used: start by adding the Web controls to the DataList s `EditItemTemplate`; use databinding syntax to assign the corresponding data field values with the appropriate Web control properties; and, in the `UpdateCommand` event handler, programmatically access the Web controls and their appropriate properties, passing their values into the BLL.</span></span>

<span data-ttu-id="67e6c-220">Wenn Sie eine Bearbeitungs Schnittstelle erstellen, unabhängig davon, ob es sich um nur Textfelder oder eine Auflistung verschiedener websteuer Elemente handelt, achten Sie darauf, die Daten Bank `NULL` Werte ordnungsgemäß zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="67e6c-220">When creating an editing interface, whether it s composed of just TextBoxes or a collection of different Web controls, be sure to correctly handle database `NULL` values.</span></span> <span data-ttu-id="67e6c-221">Wenn Sie `NULL` s in Rechnung stellen, ist es zwingend erforderlich, dass Sie einen vorhandenen `NULL` Wert nicht nur ordnungsgemäß in der Bearbeitungs Schnittstelle anzeigen, sondern auch ein Mittel zum Markieren eines Werts als `NULL`anbieten.</span><span class="sxs-lookup"><span data-stu-id="67e6c-221">When accounting for `NULL` s, it is imperative that you not only correctly display an existing `NULL` value in the editing interface, but also that you offer a means for marking a value as `NULL`.</span></span> <span data-ttu-id="67e6c-222">Für Dropdown Listen in datalisten bedeutet das in der Regel, dass ein statisches `ListItem` hinzugefügt wird, dessen `Value`-Eigenschaft explizit auf eine leere Zeichenfolge (`Value=""`) festgelegt ist, und dem `UpdateCommand` Ereignishandler ein Bit Code hinzufügt, um zu bestimmen, ob der `NULL``ListItem` ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="67e6c-222">For DropDownLists in DataLists, that typically means adding a static `ListItem` whose `Value` property is explicitly set to an empty string (`Value=""`), and adding a bit of code to the `UpdateCommand` event handler to determine whether or not the `NULL``ListItem` was selected.</span></span>

<span data-ttu-id="67e6c-223">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="67e6c-223">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="67e6c-224">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="67e6c-224">About the Author</span></span>

<span data-ttu-id="67e6c-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="67e6c-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="67e6c-226">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="67e6c-226">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="67e6c-227">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="67e6c-227">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="67e6c-228">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="67e6c-228">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="67e6c-229">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="67e6c-229">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="67e6c-230">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="67e6c-230">Special Thanks To</span></span>

<span data-ttu-id="67e6c-231">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="67e6c-231">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="67e6c-232">Die führenden Reviewer für dieses Tutorial waren Dennis Patterson, David suru und Randy Schmidt.</span><span class="sxs-lookup"><span data-stu-id="67e6c-232">Lead reviewers for this tutorial were Dennis Patterson, David Suru, and Randy Schmidt.</span></span> <span data-ttu-id="67e6c-233">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="67e6c-233">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="67e6c-234">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="67e6c-234">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="67e6c-235">Previous</span><span class="sxs-lookup"><span data-stu-id="67e6c-235">Previous</span></span>](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)
