---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: Einschränken der Daten Änderungs Funktionalität basierend auf dem Benutzer (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In einer Webanwendung, die Benutzern das Bearbeiten von Daten ermöglicht, haben unterschiedliche Benutzerkonten möglicherweise unterschiedliche Berechtigungen für die Datenbearbeitung. In diesem Tutorial wird erläutert, wie t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: c257a930e4d27fcd42591a541e700786bf413bf0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78491919"
---
# <a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="8afd3-104">Benutzerabhängiges Beschränken von Datenänderungsfunktionen (VB)</span><span class="sxs-lookup"><span data-stu-id="8afd3-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>

<span data-ttu-id="8afd3-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8afd3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8afd3-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) oder [PDF herunterladen](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8afd3-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="8afd3-107">In einer Webanwendung, die Benutzern das Bearbeiten von Daten ermöglicht, haben unterschiedliche Benutzerkonten möglicherweise unterschiedliche Berechtigungen für die Datenbearbeitung.</span><span class="sxs-lookup"><span data-stu-id="8afd3-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="8afd3-108">In diesem Tutorial wird erläutert, wie Sie die Daten Änderungs Funktionen auf der Grundlage des besuchenden Benutzers dynamisch anpassen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>

## <a name="introduction"></a><span data-ttu-id="8afd3-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="8afd3-109">Introduction</span></span>

<span data-ttu-id="8afd3-110">Eine Reihe von Webanwendungen unterstützen Benutzerkonten und bieten unterschiedliche Optionen, Berichte und Funktionen basierend auf dem angemeldeten Benutzer.</span><span class="sxs-lookup"><span data-stu-id="8afd3-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="8afd3-111">Mit unseren Tutorials möchten wir beispielsweise Benutzern von den Lieferanten Unternehmen erlauben, sich an der Website anzumelden und allgemeine Informationen zu ihren Produkten zu aktualisieren, z. b. den Namen und die Menge pro Einheit, möglicherweise zusammen mit Lieferanteninformationen, wie z. b. den Firmennamen. Adresse, Kontaktperson Informationen usw.</span><span class="sxs-lookup"><span data-stu-id="8afd3-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="8afd3-112">Außerdem möchten wir ggf. einige Benutzerkonten für Personen aus unserem Unternehmen einschließen, damit Sie sich anmelden und Produktinformationen wie z. b. Einheiten auf Lager-, neu anordnen-Ebene usw. aktualisieren können.</span><span class="sxs-lookup"><span data-stu-id="8afd3-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="8afd3-113">Die Webanwendung gestattet möglicherweise auch anonymen Benutzern den Besuch (Personen, die sich nicht angemeldet haben), schränkt Sie jedoch auf die Anzeige von Daten ein.</span><span class="sxs-lookup"><span data-stu-id="8afd3-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="8afd3-114">Wenn ein solches Benutzerkonto System vorhanden ist, möchten wir, dass die datenweb-Steuerelemente auf unseren ASP.NET Seiten die Funktionen zum Einfügen, bearbeiten und löschen anbieten, die für den aktuell angemeldeten Benutzer geeignet sind.</span><span class="sxs-lookup"><span data-stu-id="8afd3-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="8afd3-115">In diesem Tutorial wird erläutert, wie Sie die Daten Änderungs Funktionen auf der Grundlage des besuchenden Benutzers dynamisch anpassen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="8afd3-116">Insbesondere erstellen wir eine Seite, auf der die Lieferanten Informationen in einer bearbeitbaren DetailsView zusammen mit einer GridView angezeigt werden, in der die vom Lieferanten bereitgestellten Produkte aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="8afd3-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="8afd3-117">Wenn der Benutzer, der die Seite besucht, von unserem Unternehmen aus ist, kann er alle Lieferanteninformationen anzeigen. Bearbeiten Sie die Adresse. und bearbeiten Sie die Informationen für alle Produkte, die vom Lieferanten bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="8afd3-118">Wenn der Benutzer jedoch von einem bestimmten Unternehmen ist, kann er nur seine eigenen Adressinformationen anzeigen und bearbeiten und nur die Produkte bearbeiten, die nicht als eingestellt gekennzeichnet wurden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>

<span data-ttu-id="8afd3-119">[![ein Benutzer aus unserem Unternehmen kann alle Lieferanteninformationen bearbeiten.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="8afd3-120">**Abbildung 1**: ein Benutzer aus unserem Unternehmen kann alle Informationen des Lieferanten s bearbeiten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>

<span data-ttu-id="8afd3-121">[![Benutzer von einem bestimmten Lieferanten nur Ihre Informationen anzeigen und bearbeiten können](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="8afd3-122">**Abbildung 2**: ein Benutzer eines bestimmten Lieferanten kann seine Informationen nur anzeigen und bearbeiten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>

<span data-ttu-id="8afd3-123">Legen Sie Los!</span><span class="sxs-lookup"><span data-stu-id="8afd3-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="8afd3-124">Das ASP.NET 2,0 s-Mitgliedschaftssystem bietet eine standardisierte, erweiterbare Plattform zum Erstellen, verwalten und Validieren von Benutzerkonten.</span><span class="sxs-lookup"><span data-stu-id="8afd3-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="8afd3-125">Da die Untersuchung des Mitgliedschafts Systems über den Rahmen dieser Tutorials hinausgeht, wird in diesem Tutorial stattdessen die Mitgliedschaft "fakes" gewährt, indem anonyme Besucher entscheiden können, ob Sie von einem bestimmten Lieferanten oder von unserem Unternehmen stammen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="8afd3-126">Weitere Informationen zur Mitgliedschaft finden Sie unter meine unter [suchung ASP.NET 2,0 s Mitgliedschafts-, Rollen-und Profil](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) Artikel Reihe.</span><span class="sxs-lookup"><span data-stu-id="8afd3-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>

## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="8afd3-127">Schritt 1: zulassen, dass der Benutzer seine Zugriffsrechte angibt</span><span class="sxs-lookup"><span data-stu-id="8afd3-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="8afd3-128">In einer Webanwendung in der Praxis enthalten die Kontoinformationen eines Benutzers, ob Sie für unser Unternehmen oder für einen bestimmten Lieferanten gearbeitet haben. diese Informationen sind auf den ASP.NET-Seiten Programm gesteuert zugänglich, sobald sich der Benutzer bei der Website angemeldet hat.</span><span class="sxs-lookup"><span data-stu-id="8afd3-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="8afd3-129">Diese Informationen können über das ASP.NET 2,0 s-Rollensystem, als Kontoinformationen auf Benutzerebene über das Profilsystem oder auf benutzerdefinierte Weise aufgezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="8afd3-130">Da das Ziel dieses Tutorials darin besteht, die Anpassung der Daten Änderungs Funktionen basierend auf dem angemeldeten Benutzer zu veranschaulichen und nicht für die Veranschaulichung der ASP.NET 2,0 s-Mitgliedschaft,-Rollen und-Profilsysteme vorgesehen ist, verwenden wir einen sehr einfachen Mechanismus zum Ermitteln der Funktionen für den Benutzer, der die Seite besucht: eine Dropdown Liste, aus der der Benutzer angeben kann, ob er die Informationen zu den Lieferanten anzeigen und bearbeiten und alternativ die Informationen zu den einzelnen Lieferanten anzeigen und bearbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="8afd3-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="8afd3-131">Wenn der Benutzer anzeigt, dass er alle Lieferanteninformationen anzeigen und bearbeiten kann (Standardeinstellung), kann er alle Lieferanten durchlaufen, alle Adressinformationen eines Lieferanten bearbeiten und den Namen und die Menge pro Einheit für alle Produkte bearbeiten, die vom ausgewählten Lieferanten bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="8afd3-132">Wenn der Benutzer anzeigt, dass Sie nur einen bestimmten Lieferanten anzeigen und bearbeiten kann, kann er jedoch nur die Details und Produkte für diesen einen Lieferanten anzeigen und nur den Namen und die Menge pro Einheiten Informationen für die Produkte, die *nicht* eingestellt werden, nur aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="8afd3-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="8afd3-133">Der erste Schritt in diesem Tutorial besteht darin, diese Dropdown Liste zu erstellen und mit den Lieferanten des Systems aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="8afd3-134">Öffnen Sie die Seite `UserLevelAccess.aspx` im Ordner `EditInsertDelete`, fügen Sie eine Dropdown List-Eigenschaft hinzu, deren `ID`-Eigenschaft auf `Suppliers`festgelegt ist, und binden Sie diese DropDownList an eine neue ObjectDataSource mit dem Namen `AllSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8afd3-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>

<span data-ttu-id="8afd3-135">[![erstellen Sie eine neue ObjectDataSource mit dem Namen allsuppliersdatasource.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="8afd3-136">**Abbildung 3**: Erstellen einer neuen ObjectDataSource mit dem Namen "`AllSuppliersDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>

<span data-ttu-id="8afd3-137">Da diese Dropdown Liste alle Lieferanten einschließen soll, konfigurieren Sie ObjectDataSource so, dass die `SuppliersBLL` Class s `GetSuppliers()`-Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="8afd3-138">Stellen Sie außerdem sicher, dass die ObjectDataSource s-`Update()`-Methode der `SuppliersBLL` Class s `UpdateSupplierAddress`-Methode zugeordnet ist, da diese ObjectDataSource auch von der DetailsView verwendet wird, die wir in Schritt 2 hinzufügen werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="8afd3-139">Nachdem Sie den ObjectDataSource-Assistenten abgeschlossen haben, führen Sie die Schritte aus, indem Sie die `Suppliers` Dropdown List so konfigurieren, dass das `CompanyName` Datenfeld angezeigt wird, und das `SupplierID` Datenfeld als Wert für jede `ListItem`verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>

<span data-ttu-id="8afd3-140">[![konfigurieren Sie die Dropdown Liste "Suppliers" für die Verwendung der Datenfelder "CompanyName" und "SupplierID"](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="8afd3-141">**Abbildung 4**: Konfigurieren der `Suppliers` Dropdown Liste für die Verwendung der Felder `CompanyName` und `SupplierID` Daten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>

<span data-ttu-id="8afd3-142">An diesem Punkt werden in der Dropdown Liste die Firmennamen der Lieferanten in der-Datenbank aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="8afd3-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="8afd3-143">Wir müssen jedoch auch die Option "alle Lieferanten anzeigen/bearbeiten" in die Dropdown Liste einschließen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="8afd3-144">Legen Sie hierzu die `Suppliers` DropDownList s `AppendDataBoundItems`-Eigenschaft auf `true` fest, und fügen Sie dann eine `ListItem` hinzu, deren `Text`-Eigenschaft "alle Lieferanten anzeigen/bearbeiten" und deren Wert `-1`ist.</span><span class="sxs-lookup"><span data-stu-id="8afd3-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="8afd3-145">Dies kann direkt über das deklarative Markup oder über den Designer hinzugefügt werden, indem Sie zum Eigenschaftenfenster navigieren und auf die Ellipse in der DropDownList s `Items`-Eigenschaft klicken.</span><span class="sxs-lookup"><span data-stu-id="8afd3-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="8afd3-146">Eine ausführlichere Erläuterung zum Hinzufügen eines Elements "Alles auswählen" zu einer Dropdown Liste [*mit einem Dropdown List-Element finden Sie im Tutorial zur Master/Detail-Filterung mit einem Dropdown List-* ](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="8afd3-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>

<span data-ttu-id="8afd3-147">Nachdem die `AppendDataBoundItems`-Eigenschaft festgelegt wurde und die `ListItem` hinzugefügt wurde, sollte das deklarative Markup der DropDownList s wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="8afd3-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="8afd3-148">Abbildung 5 zeigt einen Screenshot des aktuellen Fortschritts, wenn er über einen Browser angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>

<span data-ttu-id="8afd3-149">[![die Dropdown Liste "Suppliers" eine "alle anzeigen"-Liste und einen für jeden Lieferanten enthält.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="8afd3-150">**Abbildung 5**: die Dropdown Liste "`Suppliers` anzeigen" enthält ein `ListItem`alle anzeigen sowie einen für jeden Lieferanten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>

<span data-ttu-id="8afd3-151">Da wir die Benutzeroberfläche sofort nach dem Ändern der Auswahl des Benutzers aktualisieren möchten, legen Sie die `Suppliers` DropDownList s `AutoPostBack`-Eigenschaft auf `true`fest.</span><span class="sxs-lookup"><span data-stu-id="8afd3-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="8afd3-152">In Schritt 2 erstellen wir ein DetailsView-Steuerelement, das die Informationen für die Lieferanten auf der Grundlage der Dropdown List-Auswahl anzeigt.</span><span class="sxs-lookup"><span data-stu-id="8afd3-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="8afd3-153">Anschließend erstellen wir in Schritt 3 einen Ereignishandler für dieses DropDownList s-`SelectedIndexChanged` Ereignis, in dem wir Code hinzufügen, der die entsprechenden Lieferanteninformationen basierend auf dem ausgewählten Lieferanten an die DetailsView bindet.</span><span class="sxs-lookup"><span data-stu-id="8afd3-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="8afd3-154">Schritt 2: Hinzufügen eines DetailsView-Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="8afd3-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="8afd3-155">Verwenden Sie eine DetailsView, um Lieferanteninformationen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="8afd3-156">Für den Benutzer, der alle Lieferanten anzeigen und bearbeiten kann, unterstützt die DetailsView das Paging, sodass der Benutzer die Lieferanteninformationen einen Datensatz nacheinander durchlaufen kann.</span><span class="sxs-lookup"><span data-stu-id="8afd3-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="8afd3-157">Wenn der Benutzer jedoch für einen bestimmten Lieferanten arbeitet, zeigt die DetailsView nur die Informationen des jeweiligen Lieferanten an und enthält keine Paging-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="8afd3-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="8afd3-158">In beiden Fällen muss die DetailsView es dem Benutzer ermöglichen, die Felder "Address", "City" und "Country" des Lieferanten zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="8afd3-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="8afd3-159">Fügen Sie der Seite unterhalb der Dropdown Liste `Suppliers` eine DetailsView hinzu, legen Sie die `ID`-Eigenschaft auf `SupplierDetails`fest, und binden Sie Sie an die im vorherigen Schritt erstellte `AllSuppliersDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8afd3-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="8afd3-160">Aktivieren Sie als nächstes die Kontrollkästchen Paging aktivieren und Bearbeitung aktivieren im Smarttags DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="8afd3-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="8afd3-161">Wenn Sie die Option zum Aktivieren der Bearbeitung in der DetailsView s Smarttags nicht sehen, haben Sie die ObjectDataSource s-`Update()` Methode nicht der `SuppliersBLL` Class s `UpdateSupplierAddress`-Methode zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="8afd3-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="8afd3-162">Nehmen Sie sich einen Moment Zeit, und nehmen Sie diese Konfigurationsänderung vor, nachdem die Option Bearbeitung aktivieren im Smarttags DetailsView s angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="8afd3-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>

<span data-ttu-id="8afd3-163">Da die `UpdateSupplierAddress`-Methode der `SuppliersBLL`-Klasse nur vier Parameter akzeptiert: `supplierID`, `address`, `city`und `country`-ändern Sie die Details der DetailsView s boundfields, sodass die `CompanyName`-und `Phone` boundfields schreibgeschützt sind.</span><span class="sxs-lookup"><span data-stu-id="8afd3-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="8afd3-164">Entfernen Sie außerdem den `SupplierID` BoundField vollständig.</span><span class="sxs-lookup"><span data-stu-id="8afd3-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="8afd3-165">Zum Schluss hat der `AllSuppliersDataSource` ObjectDataSource derzeit die `OldValuesParameterFormatString`-Eigenschaft auf `original_{0}`festgelegt.</span><span class="sxs-lookup"><span data-stu-id="8afd3-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="8afd3-166">Nehmen Sie sich einen Moment Zeit, um diese Eigenschafts Einstellung aus der deklarativen Syntax vollständig zu entfernen, oder legen Sie Sie auf den Standardwert `{0}`fest.</span><span class="sxs-lookup"><span data-stu-id="8afd3-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="8afd3-167">Nach dem Konfigurieren der `SupplierDetails` DetailsView und `AllSuppliersDataSource` ObjectDataSource verfügen wir über das folgende deklarative Markup:</span><span class="sxs-lookup"><span data-stu-id="8afd3-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="8afd3-168">An diesem Punkt kann die DetailsView durchlaufen werden, und die ausgewählten Lieferinformationen des Lieferanten können unabhängig von der in der `Suppliers` Dropdown Liste getroffenen Auswahl aktualisiert werden (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="8afd3-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>

<span data-ttu-id="8afd3-169">[![alle Lieferanteninformationen können angezeigt und die Adresse aktualisiert werden.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="8afd3-170">**Abbildung 6**: alle Lieferanteninformationen können angezeigt werden, und Ihre Adresse wird aktualisiert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>

## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="8afd3-171">Schritt 3: Anzeigen nur der Informationen des ausgewählten Lieferanten</span><span class="sxs-lookup"><span data-stu-id="8afd3-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="8afd3-172">Auf unserer Seite werden derzeit die Informationen zu allen Lieferanten angezeigt, unabhängig davon, ob ein bestimmter Lieferant aus der Dropdown Liste "`Suppliers`" ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="8afd3-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="8afd3-173">Um nur die Lieferanteninformationen für den ausgewählten Lieferanten anzuzeigen, müssen wir der Seite eine weitere ObjectDataSource hinzufügen, die Informationen zu einem bestimmten Lieferanten abruft.</span><span class="sxs-lookup"><span data-stu-id="8afd3-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="8afd3-174">Fügen Sie der Seite ein neues ObjectDataSource-Objekt hinzu, benennen Sie es `SingleSupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8afd3-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="8afd3-175">Klicken Sie im Smarttagmenü auf den Link Datenquelle konfigurieren, und verwenden Sie die `SuppliersBLL` Klasse s `GetSupplierBySupplierID(supplierID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="8afd3-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="8afd3-176">Wie bei der `AllSuppliersDataSource` ObjectDataSource muss die `SingleSupplierDataSource` ObjectDataSource s `Update()`-Methode der `SuppliersBLL` Class s `UpdateSupplierAddress`-Methode zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>

<span data-ttu-id="8afd3-177">[![die Methode "singlesupplierdatasource ObjectDataSource" für die Verwendung der Methode getsupplierbysupplierid (SupplierID) konfigurieren.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="8afd3-178">**Abbildung 7**: Konfigurieren der `SingleSupplierDataSource` ObjectDataSource für die Verwendung der `GetSupplierBySupplierID(supplierID)`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>

<span data-ttu-id="8afd3-179">Als nächstes werden Sie aufgefordert, die Parameter Quelle für die `GetSupplierBySupplierID(supplierID)` Methode `supplierID` Eingabeparameter anzugeben.</span><span class="sxs-lookup"><span data-stu-id="8afd3-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="8afd3-180">Da wir die Informationen für den von der Dropdown Liste ausgewählten Lieferanten anzeigen möchten, verwenden Sie die `Suppliers` DropDownList s `SelectedValue`-Eigenschaft als Parameter Quelle.</span><span class="sxs-lookup"><span data-stu-id="8afd3-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="8afd3-181">[![die Dropdown Liste "Suppliers" als SupplierID-Parameter Quelle verwenden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="8afd3-182">**Abbildung 8**: Verwenden der Dropdown List-`Suppliers` als `supplierID` Parameter Quelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>

<span data-ttu-id="8afd3-183">Auch wenn diese zweite ObjectDataSource hinzugefügt wurde, ist das DetailsView-Steuerelement zurzeit so konfiguriert, dass immer die `AllSuppliersDataSource` ObjectDataSource verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="8afd3-184">Wir müssen Logik hinzufügen, um die von der DetailsView verwendete Datenquelle je nach ausgewähltem `Suppliers` DropDownList-Element anzupassen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="8afd3-185">Um dies zu erreichen, erstellen Sie einen `SelectedIndexChanged` Ereignishandler für die Dropdown Liste "Suppliers".</span><span class="sxs-lookup"><span data-stu-id="8afd3-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="8afd3-186">Dies kann am einfachsten durch Doppelklicken auf die Dropdown Liste im Designer erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="8afd3-187">Dieser Ereignishandler muss ermitteln, welche Datenquelle verwendet werden soll, und muss die Daten erneut an die DetailsView binden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="8afd3-188">Dies wird mit folgendem Code erreicht:</span><span class="sxs-lookup"><span data-stu-id="8afd3-188">This is accomplished with the following code:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="8afd3-189">Der Ereignishandler bestimmt, ob die Option "alle Lieferanten anzeigen/bearbeiten" ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="8afd3-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="8afd3-190">Wenn dies der Fall ist, wird die `SupplierDetails` DetailsView s `DataSourceID` auf `AllSuppliersDataSource` festgelegt, und der Benutzer wird an den ersten Datensatz in der Gruppe von Lieferanten zurückgegeben, indem die `PageIndex`-Eigenschaft auf 0 festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="8afd3-191">Wenn der Benutzer jedoch einen bestimmten Lieferanten aus der Dropdown Liste ausgewählt hat, wird die DetailsView s-`DataSourceID` `SingleSuppliersDataSource`zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="8afd3-192">Unabhängig davon, welche Datenquelle verwendet wird, wird der `SuppliersDetails` Modus wieder auf den schreibgeschützten Modus zurückgesetzt, und die Daten werden über einen aufzurufenden `SuppliersDetails` Steuerelement-`DataBind()`-Methode an die DetailsView zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="8afd3-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="8afd3-193">Wenn dieser Ereignishandler vorhanden ist, zeigt das DetailsView-Steuerelement jetzt den ausgewählten Lieferanten an, es sei denn, die Option "alle Lieferanten anzeigen/bearbeiten" wurde ausgewählt. in diesem Fall können alle Lieferanten über die Paging-Schnittstelle angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="8afd3-194">Abbildung 9 zeigt die Seite mit ausgewählter Option "alle Lieferanten anzeigen/bearbeiten". Beachten Sie, dass die pagingschnittstelle vorhanden ist, die es dem Benutzer ermöglicht, jeden beliebigen Lieferanten zu besuchen und zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="8afd3-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="8afd3-195">Abbildung 10 zeigt die Seite mit ausgewähltem ma-maison-Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="8afd3-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="8afd3-196">In diesem Fall können nur MA-Maison s-Informationen angezeigt und bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-196">Only Ma Maison s information is viewable and editable in this case.</span></span>

<span data-ttu-id="8afd3-197">[![alle Lieferanteninformationen können angezeigt und bearbeitet werden.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="8afd3-198">**Abbildung 9**: alle Lieferanteninformationen können angezeigt und bearbeitet werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>

<span data-ttu-id="8afd3-199">[![nur die Informationen des ausgewählten Lieferanten s angezeigt und bearbeitet werden können.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="8afd3-200">**Abbildung 10**: nur die Informationen des ausgewählten Lieferanten s können angezeigt und bearbeitet werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8afd3-201">Für dieses Tutorial müssen sowohl das DropDownList-Steuerelement als auch das DetailsView-Steuerelement s-`EnableViewState` auf `true` (Standardeinstellung) festgelegt werden, da die Änderungen DropDownList s `SelectedIndex` und DetailsView s `DataSourceID` Eigenschaften s über Postbacks hinweg gespeichert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>

## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="8afd3-202">Schritt 4: Auflisten der Lieferanten Produkte in einer bearbeitbaren GridView</span><span class="sxs-lookup"><span data-stu-id="8afd3-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="8afd3-203">Wenn die DetailsView fertiggestellt ist, besteht der nächste Schritt darin, eine bearbeitbare GridView-Struktur einzuschließen, in der die Produkte des ausgewählten Lieferanten aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="8afd3-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="8afd3-204">In dieser GridView sollten nur die Felder `ProductName` und `QuantityPerUnit` bearbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="8afd3-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="8afd3-205">Wenn der Benutzer, der die Seite besucht, von einem bestimmten Lieferanten gehört, sollte er außerdem nur Updates für diese Produkte zulassen, die *nicht* eingestellt werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="8afd3-206">Um dies zu erreichen, müssen wir zuerst eine Überladung der `ProductsBLL` Klasse s `UpdateProducts` Methode hinzufügen, die nur die Felder `ProductID`, `ProductName`und `QuantityPerUnit` als Eingaben annimmt.</span><span class="sxs-lookup"><span data-stu-id="8afd3-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="8afd3-207">Wir haben diesen Prozess bereits in zahlreichen Tutorials schrittweise durchlaufen. betrachten Sie also den Code hier, der `ProductsBLL`hinzugefügt werden sollte:</span><span class="sxs-lookup"><span data-stu-id="8afd3-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="8afd3-208">Nachdem diese Überladung erstellt wurde, können wir das GridView-Steuerelement und dessen zugeordnete ObjectDataSource hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="8afd3-209">Fügen Sie der Seite eine neue GridView hinzu, legen Sie die `ID`-Eigenschaft auf `ProductsBySupplier`fest, und konfigurieren Sie Sie für die Verwendung einer neuen ObjectDataSource mit dem Namen `ProductsBySupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8afd3-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="8afd3-210">Da in dieser GridView diese Produkte vom ausgewählten Lieferanten aufgelistet werden sollen, verwenden Sie die `ProductsBLL` Class s `GetProductsBySupplierID(supplierID)`-Methode.</span><span class="sxs-lookup"><span data-stu-id="8afd3-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="8afd3-211">Ordnen Sie außerdem die `Update()`-Methode der neuen `UpdateProduct` Überladung zu, die wir soeben erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="8afd3-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>

<span data-ttu-id="8afd3-212">[![Konfigurieren von ObjectDataSource für die Verwendung der soeben erstellten UpdateProduct-Überladung](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="8afd3-213">**Abbildung 11**: Konfigurieren von ObjectDataSource für die Verwendung der soeben erstellten `UpdateProduct` Überladung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>

<span data-ttu-id="8afd3-214">Wir haben erneut aufgefordert, die Parameter Quelle für die `GetProductsBySupplierID(supplierID)` Methode `supplierID` Eingabeparameter auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="8afd3-215">Da wir die Produkte für den in der DetailsView ausgewählten Lieferanten anzeigen möchten, verwenden Sie die `SuppliersDetails` DetailsView-Steuerelement `SelectedValue`-Eigenschaft als Parameter Quelle.</span><span class="sxs-lookup"><span data-stu-id="8afd3-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="8afd3-216">[![die Eigenschaft "suppliersdetails DetailsView s SelectedValue" als Parameter Quelle verwenden.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="8afd3-217">**Abbildung 12**: Verwenden der `SuppliersDetails` DetailsView s `SelectedValue`-Eigenschaft als Parameter Quelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>

<span data-ttu-id="8afd3-218">Wenn Sie zur GridView zurückkehren, entfernen Sie alle GridView-Felder außer `ProductName`, `QuantityPerUnit`und `Discontinued`, wobei Sie das `Discontinued` CheckBoxField als schreibgeschützt markieren.</span><span class="sxs-lookup"><span data-stu-id="8afd3-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="8afd3-219">Aktivieren Sie außerdem die Option zum Aktivieren der Bearbeitung im GridView s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="8afd3-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="8afd3-220">Nachdem diese Änderungen vorgenommen wurden, sollte das deklarative Markup für GridView und ObjectDataSource in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="8afd3-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="8afd3-221">Wie bei unseren vorherigen objectdatasources ist diese Eigenschaft `OldValuesParameterFormatString` auf `original_{0}`festgelegt, was zu Problemen führt, wenn versucht wird, einen Produkt-e-Namen oder eine Menge pro Einheit zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="8afd3-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="8afd3-222">Entfernen Sie diese Eigenschaft vollständig aus der deklarativen Syntax, oder legen Sie Sie auf den Standardwert (`{0}`) fest.</span><span class="sxs-lookup"><span data-stu-id="8afd3-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="8afd3-223">Nach Abschluss dieser Konfiguration listet unsere Seite nun die Produkte auf, die vom in der GridView ausgewählten Lieferanten bereitgestellt werden (siehe Abbildung 13).</span><span class="sxs-lookup"><span data-stu-id="8afd3-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="8afd3-224">*Zurzeit* kann der Name oder die Menge der Produkte pro Einheit aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="8afd3-225">Wir müssen unsere Seiten Logik jedoch aktualisieren, damit diese Funktionalität für Benutzer, die einem bestimmten Lieferanten zugeordnet sind, nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="8afd3-226">Dieser letzte Schritt wird in Schritt 5 behandelt.</span><span class="sxs-lookup"><span data-stu-id="8afd3-226">We'll tackle this final piece in Step 5.</span></span>

<span data-ttu-id="8afd3-227">[![werden die Produkte angezeigt, die vom ausgewählten Lieferanten bereitgestellt werden.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="8afd3-228">**Abbildung 13**: die vom ausgewählten Lieferanten bereitgestellten Produkte werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8afd3-229">Durch das Hinzufügen dieses bearbeitbaren GridView-Ereignisses sollte der `Suppliers` DropDownList s `SelectedIndexChanged`-Ereignishandler aktualisiert werden, um die GridView in einen schreibgeschützten Zustand zurückzusetzen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="8afd3-230">Wenn ein anderer Lieferant während der Bearbeitung von Produktinformationen ausgewählt wird, kann der entsprechende Index in der GridView für den neuen Lieferanten auch bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="8afd3-231">Um dies zu verhindern, legen Sie einfach die GridView s `EditIndex`-Eigenschaft auf `-1` im `SelectedIndexChanged`-Ereignishandler fest.</span><span class="sxs-lookup"><span data-stu-id="8afd3-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>

<span data-ttu-id="8afd3-232">Beachten Sie auch, dass es wichtig ist, dass der GridView s-Ansichts Zustand aktiviert ist (das Standardverhalten).</span><span class="sxs-lookup"><span data-stu-id="8afd3-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="8afd3-233">Wenn Sie die Eigenschaft GridView s `EnableViewState` auf `false`festlegen, besteht das Risiko, dass gleichzeitige Benutzerdaten Sätze versehentlich löschen oder bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="8afd3-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="8afd3-234">Weitere Informationen finden Sie [unter Warnung: Parallelitäts Problem mit ASP.NET 2,0 GridViews/DetailsView/formviews, die das Bearbeiten und/oder löschen unterstützen und deren Ansichts Zustand deaktiviert ist](http://scottonwriting.net/sowblog/posts/10054.aspx) .</span><span class="sxs-lookup"><span data-stu-id="8afd3-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="8afd3-235">Schritt 5: Deaktivieren der Bearbeitung für nicht mehr unterstützte Produkte, wenn alle Lieferanten anzeigen/bearbeiten nicht ausgewählt ist</span><span class="sxs-lookup"><span data-stu-id="8afd3-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="8afd3-236">Obwohl die `ProductsBySupplier` GridView voll funktionsfähig ist, gewährt Sie derzeit zu viel Zugriff auf die Benutzer eines bestimmten Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="8afd3-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="8afd3-237">Gemäß den Geschäftsregeln sollten solche Benutzer nicht mehr unterstützte Produkte aktualisieren können.</span><span class="sxs-lookup"><span data-stu-id="8afd3-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="8afd3-238">Um dies zu erzwingen, können wir die Bearbeitungs Schaltfläche in den GridView-Zeilen mit nicht mehr unterstützten Produkten ausblenden (oder deaktivieren), wenn die Seite von einem Benutzer von einem Lieferanten besucht wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="8afd3-239">Erstellen Sie einen Ereignishandler für das GridView s `RowDataBound`-Ereignis.</span><span class="sxs-lookup"><span data-stu-id="8afd3-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="8afd3-240">In diesem Ereignishandler muss festgestellt werden, ob der Benutzer einem bestimmten Lieferanten zugeordnet ist, der für dieses Tutorial durch Überprüfen der DropDownList s-`SelectedValue` Eigenschaft von Suppliers ermittelt werden kann, wenn er etwas anderes als-1 ist, dann wird der Benutzer einem bestimmten Lieferanten zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="8afd3-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="8afd3-241">Für solche Benutzer müssen wir dann bestimmen, ob das Produkt nicht mehr unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="8afd3-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="8afd3-242">Wir können einen Verweis auf die tatsächliche `ProductRow`-Instanz, die an die GridView-Zeile gebunden ist, über die `e.Row.DataItem`-Eigenschaft erfassen, wie im Tutorial [*Anzeigen von Zusammenfassungs Informationen in der GridView-footer-footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) erläutert.</span><span class="sxs-lookup"><span data-stu-id="8afd3-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="8afd3-243">Wenn das Produkt nicht mehr unterstützt wird, können Sie mithilfe der im vorherigen Tutorial beschriebenen Techniken einen programmgesteuerten Verweis auf die Schaltfläche "Bearbeiten" im GridView s-CommandField aufrufen, indem Sie eine [*Client seitige Bestätigung beim Löschen hinzufügen*](adding-client-side-confirmation-when-deleting-vb.md).</span><span class="sxs-lookup"><span data-stu-id="8afd3-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="8afd3-244">Sobald ein Verweis vorhanden ist, können wir die Schaltfläche ausblenden oder deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="8afd3-244">Once we have a reference we can then hide or disable the button.</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="8afd3-245">Wenn dieser Ereignishandler vorhanden ist, wird beim Aufrufen dieser Seite als Benutzer von einem bestimmten Lieferanten nicht mehr bearbeitbare Produkte angezeigt, da die Bearbeitungs Schaltfläche für diese Produkte ausgeblendet ist.</span><span class="sxs-lookup"><span data-stu-id="8afd3-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="8afd3-246">Beispielsweise ist Chef Anton s Gumbo Mix ein nicht mehr unterstütztes Produkt für den neuen Lieferanten von Orleans Cajun Delights.</span><span class="sxs-lookup"><span data-stu-id="8afd3-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="8afd3-247">Wenn Sie die Seite für diesen bestimmten Lieferanten aufrufen, wird die Schaltfläche "Bearbeiten" für dieses Produkt in Sight ausgeblendet (siehe Abbildung 14).</span><span class="sxs-lookup"><span data-stu-id="8afd3-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="8afd3-248">Wenn Sie jedoch mit "alle Lieferanten anzeigen/bearbeiten" aufrufen, ist die Schaltfläche "Bearbeiten" verfügbar (siehe Abbildung 15).</span><span class="sxs-lookup"><span data-stu-id="8afd3-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>

<span data-ttu-id="8afd3-249">[![für Lieferanten spezifische Benutzer die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix ist ausgeblendet.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="8afd3-250">**Abbildung 14**: für Lieferanten spezifische Benutzer wird die Bearbeitungs Schaltfläche für Chef Anton s Gumbo Mix ausgeblendet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>

<span data-ttu-id="8afd3-251">[![für alle Lieferanten Benutzer anzeigen/bearbeiten wird die Schaltfläche Bearbeiten für Chef Anton s Gumbo Mix angezeigt.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="8afd3-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="8afd3-252">**Abbildung 15**: zum Anzeigen/Bearbeiten aller Lieferanten Benutzer wird die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="8afd3-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>

## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="8afd3-253">Überprüfen der Zugriffsrechte in der Geschäftslogik Schicht</span><span class="sxs-lookup"><span data-stu-id="8afd3-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="8afd3-254">In diesem Tutorial verarbeitet die ASP.NET-Seite alle Logik in Bezug auf die Informationen, die der Benutzer sehen kann, und welche Produkte er aktualisieren kann.</span><span class="sxs-lookup"><span data-stu-id="8afd3-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="8afd3-255">Im Idealfall wäre diese Logik auch auf der Geschäftslogik Schicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="8afd3-256">Beispielsweise kann die `SuppliersBLL` Class s `GetSuppliers()`-Methode (die alle Lieferanten zurückgibt) eine Prüfung einschließen, um sicherzustellen, dass der aktuell angemeldete Benutzer *keinem* bestimmten Lieferanten zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="8afd3-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="8afd3-257">Ebenso kann die `UpdateSupplierAddress` Methode eine Prüfung enthalten, um sicherzustellen, dass der aktuell angemeldete Benutzer entweder für unser Unternehmen gearbeitet hat (und daher alle Adressinformationen des Lieferanten aktualisieren kann) oder dem Lieferanten zugeordnet ist, dessen Daten aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="8afd3-258">Diese Überprüfungen der BLL-Schicht sind hier nicht enthalten, da die Rechte des Benutzers in unserem Tutorial durch eine Dropdown List auf der Seite bestimmt werden, auf die die BLL-Klassen nicht zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="8afd3-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="8afd3-259">Bei Verwendung des Mitgliedschafts Systems oder eines der Standard Authentifizierungs Schemas, die von ASP.NET bereitgestellt werden (z. b. Windows-Authentifizierung), kann der Zugriff auf die Informationen und Rollen Informationen des aktuell angemeldeten Benutzers über die BLL erfolgen, wodurch ein solcher Zugriff möglich ist. auf der Präsentations-und der BLL-Ebene können Rechte überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="8afd3-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="8afd3-260">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="8afd3-260">Summary</span></span>

<span data-ttu-id="8afd3-261">Die meisten Websites, die Benutzerkonten bereitstellen, müssen die Daten Änderungs Schnittstelle basierend auf dem angemeldeten Benutzer anpassen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="8afd3-262">Administratoren können möglicherweise jeden Datensatz löschen und bearbeiten, während Benutzer ohne Administrator Beschränkung darauf beschränkt sind, nur die von Ihnen erstellten Datensätze zu aktualisieren oder zu löschen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="8afd3-263">Je nach Szenario kann es sein, dass die Klassen Data Web Controls, ObjectDataSource und Business Logic Layer erweitert werden können, um bestimmte Funktionen auf der Grundlage des angemeldeten Benutzers hinzuzufügen oder zu verweigern.</span><span class="sxs-lookup"><span data-stu-id="8afd3-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="8afd3-264">In diesem Tutorial wurde erläutert, wie Sie die sichtbaren und bearbeitbaren Daten begrenzen können, je nachdem, ob der Benutzer einem bestimmten Lieferanten zugeordnet wurde oder ob er für unser Unternehmen tätig war.</span><span class="sxs-lookup"><span data-stu-id="8afd3-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="8afd3-265">In diesem Tutorial wird die Untersuchung des Einfügens, Aktualisierens und Löschens von Daten mithilfe der Steuerelemente GridView, DetailsView und FormView abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="8afd3-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="8afd3-266">Beginnend mit dem nächsten Tutorial wird das Hinzufügen von Paging-und Sortierungs Unterstützung berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="8afd3-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="8afd3-267">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="8afd3-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8afd3-268">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="8afd3-268">About the Author</span></span>

<span data-ttu-id="8afd3-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="8afd3-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8afd3-270">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="8afd3-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8afd3-271">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8afd3-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8afd3-272">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8afd3-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8afd3-273">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8afd3-273">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="8afd3-274">Previous</span><span class="sxs-lookup"><span data-stu-id="8afd3-274">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
