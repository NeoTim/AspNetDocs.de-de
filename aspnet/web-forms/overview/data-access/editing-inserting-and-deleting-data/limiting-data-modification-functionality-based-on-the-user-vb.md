---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: Benutzerabhängiges Datenänderungsfunktionen (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In einer Webanwendung, die Benutzern ermöglicht, Daten zu bearbeiten, möglicherweise verschiedene Benutzerkonten Berechtigungen für andere Bearbeiten von Daten. In diesem Tutorial untersucht, wie t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: 5a2217106f32e6353f6da23ca61e847e04962d98
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2019
ms.locfileid: "65114699"
---
# <a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="8eb60-104">Benutzerabhängiges Beschränken von Datenänderungsfunktionen (VB)</span><span class="sxs-lookup"><span data-stu-id="8eb60-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>

<span data-ttu-id="8eb60-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8eb60-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8eb60-106">[Beispiel-App herunter](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) oder [PDF-Datei herunterladen](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8eb60-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="8eb60-107">In einer Webanwendung, die Benutzern ermöglicht, Daten zu bearbeiten, möglicherweise verschiedene Benutzerkonten Berechtigungen für andere Bearbeiten von Daten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="8eb60-108">In diesem Tutorial betrachten wir, wie Sie die Möglichkeiten zur Datenänderung basierend auf der Website besucht Benutzer dynamisch anpassen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>

## <a name="introduction"></a><span data-ttu-id="8eb60-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="8eb60-109">Introduction</span></span>

<span data-ttu-id="8eb60-110">Eine Anzahl von Webanwendungen unterstützen Benutzerkonten und bieten verschiedene Optionen, Berichte und Funktionen, die basierend auf dem angemeldeten Benutzer.</span><span class="sxs-lookup"><span data-stu-id="8eb60-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="8eb60-111">Beispielsweise möchten wir mit unseren Tutorials kann Benutzer aus der Supplier-Firmen, die auf der Website "und" Update allgemeine Informationen über ihre Produkte - ihren Namen und eine Menge pro Einheit, melden Sie sich vielleicht – zusammen mit der Lieferanteninformationen, z. B. ihren Firmennamen können, Adresse, Kontaktperson s Informationen und So weiter.</span><span class="sxs-lookup"><span data-stu-id="8eb60-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="8eb60-112">Darüber hinaus möchten wir einige Benutzerkonten für unser Unternehmen für Personen enthalten, sodass sie anmelden und Produktinformationen zu aktualisieren, wie Einheiten auf Lager, neu anordnen Ebene usw. können.</span><span class="sxs-lookup"><span data-stu-id="8eb60-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="8eb60-113">Unserer Webanwendung möglicherweise auch Fall jeder anonyme Benutzer zum Besuch (Personen, die nicht angemeldet haben), jedoch würden sie nur Anzeige von Daten einschränken.</span><span class="sxs-lookup"><span data-stu-id="8eb60-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="8eb60-114">Mit solchen eine Benutzer-kontosystem vorhanden sollten wir die Daten Websteuerelemente in unserer ASP.NET-Seiten der einfügen, bearbeiten und Löschen von Funktionen, die für den derzeit angemeldeten Benutzer zu bieten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="8eb60-115">In diesem Tutorial betrachten wir, wie Sie die Möglichkeiten zur Datenänderung basierend auf der Website besucht Benutzer dynamisch anpassen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="8eb60-116">Insbesondere erstellen wir eine Seite an, in dem die Lieferanten-Informationen in einem bearbeitbaren DetailsView zusammen mit einer GridView-Ansicht angezeigt, die Produkte von Lieferanten auflistet.</span><span class="sxs-lookup"><span data-stu-id="8eb60-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="8eb60-117">Wenn der Benutzer auf der Seite über unser Unternehmen ist, können sie: Zeigen Sie alle Lieferanteninformationen s; Bearbeiten Sie ihre Adresse; Anzeigen und bearbeiten Sie die Informationen für jedes Produkt, die von den Lieferanten bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="8eb60-118">Wenn der Benutzer jedoch von einem bestimmten Unternehmen ist, können sie nur anzeigen und bearbeiten Sie ihre eigene Adressinformationen und können nur bearbeiten, ihre Produkte, die nicht als nicht mehr unterstützt markiert wurden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>

<span data-ttu-id="8eb60-119">[![Alle Lieferanten-s-Informationen können von einem Benutzer in unserem Unternehmen bearbeitet.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="8eb60-120">**Abbildung 1**: Ein Benutzer über unser Unternehmen können beliebige Zulieferer bearbeiten s Informationen ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>

<span data-ttu-id="8eb60-121">[![Ein Benutzer von einem bestimmten Lieferanten kann nur anzeigen und Bearbeiten ihrer Informationen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="8eb60-122">**Abbildung 2**: Ein Benutzer einen bestimmten Anbieter können nur anzeigen und Bearbeiten ihrer Informationen ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>

<span data-ttu-id="8eb60-123">Lassen Sie s beginnen!</span><span class="sxs-lookup"><span data-stu-id="8eb60-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="8eb60-124">ASP.NET 2.0 s Mitgliedschaftssystem bietet eine standardisierte, erweiterbare Plattform für das Erstellen und Verwalten von Benutzerkonten werden überprüft.</span><span class="sxs-lookup"><span data-stu-id="8eb60-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="8eb60-125">Da eine Untersuchung der Mitgliedschaftssystem in diesen Tutorials nicht eingegangen ist, fakes"in diesem Tutorial stattdessen" Mitgliedschaft von auswählen, ob sie über einen bestimmten Lieferanten oder unser Unternehmen für das anonyme Besucher zulassen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="8eb60-126">Weitere Informationen zu Mitgliedschaft, finden Sie in meiner [Untersuchung von ASP.NET 2.0-s-Mitgliedschaft, Rollen und Profil](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) Artikel der Reihe.</span><span class="sxs-lookup"><span data-stu-id="8eb60-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>

## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="8eb60-127">Schritt 1: Damit der Benutzer ihre Zugriffsrechte angeben</span><span class="sxs-lookup"><span data-stu-id="8eb60-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="8eb60-128">In einer realen-Webanwendung würde eine s-Benutzerkontoinformationen enthalten, ob sie für unser Unternehmen oder für einen bestimmten Lieferanten haben und diese Informationen sind aus unseren ASP.NET-Seiten programmgesteuert zugegriffen werden kann, sobald der Benutzer auf der Website angemeldet hat.</span><span class="sxs-lookup"><span data-stu-id="8eb60-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="8eb60-129">Diese Informationen kann durch ASP.NET 2.0-s-Rollen-System, als auf Benutzerebene Kontoinformationen über das Profilsystem oder über bestimmte benutzerdefinierte Wege erfasst werden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="8eb60-130">Da das Ziel in diesem Tutorial veranschaulicht die Möglichkeiten zur Datenänderung basierend auf den angemeldeten Benutzer anpassen und ist nicht für ASP.NET 2.0-Showcase-s-Mitgliedschaft, Rollen und Profil Systeme vorgesehen ist, verwenden wir einen Mechanismus sehr einfach um zu bestimmen, die Funktionen für den Benutzer, die auf der Seite – einem DropDownList-Steuerelement aus dem kann der Benutzer angeben, wenn sie anzeigen und Bearbeiten der Lieferanten-Informationen oder alternativ was werden sollen bestimmte s Lieferanteninformationen anzeigen und bearbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="8eb60-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="8eb60-131">Wenn der Benutzer angibt, dass sie anzeigen und Bearbeiten von Lieferanteninformationen für alle (Standard), können sie alle Lieferanten durchblättern, alle Lieferanten-s-Adressinformationen bearbeiten und Bearbeiten von Name und Menge pro Einheit für jedes Produkt, die von den ausgewählten Lieferanten bereitgestellte.</span><span class="sxs-lookup"><span data-stu-id="8eb60-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="8eb60-132">Wenn der Benutzer gibt an, dass sie nur anzeigen können und bearbeiten, die ein bestimmter Lieferant, allerdings wird sie nur die Details und die Produkte für diese ein Lieferant anzeigen und nur können kann aktualisieren, den Namen und eine Menge pro Einheiteninformationen für diese Produkte, die *nicht* nicht mehr unterstützt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="8eb60-133">Im ersten Schritt in diesem Tutorial werden dann diese DropDownList erstellen und füllen Sie es mit Lieferanten, im System.</span><span class="sxs-lookup"><span data-stu-id="8eb60-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="8eb60-134">Öffnen der `UserLevelAccess.aspx` auf der Seite die `EditInsertDelete` Ordner einem DropDownList-Steuerelement hinzufügen, deren `ID` -Eigenschaftensatz auf `Suppliers`, und binden Sie diese DropDownList an eine neue, mit dem Namen "ObjectDataSource" `AllSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>

<span data-ttu-id="8eb60-135">[![Erstellen Sie eine neue, mit dem Namen AllSuppliersDataSource "ObjectDataSource"](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="8eb60-136">**Abbildung 3**: Erstellen Sie eine neue "ObjectDataSource" mit dem Namen `AllSuppliersDataSource` ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>

<span data-ttu-id="8eb60-137">Da dieser Dropdownliste alle Lieferanten eingeschlossen werden soll, konfigurieren Sie dem ObjectDataSource-Steuerelement zum Aufrufen der `SuppliersBLL` Klasse s `GetSuppliers()` Methode.</span><span class="sxs-lookup"><span data-stu-id="8eb60-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="8eb60-138">Außerdem stellen Sie sicher, dass das "ObjectDataSource"-s `Update()` Methode zugeordnet ist die `SuppliersBLL` Klasse s `UpdateSupplierAddress` -Methode, als diese "ObjectDataSource" auch verwendet werden von der DetailsView, die wir in Schritt2 hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="8eb60-139">Nach Abschluss des ObjectDataSource-Steuerelement-Assistenten, führen Sie die Schritte, durch Konfigurieren der `Suppliers` DropDownList so, dass es zeigt die `CompanyName` Datenfeld und der `SupplierID` Feld "Daten" als Wert für die einzelnen `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>

<span data-ttu-id="8eb60-140">[![Konfigurieren von Lieferanten DropDownList CompanyName und SupplierID Datenfelder verwenden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="8eb60-141">**Abbildung 4**: Konfigurieren der `Suppliers` DropDownList verwenden die `CompanyName` und `SupplierID` von Datenfeldern ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>

<span data-ttu-id="8eb60-142">An diesem Punkt werden in der Dropdownliste die Unternehmensnamen von Lieferanten in der Datenbank aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="8eb60-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="8eb60-143">Allerdings müssen wir auch eine Option "Alle Lieferanten der anzeigen/bearbeiten" zu DropDownList einschließen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="8eb60-144">Zu diesem Zweck legen Sie die `Suppliers` DropDownList s `AppendDataBoundItems` Eigenschaft `true` und fügen Sie dann eine `ListItem` , deren `Text` -Eigenschaft ist "Aller-Lieferanten anzeigen/bearbeiten" und dessen Wert ist `-1`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="8eb60-145">Dies kann hinzugefügt werden direkt über den deklarativen Markup oder mit dem Designer indem Sie das Fenster "Eigenschaften" und durch Klicken auf die Auslassungspunkte in der DropDownList s `Items` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="8eb60-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="8eb60-146">Siehe die [ *Master/Detail-Filtern mit einer DropDownList* ](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) Tutorial für eine ausführlichere Beschreibung zum Hinzufügen von einer Select All-Element zu einer datengebundenen DropDownList.</span><span class="sxs-lookup"><span data-stu-id="8eb60-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>

<span data-ttu-id="8eb60-147">Nach der `AppendDataBoundItems` -Eigenschaft festgelegt wurde und die `ListItem` hinzugefügt haben, sollte die DropDownList s deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="8eb60-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="8eb60-148">Abbildung 5 zeigt einen Screenshot des unseren aktuellen Status, wenn Sie über einen Browser angezeigt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>

<span data-ttu-id="8eb60-149">[![Lieferanten DropDownList enthält ein Anzeigen aller ListItem Plus 1 für jeden Lieferanten](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="8eb60-150">**Abbildung 5**: Die `Suppliers` DropDownList enthält alle anzeigen `ListItem`, Plus 1 für jede Lieferanten ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>

<span data-ttu-id="8eb60-151">Da wir möchten die Benutzeroberfläche zu aktualisieren, sobald der Benutzer die Auswahl geändert hat, legen Sie die `Suppliers` DropDownList s `AutoPostBack` Eigenschaft `true`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="8eb60-152">In Schritt2 erstellen wir ein DetailsView-Steuerelement, das die Informationen für die Lieferanten, die basierend auf der DropDownList-Auswahl angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="8eb60-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="8eb60-153">Klicken Sie dann in Schritt 3, wir erstellen einen Ereignishandler für diese s DropDownList `SelectedIndexChanged` -Ereignis, in dem wir fügen Code, der die entsprechenden Lieferanteninformationen DetailsView gebunden wird anhand des ausgewählten Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="8eb60-154">Schritt 2: Hinzufügen von einem DetailsView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="8eb60-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="8eb60-155">Lassen Sie s eine DetailsView zu verwenden, um Lieferanteninformationen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="8eb60-156">Für den Benutzer, die anzeigen und Bearbeiten aller-Lieferanten, unterstützt die DetailsView Paging, damit der Benutzer einen Datensatz des Lieferanten-Informationen zu einem Zeitpunkt durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="8eb60-157">Wenn der Benutzer für einen bestimmten Lieferanten funktioniert, jedoch DetailsView nur bestimmte Lieferanten s Informationen angezeigt werden, und eine Paging-Schnittstelle nicht enthält.</span><span class="sxs-lookup"><span data-stu-id="8eb60-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="8eb60-158">In beiden Fällen muss die DetailsView ermöglichen die Benutzer, die Lieferanten-e-Adresse, Stadt und Landesfelder zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="8eb60-159">Fügen Sie eine DetailsView auf der Seite unter der `Suppliers` DropDownList, legen die `ID` Eigenschaft, um `SupplierDetails`, und binden Sie es an der `AllSuppliersDataSource` "ObjectDataSource", die im vorherigen Schritt erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="8eb60-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="8eb60-160">Als Nächstes aktivieren Sie die Kontrollkästchen "Paging aktivieren und die Bearbeitung aktivieren" aus dem DetailsView-s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="8eb60-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="8eb60-161">Sie Ich möchte eine Option bearbeiten Aktivieren der intelligenten DetailsView s angezeigt zu kennzeichnen. s, da Sie nicht das "ObjectDataSource"-s zugeordnet werden konnte `Update()` Methode, um die `SuppliersBLL` Klasse s `UpdateSupplierAddress` Methode.</span><span class="sxs-lookup"><span data-stu-id="8eb60-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="8eb60-162">Wechseln zurück, und stellen diese Konfiguration, die nach dem sollte die Option Bearbeiten aktivieren im DetailsView-s-Smarttag angezeigt. ändern können.</span><span class="sxs-lookup"><span data-stu-id="8eb60-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>

<span data-ttu-id="8eb60-163">Da die `SuppliersBLL` s-Klasse `UpdateSupplierAddress` -Methode akzeptiert nur vier Parameter - `supplierID`, `address`, `city`, und `country` -DetailsView s BoundFields ändern, damit die `CompanyName` und `Phone` BoundFields sind schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="8eb60-164">Entfernen Sie außerdem die `SupplierID` BoundField-vollständig.</span><span class="sxs-lookup"><span data-stu-id="8eb60-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="8eb60-165">Zum Schluss die `AllSuppliersDataSource` ObjectDataSource-Steuerelement verfügt derzeit über seine `OldValuesParameterFormatString` -Eigenschaftensatz auf `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="8eb60-166">Entfernen diese eigenschafteneinstellung wird vollständig aus der deklarative Syntax oder legen Sie ihn auf den Standardwert in Ruhe `{0}`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="8eb60-167">Nach dem Konfigurieren der `SupplierDetails` DetailsView und `AllSuppliersDataSource` "ObjectDataSource", haben wir die folgende deklarative Markup:</span><span class="sxs-lookup"><span data-stu-id="8eb60-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="8eb60-168">An diesem Punkt DetailsView über ausgelagert werden kann und die Adressinformationen für die ausgewählte Lieferanten s aktualisiert werden kann, unabhängig von der Auswahl getroffen wurde, der `Suppliers` DropDownList (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="8eb60-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>

<span data-ttu-id="8eb60-169">[![Alle Lieferanten Informationen kann angezeigt werden, und seine Adresse aktualisiert.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="8eb60-170">**Abbildung 6**: Alle Lieferanten Informationen kann angezeigt werden, und seine Adresse aktualisiert ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>

## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="8eb60-171">Schritt 3: Nur die ausgewählten Lieferanten-s-Informationen anzeigen</span><span class="sxs-lookup"><span data-stu-id="8eb60-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="8eb60-172">Die Seite derzeit zeigt die Informationen für alle Lieferanten, unabhängig davon, ob ein bestimmter Lieferant aus ausgewählt wurde die `Suppliers` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="8eb60-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="8eb60-173">Um nur die Lieferanteninformationen für den ausgewählten Lieferanten anzuzeigen müssen wir eine andere "ObjectDataSource" auf unserer Seite eine hinzufügen, die Informationen zu einem bestimmten Lieferanten abruft.</span><span class="sxs-lookup"><span data-stu-id="8eb60-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="8eb60-174">Hinzufügen einer neuen "ObjectDataSource" zur Seite, nennen Sie es `SingleSupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="8eb60-175">Klicken Sie auf die Datenquelle konfigurieren-Link sein Smarttag, und lassen Sie sie verwenden die `SuppliersBLL` Klasse s `GetSupplierBySupplierID(supplierID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="8eb60-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="8eb60-176">Wie bei der `AllSuppliersDataSource` "ObjectDataSource", haben die `SingleSupplierDataSource` "ObjectDataSource" s `Update()` Methode zugeordnet wird, um die `SuppliersBLL` s-Klasse `UpdateSupplierAddress` Methode.</span><span class="sxs-lookup"><span data-stu-id="8eb60-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>

<span data-ttu-id="8eb60-177">[![Konfigurieren Sie die SingleSupplierDataSource "ObjectDataSource" zur Verwendung der GetSupplierBySupplierID(supplierID)-Methode](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="8eb60-178">**Abbildung 7**: Konfigurieren der `SingleSupplierDataSource` "ObjectDataSource" Verwenden der `GetSupplierBySupplierID(supplierID)` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>

<span data-ttu-id="8eb60-179">Als Nächstes wir erneut einzugeben, geben Sie die Parameterquelle für die `GetSupplierBySupplierID(supplierID)` s-Methode `supplierID` input-Parameters.</span><span class="sxs-lookup"><span data-stu-id="8eb60-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="8eb60-180">Da wir die Informationen für den Lieferanten, die aus der Dropdownliste, verwenden ausgewählt anzeigen möchten die `Suppliers` DropDownList s `SelectedValue` -Eigenschaft der Parameterquelle.</span><span class="sxs-lookup"><span data-stu-id="8eb60-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="8eb60-181">[![Verwenden von Lieferanten DropDownList als die SupplierID Parameterquelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="8eb60-182">**Abbildung 8**: Verwenden der `Suppliers` DropDownList, als die `supplierID` Parameterquelle ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>

<span data-ttu-id="8eb60-183">Trotz dieser zweiten "ObjectDataSource" hinzugefügt, DetailsView-Steuerelement ist gegenwärtig konfiguriert verwenden Sie immer die `AllSuppliersDataSource` "ObjectDataSource".</span><span class="sxs-lookup"><span data-stu-id="8eb60-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="8eb60-184">Wir müssen die Logik zum Anpassen der Datenquelle, die von der DetailsView je verwendet die `Suppliers` DropDownList-Element ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="8eb60-185">Um dies zu erreichen, erstellen Sie eine `SelectedIndexChanged` -Ereignishandler für das DropDownList Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="8eb60-186">Dies kann am einfachsten durch Doppelklicken auf die Dropdownliste im Designer erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="8eb60-187">Dieser Ereignishandler muss, um zu bestimmen, welche Datenquelle verwendet und muss erneut zu binden die Daten zur DetailsView.</span><span class="sxs-lookup"><span data-stu-id="8eb60-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="8eb60-188">Dies erfolgt durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="8eb60-188">This is accomplished with the following code:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="8eb60-189">Der Ereignishandler beginnt mit der bestimmt, ob die Option "Alle Lieferanten der anzeigen/bearbeiten" ausgewählt wurde.</span><span class="sxs-lookup"><span data-stu-id="8eb60-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="8eb60-190">Wenn es war, wird die `SupplierDetails` DetailsView s `DataSourceID` zu `AllSuppliersDataSource` und den Benutzer auf den ersten Eintrag in der Menge der Lieferanten zurückgibt, durch Festlegen der `PageIndex` Eigenschaft auf 0.</span><span class="sxs-lookup"><span data-stu-id="8eb60-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="8eb60-191">Wenn Sie jedoch der Benutzer ein bestimmter Lieferant aus der Dropdownliste das DetailsView-s ausgewählt hat `DataSourceID` zugewiesen `SingleSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="8eb60-192">Unabhängig davon, welche Daten der Datenquelle verwendet wird, die `SuppliersDetails` Modus auf den nur-Lese Modus zurückgesetzt wird, und die Daten werden erneut gebunden, DetailsView durch einen Aufruf der `SuppliersDetails` Steuerelement s `DataBind()` Methode.</span><span class="sxs-lookup"><span data-stu-id="8eb60-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="8eb60-193">Mit diesem Ereignishandler vorhanden zeigt DetailsView-Steuerelement, wenn die Option "Alle Lieferanten der anzeigen/bearbeiten" ausgewählt wurde, in diesem Fall können alle Lieferanten über die Schnittstelle zur Paging angezeigt werden, nun den ausgewählten Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="8eb60-194">Abbildung 9 zeigt die Seite die Option "Aller-Lieferanten anzeigen/bearbeiten" ausgewählt ist; Beachten Sie, dass die Paging-Schnittstelle vorhanden ist, damit der Benutzer besuchen und beliebige Zulieferer aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="8eb60-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="8eb60-195">Abbildung 10 zeigt die Seite mit den Ma Maison Lieferanten ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="8eb60-196">Nur Informationen von Ma Maison, s ist in diesem Fall angezeigt und bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-196">Only Ma Maison s information is viewable and editable in this case.</span></span>

<span data-ttu-id="8eb60-197">[![Alle Lieferanten Informationen kann angezeigt und bearbeitet werden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="8eb60-198">**Abbildung 9**: Alle Lieferanten Informationen kann angezeigt werden und bearbeiteter ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>

<span data-ttu-id="8eb60-199">[![Nur die ausgewählten s von Lieferanteninformationen kann angezeigt und bearbeitet werden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="8eb60-200">**Abbildung 10**: Nur die ausgewählten Lieferanten s Informationen Ansicht "und" bearbeiteter kann ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8eb60-201">Für dieses Tutorial steuern sowohl der DropDownList und DetailsView s `EnableViewState` muss festgelegt werden, um `true` (Standard) da das DropDownList-s `SelectedIndex` und der s DetailsView `DataSourceID` eigenschaftenänderungen s müssen postbackübergreifend gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>

## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="8eb60-202">Schritt 4: Auflisten der Lieferanten-Produkte in einem bearbeitbaren GridView-Ansicht</span><span class="sxs-lookup"><span data-stu-id="8eb60-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="8eb60-203">Mit der DetailsView abgeschlossen ist wird im nächsten Schritt, um eine bearbeitbare GridView einzuschließen, die diese Produkte von den ausgewählten Lieferanten bereitgestellte aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="8eb60-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="8eb60-204">Diese GridView vorsieht, Änderungen, um nur die `ProductName` und `QuantityPerUnit` Felder.</span><span class="sxs-lookup"><span data-stu-id="8eb60-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="8eb60-205">Darüber hinaus ist der Benutzer auf der Seite von einem bestimmten anderen Lieferanten, es sollten nur zulassen Updates für Produkte, die *nicht* nicht mehr unterstützt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="8eb60-206">Um dies zu erreichen, wir zunächst hinzufügen, eine Überladung von müssen, der `ProductsBLL` s-Klasse `UpdateProducts` -Methode, die akzeptiert nur die `ProductID`, `ProductName`, und `QuantityPerUnit` Felder als Eingaben.</span><span class="sxs-lookup"><span data-stu-id="8eb60-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="8eb60-207">Wir haben in Einzelschritten durchlaufen dieser Prozess im Voraus in zahlreichen Tutorials lassen s, die nur den Code hier betrachten die hinzugefügt werden sollen `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="8eb60-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="8eb60-208">Mit dieser Überladung erstellt, es erneut bereit, das GridView-Steuerelement und seine zugehörigen "ObjectDataSource" hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="8eb60-209">Fügen Sie einer neuen GridView-Ansicht auf der Seite hinzu, legen die `ID` Eigenschaft `ProductsBySupplier`, und konfigurieren sie eine neue, mit dem Namen "ObjectDataSource" Verwendung `ProductsBySupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="8eb60-210">Da wir diese GridView diese Produkte von den ausgewählten Lieferanten auflisten möchten, verwenden die `ProductsBLL` Klasse s `GetProductsBySupplierID(supplierID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="8eb60-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="8eb60-211">Ordnen Sie auch die `Update()` Methode, um die neue `UpdateProduct` Überladung, die wir gerade erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="8eb60-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>

<span data-ttu-id="8eb60-212">[![Konfigurieren Sie die "ObjectDataSource", um die soeben erstellte UpdateProduct-Überladung verwenden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="8eb60-213">**Abbildung 11**: Konfigurieren Sie das "ObjectDataSource" Verwenden der `UpdateProduct` überladen gerade erstellt haben ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>

<span data-ttu-id="8eb60-214">Wir erneut aufgefordert, auszuwählen, die Parameterquelle für die `GetProductsBySupplierID(supplierID)` s-Methode `supplierID` input-Parameters.</span><span class="sxs-lookup"><span data-stu-id="8eb60-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="8eb60-215">Da die Produkte angezeigt, für den Lieferanten in DetailsView, Verwendung ausgewählt werden sollen die `SuppliersDetails` DetailsView-Steuerelement s `SelectedValue` -Eigenschaft der Parameterquelle.</span><span class="sxs-lookup"><span data-stu-id="8eb60-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>

<span data-ttu-id="8eb60-216">[![Verwenden Sie die SuppliersDetails DetailsView s SelectedValue-Eigenschaft, wie die Parameterquelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="8eb60-217">**Abbildung 12**: Verwenden der `SuppliersDetails` DetailsView s `SelectedValue` -Eigenschaft der Quelle-Parameter ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>

<span data-ttu-id="8eb60-218">Rückgabe an die GridView, entfernen Sie alle die GridView-Felder mit Ausnahme von `ProductName`, `QuantityPerUnit`, und `Discontinued`, markieren die `Discontinued` CheckBoxField als schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="8eb60-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="8eb60-219">Überprüfen Sie auch die Option "Bearbeiten aktivieren" das GridView-s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="8eb60-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="8eb60-220">Nachdem diese Änderungen vorgenommen wurden, sollte der deklarative Markup für die GridView und "ObjectDataSource" etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="8eb60-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>

[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="8eb60-221">Wie bei unseren vorherigen ObjectDataSources, diese einem s `OldValuesParameterFormatString` -Eigenschaftensatz auf `original_{0}`, wodurch Probleme beim Versuch, ein Produktname s oder eine Menge pro Einheit zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="8eb60-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="8eb60-222">Festlegen, dass die Standardeinstellung verwenden, oder entfernen Sie diese Eigenschaft vollständig aus der deklarativen Syntax `{0}`.</span><span class="sxs-lookup"><span data-stu-id="8eb60-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="8eb60-223">Mit dieser Konfiguration abgeschlossen ist, enthält unsere Seite jetzt Produkte von den Lieferanten, die in den GridView-Ansicht ausgewählt (siehe Abbildung 13).</span><span class="sxs-lookup"><span data-stu-id="8eb60-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="8eb60-224">Derzeit *alle* Produktnamen s oder Menge pro Einheit kann aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="8eb60-225">Allerdings müssen wir unsere Seitenlogik zu aktualisieren, sodass eine solche Funktionalität für ausgelaufene Produkte für Benutzer, die ein bestimmter Lieferant nicht zulässig ist.</span><span class="sxs-lookup"><span data-stu-id="8eb60-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="8eb60-226">Wir werden diese letzte Information in Schritt 5 in Angriff nehmen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-226">We'll tackle this final piece in Step 5.</span></span>

<span data-ttu-id="8eb60-227">[![Produkte von Lieferanten ausgewählt werden angezeigt.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="8eb60-228">**Abbildung 13**: Produkte von Lieferanten ausgewählt werden angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8eb60-229">Durch das Hinzufügen dieser bearbeitbaren GridView der `Suppliers` DropDownList s `SelectedIndexChanged` Ereignishandler aktualisiert werden soll, um die GridView zu einem schreibgeschützten Zustand zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="8eb60-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="8eb60-230">Andernfalls, wenn ein anderer Lieferanten mitten in Bearbeitung Produktinformationen ausgewählt ist, wird der zugehörige Index in der GridView-Ansicht für den neuen Lieferanten auch bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="8eb60-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="8eb60-231">Um dies zu verhindern, legen Sie einfach das GridView-s `EditIndex` Eigenschaft `-1` in die `SelectedIndexChanged` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="8eb60-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>

<span data-ttu-id="8eb60-232">Darüber hinaus denken Sie daran, dass es wichtig, dass die GridView Ansichtszustand s werden (Standardverhalten) aktiviert.</span><span class="sxs-lookup"><span data-stu-id="8eb60-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="8eb60-233">Setzen Sie das GridView-s `EnableViewState` Eigenschaft `false`, führen Sie das Risiko gleichzeitiger Benutzer versehentlich löschen oder zu bearbeiten zeichnet.</span><span class="sxs-lookup"><span data-stu-id="8eb60-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="8eb60-234">Finden Sie unter [Warnung: Parallelität ausgeben mit ASP.NET 2.0 GridViews/DetailsView/FormViews, Unterstützung bearbeiten bzw. löschen und, deren Ansichtszustand deaktiviert ist](http://scottonwriting.net/sowblog/posts/10054.aspx) für Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="8eb60-235">Schritt 5: Editing zuzulassen, nicht mehr unterstützte Produkte bei anzeigen/bearbeiten alle Lieferanten nicht ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="8eb60-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="8eb60-236">Während der `ProductsBySupplier` GridView ist voll funktionsfähig, es derzeit gewährt zu viel Zugriff auf die Benutzer, die von einem bestimmten Lieferanten sind.</span><span class="sxs-lookup"><span data-stu-id="8eb60-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="8eb60-237">Pro unsere Geschäftsregeln sollten solche Benutzer nicht eingestellte Produkte aktualisieren können.</span><span class="sxs-lookup"><span data-stu-id="8eb60-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="8eb60-238">Um dies zu erzwingen, können wir ausblenden (deaktivieren oder) die Schaltfläche "Bearbeiten" in den GridView Zeilen nicht mehr unterstützte Produkte, wenn die Seite von einem Lieferanten von einem Benutzer besucht wurde.</span><span class="sxs-lookup"><span data-stu-id="8eb60-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="8eb60-239">Erstellen Sie einen Ereignishandler für das GridView-s `RowDataBound` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="8eb60-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="8eb60-240">In diesem Ereignishandler müssen wir bestimmen, ob der Benutzer ein bestimmter Lieferant, zugeordnet, die für dieses Tutorial bestimmt werden kann ist, durch Überprüfen der Lieferanten DropDownList s `SelectedValue` -Eigenschaft: Wenn sie s anderes Element als -1, und klicken Sie dann auf der Benutzer ist ein bestimmter Lieferant zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="8eb60-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="8eb60-241">Für solche Benutzer müssen wir bestimmen, ob das Produkt nicht mehr unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="8eb60-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="8eb60-242">Können wir ziehen Sie einen Verweis auf die tatsächliche `ProductRow` Instanz gebunden, auf die GridView-Zeile über die `e.Row.DataItem` -Eigenschaft, wie unter der [ *Zusammenfassungsinformationen anzeigen, in den GridView-s-Fußzeile* ](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) In diesem Tutorial.</span><span class="sxs-lookup"><span data-stu-id="8eb60-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="8eb60-243">Wenn das Produkt nicht mehr lieferbar ist, können wir einen programmgesteuerten Verweis auf die Schaltfläche "Bearbeiten" in den GridView-s CommandField mit den Verfahren erläutert, die im vorherigen Tutorial nehmen [ *Hinzufügen der clientseitigen Bestätigung beim Löschen von* ](adding-client-side-confirmation-when-deleting-vb.md).</span><span class="sxs-lookup"><span data-stu-id="8eb60-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="8eb60-244">Nachdem wir einen Verweis haben, den können wir dann ausblenden oder deaktivieren Sie die Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="8eb60-244">Once we have a reference we can then hide or disable the button.</span></span>

[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="8eb60-245">Mit diesem Ereignis Handler vorhanden, wenn auf dieser Seite als Benutzer von einem bestimmten Lieferanten dieser Produkte, die nicht mehr unterstützt werden können nicht bearbeitet werden, wie die Schaltfläche "Bearbeiten" ist für diese Produkte ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="8eb60-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="8eb60-246">Chef Anton s Gumbo Mix ist z. B. einem ausgelaufenen Produkt für den New Orleans Cajun lerne Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="8eb60-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="8eb60-247">Wenn die Seite für diesen bestimmten Lieferanten zu besuchen, wird die Schaltfläche "Bearbeiten" für dieses Produkt aus der Sicht ausgeblendet (siehe Abbildung 14).</span><span class="sxs-lookup"><span data-stu-id="8eb60-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="8eb60-248">Allerdings ist die Schaltfläche "Bearbeiten" beim Zugriff auf "Anzeigen/bearbeiten alle Lieferanten" verwenden, zur Verfügung (siehe Abbildung 15).</span><span class="sxs-lookup"><span data-stu-id="8eb60-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>

<span data-ttu-id="8eb60-249">[![Für Anbieter-spezifischen Benutzer wird die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix ausgeblendet.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="8eb60-250">**Abbildung 14**: Für Lieferanten-spezifische Benutzer die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix ausgeblendet ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>

<span data-ttu-id="8eb60-251">[![Für alle Lieferanten Benutzer anzeigen/bearbeiten wird die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix angezeigt.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="8eb60-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="8eb60-252">**Abbildung 15**: Für alle Lieferanten Benutzer anzeigen/bearbeiten, wird die Schaltfläche "Bearbeiten" für Chef Anton s Gumbo Mix ([klicken Sie, um das Bild in voller Größe anzeigen](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="8eb60-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>

## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="8eb60-253">Überprüfen auf die Zugriffsrechte in der Geschäftslogikebene</span><span class="sxs-lookup"><span data-stu-id="8eb60-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="8eb60-254">In diesem Tutorial ASP.NET Seite verarbeitet alle Logik im Hinblick auf die Informationen, die der Benutzer angezeigt und welche Produkte, die er aktualisieren kann.</span><span class="sxs-lookup"><span data-stu-id="8eb60-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="8eb60-255">Im Idealfall würden diese Logik auch an der Geschäftslogikebene vorliegen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="8eb60-256">Z. B. die `SuppliersBLL` Klasse s `GetSuppliers()` -Methode (die alle Lieferanten zurückgibt) sind zum Beispiel eine Überprüfung aus, um sicherzustellen, dass der derzeit angemeldete Benutzer *nicht* ein bestimmter Lieferant zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="8eb60-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="8eb60-257">Ebenso die `UpdateSupplierAddress` -Methode kann eine Überprüfung aus, um sicherzustellen, dass den derzeit angemeldeten Benutzer entweder für unser Unternehmen hat (und daher können alle Lieferanten Adressinformationen zu aktualisieren) enthalten, oder den Hersteller, deren Daten aktualisiert wird, zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="8eb60-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="8eb60-258">Ich haben solchen Überprüfungen aus BLL-Ebene hier nicht eingeschlossen, da in diesem Tutorial die Benutzerrechten s durch einem DropDownList-Steuerelement auf der Seite festgelegt werden, die nicht auf die BLL Klassen zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="8eb60-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="8eb60-259">Wenn Sie das Mitgliedschaftssystem oder eines Out-die mitgelieferten Authentifizierungsschemas, die von ASP.NET bereitgestellt wird (z. B. Windows-Authentifizierung), verwenden den angemeldeten Benutzer s Informationen und Informationen zu Rollen der BLL, wodurch dieser Zugriff zugegriffen werden kann Rechte überprüft, ob auf der Präsentation und BLL Ebenen möglich.</span><span class="sxs-lookup"><span data-stu-id="8eb60-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="8eb60-260">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="8eb60-260">Summary</span></span>

<span data-ttu-id="8eb60-261">Die meisten Sites, die Benutzerkonten bereitstellen müssen die Schnittstelle auf Grundlage der angemeldete Benutzer Datenänderungsvorgänge anpassen.</span><span class="sxs-lookup"><span data-stu-id="8eb60-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="8eb60-262">Administratoren möglicherweise ein Datensatz, bearbeiten und löschen können, während nicht-Administratoren beschränkt, nur aktualisieren oder Löschen von Datensätzen, die sie selbst erstellt werden können.</span><span class="sxs-lookup"><span data-stu-id="8eb60-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="8eb60-263">Beliebiges anderes Szenario könnten sein, die Daten Websteuerelemente ObjectDataSource und Business Logic Layer-Klassen können erweitert werden, um hinzuzufügen oder zu verweigern bestimmte Funktionen basierend auf den angemeldeten Benutzer.</span><span class="sxs-lookup"><span data-stu-id="8eb60-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="8eb60-264">In diesem Tutorial wurde erläutert, wie die Daten angezeigt und bearbeitet werden, je nachdem, ob der Benutzer ein bestimmter Lieferant zugeordnet wurde oder wenn sie sich für unser Unternehmen gearbeitet einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="8eb60-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="8eb60-265">Dieses Lernprogramm schließt unserer Untersuchung der einfügen, aktualisieren und Löschen von Daten mithilfe der GridView, DetailsView oder FormView-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="8eb60-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="8eb60-266">Ab dem nächsten Tutorial, müssen wir uns dem Hinzufügen von Paginierung und Sortierung Unterstützung aktivieren.</span><span class="sxs-lookup"><span data-stu-id="8eb60-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="8eb60-267">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="8eb60-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8eb60-268">Der Autor</span><span class="sxs-lookup"><span data-stu-id="8eb60-268">About the Author</span></span>

<span data-ttu-id="8eb60-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="8eb60-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8eb60-270">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="8eb60-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8eb60-271">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8eb60-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8eb60-272">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8eb60-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8eb60-273">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8eb60-273">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="8eb60-274">Vorherige</span><span class="sxs-lookup"><span data-stu-id="8eb60-274">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
