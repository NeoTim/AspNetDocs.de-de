---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: Erstellen einer Datenzugriffs Ebene (C#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial beginnen wir von Anfang an und erstellen die Datenzugriffs Schicht (Data Access Layer, DAL) unter Verwendung typisierter Datasets, um auf die Informationen in einer Datenbank zuzugreifen.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: 5aaf97dc8448dcb7b94ef2e4e23f34fd37ac4426
ms.sourcegitcommit: 6f0e10e4ca61a1e5534b09c655fd35cdc6886c8a
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/15/2019
ms.locfileid: "74115213"
---
# <a name="creating-a-data-access-layer-c"></a><span data-ttu-id="c0bad-103">Erstellen einer Datenzugriffsschicht (C#)</span><span class="sxs-lookup"><span data-stu-id="c0bad-103">Creating a Data Access Layer (C#)</span></span>

<span data-ttu-id="c0bad-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c0bad-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="c0bad-105">PDF herunterladen</span><span class="sxs-lookup"><span data-stu-id="c0bad-105">Download PDF</span></span>](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)

> <span data-ttu-id="c0bad-106">In diesem Tutorial beginnen wir von Anfang an und erstellen die Datenzugriffs Schicht (Data Access Layer, DAL) unter Verwendung typisierter Datasets, um auf die Informationen in einer Datenbank zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>

## <a name="introduction"></a><span data-ttu-id="c0bad-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="c0bad-107">Introduction</span></span>

<span data-ttu-id="c0bad-108">Bei Webentwicklern dreht sich unser Leben um die Arbeit mit Daten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="c0bad-109">Wir erstellen Datenbanken zum Speichern der Daten, zum Abrufen und Ändern von Code und zum Erfassen und Zusammenfassen von Webseiten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="c0bad-110">Dies ist das erste Tutorial in einer langen Reihe, in dem Techniken zum Implementieren dieser allgemeinen Muster in ASP.NET 2,0 erläutert werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="c0bad-111">Wir beginnen mit der Erstellung einer [Softwarearchitektur](http://en.wikipedia.org/wiki/Software_architecture) , die aus einer Datenzugriffs Schicht (Data Access Layer, DAL) unter Verwendung typisierter Datasets besteht, einer Geschäftslogik Schicht (Business Logic Layer, BLL), die benutzerdefinierte Geschäftsregeln erzwingt, und einer Präsentationsschicht bestehend aus ASP.NET Seiten, die ein gemeinsames Seitenlayout gemeinsam</span><span class="sxs-lookup"><span data-stu-id="c0bad-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="c0bad-112">Nachdem diese Back-End-Grundlagen festgelegt wurde, werden wir uns mit der Berichterstellung beschäftigen und zeigen, wie Sie Daten aus einer Webanwendung anzeigen, zusammenfassen, erfassen und validieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="c0bad-113">Diese Lernprogramme sind so konzipiert, dass Sie präzise sind, und enthalten Schritt-für-Schritt-Anleitungen mit vielen Screenshots, um Sie durch den Prozess visuell zu führen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="c0bad-114">Jedes Tutorial ist in C# und Visual Basic Versionen verfügbar und enthält einen Download des gesamten verwendeten Codes.</span><span class="sxs-lookup"><span data-stu-id="c0bad-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="c0bad-115">(Dieses erste Lernprogramm ist recht lang, aber der Rest wird in wesentlich mehr verdaulichen Blöcken dargestellt.)</span><span class="sxs-lookup"><span data-stu-id="c0bad-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="c0bad-116">Für diese Tutorials verwenden wir eine Microsoft SQL Server 2005 Express Edition-Version der Northwind-Datenbank, die im **App-\_Daten** Verzeichnis platziert wird.</span><span class="sxs-lookup"><span data-stu-id="c0bad-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="c0bad-117">Zusätzlich zur Datenbankdatei enthält der Ordner **App\_Data** auch die SQL-Skripts zum Erstellen der Datenbank, falls Sie eine andere Datenbankversion verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="c0bad-118">Diese Skripts können auch [direkt von Microsoft heruntergeladen](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en)werden, wenn Sie es vorziehen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="c0bad-119">Wenn Sie eine andere SQL Server Version der Northwind-Datenbank verwenden, müssen Sie die **northwndconnectionstring** -Einstellung in der Datei " **Web. config** " der Anwendung aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="c0bad-120">Die Webanwendung wurde mithilfe von Visual Studio 2005 Professional Edition als auf einem Dateisystem basierendes Website Projekt erstellt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="c0bad-121">Allerdings funktionieren alle Tutorials auch mit der kostenlosen Version von Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/), gleichermaßen gut.</span><span class="sxs-lookup"><span data-stu-id="c0bad-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="c0bad-122">In diesem Tutorial beginnen wir von Anfang an mit der Erstellung der Datenzugriffs Schicht (Data Access Layer, DAL), gefolgt von der Erstellung der Geschäftslogik Schicht (Business Logic Layer, BLL) im zweiten Tutorial und dem Arbeiten an Seitenlayout und Navigation in der dritten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="c0bad-123">Die Tutorials nach dem dritten basieren auf der Grundlage der Grundlage der ersten drei.</span><span class="sxs-lookup"><span data-stu-id="c0bad-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="c0bad-124">Wir haben in diesem ersten Tutorial viel zu tun, also sollten Sie Visual Studio starten und beginnen!</span><span class="sxs-lookup"><span data-stu-id="c0bad-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="c0bad-125">Schritt 1: Erstellen eines Webprojekts und Herstellen einer Verbindung mit der Datenbank</span><span class="sxs-lookup"><span data-stu-id="c0bad-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="c0bad-126">Bevor wir unsere Datenzugriffs Schicht (Data Access Layer, DAL) erstellen können, müssen wir zuerst eine Website erstellen und unsere Datenbank einrichten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="c0bad-127">Beginnen Sie mit dem Erstellen einer neuen Dateisystem basierten ASP.NET-Website.</span><span class="sxs-lookup"><span data-stu-id="c0bad-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="c0bad-128">Wechseln Sie hierzu zum Menü Datei, und wählen Sie neue Website und dann das Dialogfeld neue Website aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="c0bad-129">Wählen Sie die Vorlage ASP.NET-Website aus, legen Sie die Dropdown Liste Speicherort auf Datei System fest, wählen Sie einen Ordner zum Platzieren der Website aus, C#und legen Sie die Sprache auf fest.</span><span class="sxs-lookup"><span data-stu-id="c0bad-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>

<span data-ttu-id="c0bad-130">[![Erstellen einer neuen Datei System basierten Website](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="c0bad-131">**Abbildung 1**: Erstellen einer neuen Datei System basierten Website ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>

<span data-ttu-id="c0bad-132">Dadurch wird eine neue Website mit der ASP.NET-Seite " **default. aspx** " und einem **App-\_Daten** Ordner erstellt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="c0bad-133">Nachdem die Website erstellt wurde, besteht der nächste Schritt im Hinzufügen eines Verweises auf die Datenbank in der Server-Explorer von Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c0bad-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="c0bad-134">Indem Sie der Server-Explorer eine Datenbank hinzufügen, können Sie in Visual Studio Tabellen, gespeicherte Prozeduren, Sichten usw. hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="c0bad-135">Sie können auch Tabellendaten anzeigen oder eigene Abfragen entweder Hand oder grafisch über die Abfrage-Generator erstellen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="c0bad-136">Außerdem müssen wir beim Erstellen der typisierten Datasets für die DAL Visual Studio auf die Datenbank verweisen, aus der die typisierten Datasets erstellt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="c0bad-137">Obwohl wir diese Verbindungsinformationen zu diesem Zeitpunkt bereitstellen können, füllt Visual Studio automatisch eine Dropdown Liste der Datenbanken auf, die bereits im Server-Explorer registriert sind.</span><span class="sxs-lookup"><span data-stu-id="c0bad-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="c0bad-138">Die Schritte zum Hinzufügen der Northwind-Datenbank zu den Server-Explorer sind davon abhängig, ob Sie die SQL Server 2005 Express Edition-Datenbank im Datenordner der **App\_** verwenden möchten oder ob Sie stattdessen über eine Microsoft SQL Server 2000-oder 2005-Daten Bank Server-Setup verfügen, die Sie stattdessen verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-the-app_data-folder"></a><span data-ttu-id="c0bad-139">Verwenden einer Datenbank im App-\_Datenordner</span><span class="sxs-lookup"><span data-stu-id="c0bad-139">Using a Database in the App\_Data Folder</span></span>

<span data-ttu-id="c0bad-140">Wenn Sie nicht über einen SQL Server 2000-oder 2005-Datenbankserver verfügen, mit dem eine Verbindung hergestellt werden soll, oder wenn Sie die Datenbank nur einem Datenbankserver hinzufügen möchten, können Sie die SQL Server 2005 Express Edition-Version der Northwind-Datenbank verwenden, die sich in der **App\_Daten** Ordner der heruntergeladenen Website befindet (**Northwnd). MDF**).</span><span class="sxs-lookup"><span data-stu-id="c0bad-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="c0bad-141">Eine Datenbank, die in den **App-\_Daten** Ordner eingefügt wird, wird automatisch der Server-Explorer hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="c0bad-142">Wenn Sie SQL Server 2005 Express Edition auf Ihrem Computer installiert haben, sollte ein Knoten mit dem Namen Northwnd angezeigt werden. MDF im Server-Explorer, das Sie erweitern und die Tabellen, Sichten, gespeicherten Prozeduren usw. untersuchen können (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="c0bad-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="c0bad-143">Der **App-\_Daten** Ordner kann auch Microsoft Access **. mdb** -Dateien enthalten, die wie Ihre SQL Server Entsprechungen automatisch dem Server-Explorer hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="c0bad-144">Wenn Sie keine SQL Server Optionen verwenden möchten, können Sie jederzeit [eine Microsoft Access-Version der Northwind-Datenbankdatei herunterladen](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) und in das Datenverzeichnis der **App\_** .</span><span class="sxs-lookup"><span data-stu-id="c0bad-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="c0bad-145">Denken Sie jedoch daran, dass der Zugriff auf Datenbanken nicht so umfangreich wie SQL Server ist und nicht für die Verwendung in Website Szenarien konzipiert ist.</span><span class="sxs-lookup"><span data-stu-id="c0bad-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="c0bad-146">Außerdem werden in einigen der 35-Tutorials bestimmte Funktionen auf Datenbankebene verwendet, die nicht durch den Zugriff unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="c0bad-147">Herstellen einer Verbindung mit der Datenbank in einem Microsoft SQL Server 2000-oder 2005-Daten Bank Server</span><span class="sxs-lookup"><span data-stu-id="c0bad-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="c0bad-148">Alternativ dazu können Sie eine Verbindung mit einer Northwind-Datenbank herstellen, die auf einem Datenbankserver installiert ist.</span><span class="sxs-lookup"><span data-stu-id="c0bad-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="c0bad-149">Wenn auf dem Datenbankserver die Northwind-Datenbank noch nicht installiert ist, müssen Sie Sie zuerst dem Datenbankserver hinzufügen, indem Sie das Installationsskript ausführen, das im Download dieses Tutorials enthalten ist, oder indem Sie [die SQL Server 2000-Version von Northwind und das Installationsskript](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) direkt von der Website von Microsoft herunterladen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="c0bad-150">Wenn Sie die Datenbank installiert haben, navigieren Sie zum Server-Explorer in Visual Studio, klicken Sie mit der rechten Maustaste auf den Knoten Datenverbindungen, und wählen Sie dann Verbindung hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="c0bad-151">Wenn die Server-Explorer nicht angezeigt wird, wechseln Sie zur Ansicht/Server-Explorer, oder drücken Sie STRG + ALT + S.</span><span class="sxs-lookup"><span data-stu-id="c0bad-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="c0bad-152">Dadurch wird das Dialogfeld Verbindung hinzufügen angezeigt, in dem Sie den Server, mit dem eine Verbindung hergestellt werden soll, die Authentifizierungsinformationen und den Datenbanknamen angeben können.</span><span class="sxs-lookup"><span data-stu-id="c0bad-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="c0bad-153">Nachdem Sie die Daten bankverbindungs Informationen erfolgreich konfiguriert und auf die Schaltfläche OK geklickt haben, wird die Datenbank als Knoten unterhalb des Knotens Datenverbindungen hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="c0bad-154">Sie können den Datenbankknoten erweitern, um die Tabellen, Sichten, gespeicherten Prozeduren usw. zu untersuchen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>

![Hinzufügen einer Verbindung mit der Northwind-Datenbank des Datenbankservers](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="c0bad-156">**Abbildung 2**: Hinzufügen einer Verbindung mit der Northwind-Datenbank des Datenbankservers</span><span class="sxs-lookup"><span data-stu-id="c0bad-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>

## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="c0bad-157">Schritt 2: Erstellen der Datenzugriffs Ebene</span><span class="sxs-lookup"><span data-stu-id="c0bad-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="c0bad-158">Beim Arbeiten mit Daten besteht eine Option darin, die Daten spezifische Logik direkt in die Darstellungs Schicht einzubetten (in einer Webanwendung bilden die ASP.NET Seiten die Darstellungs Schicht).</span><span class="sxs-lookup"><span data-stu-id="c0bad-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="c0bad-159">Dies kann das Schreiben von ADO.NET-Code in den Codeteil der ASP.NET-Seite oder das Verwenden des SqlDataSource-Steuer Elements aus dem Markup Teil in Anspruch nehmen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="c0bad-160">In beiden Fällen verbindet diese Methode die Datenzugriffs Logik eng mit der Präsentationsebene.</span><span class="sxs-lookup"><span data-stu-id="c0bad-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="c0bad-161">Die empfohlene Vorgehensweise besteht jedoch darin, die Datenzugriffs Logik von der Darstellungs Schicht zu trennen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="c0bad-162">Diese separate Ebene wird als Datenzugriffs Schicht, kurz Dal, und wird in der Regel als separates Klassen Bibliotheksprojekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="c0bad-163">Die Vorteile dieser geschichteten Architektur sind gut dokumentiert (Weitere Informationen zu diesen Vorteilen finden Sie im Abschnitt "Weitere Messwerte" am Ende dieses Tutorials) und ist der Ansatz, den wir in dieser Reihe durchführen werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="c0bad-164">Sämtlicher Code, der spezifisch für die zugrunde liegende Datenquelle ist, z. b. das Erstellen einer Verbindung mit der Datenbank, das Ausstellen von **Select**-, **Insert**-, **Update**-und **Delete** -Befehlen usw., sollte in der dal gefunden werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="c0bad-165">Die Darstellungs Schicht sollte keine Verweise auf diesen Datenzugriffs Code enthalten, sondern stattdessen Aufrufe an die DAL für beliebige und alle Datenanforderungen richten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="c0bad-166">Datenzugriffsebenen enthalten in der Regel Methoden für den Zugriff auf die zugrunde liegenden Datenbankdaten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="c0bad-167">Die Datenbank Northwind enthält z. b. Tabellen mit **Produkten** und **Kategorien** , in denen die zu verkaufende Produkte und die Kategorien aufgezeichnet werden, zu denen Sie gehören.</span><span class="sxs-lookup"><span data-stu-id="c0bad-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="c0bad-168">In unserer dal verfügen wir über Methoden wie:</span><span class="sxs-lookup"><span data-stu-id="c0bad-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="c0bad-169">**GetCategories ():** gibt Informationen zu allen Kategorien zurück.</span><span class="sxs-lookup"><span data-stu-id="c0bad-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="c0bad-170">**GetProducts ()** , die Informationen zu allen Produkten zurückgibt</span><span class="sxs-lookup"><span data-stu-id="c0bad-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="c0bad-171">**Getproducungbycategoryid (*CategoryID*)** , die alle Produkte zurückgibt, die zu einer angegebenen Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="c0bad-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="c0bad-172">**Getproductbyproductid (*ProductID*)** , das Informationen zu einem bestimmten Produkt zurückgibt</span><span class="sxs-lookup"><span data-stu-id="c0bad-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="c0bad-173">Wenn diese Methoden aufgerufen werden, wird eine Verbindung mit der Datenbank hergestellt, die entsprechende Abfrage ausgegeben und die Ergebnisse zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="c0bad-174">Wie wir diese Ergebnisse zurückgeben, ist wichtig.</span><span class="sxs-lookup"><span data-stu-id="c0bad-174">How we return these results is important.</span></span> <span data-ttu-id="c0bad-175">Diese Methoden könnten einfach ein DataSet oder einen DataReader zurückgeben, das von der Datenbankabfrage aufgefüllt wird, aber im Idealfall sollten diese Ergebnisse mit *stark typisierten Objekten*zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="c0bad-176">Ein stark typisiertes Objekt ist ein Objekt, dessen Schema zum Zeitpunkt der Kompilierung streng definiert ist, wohingegen das Gegenteil, ein lose typisiertes Objekt, ein Objekt ist, dessen Schema bis zur Laufzeit nicht bekannt ist.</span><span class="sxs-lookup"><span data-stu-id="c0bad-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="c0bad-177">Beispielsweise handelt es sich bei dem DataReader-und dem DataSet (standardmäßig) um lose typisierte Objekte, da das Schema durch die Spalten definiert ist, die von der zum Auffüllen verwendeten Datenbankabfrage zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="c0bad-178">Für den Zugriff auf eine bestimmte Spalte aus einer lose typisierten Datentabelle muss die Syntax wie folgt verwendet werden:  <strong><em>datdatababel</em>. Rows [<em>Index</em>] ["<em>ColumnName</em>"]</strong>.</span><span class="sxs-lookup"><span data-stu-id="c0bad-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span></span> <span data-ttu-id="c0bad-179">Die lose Typisierung der Datentabelle in diesem Beispiel ist darauf zurückzuführen, dass wir mit einer Zeichenfolge oder einem Ordinalindex auf den Spaltennamen zugreifen müssen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="c0bad-180">Eine stark typisierte Datentabelle hingegen wird jede der Spalten als Eigenschaften implementiert, was zu Code führt, der wie folgt aussieht:  <strong><em>datdatababel</em>. Zeilen [<em>Index</em>]. *ColumnName</strong>* .</span><span class="sxs-lookup"><span data-stu-id="c0bad-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span></span>

<span data-ttu-id="c0bad-181">Um stark typisierte Objekte zurückzugeben, können Entwickler entweder eigene benutzerdefinierte Geschäftsobjekte erstellen oder typisierte Datasets verwenden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="c0bad-182">Ein Geschäftsobjekt wird vom Entwickler als Klasse implementiert, deren Eigenschaften üblicherweise die Spalten der zugrunde liegenden Datenbanktabelle widerspiegeln, die das Geschäftsobjekt darstellt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="c0bad-183">Ein typisiertes DataSet ist eine Klasse, die von Visual Studio basierend auf einem Datenbankschema generiert wird und dessen Member gemäß diesem Schema stark typisiert sind.</span><span class="sxs-lookup"><span data-stu-id="c0bad-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="c0bad-184">Das typisierte Dataset selbst besteht aus Klassen, die die Klassen ADO.NET DataSet, Datable und DataRow erweitern.</span><span class="sxs-lookup"><span data-stu-id="c0bad-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="c0bad-185">Zusätzlich zu stark typisierten DataTables enthalten typisierte Datasets jetzt auch TableAdapters, bei denen es sich um Klassen mit Methoden zum Auffüllen der DataTables des Datasets und zum erneuten Verteilen von Änderungen in den DataTables an die Datenbank handelt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="c0bad-186">Weitere Informationen zu den vor-und Nachteile der Verwendung typisierter Datasets im Vergleich zu benutzerdefinierten Geschäftsobjekten finden Sie unter [Entwerfen von Datenebenenkomponenten und übergeben von Daten durch Ebenen](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="c0bad-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>

<span data-ttu-id="c0bad-187">Wir verwenden stark typisierte Datasets für die Architektur dieser Tutorials.</span><span class="sxs-lookup"><span data-stu-id="c0bad-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="c0bad-188">In Abbildung 3 wird der Workflow zwischen den verschiedenen Ebenen einer Anwendung veranschaulicht, die typisierte Datasets verwendet.</span><span class="sxs-lookup"><span data-stu-id="c0bad-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>

<span data-ttu-id="c0bad-189">[![sämtlicher Datenzugriffs Code an die DAL verwiesen wird](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="c0bad-190">**Abbildung 3**: der gesamte Datenzugriffs Code wird an die DAL verwiesen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>

## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="c0bad-191">Erstellen eines typisierten Datasets und Tabellen Adapters</span><span class="sxs-lookup"><span data-stu-id="c0bad-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="c0bad-192">Um mit dem Erstellen unserer dal zu beginnen, fügen wir dem Projekt zunächst ein typisiertes Dataset hinzu.</span><span class="sxs-lookup"><span data-stu-id="c0bad-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="c0bad-193">Klicken Sie hierzu im Projektmappen-Explorer mit der rechten Maustaste auf den Projekt Knoten, und wählen Sie neues Element hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="c0bad-194">Wählen Sie in der Liste der Vorlagen die Option DataSet aus, und nennen Sie Sie **Northwind. xsd**.</span><span class="sxs-lookup"><span data-stu-id="c0bad-194">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>

<span data-ttu-id="c0bad-195">[![auswählen, dem Projekt ein neues Dataset hinzuzufügen.](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="c0bad-196">**Abbildung 4**: Auswählen eines neuen Datasets zum Projekt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>

<span data-ttu-id="c0bad-197">Nachdem Sie auf Hinzufügen geklickt haben, klicken Sie auf Ja, wenn Sie aufgefordert werden, das DataSet dem **App-\_Code** Ordner hinzuzufügen</span><span class="sxs-lookup"><span data-stu-id="c0bad-197">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="c0bad-198">Der Designer für das typisierte DataSet wird dann angezeigt, und der TableAdapter-Konfigurations-Assistent wird gestartet, sodass Sie dem typisierten DataSet ihren ersten TableAdapter hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="c0bad-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="c0bad-199">Ein typisiertes DataSet dient als stark typisierte Auflistung von Daten. Sie besteht aus stark typisierten Datentabelle-Instanzen, die wiederum aus stark typisierten DataRow-Instanzen bestehen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="c0bad-200">Wir erstellen eine stark typisierte Datentabelle für jede der zugrunde liegenden Datenbanktabellen, mit denen wir in dieser Reihe von Tutorials arbeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="c0bad-201">Beginnen wir mit dem Erstellen einer Datentabelle für die Tabelle " **Products** ".</span><span class="sxs-lookup"><span data-stu-id="c0bad-201">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="c0bad-202">Beachten Sie, dass stark typisierte DataTables keine Informationen zum Zugriff auf Daten aus der zugrunde liegenden Datenbanktabelle enthalten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="c0bad-203">Um die Daten zum Auffüllen der Datentabelle abzurufen, verwenden wir eine TableAdapter-Klasse, die als Datenzugriffs Schicht fungiert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="c0bad-204">Für die Datentabelle " **Produkte** " enthält der TableAdapter die Methoden " **GetProducts ()** ", " **getproductbycategoryid" (*CategoryID*)** usw., die wir von der Präsentationsebene aus aufrufen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-204">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="c0bad-205">Die Rolle der Datentabelle besteht darin, als stark typisierte Objekte zu fungieren, die zum Übergeben von Daten zwischen den Ebenen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="c0bad-206">Der TableAdapter-Konfigurations-Assistent beginnt mit der Aufforderung, auszuwählen, mit welcher Datenbank Sie arbeiten möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="c0bad-207">In der Dropdown Liste werden diese Datenbanken in der Server-Explorer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="c0bad-208">Wenn Sie die Datenbank Northwind nicht zum Server-Explorer hinzugefügt haben, können Sie zu diesem Zeitpunkt auf die Schaltfläche neue Verbindung klicken.</span><span class="sxs-lookup"><span data-stu-id="c0bad-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>

<span data-ttu-id="c0bad-209">[![Sie in der Dropdown Liste die Datenbank Northwind aus.](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="c0bad-210">**Abbildung 5**: Auswählen der Northwind-Datenbank in der Dropdown Liste ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>

<span data-ttu-id="c0bad-211">Nachdem Sie die Datenbank ausgewählt und auf "weiter" geklickt haben, werden Sie gefragt, ob Sie die Verbindungs Zeichenfolge in der Datei " **Web. config** " speichern möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="c0bad-212">Wenn Sie die Verbindungs Zeichenfolge speichern, sollten Sie in den TableAdapter-Klassen nicht hart codiert sein, was die Dinge vereinfacht, wenn sich die Verbindungs Zeichenfolgen-Informationen in Zukunft ändern.</span><span class="sxs-lookup"><span data-stu-id="c0bad-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="c0bad-213">Wenn Sie die Verbindungs Zeichenfolge in der Konfigurationsdatei speichern, befindet Sie sich im Abschnitt **&lt;connectionStrings&gt;** , der optional für eine verbesserte Sicherheit [verschlüsselt](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) oder später über die neue ASP.NET 2,0-Eigenschaften Seite im IIS GUI Admin Tool geändert werden kann, was für Administratoren ideal ist.</span><span class="sxs-lookup"><span data-stu-id="c0bad-213">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>

<span data-ttu-id="c0bad-214">[![die Verbindungs Zeichenfolge in "Web. config" speichern.](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="c0bad-215">**Abbildung 6**: Speichern der Verbindungs Zeichenfolge in " **Web. config** " ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-215">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>

<span data-ttu-id="c0bad-216">Als nächstes müssen wir das Schema für die erste Datentabelle mit starker Typisierung definieren und die erste Methode angeben, die der TableAdapter beim Auffüllen des stark typisierten Datasets verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="c0bad-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="c0bad-217">Diese beiden Schritte werden gleichzeitig ausgeführt, indem eine Abfrage erstellt wird, die die Spalten aus der Tabelle zurückgibt, die in unserer Datentabelle wiedergegeben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="c0bad-218">Am Ende des Assistenten wird dieser Abfrage ein Methodenname übergeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="c0bad-219">Nachdem dies geschehen ist, kann diese Methode von der Präsentationsebene aus aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="c0bad-220">Die-Methode führt die definierte Abfrage aus und füllt eine stark typisierte Datentabelle auf.</span><span class="sxs-lookup"><span data-stu-id="c0bad-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="c0bad-221">Um mit der Definition der SQL-Abfrage zu beginnen, müssen Sie zunächst angeben, wie der TableAdapter die Abfrage ausgeben soll.</span><span class="sxs-lookup"><span data-stu-id="c0bad-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="c0bad-222">Wir können eine Ad-hoc-SQL-Anweisung verwenden, eine neue gespeicherte Prozedur erstellen oder eine vorhandene gespeicherte Prozedur verwenden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="c0bad-223">Für diese Tutorials verwenden wir Ad-hoc-SQL-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="c0bad-224">Ein Beispiel für die Verwendung von gespeicherten Prozeduren finden Sie im Artikel zu [Brian Noyes](http://briannoyes.net/), [Erstellen einer Datenzugriffs Ebene mit dem Visual Studio 2005-DataSet-Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) .</span><span class="sxs-lookup"><span data-stu-id="c0bad-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>

<span data-ttu-id="c0bad-225">[![Abfragen der Daten mit einer Ad-hoc-SQL-Anweisung](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="c0bad-226">**Abbildung 7**: Abfragen der Daten mit einer Ad-hoc-SQL-Anweisung ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>

<span data-ttu-id="c0bad-227">An dieser Stelle können wir die SQL-Abfrage in Hand eingeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="c0bad-228">Wenn Sie die erste Methode im TableAdapter erstellen, möchten Sie in der Regel, dass die Abfrage die Spalten zurückgibt, die in der entsprechenden Datentabelle ausgedrückt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="c0bad-229">Dies erreichen Sie, indem Sie eine Abfrage erstellen, die alle Spalten und alle Zeilen aus der **Products** -Tabelle zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="c0bad-229">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>

<span data-ttu-id="c0bad-230">[![geben Sie die SQL-Abfrage in das Textfeld ein.](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="c0bad-231">**Abbildung 8**: Geben Sie die SQL-Abfrage in das Textfeld ein ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image22.png)).</span><span class="sxs-lookup"><span data-stu-id="c0bad-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>

<span data-ttu-id="c0bad-232">Verwenden Sie alternativ die Abfrage-Generator, und erstellen Sie die Abfrage grafisch, wie in Abbildung 9 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>

<span data-ttu-id="c0bad-233">[![Sie die Abfrage mithilfe des Abfrage-Editors grafisch zu erstellen.](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="c0bad-234">**Abbildung 9**: grafisch erstellen der Abfrage mithilfe des Abfrage-Editors ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>

<span data-ttu-id="c0bad-235">Nachdem Sie die Abfrage erstellt haben, aber bevor Sie auf den nächsten Bildschirm wechseln, klicken Sie auf die Schaltfläche Erweiterte Optionen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="c0bad-236">In Website Projekten ist "INSERT-, Update-und DELETE-Anweisungen generieren" die einzige erweiterte Option, die standardmäßig ausgewählt ist. Wenn Sie diesen Assistenten aus einer Klassenbibliothek oder einem Windows-Projekt ausführen, wird auch die Option "vollständige Parallelität verwenden" ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="c0bad-237">Lassen Sie die Option "optimistische Parallelität verwenden" deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="c0bad-238">Die optimistische Parallelität wird in zukünftigen Tutorials untersucht.</span><span class="sxs-lookup"><span data-stu-id="c0bad-238">We'll examine optimistic concurrency in future tutorials.</span></span>

<span data-ttu-id="c0bad-239">[![nur die Option INSERT-, Update-und DELETE-Anweisungen generieren auswählen](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="c0bad-240">**Abbildung 10**: Wählen Sie nur die Option INSERT-, Update-und DELETE-Anweisungen generieren aus ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image28.png)).</span><span class="sxs-lookup"><span data-stu-id="c0bad-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>

<span data-ttu-id="c0bad-241">Nachdem Sie die erweiterten Optionen überprüft haben, klicken Sie auf Weiter, um mit dem letzten Bildschirm fortzufahren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="c0bad-242">Hier werden wir aufgefordert, auszuwählen, welche Methoden dem TableAdapter hinzugefügt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="c0bad-243">Es gibt zwei Muster zum Auffüllen von Daten:</span><span class="sxs-lookup"><span data-stu-id="c0bad-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="c0bad-244">**Datentabelle ausfüllen** mit diesem Ansatz wird eine Methode erstellt, die eine Datentabelle als Parameter annimmt und Sie basierend auf den Ergebnissen der Abfrage auffüllt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="c0bad-245">Die ADO.NET DataAdapter-Klasse implementiert dieses Muster z. b. mit der **Fill ()** -Methode.</span><span class="sxs-lookup"><span data-stu-id="c0bad-245">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="c0bad-246">**Zurückgeben einer Daten** Tabelle mit diesem Ansatz die Methode erstellt und füllt die Datentabelle für Sie und gibt Sie als Rückgabewert der Methode zurück.</span><span class="sxs-lookup"><span data-stu-id="c0bad-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="c0bad-247">Der TableAdapter kann ein oder beide dieser Muster implementieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="c0bad-248">Sie können auch die hier bereitgestellten Methoden umbenennen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="c0bad-249">Lassen Sie beide Kontrollkästchen aktiviert, auch wenn in diesen Tutorials nur das letztere Muster verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c0bad-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="c0bad-250">Benennen wir außerdem die eher generische **GetData** -Methode in " **GetProducts**" um.</span><span class="sxs-lookup"><span data-stu-id="c0bad-250">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="c0bad-251">Wenn dieses Kontrollkästchen aktiviert ist, erstellt das letzte Kontrollkästchen "GenerateDBDirectMethods" eine **Insert ()** -, **Update ()** -und **Delete ()** -Methode für den TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="c0bad-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="c0bad-252">Wenn Sie diese Option nicht aktiviert lassen, müssen alle Updates über die Methode "Single **Update ()** " des TableAdapter durchgeführt werden, die das typisierte DataSet, eine Datentabelle, eine einzelne DataRow oder ein Array von "DataRows" annimmt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="c0bad-253">(Wenn Sie die Option "INSERT-, Update-und DELETE-Anweisungen generieren" in den erweiterten Eigenschaften in Abbildung 9 deaktiviert haben, hat die Einstellung dieses Kontrollkästchens keine Auswirkung.) Lassen Sie dieses Kontrollkästchen deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>

<span data-ttu-id="c0bad-254">[![Ändern des Methoden namens von "GetData" in "GetProducts"](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="c0bad-255">**Abbildung 11**: Ändern des Methoden namens von " **GetData** " in " **GetProducts** " ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-255">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>

<span data-ttu-id="c0bad-256">Beenden Sie den Assistenten, indem Sie auf Fertigstellen klicken.</span><span class="sxs-lookup"><span data-stu-id="c0bad-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="c0bad-257">Nachdem der Assistent geschlossen wurde, werden Sie an den DataSet-Designer zurückgegeben, der die soeben erstellte Datentabelle anzeigt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="c0bad-258">Die Liste der Spalten in der Datentabelle " **Products** " (**ProductID**, **ProductName**usw.) sowie die Methoden von **ProductsTableAdapter** (**Fill ()** und **GetProducts ()** ) können angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-258">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>

<span data-ttu-id="c0bad-259">[![die Datentabelle "Products" und "ProductsTableAdapter" dem typisierten DataSet hinzugefügt.](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="c0bad-260">**Abbildung 12**: die Datentabelle " **Products** " und " **ProductsTableAdapter** " wurden dem typisierten DataSet hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-260">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>

<span data-ttu-id="c0bad-261">An diesem Punkt verfügen wir über ein typisiertes DataSet mit einer einzelnen Datentabelle (**Northwind. Products**) und einer stark typisierten DataAdapter-Klasse (**northwindtableadapters. ProductsTableAdapter**) mit einer **GetProducts ()** -Methode.</span><span class="sxs-lookup"><span data-stu-id="c0bad-261">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="c0bad-262">Diese Objekte können verwendet werden, um auf eine Liste aller Produkte aus Code wie zu zugreifen:</span><span class="sxs-lookup"><span data-stu-id="c0bad-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="c0bad-263">Dieser Code erforderte nicht das Schreiben eines Bits von Datenzugriffs spezifischem Code.</span><span class="sxs-lookup"><span data-stu-id="c0bad-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="c0bad-264">Es mussten keine ADO.NET-Klassen instanziiert werden. es mussten keine Verbindungs Zeichenfolgen, SQL-Abfragen oder gespeicherten Prozeduren bezogen werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="c0bad-265">Stattdessen stellt der TableAdapter den Datenzugriffs Code auf niedriger Ebene für uns bereit.</span><span class="sxs-lookup"><span data-stu-id="c0bad-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="c0bad-266">Jedes in diesem Beispiel verwendete Objekt ist ebenfalls stark typisiert und ermöglicht Visual Studio die Bereitstellung von IntelliSense und der Typüberprüfung zur Kompilierzeit.</span><span class="sxs-lookup"><span data-stu-id="c0bad-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="c0bad-267">Und das Beste aus allen vom TableAdapter zurückgegebenen DataTables kann an ASP.net-datenweb Steuerelemente gebunden werden, z. b. GridView, DetailsView, DropDownList, CheckBoxList und verschiedene andere.</span><span class="sxs-lookup"><span data-stu-id="c0bad-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="c0bad-268">Im folgenden Beispiel wird veranschaulicht, wie die Datentabelle, die von der **GetProducts ()** -Methode zurückgegeben wurde, an ein GridView-Steuerelemente in nur wenigen drei Codezeilen innerhalb der **Seite\_Lade** Ereignishandler gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="c0bad-268">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="c0bad-269">Allproducts. aspx</span><span class="sxs-lookup"><span data-stu-id="c0bad-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="c0bad-270">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="c0bad-270">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]

<span data-ttu-id="c0bad-271">[![die Liste der Produkte in einer GridView angezeigt wird](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="c0bad-272">**Abbildung 13**: die Liste der Produkte wird in einer GridView angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>

<span data-ttu-id="c0bad-273">Obwohl dieses Beispiel erfordert, dass wir drei Codezeilen auf der **Seite\_Load** -Ereignishandler unserer ASP.NET-Seite schreiben, untersuchen wir in zukünftigen Tutorials, wie Sie ObjectDataSource verwenden, um die Daten deklarativ aus der dal abzurufen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-273">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="c0bad-274">Mit ObjectDataSource müssen wir keinen Code schreiben, und es werden auch Paging-und Sortierungs Unterstützung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="c0bad-275">Schritt 3: Hinzufügen parametrisierter Methoden zur Datenzugriffs Ebene</span><span class="sxs-lookup"><span data-stu-id="c0bad-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="c0bad-276">An diesem Punkt verfügt unsere **ProductsTableAdapter** -Klasse über eine Methode, **GetProducts ()** , die alle Produkte in der Datenbank zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-276">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="c0bad-277">Obwohl die Arbeit mit allen Produkten absolut sinnvoll ist, gibt es Zeiten, in denen wir Informationen zu einem bestimmten Produkt oder zu allen Produkten abrufen möchten, die zu einer bestimmten Kategorie gehören.</span><span class="sxs-lookup"><span data-stu-id="c0bad-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="c0bad-278">Um dieser Datenzugriffs Ebene eine solche Funktionalität hinzuzufügen, können wir dem TableAdapter parametrisierte Methoden hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="c0bad-279">Fügen Sie die **getproduczbycategoryid (*CategoryID*)** -Methode hinzu.</span><span class="sxs-lookup"><span data-stu-id="c0bad-279">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="c0bad-280">Kehren Sie zum Hinzufügen einer neuen Methode zur dal zurück zum DataSet-Designer, klicken Sie mit der rechten Maustaste in den Abschnitt **ProductsTableAdapter** , und wählen Sie Abfrage hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>

![Klicken Sie mit der rechten Maustaste auf den TableAdapter und wählen Sie Abfrage hinzufügen](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="c0bad-282">**Abbildung 14**: Klicken Sie mit der rechten Maustaste auf den TableAdapter, und wählen Sie Abfrage hinzufügen</span><span class="sxs-lookup"><span data-stu-id="c0bad-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>

<span data-ttu-id="c0bad-283">Wir werden zuerst gefragt, ob Sie mit einer Ad-hoc-SQL-Anweisung oder einer neuen oder vorhandenen gespeicherten Prozedur auf die Datenbank zugreifen möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="c0bad-284">Wir möchten eine Ad-hoc-SQL-Anweisung erneut verwenden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="c0bad-285">Als nächstes werden wir gefragt, welche Art von SQL-Abfrage wir verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="c0bad-286">Da wir alle Produkte zurückgeben möchten, die zu einer bestimmten Kategorie gehören, möchten wir eine **Select** -Anweisung schreiben, die Zeilen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-286">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>

<span data-ttu-id="c0bad-287">[![erstellen Sie eine SELECT-Anweisung, die Zeilen zurückgibt](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="c0bad-288">**Abbildung 15**: Auswählen der Erstellung einer **Select** -Anweisung, die Zeilen zurückgibt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-288">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>

<span data-ttu-id="c0bad-289">Der nächste Schritt besteht darin, die SQL-Abfrage zu definieren, die für den Datenzugriff verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c0bad-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="c0bad-290">Da wir nur die Produkte zurückgeben möchten, die zu einer bestimmten Kategorie gehören, verwende ich dieselbe <strong>Select</strong> -Anweisung aus " <strong>GetProducts ()</strong>", füge aber die folgende <strong>Where</strong> -Klausel hinzu: <strong>Where CategoryID = @CategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="c0bad-290">Since we want to return only those products that belong to a particular category, I use the same <strong>SELECT</strong> statement from <strong>GetProducts()</strong>, but add the following <strong>WHERE</strong> clause: <strong>WHERE CategoryID = @CategoryID</strong>.</span></span> <span data-ttu-id="c0bad-291">Der <strong>@CategoryID</strong> -Parameter gibt dem TableAdapter-Assistenten an, dass für die Methode, die wir erstellen, ein Eingabeparameter vom entsprechenden Typ erforderlich ist (also eine Ganzzahl, die NULL-Werte zulässt).</span><span class="sxs-lookup"><span data-stu-id="c0bad-291">The <strong>@CategoryID</strong> parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>

<span data-ttu-id="c0bad-292">[![geben Sie eine Abfrage ein, um nur Produkte in einer bestimmten Kategorie zurückzugeben.](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="c0bad-293">**Abbildung 16**: eingeben einer Abfrage zum Zurückgeben von Produkten in einer angegebenen Kategorie ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>

<span data-ttu-id="c0bad-294">Im letzten Schritt können Sie auswählen, welche Datenzugriffs Muster verwendet werden sollen, und wie Sie die Namen der generierten Methoden anpassen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="c0bad-295">Für das Füllmuster ändern wir den Namen in <strong>fillbycategoryid</strong> und geben für die Rückgabe eines Datentabelle-Rückgabe Musters ( <strong>get*X</strong>*  -Methoden) <strong>getproductbycategoryid</strong>an.</span><span class="sxs-lookup"><span data-stu-id="c0bad-295">For the Fill pattern, let's change the name to <strong>FillByCategoryID</strong> and for the return a DataTable return pattern (the <strong>Get*X</strong>* methods), let's use <strong>GetProductsByCategoryID</strong>.</span></span>

<span data-ttu-id="c0bad-296">[![wählen Sie die Namen für die TableAdapter-Methoden aus.](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="c0bad-297">**Abbildung 17**: Auswählen der Namen für die TableAdapter-Methoden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>

<span data-ttu-id="c0bad-298">Nachdem Sie den Assistenten abgeschlossen haben, enthält der DataSet-Designer die neuen TableAdapter-Methoden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>

![Die Produkte können jetzt nach Kategorie abgefragt werden.](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="c0bad-300">**Abbildung 18**: die Produkte können jetzt nach Kategorie abgefragt werden</span><span class="sxs-lookup"><span data-stu-id="c0bad-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>

<span data-ttu-id="c0bad-301">Nehmen Sie sich einen Moment Zeit, um eine **getproductbyproductid (*ProductID*)** -Methode mit derselben Technik hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-301">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="c0bad-302">Diese parametrisierten Abfragen können direkt über den DataSet-Designer getestet werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="c0bad-303">Klicken Sie mit der rechten Maustaste auf die Methode im TableAdapter, und wählen Sie Daten Vorschau aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="c0bad-304">Geben Sie als nächstes die für die Parameter zu verwendenden Werte ein, und klicken Sie auf Vorschau.</span><span class="sxs-lookup"><span data-stu-id="c0bad-304">Next, enter the values to use for the parameters and click Preview.</span></span>

<span data-ttu-id="c0bad-305">[Es werden ![Produkte angezeigt, die zur Kategorie Getränke gehören.](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="c0bad-306">**Abbildung 19**: die Produkte, die zur Kategorie Getränke gehören, werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>

<span data-ttu-id="c0bad-307">Mit der **getproduczbycategoryid (*CategoryID*)** -Methode in unserer dal können wir nun eine ASP.NET-Seite erstellen, auf der nur die Produkte in einer bestimmten Kategorie angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-307">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="c0bad-308">Im folgenden Beispiel werden alle Produkte angezeigt, die in der Kategorie Getränke enthalten sind und die **CategoryID** 1 aufweisen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-308">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="c0bad-309">Getränke. ASP</span><span class="sxs-lookup"><span data-stu-id="c0bad-309">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="c0bad-310">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="c0bad-310">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]

<span data-ttu-id="c0bad-311">[![diese Produkte in der Kategorie Getränke angezeigt werden.](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="c0bad-312">**Abbildung 20**: diese Produkte in der Kategorie Getränke werden angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>

## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="c0bad-313">Schritt 4: einfügen, aktualisieren und Löschen von Daten</span><span class="sxs-lookup"><span data-stu-id="c0bad-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="c0bad-314">Es gibt zwei Muster, die häufig für das Einfügen, aktualisieren und Löschen von Daten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="c0bad-315">Das erste Muster, das ich als direktes Daten Bank Muster nenne, umfasst das Erstellen von Methoden, die beim Aufrufen einen **Insert**-, **Update**-oder **Delete** -Befehl für die Datenbank ausgeben, die für einen einzelnen Datenbankdaten Satz funktioniert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="c0bad-316">Solche Methoden werden in der Regel in einer Reihe von skalaren Werten (ganze Zahlen, Zeichen folgen, boolesche Werte, DateTime usw.), die den Werten zum Einfügen, aktualisieren oder löschen entsprechen, weitergegeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="c0bad-317">Mit diesem Muster für die **Products** -Tabelle würde die Delete-Methode z. b. einen ganzzahligen Parameter annehmen, der die **ProductID** des zu löschenden Datensatzes angibt, während die Insert-Methode eine Zeichenfolge für den **ProductName**, ein Dezimalzeichen für den **UnitPrice**, eine Ganzzahl für den **unitsonstock**usw. annimmt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-317">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>

<span data-ttu-id="c0bad-318">[![jede INSERT-, Update-und DELETE-Anforderung sofort an die Datenbank gesendet wird.](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="c0bad-319">**Abbildung 21**: jede INSERT-, Update-und DELETE-Anforderung wird sofort an die Datenbank gesendet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>

<span data-ttu-id="c0bad-320">Das andere Muster, das ich als Batch Aktualisierungs Muster bezeichne, besteht darin, ein gesamtes DataSet, eine Datentabelle oder eine Auflistung von DataRows in einem Methoden aufzurufen zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="c0bad-321">Mit diesem Muster löscht ein Entwickler die DataRows in einer Datentabelle, fügt Sie ein und ändert Sie und übergibt diese DataRows oder Datentabelle dann an eine Aktualisierungs Methode.</span><span class="sxs-lookup"><span data-stu-id="c0bad-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="c0bad-322">Diese Methode listet dann die weiter gegebenen DataRows auf, bestimmt, ob Sie geändert, hinzugefügt oder gelöscht wurden (über den [RowState-Eigenschafts](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) Wert von DataRow), und gibt die entsprechende Daten Bank Anforderung für jeden Datensatz aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>

<span data-ttu-id="c0bad-323">[![alle Änderungen mit der Datenbank synchronisiert werden, wenn die Aktualisierungs Methode aufgerufen wird.](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="c0bad-324">**Abbildung 22**: alle Änderungen werden mit der Datenbank synchronisiert, wenn die Aktualisierungs Methode aufgerufen wird ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>

<span data-ttu-id="c0bad-325">Der TableAdapter verwendet standardmäßig das Batch Aktualisierungs Muster, unterstützt aber auch das direkte DB-Muster.</span><span class="sxs-lookup"><span data-stu-id="c0bad-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="c0bad-326">Da wir beim Erstellen des TableAdapters die Option "INSERT-, Update-und DELETE-Anweisungen generieren" in den erweiterten Eigenschaften ausgewählt haben, enthält der **ProductsTableAdapter** eine **Update ()** -Methode, die das Batch Aktualisierungs Muster implementiert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="c0bad-327">Der TableAdapter enthält insbesondere eine **Update ()** -Methode, der das typisierte DataSet, eine stark typisierte Datentabelle oder eine oder mehrere DataRows (DataRows) weitergegeben werden können.</span><span class="sxs-lookup"><span data-stu-id="c0bad-327">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="c0bad-328">Wenn Sie das Kontrollkästchen "GenerateDBDirectMethods" beim ersten Erstellen des TableAdapter aktiviert lassen, wird das direkte DB-Muster auch über die Methoden **Insert ()** , **Update ()** und **Delete ()** implementiert.</span><span class="sxs-lookup"><span data-stu-id="c0bad-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="c0bad-329">Beide Daten Änderungs Muster verwenden die Eigenschaften **InsertCommand**, **UpdateCommand**und **DeleteCommand** des TableAdapter, um Ihre **Insert**-, **Update**-und **Delete** -Befehle an die Datenbank auszugeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-329">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="c0bad-330">Sie können die Eigenschaften **InsertCommand**, **UpdateCommand**und **DeleteCommand** überprüfen und ändern, indem Sie auf den TableAdapter im DataSet-Designer klicken und dann zum Eigenschaftenfenster wechseln.</span><span class="sxs-lookup"><span data-stu-id="c0bad-330">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="c0bad-331">(Stellen Sie sicher, dass Sie den TableAdapter ausgewählt haben und dass das **ProductsTableAdapter** -Objekt das in der Dropdown Liste in der Eigenschaftenfenster ausgewählte ist.)</span><span class="sxs-lookup"><span data-stu-id="c0bad-331">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>

<span data-ttu-id="c0bad-332">[![der TableAdapter über die Eigenschaften InsertCommand, UpdateCommand und DeleteCommand verfügt.](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="c0bad-333">**Abbildung 23**: der TableAdapter verfügt über die Eigenschaften **InsertCommand**, **UpdateCommand**und **DeleteCommand** ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-333">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>

<span data-ttu-id="c0bad-334">Um die Eigenschaften der Daten Bank Befehle zu überprüfen oder zu ändern, klicken Sie auf die untergeordnete Eigenschaft **CommandText** , um die Abfrage-Generator zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-334">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>

<span data-ttu-id="c0bad-335">[![Konfigurieren der INSERT-, Update-und DELETE-Anweisungen im Abfrage-Generator](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="c0bad-336">**Abbildung 24**: Konfigurieren der **Insert**-, **Update**-und **Delete** -Anweisungen im Abfrage-Generator ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-336">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>

<span data-ttu-id="c0bad-337">Im folgenden Codebeispiel wird veranschaulicht, wie das Batch Aktualisierungs Muster verwendet wird, um den Preis aller Produkte zu verdoppeln, die nicht eingestellt werden und 25 Einheiten in Aktien oder weniger aufweisen:</span><span class="sxs-lookup"><span data-stu-id="c0bad-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="c0bad-338">Der folgende Code veranschaulicht, wie das direkte Daten Bank Muster verwendet wird, um ein bestimmtes Produktprogramm gesteuert zu löschen, anschließend ein Update zu aktualisieren und dann ein neues hinzuzufügen:</span><span class="sxs-lookup"><span data-stu-id="c0bad-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="c0bad-339">Erstellen von benutzerdefinierten INSERT-, Update-und Delete-Methoden</span><span class="sxs-lookup"><span data-stu-id="c0bad-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="c0bad-340">Die von der direkten Daten Bank Methode erstellten **Insert ()** -, **Update ()** -und **Delete ()** -Methoden können etwas umständlich sein, insbesondere bei Tabellen mit vielen Spalten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-340">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="c0bad-341">Wenn Sie sich das vorherige Codebeispiel ansehen, ist es ohne IntelliSense nicht besonders zu verdeutlichen, welche **Produkte** Table Column den einzelnen Eingabe Parametern der **Update ()** -Methode und der **Insert ()** -Methode zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="c0bad-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="c0bad-342">Es kann vorkommen, dass Sie nur eine einzelne Spalte oder zwei aktualisieren möchten oder eine angepasste **Insert ()** **-Methode** wünschen, die den Wert des neu eingefügten Datensatzes (automatisch Inkrement) zurückgeben soll.</span><span class="sxs-lookup"><span data-stu-id="c0bad-342">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="c0bad-343">Kehren Sie zum Erstellen einer solchen benutzerdefinierten Methode zum DataSet-Designer zurück.</span><span class="sxs-lookup"><span data-stu-id="c0bad-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="c0bad-344">Klicken Sie mit der rechten Maustaste auf den TableAdapter, und wählen Sie Abfrage hinzufügen, um zum TableAdapter-Assistenten zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="c0bad-345">Auf dem zweiten Bildschirm können Sie den Typ der zu erstellenden Abfrage angeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="c0bad-346">Wir erstellen eine Methode, die ein neues Produkt hinzufügt und dann den Wert der **ProductID**des neu hinzugefügten Datensatzes zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-346">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="c0bad-347">Wählen Sie daher aus, dass Sie eine **Insert** -Abfrage erstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-347">Therefore, opt to create an **INSERT** query.</span></span>

<span data-ttu-id="c0bad-348">[![eine Methode erstellen, um der Tabelle "Products" eine neue Zeile hinzuzufügen.](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="c0bad-349">**Abbildung 25**: Erstellen einer Methode zum Hinzufügen einer neuen Zeile zur Tabelle " **Products** " ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-349">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>

<span data-ttu-id="c0bad-350">Auf dem nächsten Bildschirm wird der **CommandText** von **InsertCommand**angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-350">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="c0bad-351">Erweitern Sie diese Abfrage, indem Sie am Ende der Abfrage **Select Scope\_Identity ()** hinzufügen, wodurch der letzte Identitäts Wert zurückgegeben wird, der in eine **Identitäts** Spalte im selben Bereich eingefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="c0bad-351">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="c0bad-352">(In der [technischen Dokumentation](https://msdn.microsoft.com/library/ms190315.aspx) finden Sie weitere Informationen zum **Bereich\_Identity ()** und dazu, warum Sie den [Bereich\_Identity () anstelle von @@IDENTITYverwenden ](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx)möchten.) Stellen Sie sicher, dass Sie die **Insert** -Anweisung mit einem Semikolon beenden, bevor Sie die **Select** -Anweisung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>

<span data-ttu-id="c0bad-353">[![die Abfrage erweitern, um den SCOPE_IDENTITY ()-Wert zurückzugeben.](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="c0bad-354">**Abbildung 26**: Erweitern der Abfrage, um den **Bereich\_Identity ()** -Wert zurückzugeben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-354">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>

<span data-ttu-id="c0bad-355">Benennen Sie schließlich die neue Methode **insertProduct**.</span><span class="sxs-lookup"><span data-stu-id="c0bad-355">Finally, name the new method **InsertProduct**.</span></span>

<span data-ttu-id="c0bad-356">[![legen Sie den Namen der neuen Methode auf insertProduct fest.](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="c0bad-357">**Abbildung 27**: Festlegen des Namens der neuen Methode auf **insertProduct** ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-357">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>

<span data-ttu-id="c0bad-358">Wenn Sie zum DataSet-Designer zurückkehren, sehen Sie, dass der **ProductsTableAdapter** die neue Methode **insertProduct**enthält.</span><span class="sxs-lookup"><span data-stu-id="c0bad-358">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="c0bad-359">Wenn diese neue Methode keinen Parameter für jede Spalte in der **Products** -Tabelle enthält, haben Sie die Wahrscheinlichkeit, dass Sie die **Insert** -Anweisung mit einem Semikolon beenden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-359">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="c0bad-360">Konfigurieren Sie die **insertProduct** -Methode, und stellen Sie sicher, dass Sie über ein Semikolon mit den Anweisungen **Insert** und **Select** verfügen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-360">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="c0bad-361">Standardmäßig geben Insert-Methoden nicht-Abfrage Methoden aus, was bedeutet, dass Sie die Anzahl der betroffenen Zeilen zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="c0bad-362">Wir möchten jedoch, dass die **insertProduct** -Methode den von der Abfrage zurückgegebenen Wert zurückgibt, nicht die Anzahl der betroffenen Zeilen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-362">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="c0bad-363">Um dies zu erreichen, passen Sie die **executemode** -Eigenschaft der **insertProduct** -Methode auf **Scalar**an.</span><span class="sxs-lookup"><span data-stu-id="c0bad-363">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>

<span data-ttu-id="c0bad-364">[![die executemode-Eigenschaft in Skalar ändern](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="c0bad-365">**Abbildung 28**: Ändern der **executemode** -Eigenschaft in **Skalar** ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-365">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>

<span data-ttu-id="c0bad-366">Der folgende Code zeigt diese neue **insertProduct** -Methode in Aktion:</span><span class="sxs-lookup"><span data-stu-id="c0bad-366">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="c0bad-367">Schritt 5: Abschließen der Datenzugriffs Ebene</span><span class="sxs-lookup"><span data-stu-id="c0bad-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="c0bad-368">Beachten Sie, dass die **productstableadapters** -Klasse den **CategoryID** -Wert und den **SupplierID-** Wert aus der **Products** -Tabelle zurückgibt, jedoch nicht die **CategoryName** -Spalte aus der **Categories** -Tabelle oder die **CompanyName** -Spalte aus der **Suppliers** -Tabelle, obwohl dies wahrscheinlich die Spalten ist, die beim Anzeigen von Produktinformationen angezeigt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-368">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="c0bad-369">Wir können die anfängliche Methode " **GetProducts ()** " von TableAdapter erweitern, um die Spaltenwerte " **CategoryName** " und " **CompanyName** " einzuschließen. Dadurch wird die stark typisierte Datentabelle so aktualisiert, dass auch diese neuen Spalten enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="c0bad-369">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="c0bad-370">Dies kann jedoch ein Problem darstellen, da die Methoden des TableAdapter zum Einfügen, aktualisieren und Löschen von Daten auf dieser anfänglichen Methode basieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="c0bad-371">Glücklicherweise sind die automatisch generierten Methoden zum Einfügen, aktualisieren und Löschen von Unterabfragen in der **Select** -Klausel nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="c0bad-372">Wenn Sie die Abfragen in **Kategorien** und **Lieferanten** als Unterabfragen und nicht als **Join** hinzufügen, müssen wir diese Methoden zum Ändern von Daten nicht mehr bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-372">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="c0bad-373">Klicken Sie mit der rechten Maustaste auf die **GetProducts ()** -Methode in **ProductsTableAdapter** , und wählen Sie konfigurieren aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-373">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="c0bad-374">Passen Sie dann die **Select** -Klausel so an, dass Sie wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="c0bad-374">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]

<span data-ttu-id="c0bad-375">[![aktualisieren Sie die SELECT-Anweisung für die GetProducts ()-Methode.](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="c0bad-376">**Abbildung 29**: Aktualisieren der **Select** -Anweisung für die **GetProducts ()** -Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-376">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>

<span data-ttu-id="c0bad-377">Nachdem Sie die **GetProducts ()** -Methode aktualisiert haben, um diese neue Abfrage zu verwenden, enthält die Datentabelle zwei neue Spalten: **CategoryName** und **suppliername**.</span><span class="sxs-lookup"><span data-stu-id="c0bad-377">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>

![Die Datentabelle "Products" hat zwei neue Spalten.](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="c0bad-379">**Abbildung 30**: die Datentabelle " **Products** " hat zwei neue Spalten</span><span class="sxs-lookup"><span data-stu-id="c0bad-379">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>

<span data-ttu-id="c0bad-380">Nehmen Sie sich einen Moment Zeit, um die **Select** -Klausel in der **getproduczbycategoryid-Methode (*CategoryID*)** zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-380">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="c0bad-381">Wenn Sie die **GetProducts ()** **Select** -Anweisung mithilfe der **joinsyntax aktualisieren** , kann der DataSet-Designer die Methoden zum Einfügen, aktualisieren und Löschen von Datenbankdaten mit dem direkten DB-Muster nicht automatisch generieren.</span><span class="sxs-lookup"><span data-stu-id="c0bad-381">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="c0bad-382">Stattdessen müssen Sie diese manuell erstellen, ähnlich wie bei der **insertProduct** -Methode weiter oben in diesem Tutorial.</span><span class="sxs-lookup"><span data-stu-id="c0bad-382">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="c0bad-383">Außerdem müssen Sie die Eigenschaftswerte **InsertCommand**, **UpdateCommand**und **DeleteCommand** manuell angeben, wenn Sie das Batch Aktualisierungs Muster verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-383">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="c0bad-384">Hinzufügen der verbleibenden TableAdapters</span><span class="sxs-lookup"><span data-stu-id="c0bad-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="c0bad-385">Bis jetzt haben wir uns nur mit einem einzigen TableAdapter für eine einzelne Datenbanktabelle beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="c0bad-386">Die Datenbank Northwind enthält jedoch mehrere verknüpfte Tabellen, mit denen wir in unserer Webanwendung zusammenarbeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="c0bad-387">Ein typisiertes DataSet kann mehrere verknüpfte DataTables enthalten.</span><span class="sxs-lookup"><span data-stu-id="c0bad-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="c0bad-388">Um unsere dal abzuschließen, müssen wir daher DataTables für die anderen Tabellen hinzufügen, die wir in diesen Tutorials verwenden werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="c0bad-389">Öffnen Sie zum Hinzufügen eines neuen TableAdapter zu einem typisierten Dataset den DataSet-Designer, klicken Sie mit der rechten Maustaste in den Designer, und wählen Sie hinzufügen/TableAdapter aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="c0bad-390">Dadurch wird eine neue Datentabelle und ein neuer TableAdapter erstellt, und Sie werden durch den Assistenten geführt, den wir zuvor in diesem Tutorial untersucht haben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="c0bad-391">Nehmen Sie sich einige Minuten Zeit, um die folgenden TableAdapters und Methoden mithilfe der folgenden Abfragen zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="c0bad-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="c0bad-392">Beachten Sie, dass die Abfragen im **ProductsTableAdapter** die Unterabfragen enthalten, um die Kategorie-und Lieferanten Namen der einzelnen Produkte zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-392">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="c0bad-393">Außerdem haben Sie, wenn Sie es bereits getan haben, bereits die Methoden **GetProducts ()** und **getproductbycategoryid (*CategoryID*)** der **ProductsTableAdapter** -Klasse hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-393">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="c0bad-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="c0bad-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="c0bad-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
  - <span data-ttu-id="c0bad-396">**Getproductenbycategoryid**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
  - <span data-ttu-id="c0bad-397">**Getproducandbysupplierid**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
  - <span data-ttu-id="c0bad-398">**Getproductbyproductid**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="c0bad-399">**Categoriestableadapter**</span><span class="sxs-lookup"><span data-stu-id="c0bad-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="c0bad-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
  - <span data-ttu-id="c0bad-401">**Getcategorybycategoryid**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="c0bad-402">**Supplierstableadapter**</span><span class="sxs-lookup"><span data-stu-id="c0bad-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="c0bad-403">**Getsuppliers**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
  - <span data-ttu-id="c0bad-404">**Getsuppliersbycountry**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
  - <span data-ttu-id="c0bad-405">**Getsupplierbysupplierid**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="c0bad-406">**Mitarbeiter Adapter**</span><span class="sxs-lookup"><span data-stu-id="c0bad-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="c0bad-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
  - <span data-ttu-id="c0bad-408">**Getemployeesbymanager**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
  - <span data-ttu-id="c0bad-409">**Getemployeebymitarbeiter Eid**:</span><span class="sxs-lookup"><span data-stu-id="c0bad-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]

<span data-ttu-id="c0bad-410">[![Sie den DataSet-Designer, nachdem die vier TableAdapter hinzugefügt wurden.](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="c0bad-411">**Abbildung 31**: der DataSet-Designer nach dem Hinzufügen der vier TableAdapters ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>

## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="c0bad-412">Hinzufügen von benutzerdefiniertem Code zur Dal</span><span class="sxs-lookup"><span data-stu-id="c0bad-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="c0bad-413">Die dem typisierten DataSet hinzugefügten TableAdapters und DataTables werden als XML-Schema Definitionsdatei (**Northwind. xsd**) ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="c0bad-414">Sie können diese Schema Informationen anzeigen, indem Sie in der Projektmappen-Explorer mit der rechten Maustaste auf die Datei **Northwind. xsd** klicken und Code anzeigen auswählen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-414">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>

<span data-ttu-id="c0bad-415">[![Sie die XSD-Datei (XML Schema Definition) für das typisierte Northwinds-DataSet.](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="c0bad-416">**Abbildung 32**: die XSD-Datei (XML Schema Definition) für das typisierte Northwinds-DataSet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>

<span data-ttu-id="c0bad-417">Diese Schema Informationen werden zur Entwurfs C# Zeit in oder Visual Basic Code übersetzt (falls erforderlich). an diesem Punkt können Sie Sie mit dem Debugger schrittweise durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="c0bad-418">Um diesen automatisch generierten Code anzuzeigen, wechseln Sie zum Klassenansicht, und führen Sie einen Drilldown zu den TableAdapter-oder typisierten DataSet-Klassen aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="c0bad-419">Wenn die Klassenansicht auf dem Bildschirm nicht angezeigt wird, klicken Sie auf das Menü Ansicht, und wählen Sie es aus, oder drücken Sie STRG + UMSCHALT + C.</span><span class="sxs-lookup"><span data-stu-id="c0bad-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="c0bad-420">Im Klassenansicht werden die Eigenschaften, Methoden und Ereignisse der typisierten DataSet-und TableAdapter-Klassen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="c0bad-421">Wenn Sie den Code für eine bestimmte Methode anzeigen möchten, doppelklicken Sie in der Klassenansicht auf den Methodennamen, oder klicken Sie mit der rechten Maustaste darauf, und wählen Sie Gehe zu Definition aus.</span><span class="sxs-lookup"><span data-stu-id="c0bad-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>

![Überprüfen Sie den automatisch generierten Code, indem Sie im Klassenansicht die Option Gehe zu Definition auswählen.](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="c0bad-423">**Abbildung 33**: Überprüfen Sie den automatisch generierten Code, indem Sie in der Klassenansicht die Option Gehe zu Definition auswählen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>

<span data-ttu-id="c0bad-424">Obwohl automatisch generierter Code sehr viel Zeit sparen kann, ist der Code oft sehr generisch und muss angepasst werden, um die besonderen Anforderungen einer Anwendung zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="c0bad-425">Das Risiko der Erweiterung von automatisch generiertem Code besteht jedoch darin, dass das Tool, das den Code generiert hat, möglicherweise die Zeit zum erneuten generieren und überschreiben Ihrer Anpassungen feststellt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="c0bad-426">Mit dem neuen partiellen Klassenkonzept von .NET 2.0 ist es einfach, eine Klasse auf mehrere Dateien aufzuteilen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="c0bad-427">Dadurch können wir unsere eigenen Methoden, Eigenschaften und Ereignisse zu den automatisch generierten Klassen hinzufügen, ohne sich über Visual Studio Gedanken machen zu müssen, um die Anpassungen zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="c0bad-428">Um die Anpassung der dal zu veranschaulichen, fügen wir der **suppliersrow** -Klasse eine **GetProducts ()** -Methode hinzu.</span><span class="sxs-lookup"><span data-stu-id="c0bad-428">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="c0bad-429">Die **suppliersrow** -Klasse stellt einen einzelnen Datensatz in der **Suppliers** -Tabelle dar. Jeder Lieferant kann eine beliebige Anzahl von Produkten als Anbieter angeben, sodass **GetProducts ()** diese Produkte des angegebenen Lieferanten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c0bad-429">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="c0bad-430">Um dies zu erreichen, erstellen Sie eine neue Klassendatei in der **App\_dem Code** Ordner mit dem Namen **SuppliersRow.cs** , und fügen Sie folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="c0bad-430">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="c0bad-431">Diese partielle Klasse weist den Compiler an, dass bei der Erstellung der **Northwind. suppliersrow** -Klasse, um die soeben definierte **GetProducts ()** -Methode einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-431">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="c0bad-432">Wenn Sie das Projekt erstellen und dann zum Klassenansicht zurückkehren, sehen Sie, dass " **GetProducts ()** " nun als Methode von " **Northwind. suppliersrow**" aufgeführt ist.</span><span class="sxs-lookup"><span data-stu-id="c0bad-432">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>

![Die GetProducts ()-Methode ist jetzt Teil der Northwind. suppliersrow-Klasse.](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="c0bad-434">**Abbildung 34**: die **GetProducts ()** -Methode ist nun Bestandteil der **Northwind. suppliersrow** -Klasse.</span><span class="sxs-lookup"><span data-stu-id="c0bad-434">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>

<span data-ttu-id="c0bad-435">Die **GetProducts ()** -Methode kann jetzt verwendet werden, um die Produktgruppe für einen bestimmten Lieferanten aufzulisten, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="c0bad-435">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="c0bad-436">Diese Daten können auch in einem beliebigen ASP angezeigt werden. Daten-websteuer Elemente des Netzes.</span><span class="sxs-lookup"><span data-stu-id="c0bad-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="c0bad-437">Auf der folgenden Seite wird ein GridView-Steuerelement mit zwei Feldern verwendet:</span><span class="sxs-lookup"><span data-stu-id="c0bad-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="c0bad-438">Ein BoundField, das den Namen der einzelnen Lieferanten anzeigt, und</span><span class="sxs-lookup"><span data-stu-id="c0bad-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="c0bad-439">Ein TemplateField-Steuerelement, das ein BulletedList-Steuerelement enthält, das an die von der **GetProducts ()** -Methode für jeden Lieferanten zurückgegebenen Ergebnisse gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="c0bad-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="c0bad-440">Wir untersuchen, wie solche Master/Detail-Berichte in zukünftigen Tutorials angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="c0bad-441">In diesem Beispiel soll die Verwendung der benutzerdefinierten Methode veranschaulicht werden, die der **Northwind. suppliersrow** -Klasse hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="c0bad-441">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="c0bad-442">Suppliersandproducts. aspx</span><span class="sxs-lookup"><span data-stu-id="c0bad-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="c0bad-443">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="c0bad-443">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]

<span data-ttu-id="c0bad-444">[![der Unternehmens Name des Lieferanten in der linken Spalte aufgeführt ist, werden die Produkte auf der rechten Seite angezeigt.](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="c0bad-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="c0bad-445">**Abbildung 35**: der Unternehmens Name des Lieferanten ist in der linken Spalte aufgeführt, ihre Produkte auf der rechten Seite ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="c0bad-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>

## <a name="summary"></a><span data-ttu-id="c0bad-446">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="c0bad-446">Summary</span></span>

<span data-ttu-id="c0bad-447">Wenn Sie eine Webanwendung erstellen, sollte die DAL einer der ersten Schritte sein, bevor Sie mit dem Erstellen der Präsentationsschicht beginnen.</span><span class="sxs-lookup"><span data-stu-id="c0bad-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="c0bad-448">Mit Visual Studio ist das Erstellen einer dal basierend auf typisierten Datasets eine Aufgabe, die innerhalb von 10-15 Minuten durchgeführt werden kann, ohne eine Codezeile zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="c0bad-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="c0bad-449">Die Lernprogramme, die sich weiterentwickeln, basieren auf dieser dal.</span><span class="sxs-lookup"><span data-stu-id="c0bad-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="c0bad-450">Im [nächsten Tutorial](creating-a-business-logic-layer-cs.md) definieren wir eine Reihe von Geschäftsregeln und sehen, wie Sie in einer separaten Geschäftslogik Schicht implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="c0bad-450">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="c0bad-451">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="c0bad-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="c0bad-452">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="c0bad-452">Further Reading</span></span>

<span data-ttu-id="c0bad-453">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="c0bad-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="c0bad-454">Aufbauen einer dal mit stark typisierten TableAdapters und DataTables in VS 2005 und ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="c0bad-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="c0bad-455">Entwerfen von Datenebenenkomponenten und übergeben von Daten über Ebenen</span><span class="sxs-lookup"><span data-stu-id="c0bad-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="c0bad-456">Erstellen einer Datenzugriffs Ebene mit dem DataSet-Designer von Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="c0bad-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="c0bad-457">Verschlüsseln von Konfigurationsinformationen in ASP.NET 2,0-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="c0bad-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="c0bad-458">Übersicht über TableAdapters</span><span class="sxs-lookup"><span data-stu-id="c0bad-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="c0bad-459">Arbeiten mit einem typisierten DataSet</span><span class="sxs-lookup"><span data-stu-id="c0bad-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="c0bad-460">Verwenden von stark typisiertem Datenzugriff in Visual Studio 2005 und ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="c0bad-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="c0bad-461">Erweitern von TableAdapter-Methoden</span><span class="sxs-lookup"><span data-stu-id="c0bad-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="c0bad-462">Abrufen von skalaren Daten aus einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="c0bad-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="c0bad-463">Video Schulung zu Themen in diesem Tutorial</span><span class="sxs-lookup"><span data-stu-id="c0bad-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="c0bad-464">Datenzugriffsschichten in ASP.NET-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="c0bad-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="c0bad-465">Manuelles Binden eines Datasets an ein DataGrid</span><span class="sxs-lookup"><span data-stu-id="c0bad-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="c0bad-466">Arbeiten mit Datasets und Filtern aus einer ASP-Anwendung</span><span class="sxs-lookup"><span data-stu-id="c0bad-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="c0bad-467">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="c0bad-467">About the Author</span></span>

<span data-ttu-id="c0bad-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="c0bad-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c0bad-469">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="c0bad-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c0bad-470">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c0bad-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c0bad-471">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c0bad-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c0bad-472">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c0bad-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c0bad-473">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="c0bad-473">Special Thanks To</span></span>

<span data-ttu-id="c0bad-474">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="c0bad-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c0bad-475">Die führenden Reviewer für dieses Tutorial waren Ron grün, Hilton Giesenow, Dennis Patterson, Liz shulok, Abel Gomez und Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="c0bad-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="c0bad-476">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="c0bad-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c0bad-477">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c0bad-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c0bad-478">Nächste</span><span class="sxs-lookup"><span data-stu-id="c0bad-478">Next</span></span>](creating-a-business-logic-layer-cs.md)
