---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: Erstellen einer benutzerdefinierten Sortierungs Benutzeroberfläche (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Beim Anzeigen einer langen Liste sortierter Daten kann es sehr hilfreich sein, verwandte Daten durch die Einführung von Trennzeichen zu gruppieren. In diesem Tutorial erfahren Sie, wie Sie CRE...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 66127630560141cd795beb15f525a7fba85f3993
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74607368"
---
# <a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="2e08d-104">Erstellen einer angepassten Benutzeroberfläche zum Sortieren (VB)</span><span class="sxs-lookup"><span data-stu-id="2e08d-104">Creating a Customized Sorting User Interface (VB)</span></span>

<span data-ttu-id="2e08d-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2e08d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2e08d-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) oder [PDF herunterladen](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2e08d-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="2e08d-107">Beim Anzeigen einer langen Liste sortierter Daten kann es sehr hilfreich sein, verwandte Daten durch die Einführung von Trennzeichen zu gruppieren.</span><span class="sxs-lookup"><span data-stu-id="2e08d-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="2e08d-108">In diesem Tutorial erfahren Sie, wie Sie eine solche sortierende Benutzeroberfläche erstellen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="2e08d-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="2e08d-109">Introduction</span></span>

<span data-ttu-id="2e08d-110">Beim Anzeigen einer langen Liste von sortierten Daten, bei denen es nur wenige unterschiedliche Werte in der sortierten Spalte gibt, kann ein Endbenutzer feststellen, wo genau die Differenz Grenzen eintreten.</span><span class="sxs-lookup"><span data-stu-id="2e08d-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="2e08d-111">Beispielsweise gibt es 81 Produkte in der-Datenbank, aber nur neun verschiedene Kategorieoptionen (acht eindeutige Kategorien plus die `NULL`-Option).</span><span class="sxs-lookup"><span data-stu-id="2e08d-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="2e08d-112">Betrachten Sie den Fall eines Benutzers, der an der Untersuchung der Produkte interessiert ist, die in der Kategorie "Seafood" liegen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="2e08d-113">Auf einer Seite, auf der *alle* Produkte in einer einzelnen GridView aufgelistet sind, kann der Benutzer entscheiden, ob die Ergebnisse nach Kategorie sortiert werden sollen, in der alle Produkte der Benutzer Produkte gruppiert werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="2e08d-114">Nach der Sortierung nach Kategorie muss der Benutzer dann die Liste durchsuchen, um zu suchen, wo die in der Benutzerliste gruppierten Produkte beginnen und enden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="2e08d-115">Da die Ergebnisse alphabetisch nach dem Kategorienamen sortiert werden, ist die Suche nach den Produkten der-Produkte nicht schwierig, erfordert aber trotzdem eine genaue Überprüfung der Liste der Elemente im Raster.</span><span class="sxs-lookup"><span data-stu-id="2e08d-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="2e08d-116">Um die Grenzen zwischen sortierten Gruppen hervorzuheben, verwenden viele Websites eine Benutzeroberfläche, die ein Trennzeichen zwischen diesen Gruppen hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="2e08d-117">Mithilfe von Trennzeichen wie den in Abbildung 1 gezeigten können Benutzer eine bestimmte Gruppe schneller finden und ihre Grenzen identifizieren und ermitteln, welche unterschiedlichen Gruppen in den Daten vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="2e08d-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>

<span data-ttu-id="2e08d-118">[![werden alle Kategoriegruppen eindeutig identifiziert.](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2e08d-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="2e08d-119">**Abbildung 1**: jede Kategoriegruppe ist eindeutig identifiziert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2e08d-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>

<span data-ttu-id="2e08d-120">In diesem Tutorial erfahren Sie, wie Sie eine solche sortierende Benutzeroberfläche erstellen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="2e08d-121">Schritt 1: Erstellen eines Standard mäßigen, sortierbaren GridView-Sicht</span><span class="sxs-lookup"><span data-stu-id="2e08d-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="2e08d-122">Bevor wir untersuchen, wie die GridView erweitert wird, um die erweiterte Sortier Schnittstelle bereitzustellen, können Sie zuerst eine standardmäßige, sortierbare GridView erstellen, die die Produkte auflistet.</span><span class="sxs-lookup"><span data-stu-id="2e08d-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="2e08d-123">Öffnen Sie zunächst die Seite `CustomSortingUI.aspx` im Ordner `PagingAndSorting`.</span><span class="sxs-lookup"><span data-stu-id="2e08d-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="2e08d-124">Fügen Sie der Seite eine GridView hinzu, legen Sie die `ID`-Eigenschaft auf `ProductList`fest, und binden Sie Sie an eine neue ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2e08d-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="2e08d-125">Konfigurieren Sie ObjectDataSource so, dass die `ProductsBLL` Klasse s `GetProducts()` Methode zum Auswählen von Datensätzen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="2e08d-126">Als Nächstes konfigurieren Sie die GridView so, dass Sie nur die `ProductName`, `CategoryName`, `SupplierName`und `UnitPrice` boundfields und das nicht mehr unterstützte CheckBoxField enthält.</span><span class="sxs-lookup"><span data-stu-id="2e08d-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="2e08d-127">Konfigurieren Sie abschließend die GridView, um die Sortierung zu unterstützen, indem Sie das Kontrollkästchen Sortierung aktivieren im GridView-Smarttag aktivieren (oder indem Sie die `AllowSorting`-Eigenschaft auf `true`festlegen).</span><span class="sxs-lookup"><span data-stu-id="2e08d-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="2e08d-128">Nachdem Sie diese Ergänzungen auf der Seite `CustomSortingUI.aspx` vorgenommen haben, sollte das deklarative Markup in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="2e08d-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="2e08d-129">Nehmen Sie sich einen Moment Zeit, um den Fortschritt in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="2e08d-130">Abbildung 2 zeigt die sortierbare GridView, wenn Ihre Daten nach Kategorie in alphabetischer Reihenfolge sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>

<span data-ttu-id="2e08d-131">[![die sortierbaren GridView s-Daten nach Kategorie sortiert](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2e08d-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="2e08d-132">**Abbildung 2**: die sortierbaren GridView s-Daten werden nach Kategorie sortiert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2e08d-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>

## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="2e08d-133">Schritt 2: Untersuchen von Verfahren zum Hinzufügen der Trenn Zeilen</span><span class="sxs-lookup"><span data-stu-id="2e08d-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="2e08d-134">Wenn die generische, sortierbare GridView vollständig ist, muss nur noch die Trenn Zeilen in der GridView vor jeder eindeutigen sortierten Gruppe hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="2e08d-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="2e08d-135">Aber wie können solche Zeilen in die GridView-Struktur eingefügt werden?</span><span class="sxs-lookup"><span data-stu-id="2e08d-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="2e08d-136">Im Wesentlichen müssen die GridView s-Zeilen durchlaufen werden, und es wird festgelegt, wo die Unterschiede zwischen den Werten in der sortierten Spalte auftreten, und anschließend wird die entsprechende Trennlinie hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="2e08d-137">Wenn Sie dieses Problem betrachten, scheint es natürlich, dass die Projekt Mappe irgendwo im `RowDataBound` Ereignishandler von GridView s liegt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="2e08d-138">Wie im Tutorial " [benutzerdefinierte Formatierung basierend auf Daten](../custom-formatting/custom-formatting-based-upon-data-vb.md) " erläutert, wird dieser Ereignishandler häufig verwendet, wenn die Formatierung auf Zeilenebene auf Grundlage der Daten der Zeile angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="2e08d-139">Der `RowDataBound` Ereignishandler ist hier jedoch nicht die Projekt Mappe, da Zeilen von diesem Ereignishandler nicht Programm gesteuert zur GridView hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="2e08d-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="2e08d-140">Die GridView s-`Rows` Sammlung ist tatsächlich schreibgeschützt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="2e08d-141">Wenn Sie der GridView zusätzliche Zeilen hinzufügen möchten, stehen Ihnen drei Optionen zur Auswahl:</span><span class="sxs-lookup"><span data-stu-id="2e08d-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="2e08d-142">Fügen Sie diese metadatentrennzeilen den eigentlichen Daten hinzu, die an die GridView gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="2e08d-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="2e08d-143">Nachdem die GridView an die Daten gebunden wurde, fügen Sie der GridView s-Steuerelement Sammlung zusätzliche `TableRow` Instanzen hinzu.</span><span class="sxs-lookup"><span data-stu-id="2e08d-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="2e08d-144">Erstellen Sie ein benutzerdefiniertes Server Steuerelement, das das GridView-Steuerelement erweitert und die Methoden überschreibt, die für das Erstellen der GridView-Struktur</span><span class="sxs-lookup"><span data-stu-id="2e08d-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="2e08d-145">Das Erstellen eines benutzerdefinierten Server Steuer Elements ist der beste Ansatz, wenn diese Funktionalität auf vielen Webseiten oder über mehrere Websites benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="2e08d-146">Es würde jedoch etwas Code und eine gründliche Untersuchung in die Tiefe der internen GridView s-Funktionen umfassen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="2e08d-147">Daher wird diese Option für dieses Tutorial nicht berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="2e08d-148">Die anderen beiden Optionen fügen Trenn Zeilen zu den eigentlichen Daten hinzu, die an die GridView gebunden werden, und zum Bearbeiten der GridView s-Steuerelement Auflistung nach dem gebundenen Angriff auf das Problem und eine Erörterung.</span><span class="sxs-lookup"><span data-stu-id="2e08d-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="2e08d-149">Hinzufügen von Zeilen zu den Daten, die an die GridView gebunden sind</span><span class="sxs-lookup"><span data-stu-id="2e08d-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="2e08d-150">Wenn die GridView an eine Datenquelle gebunden ist, erstellt Sie eine `GridViewRow` für jeden Datensatz, der von der Datenquelle zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="2e08d-151">Aus diesem Grund können wir die erforderlichen Trenn Zeilen einfügen, indem Sie der Datenquelle Trennzeichen Sätze hinzufügen, bevor Sie an die GridView gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="2e08d-152">In Abbildung 3 wird dieses Konzept veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="2e08d-152">Figure 3 illustrates this concept.</span></span>

![Eine Technik umfasst das Hinzufügen von Trenn Zeilen zur Datenquelle.](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="2e08d-154">**Abbildung 3**: eine Technik umfasst das Hinzufügen von Trenn Zeilen zur Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="2e08d-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>

<span data-ttu-id="2e08d-155">Ich verwende den Begriff Trennzeichen Sätze in Anführungszeichen, weil kein spezieller Trennzeichen Daten Satz vorhanden ist. Stattdessen müssen wir auf irgendeine Weise darauf achten, dass ein bestimmter Datensatz in der Datenquelle als Trennzeichen und nicht als normale Daten Zeile fungiert.</span><span class="sxs-lookup"><span data-stu-id="2e08d-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="2e08d-156">In unseren Beispielen wird eine `ProductsDataTable` Instanz erneut an die GridView-Instanz gebunden, die aus `ProductRows`besteht.</span><span class="sxs-lookup"><span data-stu-id="2e08d-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="2e08d-157">Wir könnten einen Datensatz als Trennlinie markieren, indem wir dessen `CategoryID`-Eigenschaft auf `-1` festlegen (da ein solcher Wert nicht normal vorhanden sein konnte).</span><span class="sxs-lookup"><span data-stu-id="2e08d-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="2e08d-158">Um dieses Verfahren zu verwenden, müssen wir die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="2e08d-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="2e08d-159">Programm gesteuertes Abrufen der Daten für die Bindung an die GridView-Instanz (eine `ProductsDataTable` Instanz)</span><span class="sxs-lookup"><span data-stu-id="2e08d-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="2e08d-160">Sortieren der Daten auf der Grundlage der Eigenschaften von GridView s `SortExpression` und `SortDirection`</span><span class="sxs-lookup"><span data-stu-id="2e08d-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="2e08d-161">Durchlaufen Sie die `ProductsRows` im `ProductsDataTable`, und suchen Sie nach dem Ort, an dem die Unterschiede in der sortierten Spalte liegen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="2e08d-162">Fügen Sie an jeder Gruppen Grenze einen Trennzeichen Daten Satz `ProductsRow`-Instanz in die Datentabelle ein, bei der es sich um einen `CategoryID` auf `-1` festgelegt hat</span><span class="sxs-lookup"><span data-stu-id="2e08d-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="2e08d-163">Binden Sie die Daten nach dem Einfügen der Trenn Zeilen Programm gesteuert an die GridView.</span><span class="sxs-lookup"><span data-stu-id="2e08d-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="2e08d-164">Zusätzlich zu diesen fünf Schritten muss auch ein Ereignishandler für das GridView s `RowDataBound`-Ereignis bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="2e08d-165">An dieser Stelle werden alle `DataRow` überprüft und ermittelt, ob es sich um eine Trennlinie handelt, deren `CategoryID` Einstellung `-1`wurde.</span><span class="sxs-lookup"><span data-stu-id="2e08d-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="2e08d-166">Wenn dies der Fall ist, möchten wir wahrscheinlich die Formatierung oder den Text anpassen, der in den Zellen angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="2e08d-167">Die Verwendung dieser Technik zum Einfügen der Sortierungs Gruppen Grenzen erfordert etwas mehr Arbeit als oben beschrieben, da Sie auch einen Ereignishandler für das GridView s `Sorting`-Ereignis bereitstellen und die `SortExpression`-und `SortDirection`-Werte nachverfolgen müssen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="2e08d-168">Bearbeiten der GridView s-Steuerelement Sammlung, nachdem Sie Daten gebunden war</span><span class="sxs-lookup"><span data-stu-id="2e08d-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="2e08d-169">Anstatt die Daten vor der Bindung an die GridView zu überprüfen, können wir die Trennzeichen Zeilen hinzufügen, *nachdem* die Daten an die GridView gebunden wurden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="2e08d-170">Der Prozess der Datenbindung erstellt die GridView s-Steuerelement Hierarchie, bei der es sich in Wirklichkeit einfach um eine `Table` Instanz handelt, die aus einer Auflistung von Zeilen besteht, von denen jede aus einer Auflistung von Zellen besteht.</span><span class="sxs-lookup"><span data-stu-id="2e08d-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="2e08d-171">Die GridView s-Steuerelement Auflistung enthält insbesondere ein `Table` Objekt im Stammverzeichnis, ein `GridViewRow` (das von der `TableRow`-Klasse abgeleitet wird) für jeden Datensatz in der `DataSource`, der an die GridView gebunden ist, und ein `TableCell` Objekt in jeder `GridViewRow` Instanz für jedes Datenfeld in der `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="2e08d-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="2e08d-172">Um zwischen den einzelnen Sortiergruppen Trenn Zeilen hinzuzufügen, können wir diese Steuerelement Hierarchie nach der Erstellung direkt bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="2e08d-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="2e08d-173">Wir können sicher sein, dass die GridView s-Steuerelement Hierarchie zum letzten Mal erstellt wurde, bis die Seite gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="2e08d-174">Daher überschreibt dieser Ansatz die `Page` Class s `Render`-Methode. zu diesem Zeitpunkt wird die endgültige Steuerelement Hierarchie der GridView s so aktualisiert, dass die erforderlichen Trenn Zeilen enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="2e08d-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="2e08d-175">Dieses Verfahren wird in Abbildung 4 veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="2e08d-175">Figure 4 illustrates this process.</span></span>

<span data-ttu-id="2e08d-176">[![eine Alternative Technik die GridView s-Steuerelement Hierarchie manipuliert](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="2e08d-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="2e08d-177">**Abbildung 4**: eine Alternative Technik bearbeitet die GridView s-Steuerelement Hierarchie ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="2e08d-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>

<span data-ttu-id="2e08d-178">In diesem Tutorial verwenden wir diesen letzteren Ansatz, um die Sortierfunktion für Benutzer anzupassen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="2e08d-179">Der Code, den Sie in diesem Tutorial vorstellen, basiert auf dem Beispiel im Blogeintrag [Teemu-Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s, das [etwas mit der GridView-Sortier Gruppierung spielt](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span><span class="sxs-lookup"><span data-stu-id="2e08d-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>

## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="2e08d-180">Schritt 3: Hinzufügen der Trenn Zeilen zur GridView s-Steuerelement Hierarchie</span><span class="sxs-lookup"><span data-stu-id="2e08d-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="2e08d-181">Da wir nur die Trenn Zeilen der GridView s-Steuerelement Hierarchie hinzufügen möchten, nachdem die Steuerelement Hierarchie erstellt und zum letzten Mal auf dieser Seite erstellt wurde, möchten wir diese Addition am Ende des Lebenszyklus der Seite, aber vor der tatsächlichen GridView c- die Benutzerkontensteuerung-Hierarchie wurde in HTML gerendert.</span><span class="sxs-lookup"><span data-stu-id="2e08d-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="2e08d-182">Der letzte mögliche Punkt, an dem dies erreicht werden kann, ist das `Page` Class-`Render` Ereignis, das wir in unserer Code-Behind-Klasse mithilfe der folgenden Methoden Signatur überschreiben können:</span><span class="sxs-lookup"><span data-stu-id="2e08d-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="2e08d-183">Wenn die ursprüngliche `Render`-Methode der `Page` Klasse aufgerufen wird `base.Render(writer)` werden alle Steuerelemente auf der Seite gerendert, wodurch das Markup basierend auf Ihrer Steuerelement Hierarchie erzeugt wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="2e08d-184">Daher ist es zwingend erforderlich, dass wir `base.Render(writer)`aufrufen, sodass die Seite gerendert wird, und dass wir die Hierarchie der GridView s-Steuerelemente vor dem Aufrufen von `base.Render(writer)`bearbeiten, sodass die Trennzeichen Zeilen der GridView s-Steuerelement Hierarchie hinzugefügt wurden, bevor Sie gerendert wurden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="2e08d-185">Um die Sortierungs Gruppen Header einzufügen, müssen Sie zuerst sicherstellen, dass der Benutzer die Sortierung der Daten angefordert hat.</span><span class="sxs-lookup"><span data-stu-id="2e08d-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="2e08d-186">Standardmäßig sind die Inhalte der GridView-Inhalte nicht sortiert, daher müssen wir keine Gruppen Sortierungs Header eingeben.</span><span class="sxs-lookup"><span data-stu-id="2e08d-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="2e08d-187">Wenn die GridView nach einer bestimmten Spalte sortiert werden soll, wenn die Seite zum ersten Mal geladen wird, rufen Sie die GridView s `Sort`-Methode auf dem ersten Seitenbesuch auf (aber nicht bei nachfolgenden Postbacks).</span><span class="sxs-lookup"><span data-stu-id="2e08d-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="2e08d-188">Fügen Sie zu diesem Zweck diesen-Befehl im `Page_Load`-Ereignishandler innerhalb einer `if (!Page.IsPostBack)` bedingten ein.</span><span class="sxs-lookup"><span data-stu-id="2e08d-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="2e08d-189">Weitere Informationen zur `Sort`-Methode finden Sie im Tutorial zum [Paging und zum Sortieren von Berichtsdaten](paging-and-sorting-report-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="2e08d-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>

<span data-ttu-id="2e08d-190">Wenn Sie davon ausgehen, dass die Daten sortiert wurden, besteht die nächste Aufgabe darin, zu bestimmen, nach welcher Spalte die Daten sortiert wurden, und dann die Zeilen zu scannen, die auf Unterschiede in diesen Spaltenwerten suchen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="2e08d-191">Der folgende Code stellt sicher, dass die Daten sortiert wurden, und sucht die Spalte, nach der die Daten sortiert wurden:</span><span class="sxs-lookup"><span data-stu-id="2e08d-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="2e08d-192">Wenn das GridView-Objekt noch sortiert werden kann, wurde die GridView s-`SortExpression`-Eigenschaft nicht festgelegt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="2e08d-193">Daher möchten wir nur die Trennzeichen Zeilen hinzufügen, wenn diese Eigenschaft einen Wert aufweist.</span><span class="sxs-lookup"><span data-stu-id="2e08d-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="2e08d-194">Wenn dies der Fall ist, müssen wir den Index der Spalte festlegen, nach der die Daten sortiert wurden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="2e08d-195">Dies wird erreicht, indem die GridView s-`Columns` Auflistung durchlaufen wird. dabei wird nach der Spalte gesucht, deren `SortExpression`-Eigenschaft der `SortExpression` Eigenschaft GridView s entspricht.</span><span class="sxs-lookup"><span data-stu-id="2e08d-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="2e08d-196">Zusätzlich zum Spalten Index wird auch die `HeaderText`-Eigenschaft verwendet, die beim Anzeigen der Trennzeichen Zeilen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="2e08d-197">Mit dem Index der Spalte, nach der die Daten sortiert werden, besteht der letzte Schritt darin, die Zeilen der GridView aufzulisten.</span><span class="sxs-lookup"><span data-stu-id="2e08d-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="2e08d-198">Für jede Zeile muss bestimmt werden, ob sich der Wert der sortierten Spalte von dem Wert der Spalte in der vorherigen Zeile in der Spalte unterscheidet.</span><span class="sxs-lookup"><span data-stu-id="2e08d-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="2e08d-199">Wenn dies der Fall ist, müssen wir eine neue `GridViewRow` Instanz in die Steuerelement Hierarchie einfügen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="2e08d-200">Dies wird mit folgendem Code erreicht:</span><span class="sxs-lookup"><span data-stu-id="2e08d-200">This is accomplished with the following code:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="2e08d-201">Dieser Code beginnt mit einem programmgesteuerten Verweis auf das `Table` Objekt, das sich im Stammverzeichnis der GridView s-Steuerelement Hierarchie befindet, und erstellt eine Zeichen folgen Variable mit dem Namen `lastValue`.</span><span class="sxs-lookup"><span data-stu-id="2e08d-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="2e08d-202">`lastValue` wird verwendet, um den Wert der aktuellen Zeilen-sortierten Spalte mit dem Wert der vorherigen Zeile zu vergleichen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="2e08d-203">Als nächstes wird die GridView s-`Rows` Collection aufgelistet, und für jede Zeile wird der Wert der sortierten Spalte in der `currentValue`-Variablen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="2e08d-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="2e08d-204">Um den Wert der sortierten Spalte der Spalte zu bestimmen, verwende ich die Cell s `Text`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="2e08d-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="2e08d-205">Dies funktioniert gut für boundfields, funktioniert jedoch nicht wie gewünscht für templatefields, checkboxfields usw.</span><span class="sxs-lookup"><span data-stu-id="2e08d-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="2e08d-206">Wir sehen uns an, wie Sie die alternativen GridView-Felder in Kürze berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-206">We'll look at how to account for alternate GridView fields shortly.</span></span>

<span data-ttu-id="2e08d-207">Anschließend werden die Variablen `currentValue` und `lastValue` verglichen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="2e08d-208">Wenn Sie sich unterscheiden, müssen wir der Steuerelement Hierarchie eine neue Trenn Zeile hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="2e08d-209">Dies wird erreicht, indem der Index der `GridViewRow` in der `Table`-Objekt-`Rows`-Auflistung ermittelt wird, neue `GridViewRow`-und `TableCell` Instanzen erstellt werden und dann die `TableCell` und `GridViewRow` der Steuerelement Hierarchie hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="2e08d-210">Beachten Sie, dass die einzeilige `TableCell` der Zeilen Trennlinie so formatiert ist, dass Sie die gesamte Breite der GridView umfasst, mit der `SortHeaderRowStyle` CSS-Klasse formatiert wird und die `Text`-Eigenschaft aufweist, sodass Sie sowohl den Namen der Sortier Gruppe (z. b. Kategorie) als auch den Wert der Gruppe (z. b. Getränke) anzeigt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="2e08d-211">Schließlich wird `lastValue` auf den Wert `currentValue`aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="2e08d-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="2e08d-212">Die CSS-Klasse, die zum Formatieren der Kopfzeilen `SortHeaderRowStyle` der Sortier Gruppe verwendet wird, muss in der `Styles.css` Datei angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="2e08d-213">Sie können jederzeit beliebige Stileinstellungen verwenden, Ich habe Folgendes verwendet:</span><span class="sxs-lookup"><span data-stu-id="2e08d-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>

[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="2e08d-214">Mit dem aktuellen Code fügt die Sortierungs Schnittstelle Sortiergruppen Kopfzeilen hinzu, wenn Sie nach beliebigen BoundField sortiert werden (siehe Abbildung 5, das beim Sortieren nach Lieferanten einen Screenshot anzeigt).</span><span class="sxs-lookup"><span data-stu-id="2e08d-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="2e08d-215">Beim Sortieren nach einem beliebigen anderen Feldtyp (z. b. CheckBoxField oder TemplateField) werden die Header der Sortier Gruppe jedoch nicht gefunden (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="2e08d-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>

<span data-ttu-id="2e08d-216">[![die Sortierungs Schnittstelle Sortiergruppen Kopfzeilen beim Sortieren nach boundfields enthält.](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="2e08d-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="2e08d-217">**Abbildung 5**: die Sortierungs Schnittstelle enthält Sortiergruppen Kopfzeilen beim Sortieren nach boundfields ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="2e08d-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>

<span data-ttu-id="2e08d-218">[beim Sortieren eines CheckBoxField fehlen ![die Sortiergruppen Header.](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="2e08d-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="2e08d-219">**Abbildung 6**: die Header der Sortier Gruppe fehlen beim Sortieren eines CheckBoxField ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="2e08d-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>

<span data-ttu-id="2e08d-220">Der Grund für das Sortieren von Sortierungs Gruppen Headern in einem CheckBoxField-Objekt liegt darin, dass der Code derzeit nur die `TableCell` s `Text`-Eigenschaft verwendet, um den Wert der sortierten Spalte für jede Zeile zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="2e08d-221">Bei checkboxfields ist die `TableCell` s `Text`-Eigenschaft eine leere Zeichenfolge. Stattdessen ist der Wert über ein CheckBox-websteuer Element verfügbar, das sich innerhalb der `TableCell` s `Controls` Auflistung befindet.</span><span class="sxs-lookup"><span data-stu-id="2e08d-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="2e08d-222">Um andere Feldtypen als boundfields zu verarbeiten, müssen wir den Code erweitern, in dem die `currentValue` Variable zum Überprüfen des Vorhandenseins eines Kontrollkästchens in der `Controls` Auflistung der `TableCell` s zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="2e08d-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="2e08d-223">Anstatt `currentValue = gvr.Cells(sortColumnIndex).Text`zu verwenden, ersetzen Sie diesen Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="2e08d-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="2e08d-224">Dieser Code untersucht die sortierte Spalte `TableCell` für die aktuelle Zeile, um zu bestimmen, ob in der `Controls` Auflistung Steuerelemente vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="2e08d-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="2e08d-225">Wenn dies der Fall ist und das erste Steuerelement ein Kontrollkästchen ist, wird die `currentValue` Variable abhängig von der Eigenschaft `Checked` Eigenschaft auf Ja oder Nein festgelegt.</span><span class="sxs-lookup"><span data-stu-id="2e08d-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="2e08d-226">Andernfalls wird der Wert aus der `TableCell` s-`Text` Eigenschaft entnommen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="2e08d-227">Diese Logik kann repliziert werden, um die Sortierung für alle templatefields-Felder zu verarbeiten, die in der GridView vorhanden sein können.</span><span class="sxs-lookup"><span data-stu-id="2e08d-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="2e08d-228">Mit dem obigen Code Additions sind die Sortierungs Gruppen Header nun beim Sortieren nach dem nicht mehr unterstützten CheckBoxField vorhanden (siehe Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="2e08d-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>

<span data-ttu-id="2e08d-229">[![die Sortierungs Gruppen Header jetzt beim Sortieren eines CheckBoxField vorhanden sind.](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="2e08d-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="2e08d-230">**Abbildung 7**: die Header der Sortier Gruppe sind nun beim Sortieren eines CheckBoxField vorhanden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="2e08d-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="2e08d-231">Wenn Sie über Produkte mit `NULL` Daten bankwerten für die Felder "`CategoryID`", "`SupplierID`" oder "`UnitPrice`" verfügen, werden diese Werte standardmäßig als leere Zeichen folgen in der GridView angezeigt. Dies bedeutet, dass der Text der Trenn Zeile für diese Produkte mit `NULL` Werten wie die Kategorie lautet: (das heißt, es gibt keinen Namen nach Kategorie: wie bei Kategorie: Getränke).</span><span class="sxs-lookup"><span data-stu-id="2e08d-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="2e08d-232">Wenn Sie hier einen Wert anzeigen möchten, können Sie entweder die Eigenschaft boundfields [`NullDisplayText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) auf den Text festlegen, der angezeigt werden soll, oder Sie können eine Bedingungs Anweisung in der Methode "Rendering" hinzufügen, wenn Sie die `currentValue` der Eigenschaft "`Text` der Trenn zeichenzeile" zuweisen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>

## <a name="summary"></a><span data-ttu-id="2e08d-233">Summary</span><span class="sxs-lookup"><span data-stu-id="2e08d-233">Summary</span></span>

<span data-ttu-id="2e08d-234">In der GridView sind nicht viele integrierte Optionen zum Anpassen der Sortier Schnittstelle enthalten.</span><span class="sxs-lookup"><span data-stu-id="2e08d-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="2e08d-235">Allerdings ist es mit einem wenig Code auf niedriger Ebene möglich, die GridView s-Steuerelement Hierarchie zu optimieren, um eine benutzerdefinierte Schnittstelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="2e08d-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="2e08d-236">In diesem Tutorial haben Sie erfahren, wie Sie eine Sortierungs Gruppe für Sortiergruppen für eine sortierbare GridView-Struktur hinzufügen, mit der die verschiedenen Gruppen und Gruppen Grenzen leichter identifiziert werden.</span><span class="sxs-lookup"><span data-stu-id="2e08d-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="2e08d-237">Weitere Beispiele für angepasste Sortier Schnittstellen finden Sie im Blogeintrag [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A few ASP.NET 2,0 GridView Sortierungs Tipps und Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2e08d-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="2e08d-238">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="2e08d-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2e08d-239">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="2e08d-239">About the Author</span></span>

<span data-ttu-id="2e08d-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="2e08d-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2e08d-241">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="2e08d-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2e08d-242">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2e08d-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2e08d-243">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2e08d-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2e08d-244">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2e08d-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="2e08d-245">Vorheriges</span><span class="sxs-lookup"><span data-stu-id="2e08d-245">Previous</span></span>](sorting-custom-paged-data-vb.md)
