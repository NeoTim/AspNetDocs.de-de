---
uid: web-forms/overview/data-access/paging-and-sorting/sorting-custom-paged-data-cs
title: Sortieren von benutzerdefinierten ausgelagerten Daten (c#) | Microsoft-Dokumentation
author: rick-anderson
description: Im vorherigen Tutorial haben wir gelernt benutzerdefiniertes Paging zu implementieren, wenn Daten auf einer Webseite dargestellt werden. In diesem Tutorial erfahren Sie wie der vorherigen erweitern...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: 778baa4e-4af8-4665-947e-7a01d1a4dff2
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/sorting-custom-paged-data-cs
msc.type: authoredcontent
ms.openlocfilehash: eaf11e48238353d098a1df8bbd13f71b5778ffb5
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2019
ms.locfileid: "65128093"
---
# <a name="sorting-custom-paged-data-c"></a><span data-ttu-id="dcbbe-104">Sortieren von benutzerdefinierten ausgelagerten Daten (C#)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-104">Sorting Custom Paged Data (C#)</span></span>

<span data-ttu-id="dcbbe-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dcbbe-106">[Beispiel-App herunter](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_26_CS.exe) oder [PDF-Datei herunterladen](sorting-custom-paged-data-cs/_static/datatutorial26cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_26_CS.exe) or [Download PDF](sorting-custom-paged-data-cs/_static/datatutorial26cs1.pdf)</span></span>

> <span data-ttu-id="dcbbe-107">Im vorherigen Tutorial haben wir gelernt benutzerdefiniertes Paging zu implementieren, wenn Daten auf einer Webseite dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-107">In the previous tutorial we learned how to implement custom paging when presenting data on a web page.</span></span> <span data-ttu-id="dcbbe-108">In diesem Tutorial sehen wir im vorherige Beispiel Unterstützung für die Sortierung von benutzerdefinierten Paging zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-108">In this tutorial we see how to extend the preceding example to include support for sorting custom paging.</span></span>

## <a name="introduction"></a><span data-ttu-id="dcbbe-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="dcbbe-109">Introduction</span></span>

<span data-ttu-id="dcbbe-110">Im Vergleich zu Standard-auslagerungen, benutzerdefinierte Paginierung kann die Leistung von Paging Daten verbessern, indem ein Vielfaches, sodass benutzerdefiniertes paging die Wahl der de-facto Paging-Implementierung, wenn paging durch große Mengen von Daten.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-110">Compared to default paging, custom paging can improve the performance of paging through data by several orders of magnitude, making custom paging the de facto paging implementation choice when paging through large amounts of data.</span></span> <span data-ttu-id="dcbbe-111">Implementieren von benutzerdefiniertem Paging ist komplizierter als die Implementierung, standardmäßig paging, jedoch vor allem beim Hinzufügen einer Sortierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-111">Implementing custom paging is more involved than implementing default paging, however, especially when adding sorting to the mix.</span></span> <span data-ttu-id="dcbbe-112">In diesem Tutorial werden wir das Beispiel aus dem vorherigen Unterstützung für die Sortierung erweitern *und* benutzerdefiniertes Paging.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-112">In this tutorial we'll extend the example from the preceding one to include support for sorting *and* custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="dcbbe-113">Seit dem vorherigen Beispiel, in diesem Tutorial aufbaut, vor dem Beginn können Sie die deklarative Syntax im Kopieren der `<asp:Content>` Element aus der vorherigen Lernprogramm-s-Webseite (`EfficientPaging.aspx`) und fügen Sie sie zwischen den `<asp:Content>` Element in der `SortParameter.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-113">Since this tutorial builds upon the preceding one, before beginning take a moment to copy the declarative syntax within the `<asp:Content>` element from the preceding tutorial s web page (`EfficientPaging.aspx`) and paste it between the `<asp:Content>` element in the `SortParameter.aspx` page.</span></span> <span data-ttu-id="dcbbe-114">Siehe Schritt 1 von der [Hinzufügen von Steuerelementen zur gültigkeitsprüfung zum Bearbeiten und Einfügen von Schnittstellen](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) Tutorial für eine ausführlichere Erläuterung zur Replikation von der Funktionalität einer ASP.NET-Seite in einen anderen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-114">Refer back to Step 1 of the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for a more detailed discussion on replicating the functionality of one ASP.NET page to another.</span></span>

## <a name="step-1-reexamining-the-custom-paging-technique"></a><span data-ttu-id="dcbbe-115">Schritt 1: Überprüfen das benutzerdefinierte Paging-Verfahren</span><span class="sxs-lookup"><span data-stu-id="dcbbe-115">Step 1: Reexamining the Custom Paging Technique</span></span>

<span data-ttu-id="dcbbe-116">Für das benutzerdefinierte Paging ordnungsgemäß funktioniert, müssen wir ein Verfahren implementieren, die eine bestimmte Teilmenge der Datensätze, die anhand der Startindex für die Zeile und die maximale Zeilenanzahl Parameter effizient erfasst werden können.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-116">For custom paging to work properly, we must implement some technique that can efficiently grab a particular subset of records given the Start Row Index and Maximum Rows parameters.</span></span> <span data-ttu-id="dcbbe-117">Es gibt eine Reihe von Techniken, die verwendet werden kann, um dieses Ziel zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-117">There are a handful of techniques that can be used to achieve this aim.</span></span> <span data-ttu-id="dcbbe-118">Im vorherigen Tutorial erläutert, auf das erreichen dies mithilfe von Microsoft SQLServer 2005 s neue `ROW_NUMBER()` rangfolgefunktion.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-118">In the preceding tutorial we looked at accomplishing this using Microsoft SQL Server 2005 s new `ROW_NUMBER()` ranking function.</span></span> <span data-ttu-id="dcbbe-119">Kurz gesagt: die `ROW_NUMBER()` rangfolgefunktion weist jede Zeile zurück, die von einer Abfrage, die nach einer angegebenen Sortierreihenfolge geordnet wird eine Zeilennummer.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-119">In short, the `ROW_NUMBER()` ranking function assigns a row number to each row returned by a query that is ranked by a specified sort order.</span></span> <span data-ttu-id="dcbbe-120">Anschließend wird die entsprechende Teilmenge der Datensätze abgerufen, durch einen bestimmten Teil der nummerierten Ergebnisse zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-120">The appropriate subset of records is then obtained by returning a particular section of the numbered results.</span></span> <span data-ttu-id="dcbbe-121">Die folgende Abfrage veranschaulicht, wie Sie dieses Verfahren, um zurückgeben dieser Produkte 11 bis 20 nummeriert, wenn nach der Rangfolge der Ergebnisse alphabetisch sortiert werden. die `ProductName`:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-121">The following query illustrates how to use this technique to return those products numbered 11 through 20 when ranking the results ordered alphabetically by the `ProductName`:</span></span>

[!code-sql[Main](sorting-custom-paged-data-cs/samples/sample1.sql)]

<span data-ttu-id="dcbbe-122">Dieses Verfahren eignet sich gut für Paging, verwenden keine bestimmte Sortierreihenfolge (`ProductName` alphabetisch sortiert, in diesem Fall), aber die Abfrage muss geändert werden, um die Ergebnisse sortiert nach einem Sortierungsausdruck für die verschiedenen zeigen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-122">This technique works well for paging using a specific sort order (`ProductName` sorted alphabetically, in this case), but the query needs to be modified to show the results sorted by a different sort expression.</span></span> <span data-ttu-id="dcbbe-123">Im Idealfall die obige Abfrage neu geschrieben werden, um eine in-Parameter verwenden, die `OVER` -Klausel wie folgt:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-123">Ideally, the above query could be rewritten to use a parameter in the `OVER` clause, like so:</span></span>

[!code-sql[Main](sorting-custom-paged-data-cs/samples/sample2.sql)]

<span data-ttu-id="dcbbe-124">Leider parametrisiert `ORDER BY` Klauseln sind nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-124">Unfortunately, parameterized `ORDER BY` clauses are not allowed.</span></span> <span data-ttu-id="dcbbe-125">Stattdessen müssen wir erstellen eine gespeicherte Prozedur, die akzeptiert eine `@sortExpression` input-Parameters, verwendet aber von einer der folgenden problemumgehungen:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-125">Instead, we must create a stored procedure that accepts a `@sortExpression` input parameter, but uses one of the following workarounds:</span></span>

- <span data-ttu-id="dcbbe-126">Schreiben Sie hart kodierte Abfragen, für die einzelnen die sortierungsausdrücke, die verwendet werden können; Verwenden Sie dann `IF/ELSE` T-SQL-Anweisungen, um zu bestimmen, welche die auszuführende Abfrage.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-126">Write hard-coded queries for each of the sort expressions that may be used; then, use `IF/ELSE` T-SQL statements to determine which query to execute.</span></span>
- <span data-ttu-id="dcbbe-127">Verwenden einer `CASE` Anweisung zu dynamischen `ORDER BY` Ausdrücke basierend auf der `@sortExpressio` n Eingabeparameter; finden Sie unter den wird verwendet, um dynamisch Sortieren von Abfrageergebnissen im Abschnitt [die Leistungsfähigkeit von SQL `CASE` Anweisungen](http://www.4guysfromrolla.com/webtech/102704-1.shtml) Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-127">Use a `CASE` statement to provide dynamic `ORDER BY` expressions based on the `@sortExpressio` n input parameter; see the Used to Dynamically Sort Query Results section in [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml) for more information.</span></span>
- <span data-ttu-id="dcbbe-128">Gestalten Sie die entsprechende Abfrage als Zeichenfolge in der gespeicherten Prozedur, und verwenden Sie dann [der `sp_executesql` gespeicherte Systemprozedur](https://msdn.microsoft.com/library/ms188001.aspx) um die dynamische Abfrage auszuführen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-128">Craft the appropriate query as a string in the stored procedure and then use [the `sp_executesql` system stored procedure](https://msdn.microsoft.com/library/ms188001.aspx) to execute the dynamic query.</span></span>

<span data-ttu-id="dcbbe-129">Jede der folgenden Vorgehensweisen hat einige Nachteile.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-129">Each of these workarounds has some drawbacks.</span></span> <span data-ttu-id="dcbbe-130">Die erste Option ist nicht als verwaltbar als die anderen beiden, da es erfordert, dass Sie eine Abfrage für jeden möglichen Sortierungsausdruck erstellen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-130">The first option is not as maintainable as the other two as it requires that you create a query for each possible sort expression.</span></span> <span data-ttu-id="dcbbe-131">Aus diesem Grund, wenn Sie später entscheiden, um die GridView neue, sortierbar Felder hinzuzufügen auch müssen Sie zurückgehen und aktualisieren die gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-131">Therefore, if later you decide to add new, sortable fields to the GridView you will also need to go back and update the stored procedure.</span></span> <span data-ttu-id="dcbbe-132">Der zweite Ansatz hat einige Besonderheiten, die Bedenken hinsichtlich der Leistung führen, beim Sortieren von Datenbankspalten keine Zeichenfolge und unterliegt auch dieselben Probleme wie die erste Verwaltbarkeit.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-132">The second approach has some subtleties that introduce performance concerns when sorting by non-string database columns and also suffers from the same maintainability issues as the first.</span></span> <span data-ttu-id="dcbbe-133">Und die dritte Option, die dynamisches SQL verwendet, bietet das Risiko für einen SQL-Injection-Angriff aus, wenn ein Angreifer die gespeicherte Prozedur übergeben werden, in der Eingabe von eingabeparameterwerten ihrer Wahl ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-133">And the third choice, which uses dynamic SQL, introduces the risk for a SQL injection attack if an attacker is able to execute the stored procedure passing in the input parameter values of their choosing.</span></span>

<span data-ttu-id="dcbbe-134">Während keiner dieser Ansätze perfekt ist, denke ich, dass die dritte Option das beste aus den drei ist.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-134">While none of these approaches is perfect, I think the third option is the best of the three.</span></span> <span data-ttu-id="dcbbe-135">Mit der Verwendung von dynamischem SQL bietet es sich um ein Maß an Flexibilität, die die beiden anderen nicht der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-135">With its use of dynamic SQL, it offers a level of flexibility the other two do not.</span></span> <span data-ttu-id="dcbbe-136">Darüber hinaus kann ein SQL-Injection-Angriff nur ausgenutzt werden, wenn ein Angreifer die gespeicherte Prozedur übergeben, die in den Eingabeparametern seiner Wahl ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-136">Furthermore, a SQL injection attack can only be exploited if an attacker is able to execute the stored procedure passing in the input parameters of his choice.</span></span> <span data-ttu-id="dcbbe-137">Da die DAL parametrisierte Abfragen verwendet, schützt ADO.NET diese Parameter, die über die Architektur, auf die Datenbank gesendet werden dies bedeutet, dass die SQL-Injection-Angriff Schwachstelle ist nur vorhanden, wenn der Angreifer die gespeicherte Prozedur direkt ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-137">Since the DAL uses parameterized queries, ADO.NET will protect those parameters that are sent to the database through the architecture, meaning that the SQL injection attack vulnerability only exists if the attacker can directly execute the stored procedure.</span></span>

<span data-ttu-id="dcbbe-138">Um diese Funktionalität zu implementieren, erstellen Sie eine neue gespeicherte Prozedur in der Northwind-Datenbank, die mit dem Namen `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-138">To implement this functionality, create a new stored procedure in the Northwind database named `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="dcbbe-139">Diese gespeicherte Prozedur sollte drei Eingabezeichenfolge-Parameter akzeptieren: `@sortExpression`, einen Eingabeparameter vom Typ `nvarchar(100`), der angibt, wie die Ergebnisse sortiert werden soll, und wird direkt nach eingefügt der `ORDER BY` Text in die `OVER` -Klausel und `@startRowIndex` und `@maximumRows`, die gleichen beiden ganzzahligen Eingabeparameter aus der `GetProductsPaged` gespeicherte Prozedur, die im vorherigen Tutorial untersucht.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-139">This stored procedure should accept three input parameters: `@sortExpression`, an input parameter of type `nvarchar(100`) that specifies how the results should be sorted and is injected directly after the `ORDER BY` text in the `OVER` clause; and `@startRowIndex` and `@maximumRows`, the same two integer input parameters from the `GetProductsPaged` stored procedure examined in the preceding tutorial.</span></span> <span data-ttu-id="dcbbe-140">Erstellen der `GetProductsPagedAndSorted` gespeicherte Prozedur, die mithilfe des folgenden Skripts:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-140">Create the `GetProductsPagedAndSorted` stored procedure using the following script:</span></span>

[!code-sql[Main](sorting-custom-paged-data-cs/samples/sample3.sql)]

<span data-ttu-id="dcbbe-141">Die gespeicherte Prozedur startet, indem sichergestellt wird, die einen Wert für die `@sortExpression` Parameter angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-141">The stored procedure starts by ensuring that a value for the `@sortExpression` parameter has been specified.</span></span> <span data-ttu-id="dcbbe-142">Wenn sie nicht vorhanden ist, werden die Ergebnisse von geordnet `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-142">If it is missing, the results are ranked by `ProductID`.</span></span> <span data-ttu-id="dcbbe-143">Als Nächstes wird die dynamische SQL-Abfrage erstellt.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-143">Next, the dynamic SQL query is constructed.</span></span> <span data-ttu-id="dcbbe-144">Beachten Sie, dass die dynamische SQL-Abfrage hier von unseren vorherigen Abfragen verwendet geringfügig, um alle Zeilen aus Produkttabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-144">Note that the dynamic SQL query here differs slightly from our previous queries used to retrieve all rows from the Products table.</span></span> <span data-ttu-id="dcbbe-145">In früheren Beispielen wir jede s zugeordneten Produktkategorie s und Lieferant s-Namen, die mit einer Unterabfrage abgerufen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-145">In prior examples, we obtained each product s associated category s and supplier s names using a subquery.</span></span> <span data-ttu-id="dcbbe-146">Diese Entscheidung getroffen wurde, wieder in die [Erstellen einer Datenzugriffsschicht](../introduction/creating-a-data-access-layer-cs.md) Tutorial und erfolgte anstelle `JOIN` s weil TableAdapter zugeordnete Einfüge-, nicht automatisch erstellt Update- und delete-Methoden für ein solches Abfragen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-146">This decision was made back in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial and was done in lieu of using `JOIN` s because the TableAdapter cannot automatically create the associated insert, update, and delete methods for such queries.</span></span> <span data-ttu-id="dcbbe-147">Die `GetProductsPagedAndSorted` gespeicherte Prozedur, allerdings muss verwenden `JOIN` s für die Ergebnisse an die Kategorie- bzw. Lieferanteninformationen Namen sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-147">The `GetProductsPagedAndSorted` stored procedure, however, must use `JOIN` s for the results to be ordered by the category or supplier names.</span></span>

<span data-ttu-id="dcbbe-148">Diese dynamische Abfrage durch die Verkettung der statische Abfrage Teile aufgebaut ist und die `@sortExpression`, `@startRowIndex`, und `@maximumRows` Parameter.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-148">This dynamic query is built up by concatenating the static query portions and the `@sortExpression`, `@startRowIndex`, and `@maximumRows` parameters.</span></span> <span data-ttu-id="dcbbe-149">Da `@startRowIndex` und `@maximumRows` sind ganzzahlige Parameter, sie müssen in Nvarchars um ordnungsgemäß verkettet werden, konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-149">Since `@startRowIndex` and `@maximumRows` are integer parameters, they must be converted into nvarchars in order to be correctly concatenated.</span></span> <span data-ttu-id="dcbbe-150">Sobald diese dynamischen SQL-Abfrage erstellt wurde, wird es über ausgeführt `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-150">Once this dynamic SQL query has been constructed, it is executed via `sp_executesql`.</span></span>

<span data-ttu-id="dcbbe-151">Testen mit unterschiedlichen Werten für diese gespeicherte Prozedur in Ruhe die `@sortExpression`, `@startRowIndex`, und `@maximumRows` Parameter.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-151">Take a moment to test this stored procedure with different values for the `@sortExpression`, `@startRowIndex`, and `@maximumRows` parameters.</span></span> <span data-ttu-id="dcbbe-152">Klicken Sie im Server-Explorer mit der rechten Maustaste auf den Namen der gespeicherten Prozedur, und wählen Sie Execute.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-152">From the Server Explorer, right-click on the stored procedure name and choose Execute.</span></span> <span data-ttu-id="dcbbe-153">Dadurch gelangen in die Sie, die Eingabeparameter eingeben können (siehe Abbildung 1) das Dialogfeld für die gespeicherte Ausführungsprozedur.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-153">This will bring up the Run Stored Procedure dialog box into which you can enter the input parameters (see Figure 1).</span></span> <span data-ttu-id="dcbbe-154">Verwenden Sie zum Sortieren der Ergebnisse durch den Namen der Kategorie "CategoryName", für die `@sortExpression` Parameterwert; CompanyName verwenden Sie zum Sortieren, indem der Name des Lieferanten s-Unternehmen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-154">To sort the results by the category name, use CategoryName for the `@sortExpression` parameter value; to sort by the supplier s company name, use CompanyName.</span></span> <span data-ttu-id="dcbbe-155">Nach dem Sie die Parameterwerte angegeben haben, klicken Sie auf "OK".</span><span class="sxs-lookup"><span data-stu-id="dcbbe-155">After providing the parameters values, click OK.</span></span> <span data-ttu-id="dcbbe-156">Die Ergebnisse werden im Ausgabefenster angezeigt.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-156">The results are displayed in the Output window.</span></span> <span data-ttu-id="dcbbe-157">Abbildung 2 zeigt die Ergebnisse, wenn 11 bis 20 Produkten zurückgeben eingestuft werden, wenn durch die `UnitPrice` in absteigender Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-157">Figure 2 shows the results when returning products ranked 11 through 20 when ordering by the `UnitPrice` in descending order.</span></span>

![Testen Sie verschiedene Werte für die gespeicherte Prozedur s drei Eingabeparameter](sorting-custom-paged-data-cs/_static/image1.png)

<span data-ttu-id="dcbbe-159">**Abbildung 1**: Testen Sie verschiedene Werte für die gespeicherte Prozedur s drei Eingabeparameter</span><span class="sxs-lookup"><span data-stu-id="dcbbe-159">**Figure 1**: Try Different Values for the Stored Procedure s Three Input Parameters</span></span>

<span data-ttu-id="dcbbe-160">[![Die gespeicherte Prozedur s werden Ergebnisse im Ausgabefenster angezeigt.](sorting-custom-paged-data-cs/_static/image3.png)](sorting-custom-paged-data-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-160">[![The Stored Procedure s Results are Shown in the Output Window](sorting-custom-paged-data-cs/_static/image3.png)](sorting-custom-paged-data-cs/_static/image2.png)</span></span>

<span data-ttu-id="dcbbe-161">**Abbildung 2**: Die gespeicherte Prozedur s Ergebnisse werden im Ausgabefenster angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](sorting-custom-paged-data-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="dcbbe-161">**Figure 2**: The Stored Procedure s Results are Shown in the Output Window ([Click to view full-size image](sorting-custom-paged-data-cs/_static/image4.png))</span></span>

> [!NOTE]
> <span data-ttu-id="dcbbe-162">Wenn die Ergebnisse mit der angegebenen Rangfolge `ORDER BY` -Spalte in der `OVER` -Klausel, SQL Server muss die Ergebnisse zu sortieren.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-162">When ranking the results by the specified `ORDER BY` column in the `OVER` clause, SQL Server must sort the results.</span></span> <span data-ttu-id="dcbbe-163">Dies ist ein schneller Vorgang bei ein gruppierter Index über die Spalten, die die Ergebnisse nach sortiert wird werden oder wenn es ein abdeckender index, aber andernfalls teuer werden können.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-163">This is a quick operation if there is a clustered index over the column(s) the results are being ordered by or if there is a covering index, but can be more costly otherwise.</span></span> <span data-ttu-id="dcbbe-164">Zur Verbesserung der Leistung bei ausreichend großen Abfragen erwägen Sie, einen nicht gruppierten Index für die Spalte mit der die Ergebnisse nach sortiert sind.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-164">To improve performance for sufficiently large queries, consider adding a non-clustered index for the column by which the results are ordered by.</span></span> <span data-ttu-id="dcbbe-165">Finden Sie unter [Rangfolgefunktionen und Leistung in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) Weitere Details.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-165">Refer to [Ranking Functions and Performance in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) for more details.</span></span>

## <a name="step-2-augmenting-the-data-access-and-business-logic-layers"></a><span data-ttu-id="dcbbe-166">Schritt 2: Erweitern den Datenzugriff und Geschäftslogikschichten</span><span class="sxs-lookup"><span data-stu-id="dcbbe-166">Step 2: Augmenting the Data Access and Business Logic Layers</span></span>

<span data-ttu-id="dcbbe-167">Mit der `GetProductsPagedAndSorted` erstellten gespeicherten Prozedur im nächsten Schritt wird eine Möglichkeit zum Ausführen dieser gespeicherten Prozedur über die Architektur unserer Anwendung bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-167">With the `GetProductsPagedAndSorted` stored procedure created, our next step is to provide a means to execute that stored procedure through our application architecture.</span></span> <span data-ttu-id="dcbbe-168">Dies umfasst das Hinzufügen einer geeigneten Methode zum BLL- und DAL.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-168">This entails adding an appropriate method to both the DAL and BLL.</span></span> <span data-ttu-id="dcbbe-169">Lassen Sie s beginnen, indem eine Methode an die DAL hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-169">Let s start by adding a method to the DAL.</span></span> <span data-ttu-id="dcbbe-170">Öffnen der `Northwind.xsd` typisierte DataSet, mit der rechten Maustaste auf die `ProductsTableAdapter`, und wählen Sie im Kontextmenü die Option "hinzufügen".</span><span class="sxs-lookup"><span data-stu-id="dcbbe-170">Open the `Northwind.xsd` Typed DataSet, right-click on the `ProductsTableAdapter`, and choose the Add Query option from the context menu.</span></span> <span data-ttu-id="dcbbe-171">Wie im vorherigen Tutorial so konfigurieren Sie diese neuen DAL-Methode, um eine vorhandene gespeicherte Prozedur - verwenden werden sollten `GetProductsPagedAndSorted`, in diesem Fall.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-171">As we did in the preceding tutorial, we want to configure this new DAL method to use an existing stored procedure - `GetProductsPagedAndSorted`, in this case.</span></span> <span data-ttu-id="dcbbe-172">Starten Sie an, dass Sie die neue TableAdapter-Methode, um eine vorhandene gespeicherte Prozedur verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-172">Start by indicating that you want the new TableAdapter method to use an existing stored procedure.</span></span>

![Wählen Sie eine vorhandene gespeicherte Prozedur verwenden.](sorting-custom-paged-data-cs/_static/image5.png)

<span data-ttu-id="dcbbe-174">**Abbildung 3**: Wählen Sie eine vorhandene gespeicherte Prozedur verwenden.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-174">**Figure 3**: Choose to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="dcbbe-175">Wählen Sie zum Angeben der gespeicherten Prozedur verwendet die `GetProductsPagedAndSorted` gespeicherte Prozedur aus der Dropdown-Liste im nächsten Bildschirm.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-175">To specify the stored procedure to use, select the `GetProductsPagedAndSorted` stored procedure from the drop-down list in the next screen.</span></span>

![Verwenden Sie die GetProductsPagedAndSorted gespeicherten Prozedur](sorting-custom-paged-data-cs/_static/image6.png)

<span data-ttu-id="dcbbe-177">**Abbildung 4**: Verwenden Sie die GetProductsPagedAndSorted gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="dcbbe-177">**Figure 4**: Use the GetProductsPagedAndSorted Stored Procedure</span></span>

<span data-ttu-id="dcbbe-178">Diese gespeicherte Prozedur gibt eine Gruppe von Datensätzen zurück, wie die Ergebnisse also auf dem nächsten Bildschirm angegeben, dass sie die tabellarische Daten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-178">This stored procedure returns a set of records as its results so, in the next screen, indicate that it returns tabular data.</span></span>

![Anzugeben Sie, dass die gespeicherte Prozedur Tabellendaten zurück.](sorting-custom-paged-data-cs/_static/image7.png)

<span data-ttu-id="dcbbe-180">**Abbildung 5**: Anzugeben Sie, dass die gespeicherte Prozedur Tabellendaten zurück.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-180">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data</span></span>

<span data-ttu-id="dcbbe-181">Erstellen Sie schließlich DAL Methoden, mit denen sowohl die Füllung einer "DataTable" und Zurückgeben einer DataTable-Muster, und benennen die Methoden `FillPagedAndSorted` und `GetProductsPagedAndSorted`bzw.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-181">Finally, create DAL methods that use both the Fill a DataTable and Return a DataTable patterns, naming the methods `FillPagedAndSorted` and `GetProductsPagedAndSorted`, respectively.</span></span>

![Wählen Sie die Methodennamen](sorting-custom-paged-data-cs/_static/image8.png)

<span data-ttu-id="dcbbe-183">**Abbildung 6**: Wählen Sie die Methodennamen</span><span class="sxs-lookup"><span data-stu-id="dcbbe-183">**Figure 6**: Choose the Methods Names</span></span>

<span data-ttu-id="dcbbe-184">Nun, wir haben erweitert die DAL aus, es erneut bereit, um an die BLL zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-184">Now that we ve extended the DAL, we re ready to turn to the BLL.</span></span> <span data-ttu-id="dcbbe-185">Öffnen der `ProductsBLL` Klassendatei, und fügen Sie eine neue Methode `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-185">Open the `ProductsBLL` class file and add a new method, `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="dcbbe-186">Diese Methode akzeptiert drei Eingabezeichenfolge-Parameter muss `sortExpression`, `startRowIndex`, und `maximumRows` und einfach in die DAL s aufrufen sollten `GetProductsPagedAndSorted` -Methode wie folgt:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-186">This method needs to accept three input parameters `sortExpression`, `startRowIndex`, and `maximumRows` and should simply call down into the DAL s `GetProductsPagedAndSorted` method, like so:</span></span>

[!code-csharp[Main](sorting-custom-paged-data-cs/samples/sample4.cs)]

## <a name="step-3-configuring-the-objectdatasource-to-pass-in-the-sortexpression-parameter"></a><span data-ttu-id="dcbbe-187">Schritt 3: Konfigurieren im Parameter "SortExpression" dem ObjectDataSource-Steuerelement zu übergeben</span><span class="sxs-lookup"><span data-stu-id="dcbbe-187">Step 3: Configuring the ObjectDataSource to Pass in the SortExpression Parameter</span></span>

<span data-ttu-id="dcbbe-188">Müssen erweitert die DAL und den BLL, um die Methoden enthalten, die Nutzung der `GetProductsPagedAndSorted` gespeicherte Prozedur, die alle, die verbleibt, wird zu "ObjectDataSource" Konfigurieren der `SortParameter.aspx` Seite zur Verwendung der neuen BLL-Methode und übergeben der `SortExpression` Parameter basierend auf der Spalte, die der Benutzer angefordert hat, um die Ergebnisse nach zu sortieren.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-188">Having augmented the DAL and BLL to include methods that utilize the `GetProductsPagedAndSorted` stored procedure, all that remains is to configure the ObjectDataSource in the `SortParameter.aspx` page to use the new BLL method and to pass in the `SortExpression` parameter based on the column that the user has requested to sort the results by.</span></span>

<span data-ttu-id="dcbbe-189">Als erstes ändern das "ObjectDataSource"-s `SelectMethod` aus `GetProductsPaged` zu `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-189">Start by changing the ObjectDataSource s `SelectMethod` from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="dcbbe-190">Dies kann über das Konfigurieren von Datenquellen-Assistenten, im Eigenschaftenfenster oder direkt über die deklarative Syntax erfolgen.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-190">This can be done through the Configure Data Source wizard, from the Properties window, or directly through the declarative syntax.</span></span> <span data-ttu-id="dcbbe-191">Als Nächstes müssen wir geben Sie einen Wert für "ObjectDataSource" s [ `SortParameterName` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sortparametername.aspx).</span><span class="sxs-lookup"><span data-stu-id="dcbbe-191">Next, we need to provide a value for the ObjectDataSource s [`SortParameterName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sortparametername.aspx).</span></span> <span data-ttu-id="dcbbe-192">Wenn diese Eigenschaft festgelegt ist, versucht dem ObjectDataSource-Steuerelement für die Übergabe in den GridView-s `SortExpression` Eigenschaft, um die `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-192">If this property is set, the ObjectDataSource attempts to pass in the GridView s `SortExpression` property to the `SelectMethod`.</span></span> <span data-ttu-id="dcbbe-193">Insbesondere sucht dem ObjectDataSource-Steuerelement für einen Eingabeparameter, dessen Name dem Wert des entspricht, der `SortParameterName` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-193">In particular, the ObjectDataSource looks for an input parameter whose name is equal to the value of the `SortParameterName` property.</span></span> <span data-ttu-id="dcbbe-194">Seit der BLL s `GetProductsPagedAndSorted` Methode verfügt über die Eingabeparameter der Sort-Ausdruck mit dem Namen `sortExpression`, legen Sie das "ObjectDataSource"-s `SortExpression` SortExpression Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-194">Since the BLL s `GetProductsPagedAndSorted` method has the sort expression input parameter named `sortExpression`, set the ObjectDataSource s `SortExpression` property to sortExpression .</span></span>

<span data-ttu-id="dcbbe-195">Nachdem Sie diese beiden Änderungen vornehmen, sollte die deklarative Syntax des "ObjectDataSource"-s etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-195">After making these two changes, the ObjectDataSource s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-custom-paged-data-cs/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="dcbbe-196">Wie stellen Sie sicher, dass dem ObjectDataSource-Steuerelement festgelegt wurde, mit dem vorherigen Lernprogramm *nicht* SortExpression StartRowIndex oder MaximumRows Eingabeparameter in der SelectParameters-Sammlung enthalten.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-196">As with the preceding tutorial, ensure that the ObjectDataSource does *not* include the sortExpression, startRowIndex, or maximumRows input parameters in its SelectParameters collection.</span></span>

<span data-ttu-id="dcbbe-197">Zum Aktivieren der Sortierung in den GridView-Ansicht aktivieren Sie einfach die Kontrollkästchen Sortieren aktivieren im GridView s Smarttag, das GridView-s festgelegt `AllowSorting` Eigenschaft `true` und dadurch den Headertext für jede Spalte als ein LinkButton gerendert werden soll.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-197">To enable sorting in the GridView, simply check the Enable Sorting checkbox in the GridView s smart tag, which sets the GridView s `AllowSorting` property to `true` and causing the header text for each column to be rendered as a LinkButton.</span></span> <span data-ttu-id="dcbbe-198">Klickt der Endbenutzer auf eines der Header LinkButtons, erfolgt ein Postback und ablaufen, müssen die folgenden Schritte aus:</span><span class="sxs-lookup"><span data-stu-id="dcbbe-198">When the end user clicks on one of the header LinkButtons, a postback ensues and the following steps transpire:</span></span>

1. <span data-ttu-id="dcbbe-199">Das GridView-Updates der [ `SortExpression` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) auf den Wert des der `SortExpression` des Felds, dessen Verknüpfung Header geklickt wurde,</span><span class="sxs-lookup"><span data-stu-id="dcbbe-199">The GridView updates its [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) to the value of the `SortExpression` of the field whose header link was clicked</span></span>
2. <span data-ttu-id="dcbbe-200">Dem ObjectDataSource-Steuerelement ruft die BLL s `GetProductsPagedAndSorted` Methode und übergeben das GridView-s `SortExpression` Eigenschaft als Wert für die s-Methode `sortExpression` Eingabeparameter (zusammen mit dem entsprechenden `startRowIndex` und `maximumRows` Werte der Eingabeparameter)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-200">The ObjectDataSource invokes the BLL s `GetProductsPagedAndSorted` method, passing in the GridView s `SortExpression` property as the value for the method s `sortExpression` input parameter (along with the appropriate `startRowIndex` and `maximumRows` input parameter values)</span></span>
3. <span data-ttu-id="dcbbe-201">Die Geschäftslogikschicht Ruft die DAL s `GetProductsPagedAndSorted` Methode</span><span class="sxs-lookup"><span data-stu-id="dcbbe-201">The BLL invokes the DAL s `GetProductsPagedAndSorted` method</span></span>
4. <span data-ttu-id="dcbbe-202">Die DAL führt die `GetProductsPagedAndSorted` gespeicherte Prozedur übergeben, der `@sortExpression` Parameter (zusammen mit den `@startRowIndex` und `@maximumRows` Werte der Eingabeparameter)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-202">The DAL executes the `GetProductsPagedAndSorted` stored procedure, passing in the `@sortExpression` parameter (along with the `@startRowIndex` and `@maximumRows` input parameter values)</span></span>
5. <span data-ttu-id="dcbbe-203">Die gespeicherte Prozedur gibt die geeignete Teilmenge von Daten an die BLL, das an dem ObjectDataSource-Steuerelement zurückgegeben; Diese Daten werden dann an die GridView gebunden, in HTML gerendert und nach unten für den Endbenutzer gesendet</span><span class="sxs-lookup"><span data-stu-id="dcbbe-203">The stored procedure returns the appropriate subset of data to the BLL, which returns it to the ObjectDataSource; this data is then bound to the GridView, rendered into HTML, and sent down to the end user</span></span>

<span data-ttu-id="dcbbe-204">Abbildung 7 zeigt die erste Seite der Ergebnisse sortiert nach der `UnitPrice` in aufsteigender Reihenfolge.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-204">Figure 7 shows the first page of results when sorted by the `UnitPrice` in ascending order.</span></span>

<span data-ttu-id="dcbbe-205">[![Die Ergebnisse sind nach den Einzelpreis sortiert.](sorting-custom-paged-data-cs/_static/image10.png)](sorting-custom-paged-data-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-205">[![The Results are Sorted by the UnitPrice](sorting-custom-paged-data-cs/_static/image10.png)](sorting-custom-paged-data-cs/_static/image9.png)</span></span>

<span data-ttu-id="dcbbe-206">**Abbildung 7**: Die Ergebnisse werden nach den Einzelpreis sortiert ([klicken Sie, um das Bild in voller Größe anzeigen](sorting-custom-paged-data-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="dcbbe-206">**Figure 7**: The Results are Sorted by the UnitPrice ([Click to view full-size image](sorting-custom-paged-data-cs/_static/image11.png))</span></span>

<span data-ttu-id="dcbbe-207">Während die Ergebnisse nach Produktname, Kategoriename, Menge pro Einheit und Preis pro Einheit in die aktuelle Implementierung ordnungsgemäß sortieren kann, es wird versucht, zum Sortieren der Ergebnisse der Lieferant die Namen wird zu einer Laufzeitausnahme (siehe Abbildung 8).</span><span class="sxs-lookup"><span data-stu-id="dcbbe-207">While the current implementation can correctly sort the results by product name, category name, quantity per unit, and unit price, attempting to order the results by the supplier name results in a runtime exception (see Figure 8).</span></span>

![Es wird versucht, zum Sortieren der Ergebnisse von den Lieferanten-Ergebnissen in der folgenden Common Language Runtime-Ausnahme](sorting-custom-paged-data-cs/_static/image12.png)

<span data-ttu-id="dcbbe-209">**Abbildung 8**: Es wird versucht, zum Sortieren der Ergebnisse von den Lieferanten-Ergebnissen in der folgenden Common Language Runtime-Ausnahme</span><span class="sxs-lookup"><span data-stu-id="dcbbe-209">**Figure 8**: Attempting to Sort the Results by the Supplier Results in the Following Runtime Exception</span></span>

<span data-ttu-id="dcbbe-210">Diese Ausnahme tritt auf, weil die `SortExpression` der GridView Zuordnungsvorgänge `SupplierName` BoundField nastaven NA hodnotu `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-210">This exception occurs because the `SortExpression` of the GridView s `SupplierName` BoundField is set to `SupplierName`.</span></span> <span data-ttu-id="dcbbe-211">Mit dem Namen des Lieferanten s jedoch in der `Suppliers` Tabelle aufgerufen wird `CompanyName` wir waren mit einem Alias versehen der Name dieser Spalte als `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-211">However, the supplier s name in the `Suppliers` table is actually called `CompanyName` we have been aliased this column name as `SupplierName`.</span></span> <span data-ttu-id="dcbbe-212">Allerdings die `OVER` Klausel ein, die die `ROW_NUMBER()` Funktion kann nicht den Alias und den tatsächlichen Spaltennamen verwendet.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-212">However, the `OVER` clause used by the `ROW_NUMBER()` function cannot use the alias and must use the actual column name.</span></span> <span data-ttu-id="dcbbe-213">Ändern Sie daher die `SupplierName` BoundField-s `SortExpression` aus Lieferantenname CompanyName (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="dcbbe-213">Therefore, change the `SupplierName` BoundField s `SortExpression` from SupplierName to CompanyName (see Figure 9).</span></span> <span data-ttu-id="dcbbe-214">Wie in Abbildung 10 gezeigt, können nach dieser Änderung die Ergebnisse werden vom Lieferanten sortiert.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-214">As Figure 10 shows, after this change the results can be sorted by the supplier.</span></span>

![Ändern Sie die Lieferantenname BoundField-s SortExpression CompanyName](sorting-custom-paged-data-cs/_static/image13.png)

<span data-ttu-id="dcbbe-216">**Abbildung 9**: Ändern Sie die Lieferantenname BoundField-s SortExpression CompanyName</span><span class="sxs-lookup"><span data-stu-id="dcbbe-216">**Figure 9**: Change the SupplierName BoundField s SortExpression to CompanyName</span></span>

<span data-ttu-id="dcbbe-217">[![Die Ergebnisse können jetzt Lieferant sortiert werden](sorting-custom-paged-data-cs/_static/image15.png)](sorting-custom-paged-data-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-217">[![The Results Can Now Be Sorted by Supplier](sorting-custom-paged-data-cs/_static/image15.png)](sorting-custom-paged-data-cs/_static/image14.png)</span></span>

<span data-ttu-id="dcbbe-218">**Abbildung 10**: Die Ergebnisse können jetzt sortiert werden vom Lieferanten ([klicken Sie, um das Bild in voller Größe anzeigen](sorting-custom-paged-data-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="dcbbe-218">**Figure 10**: The Results Can Now Be Sorted by Supplier ([Click to view full-size image](sorting-custom-paged-data-cs/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="dcbbe-219">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="dcbbe-219">Summary</span></span>

<span data-ttu-id="dcbbe-220">Die benutzerdefinierte Paging-Implementierung, die untersuchten wir im vorherigen Tutorial erforderlich, dass die Reihenfolge, die mit der wurden die Ergebnisse sortiert werden soll, die zur Entwurfszeit angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-220">The custom paging implementation we examined in the preceding tutorial required that the order by which the results were to be sorted be specified at design time.</span></span> <span data-ttu-id="dcbbe-221">Kurz gesagt, bedeutete dies, dass die benutzerdefinierte Paging-Implementierung, die wir implementiert nicht zur gleichen Zeit, Sortierfunktionen bereitstellen konnte.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-221">In short, this meant that the custom paging implementation we implemented could not, at the same time, provide sorting capabilities.</span></span> <span data-ttu-id="dcbbe-222">In diesem Tutorial handelsanwendung wir diese Einschränkung durch die Erweiterung von der gespeicherten Prozedur aus dem ersten sollen eine `@sortExpression` Eingabeparameter mit dem die Ergebnisse sortiert werden können.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-222">In this tutorial we overcame this limitation by extending the stored procedure from the first to include a `@sortExpression` input parameter by which the results could be sorted.</span></span>

<span data-ttu-id="dcbbe-223">Nach dem Erstellen dieser Prozedur und erstellen neue Methoden in der DAL und BLL gespeichert, es wurden einer GridView-Ansicht zu implementieren, die beide Sortieren von Angeboten und benutzerdefinierte paging durch Konfigurieren der "ObjectDataSource" in den GridView-s aktuelle übergeben `SortExpression` Eigenschaft an die BLL `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-223">After creating this stored procedure and creating new methods in the DAL and BLL, we were able to implement a GridView that offered both sorting and custom paging by configuring the ObjectDataSource to pass in the GridView s current `SortExpression` property to the BLL `SelectMethod`.</span></span>

<span data-ttu-id="dcbbe-224">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="dcbbe-224">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="dcbbe-225">Der Autor</span><span class="sxs-lookup"><span data-stu-id="dcbbe-225">About the Author</span></span>

<span data-ttu-id="dcbbe-226">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-226">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dcbbe-227">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-227">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dcbbe-228">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="dcbbe-228">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dcbbe-229">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-229">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="dcbbe-230">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="dcbbe-230">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="dcbbe-231">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="dcbbe-231">Special Thanks To</span></span>

<span data-ttu-id="dcbbe-232">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-232">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="dcbbe-233">Führendes Prüfer für dieses Tutorial wurde Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="dcbbe-233">Lead reviewer for this tutorial was Carlos Santos.</span></span> <span data-ttu-id="dcbbe-234">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="dcbbe-234">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="dcbbe-235">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-235">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dcbbe-236">[Zurück](efficiently-paging-through-large-amounts-of-data-cs.md)
> [Weiter](creating-a-customized-sorting-user-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="dcbbe-236">[Previous](efficiently-paging-through-large-amounts-of-data-cs.md)
[Next](creating-a-customized-sorting-user-interface-cs.md)</span></span>
