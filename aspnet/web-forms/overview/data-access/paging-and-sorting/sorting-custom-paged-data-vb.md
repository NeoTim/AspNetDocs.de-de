---
uid: web-forms/overview/data-access/paging-and-sorting/sorting-custom-paged-data-vb
title: Sortieren von benutzerdefinierten auslagerenen Daten (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Im vorherigen Tutorial haben Sie erfahren, wie Sie benutzerdefiniertes Paging implementieren, wenn Sie Daten auf einer Webseite darstellen. In diesem Tutorial erfahren Sie, wie Sie das obige erweitern...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: 4823a186-caaf-4116-a318-c7ff4d955ddc
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/sorting-custom-paged-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 934c7558d907611732ae6f04c553bc9e295c569b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78501711"
---
# <a name="sorting-custom-paged-data-vb"></a><span data-ttu-id="2b4d6-104">Sortieren von benutzerdefinierten ausgelagerten Daten (VB)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-104">Sorting Custom Paged Data (VB)</span></span>

<span data-ttu-id="2b4d6-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2b4d6-106">[Beispiel-app herunterladen](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_26_VB.exe) oder [PDF herunterladen](sorting-custom-paged-data-vb/_static/datatutorial26vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_26_VB.exe) or [Download PDF](sorting-custom-paged-data-vb/_static/datatutorial26vb1.pdf)</span></span>

> <span data-ttu-id="2b4d6-107">Im vorherigen Tutorial haben Sie erfahren, wie Sie benutzerdefiniertes Paging implementieren, wenn Sie Daten auf einer Webseite darstellen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-107">In the previous tutorial we learned how to implement custom paging when presenting data on a web page.</span></span> <span data-ttu-id="2b4d6-108">In diesem Tutorial erfahren Sie, wie Sie das vorherige Beispiel erweitern, um die Unterstützung für das Sortieren von benutzerdefiniertem Paging zu bieten</span><span class="sxs-lookup"><span data-stu-id="2b4d6-108">In this tutorial we see how to extend the preceding example to include support for sorting custom paging.</span></span>

## <a name="introduction"></a><span data-ttu-id="2b4d6-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="2b4d6-109">Introduction</span></span>

<span data-ttu-id="2b4d6-110">Im Vergleich zum Standard-Paging kann durch benutzerdefiniertes Paging die Leistung beim Paging durch Daten um verschiedene Größenordnungen verbessert werden. Dadurch wird das benutzerdefinierte Paging beim Paging durch große Datenmengen zur Deserialisierung der Auslagerungs Auswahl.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-110">Compared to default paging, custom paging can improve the performance of paging through data by several orders of magnitude, making custom paging the de facto paging implementation choice when paging through large amounts of data.</span></span> <span data-ttu-id="2b4d6-111">Das Implementieren von benutzerdefiniertem Paging ist besser als die Implementierung der standardpaginierung, insbesondere beim Hinzufügen von Sortierungen zur Mischung.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-111">Implementing custom paging is more involved than implementing default paging, however, especially when adding sorting to the mix.</span></span> <span data-ttu-id="2b4d6-112">In diesem Tutorial erweitern wir das Beispiel aus dem vorherigen Beispiel, um Unterstützung für das Sortieren *und* das benutzerdefinierte Paging zu bieten.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-112">In this tutorial we'll extend the example from the preceding one to include support for sorting *and* custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="2b4d6-113">Da dieses Lernprogramm auf dem vorhergehenden erstellt wird, müssen Sie zunächst die deklarative Syntax in das `<asp:Content>`-Element von der vorherigen Tutorial s-Webseite (`EfficientPaging.aspx`) kopieren und zwischen dem `<asp:Content>`-Element auf der `SortParameter.aspx` Seite einfügen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-113">Since this tutorial builds upon the preceding one, before beginning take a moment to copy the declarative syntax within the `<asp:Content>` element from the preceding tutorial s web page (`EfficientPaging.aspx`) and paste it between the `<asp:Content>` element in the `SortParameter.aspx` page.</span></span> <span data-ttu-id="2b4d6-114">Eine ausführlichere Erläuterung zur Replikation der Funktionalität einer ASP.NET-Seite finden Sie in Schritt 1 des Tutorials [Hinzufügen von Validierungs Steuerelementen zum Bearbeitungs-und einfügeschnittstellen-](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-114">Refer back to Step 1 of the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for a more detailed discussion on replicating the functionality of one ASP.NET page to another.</span></span>

## <a name="step-1-reexamining-the-custom-paging-technique"></a><span data-ttu-id="2b4d6-115">Schritt 1: Untersuchen des benutzerdefinierten pagingverfahrens</span><span class="sxs-lookup"><span data-stu-id="2b4d6-115">Step 1: Reexamining the Custom Paging Technique</span></span>

<span data-ttu-id="2b4d6-116">Damit das benutzerdefinierte Paging ordnungsgemäß funktioniert, müssen wir einige Techniken implementieren, die eine bestimmte Teilmenge von Datensätzen mit den Parametern "Start Row Index" und "Maximum rows" effizient erfassen können.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-116">For custom paging to work properly, we must implement some technique that can efficiently grab a particular subset of records given the Start Row Index and Maximum Rows parameters.</span></span> <span data-ttu-id="2b4d6-117">Es gibt eine Reihe von Techniken, die dazu verwendet werden können, dieses Ziel zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-117">There are a handful of techniques that can be used to achieve this aim.</span></span> <span data-ttu-id="2b4d6-118">Im vorherigen Tutorial haben wir uns mit dem Erreichen dieser Funktion mit der neuen `ROW_NUMBER()` Rang Folge Funktion von Microsoft SQL Server 2005 befasst.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-118">In the preceding tutorial we looked at accomplishing this using Microsoft SQL Server 2005 s new `ROW_NUMBER()` ranking function.</span></span> <span data-ttu-id="2b4d6-119">Kurz gesagt, weist die `ROW_NUMBER()` Rang Folge Funktion jeder Zeile, die von einer Abfrage zurückgegeben wird, die nach einer angegebenen Sortierreihenfolge sortiert wird, eine Zeilennummer zu.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-119">In short, the `ROW_NUMBER()` ranking function assigns a row number to each row returned by a query that is ranked by a specified sort order.</span></span> <span data-ttu-id="2b4d6-120">Die entsprechende Teilmenge der Datensätze wird dann abgerufen, indem ein bestimmter Abschnitt der nummerierten Ergebnisse zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-120">The appropriate subset of records is then obtained by returning a particular section of the numbered results.</span></span> <span data-ttu-id="2b4d6-121">Die folgende Abfrage veranschaulicht, wie diese Methode verwendet wird, um die Produkte 11 bis 20 zurückzugeben, wenn die Ergebnisse alphabetisch nach dem `ProductName`geordnet werden:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-121">The following query illustrates how to use this technique to return those products numbered 11 through 20 when ranking the results ordered alphabetically by the `ProductName`:</span></span>

[!code-sql[Main](sorting-custom-paged-data-vb/samples/sample1.sql)]

<span data-ttu-id="2b4d6-122">Dieses Verfahren eignet sich gut für das Paging mit einer bestimmten Sortierreihenfolge (in diesem Fall`ProductName` alphabetisch sortiert). die Abfrage muss jedoch geändert werden, um die Ergebnisse nach einem anderen Sortier Ausdruck sortieren zu können.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-122">This technique works well for paging using a specific sort order (`ProductName` sorted alphabetically, in this case), but the query needs to be modified to show the results sorted by a different sort expression.</span></span> <span data-ttu-id="2b4d6-123">Im Idealfall könnte die obige Abfrage so umgeschrieben werden, dass Sie einen Parameter in der `OVER`-Klausel wie folgt verwendet:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-123">Ideally, the above query could be rewritten to use a parameter in the `OVER` clause, like so:</span></span>

[!code-sql[Main](sorting-custom-paged-data-vb/samples/sample2.sql)]

<span data-ttu-id="2b4d6-124">Leider sind parametrisierte `ORDER BY` Klauseln nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-124">Unfortunately, parameterized `ORDER BY` clauses are not allowed.</span></span> <span data-ttu-id="2b4d6-125">Stattdessen müssen Sie eine gespeicherte Prozedur erstellen, die einen `@sortExpression` Eingabeparameter akzeptiert, aber eine der folgenden Problem Umgehungen verwendet:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-125">Instead, we must create a stored procedure that accepts a `@sortExpression` input parameter, but uses one of the following workarounds:</span></span>

- <span data-ttu-id="2b4d6-126">Schreiben Sie hart codierte Abfragen für jeden Sortier Ausdruck, der verwendet werden kann. Verwenden Sie dann `IF/ELSE` t-SQL-Anweisungen, um zu bestimmen, welche Abfrage ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-126">Write hard-coded queries for each of the sort expressions that may be used; then, use `IF/ELSE` T-SQL statements to determine which query to execute.</span></span>
- <span data-ttu-id="2b4d6-127">Verwenden Sie eine `CASE`-Anweisung, um dynamische `ORDER BY` Ausdrücke basierend auf dem `@sortExpressio` n-Eingabeparameter bereitzustellen. Weitere Informationen finden Sie im Abschnitt Verwenden von zum dynamischen Sortieren von Abfrage Ergebnissen in [der Leistungsfähigkeit von SQL `CASE`-Anweisungen](http://www.4guysfromrolla.com/webtech/102704-1.shtml) .</span><span class="sxs-lookup"><span data-stu-id="2b4d6-127">Use a `CASE` statement to provide dynamic `ORDER BY` expressions based on the `@sortExpressio` n input parameter; see the Used to Dynamically Sort Query Results section in [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml) for more information.</span></span>
- <span data-ttu-id="2b4d6-128">Erstellen Sie die entsprechende Abfrage als Zeichenfolge in der gespeicherten Prozedur, und verwenden Sie dann [die gespeicherte System Prozedur `sp_executesql`](https://msdn.microsoft.com/library/ms188001.aspx) , um die dynamische Abfrage auszuführen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-128">Craft the appropriate query as a string in the stored procedure and then use [the `sp_executesql` system stored procedure](https://msdn.microsoft.com/library/ms188001.aspx) to execute the dynamic query.</span></span>

<span data-ttu-id="2b4d6-129">Jede dieser Problem Umgehungen hat einige Nachteile.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-129">Each of these workarounds has some drawbacks.</span></span> <span data-ttu-id="2b4d6-130">Die erste Option ist nicht so verwaltbar wie die anderen beiden, da Sie erfordert, dass Sie für jeden möglichen Sortier Ausdruck eine Abfrage erstellen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-130">The first option is not as maintainable as the other two as it requires that you create a query for each possible sort expression.</span></span> <span data-ttu-id="2b4d6-131">Wenn Sie sich später entscheiden, der GridView neue sortierbare Felder hinzuzufügen, müssen Sie die gespeicherte Prozedur ebenfalls aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-131">Therefore, if later you decide to add new, sortable fields to the GridView you will also need to go back and update the stored procedure.</span></span> <span data-ttu-id="2b4d6-132">Der zweite Ansatz bietet einige Feinheiten, die beim Sortieren von Daten Bank Spalten, die keine Zeichenfolge sind, zu Leistungsproblemen führen und auch die gleichen wart barkeits Probleme wie die erste haben.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-132">The second approach has some subtleties that introduce performance concerns when sorting by non-string database columns and also suffers from the same maintainability issues as the first.</span></span> <span data-ttu-id="2b4d6-133">Und die dritte Auswahl, die dynamisches SQL verwendet, stellt das Risiko für einen SQL-Injection-Angriff vor, wenn ein Angreifer die gespeicherte Prozedur ausführen und die Eingabeparameter Werte Ihrer Wahl übergeben kann.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-133">And the third choice, which uses dynamic SQL, introduces the risk for a SQL injection attack if an attacker is able to execute the stored procedure passing in the input parameter values of their choosing.</span></span>

<span data-ttu-id="2b4d6-134">Obwohl keiner dieser Ansätze perfekt ist, denke ich, dass die dritte Option die beste der drei Optionen ist.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-134">While none of these approaches is perfect, I think the third option is the best of the three.</span></span> <span data-ttu-id="2b4d6-135">Durch die Verwendung von dynamischem SQL bietet das Unternehmen eine höhere Flexibilität.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-135">With its use of dynamic SQL, it offers a level of flexibility the other two do not.</span></span> <span data-ttu-id="2b4d6-136">Außerdem kann ein SQL-einschleusungs Angriff nur ausgenutzt werden, wenn ein Angreifer die gespeicherte Prozedur ausführen kann, die die Eingabeparameter seiner Wahl übergibt.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-136">Furthermore, a SQL injection attack can only be exploited if an attacker is able to execute the stored procedure passing in the input parameters of his choice.</span></span> <span data-ttu-id="2b4d6-137">Da in der dal parametrisierte Abfragen verwendet werden, schützt ADO.net die Parameter, die über die Architektur an die Datenbank gesendet werden. das bedeutet, dass das Sicherheitsrisiko des SQL-Injection-Angriffs nur vorhanden ist, wenn der Angreifer die gespeicherte Prozedur direkt ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-137">Since the DAL uses parameterized queries, ADO.NET will protect those parameters that are sent to the database through the architecture, meaning that the SQL injection attack vulnerability only exists if the attacker can directly execute the stored procedure.</span></span>

<span data-ttu-id="2b4d6-138">Um diese Funktionalität zu implementieren, erstellen Sie eine neue gespeicherte Prozedur in der Northwind-Datenbank mit dem Namen `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-138">To implement this functionality, create a new stored procedure in the Northwind database named `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="2b4d6-139">Diese gespeicherte Prozedur sollte drei Eingabeparameter akzeptieren: `@sortExpression`, einen Eingabeparameter vom Typ `nvarchar(100`), der angibt, wie die Ergebnisse sortiert werden sollen und direkt nach dem `ORDER BY` Text in der `OVER`-Klausel eingefügt werden. und `@startRowIndex` und `@maximumRows`die gleichen beiden ganzzahligen Eingabeparameter aus der gespeicherten Prozedur `GetProductsPaged`, die im vorherigen Tutorial untersucht wurde.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-139">This stored procedure should accept three input parameters: `@sortExpression`, an input parameter of type `nvarchar(100`) that specifies how the results should be sorted and is injected directly after the `ORDER BY` text in the `OVER` clause; and `@startRowIndex` and `@maximumRows`, the same two integer input parameters from the `GetProductsPaged` stored procedure examined in the preceding tutorial.</span></span> <span data-ttu-id="2b4d6-140">Erstellen Sie die gespeicherte Prozedur `GetProductsPagedAndSorted` mithilfe des folgenden Skripts:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-140">Create the `GetProductsPagedAndSorted` stored procedure using the following script:</span></span>

[!code-sql[Main](sorting-custom-paged-data-vb/samples/sample3.sql)]

<span data-ttu-id="2b4d6-141">Die gespeicherte Prozedur beginnt mit dem sicherstellen, dass ein Wert für den `@sortExpression`-Parameter angegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-141">The stored procedure starts by ensuring that a value for the `@sortExpression` parameter has been specified.</span></span> <span data-ttu-id="2b4d6-142">Wenn Sie nicht vorhanden ist, werden die Ergebnisse nach `ProductID`sortiert.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-142">If it is missing, the results are ranked by `ProductID`.</span></span> <span data-ttu-id="2b4d6-143">Im nächsten Schritt wird die dynamische SQL-Abfrage erstellt.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-143">Next, the dynamic SQL query is constructed.</span></span> <span data-ttu-id="2b4d6-144">Beachten Sie, dass die dynamische SQL-Abfrage hier geringfügig von den vorherigen Abfragen abweicht, die zum Abrufen aller Zeilen aus der Products-Tabelle verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-144">Note that the dynamic SQL query here differs slightly from our previous queries used to retrieve all rows from the Products table.</span></span> <span data-ttu-id="2b4d6-145">In den vorherigen Beispielen haben wir die Namen der Kategorie s und Lieferanten-e mithilfe einer Unterabfrage abgerufen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-145">In prior examples, we obtained each product s associated category s and supplier s names using a subquery.</span></span> <span data-ttu-id="2b4d6-146">Diese Entscheidung wurde im Lernprogramm zum [Erstellen einer Datenzugriffs Ebene](../introduction/creating-a-data-access-layer-vb.md) zurückgegeben und wurde anstelle der Verwendung von `JOIN` s vorgenommen, da der TableAdapter nicht automatisch die zugehörigen INSERT-, Update-und Delete-Methoden für solche Abfragen erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-146">This decision was made back in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial and was done in lieu of using `JOIN` s because the TableAdapter cannot automatically create the associated insert, update, and delete methods for such queries.</span></span> <span data-ttu-id="2b4d6-147">Die gespeicherte Prozedur `GetProductsPagedAndSorted` muss jedoch `JOIN` s verwenden, damit die Ergebnisse nach Kategorie-oder Lieferanten Namen sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-147">The `GetProductsPagedAndSorted` stored procedure, however, must use `JOIN` s for the results to be ordered by the category or supplier names.</span></span>

<span data-ttu-id="2b4d6-148">Diese dynamische Abfrage wird erstellt, indem die statischen Abfrage Teile und die Parameter `@sortExpression`, `@startRowIndex`und `@maximumRows` verkettet werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-148">This dynamic query is built up by concatenating the static query portions and the `@sortExpression`, `@startRowIndex`, and `@maximumRows` parameters.</span></span> <span data-ttu-id="2b4d6-149">Da `@startRowIndex` und `@maximumRows` ganzzahlige Parameter sind, müssen Sie in nvarchars konvertiert werden, damit Sie ordnungsgemäß verkettet werden können.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-149">Since `@startRowIndex` and `@maximumRows` are integer parameters, they must be converted into nvarchars in order to be correctly concatenated.</span></span> <span data-ttu-id="2b4d6-150">Nachdem diese dynamische SQL-Abfrage erstellt wurde, wird Sie über `sp_executesql`ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-150">Once this dynamic SQL query has been constructed, it is executed via `sp_executesql`.</span></span>

<span data-ttu-id="2b4d6-151">Nehmen Sie sich einen Moment Zeit, um diese gespeicherte Prozedur mit unterschiedlichen Werten für die Parameter `@sortExpression`, `@startRowIndex`und `@maximumRows` zu testen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-151">Take a moment to test this stored procedure with different values for the `@sortExpression`, `@startRowIndex`, and `@maximumRows` parameters.</span></span> <span data-ttu-id="2b4d6-152">Klicken Sie im Server-Explorer mit der rechten Maustaste auf den Namen der gespeicherten Prozedur, und wählen Sie ausführen aus.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-152">From the Server Explorer, right-click on the stored procedure name and choose Execute.</span></span> <span data-ttu-id="2b4d6-153">Dadurch wird das Dialogfeld gespeicherte Prozedur ausführen angezeigt, in das Sie die Eingabeparameter eingeben können (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-153">This will bring up the Run Stored Procedure dialog box into which you can enter the input parameters (see Figure 1).</span></span> <span data-ttu-id="2b4d6-154">Um die Ergebnisse nach Kategorien Amen zu sortieren, verwenden Sie CategoryName für den `@sortExpression` Parameterwert. um nach dem Firmennamen des Lieferanten zu sortieren, verwenden Sie CompanyName.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-154">To sort the results by the category name, use CategoryName for the `@sortExpression` parameter value; to sort by the supplier s company name, use CompanyName.</span></span> <span data-ttu-id="2b4d6-155">Nachdem Sie die Parameterwerte angegeben haben, klicken Sie auf OK.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-155">After providing the parameters values, click OK.</span></span> <span data-ttu-id="2b4d6-156">Die Ergebnisse werden im Fenster Ausgabe angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-156">The results are displayed in the Output window.</span></span> <span data-ttu-id="2b4d6-157">Abbildung 2 zeigt die Ergebnisse bei der Rückgabe von Produkten in der Rangfolge 11 bis 20, wenn die Sortierung nach dem `UnitPrice` in absteigender Reihenfolge</span><span class="sxs-lookup"><span data-stu-id="2b4d6-157">Figure 2 shows the results when returning products ranked 11 through 20 when ordering by the `UnitPrice` in descending order.</span></span>

![Verwenden Sie unterschiedliche Werte für die drei Eingabeparameter der gespeicherten Prozedur.](sorting-custom-paged-data-vb/_static/image1.png)

<span data-ttu-id="2b4d6-159">**Abbildung 1**: ausprobieren von unterschiedlichen Werten für die drei Eingabeparameter der gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="2b4d6-159">**Figure 1**: Try Different Values for the Stored Procedure s Three Input Parameters</span></span>

<span data-ttu-id="2b4d6-160">[![werden die Ergebnisse der gespeicherten Prozedur in der Ausgabefenster angezeigt.](sorting-custom-paged-data-vb/_static/image3.png)](sorting-custom-paged-data-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-160">[![The Stored Procedure s Results are Shown in the Output Window](sorting-custom-paged-data-vb/_static/image3.png)](sorting-custom-paged-data-vb/_static/image2.png)</span></span>

<span data-ttu-id="2b4d6-161">**Abbildung 2**: die Ergebnisse der gespeicherten Prozeduren werden in der Ausgabefenster angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](sorting-custom-paged-data-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="2b4d6-161">**Figure 2**: The Stored Procedure s Results are Shown in the Output Window ([Click to view full-size image](sorting-custom-paged-data-vb/_static/image4.png))</span></span>

> [!NOTE]
> <span data-ttu-id="2b4d6-162">Wenn die Ergebnisse mit der angegebenen `ORDER BY` Spalte in der `OVER`-Klausel sortiert werden, müssen die Ergebnisse von SQL Server sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-162">When ranking the results by the specified `ORDER BY` column in the `OVER` clause, SQL Server must sort the results.</span></span> <span data-ttu-id="2b4d6-163">Dies ist ein schneller Vorgang, wenn ein gruppierter Index für die Spalten vorhanden ist, nach denen die Ergebnisse geordnet werden, oder wenn es einen Abdeck enden Index gibt, der andernfalls kostengünstiger sein kann.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-163">This is a quick operation if there is a clustered index over the column(s) the results are being ordered by or if there is a covering index, but can be more costly otherwise.</span></span> <span data-ttu-id="2b4d6-164">Um die Leistung für ausreichend große Abfragen zu verbessern, sollten Sie einen nicht gruppierten Index für die Spalte hinzufügen, nach der die Ergebnisse geordnet sind.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-164">To improve performance for sufficiently large queries, consider adding a non-clustered index for the column by which the results are ordered by.</span></span> <span data-ttu-id="2b4d6-165">Weitere Informationen finden Sie unter [Rang Folge Funktionen und Leistung in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) .</span><span class="sxs-lookup"><span data-stu-id="2b4d6-165">Refer to [Ranking Functions and Performance in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) for more details.</span></span>

## <a name="step-2-augmenting-the-data-access-and-business-logic-layers"></a><span data-ttu-id="2b4d6-166">Schritt 2: Erweitern der Datenzugriffs-und Geschäftslogik Ebenen</span><span class="sxs-lookup"><span data-stu-id="2b4d6-166">Step 2: Augmenting the Data Access and Business Logic Layers</span></span>

<span data-ttu-id="2b4d6-167">Wenn die gespeicherte Prozedur `GetProductsPagedAndSorted` erstellt wurde, besteht der nächste Schritt darin, eine Möglichkeit zum Ausführen dieser gespeicherten Prozedur über unsere Anwendungsarchitektur bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-167">With the `GetProductsPagedAndSorted` stored procedure created, our next step is to provide a means to execute that stored procedure through our application architecture.</span></span> <span data-ttu-id="2b4d6-168">Dies umfasst das Hinzufügen einer entsprechenden Methode zu dal und BLL.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-168">This entails adding an appropriate method to both the DAL and BLL.</span></span> <span data-ttu-id="2b4d6-169">Beginnen Sie, indem Sie der dal eine Methode hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-169">Let s start by adding a method to the DAL.</span></span> <span data-ttu-id="2b4d6-170">Öffnen Sie das `Northwind.xsd` typisierte DataSet, klicken Sie mit der rechten Maustaste auf die `ProductsTableAdapter`, und wählen Sie im Kontextmenü die Option Abfrage hinzufügen aus.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-170">Open the `Northwind.xsd` Typed DataSet, right-click on the `ProductsTableAdapter`, and choose the Add Query option from the context menu.</span></span> <span data-ttu-id="2b4d6-171">Wie bereits im vorherigen Tutorial beschrieben, möchten wir diese neue dal-Methode so konfigurieren, dass Sie eine vorhandene gespeicherte Prozedur `GetProductsPagedAndSorted`verwendet, in diesem Fall.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-171">As we did in the preceding tutorial, we want to configure this new DAL method to use an existing stored procedure - `GetProductsPagedAndSorted`, in this case.</span></span> <span data-ttu-id="2b4d6-172">Beginnen Sie mit der Angabe, dass die neue TableAdapter-Methode eine vorhandene gespeicherte Prozedur verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-172">Start by indicating that you want the new TableAdapter method to use an existing stored procedure.</span></span>

![Wählen Sie eine vorhandene gespeicherte Prozedur aus.](sorting-custom-paged-data-vb/_static/image5.png)

<span data-ttu-id="2b4d6-174">**Abbildung 3**: Auswählen der Verwendung einer vorhandenen gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="2b4d6-174">**Figure 3**: Choose to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="2b4d6-175">Um die zu verwendende gespeicherte Prozedur anzugeben, wählen Sie die gespeicherte Prozedur `GetProductsPagedAndSorted` aus der Dropdown Liste auf dem nächsten Bildschirm aus.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-175">To specify the stored procedure to use, select the `GetProductsPagedAndSorted` stored procedure from the drop-down list in the next screen.</span></span>

![Verwenden Sie die gespeicherte Prozedur getproductspagedandsortierte.](sorting-custom-paged-data-vb/_static/image6.png)

<span data-ttu-id="2b4d6-177">**Abbildung 4**: Verwenden der gespeicherten Prozedur getproductspagedandsortierte</span><span class="sxs-lookup"><span data-stu-id="2b4d6-177">**Figure 4**: Use the GetProductsPagedAndSorted Stored Procedure</span></span>

<span data-ttu-id="2b4d6-178">Diese gespeicherte Prozedur gibt eine Reihe von Datensätzen als Ergebnisse zurück, sodass auf dem nächsten Bildschirm angezeigt wird, dass Tabellendaten zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-178">This stored procedure returns a set of records as its results so, in the next screen, indicate that it returns tabular data.</span></span>

![Gibt an, dass die gespeicherte Prozedur Tabellendaten zurückgibt.](sorting-custom-paged-data-vb/_static/image7.png)

<span data-ttu-id="2b4d6-180">**Abbildung 5**: angeben, dass die gespeicherte Prozedur Tabellendaten zurückgibt</span><span class="sxs-lookup"><span data-stu-id="2b4d6-180">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data</span></span>

<span data-ttu-id="2b4d6-181">Erstellen Sie schließlich Dal-Methoden, die sowohl das Fill a datdatababel-Steuer Muster als auch ein Datentabelle zurückgeben, indem Sie die Methoden `FillPagedAndSorted` und `GetProductsPagedAndSorted`benennen.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-181">Finally, create DAL methods that use both the Fill a DataTable and Return a DataTable patterns, naming the methods `FillPagedAndSorted` and `GetProductsPagedAndSorted`, respectively.</span></span>

![Methodennamen auswählen](sorting-custom-paged-data-vb/_static/image8.png)

<span data-ttu-id="2b4d6-183">**Abbildung 6**: Auswählen der Methodennamen</span><span class="sxs-lookup"><span data-stu-id="2b4d6-183">**Figure 6**: Choose the Methods Names</span></span>

<span data-ttu-id="2b4d6-184">Nun, da wir die DAL erweitert haben, sind wir bereit, auf den BLL zu schalten.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-184">Now that we ve extended the DAL, we re ready to turn to the BLL.</span></span> <span data-ttu-id="2b4d6-185">Öffnen Sie die Datei `ProductsBLL`-Klasse, und fügen Sie eine neue Methode hinzu, `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-185">Open the `ProductsBLL` class file and add a new method, `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="2b4d6-186">Diese Methode muss drei Eingabeparameter `sortExpression`, `startRowIndex`und `maximumRows` akzeptieren und sollte einfach die Methode `GetProductsPagedAndSorted` der dal-Methode wie folgt aufzurufen:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-186">This method needs to accept three input parameters `sortExpression`, `startRowIndex`, and `maximumRows` and should simply call down into the DAL s `GetProductsPagedAndSorted` method, like so:</span></span>

[!code-vb[Main](sorting-custom-paged-data-vb/samples/sample4.vb)]

## <a name="step-3-configuring-the-objectdatasource-to-pass-in-the-sortexpression-parameter"></a><span data-ttu-id="2b4d6-187">Schritt 3: Konfigurieren von ObjectDataSource für die Übergabe in den SortExpression-Parameter</span><span class="sxs-lookup"><span data-stu-id="2b4d6-187">Step 3: Configuring the ObjectDataSource to Pass in the SortExpression Parameter</span></span>

<span data-ttu-id="2b4d6-188">Wenn Sie die DAL und BLL so erweitert haben, dass Sie Methoden enthalten, die die gespeicherte Prozedur `GetProductsPagedAndSorted` verwenden, müssen Sie nur noch die ObjectDataSource auf der `SortParameter.aspx` Seite so konfigurieren, dass die neue BLL-Methode verwendet wird, und Sie können den `SortExpression`-Parameter basierend auf der Spalte übergeben, die der Benutzer zum Sortieren der Ergebnisse angefordert hat.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-188">Having augmented the DAL and BLL to include methods that utilize the `GetProductsPagedAndSorted` stored procedure, all that remains is to configure the ObjectDataSource in the `SortParameter.aspx` page to use the new BLL method and to pass in the `SortExpression` parameter based on the column that the user has requested to sort the results by.</span></span>

<span data-ttu-id="2b4d6-189">Ändern Sie zunächst die `SelectMethod` ObjectDataSource s von `GetProductsPaged` in `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-189">Start by changing the ObjectDataSource s `SelectMethod` from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span> <span data-ttu-id="2b4d6-190">Dies kann über den Assistenten zum Konfigurieren von Datenquellen, über das Eigenschaftenfenster oder direkt über die deklarative Syntax durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-190">This can be done through the Configure Data Source wizard, from the Properties window, or directly through the declarative syntax.</span></span> <span data-ttu-id="2b4d6-191">Als nächstes müssen wir einen Wert für die ObjectDataSource s`SortParameterName`- [Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sortparametername.aspx)angeben.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-191">Next, we need to provide a value for the ObjectDataSource s [`SortParameterName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sortparametername.aspx).</span></span> <span data-ttu-id="2b4d6-192">Wenn diese Eigenschaft festgelegt ist, versucht ObjectDataSource, die GridView s `SortExpression`-Eigenschaft an die `SelectMethod`zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-192">If this property is set, the ObjectDataSource attempts to pass in the GridView s `SortExpression` property to the `SelectMethod`.</span></span> <span data-ttu-id="2b4d6-193">Insbesondere sucht ObjectDataSource nach einem Eingabeparameter, dessen Name gleich dem Wert der `SortParameterName`-Eigenschaft ist.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-193">In particular, the ObjectDataSource looks for an input parameter whose name is equal to the value of the `SortParameterName` property.</span></span> <span data-ttu-id="2b4d6-194">Da die BLL s-`GetProductsPagedAndSorted` Methode den Eingabeparameter des Sortier Ausdrucks namens `sortExpression`aufweist, legen Sie die Eigenschaft ObjectDataSource s `SortExpression` auf SortExpression fest.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-194">Since the BLL s `GetProductsPagedAndSorted` method has the sort expression input parameter named `sortExpression`, set the ObjectDataSource s `SortExpression` property to sortExpression .</span></span>

<span data-ttu-id="2b4d6-195">Nachdem Sie diese beiden Änderungen vorgenommen haben, sollte die deklarative Syntax von ObjectDataSource s in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-195">After making these two changes, the ObjectDataSource s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](sorting-custom-paged-data-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="2b4d6-196">Stellen Sie wie im vorherigen Tutorial sicher, dass ObjectDataSource die Eingabeparameter SortExpression, StartRowIndex oder MaximumRows *nicht* in der SelectParameters-Auflistung enthält.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-196">As with the preceding tutorial, ensure that the ObjectDataSource does *not* include the sortExpression, startRowIndex, or maximumRows input parameters in its SelectParameters collection.</span></span>

<span data-ttu-id="2b4d6-197">Aktivieren Sie zum Aktivieren der Sortierung in der GridView einfach das Kontrollkästchen Sortierung aktivieren im GridView s-Smarttag, das die GridView s `AllowSorting`-Eigenschaft auf `true` festlegt und bewirkt, dass der Header Text für jede Spalte als LinkButton gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-197">To enable sorting in the GridView, simply check the Enable Sorting checkbox in the GridView s smart tag, which sets the GridView s `AllowSorting` property to `true` and causing the header text for each column to be rendered as a LinkButton.</span></span> <span data-ttu-id="2b4d6-198">Wenn der Endbenutzer auf eine der Header Link Schaltflächen klickt, wird ein Postback ausgeführt, und die folgenden Schritte werden erneut ausgeführt:</span><span class="sxs-lookup"><span data-stu-id="2b4d6-198">When the end user clicks on one of the header LinkButtons, a postback ensues and the following steps transpire:</span></span>

1. <span data-ttu-id="2b4d6-199">Die GridView aktualisiert die [`SortExpression`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) auf den Wert des `SortExpression` des Felds, auf das geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-199">The GridView updates its [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) to the value of the `SortExpression` of the field whose header link was clicked</span></span>
2. <span data-ttu-id="2b4d6-200">Die ObjectDataSource Ruft die `GetProductsPagedAndSorted`-Methode der BLL s auf und übergibt die GridView s `SortExpression`-Eigenschaft als Wert für die `sortExpression` Eingabeparameter der Methode (zusammen mit den entsprechenden `startRowIndex`-und `maximumRows` Eingabeparameter Werten).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-200">The ObjectDataSource invokes the BLL s `GetProductsPagedAndSorted` method, passing in the GridView s `SortExpression` property as the value for the method s `sortExpression` input parameter (along with the appropriate `startRowIndex` and `maximumRows` input parameter values)</span></span>
3. <span data-ttu-id="2b4d6-201">Die BLL Ruft die DAL s-`GetProductsPagedAndSorted` Methode auf.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-201">The BLL invokes the DAL s `GetProductsPagedAndSorted` method</span></span>
4. <span data-ttu-id="2b4d6-202">Die DAL führt die gespeicherte Prozedur `GetProductsPagedAndSorted` aus und übergibt dabei den `@sortExpression` Parameter (zusammen mit den `@startRowIndex` und `@maximumRows` Eingabeparameter Werten).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-202">The DAL executes the `GetProductsPagedAndSorted` stored procedure, passing in the `@sortExpression` parameter (along with the `@startRowIndex` and `@maximumRows` input parameter values)</span></span>
5. <span data-ttu-id="2b4d6-203">Die gespeicherte Prozedur gibt die entsprechende Teilmenge der Daten an die BLL zurück, die Sie an die ObjectDataSource zurückgibt. Diese Daten werden dann an die GridView gebunden, in HTML gerendert und an den Endbenutzer gesendet.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-203">The stored procedure returns the appropriate subset of data to the BLL, which returns it to the ObjectDataSource; this data is then bound to the GridView, rendered into HTML, and sent down to the end user</span></span>

<span data-ttu-id="2b4d6-204">Abbildung 7 zeigt die erste Seite der Ergebnisse, wenn Sie nach dem `UnitPrice` in aufsteigender Reihenfolge sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-204">Figure 7 shows the first page of results when sorted by the `UnitPrice` in ascending order.</span></span>

<span data-ttu-id="2b4d6-205">[![werden die Ergebnisse nach UnitPrice sortiert.](sorting-custom-paged-data-vb/_static/image10.png)](sorting-custom-paged-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-205">[![The Results are Sorted by the UnitPrice](sorting-custom-paged-data-vb/_static/image10.png)](sorting-custom-paged-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="2b4d6-206">**Abbildung 7**: die Ergebnisse werden nach UnitPrice sortiert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](sorting-custom-paged-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="2b4d6-206">**Figure 7**: The Results are Sorted by the UnitPrice ([Click to view full-size image](sorting-custom-paged-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="2b4d6-207">Obwohl die aktuelle Implementierung die Ergebnisse nach Produktname, Kategoriename, Menge pro Einheit und Einheitspreis ordnungsgemäß sortieren kann, führt der Versuch, die Ergebnisse nach dem Lieferanten Namen zu sortieren, zu einer Lauf Zeit Ausnahme (siehe Abbildung 8).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-207">While the current implementation can correctly sort the results by product name, category name, quantity per unit, and unit price, attempting to order the results by the supplier name results in a runtime exception (see Figure 8).</span></span>

![Der Versuch, die Ergebnisse nach dem Lieferanten zu sortieren, führt zu der folgenden Lauf Zeit Ausnahme.](sorting-custom-paged-data-vb/_static/image12.png)

<span data-ttu-id="2b4d6-209">**Abbildung 8**: der Versuch, die Ergebnisse nach dem Lieferanten zu sortieren, führt zu der folgenden Lauf Zeit Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-209">**Figure 8**: Attempting to Sort the Results by the Supplier Results in the Following Runtime Exception</span></span>

<span data-ttu-id="2b4d6-210">Diese Ausnahme tritt auf, weil die `SortExpression` von GridView s `SupplierName` BoundField auf `SupplierName`festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-210">This exception occurs because the `SortExpression` of the GridView s `SupplierName` BoundField is set to `SupplierName`.</span></span> <span data-ttu-id="2b4d6-211">Allerdings wird der Name des Lieferanten in der `Suppliers` Tabelle tatsächlich aufgerufen, `CompanyName` wir als Alias für diesen Spaltennamen `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-211">However, the supplier s name in the `Suppliers` table is actually called `CompanyName` we have been aliased this column name as `SupplierName`.</span></span> <span data-ttu-id="2b4d6-212">Die von der `ROW_NUMBER()`-Funktion verwendete `OVER`-Klausel kann den Alias jedoch nicht verwenden und muss den tatsächlichen Spaltennamen verwenden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-212">However, the `OVER` clause used by the `ROW_NUMBER()` function cannot use the alias and must use the actual column name.</span></span> <span data-ttu-id="2b4d6-213">Ändern Sie daher die `SupplierName` BoundField s-`SortExpression` von suppliername in CompanyName (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-213">Therefore, change the `SupplierName` BoundField s `SortExpression` from SupplierName to CompanyName (see Figure 9).</span></span> <span data-ttu-id="2b4d6-214">Wie in Abbildung 10 gezeigt, können die Ergebnisse nach dieser Änderung nach dem Lieferanten sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-214">As Figure 10 shows, after this change the results can be sorted by the supplier.</span></span>

!["Suppliername BoundField s SortExpression" in "CompanyName" ändern](sorting-custom-paged-data-vb/_static/image13.png)

<span data-ttu-id="2b4d6-216">**Abbildung 9**: Ändern des suppfield s "suppliername BoundField s SortExpression" in "CompanyName"</span><span class="sxs-lookup"><span data-stu-id="2b4d6-216">**Figure 9**: Change the SupplierName BoundField s SortExpression to CompanyName</span></span>

<span data-ttu-id="2b4d6-217">[![die Ergebnisse können jetzt nach Lieferant sortiert werden.](sorting-custom-paged-data-vb/_static/image15.png)](sorting-custom-paged-data-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-217">[![The Results Can Now Be Sorted by Supplier](sorting-custom-paged-data-vb/_static/image15.png)](sorting-custom-paged-data-vb/_static/image14.png)</span></span>

<span data-ttu-id="2b4d6-218">**Abbildung 10**: die Ergebnisse können jetzt nach Lieferant sortiert werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](sorting-custom-paged-data-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="2b4d6-218">**Figure 10**: The Results Can Now Be Sorted by Supplier ([Click to view full-size image](sorting-custom-paged-data-vb/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="2b4d6-219">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="2b4d6-219">Summary</span></span>

<span data-ttu-id="2b4d6-220">Die benutzerdefinierte Paginierungs Implementierung, die wir im vorherigen Tutorial überprüft haben, erforderte, dass die Reihenfolge, nach der die Ergebnisse sortiert werden sollen, zur Entwurfszeit angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-220">The custom paging implementation we examined in the preceding tutorial required that the order by which the results were to be sorted be specified at design time.</span></span> <span data-ttu-id="2b4d6-221">Kurz gesagt, dies bedeutete, dass die Implementierung der benutzerdefinierten Paginierung, die wir implementiert haben, nicht gleichzeitig Sortierfunktionen bereitstellen konnte.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-221">In short, this meant that the custom paging implementation we implemented could not, at the same time, provide sorting capabilities.</span></span> <span data-ttu-id="2b4d6-222">In diesem Tutorial haben wir diese Einschränkung überwunden, indem wir die gespeicherte Prozedur von der ersten erweitern, um einen `@sortExpression` Eingabeparameter einzuschließen, mit dem die Ergebnisse sortiert werden könnten.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-222">In this tutorial we overcame this limitation by extending the stored procedure from the first to include a `@sortExpression` input parameter by which the results could be sorted.</span></span>

<span data-ttu-id="2b4d6-223">Nachdem Sie diese gespeicherte Prozedur erstellt und neue Methoden in der dal und der BLL erstellt haben, konnten wir eine GridView implementieren, die sowohl Sortier-als auch benutzerdefinierte Paginierung bot, indem wir die ObjectDataSource so konfigurieren, dass Sie die Eigenschaft "GridView s Current `SortExpression`" an die BLL-`SelectMethod`übergibt.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-223">After creating this stored procedure and creating new methods in the DAL and BLL, we were able to implement a GridView that offered both sorting and custom paging by configuring the ObjectDataSource to pass in the GridView s current `SortExpression` property to the BLL `SelectMethod`.</span></span>

<span data-ttu-id="2b4d6-224">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="2b4d6-224">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2b4d6-225">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="2b4d6-225">About the Author</span></span>

<span data-ttu-id="2b4d6-226">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-226">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2b4d6-227">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-227">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2b4d6-228">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-228">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2b4d6-229">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-229">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2b4d6-230">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2b4d6-230">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2b4d6-231">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="2b4d6-231">Special Thanks To</span></span>

<span data-ttu-id="2b4d6-232">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-232">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2b4d6-233">Lead Reviewer für dieses Tutorial war Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="2b4d6-233">Lead reviewer for this tutorial was Carlos Santos.</span></span> <span data-ttu-id="2b4d6-234">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="2b4d6-234">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2b4d6-235">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-235">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2b4d6-236">[Zurück](efficiently-paging-through-large-amounts-of-data-vb.md)
> [Weiter](creating-a-customized-sorting-user-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2b4d6-236">[Previous](efficiently-paging-through-large-amounts-of-data-vb.md)
[Next](creating-a-customized-sorting-user-interface-vb.md)</span></span>
