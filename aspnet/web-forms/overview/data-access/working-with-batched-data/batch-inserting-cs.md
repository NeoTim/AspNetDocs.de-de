---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
title: Batch einfügen (C#) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie Sie mehrere Datenbankdaten Sätze in einem einzelnen Vorgang einfügen. In der Benutzeroberflächen Ebene erweitern wir die GridView, um dem Benutzer die Eingabe mehrerer n...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: cf025e08-48fc-4385-b176-8610aa7b5565
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
msc.type: authoredcontent
ms.openlocfilehash: 5dc4d0b6ac9bf3aa2baa54fe9f5d4149494e47d2
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78501447"
---
# <a name="batch-inserting-c"></a><span data-ttu-id="d2974-104">Einfügen in Batches (C#)</span><span class="sxs-lookup"><span data-stu-id="d2974-104">Batch Inserting (C#)</span></span>

<span data-ttu-id="d2974-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d2974-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d2974-106">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) oder [PDF herunterladen](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d2974-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) or [Download PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span></span>

> <span data-ttu-id="d2974-107">Erfahren Sie, wie Sie mehrere Datenbankdaten Sätze in einem einzelnen Vorgang einfügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="d2974-108">In der Benutzeroberflächen Ebene erweitern wir die GridView, um dem Benutzer die Eingabe mehrerer neuer Datensätze zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="d2974-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="d2974-109">In der Datenzugriffs Ebene werden mehrere Einfügevorgänge innerhalb einer Transaktion eingeschlossen, um sicherzustellen, dass alle Einfügungen erfolgreich sind oder für alle Einfügungen ein Rollback ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="d2974-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="d2974-110">Introduction</span></span>

<span data-ttu-id="d2974-111">Im Tutorial zum [Batch-Update](batch-updating-cs.md) haben wir uns mit der Anpassung des GridView-Steuer Elements für eine Schnittstelle beschäftigt, bei der mehrere Datensätze bearbeitet werden konnten.</span><span class="sxs-lookup"><span data-stu-id="d2974-111">In the [Batch Updating](batch-updating-cs.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="d2974-112">Der Benutzer, der die Seite besucht, könnte eine Reihe von Änderungen vornehmen und dann mit einem einzigen Klick auf die Schaltfläche ein Batch Update ausführen.</span><span class="sxs-lookup"><span data-stu-id="d2974-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="d2974-113">In Situationen, in denen Benutzer häufig viele Datensätze in einem Go aktualisieren, kann eine solche Schnittstelle unzählige Klicks und Tastatur-zu-Maus-Kontextwechsel im Vergleich zu den standardmäßigen Bearbeitungs Features pro Zeile, die zuerst in der Übersicht über das [Einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) untersucht wurden, speichern.</span><span class="sxs-lookup"><span data-stu-id="d2974-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span></span>

<span data-ttu-id="d2974-114">Dieses Konzept kann auch angewendet werden, wenn Datensätze hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="d2974-115">Stellen Sie sich vor, dass wir bei Northwind Traders häufig Lieferungen von Lieferanten erhalten, die eine Reihe von Produkten für eine bestimmte Kategorie enthalten.</span><span class="sxs-lookup"><span data-stu-id="d2974-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="d2974-116">Beispielsweise erhalten wir möglicherweise eine Lieferung von sechs verschiedenen Tee-und kaffeeprodukten von Tokyo Traders.</span><span class="sxs-lookup"><span data-stu-id="d2974-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="d2974-117">Wenn ein Benutzer die sechs Produkte einzeln über ein DetailsView-Steuerelement eingibt, muss er viele der gleichen Werte immer wieder auswählen: er muss dieselbe Kategorie (Getränke), denselben Lieferanten (Tokyo Traders) und denselben nicht mehr unterstützten Wert auswählen ( False) und die gleichen Einheiten für den Bestellwert (0).</span><span class="sxs-lookup"><span data-stu-id="d2974-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="d2974-118">Dieser wiederkehrende Dateneintrag ist nicht nur zeitaufwändig, sondern fehleranfällig.</span><span class="sxs-lookup"><span data-stu-id="d2974-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="d2974-119">Mit geringem Aufwand können wir eine Schnittstelle für das Einfügen von Batches erstellen, die es dem Benutzer ermöglicht, den Lieferanten und die Kategorie einmalig auszuwählen, eine Reihe von Produktnamen und Preis Einheiten einzugeben und dann auf eine Schaltfläche zu klicken, um die neuen Produkte der Datenbank hinzuzufügen (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="d2974-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="d2974-120">Wenn jedes Produkt hinzugefügt wird, werden die Datenfelder `ProductName` und `UnitPrice` den in den Textfeldern eingegebenen Werten zugewiesen, während deren `CategoryID` und `SupplierID` Werte den Werten aus den Dropdown Listen am oberen Rand des Formulars zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="d2974-121">Die Werte für `Discontinued` und `UnitsOnOrder` werden auf die hart codierten Werte von `false` bzw. 0 festgelegt.</span><span class="sxs-lookup"><span data-stu-id="d2974-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `false` and 0, respectively.</span></span>

<span data-ttu-id="d2974-122">[![der Batch-einfügeschnittstelle](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-122">[![The Batch Inserting Interface](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span></span>

<span data-ttu-id="d2974-123">**Abbildung 1**: die Schnittstelle zum Einfügen[von Batches (Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-cs/_static/image3.png))</span></span>

<span data-ttu-id="d2974-124">In diesem Tutorial erstellen wir eine Seite, auf der die in Abbildung 1 gezeigte Schnittstelle zum Einfügen von Batches implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="d2974-125">Wie bei den vorherigen beiden Tutorials werden die Einfügungen innerhalb des Umfangs einer Transaktion umschlossen, um die Atomizität sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="d2974-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="d2974-126">Legen Sie Los!</span><span class="sxs-lookup"><span data-stu-id="d2974-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="d2974-127">Schritt 1: Erstellen der Anzeige Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="d2974-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="d2974-128">Dieses Tutorial besteht aus einer einzelnen Seite, die in zwei Bereiche unterteilt ist: einem Anzeigebereich und einem Einfügebereich.</span><span class="sxs-lookup"><span data-stu-id="d2974-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="d2974-129">Die Anzeige Schnittstelle, die wir in diesem Schritt erstellen, zeigt die Produkte in einer GridView an und enthält eine Schaltfläche mit dem Namen Process Product Shipping.</span><span class="sxs-lookup"><span data-stu-id="d2974-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="d2974-130">Wenn Sie auf diese Schaltfläche klicken, wird die Anzeige Schnittstelle durch die einfügeschnittstelle ersetzt, die in Abbildung 1 dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="d2974-131">Die Anzeige Schnittstelle wird zurückgegeben, nachdem auf die Schaltflächen Produkte aus Sendung hinzufügen oder Abbrechen geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="d2974-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="d2974-132">Die einfügeschnittstelle wird in Schritt 2 erstellt.</span><span class="sxs-lookup"><span data-stu-id="d2974-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="d2974-133">Beim Erstellen einer Seite mit zwei Schnittstellen, von denen jeweils nur eine sichtbar ist, wird jede Schnittstelle in der Regel in einem [Panel-websteuer](http://www.w3schools.com/aspnet/control_panel.asp)Element platziert, das als Container für andere Steuerelemente fungiert.</span><span class="sxs-lookup"><span data-stu-id="d2974-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="d2974-134">Daher hat unsere Seite zwei Panel-Steuerelemente für jede Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="d2974-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="d2974-135">Öffnen Sie zunächst die Seite `BatchInsert.aspx` im Ordner `BatchData`, und ziehen Sie einen Bereich aus der Toolbox auf den Designer (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="d2974-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="d2974-136">Legen Sie die Eigenschaft Bereich s `ID` auf `DisplayInterface`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="d2974-137">Wenn das Panel dem Designer hinzugefügt wird, werden die Eigenschaften `Height` und `Width` auf 50px bzw. 125 px festgelegt.</span><span class="sxs-lookup"><span data-stu-id="d2974-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="d2974-138">Löschen Sie diese Eigenschaftswerte aus der Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="d2974-138">Clear out these property values from the Properties window.</span></span>

<span data-ttu-id="d2974-139">[![ziehen Sie einen Bereich aus der Toolbox auf den Designer.](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span></span>

<span data-ttu-id="d2974-140">**Abbildung 2**: Ziehen eines Panels aus der Toolbox auf den Designer ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-cs/_static/image6.png))</span></span>

<span data-ttu-id="d2974-141">Ziehen Sie als nächstes ein Schaltflächen-und GridView-Steuerelement in den Bereich.</span><span class="sxs-lookup"><span data-stu-id="d2974-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="d2974-142">Legen Sie die Schaltfläche s `ID`-Eigenschaft auf `ProcessShipment` und deren `Text`-Eigenschaft auf Produktlieferung verarbeiten fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="d2974-143">Legen Sie die Eigenschaft GridView s `ID` auf `ProductsGrid` fest, und binden Sie das Smarttag an eine neue ObjectDataSource mit dem Namen `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d2974-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="d2974-144">Konfigurieren Sie ObjectDataSource so, dass die Daten aus der `ProductsBLL` Klasse `GetProducts` Methode abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="d2974-145">Da diese GridView nur zum Anzeigen von Daten verwendet wird, legen Sie die Dropdown Listen auf den Registerkarten aktualisieren, einfügen und löschen auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="d2974-146">Klicken Sie zum Abschließen des Assistenten zum Konfigurieren von Datenquellen auf Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="d2974-146">Click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="d2974-147">[![Anzeigen der Daten, die von der Methode "GetProducts" der productbll-Klasse zurückgegeben werden](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span></span>

<span data-ttu-id="d2974-148">**Abbildung 3**: Anzeigen der Daten, die von der `ProductsBLL` Klasse `GetProducts`-Methode zurückgegeben werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-cs/_static/image9.png))</span></span>

<span data-ttu-id="d2974-149">[![die Dropdown Listen auf den Registerkarten aktualisieren, einfügen und löschen auf (keine) festgelegt.](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span></span>

<span data-ttu-id="d2974-150">**Abbildung 4**: Festlegen der Dropdown Listen auf den Registerkarten "Aktualisieren", "Einfügen" und "Löschen" auf "(keine)" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-cs/_static/image12.png))</span></span>

<span data-ttu-id="d2974-151">Nachdem Sie den ObjectDataSource-Assistenten abgeschlossen haben, fügt Visual Studio boundfields und ein CheckBoxField für die Product Data-Felder hinzu.</span><span class="sxs-lookup"><span data-stu-id="d2974-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="d2974-152">Entfernen Sie alle Felder außer den Feldern `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`und `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="d2974-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="d2974-153">Sie können jederzeit beliebige ästhetische Anpassungen vornehmen.</span><span class="sxs-lookup"><span data-stu-id="d2974-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="d2974-154">Ich habe mich entschieden, das `UnitPrice`-Feld als Währungswert zu formatieren, die Felder neu angeordnet zu haben und einige Felder `HeaderText` Werte umzubenennen.</span><span class="sxs-lookup"><span data-stu-id="d2974-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="d2974-155">Konfigurieren Sie außerdem die GridView so, dass Paging und Sortier Unterstützung unterstützt werden, indem Sie die Kontrollkästchen Paging aktivieren und Sortierung aktivieren in der GridView s Smarttags aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d2974-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="d2974-156">Nach dem Hinzufügen der Steuerelemente Panel, Button, GridView und ObjectDataSource und Anpassen der GridView s-Felder sollte das deklarative Markup der Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="d2974-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](batch-inserting-cs/samples/sample1.aspx)]

<span data-ttu-id="d2974-157">Beachten Sie, dass das Markup für die Schaltfläche und die GridView innerhalb der öffnenden und schließenden `<asp:Panel>` Tags angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="d2974-158">Da sich diese Steuerelemente im `DisplayInterface` Panel befinden, können Sie diese ausblenden, indem Sie einfach die Eigenschaft `Visible` des Bereichs s auf `false`festlegen.</span><span class="sxs-lookup"><span data-stu-id="d2974-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `false`.</span></span> <span data-ttu-id="d2974-159">In Schritt 3 wird das programmgesteuerte Ändern der Panel s-`Visible` Eigenschaft als Reaktion auf einen Schaltflächen Klick erläutert, um eine Schnittstelle anzuzeigen, während die andere ausgeblendet wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="d2974-160">Nehmen Sie sich einen Moment Zeit, um den Fortschritt über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="d2974-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="d2974-161">Wie in Abbildung 5 gezeigt, sollte eine Schaltfläche "Produktversand verarbeiten" oberhalb einer GridView angezeigt werden, in der die Produkte jeweils zehn aufgelistet sind.</span><span class="sxs-lookup"><span data-stu-id="d2974-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>

<span data-ttu-id="d2974-162">[![GridView listet die Produkte auf und bietet Sortier-und Pagingfunktionen.](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span></span>

<span data-ttu-id="d2974-163">**Abbildung 5**: die GridView listet die Produkte auf und bietet Sortier-und Pagingfunktionen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-cs/_static/image15.png))</span></span>

## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="d2974-164">Schritt 2: Erstellen der einfügeschnittstelle</span><span class="sxs-lookup"><span data-stu-id="d2974-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="d2974-165">Nachdem die Anzeige Schnittstelle abgeschlossen ist, können Sie die einfügeschnittstelle neu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d2974-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="d2974-166">In diesem Tutorial erstellen Sie eine einfügeschnittstelle, die zur Eingabe eines einzelnen Lieferanten-und Kategoriewerts auffordert und dem Benutzer dann ermöglicht, bis zu fünf Produktnamen und Einheiten preiswerte einzugeben.</span><span class="sxs-lookup"><span data-stu-id="d2974-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="d2974-167">Mit dieser Schnittstelle kann der Benutzer ein bis fünf neue Produkte hinzufügen, die alle dieselbe Kategorie und denselben Lieferanten gemeinsam nutzen, aber eindeutige Produktnamen und Preise aufweisen.</span><span class="sxs-lookup"><span data-stu-id="d2974-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="d2974-168">Ziehen Sie zunächst ein Panel aus der Toolbox auf den Designer, und platzieren Sie es unterhalb des vorhandenen `DisplayInterface` Panels.</span><span class="sxs-lookup"><span data-stu-id="d2974-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="d2974-169">Legen Sie die `ID`-Eigenschaft des neu hinzugefügten Panels auf `InsertingInterface` fest, und legen Sie dessen `Visible`-Eigenschaft auf `false`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `false`.</span></span> <span data-ttu-id="d2974-170">Wir fügen Code hinzu, mit dem die `InsertingInterface` Panel s `Visible` Eigenschaft auf `true` in Schritt 3 festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `true` in Step 3.</span></span> <span data-ttu-id="d2974-171">Löschen Sie außerdem den Bereich s `Height` und `Width` Eigenschaftswerte.</span><span class="sxs-lookup"><span data-stu-id="d2974-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="d2974-172">Als nächstes muss die einfügeschnittstelle erstellt werden, die in Abbildung 1 dargestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="d2974-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="d2974-173">Diese Schnittstelle kann über eine Vielzahl von HTML-Techniken erstellt werden, aber wir verwenden eine ziemlich unkomplizierte Tabelle: eine Tabelle mit vier Spalten und sieben Zeilen.</span><span class="sxs-lookup"><span data-stu-id="d2974-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="d2974-174">Wenn Sie Markup für HTML-`<table>` Elemente eingeben, bevorzugen Sie die Verwendung der Quell Ansicht.</span><span class="sxs-lookup"><span data-stu-id="d2974-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="d2974-175">Obwohl Visual Studio über Tools zum Hinzufügen von `<table>` Elementen über den Designer verfügt, scheint der Designer alle nicht angefragten `style` Einstellungen in das Markup einzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="d2974-176">Nachdem Sie das `<table>` Markup erstellt haben, kehren Sie in der Regel zum Designer zurück, um die websteuer Elemente hinzuzufügen und ihre Eigenschaften festzulegen.</span><span class="sxs-lookup"><span data-stu-id="d2974-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="d2974-177">Beim Erstellen von Tabellen mit vordefinierten Spalten und Zeilen verwende ich anstelle des websteuer Elements "Table" anstelle des [websteuer](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) Elements "Table" die Verwendung von statischem HTML, da auf alle websteuer Elemente, `FindControl("controlID")` die in einem Table-websteuer Element platziert sind,</span><span class="sxs-lookup"><span data-stu-id="d2974-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="d2974-178">Ich verwende jedoch Tabellen-websteuer Elemente für dynamisch formatierte Tabellen (solche, deren Zeilen oder Spalten auf einer Datenbank oder einem benutzerdefinierten Kriterium basieren), da das Table-websteuer Element Programm gesteuert erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="d2974-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>

<span data-ttu-id="d2974-179">Geben Sie das folgende Markup innerhalb der `<asp:Panel>` Tags des `InsertingInterface` Panels ein:</span><span class="sxs-lookup"><span data-stu-id="d2974-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>

[!code-html[Main](batch-inserting-cs/samples/sample2.html)]

<span data-ttu-id="d2974-180">Dieses `<table>` Markup enthält noch keine websteuer Elemente. Diese werden vorübergehend hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2974-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="d2974-181">Beachten Sie, dass jedes `<tr>`-Element eine bestimmte CSS-Klassen Einstellung enthält: `BatchInsertHeaderRow` für die Kopfzeile, in der die Dropdown Listen "Lieferant" und "Category" verwendet werden. `BatchInsertFooterRow` für die Footerzeile, in der die Schaltflächen Produkte aus Sendung hinzufügen und Abbrechen angezeigt werden. und abwechselnde `BatchInsertRow` und `BatchInsertAlternatingRow` Werte für die Zeilen, die die Textfeld-Steuerelemente Product und Unit Price enthalten.</span><span class="sxs-lookup"><span data-stu-id="d2974-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="d2974-182">In der `Styles.css` Datei wurden entsprechende CSS-Klassen erstellt, um der einfügeschnittstelle eine Darstellung ähnlich der GridView-und DetailsView-Steuerelemente zuzuweisen, die wir in diesen Tutorials verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="d2974-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="d2974-183">Diese CSS-Klassen sind unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d2974-183">These CSS classes are shown below.</span></span>

[!code-css[Main](batch-inserting-cs/samples/sample3.css)]

<span data-ttu-id="d2974-184">Wenn Sie dieses Markup eingegeben haben, kehren Sie zum Designansicht zurück.</span><span class="sxs-lookup"><span data-stu-id="d2974-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="d2974-185">Diese `<table>` sollte im Designer als vier spaltige Tabelle mit sieben Zeilen angezeigt werden, wie in Abbildung 6 veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="d2974-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>

<span data-ttu-id="d2974-186">[![die einfügende Schnittstelle aus einer Tabelle mit vier Spalten und sieben Zeilen besteht.](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span></span>

<span data-ttu-id="d2974-187">**Abbildung 6**: die einfügende Schnittstelle besteht aus einer Tabelle mit vier Spalten und sieben Zeilen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-cs/_static/image18.png))</span></span>

<span data-ttu-id="d2974-188">Nun können Sie die websteuer Elemente zur einfügeschnittstelle hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="d2974-189">Ziehen Sie zwei Dropdown Listen aus der Toolbox in die entsprechenden Zellen in der Tabelle 1 für den Lieferanten und eine für die Kategorie.</span><span class="sxs-lookup"><span data-stu-id="d2974-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="d2974-190">Legen Sie für die Eigenschaft "Lieferant DropDownList s `ID`" den Wert `Suppliers` fest, und binden Sie ihn an eine neue ObjectDataSource namens `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d2974-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="d2974-191">Konfigurieren Sie die neue ObjectDataSource, um Ihre Daten aus der `SuppliersBLL` Klasse `GetSuppliers` Methode abzurufen, und legen Sie die Dropdown Liste Update Registerkarte auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="d2974-192">Klicken Sie auf Fertigstellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="d2974-192">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="d2974-193">[![konfigurieren Sie die ObjectDataSource für die Verwendung der Methode getsuppliers der suppliersbll-Klasse.](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span></span>

<span data-ttu-id="d2974-194">**Abbildung 7**: Konfigurieren von ObjectDataSource für die Verwendung der `SuppliersBLL` Class s `GetSuppliers`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-cs/_static/image21.png))</span></span>

<span data-ttu-id="d2974-195">Verwenden Sie die Dropdown Liste `Suppliers`, um das `CompanyName` Datenfeld anzuzeigen, und verwenden Sie das `SupplierID` Datenfeld als `ListItem` s-Werte.</span><span class="sxs-lookup"><span data-stu-id="d2974-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>

<span data-ttu-id="d2974-196">[![das Unternehmensname-Datenfeld anzeigen und SupplierID als Wert verwenden.](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span></span>

<span data-ttu-id="d2974-197">**Abbildung 8**: Anzeigen des `CompanyName` Datenfelds und verwenden `SupplierID` als Wert ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-cs/_static/image24.png))</span></span>

<span data-ttu-id="d2974-198">Benennen Sie den zweiten DropDownList-`Categories`, und binden Sie ihn an eine neue ObjectDataSource mit dem Namen `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d2974-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="d2974-199">Konfigurieren Sie die `CategoriesDataSource` ObjectDataSource für die Verwendung der `CategoriesBLL` Class s `GetCategories`-Methode. Legen Sie die Dropdown Listen auf den Registerkarten aktualisieren und löschen auf (keine) fest, und klicken Sie auf Fertigstellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="d2974-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="d2974-200">Zum Schluss soll in der Dropdown List das `CategoryName` Datenfeld angezeigt und die `CategoryID` als Wert verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="d2974-201">Nachdem diese beiden Dropdown Listen hinzugefügt und an ordnungsgemäß konfigurierte objectdatasources gebunden wurden, sollte der Bildschirm in etwa wie in Abbildung 9 aussehen.</span><span class="sxs-lookup"><span data-stu-id="d2974-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>

<span data-ttu-id="d2974-202">[![die Kopfzeile enthält jetzt die Dropdown Listen "Suppliers" und "categories".](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span></span>

<span data-ttu-id="d2974-203">**Abbildung 9**: die Kopfzeile enthält jetzt die Dropdown Listen `Suppliers` und `Categories` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-cs/_static/image27.png))</span></span>

<span data-ttu-id="d2974-204">Wir müssen nun die Textfelder erstellen, um den Namen und den Preis für jedes neue Produkt zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="d2974-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="d2974-205">Ziehen Sie ein TextBox-Steuerelement aus der Toolbox auf den Designer für jeden der fünf Product Name-und Price-Zeilen.</span><span class="sxs-lookup"><span data-stu-id="d2974-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="d2974-206">Legen Sie die `ID` Eigenschaften der Textfelder auf `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`usw. fest.`UnitPrice3`</span><span class="sxs-lookup"><span data-stu-id="d2974-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="d2974-207">Fügen Sie ein CompareValidator nach jedem der Einheitspreis-Textfelder hinzu, und legen Sie die `ControlToValidate`-Eigenschaft auf die entsprechende `ID`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="d2974-208">Legen Sie außerdem die Eigenschaft `Operator` auf `GreaterThanEqual`, `ValueToCompare` auf 0 und `Type` auf `Currency`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="d2974-209">Diese Einstellungen weisen das CompareValidator an, sicherzustellen, dass der Preis, falls eingegeben, ein gültiger Währungswert ist, der größer oder gleich 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="d2974-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="d2974-210">Legen Sie die `Text`-Eigenschaft auf \*fest, und `ErrorMessage` auf den Preis muss größer oder gleich 0 (null) sein.</span><span class="sxs-lookup"><span data-stu-id="d2974-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="d2974-211">Außerdem sollten Sie keine Währungssymbole weglassen.</span><span class="sxs-lookup"><span data-stu-id="d2974-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="d2974-212">Die einfügende Schnittstelle enthält keine Requirements dfieldvalidator-Steuerelemente, auch wenn das `ProductName`-Feld in der `Products` Datenbanktabelle keine `NULL` Werte zulässt.</span><span class="sxs-lookup"><span data-stu-id="d2974-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="d2974-213">Der Grund hierfür ist, dass der Benutzer bis zu fünf Produkte eingeben soll.</span><span class="sxs-lookup"><span data-stu-id="d2974-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="d2974-214">Wenn der Benutzer z. b. den Produktnamen und den Preis für die ersten drei Zeilen angeben und die letzten beiden Zeilen leer gelassen hat, werden dem System lediglich drei neue Produkte hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2974-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="d2974-215">Da `ProductName` erforderlich ist, müssen wir Programm gesteuert überprüfen, um sicherzustellen, dass ein entsprechender Produkt namens Wert angegeben wird, wenn ein Stückpreis eingegeben wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="d2974-216">Wir behandeln diese Prüfung in Schritt 4.</span><span class="sxs-lookup"><span data-stu-id="d2974-216">We'll tackle this check in Step 4.</span></span>

<span data-ttu-id="d2974-217">Beim Validieren der Benutzereingaben meldet das CompareValidator ungültige Daten, wenn der Wert ein Währungssymbol enthält.</span><span class="sxs-lookup"><span data-stu-id="d2974-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="d2974-218">Fügen Sie vor jedem der UnitPrice-Textfelder einen Wert von $ vor, der als visueller Hinweis dienen soll, der den Benutzer anweist, das Währungssymbol bei der Eingabe des Preises auszulassen.</span><span class="sxs-lookup"><span data-stu-id="d2974-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="d2974-219">Fügen Sie abschließend im `InsertingInterface` Panel ein ValidationSummary-Steuerelement hinzu, und legen Sie dessen `ShowMessageBox`-Eigenschaft `true` und dessen `ShowSummary`-Eigenschaft auf `false`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="d2974-220">Mit diesen Einstellungen wird ein Sternchen neben den problematischen TextBox-Steuerelementen angezeigt, wenn der Benutzer einen ungültigen Einheiten Preis Wert eingibt. in der Datei "ValidationSummary" wird eine Client seitige MessageBox angezeigt, in der die zuvor angegebene Fehlermeldung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="d2974-221">An diesem Punkt sollte der Bildschirm in etwa wie in Abbildung 10 aussehen.</span><span class="sxs-lookup"><span data-stu-id="d2974-221">At this point, your screen should look similar to Figure 10.</span></span>

<span data-ttu-id="d2974-222">[![die einfügende Schnittstelle nun Textfelder für die Namen und Preise der Produkte enthält.](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span></span>

<span data-ttu-id="d2974-223">**Abbildung 10**: die einfügende Schnittstelle enthält jetzt Textfelder für die Namen und Preise der Produkte ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-cs/_static/image30.png))</span></span>

<span data-ttu-id="d2974-224">Als nächstes müssen wir die Schaltflächen Produkte aus Versand und Abbrechen der Footerzeile hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="d2974-225">Ziehen Sie zwei Schaltflächen-Steuerelemente aus der Toolbox in die Fußzeile der einfügeschnittstelle, und legen Sie die Schaltflächen `ID` Eigenschaften auf `AddProducts` und `CancelButton` und `Text` Eigenschaften zum Hinzufügen von Produkten aus der Lieferung bzw. dem Abbruch fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="d2974-226">Legen Sie außerdem die `CancelButton` Control s `CausesValidation`-Eigenschaft auf `false`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="d2974-227">Zum Schluss muss ein Label-websteuer Element hinzugefügt werden, das Statusmeldungen für die beiden Schnittstellen anzeigt.</span><span class="sxs-lookup"><span data-stu-id="d2974-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="d2974-228">Wenn ein Benutzer beispielsweise erfolgreich eine neue Lieferung von Produkten hinzufügt, möchten wir zur Anzeige Schnittstelle zurückkehren und eine Bestätigungsmeldung anzeigen.</span><span class="sxs-lookup"><span data-stu-id="d2974-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="d2974-229">Wenn der Benutzer jedoch einen Preis für ein neues Produkt bereitstellt, aber den Produktnamen verlässt, muss eine Warnmeldung angezeigt werden, da das Feld "`ProductName`" erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="d2974-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="d2974-230">Da diese Meldung für beide Schnittstellen angezeigt werden muss, platzieren Sie Sie am oberen Rand der Seite außerhalb der Panels.</span><span class="sxs-lookup"><span data-stu-id="d2974-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="d2974-231">Ziehen Sie ein Label-websteuer Element aus der Toolbox an den oberen Rand der Seite im Designer.</span><span class="sxs-lookup"><span data-stu-id="d2974-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="d2974-232">Legen Sie die `ID`-Eigenschaft auf `StatusLabel`fest, löschen Sie die `Text`-Eigenschaft, und legen Sie die `Visible`-und `EnableViewState`-Eigenschaften auf `false`fest.</span><span class="sxs-lookup"><span data-stu-id="d2974-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `false`.</span></span> <span data-ttu-id="d2974-233">Wie in den vorherigen Tutorials gezeigt, können wir die `EnableViewState`-Eigenschaft auf `false` festlegen, um die Eigenschaften Werte der Bezeichnung Programm gesteuert zu ändern und automatisch auf die Standardwerte des nachfolgenden Postbacks zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="d2974-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `false` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="d2974-234">Dies vereinfacht den Code, um eine Statusmeldung als Reaktion auf eine Benutzeraktion anzuzeigen, die beim nachfolgenden Postback nicht mehr angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="d2974-235">Legen Sie abschließend die `StatusLabel` Control s `CssClass` Eigenschaft auf Warning fest. Dies ist der Name einer CSS-Klasse, die in `Styles.css` definiert ist, in der Text in einer großen, kursiv, Fetten und roten Schriftart angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="d2974-236">Abbildung 11 zeigt den Visual Studio-Designer, nachdem die Bezeichnung hinzugefügt und konfiguriert wurde.</span><span class="sxs-lookup"><span data-stu-id="d2974-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>

<span data-ttu-id="d2974-237">[![das Steuerelement "Status Bezeichnung" oberhalb der beiden Panel-Steuerelemente platzieren.](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span></span>

<span data-ttu-id="d2974-238">**Abbildung 11**: Platzieren des `StatusLabel`-Steuer Elements oberhalb der beiden Panel-Steuerelemente ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-cs/_static/image33.png))</span></span>

## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="d2974-239">Schritt 3: Wechseln zwischen den Anzeige-und einfügeschnittstellen</span><span class="sxs-lookup"><span data-stu-id="d2974-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="d2974-240">An dieser Stelle haben wir das Markup für unsere Anzeige-und einfügeschnittstellen abgeschlossen, aber wir haben noch immer zwei Aufgaben verbleiben:</span><span class="sxs-lookup"><span data-stu-id="d2974-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="d2974-241">Wechseln zwischen den Anzeige-und einfügeschnittstellen</span><span class="sxs-lookup"><span data-stu-id="d2974-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="d2974-242">Hinzufügen der Produkte in der Lieferung zur Datenbank</span><span class="sxs-lookup"><span data-stu-id="d2974-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="d2974-243">Derzeit ist die Anzeige Schnittstelle sichtbar, aber die einfügende Schnittstelle ist ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="d2974-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="d2974-244">Dies liegt daran, dass die `DisplayInterface` Bereich s `Visible` Eigenschaft auf `true` (Standardwert) festgelegt ist, während die `InsertingInterface` Panel s `Visible`-Eigenschaft auf `false`festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="d2974-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `true` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `false`.</span></span> <span data-ttu-id="d2974-245">Um zwischen den beiden Schnittstellen zu wechseln, müssen Sie einfach die einzelnen Steuerelemente `Visible`-Eigenschafts Wert umschalten.</span><span class="sxs-lookup"><span data-stu-id="d2974-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="d2974-246">Wir möchten von der Anzeige Schnittstelle zur einfügeschnittstelle wechseln, wenn auf die Schaltfläche "Produktversand verarbeiten" geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="d2974-247">Erstellen Sie daher einen Ereignishandler für diese Schaltfläche s `Click` Ereignis, das den folgenden Code enthält:</span><span class="sxs-lookup"><span data-stu-id="d2974-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>

[!code-csharp[Main](batch-inserting-cs/samples/sample4.cs)]

<span data-ttu-id="d2974-248">Mit diesem Code wird der `DisplayInterface` Panel ausgeblendet und das `InsertingInterface` Panel angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d2974-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="d2974-249">Erstellen Sie anschließend in der einfügeschnittstelle Ereignishandler für die Schaltflächen "Produkte aus Sendung und Abbrechen".</span><span class="sxs-lookup"><span data-stu-id="d2974-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="d2974-250">Wenn auf eine dieser Schaltflächen geklickt wird, müssen wir auf die Anzeige Schnittstelle zurückgreifen.</span><span class="sxs-lookup"><span data-stu-id="d2974-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="d2974-251">Erstellen Sie `Click` Ereignishandler für beide Schaltflächen-Steuerelemente, sodass Sie `ReturnToDisplayInterface`, eine Methode, die Sie vorübergehend hinzufügen werden, aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="d2974-252">Zusätzlich zum Ausblenden des `InsertingInterface` Bereichs und der Anzeige des `DisplayInterface` Panel muss die `ReturnToDisplayInterface`-Methode die websteuer Elemente in den Zustand der vorabbearbeitung zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="d2974-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="d2974-253">Dies umfasst das Festlegen der DropDownLists-`SelectedIndex` Eigenschaften auf 0 und das Löschen der `Text` Eigenschaften der Textfeld-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="d2974-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="d2974-254">Berücksichtigen Sie, was passieren kann, wenn die Steuerelemente vor dem zurückkehren zur Anzeige Schnittstelle nicht in ihren Zustand vor der Bearbeitung zurückgegeben wurden.</span><span class="sxs-lookup"><span data-stu-id="d2974-254">Consider what might happen if we didn't return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="d2974-255">Wenn ein Benutzer auf die Schaltfläche Produktversand verarbeiten klickt, geben Sie die Produkte der Lieferung ein, und klicken Sie dann auf Produkte aus Lieferung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="d2974-256">Dadurch werden die Produkte hinzugefügt, und der Benutzer wird an die Anzeige Schnittstelle zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="d2974-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="d2974-257">An diesem Punkt kann der Benutzer eine weitere Lieferung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="d2974-258">Wenn Sie auf die Schaltfläche "Produktversand verarbeiten" klicken, werden Sie zur einfügeschnittstelle zurückkehren, aber die DropDownList-Auswahl und die TextBox-Werte werden weiterhin mit ihren vorherigen Werten aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="d2974-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>

[!code-csharp[Main](batch-inserting-cs/samples/sample5.cs)]

<span data-ttu-id="d2974-259">Beide `Click` Ereignishandler greifen einfach auf die `ReturnToDisplayInterface`-Methode zu, obwohl wir zum Hinzufügen von Produkten aus der Lieferung `Click` Ereignishandler in Schritt 4 zurückkehren und Code zum Speichern der Produkte hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2974-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="d2974-260">`ReturnToDisplayInterface` beginnt mit dem Zurückgeben der `Suppliers` und `Categories` Dropdown Listen zu ihren ersten Optionen.</span><span class="sxs-lookup"><span data-stu-id="d2974-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="d2974-261">Die beiden Konstanten `firstControlID` und `lastControlID` die Start-und End Control Index-Werte, die in Benennen der Product Name-und Unit Price-Textfelder in der einfügschnittstelle verwendet werden, und werden in den Begrenzungen der `for`-Schleife verwendet, mit der die `Text` Eigenschaften der TextBox-Steuerelemente auf eine leere Zeichenfolge zurückgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `for` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="d2974-262">Zum Schluss werden die Panel-`Visible` Eigenschaften zurückgesetzt, sodass die einfügende Schnittstelle ausgeblendet und die Anzeige Schnittstelle angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="d2974-263">Nehmen Sie sich einen Moment Zeit, um diese Seite in einem Browser zu testen.</span><span class="sxs-lookup"><span data-stu-id="d2974-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="d2974-264">Beim ersten Besuch der Seite sollte die Anzeige Schnittstelle wie in Abbildung 5 gezeigt angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="d2974-265">Klicken Sie auf die Schaltfläche Produktlieferung verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="d2974-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="d2974-266">Die Seite wird Postback angezeigt, und Sie sollten jetzt die einfügeschnittstelle sehen, wie in Abbildung 12 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d2974-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="d2974-267">Wenn Sie auf die Schaltflächen Produkte aus Sendung hinzufügen oder Abbrechen klicken, werden Sie zur Anzeige Schnittstelle zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="d2974-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="d2974-268">Wenn Sie die einfügeschnittstelle anzeigen, nehmen Sie sich einen Moment Zeit, um die comparevalidators für die Einzelpreis-Textfelder zu testen.</span><span class="sxs-lookup"><span data-stu-id="d2974-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="d2974-269">Wenn Sie auf die Schaltfläche Produkte aus Lieferung hinzufügen klicken, wird eine Client seitige MessageBox-Warnung angezeigt, die ungültige Währungswerte oder Preise mit einem Wert kleiner als 0 (null) aufweist.</span><span class="sxs-lookup"><span data-stu-id="d2974-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>

<span data-ttu-id="d2974-270">[![die Schaltfläche "Einfügen" angezeigt wird](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span></span>

<span data-ttu-id="d2974-271">**Abbildung 12**: die einfügeschnittstelle wird angezeigt[,](batch-inserting-cs/_static/image36.png)nachdem auf die Schaltfläche "Produktversand verarbeiten" geklickt wurde</span><span class="sxs-lookup"><span data-stu-id="d2974-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-cs/_static/image36.png))</span></span>

## <a name="step-4-adding-the-products"></a><span data-ttu-id="d2974-272">Schritt 4: Hinzufügen der Produkte</span><span class="sxs-lookup"><span data-stu-id="d2974-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="d2974-273">Für dieses Lernprogramm müssen Sie lediglich die Produkte in der-Datenbank in der Schaltfläche Produkte aus Lieferung hinzufügen `Click` Ereignis Handlers speichern.</span><span class="sxs-lookup"><span data-stu-id="d2974-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="d2974-274">Dies kann erreicht werden, indem ein `ProductsDataTable` erstellt und für jeden bereitgestellten Produktnamen eine `ProductsRow` Instanz hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="d2974-275">Nachdem diese `ProductsRow` s hinzugefügt wurden, wird die `ProductsBLL` Class s `UpdateWithTransaction`-Methode aufgerufen, die die `ProductsDataTable`übergibt.</span><span class="sxs-lookup"><span data-stu-id="d2974-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="d2974-276">Erinnern Sie sich daran, dass die `UpdateWithTransaction`-Methode, die im Tutorial zum [Umpacken von Daten Bank Änderungen innerhalb einer Transaktion](wrapping-database-modifications-within-a-transaction-cs.md) erstellt wurde, die `ProductsDataTable` an die `ProductsTableAdapter` s `UpdateWithTransaction`-Methode übergibt.</span><span class="sxs-lookup"><span data-stu-id="d2974-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="d2974-277">Von dort aus wird eine ADO.NET-Transaktion gestartet, und der TableAdapter gibt eine `INSERT`-Anweisung für jede hinzugefügte `ProductsRow` in der Datentabelle aus.</span><span class="sxs-lookup"><span data-stu-id="d2974-277">From there, an ADO.NET transaction is started and the TableAdapter issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="d2974-278">Wenn alle Produkte ohne Fehler hinzugefügt werden, wird für die Transaktion ein Commit ausgeführt; andernfalls wird ein Rollback ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="d2974-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="d2974-279">Der Code für die Schaltfläche Produkte aus Lieferung hinzufügen `Click` Ereignishandler muss ebenfalls eine gewisse Fehlerüberprüfung durchführen.</span><span class="sxs-lookup"><span data-stu-id="d2974-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="d2974-280">Da keine "Requirements dfieldvalidators" in der einfügeschnittstelle verwendet werden, könnte ein Benutzer einen Preis für ein Produkt eingeben, während der Name ausgelassen wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="d2974-281">Da der Name des Produkts erforderlich ist, müssen wir bei einer solchen Bedingung den Benutzer benachrichtigen und die Einfügungen nicht fortsetzen.</span><span class="sxs-lookup"><span data-stu-id="d2974-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="d2974-282">Der gesamte `Click` Ereignishandlercode folgt:</span><span class="sxs-lookup"><span data-stu-id="d2974-282">The complete `Click` event handler code follows:</span></span>

[!code-csharp[Main](batch-inserting-cs/samples/sample6.cs)]

<span data-ttu-id="d2974-283">Der Ereignishandler beginnt mit dem sicherstellen, dass die `Page.IsValid`-Eigenschaft den Wert `true`zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="d2974-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `true`.</span></span> <span data-ttu-id="d2974-284">Wenn `false`zurückgegeben wird, bedeutet dies, dass mindestens ein comparevalidators ungültige Daten meldet. in einem solchen Fall möchten wir nicht versuchen, die eingegebenen Produkte einzufügen, oder es wird eine Ausnahme ausgelöst, wenn versucht wird, den Wert des vom Benutzer eingegebenen Einheiten Preises der `ProductsRow` s `UnitPrice`-Eigenschaft zuzuweisen.</span><span class="sxs-lookup"><span data-stu-id="d2974-284">If it returns `false`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="d2974-285">Als nächstes wird eine neue `ProductsDataTable` Instanz erstellt (`products`).</span><span class="sxs-lookup"><span data-stu-id="d2974-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="d2974-286">Eine `for`-Schleife wird verwendet, um die Textfelder Product Name und Unit Price zu durchlaufen, und die `Text` Eigenschaften werden in die lokalen Variablen `productName` und `unitPrice`eingelesen.</span><span class="sxs-lookup"><span data-stu-id="d2974-286">A `for` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="d2974-287">Wenn der Benutzer einen Wert für den Einheitspreis eingegeben hat, aber nicht für den entsprechenden Produktnamen, zeigt der `StatusLabel` die Meldung an, wenn Sie einen unitpreis angeben, müssen Sie auch den Namen des Produkts einschließen, und der Ereignishandler wird beendet.</span><span class="sxs-lookup"><span data-stu-id="d2974-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="d2974-288">Wenn ein Produktname angegeben wurde, wird mithilfe der `NewProductsRow`-Methode `ProductsDataTable` s eine neue `ProductsRow` Instanz erstellt.</span><span class="sxs-lookup"><span data-stu-id="d2974-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="d2974-289">Diese neue `ProductsRow` Instanz s `ProductName` Eigenschaft wird auf das Textfeld aktueller Produktname festgelegt, während die Eigenschaften `SupplierID` und `CategoryID` den `SelectedValue` Eigenschaften der Dropdown Listen im Header der Einfügungs Schnittstelle zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="d2974-290">Wenn der Benutzer einen Wert für den Produkt-e-Preis eingegeben hat, wird er der `ProductsRow` Instanz s `UnitPrice` Eigenschaft zugewiesen. Andernfalls wird die-Eigenschaft nicht zugewiesen, was zu einem `NULL` Wert für `UnitPrice` in der Datenbank führt.</span><span class="sxs-lookup"><span data-stu-id="d2974-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="d2974-291">Zum Schluss werden die `Discontinued`-und `UnitsOnOrder` Eigenschaften den hart codierten Werten `false` bzw. 0 (null) zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="d2974-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `false` and 0, respectively.</span></span>

<span data-ttu-id="d2974-292">Nachdem die Eigenschaften der `ProductsRow` Instanz zugewiesen wurden, wird Sie der `ProductsDataTable`hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2974-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="d2974-293">Nach Abschluss der `for` Schleife überprüfen wir, ob Produkte hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="d2974-293">At the completion of the `for` loop, we check whether any products have been added.</span></span> <span data-ttu-id="d2974-294">Der Benutzer hat möglicherweise auf die Produkte aus Lieferung hinzufügen geklickt, bevor er Produktnamen oder Preise eingegeben hat.</span><span class="sxs-lookup"><span data-stu-id="d2974-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="d2974-295">Wenn mindestens ein Produkt im `ProductsDataTable`vorhanden ist, wird die `ProductsBLL` Class s `UpdateWithTransaction`-Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="d2974-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="d2974-296">Als nächstes werden die Daten an die `ProductsGrid` GridView zurückgesetzt, sodass die neu hinzugefügten Produkte in der Anzeige Schnittstelle angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d2974-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="d2974-297">Der `StatusLabel` wird aktualisiert, um eine Bestätigungsmeldung anzuzeigen, und die `ReturnToDisplayInterface` wird aufgerufen, wobei die einfügeschnittstelle ausgeblendet und die Anzeige Schnittstelle angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d2974-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="d2974-298">Wenn keine Produkte eingegeben wurden, wird die einfügende Schnittstelle angezeigt, aber es wurden keine Produkte hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2974-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="d2974-299">Geben Sie die Produktnamen und die Preis Einheiten in die Textfelder ein.</span><span class="sxs-lookup"><span data-stu-id="d2974-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="d2974-300">In Abbildung s 13, 14 und 15 werden die Einfüge-und Anzeige Schnittstellen in Aktion angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d2974-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="d2974-301">In Abbildung 13 hat der Benutzer einen Einzelpreis Wert ohne einen entsprechenden Produktnamen eingegeben.</span><span class="sxs-lookup"><span data-stu-id="d2974-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="d2974-302">In Abbildung 14 wird die Anzeige Schnittstelle angezeigt, nachdem drei neue Produkte erfolgreich hinzugefügt wurden, während Abbildung 15 zwei der neu hinzugefügten Produkte in der GridView anzeigt (die dritte ist auf der vorherigen Seite).</span><span class="sxs-lookup"><span data-stu-id="d2974-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>

<span data-ttu-id="d2974-303">[![ein Produkt Name erforderlich ist, wenn ein Einzelpreis eingegeben wird](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span></span>

<span data-ttu-id="d2974-304">**Abbildung 13**: ein Produkt Name ist erforderlich, wenn ein Einheitspreis eingegeben wird ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-cs/_static/image39.png))</span></span>

<span data-ttu-id="d2974-305">[![drei neue Veggies für den Lieferanten Mayumi s hinzugefügt.](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span></span>

<span data-ttu-id="d2974-306">**Abbildung 14**: dem Lieferanten Mayumi s wurden drei neue Veggies hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-cs/_static/image42.png))</span></span>

<span data-ttu-id="d2974-307">[![die neuen Produkte finden Sie auf der letzten Seite der GridView.](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="d2974-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span></span>

<span data-ttu-id="d2974-308">**Abbildung 15**: die neuen Produkte finden Sie auf der letzten Seite der GridView ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-inserting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="d2974-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-cs/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="d2974-309">Die in diesem Tutorial verwendete Batch-Einfügungs Logik umschließt die Einfügungen innerhalb des Umfangs der Transaktion.</span><span class="sxs-lookup"><span data-stu-id="d2974-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="d2974-310">Um dies zu überprüfen, führen Sie absichtlich einen Fehler auf Datenbankebene ein.</span><span class="sxs-lookup"><span data-stu-id="d2974-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="d2974-311">Anstatt z. b. die neue `ProductsRow` Instanz s `CategoryID` Eigenschaft dem ausgewählten Wert in der `Categories` DropDownList zuzuweisen, weisen Sie ihn einem Wert wie `i * 5`zu.</span><span class="sxs-lookup"><span data-stu-id="d2974-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="d2974-312">Hier ist `i` der Schleifen Indexer und hat Werte zwischen 1 und 5.</span><span class="sxs-lookup"><span data-stu-id="d2974-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="d2974-313">Beim Hinzufügen von zwei oder mehr Produkten in Batch INSERT hat das erste Produkt daher einen gültigen `CategoryID` Wert (5), nachfolgende Produkte verfügen jedoch über `CategoryID` Werte, die nicht mit `CategoryID` Werten in der `Categories` Tabelle identisch sind.</span><span class="sxs-lookup"><span data-stu-id="d2974-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="d2974-314">Dies hat zur Folge, dass während der ersten `INSERT` erfolgreich ist, dass nachfolgende mit einer Verletzung der Fremdschlüssel Einschränkung fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="d2974-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="d2974-315">Da die Batch Einfügung atomarisch ist, wird für den ersten `INSERT` ein Rollback ausgeführt, und die Datenbank wird vor Beginn des Batch Einfügungs Prozesses in den Zustand zurückversetzt.</span><span class="sxs-lookup"><span data-stu-id="d2974-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>

## <a name="summary"></a><span data-ttu-id="d2974-316">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="d2974-316">Summary</span></span>

<span data-ttu-id="d2974-317">In diesem und den beiden vorherigen Tutorials haben wir Schnittstellen erstellt, die das Aktualisieren, löschen und Einfügen von Daten Batches ermöglichen, die alle die Transaktionsunterstützung verwendet haben, die wir der Datenzugriffs Ebene im Tutorial Wrapping von Daten [Bank Änderungen innerhalb einer Transaktion](wrapping-database-modifications-within-a-transaction-cs.md) hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="d2974-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span></span> <span data-ttu-id="d2974-318">In bestimmten Szenarien verbessern diese Benutzeroberflächen für die Batch Verarbeitung die Effizienz von Endbenutzern erheblich, indem die Anzahl der Klicks, Postbacks und Tastatur-zu-Maus-Kontextwechsel gesenkt werden, während gleichzeitig die Integrität der zugrunde liegenden Daten gewahrt bleibt.</span><span class="sxs-lookup"><span data-stu-id="d2974-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="d2974-319">In diesem Tutorial wird die Arbeit mit Batch Daten behandelt.</span><span class="sxs-lookup"><span data-stu-id="d2974-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="d2974-320">Der nächste Satz von Tutorials untersucht eine Reihe von erweiterten Szenarien für die Datenzugriffs Schicht, einschließlich der Verwendung von gespeicherten Prozeduren in den TableAdapter-Methoden, dem Konfigurieren der Einstellungen für die Verbindungs-und Befehls Ebene in der Dal, dem Verschlüsseln von Verbindungs Zeichenfolgen und mehr.</span><span class="sxs-lookup"><span data-stu-id="d2974-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="d2974-321">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="d2974-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d2974-322">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="d2974-322">About the Author</span></span>

<span data-ttu-id="d2974-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="d2974-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d2974-324">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="d2974-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d2974-325">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d2974-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d2974-326">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d2974-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d2974-327">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d2974-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d2974-328">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="d2974-328">Special Thanks To</span></span>

<span data-ttu-id="d2974-329">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="d2974-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d2974-330">Die führenden Reviewer für dieses Tutorial waren Hilton giesdenow und S ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="d2974-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="d2974-331">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="d2974-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d2974-332">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d2974-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d2974-333">[Zurück](batch-deleting-cs.md)
> [Weiter](wrapping-database-modifications-within-a-transaction-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d2974-333">[Previous](batch-deleting-cs.md)
[Next](wrapping-database-modifications-within-a-transaction-vb.md)</span></span>
