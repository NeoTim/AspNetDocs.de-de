---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-cs
title: Batch Aktualisierung (C#) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie Sie mehrere Datenbankdaten Sätze in einem einzelnen Vorgang aktualisieren. In der Benutzeroberflächen Ebene erstellen wir eine GridView, in der jede Zeile bearbeitet werden kann. In den Daten...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: 4e849bcc-c557-4bc3-937e-f7453ee87265
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-cs
msc.type: authoredcontent
ms.openlocfilehash: baaaf37c47cc57d90ea579a5c20949bf8cfc7a3c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78476403"
---
# <a name="batch-updating-c"></a><span data-ttu-id="cae9a-105">Aktualisieren in Batches (C#)</span><span class="sxs-lookup"><span data-stu-id="cae9a-105">Batch Updating (C#)</span></span>

<span data-ttu-id="cae9a-106">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cae9a-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cae9a-107">[Code herunterladen](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_CS.zip) oder [PDF herunterladen](batch-updating-cs/_static/datatutorial64cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cae9a-107">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_CS.zip) or [Download PDF](batch-updating-cs/_static/datatutorial64cs1.pdf)</span></span>

> <span data-ttu-id="cae9a-108">Erfahren Sie, wie Sie mehrere Datenbankdaten Sätze in einem einzelnen Vorgang aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="cae9a-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="cae9a-109">In der Benutzeroberflächen Ebene erstellen wir eine GridView, in der jede Zeile bearbeitet werden kann.</span><span class="sxs-lookup"><span data-stu-id="cae9a-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="cae9a-110">In der Datenzugriffs Ebene werden mehrere Aktualisierungs Vorgänge in eine Transaktion eingeschlossen, um sicherzustellen, dass alle Updates erfolgreich sind oder für alle Updates ein Rollback ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="cae9a-111">Einführung</span><span class="sxs-lookup"><span data-stu-id="cae9a-111">Introduction</span></span>

<span data-ttu-id="cae9a-112">Im [vorherigen Tutorial](wrapping-database-modifications-within-a-transaction-cs.md) wurde erläutert, wie die Datenzugriffs Ebene erweitert wird, um Unterstützung für Datenbanktransaktionen hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-cs.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="cae9a-113">Datenbanktransaktionen garantieren, dass eine Reihe von Daten Änderungs Anweisungen als ein atomarer Vorgang behandelt werden, um sicherzustellen, dass alle Änderungen fehlschlagen oder alle erfolgreich ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="cae9a-114">Mit dieser auf Low-Level-dal-Funktionalität haben wir nun die Aufmerksamkeit auf das Erstellen von Schnittstellen für die Batch Datenänderung vorbereitet.</span><span class="sxs-lookup"><span data-stu-id="cae9a-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="cae9a-115">In diesem Tutorial erstellen wir eine GridView, in der jede Zeile bearbeitet werden kann (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="cae9a-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="cae9a-116">Da jede Zeile in der Bearbeitungs Schnittstelle gerendert wird, ist es nicht erforderlich, dass eine Spalte mit den Schaltflächen Bearbeiten, aktualisieren und Abbrechen vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="cae9a-117">Stattdessen werden auf der Seite zwei Schaltflächen zum Aktualisieren von Produkten angezeigt. Wenn Sie darauf klicken, werden die GridView-Zeilen aufgezählt, und die Datenbank wird aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="cae9a-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>

<span data-ttu-id="cae9a-118">[![jede Zeile in der GridView-Tabelle bearbeitet werden kann.](batch-updating-cs/_static/image1.gif)](batch-updating-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-118">[![Each Row in the GridView is Editable](batch-updating-cs/_static/image1.gif)](batch-updating-cs/_static/image1.png)</span></span>

<span data-ttu-id="cae9a-119">**Abbildung 1**: jede Zeile in der GridView-Tabelle kann bearbeitet werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-cs/_static/image2.png))</span></span>

<span data-ttu-id="cae9a-120">Legen Sie Los!</span><span class="sxs-lookup"><span data-stu-id="cae9a-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="cae9a-121">Im Tutorial zum [Durchführen von Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) haben wir eine Batch Bearbeitungs Schnittstelle mit dem DataList-Steuerelement erstellt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="cae9a-122">Dieses Tutorial unterscheidet sich von dem vorherigen in, das eine GridView verwendet, und das Batch Update wird innerhalb des Umfangs einer Transaktion ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="cae9a-123">Nachdem Sie dieses Tutorial durchgearbeitet haben, empfehlen wir Ihnen, zum vorherigen Tutorial zurückzukehren und es zu aktualisieren, um die im vorherigen Tutorial hinzugefügte Daten Bank Transaktions Funktionalität zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>

## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="cae9a-124">Untersuchen der Schritte, mit denen alle GridView-Zeilen bearbeitet werden</span><span class="sxs-lookup"><span data-stu-id="cae9a-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="cae9a-125">Wie in der Übersicht über das [Einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) beschrieben, bietet die GridView integrierte Unterstützung für die Bearbeitung der zugrunde liegenden Daten auf Zeilen Basis.</span><span class="sxs-lookup"><span data-stu-id="cae9a-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="cae9a-126">Intern wird in der GridView festgelegt, welche Zeile durch die [`EditIndex`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx)bearbeitet werden kann.</span><span class="sxs-lookup"><span data-stu-id="cae9a-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="cae9a-127">Wenn die GridView an die Datenquelle gebunden wird, wird jede Zeile überprüft, um festzustellen, ob der Index der Zeile dem Wert `EditIndex`entspricht.</span><span class="sxs-lookup"><span data-stu-id="cae9a-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="cae9a-128">Wenn dies der Fall ist, werden die Zeilen Felder mithilfe Ihrer Bearbeitungs Schnittstellen gerendert.</span><span class="sxs-lookup"><span data-stu-id="cae9a-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="cae9a-129">Bei boundfields ist die Bearbeitungs Schnittstelle ein Textfeld, dessen `Text`-Eigenschaft dem Wert des Daten Felds zugewiesen ist, das durch die Eigenschaft "BoundField s `DataField`" angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="cae9a-130">Bei templatefields wird der `EditItemTemplate` anstelle des `ItemTemplate`verwendet.</span><span class="sxs-lookup"><span data-stu-id="cae9a-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="cae9a-131">Beachten Sie, dass der Bearbeitungs Workflow gestartet wird, wenn ein Benutzer auf die Schaltfläche "Bearbeiten" der Zeile klickt</span><span class="sxs-lookup"><span data-stu-id="cae9a-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="cae9a-132">Dadurch wird ein Postback ausgelöst, die GridView s `EditIndex`-Eigenschaft auf den angeklickten Zeilen Index festgelegt, und die Daten werden an das Raster gebunden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="cae9a-133">Beim Klicken auf die Schaltfläche "Abbrechen" einer Zeile wird beim Postback der `EditIndex` auf den Wert `-1` festgelegt, bevor die Daten erneut an das Raster gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="cae9a-134">Da in den GridView s-Zeilen die Indizierung bei Null beginnt, hat das Festlegen von `EditIndex` auf `-1` die Auswirkung, die GridView im schreibgeschützten Modus anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="cae9a-135">Die `EditIndex`-Eigenschaft eignet sich gut für die Zeilen übergreifende Bearbeitung, ist aber nicht für die Batch Bearbeitung vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="cae9a-136">Damit die gesamte GridView bearbeitbar ist, muss jede Zeile mit Ihrer Bearbeitungs Schnittstelle dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="cae9a-137">Dies lässt sich am einfachsten erreichen, indem Sie erstellen, wo jedes bearbeitbare Feld als TemplateField implementiert wird und seine Bearbeitungs Schnittstelle in der `ItemTemplate`definiert ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="cae9a-138">In den nächsten Schritten erstellen wir eine vollständig bearbeitbare GridView.</span><span class="sxs-lookup"><span data-stu-id="cae9a-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="cae9a-139">In Schritt 1 erstellen wir zunächst die GridView und deren ObjectDataSource und konvertieren deren boundfields und CheckBoxField in templatefields.</span><span class="sxs-lookup"><span data-stu-id="cae9a-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="cae9a-140">In den Schritten 2 und 3 verschieben wir die Bearbeitungs Schnittstellen aus den templatefields-`EditItemTemplate` s in Ihre `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="cae9a-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="cae9a-141">Schritt 1: Anzeigen von Produktinformationen</span><span class="sxs-lookup"><span data-stu-id="cae9a-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="cae9a-142">Bevor wir uns Gedanken über das Erstellen einer GridView machen, in der die Zeilen bearbeitet werden können, lassen Sie zunächst die Produktinformationen anzeigen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="cae9a-143">Öffnen Sie die Seite `BatchUpdate.aspx` im Ordner `BatchData`, und ziehen Sie eine GridView aus der Toolbox auf den Designer.</span><span class="sxs-lookup"><span data-stu-id="cae9a-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="cae9a-144">Legen Sie die `ID` GridView s auf `ProductsGrid` fest, und wählen Sie aus dem smarttagtag aus, dass es an eine neue ObjectDataSource mit dem Namen `ProductsDataSource`gebunden werden soll.</span><span class="sxs-lookup"><span data-stu-id="cae9a-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="cae9a-145">Konfigurieren Sie ObjectDataSource so, dass die Daten aus der `ProductsBLL` Klasse `GetProducts`-Methode abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>

<span data-ttu-id="cae9a-146">[![konfigurieren Sie ObjectDataSource für die Verwendung der productbll-Klasse.](batch-updating-cs/_static/image2.gif)](batch-updating-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-cs/_static/image2.gif)](batch-updating-cs/_static/image3.png)</span></span>

<span data-ttu-id="cae9a-147">**Abbildung 2**: Konfigurieren von ObjectDataSource für die Verwendung der `ProductsBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-cs/_static/image4.png))</span></span>

<span data-ttu-id="cae9a-148">[![Abrufen der Produktdaten mithilfe der GetProducts-Methode](batch-updating-cs/_static/image3.gif)](batch-updating-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-cs/_static/image3.gif)](batch-updating-cs/_static/image5.png)</span></span>

<span data-ttu-id="cae9a-149">**Abbildung 3**: Abrufen der Produktdaten mit der `GetProducts`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-cs/_static/image6.png))</span></span>

<span data-ttu-id="cae9a-150">Wie bei GridView sind die Modifizierungs Features von ObjectDataSource für zeilenweise so konzipiert, dass Sie auf Zeilen Basis funktionieren.</span><span class="sxs-lookup"><span data-stu-id="cae9a-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="cae9a-151">Um einen Satz von Datensätzen zu aktualisieren, müssen wir ein Bit Code in der Code Behind-Klasse der ASP.net page s schreiben, die die Daten stapelt und an die BLL übergibt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="cae9a-152">Legen Sie daher die Dropdown Listen in den Registerkarten Update, INSERT und DELETE von ObjectDataSource auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="cae9a-153">Klicken Sie auf Fertigstellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-153">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="cae9a-154">[![die Dropdown Listen auf den Registerkarten aktualisieren, einfügen und löschen auf (keine) festgelegt.](batch-updating-cs/_static/image4.gif)](batch-updating-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-cs/_static/image4.gif)](batch-updating-cs/_static/image7.png)</span></span>

<span data-ttu-id="cae9a-155">**Abbildung 4**: Festlegen der Dropdown Listen auf den Registerkarten "Aktualisieren", "Einfügen" und "Löschen" auf "(keine)" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-cs/_static/image8.png))</span></span>

<span data-ttu-id="cae9a-156">Nach Abschluss des Assistenten zum Konfigurieren von Datenquellen sollte das deklarative Markup von ObjectDataSource s wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="cae9a-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](batch-updating-cs/samples/sample1.aspx)]

<span data-ttu-id="cae9a-157">Wenn Sie den Assistenten zum Konfigurieren von Datenquellen abschließen, erstellt Visual Studio außerdem boundfields und ein CheckBoxField für die Product Data-Felder in der GridView.</span><span class="sxs-lookup"><span data-stu-id="cae9a-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="cae9a-158">In diesem Tutorial dürfen die Benutzer nur den Namen, die Kategorie, den Preis und den Status des Produkts anzeigen und bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="cae9a-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="cae9a-159">Entfernen Sie alle Felder außer den Feldern `ProductName`, `CategoryName`, `UnitPrice`und `Discontinued`, und benennen Sie die `HeaderText` Eigenschaften der ersten drei Felder in Product, Category bzw. Price um.</span><span class="sxs-lookup"><span data-stu-id="cae9a-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="cae9a-160">Aktivieren Sie abschließend die Kontrollkästchen Paging aktivieren und Sortierung aktivieren im Smarttag GridView s.</span><span class="sxs-lookup"><span data-stu-id="cae9a-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="cae9a-161">An diesem Punkt enthält die GridView drei boundfields (`ProductName`, `CategoryName`und `UnitPrice`) und ein CheckBoxField (`Discontinued`).</span><span class="sxs-lookup"><span data-stu-id="cae9a-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="cae9a-162">Diese vier Felder müssen in templatefields konvertiert und dann die Bearbeitungs Schnittstelle von der `EditItemTemplate` TemplateField s in den `ItemTemplate`verschoben werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="cae9a-163">Wir haben das Erstellen und Anpassen von templatefields im Tutorial [Anpassen der Daten Änderungs Schnittstelle](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) untersucht.</span><span class="sxs-lookup"><span data-stu-id="cae9a-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial.</span></span> <span data-ttu-id="cae9a-164">Wir führen Sie durch die Schritte zum Konvertieren von boundfields und CheckBoxField in templatefields und zum Definieren Ihrer Bearbeitungs Schnittstellen in ihren `ItemTemplate` en. Wenn Sie jedoch hängen bleiben oder ein Aktualisierungs Programm benötigen, können Sie sich nicht mehr auf dieses vorherige Tutorial zurückgreifen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>

<span data-ttu-id="cae9a-165">Klicken Sie in der GridView s-Smarttag auf den Link Spalten bearbeiten, um das Dialogfeld Felder zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="cae9a-166">Wählen Sie als nächstes jedes Feld aus, und klicken Sie auf das Feld dieses Feld in einen TemplateField-Link konvertieren.</span><span class="sxs-lookup"><span data-stu-id="cae9a-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>

![Vorhandene boundfields und CheckBoxField in TemplateField konvertieren](batch-updating-cs/_static/image5.gif)

<span data-ttu-id="cae9a-168">**Abbildung 5**: Konvertieren der vorhandenen boundfields und CheckBoxField in TemplateField</span><span class="sxs-lookup"><span data-stu-id="cae9a-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateField</span></span>

<span data-ttu-id="cae9a-169">Da jedes Feld nun ein TemplateField ist, können Sie die Bearbeitungs Schnittstelle aus den `EditItemTemplate` s in die `ItemTemplate` s verschieben.</span><span class="sxs-lookup"><span data-stu-id="cae9a-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="cae9a-170">Schritt 2: Erstellen der Schnittstellen für`ProductName`,`UnitPrice`und`Discontinued`Bearbeitung</span><span class="sxs-lookup"><span data-stu-id="cae9a-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="cae9a-171">Das Erstellen der `ProductName`, `UnitPrice`und `Discontinued` Bearbeitungs Schnittstellen ist das Thema dieses Schritts und ist recht unkompliziert, da jede Schnittstelle bereits in der `EditItemTemplate`TemplateField s definiert ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="cae9a-172">Das Erstellen der `CategoryName` Bearbeitungs Schnittstelle ist etwas komplizierter, da wir eine Dropdown Liste der entsprechenden Kategorien erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="cae9a-173">Diese `CategoryName` Bearbeitungs Schnittstelle wird in Schritt 3 behandelt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="cae9a-174">Beginnen Sie mit der `ProductName` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="cae9a-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="cae9a-175">Klicken Sie in der GridView s-Smarttag auf den Link Vorlagen bearbeiten, und führen Sie einen Drilldown zum `ProductName` TemplateField s `EditItemTemplate`aus.</span><span class="sxs-lookup"><span data-stu-id="cae9a-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="cae9a-176">Wählen Sie das Textfeld aus, kopieren Sie es in die Zwischenablage, und fügen Sie es dann in das `ProductName` TemplateField s-`ItemTemplate`ein.</span><span class="sxs-lookup"><span data-stu-id="cae9a-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="cae9a-177">Ändern Sie die Eigenschaft TextBox s `ID` in `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="cae9a-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="cae9a-178">Fügen Sie als nächstes dem `ItemTemplate` ein "Requirements dfieldvalidator" hinzu, um sicherzustellen, dass der Benutzer für jeden Produktnamen einen Wert bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="cae9a-179">Legen Sie die `ControlToValidate`-Eigenschaft auf ProductName fest. die Eigenschaft `ErrorMessage`, auf die Sie den Namen des Produkts angeben müssen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="cae9a-180">und die `Text`-Eigenschaft, die \*werden soll.</span><span class="sxs-lookup"><span data-stu-id="cae9a-180">and the `Text` property to \*.</span></span> <span data-ttu-id="cae9a-181">Nachdem Sie diese Ergänzungen an der `ItemTemplate`vorgenommen haben, sollte der Bildschirm in etwa wie in Abbildung 6 aussehen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>

<span data-ttu-id="cae9a-182">[![das Element ProductName TemplateField nun ein Textfeld und ein "Requirements dfieldvalidator" enthält.](batch-updating-cs/_static/image6.gif)](batch-updating-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-cs/_static/image6.gif)](batch-updating-cs/_static/image9.png)</span></span>

<span data-ttu-id="cae9a-183">**Abbildung 6**: die `ProductName` TemplateField enthält jetzt ein Textfeld und ein "Requirements dfieldvalidator" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image10.png)).</span><span class="sxs-lookup"><span data-stu-id="cae9a-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-cs/_static/image10.png))</span></span>

<span data-ttu-id="cae9a-184">Kopieren Sie für die `UnitPrice` Bearbeitungs Schnittstelle zunächst das Textfeld aus der `EditItemTemplate` in die `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="cae9a-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="cae9a-185">Platzieren Sie als nächstes ein $ vor dem Textfeld, und legen Sie dessen `ID`-Eigenschaft auf UnitPrice und dessen `Columns`-Eigenschaft auf 8 fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="cae9a-186">Fügen Sie auch ein CompareValidator zum `UnitPrice` s `ItemTemplate` hinzu, um sicherzustellen, dass der vom Benutzer eingegebene Wert ein gültiger Währungswert ist, der größer oder gleich $0,00 ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="cae9a-187">Legen Sie die Eigenschaft Prüfungs s `ControlToValidate` auf UnitPrice fest, deren `ErrorMessage`-Eigenschaft auf Sie müssen einen gültigen Währungswert eingeben.</span><span class="sxs-lookup"><span data-stu-id="cae9a-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="cae9a-188">Lassen Sie alle Währungssymbole aus., dessen `Text` Eigenschaft \*, die `Type` Eigenschaft für `Currency`, die `Operator`-Eigenschaft `GreaterThanEqual`und deren `ValueToCompare`-Eigenschaft auf 0 (null).</span><span class="sxs-lookup"><span data-stu-id="cae9a-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>

<span data-ttu-id="cae9a-189">[![einen CompareValidator hinzufügen, um sicherzustellen, dass der eingegebene Preis ein nicht negativer Währungswert ist.](batch-updating-cs/_static/image7.gif)](batch-updating-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-cs/_static/image7.gif)](batch-updating-cs/_static/image11.png)</span></span>

<span data-ttu-id="cae9a-190">**Abbildung 7**: Hinzufügen eines CompareValidator, um sicherzustellen, dass der eingegebene Preis ein nicht negativer Währungswert ist ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-cs/_static/image12.png))</span></span>

<span data-ttu-id="cae9a-191">Für das `Discontinued` TemplateField können Sie das Kontrollkästchen verwenden, das bereits in der `ItemTemplate`definiert ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="cae9a-192">Legen Sie den `ID` einfach auf "nicht eingestellt" und dessen `Enabled`-Eigenschaft auf `true`fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-192">Simply set its `ID` to Discontinued and its `Enabled` property to `true`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="cae9a-193">Schritt 3: Erstellen der`CategoryName`Bearbeitungs Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="cae9a-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="cae9a-194">Die Bearbeitungs Schnittstelle in der `CategoryName` TemplateField s `EditItemTemplate` enthält ein Textfeld, in dem der Wert des `CategoryName` Datenfelds angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="cae9a-195">Wir müssen dies durch eine Dropdown List ersetzen, die die möglichen Kategorien auflistet.</span><span class="sxs-lookup"><span data-stu-id="cae9a-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="cae9a-196">Das Tutorial zum [Anpassen der Daten Änderungs Schnittstelle](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) enthält eine ausführlichere und vollständigste Erläuterung zum Anpassen einer Vorlage, um eine Dropdown List im Gegensatz zu einem Textfeld einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="cae9a-197">Obwohl die hier beschriebenen Schritte durchgeführt wurden, werden Sie auf die gleiche Weise dargestellt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="cae9a-198">Eine ausführlichere Betrachtung der Erstellung und Konfiguration der Dropdown List-Kategorien finden Sie im Tutorial [Anpassen der Daten Änderungs Schnittstelle](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="cae9a-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial.</span></span>

<span data-ttu-id="cae9a-199">Ziehen Sie eine Dropdown List aus der Toolbox auf die `CategoryName` TemplateField s `ItemTemplate`, und legen Sie deren `ID` auf `Categories`fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="cae9a-200">An diesem Punkt definieren wir in der Regel die DropDownLists s-Datenquelle über das Smarttags und erstellen eine neue ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="cae9a-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="cae9a-201">Dadurch wird jedoch die ObjectDataSource innerhalb der `ItemTemplate`hinzugefügt, was dazu führt, dass für jede Zeile der GridView-Instanz eine ObjectDataSource-Instanz erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="cae9a-202">Erstellen Sie stattdessen die ObjectDataSource außerhalb der GridView s templatefields.</span><span class="sxs-lookup"><span data-stu-id="cae9a-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="cae9a-203">Beenden Sie die Vorlagen Bearbeitung, und ziehen Sie ObjectDataSource aus der Toolbox auf den Designer unterhalb der `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="cae9a-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="cae9a-204">Benennen Sie den neuen ObjectDataSource-`CategoriesDataSource`, und konfigurieren Sie ihn so, dass er die `CategoriesBLL` Class s `GetCategories`-Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="cae9a-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>

<span data-ttu-id="cae9a-205">[![Konfigurieren von ObjectDataSource für die Verwendung der Klasse "kategoriesbll"](batch-updating-cs/_static/image8.gif)](batch-updating-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-cs/_static/image8.gif)](batch-updating-cs/_static/image13.png)</span></span>

<span data-ttu-id="cae9a-206">**Abbildung 8**: Konfigurieren von ObjectDataSource für die Verwendung der `CategoriesBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-cs/_static/image14.png))</span></span>

<span data-ttu-id="cae9a-207">[![die Kategoriedaten mithilfe der GetCategories-Methode abrufen.](batch-updating-cs/_static/image9.gif)](batch-updating-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-cs/_static/image9.gif)](batch-updating-cs/_static/image15.png)</span></span>

<span data-ttu-id="cae9a-208">**Abbildung 9**: Abrufen der Kategorieinformationen mithilfe der `GetCategories`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-cs/_static/image16.png))</span></span>

<span data-ttu-id="cae9a-209">Da diese ObjectDataSource lediglich zum Abrufen von Daten verwendet wird, legen Sie die Dropdown Listen auf den Registerkarten aktualisieren und löschen auf (keine) fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="cae9a-210">Klicken Sie auf Fertigstellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-210">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="cae9a-211">[![die Dropdown Listen auf den Registerkarten aktualisieren und löschen auf (keine) festgelegt.](batch-updating-cs/_static/image10.gif)](batch-updating-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-cs/_static/image10.gif)](batch-updating-cs/_static/image17.png)</span></span>

<span data-ttu-id="cae9a-212">**Abbildung 10**: Festlegen der Dropdown Listen auf den Registerkarten "Aktualisieren" und "Löschen" auf "(keine)" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-cs/_static/image18.png))</span></span>

<span data-ttu-id="cae9a-213">Nachdem Sie den Assistenten abgeschlossen haben, sollte das deklarative Markup der `CategoriesDataSource` wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="cae9a-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>

[!code-aspx[Main](batch-updating-cs/samples/sample2.aspx)]

<span data-ttu-id="cae9a-214">Nachdem Sie die `CategoriesDataSource` erstellt und konfiguriert haben, kehren Sie zum `CategoryName` TemplateField s `ItemTemplate` zurück, und klicken Sie im Smarttag DropDownList s auf den Link Datenquelle auswählen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="cae9a-215">Wählen Sie im Assistenten zum Konfigurieren von Datenquellen in der ersten Dropdown Liste die Option `CategoriesDataSource` aus, und wählen Sie aus, dass `CategoryName` für die Anzeige und `CategoryID` als Wert verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="cae9a-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>

<span data-ttu-id="cae9a-216">[!["Dropdown List" an "categoriesdatasource" binden](batch-updating-cs/_static/image11.gif)](batch-updating-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-cs/_static/image11.gif)](batch-updating-cs/_static/image19.png)</span></span>

<span data-ttu-id="cae9a-217">**Abbildung 11**: Binden der Dropdown List an den `CategoriesDataSource` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-cs/_static/image20.png))</span></span>

<span data-ttu-id="cae9a-218">An diesem Punkt listet der `Categories` Dropdown List alle Kategorien auf, aber es wird noch nicht automatisch die entsprechende Kategorie für das an die GridView-Zeile gebundene Produkt ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="cae9a-219">Um dies zu erreichen, müssen wir die `Categories` DropDownList s-`SelectedValue` auf den Product s `CategoryID` Wert festlegen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="cae9a-220">Klicken Sie im Smarttag DropDownList s auf den Link DataBindings bearbeiten, und ordnen Sie die `SelectedValue`-Eigenschaft dem `CategoryID` Datenfeld zu, wie in Abbildung 12 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>

![Binden Sie den Wert des Product s CategoryID an die DropDownList s SelectedValue-Eigenschaft.](batch-updating-cs/_static/image12.gif)

<span data-ttu-id="cae9a-222">**Abbildung 12**: Binden des Product s `CategoryID` Werts an die DropDownList s `SelectedValue`-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="cae9a-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>

<span data-ttu-id="cae9a-223">Ein letztes Problem bleibt bestehen: Wenn für das Produkt kein `CategoryID` Wert angegeben wird, führt die Datenbindung-Anweisung auf `SelectedValue` zu einer Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="cae9a-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="cae9a-224">Dies liegt daran, dass DropDownList nur Elemente für die Kategorien enthält und keine Option für die Produkte bietet, die einen `NULL` Daten Bank Wert für `CategoryID`haben.</span><span class="sxs-lookup"><span data-stu-id="cae9a-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="cae9a-225">Um dieses Problem zu beheben, legen Sie die Eigenschaft DropDownList s `AppendDataBoundItems` auf `true` fest, und fügen Sie der Dropdown Liste ein neues Element hinzu, wobei die Eigenschaft `Value` aus der deklarativen Syntax weggelassen wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `true` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="cae9a-226">Stellen Sie also sicher, dass die deklarative Syntax `Categories` DropDownList s wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="cae9a-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>

[!code-aspx[Main](batch-updating-cs/samples/sample3.aspx)]

<span data-ttu-id="cae9a-227">Beachten Sie, dass die `<asp:ListItem Value="">`--Select-Eigenschaft ein-`Value` Attribut explizit auf eine leere Zeichenfolge festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="cae9a-228">Im Tutorial zum [Anpassen der Daten Änderungs Schnittstelle](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) finden Sie eine ausführlichere Erläuterung dazu, warum dieses zusätzliche DropDownList-Element benötigt wird, um den `NULL` Fall zu behandeln, und warum die Zuweisung der `Value` Eigenschaft zu einer leeren Zeichenfolge erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="cae9a-229">Es gibt ein potenzielles Problem mit der Leistung und Skalierbarkeit, das erwähnt werden sollte.</span><span class="sxs-lookup"><span data-stu-id="cae9a-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="cae9a-230">Da jede Zeile über eine Dropdown List verfügt, die die `CategoriesDataSource` als Datenquelle verwendet, wird die `CategoriesBLL` Class s `GetCategories`-Methode *n* -Mal pro Seitenbesuch aufgerufen, wobei *n* die Anzahl der Zeilen in der GridView ist.</span><span class="sxs-lookup"><span data-stu-id="cae9a-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="cae9a-231">Diese *n* Aufrufe von `GetCategories` führen zu *n* Abfragen an die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="cae9a-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="cae9a-232">Diese Auswirkung auf die Datenbank kann verringert werden, indem die zurückgegebenen Kategorien entweder in einem Anforderungs bezogenen Cache oder über die zwischen Speicherungs Schicht mithilfe einer SQL-zwischen Speicherungs Abhängigkeit oder einem sehr kurzen zeitbasierten Ablauf zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="cae9a-233">Weitere Informationen zur Cache Option pro Anforderung finden Sie unter [`HttpContext.Items` eines Cache Speichers pro Anforderung](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="cae9a-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>

## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="cae9a-234">Schritt 4: Abschließen der Bearbeitungs Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="cae9a-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="cae9a-235">Wir haben eine Reihe von Änderungen an den GridView s-Vorlagen vorgenommen, ohne den Fortschritt anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="cae9a-236">Nehmen Sie sich einen Moment Zeit, um den Fortschritt über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="cae9a-237">Wie in Abbildung 13 gezeigt, wird jede Zeile mit der `ItemTemplate`gerendert, die die Bearbeitungs Schnittstelle für Zellen enthält.</span><span class="sxs-lookup"><span data-stu-id="cae9a-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>

<span data-ttu-id="cae9a-238">[![jeder GridView-Zeile kann bearbeitet werden.](batch-updating-cs/_static/image13.gif)](batch-updating-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-238">[![Each GridView Row is Editable](batch-updating-cs/_static/image13.gif)](batch-updating-cs/_static/image21.png)</span></span>

<span data-ttu-id="cae9a-239">**Abbildung 13**: die einzelnen GridView-Zeilen können bearbeitet werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-cs/_static/image22.png))</span></span>

<span data-ttu-id="cae9a-240">An dieser Stelle sind einige geringfügige Formatierungs Probleme zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="cae9a-241">Beachten Sie zunächst, dass der `UnitPrice` Wert vier Dezimalstellen enthält.</span><span class="sxs-lookup"><span data-stu-id="cae9a-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="cae9a-242">Um dieses Problem zu beheben, kehren Sie zur `UnitPrice` TemplateField s `ItemTemplate` zurück, und klicken Sie im TextBox-smarttagtag auf den Link DataBindings bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="cae9a-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="cae9a-243">Geben Sie als nächstes an, dass die `Text`-Eigenschaft als Zahl formatiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="cae9a-243">Next, specify that the `Text` property should be formatted as a number.</span></span>

![Formatieren der Text-Eigenschaft als Zahl](batch-updating-cs/_static/image14.gif)

<span data-ttu-id="cae9a-245">**Abbildung 14**: Formatieren der `Text`-Eigenschaft als Zahl</span><span class="sxs-lookup"><span data-stu-id="cae9a-245">**Figure 14**: Format the `Text` Property as a Number</span></span>

<span data-ttu-id="cae9a-246">Im zweiten Bereich können Sie das Kontrollkästchen in der `Discontinued` Spalte zentrieren (anstatt Sie linksbündig auszurichten).</span><span class="sxs-lookup"><span data-stu-id="cae9a-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="cae9a-247">Klicken Sie in der GridView s-Smarttag auf Spalten bearbeiten, und wählen Sie die `Discontinued` TemplateField aus der Liste der Felder in der unteren linken Ecke aus.</span><span class="sxs-lookup"><span data-stu-id="cae9a-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="cae9a-248">Führen Sie einen Drilldown in `ItemStyle` aus, und legen Sie die `HorizontalAlign`-Eigenschaft wie in Abbildung 15 dargestellt auf Center</span><span class="sxs-lookup"><span data-stu-id="cae9a-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>

![Kontrollkästchen für das unterstützte Center](batch-updating-cs/_static/image15.gif)

<span data-ttu-id="cae9a-250">**Abbildung 15**: Kontrollkästchen "`Discontinued` zentrieren"</span><span class="sxs-lookup"><span data-stu-id="cae9a-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>

<span data-ttu-id="cae9a-251">Fügen Sie anschließend der Seite ein ValidationSummary-Steuerelement hinzu, und legen Sie dessen `ShowMessageBox`-Eigenschaft auf `true` und dessen `ShowSummary`-Eigenschaft auf `false`fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="cae9a-252">Fügen Sie auch die Schaltflächen-websteuer Elemente hinzu, die die Änderungen des Benutzers aktualisieren, wenn Sie darauf klicken.</span><span class="sxs-lookup"><span data-stu-id="cae9a-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="cae9a-253">Fügen Sie insbesondere zwei Schaltflächen-websteuer Elemente hinzu, eine oberhalb der GridView und eine darunter, und legen Sie beide Steuerelemente `Text` Eigenschaften zum Aktualisieren von Produkten fest.</span><span class="sxs-lookup"><span data-stu-id="cae9a-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="cae9a-254">Da die GridView s-Bearbeitungs Schnittstelle in den templatefields-`ItemTemplate` s definiert ist, sind die `EditItemTemplate` s überflüssig und können gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="cae9a-255">Nachdem Sie die oben genannten Formatierungs Änderungen vorgenommen, die Schaltflächen-Steuerelemente hinzugefügt und die nicht benötigten `EditItemTemplate` s entfernt haben, sollte die deklarative Syntax Ihrer Seite s wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="cae9a-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](batch-updating-cs/samples/sample4.aspx)]

<span data-ttu-id="cae9a-256">Abbildung 16 zeigt diese Seite, wenn Sie über einen Browser angezeigt werden, nachdem die Schaltflächen-websteuer Elemente hinzugefügt und die Formatierungs Änderungen vorgenommen wurden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>

<span data-ttu-id="cae9a-257">[![die Seite jetzt zwei Schaltflächen zum Aktualisieren von Produkten enthält.](batch-updating-cs/_static/image16.gif)](batch-updating-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="cae9a-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-cs/_static/image16.gif)](batch-updating-cs/_static/image23.png)</span></span>

<span data-ttu-id="cae9a-258">**Abbildung 16**: die Seite enthält jetzt zwei Schaltflächen zum Aktualisieren[von Produkten (Klicken Sie, um das Bild in voller Größe anzuzeigen](batch-updating-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="cae9a-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-cs/_static/image24.png))</span></span>

## <a name="step-5-updating-the-products"></a><span data-ttu-id="cae9a-259">Schritt 5: Aktualisieren der Produkte</span><span class="sxs-lookup"><span data-stu-id="cae9a-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="cae9a-260">Wenn ein Benutzer auf diese Seite wechselt, führt er die Änderungen aus und klickt dann auf eine der beiden Schaltflächen zum Aktualisieren von Produkten.</span><span class="sxs-lookup"><span data-stu-id="cae9a-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="cae9a-261">An dieser Stelle müssen wir die vom Benutzer eingegebenen Werte für jede Zeile in einer `ProductsDataTable`-Instanz speichern und diese dann an eine BLL-Methode übergeben, die diese `ProductsDataTable` Instanz an die DAL-`UpdateWithTransaction`-Methode übergibt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="cae9a-262">Mit der `UpdateWithTransaction`-Methode, die wir im [vorherigen Tutorial](wrapping-database-modifications-within-a-transaction-cs.md)erstellt haben, wird sichergestellt, dass der Batch von Änderungen als atomarer Vorgang aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-cs.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="cae9a-263">Erstellen Sie eine Methode mit dem Namen `BatchUpdate` in `BatchUpdate.aspx.cs`, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="cae9a-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.cs` and add the following code:</span></span>

[!code-csharp[Main](batch-updating-cs/samples/sample5.cs)]

<span data-ttu-id="cae9a-264">Diese Methode beginnt, indem alle Produkte mithilfe eines Aufrufens der `GetProducts`-Methode der BLL s in einer `ProductsDataTable` zurückerhalten werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="cae9a-265">Anschließend wird die `ProductGrid` GridView s [`Rows`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx)Auflistung aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="cae9a-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="cae9a-266">Die `Rows`-Auflistung enthält eine [`GridViewRow` Instanz](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) für jede in der GridView angezeigte Zeile.</span><span class="sxs-lookup"><span data-stu-id="cae9a-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="cae9a-267">Da höchstens zehn Zeilen pro Seite angezeigt werden, enthält die GridView s-`Rows` Sammlung höchstens zehn Elemente.</span><span class="sxs-lookup"><span data-stu-id="cae9a-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="cae9a-268">Für jede Zeile wird die `ProductID` aus der `DataKeys` Auflistung und die entsprechende `ProductsRow` aus der `ProductsDataTable`ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="cae9a-269">Auf die vier TemplateField-Eingabe Steuerelemente wird Programm gesteuert verwiesen, und ihre Werte werden den Eigenschaften der `ProductsRow`-Instanz zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="cae9a-270">Nachdem alle GridView-Zeilen Werte verwendet wurden, um die `ProductsDataTable`zu aktualisieren, werden Sie an die BLL s-`UpdateWithTransaction`-Methode übermittelt, die wie im vorherigen Tutorial bereits in der `UpdateWithTransaction`-Methode von Dal aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="cae9a-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="cae9a-271">Der für dieses Tutorial verwendete Batch Aktualisierungs Algorithmus aktualisiert jede Zeile in der `ProductsDataTable`, die einer Zeile in der GridView entspricht, unabhängig davon, ob die Produkt-e-Informationen geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="cae9a-272">Diese Blind Updates sind zwar in der Regel kein Leistungsproblem, aber Sie können zu überflüssigen Datensätzen führen, wenn Sie Änderungen an der Datenbanktabelle erneut überwachen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-272">While such blind updates aren't usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="cae9a-273">Wieder im Tutorial zum [Durchführen von Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) haben wir eine Batch Aktualisierungs Schnittstelle mit dem DataList untersucht und Code hinzugefügt, mit dem nur die Datensätze aktualisiert werden, die tatsächlich vom Benutzer geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="cae9a-274">Wenn gewünscht, können Sie die Verfahren aus der [Ausführung von Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) verwenden, um den Code in diesem Tutorial zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="cae9a-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="cae9a-275">Wenn die Datenquelle über das Smarttag an die GridView gebunden wird, weist Visual Studio automatisch die-Primärschlüssel Werte der Datenquelle der GridView s-`DataKeyNames`-Eigenschaft zu.</span><span class="sxs-lookup"><span data-stu-id="cae9a-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="cae9a-276">Wenn Sie ObjectDataSource nicht wie in Schritt 1 beschrieben an das GridView-Smarttag gebunden haben, müssen Sie die Eigenschaft GridView s `DataKeyNames` manuell auf ProductID festlegen, um auf den `ProductID` Wert für jede Zeile über die `DataKeys` Auflistung zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>

<span data-ttu-id="cae9a-277">Der in `BatchUpdate` verwendete Code ähnelt dem, der in den `UpdateProduct` Methoden der BLL s verwendet wird. der Hauptunterschied besteht darin, dass in den `UpdateProduct`-Methoden nur eine einzige `ProductRow` Instanz aus der Architektur abgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="cae9a-278">Der Code, der die Eigenschaften des `ProductRow` zuweist, ist zwischen den `UpdateProducts` Methoden und dem Code innerhalb der `foreach`-Schleife in `BatchUpdate`identisch, wie das Gesamt Muster.</span><span class="sxs-lookup"><span data-stu-id="cae9a-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `foreach` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="cae9a-279">Um dieses Tutorial abzuschließen, muss die `BatchUpdate`-Methode aufgerufen werden, wenn auf eine der Schaltflächen zum Aktualisieren von Produkten geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="cae9a-280">Erstellen Sie Ereignishandler für die `Click`-Ereignisse dieser beiden Schaltflächen-Steuerelemente, und fügen Sie den folgenden Code in den Ereignis Handlern ein:</span><span class="sxs-lookup"><span data-stu-id="cae9a-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>

[!code-csharp[Main](batch-updating-cs/samples/sample6.cs)]

<span data-ttu-id="cae9a-281">Zuerst wird ein-`BatchUpdate`aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="cae9a-282">Im nächsten Schritt wird das `ClientScript property` zum Einfügen von JavaScript verwendet, das eine MessageBox anzeigt, die liest, dass die Produkte aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-282">Next, the `ClientScript property` is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="cae9a-283">Nehmen Sie sich einen Moment Zeit, um diesen Code zu testen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-283">Take a minute to test out this code.</span></span> <span data-ttu-id="cae9a-284">Besuchen Sie `BatchUpdate.aspx` über einen Browser, bearbeiten Sie eine Reihe von Zeilen, und klicken Sie auf eine der Schaltflächen zum Aktualisieren von Produkten.</span><span class="sxs-lookup"><span data-stu-id="cae9a-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="cae9a-285">Wenn keine Eingabevalidierungsfehler vorliegen, sollte eine MessageBox angezeigt werden, die liest, dass die Produkte aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="cae9a-286">Um die Atomizität des Updates zu überprüfen, sollten Sie eine zufällige `CHECK` Einschränkung hinzufügen, wie z. b. eine, die `UnitPrice` Werte von 1234,56 nicht zulässt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="cae9a-287">Bearbeiten Sie anschließend in `BatchUpdate.aspx`eine Reihe von Datensätzen, und stellen Sie sicher, dass Sie einen der Product s `UnitPrice` Wert auf den unzulässigen Wert festlegen (1234,56).</span><span class="sxs-lookup"><span data-stu-id="cae9a-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="cae9a-288">Dies sollte zu einem Fehler führen, wenn Sie während dieses Batch Vorgangs auf Produkte aktualisieren klicken, die auf die ursprünglichen Werte zurückgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="cae9a-289">Eine Alternative`BatchUpdate`-Methode</span><span class="sxs-lookup"><span data-stu-id="cae9a-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="cae9a-290">Die `BatchUpdate` Methode, die wir gerade überprüft haben, ruft *alle* Produkte aus der BLL s-`GetProducts` Methode ab und aktualisiert dann nur die Datensätze, die in der GridView angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="cae9a-291">Diese Vorgehensweise ist ideal, wenn die GridView kein Paging verwendet, aber wenn dies der Fall ist, gibt es möglicherweise Hunderte, Tausende oder Zehntausende von Produkten, aber nur zehn Zeilen in der GridView.</span><span class="sxs-lookup"><span data-stu-id="cae9a-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="cae9a-292">In einem solchen Fall ist es weniger als ideal, alle Produkte aus der Datenbank zu ändern, um 10 davon zu ändern.</span><span class="sxs-lookup"><span data-stu-id="cae9a-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="cae9a-293">Für diese Art von Situationen sollten Sie stattdessen die folgende `BatchUpdateAlternate`-Methode verwenden:</span><span class="sxs-lookup"><span data-stu-id="cae9a-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>

[!code-csharp[Main](batch-updating-cs/samples/sample7.cs)]

<span data-ttu-id="cae9a-294">`BatchMethodAlternate` beginnt mit dem Erstellen einer neuen leeren `ProductsDataTable` mit dem Namen `products`.</span><span class="sxs-lookup"><span data-stu-id="cae9a-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="cae9a-295">Anschließend werden die `Rows` Auflistung von GridView s durchlaufen, und für jede Zeile werden die jeweiligen Produktinformationen mithilfe der BLL s `GetProductByProductID(productID)`-Methode abgerufen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="cae9a-296">Die Eigenschaften der abgerufenen `ProductsRow` Instanz werden auf die gleiche Weise wie `BatchUpdate`aktualisiert, aber nach dem Aktualisieren der Zeile wird Sie über die Datentabelle [`ImportRow(DataRow)`-Methode](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx)in die `products``ProductsDataTable` importiert.</span><span class="sxs-lookup"><span data-stu-id="cae9a-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products``ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="cae9a-297">Nachdem die `foreach` Schleife abgeschlossen ist, enthält `products` eine `ProductsRow` Instanz für jede Zeile in der GridView.</span><span class="sxs-lookup"><span data-stu-id="cae9a-297">After the `foreach` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="cae9a-298">Da jede der `ProductsRow` Instanzen der `products` hinzugefügt wurde (anstatt Sie zu aktualisieren), wird die `ProductsTableAdapter` versuchen, jeden der Datensätze in die Datenbank einzufügen, wenn Sie Sie blind an die `UpdateWithTransaction`-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="cae9a-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdapter` will try to insert each of the records into the database.</span></span> <span data-ttu-id="cae9a-299">Stattdessen müssen Sie angeben, dass alle Zeilen geändert (nicht hinzugefügt) werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="cae9a-300">Dies kann durch Hinzufügen einer neuen Methode zur BLL namens `UpdateProductsWithTransaction`erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="cae9a-301">`UpdateProductsWithTransaction`, wie unten dargestellt, legt die `RowState` der einzelnen `ProductsRow` Instanzen in der `ProductsDataTable` auf `Modified` fest und übergibt dann den `ProductsDataTable` an die DAL s `UpdateWithTransaction`-Methode.</span><span class="sxs-lookup"><span data-stu-id="cae9a-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>

[!code-csharp[Main](batch-updating-cs/samples/sample8.cs)]

## <a name="summary"></a><span data-ttu-id="cae9a-302">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="cae9a-302">Summary</span></span>

<span data-ttu-id="cae9a-303">Die GridView bietet integrierte Zeilen übergreifende Bearbeitungsfunktionen, bietet jedoch keine Unterstützung für das Erstellen von vollständig bearbeitbaren Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="cae9a-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="cae9a-304">Wie in diesem Tutorial gezeigt, sind solche Schnittstellen möglich, erfordern jedoch etwas Arbeit.</span><span class="sxs-lookup"><span data-stu-id="cae9a-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="cae9a-305">Zum Erstellen einer GridView-Tabelle, in der jede Zeile bearbeitet werden kann, müssen die GridView s-Felder in templatefields konvertiert und die Bearbeitungs Schnittstelle innerhalb der `ItemTemplate` s definiert werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="cae9a-306">Darüber hinaus müssen der Seite, getrennt von der GridView, die websteuer Elemente für alle Typen aktualisieren hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="cae9a-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="cae9a-307">Diese Schaltflächen `Click` Ereignishandler müssen die GridView s `Rows` Auflistung auflisten, die Änderungen in einem `ProductsDataTable`speichern und die aktualisierten Informationen an die entsprechende BLL-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="cae9a-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="cae9a-308">Im nächsten Tutorial wird erläutert, wie eine Schnittstelle für das Löschen von Batches erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="cae9a-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="cae9a-309">Vor allem enthält jede GridView-Zeile ein Kontrollkästchen und anstelle der Schaltflächen alle Typen aktualisieren werden die Schaltflächen ausgewählte Zeilen löschen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="cae9a-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="cae9a-310">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="cae9a-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cae9a-311">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="cae9a-311">About the Author</span></span>

<span data-ttu-id="cae9a-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="cae9a-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cae9a-313">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="cae9a-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cae9a-314">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="cae9a-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cae9a-315">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cae9a-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cae9a-316">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="cae9a-316">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cae9a-317">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="cae9a-317">Special Thanks To</span></span>

<span data-ttu-id="cae9a-318">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="cae9a-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cae9a-319">Die führenden Reviewer für dieses Tutorial waren Teresa Murphy und David suru.</span><span class="sxs-lookup"><span data-stu-id="cae9a-319">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="cae9a-320">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="cae9a-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cae9a-321">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cae9a-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cae9a-322">[Zurück](wrapping-database-modifications-within-a-transaction-cs.md)
> [Weiter](batch-deleting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="cae9a-322">[Previous](wrapping-database-modifications-within-a-transaction-cs.md)
[Next](batch-deleting-cs.md)</span></span>
