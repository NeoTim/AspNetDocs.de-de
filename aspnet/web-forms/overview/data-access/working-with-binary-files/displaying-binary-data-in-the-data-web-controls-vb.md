---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
title: Anzeigen von Binärdaten in den datenweb Steuerelementen (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial betrachten wir die Optionen zum Darstellen von Binärdaten auf einer Webseite, einschließlich der Anzeige einer Bilddatei und der Bereitstellung eines "Download"-Links f...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: 9201656a-e1c2-4020-824b-18fb632d2925
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
msc.type: authoredcontent
ms.openlocfilehash: 27c901af092aa990f557750dc5d2c42ba2644c02
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78489099"
---
# <a name="displaying-binary-data-in-the-data-web-controls-vb"></a><span data-ttu-id="87f14-103">Anzeigen von Binärdaten in den Datenwebsteuerelementen (VB)</span><span class="sxs-lookup"><span data-stu-id="87f14-103">Displaying Binary Data in the Data Web Controls (VB)</span></span>

<span data-ttu-id="87f14-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="87f14-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="87f14-105">[Beispiel-app herunterladen](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) oder [PDF herunterladen](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="87f14-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span></span>

> <span data-ttu-id="87f14-106">In diesem Tutorial betrachten wir die Optionen zum Darstellen von Binärdaten auf einer Webseite, einschließlich der Anzeige einer Bilddatei und der Bereitstellung eines "Download"-Links für eine PDF-Datei.</span><span class="sxs-lookup"><span data-stu-id="87f14-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>

## <a name="introduction"></a><span data-ttu-id="87f14-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="87f14-107">Introduction</span></span>

<span data-ttu-id="87f14-108">Im vorherigen Tutorial haben wir die beiden Verfahren zum Zuordnen von Binärdaten zu einem zugrunde liegenden Datenmodell einer Anwendung untersucht und das FileUpload-Steuerelement verwendet, um Dateien aus einem Browser in das Dateisystem des Webserver s hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="87f14-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="87f14-109">Wir haben noch erfahren, wie die hochgeladenen Binärdaten dem Datenmodell zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="87f14-110">Das heißt, nachdem eine Datei hochgeladen und im Dateisystem gespeichert wurde, muss ein Pfad zur Datei im entsprechenden Datenbankdaten Satz gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="87f14-111">Wenn die Daten direkt in der Datenbank gespeichert werden, müssen die hochgeladenen Binärdaten nicht im Dateisystem gespeichert werden, sondern müssen in die Datenbank eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="87f14-112">Bevor wir uns mit der Zuordnung der Daten zum Datenmodell befassen, sehen wir uns jedoch zunächst an, wie die Binärdaten für den Endbenutzer bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="87f14-113">Das darstellen von Textdaten ist einfach genug, aber wie sollen Binärdaten angezeigt werden?</span><span class="sxs-lookup"><span data-stu-id="87f14-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="87f14-114">Dies hängt natürlich von der Art der Binärdaten ab.</span><span class="sxs-lookup"><span data-stu-id="87f14-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="87f14-115">Bei Bildern möchten wir wahrscheinlich das Bild anzeigen. für PDF-Dateien, Microsoft Word-Dokumente, ZIP-Dateien und andere Typen von Binärdaten ist die Bereitstellung eines Download Links wahrscheinlich besser geeignet.</span><span class="sxs-lookup"><span data-stu-id="87f14-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="87f14-116">In diesem Tutorial wird erläutert, wie die Binärdaten zusammen mit den zugehörigen Textdaten mithilfe von datenweb-Steuerelementen wie GridView und DetailsView präsentiert werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="87f14-117">Im nächsten Tutorial wird das Verknüpfen einer hochgeladenen Datei mit der Datenbank berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="87f14-118">Schritt 1: Bereitstellen von`BrochurePath`Werten</span><span class="sxs-lookup"><span data-stu-id="87f14-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="87f14-119">Die Spalte `Picture` in der `Categories` Tabelle enthält bereits Binärdaten für die verschiedenen kategorieimages.</span><span class="sxs-lookup"><span data-stu-id="87f14-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="87f14-120">Insbesondere die Spalte `Picture` für jeden Datensatz enthält den binären Inhalt eines Grad-Bitmap-Bilds mit niedriger Qualität.</span><span class="sxs-lookup"><span data-stu-id="87f14-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="87f14-121">Jedes Kategoriebild ist 172 Pixel breit und 120 Pixel hoch und verbraucht ungefähr 11 KB.</span><span class="sxs-lookup"><span data-stu-id="87f14-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="87f14-122">Darüber hinaus enthält der binäre Inhalt in der `Picture`-Spalte einen 78-Byte- [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) -Header, der vor dem Anzeigen des Bilds entfernt werden muss.</span><span class="sxs-lookup"><span data-stu-id="87f14-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="87f14-123">Diese Header Informationen sind vorhanden, da die Northwind-Datenbank ihre Stämme in Microsoft Access hat.</span><span class="sxs-lookup"><span data-stu-id="87f14-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="87f14-124">In Access werden Binärdaten mithilfe des OLE-Objekt Datentyps gespeichert, der in diesem Header Tacks speichert.</span><span class="sxs-lookup"><span data-stu-id="87f14-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="87f14-125">Vorerst sehen Sie, wie Sie die Header aus diesen Bildern mit niedriger Qualität entfernen, um das Bild anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="87f14-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="87f14-126">In einem zukünftigen Tutorial erstellen wir eine Schnittstelle zum Aktualisieren der Kategorie s `Picture` Spalte und ersetzen diese Bitmap-Bilder, die OLE-Header mit äquivalenten jpg-Bildern ohne unnötige OLE-Header verwenden.</span><span class="sxs-lookup"><span data-stu-id="87f14-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="87f14-127">Im vorherigen Tutorial haben Sie erfahren, wie Sie das FileUpload-Steuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="87f14-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="87f14-128">Aus diesem Grund können Sie dem Webserver-Dateisystem-Dateisystem-Konsolen Dateien hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="87f14-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="87f14-129">Dadurch wird jedoch die `BrochurePath` Spalte in der `Categories` Tabelle nicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="87f14-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="87f14-130">Im nächsten Tutorial erfahren Sie, wie Sie dies erreichen, aber vorerst müssen wir die Werte für diese Spalte manuell angeben.</span><span class="sxs-lookup"><span data-stu-id="87f14-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="87f14-131">In diesem Tutorial finden Sie sieben PDF-Datei Dateien im Ordner "`~/Brochures`", eine für jede Kategorie mit Ausnahme von "Meeresfrüchte".</span><span class="sxs-lookup"><span data-stu-id="87f14-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="87f14-132">Ich habe absichtlich das Hinzufügen einer Seafood-Broschüre ausgelassen, um zu veranschaulichen, wie Szenarios behandelt werden, bei denen nicht alle Datensätze binäre Daten</span><span class="sxs-lookup"><span data-stu-id="87f14-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="87f14-133">Um die `Categories` Tabelle mit diesen Werten zu aktualisieren, klicken Sie mit der rechten Maustaste auf den Knoten `Categories` von Server-Explorer, und wählen Sie Tabellendaten anzeigen aus.</span><span class="sxs-lookup"><span data-stu-id="87f14-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="87f14-134">Geben Sie dann die virtuellen Pfade zu den Prospekt Dateien für jede Kategorie ein, die eine-Broschüre enthält, wie in Abbildung 1 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="87f14-135">Da es keine Broschüre für die Kategorie "Seafood" gibt, belassen Sie den Wert der `BrochurePath` Spalte `NULL`.</span><span class="sxs-lookup"><span data-stu-id="87f14-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>

<span data-ttu-id="87f14-136">[![die Werte für die Spalte "categories" in der Tabelle "Kategoriepfad" manuell eingeben](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span></span>

<span data-ttu-id="87f14-137">**Abbildung 1**: Manuelles Eingeben der Werte für den `Categories` Tabelle s `BrochurePath` Spalte ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span></span>

## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="87f14-138">Schritt 2: Bereitstellen eines Download Links für die Broschüren in einer GridView</span><span class="sxs-lookup"><span data-stu-id="87f14-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="87f14-139">Mit den `BrochurePath` Werten, die für die Tabelle "`Categories`" bereitgestellt werden, können wir erneut eine GridView erstellen, die jede Kategorie zusammen mit einem Link zum Herunterladen der Kategorie "Category" auflistet.</span><span class="sxs-lookup"><span data-stu-id="87f14-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="87f14-140">In Schritt 4 erweitern wir diese GridView, um auch das Bild der Kategorie s anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="87f14-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="87f14-141">Ziehen Sie zunächst eine GridView aus der Toolbox auf den Designer der Seite `DisplayOrDownloadData.aspx` im Ordner `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="87f14-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="87f14-142">Legen Sie die `ID` GridView s auf `Categories` und durch das Smarttag GridView s fest, das Sie an eine neue Datenquelle binden möchten.</span><span class="sxs-lookup"><span data-stu-id="87f14-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="87f14-143">Binden Sie Sie insbesondere an eine ObjectDataSource mit dem Namen `CategoriesDataSource`, die Daten mithilfe der `CategoriesBLL` Object s `GetCategories()`-Methode abruft.</span><span class="sxs-lookup"><span data-stu-id="87f14-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>

<span data-ttu-id="87f14-144">[![erstellen Sie eine neue ObjectDataSource mit dem Namen "categoriesdatasource".](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span></span>

<span data-ttu-id="87f14-145">**Abbildung 2**: Erstellen einer neuen ObjectDataSource mit dem Namen "`CategoriesDataSource`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span></span>

<span data-ttu-id="87f14-146">[![Konfigurieren von ObjectDataSource für die Verwendung der Klasse "kategoriesbll"](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span></span>

<span data-ttu-id="87f14-147">**Abbildung 3**: Konfigurieren von ObjectDataSource für die Verwendung der `CategoriesBLL`-Klasse ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span></span>

<span data-ttu-id="87f14-148">[![die Liste der Kategorien mithilfe der GetCategories ()-Methode abzurufen.](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span></span>

<span data-ttu-id="87f14-149">**Abbildung 4**: Abrufen der Liste der Kategorien mit der `GetCategories()`-Methode ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span></span>

<span data-ttu-id="87f14-150">Nachdem Sie den Assistenten zum Konfigurieren von Datenquellen abgeschlossen haben, fügt Visual Studio der `Categories` GridView automatisch ein BoundField für die `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`und `BrochurePath` `DataColumn` s hinzu.</span><span class="sxs-lookup"><span data-stu-id="87f14-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="87f14-151">Entfernen Sie den `NumberOfProducts` BoundField, da die Abfrage der `GetCategories()` Methode diese Informationen nicht abruft.</span><span class="sxs-lookup"><span data-stu-id="87f14-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="87f14-152">Entfernen Sie außerdem das `CategoryID` BoundField, und benennen Sie die `CategoryName` und `BrochurePath` boundfields `HeaderText` Eigenschaften in Category bzw.</span><span class="sxs-lookup"><span data-stu-id="87f14-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="87f14-153">Nachdem Sie diese Änderungen vorgenommen haben, sollten das deklarative Markup der GridView-und ObjectDataSource-Objekte wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="87f14-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample1.aspx)]

<span data-ttu-id="87f14-154">Diese Seite über einen Browser anzeigen (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="87f14-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="87f14-155">Jede der acht Kategorien ist aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="87f14-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="87f14-156">In den sieben Kategorien mit `BrochurePath` Werten wird der `BrochurePath` Wert im jeweiligen BoundField-Wert angezeigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="87f14-157">Bei Meeresfrüchten mit einem `NULL` Wert für die `BrochurePath`wird eine leere Zelle angezeigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>

<span data-ttu-id="87f14-158">[![werden die einzelnen Kategorien "Name", "Beschreibung" und "brochlinienpfad" aufgeführt.](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span></span>

<span data-ttu-id="87f14-159">**Abbildung 5**: die Kategorien "Name", "Beschreibung" und "`BrochurePath`" werden aufgelistet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span></span>

<span data-ttu-id="87f14-160">Anstatt den Text der `BrochurePath` Spalte anzuzeigen, möchten wir einen Link zur Broschüre erstellen.</span><span class="sxs-lookup"><span data-stu-id="87f14-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="87f14-161">Um dies zu erreichen, entfernen Sie das `BrochurePath` BoundField, und ersetzen Sie es durch ein HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="87f14-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="87f14-162">Legen Sie die neue Eigenschaft "HyperLinkField s `HeaderText`" auf "Prospekt", die `Text`-Eigenschaft auf "View" und deren `DataNavigateUrlFields` Eigenschaft auf "`BrochurePath`" fest.</span><span class="sxs-lookup"><span data-stu-id="87f14-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>

![HyperLinkField für "brochurepath" hinzufügen](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.gif)

<span data-ttu-id="87f14-164">**Abbildung 6**: Hinzufügen eines HyperLinkField für `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="87f14-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>

<span data-ttu-id="87f14-165">Dadurch wird eine Spalte mit Links zur GridView hinzugefügt, wie in Abbildung 7 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="87f14-166">Wenn Sie auf einen Link zum Anzeigen der Broschüre klicken, wird die PDF-Datei entweder direkt im Browser angezeigt, oder der Benutzer wird aufgefordert, die Datei herunterzuladen, je nachdem, ob ein PDF-Reader installiert ist, und die Browsereinstellungen.</span><span class="sxs-lookup"><span data-stu-id="87f14-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>

<span data-ttu-id="87f14-167">[![eine Kategorie s-Broschüre angezeigt werden, indem Sie auf den Link "anzeigen" klicken](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span></span>

<span data-ttu-id="87f14-168">**Abbildung 7**: eine Kategorie-s-Broschüre kann angezeigt werden, indem Sie auf den Link "anzeigen"[klicken (Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span></span>

<span data-ttu-id="87f14-169">[![die PDF-Datei der Kategorie s wird angezeigt.](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span></span>

<span data-ttu-id="87f14-170">**Abbildung 8**: die PDF-Datei der Kategorie s wird angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span></span>

## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="87f14-171">Ausblenden des Texts der Ansichts Broschüre für Kategorien ohne eine Broschüre</span><span class="sxs-lookup"><span data-stu-id="87f14-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="87f14-172">Wie in Abbildung 7 dargestellt, zeigt der `BrochurePath` HyperLinkField seinen `Text`-Eigenschafts Wert ("Display") für alle Datensätze an, unabhängig davon, ob für `BrochurePath`ein nicht`NULL` Wert vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="87f14-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="87f14-173">Wenn `BrochurePath` `NULL`ist, wird der Link natürlich nur als Text angezeigt, wie es bei der Kategorie "Seafood" der Fall ist (siehe Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="87f14-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="87f14-174">Anstatt die Text Ansichts Broschüre anzuzeigen, ist es möglicherweise schön, dass diese Kategorien ohne einen `BrochurePath` Wert einen alternativen Text anzeigen, z. b. keine verfügbare Broschüre.</span><span class="sxs-lookup"><span data-stu-id="87f14-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="87f14-175">Um dieses Verhalten bereitzustellen, müssen wir ein TemplateField verwenden, dessen Inhalt durch einen Aufrufen einer Seiten Methode generiert wird, die die entsprechende Ausgabe basierend auf dem `BrochurePath` Wert ausgibt.</span><span class="sxs-lookup"><span data-stu-id="87f14-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="87f14-176">Wir untersuchten dieses Formatierungs Verfahren zunächst im Tutorial [Verwenden von templatefields im GridView-Steuer](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) Element.</span><span class="sxs-lookup"><span data-stu-id="87f14-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="87f14-177">Aktivieren Sie das HyperLinkField in ein TemplateField-Element, indem Sie das `BrochurePath` HyperLinkField auswählen und dann im Dialogfeld Spalten bearbeiten auf das Feld dieses Feld in einen TemplateField-Link konvertieren klicken.</span><span class="sxs-lookup"><span data-stu-id="87f14-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>

![Konvertieren des HyperLinkField in ein TemplateField-Element](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.gif)

<span data-ttu-id="87f14-179">**Abbildung 9**: Konvertieren des HyperLinkField in ein TemplateField-Element</span><span class="sxs-lookup"><span data-stu-id="87f14-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>

<span data-ttu-id="87f14-180">Dadurch wird ein TemplateField mit einem `ItemTemplate` erstellt, das ein Hyperlink-websteuer Element enthält, dessen `NavigateUrl`-Eigenschaft an den `BrochurePath` Wert gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="87f14-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="87f14-181">Ersetzen Sie dieses Markup durch einen-Befehl für die-Methode `GenerateBrochureLink`, und übergeben Sie dabei den Wert `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="87f14-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample2.aspx)]

<span data-ttu-id="87f14-182">Erstellen Sie als nächstes eine `Protected` Methode in der Code Behind-Klasse der ASP.net page s mit dem Namen `GenerateBrochureLink`, die eine `String` zurückgibt und eine `Object` als Eingabeparameter akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="87f14-182">Next, create a `Protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `String` and accepts an `Object` as an input parameter.</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample3.vb)]

<span data-ttu-id="87f14-183">Diese Methode bestimmt, ob es sich bei dem `Object` Wert für die Übergabe um eine Datenbank handelt `NULL` und gibt, wenn dies der Fall ist, eine Meldung zurück, die angibt, dass in der Kategorie keine</span><span class="sxs-lookup"><span data-stu-id="87f14-183">This method determines if the passed-in `Object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="87f14-184">Andernfalls, wenn ein `BrochurePath` Wert vorhanden ist, wird er in einem Hyperlink angezeigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="87f14-185">Beachten Sie Folgendes: Wenn der `BrochurePath` Wert vorhanden ist, wird er an die [`ResolveUrl(url)`-Methode](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx)übermittelt.</span><span class="sxs-lookup"><span data-stu-id="87f14-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="87f14-186">Diese Methode löst die über gegebene *URL*auf und ersetzt dabei das `~` Zeichen durch den entsprechenden virtuellen Pfad.</span><span class="sxs-lookup"><span data-stu-id="87f14-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="87f14-187">Wenn die Anwendung z. b. auf `/Tutorial55`liegt, wird `ResolveUrl("~/Brochures/Meats.pdf")` `/Tutorial55/Brochures/Meat.pdf`zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="87f14-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="87f14-188">Abbildung 10 zeigt die Seite, nachdem diese Änderungen angewendet wurden.</span><span class="sxs-lookup"><span data-stu-id="87f14-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="87f14-189">Beachten Sie, dass im Feld "`BrochurePath`" der Kategorie "" nun der Text keine-Broschüre verfügbar anzeigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>

<span data-ttu-id="87f14-190">[![der Text für diese Kategorien ohne eine Broschüre wird keine verfügbare Broschüre angezeigt](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span></span>

<span data-ttu-id="87f14-191">**Abbildung 10**: der Text keine verfügbare Broschüre wird für diese Kategorien ohne eine-Broschüre angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span></span>

## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="87f14-192">Schritt 3: Hinzufügen einer Webseite zum Anzeigen eines kategoriebilds</span><span class="sxs-lookup"><span data-stu-id="87f14-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="87f14-193">Wenn ein Benutzer eine ASP.NET Seite besucht, empfängt er das HTML-Format der ASP.NET-Seite.</span><span class="sxs-lookup"><span data-stu-id="87f14-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="87f14-194">Der empfangene HTML-Code ist nur Text und enthält keine Binärdaten.</span><span class="sxs-lookup"><span data-stu-id="87f14-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="87f14-195">Alle zusätzlichen Binärdaten, z. b. Bilder, Audiodateien, Macromedia Flash Anwendungen, eingebettete Windows Media Player-Videos usw., sind als separate Ressourcen auf dem Webserver vorhanden.</span><span class="sxs-lookup"><span data-stu-id="87f14-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="87f14-196">Der HTML-Code enthält Verweise auf diese Dateien, enthält jedoch nicht den eigentlichen Inhalt der Dateien.</span><span class="sxs-lookup"><span data-stu-id="87f14-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="87f14-197">Beispielsweise wird in HTML das `<img>`-Element verwendet, um auf ein Bild zu verweisen, wobei das `src` Attribut wie folgt auf die Bilddatei zeigt:</span><span class="sxs-lookup"><span data-stu-id="87f14-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>

[!code-html[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample4.html)]

<span data-ttu-id="87f14-198">Wenn ein Browser diese HTML-Datei empfängt, sendet er eine weitere Anforderung an den Webserver, den binären Inhalt der Bilddatei abzurufen, der dann im Browser angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="87f14-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="87f14-199">Dasselbe Konzept gilt für Binärdaten.</span><span class="sxs-lookup"><span data-stu-id="87f14-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="87f14-200">In Schritt 2 wurde die Broschüre nicht als Teil des HTML-Markups der Seite an den Browser gesendet.</span><span class="sxs-lookup"><span data-stu-id="87f14-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="87f14-201">Stattdessen gab der gerenderte HTML-Code Hyperlinks aus, die dazu geführt haben, dass der Browser das PDF-Dokument direkt angefordert hat.</span><span class="sxs-lookup"><span data-stu-id="87f14-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="87f14-202">Um Benutzern das Herunterladen von Binärdaten in der Datenbank anzuzeigen oder zuzulassen, muss eine separate Webseite erstellt werden, die die Daten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="87f14-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="87f14-203">Für unsere Anwendung gibt es nur ein binäres Daten Feld, das direkt in der Datenbank in der Kategorie s angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="87f14-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="87f14-204">Daher benötigen wir eine Seite, die beim Aufrufen die Bilddaten für eine bestimmte Kategorie zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="87f14-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="87f14-205">Fügen Sie eine neue ASP.NET-Seite zum `BinaryData` Ordner mit dem Namen `DisplayCategoryPicture.aspx`hinzu.</span><span class="sxs-lookup"><span data-stu-id="87f14-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="87f14-206">Lassen Sie dabei das Kontrollkästchen Master Seite auswählen deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="87f14-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="87f14-207">Diese Seite erwartet einen `CategoryID` Wert in der Abfrage Zeichenfolge und gibt die Binärdaten dieser Kategorie `Picture` Spalte zurück.</span><span class="sxs-lookup"><span data-stu-id="87f14-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="87f14-208">Da auf dieser Seite binäre Daten zurückgegeben werden und nichts anderes vorhanden ist, wird im HTML-Abschnitt kein Markup benötigt.</span><span class="sxs-lookup"><span data-stu-id="87f14-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="87f14-209">Klicken Sie daher in der unteren linken Ecke auf die Registerkarte Quelle, und entfernen Sie das gesamte Markup der Seite mit Ausnahme der `<%@ Page %>` Direktive.</span><span class="sxs-lookup"><span data-stu-id="87f14-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="87f14-210">Das heißt, dass `DisplayCategoryPicture.aspx` s deklaratives Markup aus einer einzelnen Zeile bestehen sollte:</span><span class="sxs-lookup"><span data-stu-id="87f14-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample5.aspx)]

<span data-ttu-id="87f14-211">Wenn das `MasterPageFile`-Attribut in der `<%@ Page %>`-Direktive angezeigt wird, entfernen Sie es.</span><span class="sxs-lookup"><span data-stu-id="87f14-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="87f14-212">Fügen Sie in der Code Behind-Klasse der Seite dem `Page_Load`-Ereignishandler den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="87f14-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample6.vb)]

<span data-ttu-id="87f14-213">Dieser Code beginnt mit dem Lesen des `CategoryID` QueryString-Werts in eine Variable mit dem Namen `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="87f14-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="87f14-214">Als nächstes werden die Bilddaten über einen aufzurufenden `CategoriesBLL` Klasse `GetCategoryWithBinaryDataByCategoryID(categoryID)`-Methode abgerufen.</span><span class="sxs-lookup"><span data-stu-id="87f14-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="87f14-215">Diese Daten werden mit der `Response.BinaryWrite(data)`-Methode an den Client zurückgegeben, aber bevor dieser aufgerufen wird, muss der OLE-Header der `Picture` Column-Wert s entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="87f14-216">Dies wird erreicht, indem ein `Byte` Array namens `strippedImageData` erstellt wird, das genau 78 Zeichen enthält, die kleiner sind als die in der `Picture` Spalte.</span><span class="sxs-lookup"><span data-stu-id="87f14-216">This is accomplished by creating a `Byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="87f14-217">Die [`Array.Copy`-Methode](https://msdn.microsoft.com/library/z50k9bft.aspx) wird verwendet, um die Daten aus `category.Picture` beginnend an der Position 78 auf `strippedImageData`zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="87f14-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="87f14-218">Die `Response.ContentType`-Eigenschaft gibt den [MIME-Typ](http://en.wikipedia.org/wiki/MIME) des Inhalts an, der zurückgegeben wird, damit der Browser weiß, wie er dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="87f14-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="87f14-219">Da es sich bei der `Categories` Tabelle `Picture` Spalte um ein Bitmap-Bild handelt, wird hier der Bitmap-MIME-Typ verwendet (Bild/BMP).</span><span class="sxs-lookup"><span data-stu-id="87f14-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="87f14-220">Wenn Sie den MIME-Typ weglassen, wird das Bild in den meisten Browsern weiterhin ordnungsgemäß angezeigt, da Sie den Typ basierend auf dem Inhalt der Binärdaten der Bilddatei-Binärdaten ableiten können.</span><span class="sxs-lookup"><span data-stu-id="87f14-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="87f14-221">Es ist jedoch ratsam, den MIME-Typ nach Möglichkeit einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="87f14-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="87f14-222">Eine komplette Liste der [MIME-Medientypen](http://www.iana.org/assignments/media-types/)finden Sie auf der [Website Internet Assigned Numbers Authority](http://www.iana.org/) .</span><span class="sxs-lookup"><span data-stu-id="87f14-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="87f14-223">Wenn diese Seite erstellt wurde, kann ein bestimmtes Bild der Kategorie angezeigt werden, indem Sie `DisplayCategoryPicture.aspx?CategoryID=categoryID`besuchen.</span><span class="sxs-lookup"><span data-stu-id="87f14-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="87f14-224">Abbildung 11 zeigt die Bildkategorie "Getränke", die in `DisplayCategoryPicture.aspx?CategoryID=1`angezeigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="87f14-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="87f14-225">[![das Bild der Kategorie "Getränke" angezeigt wird.](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span></span>

<span data-ttu-id="87f14-226">**Abbildung 11**: Bild der Kategorie "Getränke" wird angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span></span>

<span data-ttu-id="87f14-227">Wenn beim Besuch `DisplayCategoryPicture.aspx?CategoryID=categoryID`eine Ausnahme ausgelöst wird, die liest, dass ein Objekt vom Typ "System. DBNull" nicht in den Typ "System. Byte []" umgewandelt werden kann, gibt es zwei Dinge, die dies verursachen können.</span><span class="sxs-lookup"><span data-stu-id="87f14-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="87f14-228">Zuerst lässt die `Categories` Tabelle s `Picture` Spalte `NULL` Werte zu.</span><span class="sxs-lookup"><span data-stu-id="87f14-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="87f14-229">Auf der `DisplayCategoryPicture.aspx` Seite wird jedoch davon ausgegangen, dass ein nicht`NULL` Wert vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="87f14-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="87f14-230">Auf die `Picture`-Eigenschaft des `CategoriesDataTable` kann nicht direkt zugegriffen werden, wenn Sie über einen `NULL` Wert verfügt.</span><span class="sxs-lookup"><span data-stu-id="87f14-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="87f14-231">Wenn Sie `NULL` Werte für die Spalte `Picture` zulassen möchten, sollten Sie die folgende Bedingung einschließen:</span><span class="sxs-lookup"><span data-stu-id="87f14-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>

[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample7.vb)]

<span data-ttu-id="87f14-232">Der obige Code geht davon aus, dass es eine Bilddatei mit dem Namen `NoPictureAvailable.gif` im `Images` Ordner gibt, den Sie für diese Kategorien ohne Bild anzeigen möchten.</span><span class="sxs-lookup"><span data-stu-id="87f14-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="87f14-233">Diese Ausnahme kann auch dadurch verursacht werden, dass die `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` Method s `SELECT`-Anweisung in der Spaltenliste der Haupt Abfrage wieder hergestellt wurde. Dies kann vorkommen, wenn Sie Ad-hoc-SQL-Anweisungen verwenden und den Assistenten für die Haupt Abfrage TableAdapter s erneut ausführen.</span><span class="sxs-lookup"><span data-stu-id="87f14-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="87f14-234">Stellen Sie sicher, dass `GetCategoryWithBinaryDataByCategoryID` Method s `SELECT`-Anweisung weiterhin die `Picture` Spalte enthält.</span><span class="sxs-lookup"><span data-stu-id="87f14-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="87f14-235">Jedes Mal, wenn die `DisplayCategoryPicture.aspx` besucht wird, wird auf die Datenbank zugegriffen, und die Bilddaten der angegebenen Kategorie werden zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="87f14-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="87f14-236">Wenn das Bild der Kategorie nicht geändert wurde, da der Benutzer es zuletzt angezeigt hat, ist dies der Aufwand.</span><span class="sxs-lookup"><span data-stu-id="87f14-236">If the category s picture hasn't changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="87f14-237">Glücklicherweise ermöglicht http das *bedingtes*abrufen.</span><span class="sxs-lookup"><span data-stu-id="87f14-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="87f14-238">Bei einem bedingten Get sendet der Client, der die HTTP-Anforderung sendet, eine [`If-Modified-Since` http-Kopfzeile](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) , die das Datum und die Uhrzeit bereitstellt, zu der der Client diese Ressource zuletzt vom Webserver abgerufen hat.</span><span class="sxs-lookup"><span data-stu-id="87f14-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="87f14-239">Wenn sich der Inhalt seit dem angegebenen Datum nicht geändert hat, antwortet der Webserver möglicherweise mit dem [Statuscode "nicht geändert" (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) und sendet den angeforderten Inhalt der Ressource zurück.</span><span class="sxs-lookup"><span data-stu-id="87f14-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="87f14-240">Kurz gesagt, diese Vorgehensweise weist den Webserver an, den Inhalt für eine Ressource zurücksenden zu müssen, wenn Sie seit dem letzten Zugriff auf den Client nicht geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="87f14-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>

<span data-ttu-id="87f14-241">Um dieses Verhalten zu implementieren, erfordert jedoch, dass Sie der `Categories` Tabelle eine `PictureLastModified` Spalte hinzufügen, die erfasst werden soll, wenn die `Picture` Spalte zuletzt aktualisiert wurde, sowie Code zum Überprüfen des `If-Modified-Since` Headers.</span><span class="sxs-lookup"><span data-stu-id="87f14-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="87f14-242">Weitere Informationen zum `If-Modified-Since`-Header und zum bedingten Get-Workflow finden Sie unter [http Conditional Get for RSS Hacker](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) und genauere [Betrachtung der Durchführung von HTTP-Anforderungen auf einer ASP.NET-Seite](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="87f14-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="87f14-243">Schritt 4: Anzeigen der Kategoriebilder in einer GridView</span><span class="sxs-lookup"><span data-stu-id="87f14-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="87f14-244">Nachdem wir nun über eine Webseite verfügen, auf der ein bestimmtes Bild der Kategorie angezeigt wird, können wir Sie mit dem [Image-websteuer](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) Element oder einem HTML-`<img>` Element anzeigen, das auf `DisplayCategoryPicture.aspx?CategoryID=categoryID`verweist.</span><span class="sxs-lookup"><span data-stu-id="87f14-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="87f14-245">Bilder, deren URL durch Datenbankdaten bestimmt wird, können in GridView oder DetailsView mithilfe von ImageField angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="87f14-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="87f14-246">Das ImageField enthält `DataImageUrlField`-und `DataImageUrlFormatString` Eigenschaften, die wie die Eigenschaften `DataNavigateUrlFields` und `DataNavigateUrlFormatString` von HyperLinkField funktionieren.</span><span class="sxs-lookup"><span data-stu-id="87f14-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="87f14-247">Erweitern Sie die `Categories` GridView in `DisplayOrDownloadData.aspx`, indem Sie ein ImageField hinzufügen, um die einzelnen Kategorien anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="87f14-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="87f14-248">Fügen Sie einfach das ImageField hinzu, und legen Sie dessen Eigenschaften für `DataImageUrlField` und `DataImageUrlFormatString` auf `CategoryID` bzw. `DisplayCategoryPicture.aspx?CategoryID={0}`fest.</span><span class="sxs-lookup"><span data-stu-id="87f14-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="87f14-249">Dadurch wird eine GridView-Spalte erstellt, die ein `<img>` Element rendert, dessen `src` Attribut auf `DisplayCategoryPicture.aspx?CategoryID={0}`verweist, wobei {0} durch den `CategoryID` Wert der GridView-Zeile ersetzt wird.</span><span class="sxs-lookup"><span data-stu-id="87f14-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>

![Hinzufügen eines ImageField zur GridView](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.gif)

<span data-ttu-id="87f14-251">**Abbildung 12**: Hinzufügen eines ImageField zur GridView</span><span class="sxs-lookup"><span data-stu-id="87f14-251">**Figure 12**: Add an ImageField to the GridView</span></span>

<span data-ttu-id="87f14-252">Nach dem Hinzufügen von ImageField sollte die deklarative Syntax von GridView s wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="87f14-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>

[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample8.aspx)]

<span data-ttu-id="87f14-253">Nehmen Sie sich einen Moment Zeit, um diese Seite über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="87f14-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="87f14-254">Beachten Sie, dass jeder Datensatz nun ein Bild für die Kategorie enthält.</span><span class="sxs-lookup"><span data-stu-id="87f14-254">Note how each record now includes a picture for the category.</span></span>

<span data-ttu-id="87f14-255">[![der Bildkategorie s für jede Zeile angezeigt wird.](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="87f14-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span></span>

<span data-ttu-id="87f14-256">**Abbildung 13**: das Bild der Kategorie wird für jede Zeile angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="87f14-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span></span>

## <a name="summary"></a><span data-ttu-id="87f14-257">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="87f14-257">Summary</span></span>

<span data-ttu-id="87f14-258">In diesem Tutorial wurde das präsentieren von Binärdaten untersucht.</span><span class="sxs-lookup"><span data-stu-id="87f14-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="87f14-259">Wie die Daten dargestellt werden, hängt von der Art der Daten ab.</span><span class="sxs-lookup"><span data-stu-id="87f14-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="87f14-260">Bei den PDF-Datei Dateien haben wir dem Benutzer einen Ansichts Prospekt Link angeboten, der den Benutzer beim Klicken direkt in die PDF-Datei aufgenommen hat.</span><span class="sxs-lookup"><span data-stu-id="87f14-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="87f14-261">Für das Bild der Kategorie wurde zuerst eine Seite zum Abrufen und Zurückgeben der Binärdaten aus der Datenbank erstellt. Anschließend wird diese Seite verwendet, um jedes Bild der Kategorie in einer GridView anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="87f14-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="87f14-262">Nachdem wir uns nun mit dem Anzeigen von Binärdaten beschäftigt haben, können wir die Ausführung von Einfüge-, Aktualisierungs-und Lösch Vorgängen für die Datenbank mit den Binärdaten untersuchen.</span><span class="sxs-lookup"><span data-stu-id="87f14-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="87f14-263">Im nächsten Tutorial wird erläutert, wie eine hochgeladene Datei mit dem entsprechenden Daten Bank Datensatz verknüpft wird.</span><span class="sxs-lookup"><span data-stu-id="87f14-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="87f14-264">In diesem Tutorial erfahren Sie, wie Sie vorhandene Binärdaten aktualisieren und die Binärdaten löschen, wenn der zugehörige Datensatz entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="87f14-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="87f14-265">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="87f14-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="87f14-266">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="87f14-266">About the Author</span></span>

<span data-ttu-id="87f14-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="87f14-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="87f14-268">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="87f14-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="87f14-269">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="87f14-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="87f14-270">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="87f14-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="87f14-271">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="87f14-271">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="87f14-272">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="87f14-272">Special Thanks To</span></span>

<span data-ttu-id="87f14-273">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="87f14-273">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="87f14-274">Die führenden Reviewer für dieses Tutorial waren Teresa Murphy und Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="87f14-274">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="87f14-275">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="87f14-275">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="87f14-276">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="87f14-276">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="87f14-277">[Zurück](uploading-files-vb.md)
> [Weiter](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span><span class="sxs-lookup"><span data-stu-id="87f14-277">[Previous](uploading-files-vb.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span></span>
