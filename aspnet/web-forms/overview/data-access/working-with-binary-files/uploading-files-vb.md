---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
title: Hochladen von Dateien (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie Benutzer zum Hochladen von Binärdateien (z. B. Word oder PDF-Dokumente) können zu Ihrer Website, in denen die Server-Dateisystem gespeichert werden kann...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: f7c00fbd-652c-433d-8ed3-0e5168a4d4df
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
msc.type: authoredcontent
ms.openlocfilehash: 7f342a7749ac175c3335f260324d69a0cce30202
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/09/2019
ms.locfileid: "59399748"
---
# <a name="uploading-files-vb"></a><span data-ttu-id="9cee8-103">Hochladen von Dateien (VB)</span><span class="sxs-lookup"><span data-stu-id="9cee8-103">Uploading Files (VB)</span></span>

<span data-ttu-id="9cee8-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9cee8-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9cee8-105">[Beispiel-App herunter](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) oder [PDF-Datei herunterladen](uploading-files-vb/_static/datatutorial54vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9cee8-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) or [Download PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span></span>

> <span data-ttu-id="9cee8-106">Erfahren Sie, wie Benutzer zum Hochladen von Binärdateien (z. B. Word oder PDF-Dokumente) können zu Ihrer Website, in dem sie im Dateisystem des Servers oder der Datenbank gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="9cee8-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>


## <a name="introduction"></a><span data-ttu-id="9cee8-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="9cee8-107">Introduction</span></span>

<span data-ttu-id="9cee8-108">Alle in den Tutorials wir haben bisher untersucht haben daran gearbeitet, ausschließlich mit Textdaten.</span><span class="sxs-lookup"><span data-stu-id="9cee8-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="9cee8-109">Viele Anwendungen müssen jedoch Datenmodelle, die sowohl Text als auch binäre Daten zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="9cee8-110">Eine dating online-Website kann es sich um Benutzer ein Bild des Profils zugeordnet werden soll hochladen können.</span><span class="sxs-lookup"><span data-stu-id="9cee8-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="9cee8-111">Eine personalbeschaffungs-Website kann Benutzer ihre fortsetzen als Microsoft Word oder PDF-Dokument hochladen können.</span><span class="sxs-lookup"><span data-stu-id="9cee8-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="9cee8-112">Arbeiten mit Binärdaten Fügt eine neue Reihe von Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="9cee8-113">Wir müssen entscheiden, wie die binären Daten in der Anwendung gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="9cee8-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="9cee8-114">Die Schnittstelle für das Einfügen neuer Datensätze muss aktualisiert werden, um die Benutzer zum Hochladen einer Datei von ihrem Computer zu ermöglichen und zusätzliche Schritte erforderlich, um anzuzeigen, oder geben Sie, dass eine Methode für das Herunterladen eines Datensatzes s Binärdaten verknüpft ist.</span><span class="sxs-lookup"><span data-stu-id="9cee8-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="9cee8-115">In diesem Tutorial und die folgenden drei lernen wir, wie Sie diese Herausforderungen Herausforderung.</span><span class="sxs-lookup"><span data-stu-id="9cee8-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="9cee8-116">Am Ende der in diesen Tutorials werden wir eine voll funktionsfähige Anwendung erstellt haben, die ein Bild und PDF-Broschüre jeder Kategorie zuordnet.</span><span class="sxs-lookup"><span data-stu-id="9cee8-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="9cee8-117">In diesem bestimmten Tutorial wir verschiedene Techniken zum Speichern von Binärdaten und erfahren Sie, wie Benutzer zum Hochladen einer Datei von ihrem Computer zu aktivieren und es auf das Dateisystem der Web-Server-s gespeichert haben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="9cee8-118">Binäre Daten, die Teil einer Anwendung s-Datenmodells werden manchmal als bezeichnet ein [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), ein Akronym für Binary Large OBject.</span><span class="sxs-lookup"><span data-stu-id="9cee8-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="9cee8-119">In diesen Tutorials habe ich entschieden, verwenden Sie die Terminologie binären Daten, obwohl der Begriff BLOB Synonym ist.</span><span class="sxs-lookup"><span data-stu-id="9cee8-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>


## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="9cee8-120">Schritt 1: Erstellen über das Arbeiten mit Binärdaten Web Pages</span><span class="sxs-lookup"><span data-stu-id="9cee8-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="9cee8-121">Bevor wir beginnen, um die Herausforderungen beim Hinzufügen von Unterstützung für binäre Daten zu untersuchen, können Sie s zuerst können Sie die ASP.NET-Seiten in unserem Websiteprojekt zu erstellen, die wir für dieses Lernprogramm sowie die folgenden drei benötigen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="9cee8-122">Starten, indem Sie einen neuen Ordner namens hinzufügen `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="9cee8-123">Fügen Sie die folgenden ASP.NET-Seiten in diesen Ordner, um sicherzustellen, ordnen Sie jeder Seite mit den `Site.master` Masterseite:</span><span class="sxs-lookup"><span data-stu-id="9cee8-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`


![Fügen Sie die ASP.NET-Seiten für die binäre datenbezogenen Lernprogramme](uploading-files-vb/_static/image1.gif)

<span data-ttu-id="9cee8-125">**Abbildung 1**: Fügen Sie die ASP.NET-Seiten für die binäre datenbezogenen Lernprogramme</span><span class="sxs-lookup"><span data-stu-id="9cee8-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>


<span data-ttu-id="9cee8-126">Wie in den anderen Ordnern `Default.aspx` in die `BinaryData` Ordner werden in den Tutorials im Abschnitt aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="9cee8-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="9cee8-127">Bedenken Sie, dass die `SectionLevelTutorialListing.ascx` Benutzersteuerelement stellt diese Funktionalität bereit.</span><span class="sxs-lookup"><span data-stu-id="9cee8-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="9cee8-128">Aus diesem Grund fügen dieses Benutzersteuerelement zu `Default.aspx` durch Ziehen aus dem Projektmappen-Explorer auf die Seite s Entwurfsansicht.</span><span class="sxs-lookup"><span data-stu-id="9cee8-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


[![A<span data-ttu-id="9cee8-129">Dd SectionLevelTutorialListing.ascx Benutzersteuerelements in "default.aspx"]</span><span class="sxs-lookup"><span data-stu-id="9cee8-129">dd the SectionLevelTutorialListing.ascx User Control to Default.aspx]</span></span>(uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)

<span data-ttu-id="9cee8-130">**Abbildung 2**: Hinzufügen der `SectionLevelTutorialListing.ascx` Benutzersteuerelement `Default.aspx` ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-vb/_static/image2.png))</span></span>


<span data-ttu-id="9cee8-131">Abschließend fügen Sie diese Seiten als Einträge der `Web.sitemap` Datei.</span><span class="sxs-lookup"><span data-stu-id="9cee8-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="9cee8-132">Fügen Sie das folgende Markup insbesondere nach dem Enhancing GridView `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="9cee8-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>


[!code-xml[Main](uploading-files-vb/samples/sample1.xml)]

<span data-ttu-id="9cee8-133">Nach der Aktualisierung `Web.sitemap`, können Sie die Lernprogramme-Website über einen Browser anzeigen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="9cee8-134">Klicken Sie im Menü auf der linken Seite enthält jetzt Elemente für das Arbeiten mit Binärdaten Tutorials.</span><span class="sxs-lookup"><span data-stu-id="9cee8-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>


![Die Sitemap enthält jetzt die Einträge für das Arbeiten mit Binärdaten Tutorials](uploading-files-vb/_static/image3.gif)

<span data-ttu-id="9cee8-136">**Abbildung 3**: Die Sitemap enthält jetzt die Einträge für das Arbeiten mit Binärdaten Tutorials</span><span class="sxs-lookup"><span data-stu-id="9cee8-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>


## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="9cee8-137">Schritt 2: Die Entscheidung, wo die Binärdaten Store</span><span class="sxs-lookup"><span data-stu-id="9cee8-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="9cee8-138">Binäre Daten, die das Anwendungsmodell für s Daten zugeordnet ist, können in einer von zwei Stellen gespeichert werden: auf das Dateisystem der Web-s-Server mit einem Verweis auf die Datei, die in der Datenbank gespeichert oder direkt in der Datenbank selbst (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="9cee8-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="9cee8-139">Jeder Ansatz verfügt über einen eigenen Satz von vor- und Nachteile und benötigt eine ausführlichere Erläuterung.</span><span class="sxs-lookup"><span data-stu-id="9cee8-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>


[![B<span data-ttu-id="9cee8-140">inär Daten kann im Dateisystem oder direkt in der Datenbank gespeichert werden]</span><span class="sxs-lookup"><span data-stu-id="9cee8-140">inary Data Can Be Stored On the File System or Directly in the Database]</span></span>(uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)

<span data-ttu-id="9cee8-141">**Abbildung 4**: Binäre Daten können im Dateisystem oder direkt in der Datenbank gespeichert werden ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-vb/_static/image4.png))</span></span>


<span data-ttu-id="9cee8-142">Angenommen Sie, wir wollten, erweitern Sie die Northwind-Datenbank, um ein Bild jedes Produkts zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="9cee8-143">Eine Möglichkeit wäre diese Bilddateien auf das Dateisystem der Web-s-Server zu speichern, und zeichnen Sie den Pfad in der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="9cee8-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="9cee8-144">Bei diesem Ansatz fügen wir d eine `ImagePath` Spalte, um die `Products` Tabelle vom Typ `varchar(200)`, vielleicht.</span><span class="sxs-lookup"><span data-stu-id="9cee8-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="9cee8-145">Wenn ein Benutzer ein Bild für Chai hochgeladen werden, kann dieses Bild gespeichert werden, auf das Dateisystem der Web-s-Server am `~/Images/Tea.jpg`, wobei `~` physischen Pfad der Anwendung s darstellt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="9cee8-146">D. h., wenn die Website den physischen Pfad als Stamm ist `C:\Websites\Northwind\`, `~/Images/Tea.jpg` wäre entspricht `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="9cee8-147">Nach dem Hochladen der Bilddatei, aktualisieren wir d den Chai Datensatz in die `Products` Tabelle, damit die `ImagePath` Spalte verwiesen wird, den Pfad des neuen Images.</span><span class="sxs-lookup"><span data-stu-id="9cee8-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="9cee8-148">Wir können `~/Images/Tea.jpg` oder nur `Tea.jpg` Wenn wir uns entschieden, dass alle Produktbilder in der Anwendung s abgelegt werden `Images` Ordner.</span><span class="sxs-lookup"><span data-stu-id="9cee8-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="9cee8-149">Die Hauptvorteile von binären Daten im Dateisystem gespeichert sind:</span><span class="sxs-lookup"><span data-stu-id="9cee8-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="9cee8-150">**Einfache Implementierung** wie wir in Kürze sehen werden, speichern und Abrufen von Binärdaten, die direkt in der Datenbank gespeicherten umfasst ein wenig mehr Code als beim Arbeiten mit Daten über das Dateisystem.</span><span class="sxs-lookup"><span data-stu-id="9cee8-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="9cee8-151">Darüber hinaus müssen in der Reihenfolge für einen Benutzer zum Anzeigen oder Herunterladen von Binärdaten sie eine URL für die Daten angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="9cee8-152">Wenn die Daten auf s-Dateisystem der Web-Server befindet, ist die URL einfach.</span><span class="sxs-lookup"><span data-stu-id="9cee8-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="9cee8-153">Wenn die Daten in der Datenbank gespeichert ist, jedoch eine Webseite muss erstellt werden, die abgerufen werden und die Daten aus der Datenbank zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="9cee8-154">**Größere Zugriff auf die Binärdaten** die binären Daten müssen möglicherweise mit anderen Diensten oder Anwendungen, für solche, die die Daten aus der Datenbank abrufen, kann nicht zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="9cee8-155">Beispielsweise jedes Produkt zugeordneten Bilder auch über für Benutzer verfügbar sein müssen möglicherweise [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in diesem Fall d soll die binären Daten im Dateisystem zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9cee8-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="9cee8-156">**Leistung** Wenn die binären Daten im Dateisystem gespeichert ist, wird die Nachfrage und Netzwerk-Überlastung zwischen der Datenbank-Server und Webserver werden kleiner als die binären Daten direkt in der Datenbank gespeichert ist.</span><span class="sxs-lookup"><span data-stu-id="9cee8-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="9cee8-157">Der Hauptnachteil der binäre Daten im Dateisystem gespeichert ist, dass es sich um die Daten aus der Datenbank entkoppelt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="9cee8-158">Wenn ein Datensatz gelöscht wird, aus der `Products` Tabelle, die zugehörige Datei im Dateisystem der Web-Server s werden nicht automatisch gelöscht.</span><span class="sxs-lookup"><span data-stu-id="9cee8-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="9cee8-159">Schreiben wir, dass zusätzlicher Code So löschen Sie die Datei oder das Dateisystem mit nicht verwendeten, verwaiste Dateien überladen werden wird.</span><span class="sxs-lookup"><span data-stu-id="9cee8-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="9cee8-160">Darüber hinaus müssen bei der Sicherung der Datenbank wir damit Sicherungen der zugeordneten Binärdaten im Dateisystem, ebenfalls sicherstellen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="9cee8-161">Verschieben der Datenbank auf einem anderen Standort oder ähnliche Server führt zu Problemen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="9cee8-162">Binäre Daten können auch direkt in einer Microsoft SQL Server 2005-Datenbank gespeichert werden, erstellen Sie eine Spalte vom Typ `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="9cee8-163">Wie kann mit anderen Datentypen variabler Länge Angabe eine maximale Länge der binären Daten, die gespeichert werden können in dieser Spalte.</span><span class="sxs-lookup"><span data-stu-id="9cee8-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="9cee8-164">Beispielsweise, reservieren höchstens 5.000 Bytes verwenden `varbinary(5000)`; `varbinary(MAX)` ermöglicht die maximale Speichergröße, etwa 2 GB.</span><span class="sxs-lookup"><span data-stu-id="9cee8-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="9cee8-165">Der Hauptvorteil von binären Daten direkt in der Datenbank gespeichert ist, die enge Kopplung zwischen den binären Daten und den Datenbank-Datensatz.</span><span class="sxs-lookup"><span data-stu-id="9cee8-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="9cee8-166">Dies vereinfacht deutlich Datenbankverwaltungsaufgaben, z. B. Sicherungen oder die Datenbank auf einem anderen Standort oder den Server verschieben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="9cee8-167">Darüber hinaus löscht das Löschen eines Datensatzes automatisch die entsprechenden Binärdaten.</span><span class="sxs-lookup"><span data-stu-id="9cee8-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="9cee8-168">Es gibt auch weitere geringfügige Vorteile die binären Daten in der Datenbank gespeichert.</span><span class="sxs-lookup"><span data-stu-id="9cee8-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="9cee8-169">Finden Sie unter [Speichern von binären Dateien direkt in die Datenbank mithilfe von ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) für eine ausführlichere Erläuterung.</span><span class="sxs-lookup"><span data-stu-id="9cee8-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="9cee8-170">In Microsoft SQL Server 2000 und früheren Versionen die `varbinary` -Datentyp aufwies, einem maximalen Grenzwert von 8.000 Bytes.</span><span class="sxs-lookup"><span data-stu-id="9cee8-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="9cee8-171">Zum Speichern von bis zu 2 GB binärer Daten der [ `image` Datentyp](https://msdn.microsoft.com/library/ms187993.aspx) stattdessen verwendet werden muss.</span><span class="sxs-lookup"><span data-stu-id="9cee8-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="9cee8-172">Durch das Hinzufügen von `MAX` in SQL Server 2005, jedoch die `image` -Datentyp ist veraltet.</span><span class="sxs-lookup"><span data-stu-id="9cee8-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="9cee8-173">Es s noch Gründen der Abwärtskompatibilität unterstützt, aber Microsoft hat angekündigt, die die `image` -Datentyp in einer zukünftigen Version von SQL Server entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>


<span data-ttu-id="9cee8-174">Bei Verwendung mit einem älteren Data Model können Sie sehen die `image` -Datentyp.</span><span class="sxs-lookup"><span data-stu-id="9cee8-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="9cee8-175">Die Datenbank "Northwind" s `Categories` Tabelle besitzt eine `Picture` Spalte, die verwendet werden kann, um die binären Daten der Bilddatei für die Kategorie zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9cee8-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="9cee8-176">Da die Northwind-Datenbank ihren Wurzeln in Microsoft Access und früheren Versionen von SQL Server verfügt, ist diese Spalte vom Typ `image`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="9cee8-177">Für dieses Lernprogramm sowie die folgenden drei verwenden wir beide Ansätze.</span><span class="sxs-lookup"><span data-stu-id="9cee8-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="9cee8-178">Die `Categories` Tabelle verfügt bereits über eine `Picture` Spalte zum Speichern von Inhalt im Binärformat eines Bilds für die Kategorie.</span><span class="sxs-lookup"><span data-stu-id="9cee8-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="9cee8-179">Wir fügen eine weitere Spalte, `BrochurePath`, um einen Pfad zu einer PDF-Datei im Dateisystem der Web-s-Server zu speichern, die verwendet werden können, um einen drucken hochwertigen, ansprechenden Überblick über die Kategorie bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="9cee8-180">Schritt 3: Hinzufügen der`BrochurePath`Spalte, um die`Categories`Tabelle</span><span class="sxs-lookup"><span data-stu-id="9cee8-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="9cee8-181">Die Categories-Tabelle ist derzeit nur vier Spalten: `CategoryID`, `CategoryName`, `Description`, und `Picture`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="9cee8-182">Zusätzlich zu diesen Feldern ausführen müssen wir ein neues Gerät hinzufügen, das auf die Kategorie s Broschüre verweist (falls vorhanden).</span><span class="sxs-lookup"><span data-stu-id="9cee8-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="9cee8-183">Wechseln Sie zum Hinzufügen dieser Spalte, um im Server-Explorer einen Drilldown in die Tabellen, mit der rechten Maustaste auf die `Categories` Tabelle, und wählen Sie die Tabellendefinition öffnen (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="9cee8-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="9cee8-184">Wenn Sie den Server-Explorer nicht angezeigt werden, machen sie Sie durch Auswahl der Server-Explorer-Option im Menü Ansicht, oder drücken Sie Strg + Alt + S ein.</span><span class="sxs-lookup"><span data-stu-id="9cee8-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="9cee8-185">Fügen Sie einen neuen `varchar(200)` Spalte, um die `Categories` Tabelle mit der Bezeichnung `BrochurePath` und ermöglicht `NULL` s, und klicken Sie auf das Symbol "Speichern" (oder drücken Sie STRG + S).</span><span class="sxs-lookup"><span data-stu-id="9cee8-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>


[![A<span data-ttu-id="9cee8-186">Dd der Categories-Tabelle eine Spalte BrochurePath]</span><span class="sxs-lookup"><span data-stu-id="9cee8-186">dd a BrochurePath Column to the Categories Table]</span></span>(uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)

<span data-ttu-id="9cee8-187">**Abbildung 5**: Hinzufügen einer `BrochurePath` Spalte, um die `Categories` Tabelle ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-vb/_static/image6.png))</span></span>


## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="9cee8-188">Schritt 4: Aktualisieren die Architektur für die Verwendung der`Picture`und`BrochurePath`Spalten</span><span class="sxs-lookup"><span data-stu-id="9cee8-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="9cee8-189">Die `CategoriesDataTable` in die (Data Access Layer, DAL) verfügt derzeit über vier `DataColumn` s definiert: `CategoryID`, `CategoryName`, `Description`, und `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="9cee8-190">Wenn wir ursprünglich entworfen, dieser Datentabelle in der [Erstellen einer Datenzugriffsschicht](../introduction/creating-a-data-access-layer-vb.md) Tutorial die `CategoriesDataTable` mussten nur die ersten drei Spalten; die `NumberOfProducts` Spalte wurde hinzugefügt, die [Master-/Detailberichten mithilfe einer mit Aufzählungszeichen Liste der Masterdatensätze und einem DataList-Details Steuerelement](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="9cee8-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial.</span></span>

<span data-ttu-id="9cee8-191">Siehe *Erstellen einer Datenzugriffsschicht*, die Datentabellen in typisierten Datasets bilden die Geschäftsobjekte.</span><span class="sxs-lookup"><span data-stu-id="9cee8-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="9cee8-192">Die TableAdapters sind verantwortlich für die Kommunikation mit der Datenbank und die Geschäftsobjekte mit den Abfrageergebnissen auffüllen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="9cee8-193">Die `CategoriesDataTable` werden ausgefüllt, indem die `CategoriesTableAdapter`, die über drei Datenabrufmethoden verfügt:</span><span class="sxs-lookup"><span data-stu-id="9cee8-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- `GetCategories()` <span data-ttu-id="9cee8-194">führt die Hauptabfrage des TableAdapter s aus und gibt die `CategoryID`, `CategoryName`, und `Description` Felder aller Datensätze in der `Categories` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="9cee8-194">executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="9cee8-195">Die Hauptabfrage wird verwendet, indem Sie den automatisch generierten `Insert` und `Update` Methoden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- `GetCategoryByCategoryID(categoryID)` <span data-ttu-id="9cee8-196">Gibt die `CategoryID`, `CategoryName`, und `Description` Felder der Kategorie, deren `CategoryID` gleich *CategoryID*.</span><span class="sxs-lookup"><span data-stu-id="9cee8-196">returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- `GetCategoriesAndNumberOfProducts()` <span data-ttu-id="9cee8-197">-Gibt die `CategoryID`, `CategoryName`, und `Description` Felder für alle Datensätze in der `Categories` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="9cee8-197">- returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="9cee8-198">Auch wird eine Unterabfrage verwendet, um die Anzahl der Produkte verknüpft ist, wobei jede Kategorie zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="9cee8-199">Beachten Sie, dass keine dieser Abfragen zurückgeben der `Categories` s'-Tabelle `Picture` oder `BrochurePath` Spalten noch wird die `CategoriesDataTable` bieten `DataColumn` s für diese Felder.</span><span class="sxs-lookup"><span data-stu-id="9cee8-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="9cee8-200">Für die Arbeit mit dem Bild und `BrochurePath` Eigenschaften, wir müssen zunächst zum Hinzufügen der `CategoriesDataTable` und aktualisieren Sie dann die `CategoriesTableAdapter` Klasse, um diese Spalten zurück.</span><span class="sxs-lookup"><span data-stu-id="9cee8-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="9cee8-201">Hinzufügen der`Picture`und`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="9cee8-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="9cee8-202">Starten, indem diese beiden Spalten zum Hinzufügen der `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="9cee8-203">Mit der rechten Maustaste auf die `CategoriesDataTable` s-Header, wählen Sie aus dem Kontextmenü hinzufügen, und wählen Sie dann die Option Spalte.</span><span class="sxs-lookup"><span data-stu-id="9cee8-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="9cee8-204">Hiermit wird ein neues `DataColumn` in der Datentabelle, die mit dem Namen `Column1`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="9cee8-205">Benennen Sie diese Spalte in `Picture`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="9cee8-206">Legen Sie im Eigenschaftenfenster die `DataColumn` s `DataType` Eigenschaft `System.Byte[]` (Dies ist dabei nicht um eine Option in der Dropdown-Liste, müssen Sie sie eingeben).</span><span class="sxs-lookup"><span data-stu-id="9cee8-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>


[![C<span data-ttu-id="9cee8-207">Erstellen Sie eine DataColumn mit dem Namen Bild ist, deren Datentyp System.Byte []]</span><span class="sxs-lookup"><span data-stu-id="9cee8-207">reate a DataColumn Named Picture whose DataType is System.Byte[]]</span></span>(uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)

<span data-ttu-id="9cee8-208">**Abbildung 6**: Erstellen einer `DataColumn` benannte `Picture` , deren `DataType` ist `System.Byte[]` ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-vb/_static/image8.png))</span></span>


<span data-ttu-id="9cee8-209">Fügen Sie ein weiteres `DataColumn` der Datentabelle, nennen Sie es `BrochurePath` über das standardmäßige `DataType` Wert (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="9cee8-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="9cee8-210">Zurückgeben der`Picture`und`BrochurePath`Werte aus dem TableAdapter</span><span class="sxs-lookup"><span data-stu-id="9cee8-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="9cee8-211">Mit diesen beiden `DataColumn` s hinzugefügt, die `CategoriesDataTable`, wir erneut bereit, die zum Aktualisieren der `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="9cee8-212">Es wäre möglich gewesen, beide dieser Spaltenwerte in der Hauptabfrage des TableAdapter zurückgegeben, aber dies würde zurückbringen die binären Daten jedes Mal die `GetCategories()` Methode wurde aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="9cee8-213">Let s aktualisieren Sie stattdessen die Hauptabfrage der TableAdapter rüstet `BrochurePath` , und erstellen Sie eine weitere Daten abrufen-Methode, die eine bestimmte Kategorie s zurückgibt `Picture` Spalte.</span><span class="sxs-lookup"><span data-stu-id="9cee8-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="9cee8-214">Um die Hauptabfrage des TableAdapter zu aktualisieren, mit der Maustaste auf die `CategoriesTableAdapter` s-Header, und wählen Sie im Kontextmenü die Option konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="9cee8-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="9cee8-215">Dadurch wird die Tabelle Konfigurations-Assistenten, die wir in einer Reihe von früheren Tutorials gesehen haben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="9cee8-216">Aktualisieren Sie die Abfrage rüstet die `BrochurePath` , und klicken Sie auf "Fertig stellen".</span><span class="sxs-lookup"><span data-stu-id="9cee8-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>


[![U<span data-ttu-id="9cee8-217">Aktualisieren der Liste der Spalten in der SELECT-Anweisung auch zurückgeben BrochurePath]</span><span class="sxs-lookup"><span data-stu-id="9cee8-217">pdate the Column List in the SELECT Statement to Also Return BrochurePath]</span></span>(uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)

<span data-ttu-id="9cee8-218">**Abbildung 7**: Aktualisieren der Liste der Spalten in der `SELECT` Anweisung, um auch zurückzugeben `BrochurePath` ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-vb/_static/image10.png))</span></span>


<span data-ttu-id="9cee8-219">Wenn Sie Ad-hoc-SQL-Anweisungen für den TableAdapter verwenden, Aktualisieren der Liste der Spalten in der Hauptabfrage die Liste der Spalten für alle aktualisiert die `SELECT` Abfragemethoden im TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="9cee8-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="9cee8-220">Das bedeutet, dass die `GetCategoryByCategoryID(categoryID)` Methode wurde aktualisiert, um das Zurückgeben der `BrochurePath` Spalte, die möglicherweise, was wir es beabsichtigt haben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="9cee8-221">Es jedoch in die Liste der Spalten auch aktualisiert die `GetCategoriesAndNumberOfProducts()` -Methode, entfernen Sie die Unterabfrage, die die Anzahl der Produkte für die einzelnen Kategorien gibt!</span><span class="sxs-lookup"><span data-stu-id="9cee8-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="9cee8-222">Aus diesem Grund müssen wir diese Methode s aktualisieren `SELECT` Abfrage.</span><span class="sxs-lookup"><span data-stu-id="9cee8-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="9cee8-223">Mit der rechten Maustaste auf die `GetCategoriesAndNumberOfProducts()` Methode konfigurieren auswählen und Wiederherstellen der `SELECT` Abfrage zurück an den ursprünglichen Wert:</span><span class="sxs-lookup"><span data-stu-id="9cee8-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>


[!code-sql[Main](uploading-files-vb/samples/sample2.sql)]

<span data-ttu-id="9cee8-224">Als Nächstes erstellen Sie eine neue TableAdapter-Methode, die eine bestimmte Kategorie s zurückgibt `Picture` Spaltenwert.</span><span class="sxs-lookup"><span data-stu-id="9cee8-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="9cee8-225">Mit der rechten Maustaste auf die `CategoriesTableAdapter` s-Header, und wählen Sie die Option "Abfrage hinzufügen" zum TableAdapter-Konfigurations-Assistenten zu starten.</span><span class="sxs-lookup"><span data-stu-id="9cee8-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="9cee8-226">Der erste Schritt des Assistenten werden wir gefragt, wenn Sie möchten zum Abfragen von Daten mit Ad-hoc-SQL-Anweisungen, eine neue, gespeicherte Prozedur bzw. eine vorhandene Ressourcengruppe.</span><span class="sxs-lookup"><span data-stu-id="9cee8-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="9cee8-227">Wählen Sie die SQL-Anweisungen, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="9cee8-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="9cee8-228">Da wir eine Zeile zurückgegeben wird, wählen Sie die wählen die Option der Zeilen im zweiten Schritt zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>


[![S<span data-ttu-id="9cee8-229">Wählen Sie die SQL-Anweisungen Option]</span><span class="sxs-lookup"><span data-stu-id="9cee8-229">elect the Use SQL statements Option]</span></span>(uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)

<span data-ttu-id="9cee8-230">**Abbildung 8**: Wählen Sie die SQL-Anweisungen-Option ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-vb/_static/image12.png))</span></span>


[![S<span data-ttu-id="9cee8-231">Ince die Abfrage gibt einen Datensatz aus der Tabelle "Categories", wählen Sie die Zeilen zurückgibt auswählen]</span><span class="sxs-lookup"><span data-stu-id="9cee8-231">ince the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows]</span></span>(uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)

<span data-ttu-id="9cee8-232">**Abbildung 9**: Da die Abfrage einen Datensatz aus der Tabelle "Categories", wählen Sie die Option zurückgeben wird, die Zeilen zurückgibt ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-vb/_static/image14.png))</span></span>


<span data-ttu-id="9cee8-233">Klicken Sie im dritten Schritt geben Sie folgende SQL-Abfrage, und klicken Sie auf Weiter:</span><span class="sxs-lookup"><span data-stu-id="9cee8-233">In the third step, enter the following SQL query and click Next:</span></span>


[!code-sql[Main](uploading-files-vb/samples/sample3.sql)]

<span data-ttu-id="9cee8-234">Der letzte Schritt ist, um den Namen für die neue Methode auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="9cee8-235">Verwendung `FillCategoryWithBinaryDataByCategoryID` und `GetCategoryWithBinaryDataByCategoryID` für die Füllung einer DataTable und Rückgabe eine "DataTable"-Mustern bzw.</span><span class="sxs-lookup"><span data-stu-id="9cee8-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="9cee8-236">Klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-236">Click Finish to complete the wizard.</span></span>


[![C<span data-ttu-id="9cee8-237">Wählen Sie die Namen für die TableAdapter-Methoden aus]</span><span class="sxs-lookup"><span data-stu-id="9cee8-237">hoose the Names for the TableAdapter s Methods]</span></span>(uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)

<span data-ttu-id="9cee8-238">**Abbildung 10**: Wählen Sie die Namen für die TableAdapter-Methoden ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-vb/_static/image16.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9cee8-239">Nach Abschluss der Tabelle Abfragen Konfigurations-Assistenten möglicherweise ein Dialogfeld, das Sie darüber informiert, dass der neue Befehlstext aus dem Schema der Hauptabfrage unterschiedliche Daten mit Schema zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="9cee8-240">Kurz gesagt: der Assistent wird hingewiesen werden, die die Hauptabfrage des TableAdapter s `GetCategories()` gibt ein anderes Schema als dem wir gerade erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="9cee8-241">Aber wir möchten, damit Sie diese Meldung ignorieren können.</span><span class="sxs-lookup"><span data-stu-id="9cee8-241">But this is what we want, so you can disregard this message.</span></span>


<span data-ttu-id="9cee8-242">Beachten Sie außerdem, dass, wenn Sie Ad-hoc-SQL-Anweisungen verwenden und mithilfe des Assistenten zum Ändern der TableAdapter Hauptabfrage s zu einem späteren Zeitpunkt in-Time, geändert wird die `GetCategoryWithBinaryDataByCategoryID` s-Methode `SELECT` Anweisung s Spaltenliste sollen nur die Spalten aus der Hauptabfrage (d. h. er entfernt die `Picture` Spalte aus der Abfrage).</span><span class="sxs-lookup"><span data-stu-id="9cee8-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="9cee8-243">Zurückgeben die Liste der Spalten manuell aktualisieren müssen die `Picture` Spalte, ähnlich wie die `GetCategoriesAndNumberOfProducts()` Methode weiter oben in diesem Schritt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="9cee8-244">Nach dem Hinzufügen der beiden `DataColumn` s, um die `CategoriesDataTable` und `GetCategoryWithBinaryDataByCategoryID` Methode, um die `CategoriesTableAdapter`, diese Klassen im typisierten DataSet-Designer sollte wie im Screenshot in Abbildung 11 aussehen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>


![Der DataSet-Designer enthält die neue Spalten und die Methode](uploading-files-vb/_static/image11.gif)

<span data-ttu-id="9cee8-246">**Abbildung 11**: Der DataSet-Designer enthält die neue Spalten und die Methode</span><span class="sxs-lookup"><span data-stu-id="9cee8-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>


## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="9cee8-247">Aktualisieren die Geschäftslogikschicht (BLL)</span><span class="sxs-lookup"><span data-stu-id="9cee8-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="9cee8-248">Mit der DAL aktualisiert, übrig bleibt, erweitern Sie die Geschäftslogikschicht (Business Logic Layer, BLL) enthält eine Methode für das neue `CategoriesTableAdapter` Methode.</span><span class="sxs-lookup"><span data-stu-id="9cee8-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="9cee8-249">Fügen Sie die folgende Methode der `CategoriesBLL` Klasse:</span><span class="sxs-lookup"><span data-stu-id="9cee8-249">Add the following method to the `CategoriesBLL` class:</span></span>


[!code-vb[Main](uploading-files-vb/samples/sample4.vb)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="9cee8-250">Schritt 5: Hochladen einer Datei vom Client an den Webserver</span><span class="sxs-lookup"><span data-stu-id="9cee8-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="9cee8-251">Beim Sammeln von Binärdaten werden häufig durch einen Endbenutzer diese Daten bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="9cee8-252">Um diese Informationen erfassen zu können, muss der Benutzer eine Datei von ihrem Computer an den Webserver hochladen können.</span><span class="sxs-lookup"><span data-stu-id="9cee8-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="9cee8-253">Die hochgeladenen Daten müssen mit dem Datenmodell, das Speichern der Datei auf das Dateisystem der Web-Server-s und Hinzufügen eines Pfads zur Datei in der Datenbank oder den binären Inhalt direkt in der Datenbank schreiben kann bedeuten, integriert werden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="9cee8-254">In diesem Schritt untersuchen wir an, wie einen Benutzer zum Hochladen von Dateien von ihrem Computer, auf dem Server zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="9cee8-255">Im nächsten Tutorial werden wir unsere Aufmerksamkeit zum Integrieren der hochgeladenen Datei in Datenmodell aktivieren.</span><span class="sxs-lookup"><span data-stu-id="9cee8-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="9cee8-256">ASP.NET 2.0 neues [FileUpload-Websteuerelement](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) bietet einen Mechanismus für Benutzer auf eine Datei von ihrem Computer an den Webserver zu senden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="9cee8-257">Der FileUpload-Steuerelement wird als ein `<input>` Element, dessen `type` -Attribut auf die Datei, die in Browsern, wie ein Textfeld mit einer Schaltfläche zum Durchsuchen angezeigt festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="9cee8-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="9cee8-258">Durch Klicken auf die Schaltfläche zum Durchsuchen wird ein Dialogfeld, in dem der Benutzer eine Datei auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="9cee8-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="9cee8-259">Wenn das Formular erneut gesendet wird, werden den Inhalt der ausgewählten Datei s zusammen mit dem Postback gesendet.</span><span class="sxs-lookup"><span data-stu-id="9cee8-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="9cee8-260">Auf der Serverseite ist die Informationen über die hochgeladene Datei über die Eigenschaften "FileUpload"-Steuerelement zugänglich.</span><span class="sxs-lookup"><span data-stu-id="9cee8-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="9cee8-261">Öffnen Sie zum Hochladen von Dateien zu veranschaulichen, die `FileUpload.aspx` auf der Seite die `BinaryData` , ein "FileUpload"-Steuerelement aus der Toolbox in den Designer ziehen, und legen Sie das Steuerelement s `ID` Eigenschaft `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="9cee8-262">Fügen Sie eine Schaltfläche Websteuerelement Festlegen seiner `ID` und `Text` Eigenschaften `UploadButton` und Laden Sie die ausgewählte Datei bzw. hoch.</span><span class="sxs-lookup"><span data-stu-id="9cee8-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="9cee8-263">Setzen Sie ein Label-Steuerelement unterhalb der Schaltfläche, löschen Sie schließlich die `Text` Eigenschaft, und legen seine `ID` Eigenschaft `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>


[![A<span data-ttu-id="9cee8-264">TT ein "FileUpload"-Steuerelement in die ASP.NET-Seite]</span><span class="sxs-lookup"><span data-stu-id="9cee8-264">dd a FileUpload Control to the ASP.NET Page]</span></span>(uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)

<span data-ttu-id="9cee8-265">**Abbildung 12**: Hinzufügen einer FileUpload-Serversteuerelements in die ASP.NET-Seite ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-vb/_static/image18.png))</span></span>


<span data-ttu-id="9cee8-266">Abbildung 13 zeigt diese Seite, wenn Sie über einen Browser angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="9cee8-267">Beachten Sie, dass Sie auf die Schaltfläche zum Durchsuchen ein Dialogfeld zur Dateiauswahl, öffnet der Benutzer zum Auswählen einer Datei von ihrem Computer.</span><span class="sxs-lookup"><span data-stu-id="9cee8-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="9cee8-268">Nachdem eine Datei ausgewählt wurde, führt dazu, dass Sie auf die Schaltfläche für die ausgewählte Datei hochladen einen Postback aus, der die ausgewählte Datei s binären Inhalt an den Webserver sendet.</span><span class="sxs-lookup"><span data-stu-id="9cee8-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>


[![T<span data-ttu-id="9cee8-269">er Benutzer kann eine Datei zum Hochladen von ihrem Computer an den Server auswählen]</span><span class="sxs-lookup"><span data-stu-id="9cee8-269">he User Can Select a File to Upload from their Computer to the Server]</span></span>(uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)

<span data-ttu-id="9cee8-270">**Abbildung 13**: Der Benutzer kann eine Datei zum Hochladen auswählen, von dem Computer, auf dem Server ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-vb/_static/image20.png))</span></span>


<span data-ttu-id="9cee8-271">Beim Postback die hochgeladene Datei im Dateisystem gespeichert werden kann, oder die binäre Daten mit gearbeitet werden können, direkt über einen Stream.</span><span class="sxs-lookup"><span data-stu-id="9cee8-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="9cee8-272">In diesem Beispiel können Sie s, erstellen Sie eine `~/Brochures` Ordner und speichern Sie die hochgeladene Datei.</span><span class="sxs-lookup"><span data-stu-id="9cee8-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="9cee8-273">Starten Sie durch Hinzufügen der `Brochures` Ordner an den Standort als Unterordner des Stammverzeichnisses.</span><span class="sxs-lookup"><span data-stu-id="9cee8-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="9cee8-274">Als Nächstes erstellen Sie einen Ereignishandler für die `UploadButton` s `Click` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="9cee8-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>


[!code-vb[Main](uploading-files-vb/samples/sample5.vb)]

<span data-ttu-id="9cee8-275">Das "FileUpload"-Steuerelement bietet eine Vielzahl von Eigenschaften für die Arbeit mit der hochgeladenen Daten.</span><span class="sxs-lookup"><span data-stu-id="9cee8-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="9cee8-276">Z. B. die [ `HasFile` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) gibt an, ob eine Datei, vom Benutzer hochgeladen wurde während der [ `FileBytes` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) bietet Zugriff auf die hochgeladenen Binärdaten als ein Array von Bytes.</span><span class="sxs-lookup"><span data-stu-id="9cee8-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="9cee8-277">Die `Click` Ereignishandler startet, indem Sie sicherstellen, dass eine Datei hochgeladen wurde.</span><span class="sxs-lookup"><span data-stu-id="9cee8-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="9cee8-278">Wenn eine Datei hochgeladen wurde, zeigt die Bezeichnung der Name der hochgeladenen Datei, die Größe in Bytes und dem Inhaltstyp an.</span><span class="sxs-lookup"><span data-stu-id="9cee8-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="9cee8-279">Um sicherzustellen, dass der Benutzer eine Datei hochlädt, sehen Sie sich, die `HasFile` Eigenschaft und eine Warnung angezeigt, wenn es s `False`, oder Sie können die [RequiredFieldValidator-Steuerelement](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) stattdessen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `False`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>


<span data-ttu-id="9cee8-280">Die "FileUpload" s `SaveAs(filePath)` speichert die hochgeladene Datei im angegebenen *"FilePath"*.</span><span class="sxs-lookup"><span data-stu-id="9cee8-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="9cee8-281">*"FilePath"* muss eine *physischer Pfad* (`C:\Websites\Brochures\SomeFile.pdf`) anstelle eines *virtuellen* *Pfad* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="9cee8-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="9cee8-282">Die [ `Server.MapPath(virtPath)` Methode](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) akzeptiert einen virtuellen Pfad und den zugehörigen physischen Pfad zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9cee8-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="9cee8-283">Hier ist der virtuelle Pfad ist `~/Brochures/fileName`, wobei *FileName* ist der Name der hochgeladenen Datei.</span><span class="sxs-lookup"><span data-stu-id="9cee8-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="9cee8-284">Finden Sie unter [mithilfe von Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) für Weitere Informationen zur virtuellen und physischen Pfade und die Verwendung von `Server.MapPath`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="9cee8-285">Nach Abschluss der `Click` -Ereignishandler können Sie die Seite in einem Browser zu testen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="9cee8-286">Klicken Sie auf die Schaltfläche zum Durchsuchen, und wählen Sie eine Datei auf Ihrer Festplatte, und klicken Sie dann auf die Schaltfläche "ausgewählten Datei hochladen".</span><span class="sxs-lookup"><span data-stu-id="9cee8-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="9cee8-287">Das Postback sendet den Inhalt der ausgewählten Datei an den Webserver, der anschließend Informationen über die Datei vor dem Speichern auf angezeigt wird der `~/Brochures` Ordner.</span><span class="sxs-lookup"><span data-stu-id="9cee8-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="9cee8-288">Klicken Sie nach dem Hochladen der das zurück zu Visual Studio, und klicken Sie auf die Schaltfläche "Aktualisieren" im Projektmappen-Explorer.</span><span class="sxs-lookup"><span data-stu-id="9cee8-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="9cee8-289">Daraufhin sollte die Datei, die Sie gerade hochgeladen, im Ordner "~/Brochures haben"!</span><span class="sxs-lookup"><span data-stu-id="9cee8-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>


[![T<span data-ttu-id="9cee8-290">er Datei EvolutionValley.jpg hochgeladen wurde an den Webserver]</span><span class="sxs-lookup"><span data-stu-id="9cee8-290">he File EvolutionValley.jpg Has Been Uploaded to the Web Server]</span></span>(uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)

<span data-ttu-id="9cee8-291">**Abbildung 14**: Die Datei `EvolutionValley.jpg` hochgeladen wurde an den Webserver ([klicken Sie, um das Bild in voller Größe anzeigen](uploading-files-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="9cee8-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-vb/_static/image22.png))</span></span>


![EvolutionValley.jpg wurde in den Ordner ~/Brochures gespeichert.](uploading-files-vb/_static/image15.gif)

<span data-ttu-id="9cee8-293">**Abbildung 15**: `EvolutionValley.jpg` Wurde gespeichert, um die `~/Brochures` Ordner</span><span class="sxs-lookup"><span data-stu-id="9cee8-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>


## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="9cee8-294">Die feinheiten beim Speichern der hochgeladener Dateien im Dateisystem</span><span class="sxs-lookup"><span data-stu-id="9cee8-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="9cee8-295">Es gibt einige Besonderheiten, die beim Speichern der Hochladen von Dateien in das Dateisystem der Web-Server-s berücksichtigt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="9cee8-296">Zunächst wird dort s das Problem der Sicherheit.</span><span class="sxs-lookup"><span data-stu-id="9cee8-296">First, there s the issue of security.</span></span> <span data-ttu-id="9cee8-297">Um eine Datei im Dateisystem zu speichern, muss der Sicherheitskontext an, unter dem die ASP.NET-Seite ausgeführt wird, Schreibberechtigungen verfügen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="9cee8-298">Der ASP.NET Development Web Server, die im Kontext des aktuellen Benutzerkontos ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9cee8-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="9cee8-299">Wenn Sie Microsoft-s (Internet Information Services, IIS) als Webserver verwenden, hängt von der Sicherheitskontext Version von IIS und die Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="9cee8-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="9cee8-300">Eine weitere Herausforderung des Speicherns von Dateien im Dateisystem dreht sich um die Benennung der Dateien.</span><span class="sxs-lookup"><span data-stu-id="9cee8-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="9cee8-301">Derzeit auf unserer Seite speichert alle hochgeladenen Dateien, die `~/Brochures` Verzeichnis mit dem gleichen Namen wie die Datei auf dem Clientcomputer s verfügen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="9cee8-302">Wenn Benutzer A eine Broschüre mit dem Namen hochlädt `Brochure.pdf`, wird die Datei gespeichert werden, als `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="9cee8-303">Aber was geschieht, wenn einige Zeit später Benutzer B eine andere Broschüre-Datei hochgeladen wird, die zufällig den gleichen Dateinamen haben (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="9cee8-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="9cee8-304">Durch den Code haben wir nun, Benutzer, die eine s-Datei mit User B s Upload überschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="9cee8-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="9cee8-305">Es gibt eine Reihe von Techniken zum Lösen von Namenskonflikten.</span><span class="sxs-lookup"><span data-stu-id="9cee8-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="9cee8-306">Eine Möglichkeit ist, wenn keine Hochladen einer Datei aus, wenn eine mit dem gleichen Namen bereits vorhanden.</span><span class="sxs-lookup"><span data-stu-id="9cee8-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="9cee8-307">Bei diesem Ansatz, wenn Benutzer B versucht, zum Hochladen einer Datei mit dem Namen `Brochure.pdf`, würde das System nicht speichern Sie ihre Datei und zeigt stattdessen eine Nachricht an Benutzer B zum Umbenennen der Datei, und versuchen Sie es erneut.</span><span class="sxs-lookup"><span data-stu-id="9cee8-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="9cee8-308">Speichern Sie die Datei, die über einen eindeutigen Dateinamen, die möglicherweise ein anderer Ansatz ist eine [global eindeutigen Bezeichner (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) oder den Wert aus der entsprechenden Datenbank-Datensatz s Primärschlüsselspalte(n) (vorausgesetzt, dass der Upload zugeordnet ist ein bestimmte Zeile in das Datenmodell).</span><span class="sxs-lookup"><span data-stu-id="9cee8-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="9cee8-309">Im nächsten Tutorial werden wir diese Optionen ausführlicher erläutert.</span><span class="sxs-lookup"><span data-stu-id="9cee8-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="9cee8-310">Herausforderungen mit sehr großen Mengen von Binärdaten</span><span class="sxs-lookup"><span data-stu-id="9cee8-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="9cee8-311">In diesen Tutorials wird davon ausgegangen, dass die binären Daten erfasst mittlere Größe ist.</span><span class="sxs-lookup"><span data-stu-id="9cee8-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="9cee8-312">Arbeiten mit sehr großen Datenmengen binärdatendateien gespeichert, die mehrere Megabyte oder mehr führt neue Herausforderungen, die in diesen Tutorials nicht eingegangen sind.</span><span class="sxs-lookup"><span data-stu-id="9cee8-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="9cee8-313">Beispielsweise standardmäßig ASP.NET lehnt Uploads von mehr als 4 MB, auch wenn dies über konfiguriert werden, kann die [ `<httpRuntime>` Element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="9cee8-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="9cee8-314">Die größenbeschränkungen eine eigene Datei hochladen, wird von IIS zu erzwingt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="9cee8-315">Finden Sie unter [IIS hochladen Dateigröße](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) für Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="9cee8-316">Darüber hinaus kann die Zeit zum Hochladen großer Dateien standardmäßig 110 Sekunden überschreiten, die ASP.NET eine Anforderung gewartet wird.</span><span class="sxs-lookup"><span data-stu-id="9cee8-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="9cee8-317">Es gibt auch Arbeitsspeicher- und Leistungsproblemen Probleme, die beim Arbeiten mit großen Dateien auftreten.</span><span class="sxs-lookup"><span data-stu-id="9cee8-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="9cee8-318">Das Steuerelement "FileUpload" ist für große Dateiuploads unpraktisch.</span><span class="sxs-lookup"><span data-stu-id="9cee8-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="9cee8-319">Wie s den Inhalt der Datei an den Server zurückgesendet wird, sind, muss der Endbenutzer geduldig ohne eine Bestätigung warten, bis dieser den Fortschritt ihrer hochladen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="9cee8-320">Dies ist nicht so sehr ein Problem, bei kleineren Dateien, die in wenigen Sekunden hochgeladen werden können, jedoch kann ein Problem sein, wenn mit größeren Dateien geht, die den hochzuladenden länger dauern kann.</span><span class="sxs-lookup"><span data-stu-id="9cee8-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="9cee8-321">Gibt eine Vielzahl von Drittanbieter-Datei hochladen-Steuerelemente, die für die Behandlung großer Uploads besser geeignet sind, und viele von diesen Anbietern angeben, dass Statusanzeigen und ActiveX-Manager hochladen, die ein viel besseres Benutzererlebnis darstellen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="9cee8-322">Wenn Ihre Anwendung muss sich um große Dateien zu verarbeiten, müssen Sie sorgfältig untersuchen, die Herausforderungen, und suchen geeignete Lösungen für Ihre besonderen Bedürfnisse.</span><span class="sxs-lookup"><span data-stu-id="9cee8-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="9cee8-323">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="9cee8-323">Summary</span></span>

<span data-ttu-id="9cee8-324">Erstellen einer Anwendung, die zum Erfassen von binärer Daten benötigt, führt eine Reihe von Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="9cee8-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="9cee8-325">In diesem Tutorial haben wir untersucht, die ersten beiden: Entscheidung, wo sich die binären Daten speichern, und da der Benutzer zum Hochladen von Inhalt im Binärformat über eine Webseite.</span><span class="sxs-lookup"><span data-stu-id="9cee8-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="9cee8-326">Über die nächsten drei Tutorials sehen wir, einen Datensatz in der Datenbank die hochgeladenen Daten zugeordnet werden soll und wie die binären Daten zusammen mit der Textfelder für die Daten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="9cee8-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="9cee8-327">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="9cee8-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="9cee8-328">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="9cee8-328">Further Reading</span></span>

<span data-ttu-id="9cee8-329">Weitere Informationen zu den Themen in diesem Tutorial erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="9cee8-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="9cee8-330">Verwenden von Datentypen mit umfangreichen Werten</span><span class="sxs-lookup"><span data-stu-id="9cee8-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="9cee8-331">"FileUpload"-Steuerelement-Schnellstarts</span><span class="sxs-lookup"><span data-stu-id="9cee8-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="9cee8-332">ASP.NET 2.0 FileUpload-Serversteuerelements</span><span class="sxs-lookup"><span data-stu-id="9cee8-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="9cee8-333">Die dunkle Seite des Dateiuploads</span><span class="sxs-lookup"><span data-stu-id="9cee8-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="9cee8-334">Der Autor</span><span class="sxs-lookup"><span data-stu-id="9cee8-334">About the Author</span></span>

<span data-ttu-id="9cee8-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="9cee8-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9cee8-336">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="9cee8-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9cee8-337">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9cee8-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9cee8-338">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9cee8-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="9cee8-339">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="9cee8-339">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="9cee8-340">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="9cee8-340">Special Thanks To</span></span>

<span data-ttu-id="9cee8-341">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="9cee8-341">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9cee8-342">Führendes Prüfer für dieses Tutorial wurden Teresa Murphy und Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="9cee8-342">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="9cee8-343">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="9cee8-343">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9cee8-344">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9cee8-344">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9cee8-345">[Zurück](updating-and-deleting-existing-binary-data-cs.md)
> [Weiter](displaying-binary-data-in-the-data-web-controls-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9cee8-345">[Previous](updating-and-deleting-existing-binary-data-cs.md)
[Next](displaying-binary-data-in-the-data-web-controls-vb.md)</span></span>
