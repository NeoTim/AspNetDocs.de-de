---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
title: Hochladen von Dateien (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie Sie es Benutzern ermöglichen, Binärdateien (z. b. Word-oder PDF-Dokumente) auf Ihre Website hochzuladen, wo Sie möglicherweise im Dateisystem des Servers gespeichert werden...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: f7c00fbd-652c-433d-8ed3-0e5168a4d4df
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
msc.type: authoredcontent
ms.openlocfilehash: 6e0d57ef2f1e8132f19777a7d14e94611c68adcd
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74615274"
---
# <a name="uploading-files-vb"></a><span data-ttu-id="f2527-103">Hochladen von Dateien (VB)</span><span class="sxs-lookup"><span data-stu-id="f2527-103">Uploading Files (VB)</span></span>

<span data-ttu-id="f2527-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f2527-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f2527-105">[Beispiel-app herunterladen](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) oder [PDF herunterladen](uploading-files-vb/_static/datatutorial54vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f2527-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) or [Download PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span></span>

> <span data-ttu-id="f2527-106">Erfahren Sie, wie Sie es Benutzern ermöglichen können, Binärdateien (z. b. Word-oder PDF-Dokumente) auf Ihre Website hochzuladen, wo Sie entweder im Dateisystem des Servers oder in der Datenbank gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="f2527-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>

## <a name="introduction"></a><span data-ttu-id="f2527-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="f2527-107">Introduction</span></span>

<span data-ttu-id="f2527-108">Alle Lernprogramme, die wir bisher geprüft haben, haben ausschließlich mit Textdaten gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="f2527-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="f2527-109">Viele Anwendungen verfügen jedoch über Datenmodelle, mit denen sowohl Text-als auch Binärdaten erfasst werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="f2527-110">Eine Website für die Online Stellung kann es Benutzern ermöglichen, ein Bild hochzuladen, das Ihrem Profil zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="f2527-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="f2527-111">Eine Recruiting-Website ermöglicht Benutzern möglicherweise, ihre Fortsetzung als Microsoft Word-oder PDF-Dokument hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="f2527-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="f2527-112">Das Arbeiten mit binären Daten führt zu einer neuen Reihe von Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="f2527-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="f2527-113">Wir müssen entscheiden, wie die Binärdaten in der Anwendung gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="f2527-114">Die-Schnittstelle, die zum Einfügen neuer Datensätze verwendet wird, muss aktualisiert werden, damit der Benutzer eine Datei von Ihrem Computer hochladen kann. es müssen zusätzliche Schritte ausgeführt werden, um eine Möglichkeit zum Herunterladen der zugeordneten Binärdaten eines Datensatzes anzuzeigen oder bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f2527-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="f2527-115">In diesem Tutorial und den nächsten drei Untersuchungen wird erläutert, wie diese Herausforderungen bewältigt werden können.</span><span class="sxs-lookup"><span data-stu-id="f2527-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="f2527-116">Am Ende dieser Tutorials haben wir eine voll funktionsfähige Anwendung erstellt, die jeder Kategorie eine Bild-und PDF-Grafik zuordnet.</span><span class="sxs-lookup"><span data-stu-id="f2527-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="f2527-117">In diesem speziellen Tutorial beschäftigen wir uns mit verschiedenen Verfahren zum Speichern von Binärdaten und erfahren, wie Sie es Benutzern ermöglichen können, eine Datei von Ihrem Computer hochzuladen und auf dem Dateisystem des Webserver Servers zu speichern.</span><span class="sxs-lookup"><span data-stu-id="f2527-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="f2527-118">Binärdaten, die Teil eines Anwendungsdaten Modells sind, werden mitunter als [BLOB](http://en.wikipedia.org/wiki/Binary_large_object)bezeichnet, ein Akronym für das binäre große Objekt.</span><span class="sxs-lookup"><span data-stu-id="f2527-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="f2527-119">In diesen Tutorials habe ich mich für die Verwendung der Terminologie-Binärdaten entschieden, obwohl der Begriff "BLOB" gleichbedeutend ist.</span><span class="sxs-lookup"><span data-stu-id="f2527-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>

## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="f2527-120">Schritt 1: Erstellen der Webseiten zum Arbeiten mit Binärdaten</span><span class="sxs-lookup"><span data-stu-id="f2527-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="f2527-121">Bevor wir beginnen, die Herausforderungen im Zusammenhang mit dem Hinzufügen von Unterstützung für Binärdaten zu untersuchen, nehmen Sie sich einen Moment Zeit, um die ASP.NET-Seiten in unserem Website Projekt zu erstellen, die wir für dieses Tutorial benötigen, und die nächsten drei</span><span class="sxs-lookup"><span data-stu-id="f2527-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="f2527-122">Fügen Sie zunächst einen neuen Ordner mit dem Namen `BinaryData`hinzu.</span><span class="sxs-lookup"><span data-stu-id="f2527-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="f2527-123">Fügen Sie dann die folgenden ASP.NET-Seiten zu diesem Ordner hinzu, und stellen Sie sicher, dass Sie die einzelnen Seiten der `Site.master` Master Seite zuordnen:</span><span class="sxs-lookup"><span data-stu-id="f2527-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`

![Fügen Sie die ASP.NET-Seiten für die Binärdaten bezogenen Lernprogramme hinzu.](uploading-files-vb/_static/image1.gif)

<span data-ttu-id="f2527-125">**Abbildung 1**: Hinzufügen der ASP.NET-Seiten für die Binärdaten bezogenen Tutorials</span><span class="sxs-lookup"><span data-stu-id="f2527-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>

<span data-ttu-id="f2527-126">Wie in den anderen Ordnern werden `Default.aspx` im Ordner `BinaryData` die Lernprogramme in diesem Abschnitt auflisten.</span><span class="sxs-lookup"><span data-stu-id="f2527-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f2527-127">Denken Sie daran, dass das `SectionLevelTutorialListing.ascx` Benutzer Steuerelement diese Funktionalität bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="f2527-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f2527-128">Fügen Sie dieses Benutzer Steuerelement daher `Default.aspx` hinzu, indem Sie es aus dem Projektmappen-Explorer auf die Seite s Designansicht ziehen.</span><span class="sxs-lookup"><span data-stu-id="f2527-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="f2527-129">[![das Benutzer Steuerelement "sectionleveltutoriallisting. ascx" zu "default. aspx" hinzufügen](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span></span>

<span data-ttu-id="f2527-130">**Abbildung 2**: Hinzufügen des `SectionLevelTutorialListing.ascx` Benutzer Steuer Elements zu `Default.aspx` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-vb/_static/image2.png))</span></span>

<span data-ttu-id="f2527-131">Fügen Sie diese Seiten schließlich als Einträge zur `Web.sitemap` Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="f2527-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f2527-132">Fügen Sie insbesondere nach der Erweiterung des GridView-`<siteMapNode>`das folgende Markup hinzu:</span><span class="sxs-lookup"><span data-stu-id="f2527-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>

[!code-xml[Main](uploading-files-vb/samples/sample1.xml)]

<span data-ttu-id="f2527-133">Nehmen Sie sich nach dem Aktualisieren `Web.sitemap`einen Moment Zeit, um die Tutorials-Website über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="f2527-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f2527-134">Das Menü auf der linken Seite enthält jetzt Elemente für die Tutorials arbeiten mit binären Daten.</span><span class="sxs-lookup"><span data-stu-id="f2527-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>

![Die Site Übersicht enthält jetzt Einträge für die Tutorials arbeiten mit binären Daten.](uploading-files-vb/_static/image3.gif)

<span data-ttu-id="f2527-136">**Abbildung 3**: die Site Übersicht enthält jetzt Einträge für die Tutorials "arbeiten mit Binärdaten".</span><span class="sxs-lookup"><span data-stu-id="f2527-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>

## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="f2527-137">Schritt 2: Bestimmen des Speicher Orts der Binärdaten</span><span class="sxs-lookup"><span data-stu-id="f2527-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="f2527-138">Binärdaten, die dem Datenmodell der Anwendung zugeordnet sind, können an einer von zwei Stellen gespeichert werden: auf dem Dateisystem des Webserver s mit einem Verweis auf die in der Datenbank gespeicherte Datei. oder direkt in der Datenbank selbst (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="f2527-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="f2527-139">Jeder Ansatz verfügt über einen eigenen Satz von vor-und Nachteile und verdient eine ausführlichere Erläuterung.</span><span class="sxs-lookup"><span data-stu-id="f2527-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>

<span data-ttu-id="f2527-140">[![Binärdaten können im Datei System oder direkt in der Datenbank gespeichert werden.](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span></span>

<span data-ttu-id="f2527-141">**Abbildung 4**: Binärdaten können im Datei System oder direkt in der Datenbank gespeichert werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-vb/_static/image4.png))</span></span>

<span data-ttu-id="f2527-142">Stellen Sie sich vor, dass die Northwind-Datenbank erweitert werden soll, um jedem Produkt ein Bild zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="f2527-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="f2527-143">Eine Möglichkeit besteht darin, diese Bilddateien im Dateisystem des Webserver s zu speichern und den Pfad in der `Products` Tabelle aufzuzeichnen.</span><span class="sxs-lookup"><span data-stu-id="f2527-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="f2527-144">Bei diesem Ansatz fügen wir eine `ImagePath` Spalte zur `Products`-Tabelle des Typs `varchar(200)`hinzu, vielleicht.</span><span class="sxs-lookup"><span data-stu-id="f2527-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="f2527-145">Wenn ein Benutzer ein Bild für Chai hochgeladen hat, wird das Bild möglicherweise auf dem Dateisystem des Webserver s auf `~/Images/Tea.jpg`gespeichert, wobei `~` den physischen Pfad der Anwendung darstellt.</span><span class="sxs-lookup"><span data-stu-id="f2527-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="f2527-146">Das heißt, wenn sich die Website auf den physischen Pfad `C:\Websites\Northwind\`befindet, entsprechen `~/Images/Tea.jpg` `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="f2527-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="f2527-147">Nachdem Sie die Bilddatei hochgeladen haben, aktualisieren wir den Chai-Datensatz in der `Products`-Tabelle, damit die `ImagePath` Spalte auf den Pfad des neuen Images verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="f2527-148">Wir könnten `~/Images/Tea.jpg` oder nur `Tea.jpg` verwenden, wenn wir beschlossen haben, dass alle Produkt Images in den Ordner der Anwendung `Images` eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="f2527-149">Die Hauptvorteile der Speicherung der Binärdaten im Dateisystem sind:</span><span class="sxs-lookup"><span data-stu-id="f2527-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="f2527-150">**Einfache Implementierung** , wie wir bald sehen werden, umfasst das Speichern und Abrufen von Binärdaten, die direkt in der Datenbank gespeichert werden, etwas mehr Code als bei der Arbeit mit Daten über das Dateisystem.</span><span class="sxs-lookup"><span data-stu-id="f2527-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="f2527-151">Damit ein Benutzer Binärdaten anzeigen oder herunterladen kann, muss er außerdem mit einer URL zu diesen Daten angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="f2527-152">Wenn sich die Daten auf dem Dateisystem des Webserver Servers befinden, ist die URL unkompliziert.</span><span class="sxs-lookup"><span data-stu-id="f2527-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="f2527-153">Wenn die Daten in der Datenbank gespeichert werden, muss jedoch eine Webseite erstellt werden, mit der die Daten aus der Datenbank abgerufen und zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="f2527-154">**Größerer Zugriff auf die Binärdaten** , auf die die Binärdaten möglicherweise von anderen Diensten oder Anwendungen zugegriffen werden kann, von denen die Daten nicht aus der Datenbank abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="f2527-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="f2527-155">Beispielsweise können die Images, die mit den einzelnen Produkten verknüpft sind, auch für Benutzer über [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol)verfügbar sein. in diesem Fall möchten wir die Binärdaten im Dateisystem speichern.</span><span class="sxs-lookup"><span data-stu-id="f2527-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="f2527-156">**Leistung** wenn die Binärdaten im Dateisystem gespeichert werden, sind die Anforderungen und die Netzwerk Überlastung zwischen dem Datenbankserver und dem Webserver geringer, als wenn die Binärdaten direkt in der Datenbank gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="f2527-157">Der Hauptnachteil beim Speichern von Binärdaten im Dateisystem besteht darin, dass die Daten von der Datenbank entkoppelt werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="f2527-158">Wenn ein Datensatz aus der `Products` Tabelle gelöscht wird, wird die zugehörige Datei im Dateisystem des Webserver s nicht automatisch gelöscht.</span><span class="sxs-lookup"><span data-stu-id="f2527-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="f2527-159">Wir müssen zusätzlichen Code schreiben, um die Datei zu löschen, oder das Dateisystem wird mit nicht verwendeten, verwaisten Dateien überlastet.</span><span class="sxs-lookup"><span data-stu-id="f2527-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="f2527-160">Außerdem muss beim Sichern der Datenbank sichergestellt werden, dass auch Sicherungen der zugeordneten Binärdaten im Dateisystem vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="f2527-161">Das Verschieben der Datenbank auf einen anderen Standort oder Server bringt ähnliche Herausforderungen mit sich.</span><span class="sxs-lookup"><span data-stu-id="f2527-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="f2527-162">Alternativ können binäre Daten direkt in einer Microsoft SQL Server 2005-Datenbank gespeichert werden, indem eine Spalte vom Typ "`varbinary`" erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="f2527-163">Wie bei anderen Datentypen variabler Länge können Sie eine maximale Länge der Binärdaten angeben, die in dieser Spalte gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="f2527-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="f2527-164">Verwenden Sie z. b. zum Reservieren von höchstens 5.000 Bytes `varbinary(5000)`; `varbinary(MAX)` ermöglicht die maximale Speichergröße von ca. 2 GB.</span><span class="sxs-lookup"><span data-stu-id="f2527-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="f2527-165">Der Hauptvorteil der direkten Speicherung von Binärdaten in der Datenbank ist die enge Kopplung zwischen den Binärdaten und dem Datenbankdaten Satz.</span><span class="sxs-lookup"><span data-stu-id="f2527-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="f2527-166">Dadurch werden Datenbankverwaltungsaufgaben, wie z. b. Sicherungen oder das Verschieben der Datenbank auf einen anderen Standort oder Server, erheblich vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="f2527-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="f2527-167">Beim Löschen eines Datensatzes werden auch die entsprechenden Binärdaten automatisch gelöscht.</span><span class="sxs-lookup"><span data-stu-id="f2527-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="f2527-168">Die Speicherung der Binärdaten in der Datenbank hat ebenfalls größere Vorteile.</span><span class="sxs-lookup"><span data-stu-id="f2527-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="f2527-169">Eine ausführlichere Erläuterung finden [Sie unter Speichern von Binärdateien direkt in der Datenbank mit ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) .</span><span class="sxs-lookup"><span data-stu-id="f2527-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="f2527-170">In Microsoft SQL Server 2000 und früheren Versionen enthielt der `varbinary` Datentyp einen maximalen Grenzwert von 8.000 Bytes.</span><span class="sxs-lookup"><span data-stu-id="f2527-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="f2527-171">Zum Speichern von bis zu 2 GB Binärdaten muss stattdessen der [`image` Datentyp](https://msdn.microsoft.com/library/ms187993.aspx) verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="f2527-172">Durch das Hinzufügen von `MAX` in SQL Server 2005 ist der `image` Datentyp jedoch veraltet.</span><span class="sxs-lookup"><span data-stu-id="f2527-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="f2527-173">Es wird weiterhin aus Gründen der Abwärtskompatibilität unterstützt, aber Microsoft hat angekündigt, dass der `image`-Datentyp in einer zukünftigen Version von SQL Server entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>

<span data-ttu-id="f2527-174">Wenn Sie mit einem älteren Datenmodell arbeiten, sehen Sie möglicherweise den `image`-Datentyp.</span><span class="sxs-lookup"><span data-stu-id="f2527-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="f2527-175">Die `Categories` Tabelle der Northwind-Datenbank verfügt über eine `Picture` Spalte, die zum Speichern der Binärdaten einer Bilddatei für die Kategorie verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="f2527-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="f2527-176">Da die Northwind-Datenbank Ihre Stamm Elemente in Microsoft Access und früheren Versionen von SQL Server hat, ist diese Spalte vom Typ `image`.</span><span class="sxs-lookup"><span data-stu-id="f2527-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="f2527-177">In diesem Tutorial und den nächsten drei Methoden werden beide Ansätze verwendet.</span><span class="sxs-lookup"><span data-stu-id="f2527-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="f2527-178">Die `Categories` Tabelle verfügt bereits über eine `Picture` Spalte zum Speichern des binären Inhalts eines Bilds für die Kategorie.</span><span class="sxs-lookup"><span data-stu-id="f2527-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="f2527-179">Wir fügen eine zusätzliche Spalte (`BrochurePath`) hinzu, um einen Pfad zu einer PDF-Datei im Webserver-Dateisystem zu speichern, die verwendet werden kann, um eine drucksqualität, eine polierte Übersicht über die Kategorie bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f2527-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="f2527-180">Schritt 3: Hinzufügen der`BrochurePath`Spalte zur Tabelle "`Categories`"</span><span class="sxs-lookup"><span data-stu-id="f2527-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="f2527-181">Die Kategorietabelle enthält derzeit nur vier Spalten: `CategoryID`, `CategoryName`, `Description`und `Picture`.</span><span class="sxs-lookup"><span data-stu-id="f2527-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="f2527-182">Zusätzlich zu diesen Feldern müssen wir eine neue hinzufügen, die auf die-Kategorie der Kategorie zeigt (sofern vorhanden).</span><span class="sxs-lookup"><span data-stu-id="f2527-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="f2527-183">Wechseln Sie zum Hinzufügen dieser Spalte zum Server-Explorer, führen Sie einen Drilldown in die Tabellen aus, klicken Sie mit der rechten Maustaste auf die `Categories` Tabelle, und wählen Sie Tabellen Definition öffnen (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="f2527-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="f2527-184">Wenn die Server-Explorer nicht angezeigt wird, wählen Sie Sie aus, indem Sie im Menü Ansicht die Option Server-Explorer auswählen oder STRG + ALT + S drücken.</span><span class="sxs-lookup"><span data-stu-id="f2527-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="f2527-185">Fügen Sie der `Categories` Tabelle, die `BrochurePath` benannt ist, eine neue `varchar(200)` Spalte hinzu, die `NULL` s zulässt, und klicken Sie auf das Symbol "Speichern" (oder drücken Sie STRG + s).</span><span class="sxs-lookup"><span data-stu-id="f2527-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>

<span data-ttu-id="f2527-186">[![der Tabelle "categories" eine "brochurepath"-Spalte hinzufügen](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span></span>

<span data-ttu-id="f2527-187">**Abbildung 5**: Hinzufügen einer `BrochurePath` Spalte zur `Categories` Tabelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-vb/_static/image6.png))</span></span>

## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="f2527-188">Schritt 4: Aktualisieren der Architektur zur Verwendung der Spalten "`Picture`" und "`BrochurePath`"</span><span class="sxs-lookup"><span data-stu-id="f2527-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="f2527-189">Für den `CategoriesDataTable` in der Datenzugriffs Schicht (Data Access Layer, DAL) sind derzeit vier `DataColumn` s definiert: `CategoryID`, `CategoryName`, `Description`und `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="f2527-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="f2527-190">Wenn diese Datentabelle ursprünglich im Tutorial [Erstellen einer Datenzugriffs Schicht](../introduction/creating-a-data-access-layer-vb.md) entworfen wurde, hatten die `CategoriesDataTable` nur die ersten drei Spalten. die Spalte `NumberOfProducts` wurde im [Master/Detail mithilfe einer Auflistungs Liste mit Master Datensätzen mit einem DataList-Detail](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) -Tutorial hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="f2527-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial.</span></span>

<span data-ttu-id="f2527-191">Wie unter *Erstellen einer Datenzugriffs Ebene*erläutert, bilden die DataTables im typisierten DataSet die Geschäftsobjekte.</span><span class="sxs-lookup"><span data-stu-id="f2527-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="f2527-192">Die TableAdapters sind dafür verantwortlich, mit der Datenbank zu kommunizieren und die Geschäftsobjekte mit den Abfrage Ergebnissen aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="f2527-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="f2527-193">Die `CategoriesDataTable` wird mit dem `CategoriesTableAdapter`aufgefüllt, das drei Methoden zum Abrufen von Daten enthält:</span><span class="sxs-lookup"><span data-stu-id="f2527-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="f2527-194">`GetCategories()` führt die Haupt Abfrage des TableAdapter s aus und gibt die Felder `CategoryID`, `CategoryName`und `Description` aller Datensätze in der `Categories` Tabelle zurück.</span><span class="sxs-lookup"><span data-stu-id="f2527-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="f2527-195">Die Haupt Abfrage wird von den automatisch generierten Methoden `Insert` und `Update` verwendet.</span><span class="sxs-lookup"><span data-stu-id="f2527-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="f2527-196">`GetCategoryByCategoryID(categoryID)` gibt die Felder `CategoryID`, `CategoryName`und `Description` der Kategorie zurück, deren `CategoryID` *CategoryID*ist.</span><span class="sxs-lookup"><span data-stu-id="f2527-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="f2527-197">`GetCategoriesAndNumberOfProducts()`: gibt die Felder `CategoryID`, `CategoryName`und `Description` für alle Datensätze in der `Categories` Tabelle zurück.</span><span class="sxs-lookup"><span data-stu-id="f2527-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="f2527-198">Verwendet auch eine Unterabfrage, um die Anzahl der jeder Kategorie zugeordneten Produkte zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="f2527-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="f2527-199">Beachten Sie, dass keine dieser Abfragen die `Categories` Tabelle s `Picture` oder `BrochurePath` Spalten zurückgibt. und die `CategoriesDataTable` `DataColumn` s für diese Felder bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="f2527-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="f2527-200">Um mit den Bild-und `BrochurePath` Eigenschaften arbeiten zu können, müssen Sie Sie zunächst der `CategoriesDataTable` hinzufügen und dann die `CategoriesTableAdapter`-Klasse aktualisieren, um diese Spalten zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="f2527-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="f2527-201">Hinzufügen der`Picture`und`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="f2527-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="f2527-202">Beginnen Sie, indem Sie diese beiden Spalten zum `CategoriesDataTable`hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="f2527-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="f2527-203">Klicken Sie mit der rechten Maustaste auf den Header `CategoriesDataTable` s, wählen Sie im Kontextmenü hinzufügen aus, und wählen Sie dann die Option Column aus.</span><span class="sxs-lookup"><span data-stu-id="f2527-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="f2527-204">Dadurch wird eine neue `DataColumn` in der Datentabelle mit dem Namen "`Column1`" erstellt.</span><span class="sxs-lookup"><span data-stu-id="f2527-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="f2527-205">Benennen Sie diese Spalte in `Picture`um.</span><span class="sxs-lookup"><span data-stu-id="f2527-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="f2527-206">Legen Sie im Eigenschaftenfenster die Eigenschaft `DataColumn` s `DataType` auf `System.Byte[]` fest (Dies ist keine Option in der Dropdown Liste; Sie müssen Sie in eingeben).</span><span class="sxs-lookup"><span data-stu-id="f2527-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>

<span data-ttu-id="f2527-207">[![erstellen Sie eine datacolenn mit dem Namen "Image", deren Datentyp "System. Byte []" ist.](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span></span>

<span data-ttu-id="f2527-208">**Abbildung 6**: Erstellen eines `DataColumn` namens `Picture` dessen `DataType` `System.Byte[]` ist ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-vb/_static/image8.png))</span></span>

<span data-ttu-id="f2527-209">Fügen Sie der Datentabelle eine weitere `DataColumn` hinzu, und benennen Sie Sie `BrochurePath` mit dem Standard `DataType` Wert (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="f2527-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="f2527-210">Zurückgeben der Werte für`Picture`und`BrochurePath`aus dem TableAdapter</span><span class="sxs-lookup"><span data-stu-id="f2527-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="f2527-211">Nachdem diese beiden `DataColumn` s der `CategoriesDataTable`hinzugefügt wurden, können Sie die `CategoriesTableAdapter`aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="f2527-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="f2527-212">Wir könnten beide Spaltenwerte in der Haupt-TableAdapter-Abfrage zurückgegeben haben, aber dies würde die Binärdaten jedes Mal wiederholen, wenn die `GetCategories()`-Methode aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="f2527-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="f2527-213">Aktualisieren Sie stattdessen die Haupt-TableAdapter-Abfrage so, dass `BrochurePath` zurückgegeben wird, und erstellen Sie eine zusätzliche Datenabruf Methode, die eine bestimmte Kategorie s `Picture` Spalte zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f2527-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="f2527-214">Klicken Sie zum Aktualisieren der TableAdapter-Haupt Abfrage mit der rechten Maustaste auf den Header `CategoriesTableAdapter` s, und wählen Sie im Kontextmenü die Option konfigurieren aus.</span><span class="sxs-lookup"><span data-stu-id="f2527-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="f2527-215">Dadurch wird der Assistent für die Tabellen Adapter Konfiguration geöffnet, den wir in einer Reihe früherer Tutorials kennengelernt haben.</span><span class="sxs-lookup"><span data-stu-id="f2527-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="f2527-216">Aktualisieren Sie die Abfrage, um die `BrochurePath` wiederholen, und klicken Sie auf Fertigstellen.</span><span class="sxs-lookup"><span data-stu-id="f2527-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>

<span data-ttu-id="f2527-217">[![die Spaltenliste in der SELECT-Anweisung aktualisieren, damit auch "brochurepath" zurückgegeben wird.](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span></span>

<span data-ttu-id="f2527-218">**Abbildung 7**: Aktualisieren der Spaltenliste in der `SELECT`-Anweisung, um auch `BrochurePath` zurückzugeben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-vb/_static/image10.png))</span></span>

<span data-ttu-id="f2527-219">Wenn Sie Ad-hoc-SQL-Anweisungen für den TableAdapter verwenden, wird durch Aktualisieren der Spaltenliste in der Haupt Abfrage die Spaltenliste für alle `SELECT` Abfrage Methoden im TableAdapter aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="f2527-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="f2527-220">Dies bedeutet, dass die `GetCategoryByCategoryID(categoryID)`-Methode aktualisiert wurde, um die `BrochurePath` Spalte zurückzugeben. Dies ist möglicherweise beabsichtigt.</span><span class="sxs-lookup"><span data-stu-id="f2527-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="f2527-221">Es wurde jedoch auch die Spaltenliste in der `GetCategoriesAndNumberOfProducts()`-Methode aktualisiert, wobei die Unterabfrage entfernt wird, die die Anzahl der Produkte für jede Kategorie zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f2527-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="f2527-222">Daher müssen wir diese Methode `SELECT` Abfrage aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="f2527-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="f2527-223">Klicken Sie mit der rechten Maustaste auf die `GetCategoriesAndNumberOfProducts()` Methode, wählen Sie konfigurieren aus, und setzen Sie die `SELECT` Abfrage auf ihren ursprünglichen Wert zurück:</span><span class="sxs-lookup"><span data-stu-id="f2527-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>

[!code-sql[Main](uploading-files-vb/samples/sample2.sql)]

<span data-ttu-id="f2527-224">Erstellen Sie als nächstes eine neue TableAdapter-Methode, die eine bestimmte Kategorie s `Picture` Spaltenwert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="f2527-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="f2527-225">Klicken Sie mit der rechten Maustaste auf den Header `CategoriesTableAdapter` s, und wählen Sie die Option Abfrage hinzufügen aus, um den Assistenten zum Konfigurieren von TableAdapter abzufragen</span><span class="sxs-lookup"><span data-stu-id="f2527-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="f2527-226">Im ersten Schritt dieses Assistenten werden Sie gefragt, ob Sie Daten mit einer Ad-hoc-SQL-Anweisung, einer neuen gespeicherten Prozedur oder einer vorhandenen Abfrage Abfragen möchten.</span><span class="sxs-lookup"><span data-stu-id="f2527-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="f2527-227">Wählen Sie SQL-Anweisungen verwenden, und klicken Sie auf weiter</span><span class="sxs-lookup"><span data-stu-id="f2527-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="f2527-228">Da wir eine Zeile zurückgeben, wählen Sie im zweiten Schritt die Option Select What Returns Rows aus.</span><span class="sxs-lookup"><span data-stu-id="f2527-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>

<span data-ttu-id="f2527-229">[![wählen Sie die Option SQL-Anweisungen verwenden aus.](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-229">[![Select the Use SQL statements Option](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span></span>

<span data-ttu-id="f2527-230">**Abbildung 8**: Auswählen der Option "SQL-Anweisungen verwenden" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-vb/_static/image12.png))</span></span>

<span data-ttu-id="f2527-231">[![, da die Abfrage einen Datensatz aus der Categories-Tabelle zurückgibt, wählen Sie auswählen, wodurch Zeilen zurückgegeben werden.](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span></span>

<span data-ttu-id="f2527-232">**Abbildung 9**: da die Abfrage einen Datensatz aus der Categories-Tabelle zurückgibt, wählen Sie auswählen, wodurch die Zeilen zurückgegeben werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image14.png)).</span><span class="sxs-lookup"><span data-stu-id="f2527-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-vb/_static/image14.png))</span></span>

<span data-ttu-id="f2527-233">Geben Sie im dritten Schritt die folgende SQL-Abfrage ein, und klicken Sie auf Weiter:</span><span class="sxs-lookup"><span data-stu-id="f2527-233">In the third step, enter the following SQL query and click Next:</span></span>

[!code-sql[Main](uploading-files-vb/samples/sample3.sql)]

<span data-ttu-id="f2527-234">Der letzte Schritt besteht darin, den Namen für die neue Methode auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="f2527-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="f2527-235">Verwenden Sie `FillCategoryWithBinaryDataByCategoryID` und `GetCategoryWithBinaryDataByCategoryID` für die Datentabelle ausfüllen und Datentabelle zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="f2527-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="f2527-236">Klicken Sie auf Fertig stellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="f2527-236">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="f2527-237">[![wählen Sie die Namen für die TableAdapter s-Methoden aus.](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span></span>

<span data-ttu-id="f2527-238">**Abbildung 10**: Wählen Sie die Namen für die TableAdapter s-Methoden aus ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image16.png)).</span><span class="sxs-lookup"><span data-stu-id="f2527-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-vb/_static/image16.png))</span></span>

> [!NOTE]
> <span data-ttu-id="f2527-239">Nachdem Sie den Assistenten zum Konfigurieren der Tabellen Adapter Abfrage abgeschlossen haben, wird möglicherweise ein Dialogfeld angezeigt, das Sie darüber informiert, dass der neue Befehls Text Daten zurückgibt, die sich vom Schema der Haupt Abfrage unterscheiden.</span><span class="sxs-lookup"><span data-stu-id="f2527-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="f2527-240">Kurz gesagt: der Assistent gibt an, dass die Haupt Abfrage `GetCategories()` des TableAdapter s ein anderes Schema zurückgibt als das, das wir soeben erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="f2527-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="f2527-241">Aber dies ist das, was wir wollen, damit Sie diese Meldung ignorieren können.</span><span class="sxs-lookup"><span data-stu-id="f2527-241">But this is what we want, so you can disregard this message.</span></span>

<span data-ttu-id="f2527-242">Beachten Sie auch, dass bei Verwendung von Ad-hoc-SQL-Anweisungen und der Verwendung des Assistenten zum Ändern der Haupt Abfrage des TableAdapter s zu einem späteren Zeitpunkt geändert wird, dass die Spaltenliste der `GetCategoryWithBinaryDataByCategoryID`-Methode s `SELECT` Anweisung so geändert wird, dass nur die Spalten aus der Haupt Abfrage eingeschlossen werden (d. h., die `Picture` Spalte wird aus der Abfrage entfernt).</span><span class="sxs-lookup"><span data-stu-id="f2527-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="f2527-243">Sie müssen die Spaltenliste manuell aktualisieren, um die `Picture` Spalte zurückzugeben, ähnlich wie bei der `GetCategoriesAndNumberOfProducts()`-Methode weiter oben in diesem Schritt.</span><span class="sxs-lookup"><span data-stu-id="f2527-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="f2527-244">Nach dem Hinzufügen der beiden `DataColumn` s zum `CategoriesDataTable` und der `GetCategoryWithBinaryDataByCategoryID`-Methode zum `CategoriesTableAdapter`sollten diese Klassen im typisierten DataSet-Designer wie der Screenshot in Abbildung 11 aussehen.</span><span class="sxs-lookup"><span data-stu-id="f2527-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>

![Der DataSet-Designer enthält die neuen Spalten und Methoden.](uploading-files-vb/_static/image11.gif)

<span data-ttu-id="f2527-246">**Abbildung 11**: der DataSet-Designer enthält die neuen Spalten und Methoden.</span><span class="sxs-lookup"><span data-stu-id="f2527-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>

## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="f2527-247">Aktualisieren der Geschäftslogik Schicht (Business Logic Layer, BLL)</span><span class="sxs-lookup"><span data-stu-id="f2527-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="f2527-248">Wenn die DAL aktualisiert wurde, besteht nur noch die Erweiterung der Geschäftslogik Schicht (BLL), um eine Methode für die neue `CategoriesTableAdapter` Methode einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="f2527-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="f2527-249">Fügen Sie der `CategoriesBLL`-Klasse die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="f2527-249">Add the following method to the `CategoriesBLL` class:</span></span>

[!code-vb[Main](uploading-files-vb/samples/sample4.vb)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="f2527-250">Schritt 5: Hochladen einer Datei vom Client auf den Webserver</span><span class="sxs-lookup"><span data-stu-id="f2527-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="f2527-251">Beim Sammeln von Binärdaten werden diese Daten oft von einem Endbenutzer bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="f2527-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="f2527-252">Um diese Informationen zu erfassen, muss der Benutzer in der Lage sein, eine Datei von Ihrem Computer auf den Webserver hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="f2527-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="f2527-253">Die hochgeladenen Daten müssen dann in das Datenmodell integriert werden. Dies kann bedeuten, dass die Datei im Dateisystem des Webserver gespeichert wird und ein Pfad zur Datei in der Datenbank hinzugefügt oder der binäre Inhalt direkt in die Datenbank geschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="f2527-254">In diesem Schritt wird erläutert, wie Sie es Benutzern ermöglichen, Dateien von Ihrem Computer auf den Server hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="f2527-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="f2527-255">Im nächsten Tutorial wird die Integration der hochgeladenen Datei in das Datenmodell berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="f2527-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="f2527-256">ASP.NET 2,0 s neues [FileUpload-websteuer](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) Element bietet einen Mechanismus, mit dem Benutzer eine Datei von Ihrem Computer an den Webserver senden können.</span><span class="sxs-lookup"><span data-stu-id="f2527-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="f2527-257">Das FileUpload-Steuerelement wird als `<input>` Element gerendert, dessen `type`-Attribut auf File festgelegt ist. die Browser werden als Textfeld mit einer Schaltfläche zum Durchsuchen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f2527-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="f2527-258">Wenn Sie auf die Schaltfläche Durchsuchen klicken, wird ein Dialogfeld geöffnet, in dem der Benutzer eine Datei auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="f2527-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="f2527-259">Wenn das Formular zurückgesendet wird, werden die Inhalte der ausgewählten Dateien zusammen mit dem Postback gesendet.</span><span class="sxs-lookup"><span data-stu-id="f2527-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="f2527-260">Auf der Serverseite sind Informationen über die hochgeladene Datei über die Eigenschaften des FileUpload-Steuer Elements zugänglich.</span><span class="sxs-lookup"><span data-stu-id="f2527-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="f2527-261">Um das Hochladen von Dateien zu veranschaulichen, öffnen Sie die Seite `FileUpload.aspx` im Ordner `BinaryData`, ziehen Sie ein FileUpload-Steuerelement aus der Toolbox auf den Designer, und legen Sie die Eigenschaft des Steuer Elements `ID` auf `UploadTest`fest.</span><span class="sxs-lookup"><span data-stu-id="f2527-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="f2527-262">Fügen Sie als nächstes ein Schaltflächen-websteuer Element hinzu, indem Sie dessen `ID` und `Text` Eigenschaften `UploadButton` und die ausgewählte Datei hochladen.</span><span class="sxs-lookup"><span data-stu-id="f2527-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="f2527-263">Platzieren Sie abschließend ein Label-websteuer Element unterhalb der Schaltfläche, löschen Sie die `Text`-Eigenschaft, und legen Sie die `ID`-Eigenschaft auf `UploadDetails`fest.</span><span class="sxs-lookup"><span data-stu-id="f2527-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>

<span data-ttu-id="f2527-264">[![der Seite "ASP.net" ein FileUpload-Steuerelement hinzufügen](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span></span>

<span data-ttu-id="f2527-265">**Abbildung 12**: Hinzufügen eines FileUpload-Steuer Elements zur Seite "ASP.net" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-vb/_static/image18.png))</span></span>

<span data-ttu-id="f2527-266">In Abbildung 13 wird diese Seite angezeigt, wenn Sie in einem Browser angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="f2527-267">Wenn Sie auf die Schaltfläche Durchsuchen klicken, wird ein Dialogfeld für die Dateiauswahl angezeigt, in dem der Benutzer eine Datei auf dem Computer auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="f2527-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="f2527-268">Nachdem eine Datei ausgewählt wurde, wird durch Klicken auf die Schaltfläche ausgewählte Datei hochladen ein Postback ausgelöst, bei dem der Binär Inhalt der ausgewählten Datei an den Webserver gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>

<span data-ttu-id="f2527-269">[![kann der Benutzer eine Datei auswählen, die von seinem Computer auf den Server hochgeladen werden soll.](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span></span>

<span data-ttu-id="f2527-270">**Abbildung 13**: der Benutzer kann eine Datei auswählen, die von seinem Computer auf den Server hochgeladen werden soll ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-vb/_static/image20.png))</span></span>

<span data-ttu-id="f2527-271">Beim Postback kann die hochgeladene Datei im Dateisystem gespeichert werden, oder die zugehörigen Binärdaten können direkt über einen Stream bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="f2527-272">Erstellen Sie in diesem Beispiel einen `~/Brochures` Ordner, und speichern Sie die hochgeladene Datei dort.</span><span class="sxs-lookup"><span data-stu-id="f2527-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="f2527-273">Fügen Sie zunächst den `Brochures` Ordner der Website als Unterordner des Stamm Verzeichnisses hinzu.</span><span class="sxs-lookup"><span data-stu-id="f2527-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="f2527-274">Erstellen Sie als nächstes einen Ereignishandler für das `UploadButton` s `Click`-Ereignis, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="f2527-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>

[!code-vb[Main](uploading-files-vb/samples/sample5.vb)]

<span data-ttu-id="f2527-275">Das FileUpload-Steuerelement bietet eine Vielzahl von Eigenschaften zum Arbeiten mit den hochgeladenen Daten.</span><span class="sxs-lookup"><span data-stu-id="f2527-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="f2527-276">Die [`HasFile`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) gibt beispielsweise an, ob eine Datei vom Benutzer hochgeladen wurde, während die [`FileBytes`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) den Zugriff auf die hochgeladenen Binärdaten als Bytearray ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="f2527-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="f2527-277">Der `Click` Ereignishandler stellt sicher, dass eine Datei hochgeladen wurde.</span><span class="sxs-lookup"><span data-stu-id="f2527-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="f2527-278">Wenn eine Datei hochgeladen wurde, wird in der Bezeichnung der Name der hochgeladenen Datei, die Größe in Bytes und deren Inhaltstyp angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f2527-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="f2527-279">Um sicherzustellen, dass der Benutzer eine Datei hochlädt, können Sie die `HasFile`-Eigenschaft überprüfen und eine Warnung anzeigen, wenn Sie `False`, oder Sie können stattdessen das Steuerelement "Requirements [dfieldvalidator](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) " verwenden.</span><span class="sxs-lookup"><span data-stu-id="f2527-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `False`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>

<span data-ttu-id="f2527-280">Das FileUpload s-`SaveAs(filePath)` speichert die hochgeladene Datei im angegebenen *FilePath*.</span><span class="sxs-lookup"><span data-stu-id="f2527-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="f2527-281">" *FilePath* " muss ein *physischer Pfad* (`C:\Websites\Brochures\SomeFile.pdf`) anstelle eines *virtuellen* *Pfads* (`/Brochures/SomeFile.pdf`) sein.</span><span class="sxs-lookup"><span data-stu-id="f2527-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="f2527-282">Die [`Server.MapPath(virtPath)`-Methode](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) nimmt einen virtuellen Pfad an und gibt den zugehörigen physischen Pfad zurück.</span><span class="sxs-lookup"><span data-stu-id="f2527-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="f2527-283">Hier ist der virtuelle Pfad `~/Brochures/fileName`, wobei *filename* der Name der hochgeladenen Datei ist.</span><span class="sxs-lookup"><span data-stu-id="f2527-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="f2527-284">Weitere Informationen zu virtuellen und physischen Pfaden und zum Verwenden von `Server.MapPath`finden Sie unter Verwenden von " [Server. MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) ".</span><span class="sxs-lookup"><span data-stu-id="f2527-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="f2527-285">Nachdem Sie den `Click`-Ereignishandler abgeschlossen haben, nehmen Sie sich einen Moment Zeit, um die Seite in einem Browser zu testen.</span><span class="sxs-lookup"><span data-stu-id="f2527-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="f2527-286">Klicken Sie auf die Schaltfläche Durchsuchen, wählen Sie eine Datei auf der Festplatte aus, und klicken Sie auf die Schaltfläche ausgewählte Datei hochladen</span><span class="sxs-lookup"><span data-stu-id="f2527-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="f2527-287">Das Postback sendet den Inhalt der ausgewählten Datei an den Webserver, der Informationen über die Datei anzeigt, bevor Sie im Ordner "`~/Brochures`" gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="f2527-288">Kehren Sie nach dem Hochladen der Datei zu Visual Studio zurück, und klicken Sie im Projektmappen-Explorer auf die Schaltfläche Aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="f2527-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="f2527-289">Die Datei, die Sie soeben hochgeladen haben, sollte in den Ordner ~/brochures angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>

<span data-ttu-id="f2527-290">[![die Datei "evolutional. jpg" auf den Webserver hochgeladen wurde.](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f2527-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span></span>

<span data-ttu-id="f2527-291">**Abbildung 14**: der Datei `EvolutionValley.jpg` wurde auf den Webserver hochgeladen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](uploading-files-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="f2527-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-vb/_static/image22.png))</span></span>

!["Evolutionvalley. jpg" wurde im Ordner "~/Brochures" gespeichert.](uploading-files-vb/_static/image15.gif)

<span data-ttu-id="f2527-293">**Abbildung 15**: `EvolutionValley.jpg` im Ordner "`~/Brochures`" gespeichert</span><span class="sxs-lookup"><span data-stu-id="f2527-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>

## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="f2527-294">Feinheiten beim Speichern von hochgeladenen Dateien im Datei System</span><span class="sxs-lookup"><span data-stu-id="f2527-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="f2527-295">Es gibt mehrere Feinheiten, die beim Speichern des Hochladens von Dateien in das Dateisystem des Webserver s behandelt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="f2527-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="f2527-296">Erstens gibt es das Problem der Sicherheit.</span><span class="sxs-lookup"><span data-stu-id="f2527-296">First, there s the issue of security.</span></span> <span data-ttu-id="f2527-297">Um eine Datei im Dateisystem zu speichern, muss der Sicherheitskontext, unter dem die ASP.NET Seite ausgeführt wird, über Schreibberechtigungen verfügen.</span><span class="sxs-lookup"><span data-stu-id="f2527-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="f2527-298">Der ASP.NET Development-Webserver wird im Kontext Ihres aktuellen Benutzerkontos ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="f2527-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="f2527-299">Wenn Sie Microsoft s Internetinformationsdienste (IIS) als Webserver verwenden, hängt der Sicherheitskontext von der IIS-Version und der zugehörigen Konfiguration ab.</span><span class="sxs-lookup"><span data-stu-id="f2527-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="f2527-300">Eine weitere Herausforderung, Dateien im Dateisystem zu speichern, dreht sich um das Benennen der Dateien.</span><span class="sxs-lookup"><span data-stu-id="f2527-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="f2527-301">Zurzeit speichert unsere Seite alle hochgeladenen Dateien im `~/Brochures` Verzeichnis mit dem gleichen Namen wie die Datei auf dem Client Computer.</span><span class="sxs-lookup"><span data-stu-id="f2527-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="f2527-302">Wenn Benutzer a eine Broschüre mit dem Namen `Brochure.pdf`hochlädt, wird die Datei als `~/Brochure/Brochure.pdf`gespeichert.</span><span class="sxs-lookup"><span data-stu-id="f2527-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="f2527-303">Was passiert jedoch, wenn Benutzer a später eine andere Datei mit dem gleichen Dateinamen (`Brochure.pdf`) hochladen?</span><span class="sxs-lookup"><span data-stu-id="f2527-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="f2527-304">Mit dem Code, den wir jetzt haben, wird der Benutzer eine s-Datei mit Upload von Benutzer B s überschrieben.</span><span class="sxs-lookup"><span data-stu-id="f2527-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="f2527-305">Es gibt eine Reihe von Techniken zum Auflösen von Dateinamen Konflikten.</span><span class="sxs-lookup"><span data-stu-id="f2527-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="f2527-306">Eine Möglichkeit besteht darin, das Hochladen einer Datei zu verbieten, wenn bereits eine Datei mit demselben Namen vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="f2527-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="f2527-307">Wenn Benutzer b versucht, eine Datei mit dem Namen "`Brochure.pdf`" hochzuladen, speichert das System die Datei nicht und zeigt stattdessen eine Meldung an, in der Benutzer b zum Umbenennen der Datei und wiederholen des Vorgangs angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="f2527-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="f2527-308">Ein anderer Ansatz besteht darin, die Datei mit einem eindeutigen Dateinamen zu speichern, bei dem es sich um einen [Globally Unique Identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) oder den Wert aus den entsprechenden Primärschlüssel Spalten des Datensatzes handelt (vorausgesetzt, der Upload ist einer bestimmten Zeile im Datenmodell zugeordnet).</span><span class="sxs-lookup"><span data-stu-id="f2527-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="f2527-309">Im nächsten Tutorial werden diese Optionen ausführlicher erläutert.</span><span class="sxs-lookup"><span data-stu-id="f2527-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="f2527-310">Herausforderungen bei sehr großen Mengen an Binärdaten</span><span class="sxs-lookup"><span data-stu-id="f2527-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="f2527-311">In diesen Tutorials wird davon ausgegangen, dass die Größe der aufgezeichneten Binärdaten sehr gering ist.</span><span class="sxs-lookup"><span data-stu-id="f2527-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="f2527-312">Das Arbeiten mit sehr großen Binärdaten Dateien mit mehreren Megabyte oder mehr führt zu neuen Herausforderungen, die den Rahmen dieser Tutorials sprengen.</span><span class="sxs-lookup"><span data-stu-id="f2527-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="f2527-313">Beispielsweise lehnt ASP.NET standardmäßig Uploads von mehr als 4 MB ab, obwohl dies über das [`<httpRuntime>`-Element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`konfiguriert werden kann.</span><span class="sxs-lookup"><span data-stu-id="f2527-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="f2527-314">IIS erzwingt auch eigene Größenbeschränkungen für Datei Uploads.</span><span class="sxs-lookup"><span data-stu-id="f2527-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="f2527-315">Weitere Informationen finden Sie unter [IIS-Uploaddatei](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) .</span><span class="sxs-lookup"><span data-stu-id="f2527-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="f2527-316">Außerdem kann die Zeit, die zum Hochladen großer Dateien benötigt wird, den Standardwert von 110 Sekunden überschreiten ASP.net wartet auf eine Anforderung.</span><span class="sxs-lookup"><span data-stu-id="f2527-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="f2527-317">Es gibt auch Arbeitsspeicher-und Leistungsprobleme, die bei der Arbeit mit großen Dateien auftreten.</span><span class="sxs-lookup"><span data-stu-id="f2527-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="f2527-318">Das FileUpload-Steuerelement ist für große Datei Uploads nicht praktikabel.</span><span class="sxs-lookup"><span data-stu-id="f2527-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="f2527-319">Wenn der Inhalt der Datei an den Server gesendet wird, muss der Endbenutzer geduldig warten, bis er bestätigt, dass sein Upload fortschreitet.</span><span class="sxs-lookup"><span data-stu-id="f2527-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="f2527-320">Dies stellt bei kleineren Dateien, die innerhalb weniger Sekunden hochgeladen werden können, kein Problem dar. es kann jedoch ein Problem sein, wenn größere Dateien verarbeitet werden müssen, die möglicherweise einige Minuten in Anspruch nehmen.</span><span class="sxs-lookup"><span data-stu-id="f2527-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="f2527-321">Es gibt eine Vielzahl von Steuerelementen für das Hochladen von Dateien von Drittanbietern, die für die Verarbeitung großer Uploads besser geeignet sind. viele dieser Anbieter bieten Status Indikatoren und ActiveX-Uploadmanager, die eine viel höhere Benutzer Darstellung bieten.</span><span class="sxs-lookup"><span data-stu-id="f2527-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="f2527-322">Wenn Ihre Anwendung große Dateien verarbeiten muss, müssen Sie die Herausforderungen sorgfältig untersuchen und geeignete Lösungen für Ihre speziellen Anforderungen finden.</span><span class="sxs-lookup"><span data-stu-id="f2527-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="f2527-323">Summary</span><span class="sxs-lookup"><span data-stu-id="f2527-323">Summary</span></span>

<span data-ttu-id="f2527-324">Das Erstellen einer Anwendung, die Binärdaten erfassen muss, führt zu einer Reihe von Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="f2527-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="f2527-325">In diesem Tutorial haben wir die ersten beiden untersucht: entscheiden, wo die Binärdaten gespeichert werden sollen, und ermöglichen einem Benutzer, Binär Inhalte über eine Webseite hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="f2527-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="f2527-326">In den nächsten drei Tutorials erfahren Sie, wie die hochgeladenen Daten einem Datensatz in der Datenbank zugeordnet werden, und wie die Binärdaten zusammen mit den Text Datenfeldern angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="f2527-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="f2527-327">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="f2527-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="f2527-328">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="f2527-328">Further Reading</span></span>

<span data-ttu-id="f2527-329">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="f2527-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f2527-330">Verwenden von Datentypen mit umfangreichen Werten</span><span class="sxs-lookup"><span data-stu-id="f2527-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="f2527-331">Schnellstarts für FileUpload-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="f2527-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="f2527-332">Das ASP.NET 2,0 FileUpload-Server Steuerelement</span><span class="sxs-lookup"><span data-stu-id="f2527-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="f2527-333">Die dunkle Seite der Datei Uploads.</span><span class="sxs-lookup"><span data-stu-id="f2527-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="f2527-334">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="f2527-334">About the Author</span></span>

<span data-ttu-id="f2527-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor der sieben ASP/ASP. net-Bücher und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="f2527-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f2527-336">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="f2527-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f2527-337">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 2,0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f2527-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f2527-338">Er kann übermitchell@4GuysFromRolla.comerreicht werden [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f2527-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f2527-339">oder über seinen Blog finden Sie unter [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f2527-339">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f2527-340">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="f2527-340">Special Thanks To</span></span>

<span data-ttu-id="f2527-341">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="f2527-341">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f2527-342">Die führenden Reviewer für dieses Tutorial waren Teresa Murphy und Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="f2527-342">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="f2527-343">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="f2527-343">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f2527-344">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.comablegen.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f2527-344">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f2527-345">[Zurück](updating-and-deleting-existing-binary-data-cs.md)
> [Weiter](displaying-binary-data-in-the-data-web-controls-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f2527-345">[Previous](updating-and-deleting-existing-binary-data-cs.md)
[Next](displaying-binary-data-in-the-data-web-controls-vb.md)</span></span>
