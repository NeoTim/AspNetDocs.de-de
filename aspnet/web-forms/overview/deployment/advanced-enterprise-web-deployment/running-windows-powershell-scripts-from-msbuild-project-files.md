---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/running-windows-powershell-scripts-from-msbuild-project-files
title: Ausführen von Windows PowerShell-Skripts aus MSBuild-Projektdateien | Microsoft-Dokumentation
author: jrjlee
description: In diesem Thema wird beschrieben, wie ein Windows PowerShell-Skript als Teil eines Build-und Bereitstellungs Prozesses ausgeführt wird. Sie können ein Skript lokal ausführen (d. h. auf der b...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 55f1ae45-fcb5-43a9-8415-fa5b935fc9c9
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/running-windows-powershell-scripts-from-msbuild-project-files
msc.type: authoredcontent
ms.openlocfilehash: 7b09c07b8b7c2a61ca534f7a66a929593f3d04ca
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78441447"
---
# <a name="running-windows-powershell-scripts-from-msbuild-project-files"></a><span data-ttu-id="69c0a-104">Ausführen von Windows PowerShell-Skripts aus MSBuild-Projektdateien</span><span class="sxs-lookup"><span data-stu-id="69c0a-104">Running Windows PowerShell Scripts from MSBuild Project Files</span></span>

<span data-ttu-id="69c0a-105">von [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="69c0a-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="69c0a-106">PDF herunterladen</span><span class="sxs-lookup"><span data-stu-id="69c0a-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="69c0a-107">In diesem Thema wird beschrieben, wie ein Windows PowerShell-Skript als Teil eines Build-und Bereitstellungs Prozesses ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="69c0a-107">This topic describes how to run a Windows PowerShell script as part of a build and deployment process.</span></span> <span data-ttu-id="69c0a-108">Sie können ein Skript lokal ausführen (d. h. auf dem Buildserver) oder Remote, z. b. auf einem Zielweb Server oder Datenbankserver.</span><span class="sxs-lookup"><span data-stu-id="69c0a-108">You can run a script locally (in other words, on the build server) or remotely, like on a destination web server or database server.</span></span>
> 
> <span data-ttu-id="69c0a-109">Es gibt viele Gründe, warum Sie möglicherweise ein Windows PowerShell-Skript nach der Bereitstellung ausführen möchten.</span><span class="sxs-lookup"><span data-stu-id="69c0a-109">There are lots of reasons why you might want to run a post-deployment Windows PowerShell script.</span></span> <span data-ttu-id="69c0a-110">Auf diese Weise können Sie beispielsweise folgende Vorgänge durchführen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-110">For example, you might want to:</span></span>
> 
> - <span data-ttu-id="69c0a-111">Fügen Sie der Registrierung eine benutzerdefinierte Ereignis Quelle hinzu.</span><span class="sxs-lookup"><span data-stu-id="69c0a-111">Add a custom event source to the registry.</span></span>
> - <span data-ttu-id="69c0a-112">Generieren Sie ein Dateisystem Verzeichnis für Uploads.</span><span class="sxs-lookup"><span data-stu-id="69c0a-112">Generate a file system directory for uploads.</span></span>
> - <span data-ttu-id="69c0a-113">Buildverzeichnisse bereinigen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-113">Clean up build directories.</span></span>
> - <span data-ttu-id="69c0a-114">Schreiben Sie Einträge in eine benutzerdefinierte Protokolldatei.</span><span class="sxs-lookup"><span data-stu-id="69c0a-114">Write entries to a custom log file.</span></span>
> - <span data-ttu-id="69c0a-115">Senden von e-Mails, die Benutzer zu einer neu bereitgestellten Webanwendung einladen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-115">Send emails inviting users to a newly provisioned web application.</span></span>
> - <span data-ttu-id="69c0a-116">Erstellen Sie Benutzerkonten mit den entsprechenden Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-116">Create user accounts with the appropriate permissions.</span></span>
> - <span data-ttu-id="69c0a-117">Konfigurieren Sie die Replikation zwischen SQL Server Instanzen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-117">Configure replication between SQL Server instances.</span></span>
> 
> <span data-ttu-id="69c0a-118">In diesem Thema erfahren Sie, wie Sie Windows PowerShell-Skripts sowohl lokal als auch Remote über ein benutzerdefiniertes Ziel in einer Microsoft-Build-Engine-Projektdatei (MSBuild) ausführen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-118">This topic will show you how to run Windows PowerShell scripts both locally and remotely from a custom target in a Microsoft Build Engine (MSBuild) project file.</span></span>

<span data-ttu-id="69c0a-119">Dieses Thema ist Teil einer Reihe von Tutorials, basierend auf den Anforderungen an die Unternehmens Bereitstellung eines fiktiven Unternehmens namens Fabrikam, Inc. In dieser tutorialreihe wird&#x2014;eine Beispiellösung der [Contact Manager-Lösung](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;verwendet, um eine Webanwendung mit einem realistischen Komplexitäts Grad darzustellen, einschließlich einer ASP.NET MVC 3-Anwendung, eines Windows Communication Foundation (WCF)-Diensts und eines Datenbankprojekts.</span><span class="sxs-lookup"><span data-stu-id="69c0a-119">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="69c0a-120">Die Bereitstellungs Methode im Kern dieser Tutorials basiert auf dem Untergrund Legendes [zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md)beschriebenen Ansatz, in dem der Buildprozess von zwei Projektdateien&#x2014;gesteuert wird, die Buildanweisungen enthalten, die für jede Zielumgebung gelten, und eine mit Umgebungs spezifischen Build-und Bereitstellungs Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-120">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="69c0a-121">Zum Zeitpunkt der Erstellung wird die Umgebungs spezifische Projektdatei in der Umgebungs unabhängigen Projektdatei zusammengeführt, um einen kompletten Satz von Buildanweisungen zu bilden.</span><span class="sxs-lookup"><span data-stu-id="69c0a-121">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="69c0a-122">Aufgaben Übersicht</span><span class="sxs-lookup"><span data-stu-id="69c0a-122">Task Overview</span></span>

<span data-ttu-id="69c0a-123">Wenn Sie ein Windows PowerShell-Skript als Teil eines automatisierten oder Einzel stufigen Bereitstellungs Prozesses ausführen möchten, müssen Sie diese Aufgaben auf hoher Ebene ausführen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-123">To run a Windows PowerShell script as part of an automated or single-step deployment process, you'll need to complete these high-level tasks:</span></span>

- <span data-ttu-id="69c0a-124">Fügen Sie das Windows PowerShell-Skript zur-Projekt Mappe und zur Quell Code Verwaltung hinzu.</span><span class="sxs-lookup"><span data-stu-id="69c0a-124">Add the Windows PowerShell script to your solution and to source control.</span></span>
- <span data-ttu-id="69c0a-125">Erstellen Sie einen Befehl, mit dem das Windows PowerShell-Skript aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="69c0a-125">Create a command that invokes your Windows PowerShell script.</span></span>
- <span data-ttu-id="69c0a-126">Entziehen Sie alle reservierten XML-Zeichen in Ihrem Befehl.</span><span class="sxs-lookup"><span data-stu-id="69c0a-126">Escape any reserved XML characters in your command.</span></span>
- <span data-ttu-id="69c0a-127">Erstellen Sie ein Ziel in Ihrer benutzerdefinierten MSBuild-Projektdatei, und verwenden Sie die **exec** -Aufgabe zum Ausführen des Befehls.</span><span class="sxs-lookup"><span data-stu-id="69c0a-127">Create a target in your custom MSBuild project file and use the **Exec** task to run your command.</span></span>

<span data-ttu-id="69c0a-128">In diesem Thema wird gezeigt, wie Sie diese Prozeduren ausführen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-128">This topic will show you how to perform these procedures.</span></span> <span data-ttu-id="69c0a-129">In den Aufgaben und exemplarischen Vorgehensweisen in diesem Thema wird davon ausgegangen, dass Sie bereits mit MSBuild-Zielen und-Eigenschaften vertraut sind und wissen, wie Sie eine benutzerdefinierte MSBuild-Projektdatei verwenden, um einen Build-und Bereitstellungs Prozess zu fördern.</span><span class="sxs-lookup"><span data-stu-id="69c0a-129">The tasks and walkthroughs in this topic assume that you're already familiar with MSBuild targets and properties, and that you understand how to use a custom MSBuild project file to drive a build and deployment process.</span></span> <span data-ttu-id="69c0a-130">Weitere Informationen finden Sie Untergrund Legendes [zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md) und Grundlegendes [zum Buildprozess](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="69c0a-130">For more information, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

## <a name="creating-and-adding-windows-powershell-scripts"></a><span data-ttu-id="69c0a-131">Erstellen und Hinzufügen von Windows PowerShell-Skripts</span><span class="sxs-lookup"><span data-stu-id="69c0a-131">Creating and Adding Windows PowerShell Scripts</span></span>

<span data-ttu-id="69c0a-132">In den Tasks in diesem Thema wird ein Windows PowerShell-Beispielskript namens " **logbereitstellungs. ps1** " verwendet, um zu veranschaulichen, wie Skripts aus MSBuild ausgeführt werden</span><span class="sxs-lookup"><span data-stu-id="69c0a-132">The tasks in this topic use a sample Windows PowerShell script named **LogDeploy.ps1** to illustrate how to run scripts from MSBuild.</span></span> <span data-ttu-id="69c0a-133">Das Skript **logbereitstellungs. ps1** enthält eine einfache Funktion, die einen einzeiligen Eintrag in eine Protokolldatei schreibt:</span><span class="sxs-lookup"><span data-stu-id="69c0a-133">The **LogDeploy.ps1** script contains a simple function that writes a single-line entry to a log file:</span></span>

[!code-powershell[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample1.ps1)]

<span data-ttu-id="69c0a-134">Das Skript " **logbereitstellungs. ps1** " akzeptiert zwei Parameter.</span><span class="sxs-lookup"><span data-stu-id="69c0a-134">The **LogDeploy.ps1** script accepts two parameters.</span></span> <span data-ttu-id="69c0a-135">Der erste Parameter stellt den vollständigen Pfad zu der Protokolldatei dar, der Sie einen Eintrag hinzufügen möchten, und der zweite Parameter stellt das Bereitstellungs Ziel dar, das Sie in der Protokolldatei aufzeichnen möchten.</span><span class="sxs-lookup"><span data-stu-id="69c0a-135">The first parameter represents the full path to the log file to which you want to add an entry, and the second parameter represents the deployment destination that you want to record in the log file.</span></span> <span data-ttu-id="69c0a-136">Wenn Sie das Skript ausführen, wird der Protokolldatei eine Zeile im folgenden Format hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="69c0a-136">When you run the script, it adds a line to the log file in this format:</span></span>

[!code-html[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample2.html)]

<span data-ttu-id="69c0a-137">Um das Skript **logbereitstellungs. ps1** für MSBuild verfügbar zu machen, müssen Sie folgende Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-137">To make the **LogDeploy.ps1** script available to MSBuild, you need to:</span></span>

- <span data-ttu-id="69c0a-138">Fügen Sie das Skript der Quell Code Verwaltung hinzu.</span><span class="sxs-lookup"><span data-stu-id="69c0a-138">Add the script to source control.</span></span>
- <span data-ttu-id="69c0a-139">Fügen Sie das Skript der Projekt Mappe in Visual Studio 2010 hinzu.</span><span class="sxs-lookup"><span data-stu-id="69c0a-139">Add the script to your solution in Visual Studio 2010.</span></span>

<span data-ttu-id="69c0a-140">Sie müssen das Skript nicht mit ihrem Lösungs Inhalt bereitstellen, unabhängig davon, ob Sie das Skript auf dem Buildserver oder einem Remote Computer ausführen möchten.</span><span class="sxs-lookup"><span data-stu-id="69c0a-140">You don't need to deploy the script with your solution content, regardless of whether you plan to run the script on the build server or on a remote computer.</span></span> <span data-ttu-id="69c0a-141">Eine Möglichkeit besteht darin, das Skript einem Projektmappenordner hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-141">One option is to add the script to a solution folder.</span></span> <span data-ttu-id="69c0a-142">Wenn Sie das Windows PowerShell-Skript im Rahmen des Bereitstellungs Prozesses verwenden möchten, ist es sinnvoll, das Skript dem Projektmappenordner veröffentlichen hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-142">In the Contact Manager example, because you want to use the Windows PowerShell script as part of the deployment process, it makes sense to add the script to the Publish solution folder.</span></span>

![](running-windows-powershell-scripts-from-msbuild-project-files/_static/image1.png)

<span data-ttu-id="69c0a-143">Der Inhalt von Projektmappenordnern wird als Quellmaterial auf Buildserver kopiert.</span><span class="sxs-lookup"><span data-stu-id="69c0a-143">The contents of solution folders are copied to build servers as source material.</span></span> <span data-ttu-id="69c0a-144">Allerdings bilden Sie keinen Teil einer Projekt Ausgabe.</span><span class="sxs-lookup"><span data-stu-id="69c0a-144">However, they form no part of any project output.</span></span>

## <a name="executing-a-windows-powershell-script-on-the-build-server"></a><span data-ttu-id="69c0a-145">Ausführen eines Windows PowerShell-Skripts auf dem Buildserver</span><span class="sxs-lookup"><span data-stu-id="69c0a-145">Executing a Windows PowerShell Script on the Build Server</span></span>

<span data-ttu-id="69c0a-146">In einigen Szenarien möchten Sie möglicherweise Windows PowerShell-Skripts auf dem Computer ausführen, auf dem Ihre Projekte erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="69c0a-146">In some scenarios, you may want to run Windows PowerShell scripts on the computer that builds your projects.</span></span> <span data-ttu-id="69c0a-147">Beispielsweise können Sie ein Windows PowerShell-Skript verwenden, um Buildordner zu bereinigen oder Einträge in eine benutzerdefinierte Protokolldatei zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="69c0a-147">For example, you might use a Windows PowerShell script to clean up build folders or write entries to a custom log file.</span></span>

<span data-ttu-id="69c0a-148">Im Hinblick auf die Syntax entspricht das Ausführen eines Windows PowerShell-Skripts aus einer MSBuild-Projektdatei dem Ausführen eines Windows PowerShell-Skripts über eine reguläre Eingabeaufforderung.</span><span class="sxs-lookup"><span data-stu-id="69c0a-148">In terms of syntax, running a Windows PowerShell script from an MSBuild project file is the same as running a Windows PowerShell script from a regular command prompt.</span></span> <span data-ttu-id="69c0a-149">Sie müssen die ausführbare Datei "PowerShell. exe" aufrufen und den **Befehl "– Command** " verwenden, um die Befehle bereitzustellen, die von Windows PowerShell ausgeführt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-149">You need to invoke the powershell.exe executable and use the **–command** switch to provide the commands you want Windows PowerShell to run.</span></span> <span data-ttu-id="69c0a-150">(In Windows PowerShell v2 können Sie auch den Schalter **– File** ) verwenden.</span><span class="sxs-lookup"><span data-stu-id="69c0a-150">(In Windows PowerShell v2, you can also use the **–file** switch).</span></span> <span data-ttu-id="69c0a-151">Der Befehl sollte das folgende Format aufweisen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-151">The command should take this format:</span></span>

[!code-console[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample3.cmd)]

<span data-ttu-id="69c0a-152">Beispiel:</span><span class="sxs-lookup"><span data-stu-id="69c0a-152">For example:</span></span>

[!code-console[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample4.cmd)]

<span data-ttu-id="69c0a-153">Wenn der Pfad zu Ihrem Skript Leerzeichen enthält, müssen Sie den Dateipfad in einfache Anführungszeichen einschließen, denen ein kaufmännisches und-Zeichen vorangestellt ist.</span><span class="sxs-lookup"><span data-stu-id="69c0a-153">If the path to your script includes spaces, you need to enclose the file path in single quotes preceded by an ampersand.</span></span> <span data-ttu-id="69c0a-154">Doppelte Anführungszeichen können nicht verwendet werden, da Sie Sie bereits zum Einschließen des Befehls verwendet haben:</span><span class="sxs-lookup"><span data-stu-id="69c0a-154">You can't use double quotes, because you've already used them to enclose the command:</span></span>

[!code-console[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample5.cmd)]

<span data-ttu-id="69c0a-155">Wenn Sie diesen Befehl in MSBuild aufrufen, müssen Sie einige weitere Überlegungen beachten.</span><span class="sxs-lookup"><span data-stu-id="69c0a-155">There are a few additional considerations when you invoke this command from MSBuild.</span></span> <span data-ttu-id="69c0a-156">Zuerst sollten Sie das **– noninteractive** -Flag einschließen, um sicherzustellen, dass das Skript unbeaufsichtigt ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="69c0a-156">First, you should include the **–NonInteractive** flag to ensure that the script executes quietly.</span></span> <span data-ttu-id="69c0a-157">Als nächstes sollten Sie das Flag **– ExecutionPolicy** mit einem entsprechenden Argument Wert einschließen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-157">Next, you should include the **–ExecutionPolicy** flag with an appropriate argument value.</span></span> <span data-ttu-id="69c0a-158">Dadurch wird die Ausführungs Richtlinie angegeben, die von Windows PowerShell auf das Skript angewendet wird, und Sie können die Standard Ausführungs Richtlinie außer Kraft setzen, was die Ausführung des Skripts verhindern kann.</span><span class="sxs-lookup"><span data-stu-id="69c0a-158">This specifies the execution policy that Windows PowerShell will apply to your script and allows you to override the default execution policy, which may prevent execution of your script.</span></span> <span data-ttu-id="69c0a-159">Sie können aus den folgenden Argument Werten wählen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-159">You can choose from these argument values:</span></span>

- <span data-ttu-id="69c0a-160">Der Wert **uneingeschränkt** ermöglicht Windows PowerShell das Ausführen des Skripts, unabhängig davon, ob das Skript signiert ist.</span><span class="sxs-lookup"><span data-stu-id="69c0a-160">A value of **Unrestricted** will allow Windows PowerShell to execute your script, regardless of whether the script is signed.</span></span>
- <span data-ttu-id="69c0a-161">Der Wert **RemoteSigned** ermöglicht Windows PowerShell, nicht signierte Skripts auszuführen, die auf dem lokalen Computer erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="69c0a-161">A value of **RemoteSigned** will allow Windows PowerShell to execute unsigned scripts that were created on the local machine.</span></span> <span data-ttu-id="69c0a-162">Allerdings müssen Skripts, die an anderer Stelle erstellt wurden, signiert werden.</span><span class="sxs-lookup"><span data-stu-id="69c0a-162">However, scripts that were created elsewhere must be signed.</span></span> <span data-ttu-id="69c0a-163">(In der Praxis ist es sehr unwahrscheinlich, dass Sie ein Windows PowerShell-Skript lokal auf einem Buildserver erstellt haben).</span><span class="sxs-lookup"><span data-stu-id="69c0a-163">(In practice, you're very unlikely to have created a Windows PowerShell script locally on a build server).</span></span>
- <span data-ttu-id="69c0a-164">Der Wert **AllSigned** ermöglicht es Windows PowerShell, nur signierte Skripts auszuführen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-164">A value of **AllSigned** will allow Windows PowerShell to execute signed scripts only.</span></span>

<span data-ttu-id="69c0a-165">Die Standard Ausführungs Richtlinie ist **eingeschränkt**, wodurch verhindert wird, dass Windows PowerShell Skriptdateien ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="69c0a-165">The default execution policy is **Restricted**, which prevents Windows PowerShell from running any script files.</span></span>

<span data-ttu-id="69c0a-166">Schließlich müssen Sie alle reservierten XML-Zeichen, die in Ihrem Windows PowerShell-Befehl auftreten, mit Escapezeichen versehen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-166">Finally, you need to escape any reserved XML characters that occur in your Windows PowerShell command:</span></span>

- <span data-ttu-id="69c0a-167">Einfache Anführungszeichen durch **&amp;apos** ersetzen</span><span class="sxs-lookup"><span data-stu-id="69c0a-167">Replace single quotes with **&amp;apos;**</span></span>
- <span data-ttu-id="69c0a-168">Doppelte Anführungszeichen durch **&amp;quot;** ersetzen</span><span class="sxs-lookup"><span data-stu-id="69c0a-168">Replace double quotes with **&amp;quot;**</span></span>
- <span data-ttu-id="69c0a-169">Ersetzen Sie kaufmännische und durch **&amp;amp;**</span><span class="sxs-lookup"><span data-stu-id="69c0a-169">Replace ampersands with **&amp;amp;**</span></span>

- <span data-ttu-id="69c0a-170">Wenn Sie diese Änderungen vornehmen, ähnelt der Befehl folgendem:</span><span class="sxs-lookup"><span data-stu-id="69c0a-170">When you make these changes, your command will resemble this:</span></span>

[!code-console[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample6.cmd)]

<span data-ttu-id="69c0a-171">In Ihrer benutzerdefinierten MSBuild-Projektdatei können Sie ein neues Ziel erstellen und mithilfe der **exec** -Aufgabe den folgenden Befehl ausführen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-171">Within your custom MSBuild project file, you can create a new target and use the **Exec** task to run this command:</span></span>

[!code-xml[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample7.xml)]

<span data-ttu-id="69c0a-172">Beachten Sie in diesem Beispiel Folgendes:</span><span class="sxs-lookup"><span data-stu-id="69c0a-172">In this example, note that:</span></span>

- <span data-ttu-id="69c0a-173">Alle Variablen, wie Parameterwerte und der Speicherort der ausführbaren Windows PowerShell-Datei, werden als MSBuild-Eigenschaften deklariert.</span><span class="sxs-lookup"><span data-stu-id="69c0a-173">Any variables, like parameter values and the location of the Windows PowerShell executable, are declared as MSBuild properties.</span></span>
- <span data-ttu-id="69c0a-174">Bedingungen sind eingeschlossen, damit Benutzer diese Werte über die Befehlszeile überschreiben können.</span><span class="sxs-lookup"><span data-stu-id="69c0a-174">Conditions are included to enable users to override these values from the command line.</span></span>
- <span data-ttu-id="69c0a-175">Die **msdeploycomputername** -Eigenschaft wird an anderer Stelle in der Projektdatei deklariert.</span><span class="sxs-lookup"><span data-stu-id="69c0a-175">The **MSDeployComputerName** property is declared elsewhere in the project file.</span></span>

<span data-ttu-id="69c0a-176">Wenn Sie dieses Ziel als Teil des Buildprozesses ausführen, führt Windows PowerShell den Befehl aus und schreibt einen Protokolleintrag in die von Ihnen angegebene Datei.</span><span class="sxs-lookup"><span data-stu-id="69c0a-176">When you execute this target as part of your build process, Windows PowerShell will run your command and write a log entry to the file you specified.</span></span>

## <a name="executing-a-windows-powershell-script-on-a-remote-computer"></a><span data-ttu-id="69c0a-177">Ausführen eines Windows PowerShell-Skripts auf einem Remote Computer</span><span class="sxs-lookup"><span data-stu-id="69c0a-177">Executing a Windows PowerShell Script on a Remote Computer</span></span>

<span data-ttu-id="69c0a-178">Windows PowerShell ist in der Lage, Skripts auf Remote Computern über [Windows-Remoteverwaltung](https://msdn.microsoft.com/library/windows/desktop/aa384426.aspx) (WinRM) auszuführen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-178">Windows PowerShell is capable of running scripts on remote computers through [Windows Remote Management](https://msdn.microsoft.com/library/windows/desktop/aa384426.aspx) (WinRM).</span></span> <span data-ttu-id="69c0a-179">Zu diesem Zweck müssen Sie das Cmdlet "Start [-Command](https://technet.microsoft.com/library/dd347578.aspx) " verwenden.</span><span class="sxs-lookup"><span data-stu-id="69c0a-179">To do this, you need to use the [Invoke-Command](https://technet.microsoft.com/library/dd347578.aspx) cmdlet.</span></span> <span data-ttu-id="69c0a-180">Auf diese Weise können Sie das Skript auf einem oder mehreren Remote Computern ausführen, ohne das Skript auf die Remote Computer zu kopieren.</span><span class="sxs-lookup"><span data-stu-id="69c0a-180">This lets you execute your script against one or more remote computers without copying the script to the remote computers.</span></span> <span data-ttu-id="69c0a-181">Alle Ergebnisse werden an den lokalen Computer zurückgegeben, von dem aus Sie das Skript ausgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="69c0a-181">Any results are returned to the local computer from which you ran the script.</span></span>

> [!NOTE]
> <span data-ttu-id="69c0a-182">Bevor Sie das Cmdlet " **Aufruf-Command** " zum Ausführen von Windows PowerShell-Skripts auf einem Remote Computer verwenden, müssen Sie einen WinRM-Listener für die Annahme von Remote Nachrichten konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="69c0a-182">Before you use the **Invoke-Command** cmdlet to execute Windows PowerShell scripts on a remote computer, you need to configure a WinRM listener to accept remote messages.</span></span> <span data-ttu-id="69c0a-183">Führen Sie hierzu den Befehl **WinRM Quick Config** auf dem Remote Computer aus.</span><span class="sxs-lookup"><span data-stu-id="69c0a-183">You can do this by running the command **winrm quickconfig** on the remote computer.</span></span> <span data-ttu-id="69c0a-184">Weitere Informationen finden Sie unter [Installation und Konfiguration für Windows-Remoteverwaltung](https://msdn.microsoft.com/library/windows/desktop/aa384372(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="69c0a-184">For more information, see [Installation and Configuration for Windows Remote Management](https://msdn.microsoft.com/library/windows/desktop/aa384372(v=vs.85).aspx).</span></span>

<span data-ttu-id="69c0a-185">In einem Windows PowerShell-Fenster verwenden Sie diese Syntax zum Ausführen des Skripts **logbereitstellung. ps1** auf einem Remote Computer:</span><span class="sxs-lookup"><span data-stu-id="69c0a-185">From a Windows PowerShell window, you'd use this syntax to run the **LogDeploy.ps1** script on a remote computer:</span></span>

[!code-powershell[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample8.ps1)]

> [!NOTE]
> <span data-ttu-id="69c0a-186">Es gibt verschiedene andere Möglichkeiten der Verwendung von " **aufrufen-Command** " zum Ausführen einer Skriptdatei. dieser Ansatz ist jedoch die einfachste Methode, wenn Sie Parameterwerte bereitstellen und Pfade mit Leerzeichen verwalten müssen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-186">There are various other ways of using **Invoke-Command** to run a script file, but this approach is the most straightforward when you need to provide parameter values and manage paths with spaces.</span></span>

<span data-ttu-id="69c0a-187">Wenn Sie diesen Befehl über eine Eingabeaufforderung ausführen, müssen Sie die ausführbare Windows PowerShell-Datei aufrufen und den **–-Befehls** Parameter verwenden, um Ihre Anweisungen anzugeben:</span><span class="sxs-lookup"><span data-stu-id="69c0a-187">When you run this from a command prompt, you need to invoke the Windows PowerShell executable and use the **–command** parameter to provide your instructions:</span></span>

[!code-console[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample9.cmd)]

<span data-ttu-id="69c0a-188">Wie zuvor müssen Sie einige zusätzliche Switches angeben und alle reservierten XML-Zeichen mit Escapezeichen versehen, wenn Sie den Befehl in MSBuild ausführen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-188">As before, you need to provide some additional switches and escape any reserved XML characters when you run the command from MSBuild:</span></span>

[!code-console[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample10.cmd)]

<span data-ttu-id="69c0a-189">Zum Schluss können Sie wie zuvor die **exec** -Aufgabe in einem benutzerdefinierten MSBuild-Ziel verwenden, um den Befehl auszuführen:</span><span class="sxs-lookup"><span data-stu-id="69c0a-189">Finally, as before, you can use the **Exec** task within a custom MSBuild target to execute your command:</span></span>

[!code-xml[Main](running-windows-powershell-scripts-from-msbuild-project-files/samples/sample11.xml)]

<span data-ttu-id="69c0a-190">Wenn Sie dieses Ziel als Teil des Buildprozesses ausführen, führt Windows PowerShell das Skript auf dem Computer aus, den Sie im **– Computername** -Argument angegeben haben.</span><span class="sxs-lookup"><span data-stu-id="69c0a-190">When you execute this target as part of your build process, Windows PowerShell will run your script on the computer you specified in the **–computername** argument.</span></span>

## <a name="conclusion"></a><span data-ttu-id="69c0a-191">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="69c0a-191">Conclusion</span></span>

<span data-ttu-id="69c0a-192">In diesem Thema wird beschrieben, wie ein Windows PowerShell-Skript aus einer MSBuild-Projektdatei ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="69c0a-192">This topic described how to run a Windows PowerShell script from an MSBuild project file.</span></span> <span data-ttu-id="69c0a-193">Sie können diesen Ansatz verwenden, um ein Windows PowerShell-Skript entweder lokal oder auf einem Remote Computer im Rahmen eines automatisierten oder einstufigen Build-und Bereitstellungs Prozesses auszuführen.</span><span class="sxs-lookup"><span data-stu-id="69c0a-193">You can use this approach to run a Windows PowerShell script, either locally or on a remote computer, as part of an automated or single-step build and deployment process.</span></span>

## <a name="further-reading"></a><span data-ttu-id="69c0a-194">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="69c0a-194">Further Reading</span></span>

<span data-ttu-id="69c0a-195">Anleitungen zum Signieren von Windows PowerShell-Skripts und Verwalten von Ausführungsrichtlinien finden Sie unter [Ausführen von Windows PowerShell-Skripts](https://technet.microsoft.com/library/ee176949.aspx).</span><span class="sxs-lookup"><span data-stu-id="69c0a-195">For guidance on signing Windows PowerShell scripts and managing execution policies, see [Running Windows PowerShell Scripts](https://technet.microsoft.com/library/ee176949.aspx).</span></span> <span data-ttu-id="69c0a-196">Anleitungen zum Ausführen von Windows PowerShell-Befehlen von einem Remote Computer finden Sie unter [Ausführen von Remote Befehlen](https://technet.microsoft.com/library/dd819505.aspx).</span><span class="sxs-lookup"><span data-stu-id="69c0a-196">For guidance on running Windows PowerShell commands from a remote computer, see [Running Remote Commands](https://technet.microsoft.com/library/dd819505.aspx).</span></span>

<span data-ttu-id="69c0a-197">Weitere Informationen zur Verwendung von benutzerdefinierten MSBuild-Projektdateien zum Steuern des Bereitstellungs Prozesses finden Sie Untergrund Legendes [zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md) und Grundlegendes [zum Buildprozess](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="69c0a-197">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="69c0a-198">[Zurück](taking-web-applications-offline-with-web-deploy.md)
> [Weiter](troubleshooting-the-packaging-process.md)</span><span class="sxs-lookup"><span data-stu-id="69c0a-198">[Previous](taking-web-applications-offline-with-web-deploy.md)
[Next](troubleshooting-the-packaging-process.md)</span></span>
