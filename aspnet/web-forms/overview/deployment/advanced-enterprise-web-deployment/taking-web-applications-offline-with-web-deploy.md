---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy
title: Offline schalten von Webanwendungen mit Web deploy | Microsoft-Dokumentation
author: jrjlee
description: In diesem Thema wird beschrieben, wie eine Webanwendung für die Dauer einer automatisierten Bereitstellung mithilfe der Internetinformationsdienste (IIS)-Webbereitstellung offline geschaltet wird...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 3e9f6e7d-8967-4586-94d5-d3a122f12529
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy
msc.type: authoredcontent
ms.openlocfilehash: ba60664a0c3daa0650cd7e7cfc4ab9da08df3440
ms.sourcegitcommit: e365196c75ce93cd8967412b1cfdc27121816110
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 02/07/2020
ms.locfileid: "77075137"
---
# <a name="taking-web-applications-offline-with-web-deploy"></a><span data-ttu-id="abe5b-103">Offlineschalten von Webanwendungen mit Web Deploy</span><span class="sxs-lookup"><span data-stu-id="abe5b-103">Taking Web Applications Offline with Web Deploy</span></span>

<span data-ttu-id="abe5b-104">von [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="abe5b-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="abe5b-105">PDF herunterladen</span><span class="sxs-lookup"><span data-stu-id="abe5b-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="abe5b-106">In diesem Thema wird beschrieben, wie eine Webanwendung für die Dauer der automatisierten Bereitstellung mit dem Webbereitstellungs Web deploy Tool Internetinformationsdienste (IIS) offline geschaltet wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-106">This topic describes how to take a web application offline for the duration of an automated deployment using the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span> <span data-ttu-id="abe5b-107">Benutzer, die zur Webanwendung navigieren, werden bis zum Abschluss der Bereitstellung zu einer *App\_Datei "offline. htm* " umgeleitet.</span><span class="sxs-lookup"><span data-stu-id="abe5b-107">Users who browse to the web application are redirected to an *App\_offline.htm* file until the deployment is complete.</span></span>

<span data-ttu-id="abe5b-108">Dieses Thema ist Teil einer Reihe von Tutorials, basierend auf den Anforderungen an die Unternehmens Bereitstellung eines fiktiven Unternehmens namens Fabrikam, Inc. In dieser tutorialreihe wird&#x2014;eine Beispiellösung der [Contact Manager-Lösung](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;verwendet, um eine Webanwendung mit einem realistischen Komplexitäts Grad darzustellen, einschließlich einer ASP.NET MVC 3-Anwendung, eines Windows Communication Foundation (WCF)-Diensts und eines Datenbankprojekts.</span><span class="sxs-lookup"><span data-stu-id="abe5b-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="abe5b-109">Die Bereitstellungs Methode im Kern dieser Tutorials basiert auf dem Untergrund Legendes [zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md)beschriebenen Ansatz, in dem der Buildprozess von zwei Projektdateien&#x2014;gesteuert wird, die Buildanweisungen enthalten, die für jede Zielumgebung gelten, und eine mit Umgebungs spezifischen Build-und Bereitstellungs Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="abe5b-110">Zum Zeitpunkt der Erstellung wird die Umgebungs spezifische Projektdatei in der Umgebungs unabhängigen Projektdatei zusammengeführt, um einen kompletten Satz von Buildanweisungen zu bilden.</span><span class="sxs-lookup"><span data-stu-id="abe5b-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="abe5b-111">Aufgaben Übersicht</span><span class="sxs-lookup"><span data-stu-id="abe5b-111">Task Overview</span></span>

<span data-ttu-id="abe5b-112">In vielen Szenarien empfiehlt es sich, eine Webanwendung offline zu schalten, während Sie Änderungen an verknüpften Komponenten vornehmen, wie z. b. Datenbanken oder Webdienste.</span><span class="sxs-lookup"><span data-stu-id="abe5b-112">In a lot of scenarios, you'll want to take a web application offline while you make changes to related components, like databases or web services.</span></span> <span data-ttu-id="abe5b-113">In IIS und ASP.net erreichen Sie dies in der Regel, indem Sie im Stamm Ordner der IIS-Website oder-Webanwendung eine Datei mit dem Namen *App\_offline. htm* platzieren.</span><span class="sxs-lookup"><span data-stu-id="abe5b-113">Typically, in IIS and ASP.NET, you accomplish this by placing a file named *App\_offline.htm* in the root folder of the IIS website or web application.</span></span> <span data-ttu-id="abe5b-114">Bei der *App\_offline. htm* -Datei handelt es sich um eine Standard-HTML-Datei, die in der Regel eine einfache Meldung enthält, die den Benutzer darüber informiert, dass die Site aufgrund der Wartung vorübergehend nicht</span><span class="sxs-lookup"><span data-stu-id="abe5b-114">The *App\_offline.htm* file is a standard HTML file and will usually contain a simple message advising the user that the site is temporarily unavailable due to maintenance.</span></span> <span data-ttu-id="abe5b-115">Während die *App\_offline. htm* -Datei im Stamm Ordner der Website vorhanden ist, leitet IIS automatisch sämtliche Anforderungen an die Datei weiter.</span><span class="sxs-lookup"><span data-stu-id="abe5b-115">While the *App\_offline.htm* file exists in the root folder of the website, IIS will automatically redirect any requests to the file.</span></span> <span data-ttu-id="abe5b-116">Wenn Sie mit der Aktualisierung der APP fertig sind, entfernen Sie die *App\_Datei "offline. htm* ", und die Website setzt Anforderungen wie gewohnt fort.</span><span class="sxs-lookup"><span data-stu-id="abe5b-116">When you've finished making updates, you remove the *App\_offline.htm* file and the website resumes serving requests as usual.</span></span>

<span data-ttu-id="abe5b-117">Wenn Sie Web deploy verwenden, um automatisierte oder einstufige bereit Stellungen in einer Zielumgebung durchzuführen, können Sie das Hinzufügen und Entfernen der *App\_offline. htm* -Datei in ihren Bereitstellungs Prozess integrieren.</span><span class="sxs-lookup"><span data-stu-id="abe5b-117">When you use Web Deploy to perform automated or single-step deployments to a target environment, you may want to incorporate adding and removing the *App\_offline.htm* file into your deployment process.</span></span> <span data-ttu-id="abe5b-118">Zu diesem Zweck müssen Sie die folgenden Aufgaben auf hoher Ebene ausführen:</span><span class="sxs-lookup"><span data-stu-id="abe5b-118">To do this, you'll need to complete these high-level tasks:</span></span>

- <span data-ttu-id="abe5b-119">Erstellen Sie in der Microsoft-Build-Engine (MSBuild)-Projektdatei, die Sie zum Steuern des Bereitstellungs Prozesses verwenden, ein MSBuild-Ziel, das eine *App\_offline. htm* -Datei auf den Zielserver kopiert, bevor alle Bereitstellungs Aufgaben beginnen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-119">In the Microsoft Build Engine (MSBuild) project file that you use to control the deployment process, create an MSBuild target that copies an *App\_offline.htm* file to the destination server before any deployment tasks begin.</span></span>
- <span data-ttu-id="abe5b-120">Fügen Sie ein weiteres MSBuild-Ziel hinzu, das die *App\_Datei "offline. htm* " vom Zielserver entfernt, wenn alle Bereitstellungs Aufgaben vollständig sind.</span><span class="sxs-lookup"><span data-stu-id="abe5b-120">Add another MSBuild target that removes the *App\_offline.htm* file from the destination server when all deployment tasks are complete.</span></span>
- <span data-ttu-id="abe5b-121">Erstellen Sie im Webanwendungs Projekt eine *WPP. targets* -Datei, mit der sichergestellt wird, dass dem Bereitstellungs Paket, wenn Web deploy aufgerufen wird, eine *App\_offline. htm* -Datei hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-121">In the web application project, create a *.wpp.targets* file that ensures that an *App\_offline.htm* file is added to the deployment package when Web Deploy is invoked.</span></span>

<span data-ttu-id="abe5b-122">In diesem Thema wird gezeigt, wie Sie diese Prozeduren ausführen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-122">This topic will show you how to perform these procedures.</span></span> <span data-ttu-id="abe5b-123">Bei den Aufgaben und exemplarischen Vorgehensweisen in diesem Thema wird davon ausgegangen, dass Sie bereits eine Projekt Mappe erstellt haben, die mindestens ein Webanwendungs Projekt enthält, und Sie können eine benutzerdefinierte Projektdatei verwenden, um den Bereitstellungs Prozess zu steuern, wie unter [Webbereitstellung im Unternehmen](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md)</span><span class="sxs-lookup"><span data-stu-id="abe5b-123">The tasks and walkthroughs in this topic assume that you've already created a solution that contains at least one web application project, and that you use a custom project file to control the deployment process as described in [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md).</span></span> <span data-ttu-id="abe5b-124">Alternativ können Sie die Beispiellösung [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) verwenden, um die Beispiele im Thema zu befolgen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-124">Alternatively, you can use the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution to follow the examples in the topic.</span></span>

## <a name="adding-an-app_offline-file-to-a-web-application-project"></a><span data-ttu-id="abe5b-125">Hinzufügen einer APP\_Offline Datei zu einem Webanwendungs Projekt</span><span class="sxs-lookup"><span data-stu-id="abe5b-125">Adding an App\_Offline File to a Web Application Project</span></span>

<span data-ttu-id="abe5b-126">Die erste Aufgabe, die Sie ausführen müssen, ist das Hinzufügen einer *App\_Offline* Datei zum Webanwendungs Projekt:</span><span class="sxs-lookup"><span data-stu-id="abe5b-126">The first task you need to complete is to add an *App\_offline* file to your web application project:</span></span>

- <span data-ttu-id="abe5b-127">Um zu verhindern, dass die Datei den Entwicklungsprozess beeinträchtigt (Sie möchten nicht, dass Ihre Anwendung dauerhaft offline geschaltet wird), sollten Sie Sie als *App-\_"offline. htm*" bezeichnen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-127">To prevent the file from interfering with the development process (you don't want your application to be permanently offline), you should call it something other than *App\_offline.htm*.</span></span> <span data-ttu-id="abe5b-128">Beispielsweise können Sie die Datei *App\_Offline-Template. htm*benennen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-128">For example, you could name the file *App\_offline-template.htm*.</span></span>
- <span data-ttu-id="abe5b-129">Um zu verhindern, dass die Datei unverändert bereitgestellt wird, sollten Sie die Buildaktion auf **keine**festlegen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-129">To prevent the file from being deployed as-is, you should set the build action to **None**.</span></span>

<span data-ttu-id="abe5b-130">**So fügen Sie einem Webanwendungs Projekt eine APP\_-Offline Datei hinzu**</span><span class="sxs-lookup"><span data-stu-id="abe5b-130">**To add an App\_offline file to a web application project**</span></span>

1. <span data-ttu-id="abe5b-131">Öffnen Sie die Projekt Mappe in Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="abe5b-131">Open your solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="abe5b-132">Klicken Sie im **Projektmappen-Explorer** Fenster mit der rechten Maustaste auf das Webanwendungs Projekt, zeigen Sie auf **Hinzufügen**, und klicken Sie dann auf **Neues Element**.</span><span class="sxs-lookup"><span data-stu-id="abe5b-132">In the **Solution Explorer** window, right-click your web application project, point to **Add**, and then click **New Item**.</span></span>
3. <span data-ttu-id="abe5b-133">Wählen Sie im Dialogfeld **Neues Element hinzufügen** die Option **HTML-Seite**aus.</span><span class="sxs-lookup"><span data-stu-id="abe5b-133">In the **Add New Item** dialog box, select **HTML Page**.</span></span>
4. <span data-ttu-id="abe5b-134">Geben Sie im Feld **Name den Namen** **App\_Offline-Template. htm**ein, und klicken Sie dann auf **Hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="abe5b-134">In the **Name** box, type **App\_offline-template.htm**, and then click **Add**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image1.png)
5. <span data-ttu-id="abe5b-135">Fügen Sie einigen einfachen HTML-Code hinzu, um Benutzer darüber zu informieren, dass die Anwendung nicht verfügbar ist, und speichern Sie die Datei</span><span class="sxs-lookup"><span data-stu-id="abe5b-135">Add some simple HTML to inform users that the application is unavailable, and then save the file.</span></span> <span data-ttu-id="abe5b-136">Nehmen Sie keine serverseitigen Tags auf (z. b. alle Tags mit dem Präfix "ASP:").</span><span class="sxs-lookup"><span data-stu-id="abe5b-136">Do not include any server-side tags (for example, any tags that are prefixed with "asp:").</span></span> 

    ![](taking-web-applications-offline-with-web-deploy/_static/image2.png)
6. <span data-ttu-id="abe5b-137">Klicken Sie im **Projektmappen-Explorer** Fenster mit der rechten Maustaste auf die neue Datei, und klicken Sie dann auf **Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="abe5b-137">In the **Solution Explorer** window, right-click the new file, and then click **Properties**.</span></span>
7. <span data-ttu-id="abe5b-138">Wählen Sie im Fenster **Eigenschaften** in der **Zeile** Buildvorgang die Option **keine**aus.</span><span class="sxs-lookup"><span data-stu-id="abe5b-138">In the **Properties** window, in the **Build Action** row, select **None**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image3.png)

## <a name="deploying-and-deleting-an-app_offline-file"></a><span data-ttu-id="abe5b-139">Bereitstellen und Löschen einer APP\_Offline Datei</span><span class="sxs-lookup"><span data-stu-id="abe5b-139">Deploying and Deleting an App\_Offline File</span></span>

<span data-ttu-id="abe5b-140">Der nächste Schritt besteht darin, die Bereitstellungs Logik so zu ändern, dass die Datei zu Beginn des Bereitstellungs Prozesses auf den Zielserver kopiert und am Ende entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-140">The next step is to modify your deployment logic to copy the file to the destination server at the start of the deployment process and remove it at the end.</span></span>

> [!NOTE]
> <span data-ttu-id="abe5b-141">Im nächsten Verfahren wird davon ausgegangen, dass Sie eine benutzerdefinierte MSBuild-Projektdatei verwenden, um den Bereitstellungs Prozess zu steuern, wie in Grundlegendes [zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="abe5b-141">The next procedure assumes that you're using a custom MSBuild project file to control your deployment process, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span> <span data-ttu-id="abe5b-142">Wenn Sie direkt aus Visual Studio bereitstellen, müssen Sie einen anderen Ansatz verwenden.</span><span class="sxs-lookup"><span data-stu-id="abe5b-142">If you're deploying direct from Visual Studio, you'll need to use a different approach.</span></span> <span data-ttu-id="abe5b-143">Sayed Ibrahim Hashimi beschreibt einen solchen Ansatz, in dem [Sie Ihre Web-App während der Veröffentlichung Offline](http://sedodream.com/2012/01/08/HowToTakeYourWebAppOfflineDuringPublishing.aspx)schalten können.</span><span class="sxs-lookup"><span data-stu-id="abe5b-143">Sayed Ibrahim Hashimi describes one such approach in [How to Take Your Web App Offline During Publishing](http://sedodream.com/2012/01/08/HowToTakeYourWebAppOfflineDuringPublishing.aspx).</span></span>

<span data-ttu-id="abe5b-144">Zum Bereitstellen einer *App\_Offline* Datei auf einer IIS-Zielwebsite müssen Sie "msbereitstellungs. exe" mithilfe des [Web deploy **contentPath** -Anbieters](https://technet.microsoft.com/library/dd569034(WS.10).aspx)aufrufen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-144">To deploy an *App\_offline* file to a destination IIS website, you need to invoke MSDeploy.exe using the [Web Deploy **contentPath** provider](https://technet.microsoft.com/library/dd569034(WS.10).aspx).</span></span> <span data-ttu-id="abe5b-145">Der **contentPath** -Anbieter unterstützt sowohl physische Verzeichnispfade als auch IIS-Website-oder-Anwendungs Pfade, sodass er die ideale Wahl für die Synchronisierung einer Datei zwischen einem Visual Studio-Projektordner und einer IIS-Webanwendung ist.</span><span class="sxs-lookup"><span data-stu-id="abe5b-145">The **contentPath** provider supports both physical directory paths and IIS website or application paths, which makes it the ideal choice for synchronizing a file between a Visual Studio project folder and an IIS web application.</span></span> <span data-ttu-id="abe5b-146">Zum Bereitstellen der Datei sollte der msbereitstellungs-Befehl wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="abe5b-146">To deploy the file, your MSDeploy command should resemble this:</span></span>

[!code-console[Main](taking-web-applications-offline-with-web-deploy/samples/sample1.cmd)]

<span data-ttu-id="abe5b-147">Wenn Sie die Datei am Ende des Bereitstellungs Prozesses vom Ziel Standort entfernen möchten, sollte der msdeployment-Befehl wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="abe5b-147">To remove the file from the destination site at the end of the deployment process, your MSDeploy command should resemble this:</span></span>

[!code-console[Main](taking-web-applications-offline-with-web-deploy/samples/sample2.cmd)]

<span data-ttu-id="abe5b-148">Um diese Befehle im Rahmen eines Build-und Bereitstellungs Prozesses zu automatisieren, müssen Sie Sie in Ihre benutzerdefinierte MSBuild-Projektdatei integrieren.</span><span class="sxs-lookup"><span data-stu-id="abe5b-148">To automate these commands as part of a build and deployment process, you need to integrate them into your custom MSBuild project file.</span></span> <span data-ttu-id="abe5b-149">Im nächsten Verfahren wird die Vorgehensweise beschrieben.</span><span class="sxs-lookup"><span data-stu-id="abe5b-149">The next procedure describes how to do this.</span></span>

<span data-ttu-id="abe5b-150">**So können Sie eine APP\_Offline Datei bereitstellen und löschen**</span><span class="sxs-lookup"><span data-stu-id="abe5b-150">**To deploy and delete an App\_offline file**</span></span>

1. <span data-ttu-id="abe5b-151">Öffnen Sie in Visual Studio 2010 die MSBuild-Projektdatei, mit der der Bereitstellungs Prozess gesteuert wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-151">In Visual Studio 2010, open the MSBuild project file that controls your deployment process.</span></span> <span data-ttu-id="abe5b-152">In der Beispiellösung [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) ist dies die Datei *Publish. proj* .</span><span class="sxs-lookup"><span data-stu-id="abe5b-152">In the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution, this is the *Publish.proj* file.</span></span>
2. <span data-ttu-id="abe5b-153">Erstellen Sie im root **Project** -Element ein neues **PropertyGroup** -Element, um die Variablen für die *App\_die Offline* Bereitstellung zu speichern:</span><span class="sxs-lookup"><span data-stu-id="abe5b-153">In the root **Project** element, create a new **PropertyGroup** element to store variables for the *App\_offline* deployment:</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample3.xml)]
3. <span data-ttu-id="abe5b-154">Die **SourceRoot** -Eigenschaft wird an anderer Stelle in der Datei " *Publish. proj* " definiert.</span><span class="sxs-lookup"><span data-stu-id="abe5b-154">The **SourceRoot** property is defined elsewhere in the *Publish.proj* file.</span></span> <span data-ttu-id="abe5b-155">Gibt den Speicherort des Stamm Ordners für den Quell Inhalt relativ zum aktuellen Pfad&#x2014;relativ zum Speicherort der Datei " *Publish. proj* " an.</span><span class="sxs-lookup"><span data-stu-id="abe5b-155">It indicates the location of the root folder for the source content relative to the current path&#x2014;in other words, relative to the location of the *Publish.proj* file.</span></span>
4. <span data-ttu-id="abe5b-156">Der **contentPath** -Anbieter akzeptiert keine relativen Dateipfade, sodass Sie einen absoluten Pfad zu Ihrer Quelldatei erhalten müssen, bevor Sie Sie bereitstellen können.</span><span class="sxs-lookup"><span data-stu-id="abe5b-156">The **contentPath** provider will not accept relative file paths, so you need to get an absolute path to your source file before you can deploy it.</span></span> <span data-ttu-id="abe5b-157">Hierfür können Sie die [convertdeabsolutepath](https://msdn.microsoft.com/library/bb882668.aspx) -Aufgabe verwenden.</span><span class="sxs-lookup"><span data-stu-id="abe5b-157">You can use the [ConvertToAbsolutePath](https://msdn.microsoft.com/library/bb882668.aspx) task to do this.</span></span>
5. <span data-ttu-id="abe5b-158">Fügen Sie ein neues **Ziel** Element mit dem Namen **getappofflineabsolutepath**hinzu.</span><span class="sxs-lookup"><span data-stu-id="abe5b-158">Add a new **Target** element named **GetAppOfflineAbsolutePath**.</span></span> <span data-ttu-id="abe5b-159">Verwenden Sie in diesem Ziel die **convertdeabsolutepath** -Aufgabe, um einen absoluten Pfad zur *App\_Offline-Vorlagen* Datei in Ihrem Projektordner abzurufen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-159">Within this target, use the **ConvertToAbsolutePath** task to get an absolute path to the *App\_offline-template* file in your project folder.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample4.xml)]
6. <span data-ttu-id="abe5b-160">Dieses Ziel übernimmt den relativen Pfad zur *App\_Offline-Vorlagen* Datei in Ihrem Projektordner und speichert Sie als absoluten Dateipfad in einer neuen Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="abe5b-160">This target takes the relative path to the *App\_offline-template* file in your project folder and saves it to a new property as an absolute file path.</span></span> <span data-ttu-id="abe5b-161">Das **BeforeTargets** -Attribut gibt an, dass dieses Ziel vor dem **deployappoffline** -Ziel ausgeführt werden soll, das Sie im nächsten Schritt erstellen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-161">The **BeforeTargets** attribute specifies that you want this target to execute before the **DeployAppOffline** target, which you'll create in the next step.</span></span>
7. <span data-ttu-id="abe5b-162">Fügen Sie ein neues Ziel mit dem Namen **deployappoffline**hinzu.</span><span class="sxs-lookup"><span data-stu-id="abe5b-162">Add a new target named **DeployAppOffline**.</span></span> <span data-ttu-id="abe5b-163">Rufen Sie in diesem Ziel den Befehl msbereitstellungs. exe auf, mit dem die *App\_Offline* Datei auf dem Zielweb Server bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-163">Within this target, invoke the MSDeploy.exe command that deploys your *App\_offline* file to the destination web server.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample5.xml)]
8. <span data-ttu-id="abe5b-164">In diesem Beispiel wird die **contactmanageriispath** -Eigenschaft an anderer Stelle in der Projektdatei definiert.</span><span class="sxs-lookup"><span data-stu-id="abe5b-164">In this example, the **ContactManagerIisPath** property is defined elsewhere in the project file.</span></span> <span data-ttu-id="abe5b-165">Dabei handelt es sich einfach um einen IIS-Anwendungspfad im Format *[IIS-Website Name]/[Anwendungsname]* .</span><span class="sxs-lookup"><span data-stu-id="abe5b-165">This is simply an IIS application path, in the form *[IIS Website Name]/[Application Name]*.</span></span> <span data-ttu-id="abe5b-166">Wenn Sie eine Bedingung in das Ziel einschließen, können Benutzer die *App\_Offline* Bereitstellung ein-oder ausschalten, indem Sie einen Eigenschafts Wert ändern oder einen Befehlszeilenparameter bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-166">Including a condition in the target enables users to switch the *App\_offline* deployment on or off by changing a property value or providing a command-line parameter.</span></span>
9. <span data-ttu-id="abe5b-167">Fügen Sie ein neues Ziel mit dem Namen **deleteappoffline**hinzu.</span><span class="sxs-lookup"><span data-stu-id="abe5b-167">Add a new target named **DeleteAppOffline**.</span></span> <span data-ttu-id="abe5b-168">Rufen Sie in diesem Ziel den Befehl msbereitstellungs. exe auf, mit dem die *App\_Offline* Datei vom Zielweb Server entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-168">Within this target, invoke the MSDeploy.exe command that removes your *App\_offline* file from the destination web server.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample6.xml)]
10. <span data-ttu-id="abe5b-169">Die letzte Aufgabe besteht darin, diese neuen Ziele an den entsprechenden Punkten während der Ausführung der Projektdatei aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-169">The final task is to invoke these new targets at appropriate points during the execution of your project file.</span></span> <span data-ttu-id="abe5b-170">Dies kann auf unterschiedliche Weise erfolgen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-170">You can do this in various ways.</span></span> <span data-ttu-id="abe5b-171">Beispielsweise gibt die **fullpublishdependson** -Eigenschaft in der Datei *Publish. proj* eine Liste von Zielen an, die ausgeführt werden müssen, wenn das **fullpublish** -Standardziel aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-171">For example, in the *Publish.proj* file, the **FullPublishDependsOn** property specifies a list of targets that must be executed in order when the **FullPublish** default target is invoked.</span></span>
11. <span data-ttu-id="abe5b-172">Ändern Sie die MSBuild-Projektdatei, um die Ziele **deployappoffline** und **deleteappoffline** an den entsprechenden Stellen im Veröffentlichungsprozess aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-172">Modify your MSBuild project file to invoke the **DeployAppOffline** and **DeleteAppOffline** targets at appropriate points in the publishing process.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample7.xml)]

<span data-ttu-id="abe5b-173">Wenn Sie die benutzerdefinierte MSBuild-Projektdatei ausführen, wird die *App\_Offline* Datei auf dem Server sofort nach einem erfolgreichen Build bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="abe5b-173">When you run your custom MSBuild project file, the *App\_offline* file will be deployed to the server immediately after a successful build.</span></span> <span data-ttu-id="abe5b-174">Sie wird dann vom Server gelöscht, sobald alle Bereitstellungs Aufgaben vollständig ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="abe5b-174">It will then be deleted from the server once all the deployment tasks are complete.</span></span>

## <a name="adding-an-app_offline-file-to-deployment-packages"></a><span data-ttu-id="abe5b-175">Hinzufügen einer APP\_Offline Datei zu Bereitstellungs Paketen</span><span class="sxs-lookup"><span data-stu-id="abe5b-175">Adding an App\_Offline File to Deployment Packages</span></span>

<span data-ttu-id="abe5b-176">Je nachdem, wie Sie die Bereitstellung konfigurieren, werden vorhandene Inhalte in der IIS-&#x2014;Ziel Webanwendung, wie die *App\_offline. htm* -Datei&#x2014;, möglicherweise automatisch gelöscht, wenn Sie ein Webpaket für das Ziel bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-176">Depending on how you configure your deployment, any existing content at the destination IIS web application&#x2014;like the *App\_offline.htm* file&#x2014;may be deleted automatically when you deploy a web package to the destination.</span></span> <span data-ttu-id="abe5b-177">Um sicherzustellen, dass die *App\_offline. htm* -Datei für die Dauer der Bereitstellung weiterhin vorhanden ist, müssen Sie die Datei zusätzlich zur Bereitstellung der Datei direkt zu Beginn des Bereitstellungs Prozesses in das Webbereitstellungs Paket einbinden.</span><span class="sxs-lookup"><span data-stu-id="abe5b-177">To ensure that the *App\_offline.htm* file remains in place for the duration of the deployment, you need to include the file within the web deployment package itself in addition to deploying the file directly at the start of the deployment process.</span></span>

- <span data-ttu-id="abe5b-178">Wenn Sie die vorherigen Aufgaben in diesem Thema befolgt haben, haben Sie dem Webanwendungs Projekt unter einem anderen Dateinamen (wir haben *App\_Offline-Template. htm*verwendet) die APP-\_Datei " *Offline. htm* " hinzugefügt, und Sie haben die Buildaktion auf " **None**" festgelegt.</span><span class="sxs-lookup"><span data-stu-id="abe5b-178">If you've followed the previous tasks in this topic, you'll have added the *App\_offline.htm* file to your web application project under a different filename (we used *App\_offline-template.htm*) and you'll have set the build action to **None**.</span></span> <span data-ttu-id="abe5b-179">Diese Änderungen sind erforderlich, um zu verhindern, dass die Datei die Entwicklung und das Debuggen beeinträchtigt.</span><span class="sxs-lookup"><span data-stu-id="abe5b-179">These changes are necessary to prevent the file from interfering with development and debugging.</span></span> <span data-ttu-id="abe5b-180">Daher müssen Sie den Verpackungsprozess anpassen, um sicherzustellen, dass die *App\_offline. htm* -Datei im Webbereitstellungs Paket enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="abe5b-180">As a result, you need to customize the packaging process to ensure that the *App\_offline.htm* file is included in the web deployment package.</span></span>

<span data-ttu-id="abe5b-181">Die Webpublishing Pipeline (WPP) verwendet eine Elementliste mit dem Namen " **filesforpackagingfromproject** ", um eine Liste von Dateien zu erstellen, die im Webbereitstellungs Paket enthalten sein sollen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-181">The Web Publishing Pipeline (WPP) uses an item list named **FilesForPackagingFromProject** to build a list of files that should be included in the web deployment package.</span></span> <span data-ttu-id="abe5b-182">Sie können den Inhalt Ihrer Webpakete anpassen, indem Sie eigene Elemente zu dieser Liste hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-182">You can customize the contents of your web packages by adding your own items to this list.</span></span> <span data-ttu-id="abe5b-183">Hierzu müssen Sie die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="abe5b-183">To do this, you need to complete these high-level steps:</span></span>

1. <span data-ttu-id="abe5b-184">Erstellen Sie eine benutzerdefinierte Projektdatei mit dem Namen *[Project Name]. WPP. targets* in demselben Ordner wie die Projektdatei.</span><span class="sxs-lookup"><span data-stu-id="abe5b-184">Create a custom project file named *[project name].wpp.targets* in the same folder as your project file.</span></span>

    > [!NOTE]
    > <span data-ttu-id="abe5b-185">Die *WPP. targets* -Datei muss sich im selben Ordner wie die Projektdatei&#x2014;der Webanwendung befinden. Beispiel: *ContactManager. MVC. csproj*&#x2014;und nicht im selben Ordner wie benutzerdefinierte Projektdateien, mit denen Sie den Build-und Bereitstellungs Prozess steuern.</span><span class="sxs-lookup"><span data-stu-id="abe5b-185">The *.wpp.targets* file needs to go in the same folder as your web application project file&#x2014;for example, *ContactManager.Mvc.csproj*&#x2014;rather than in the same folder as any custom project files you use to control the build and deployment process.</span></span>
2. <span data-ttu-id="abe5b-186">Erstellen Sie in der Datei *. WPP. targets* ein neues MSBuild-Ziel, das *vor* dem **copyallfilestosinglefolderforpackage** -Ziel ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-186">In the *.wpp.targets* file, create a new MSBuild target that executes *before* the **CopyAllFilesToSingleFolderForPackage** target.</span></span> <span data-ttu-id="abe5b-187">Dies ist das WPP-Ziel, das eine Liste von Elementen erstellt, die in das Paket eingeschlossen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-187">This is the WPP target that builds a list of things to include in the package.</span></span>
3. <span data-ttu-id="abe5b-188">Erstellen Sie im neuen Ziel ein **ItemGroup** -Element.</span><span class="sxs-lookup"><span data-stu-id="abe5b-188">In the new target, create an **ItemGroup** element.</span></span>
4. <span data-ttu-id="abe5b-189">Fügen Sie im **ItemGroup** -Element ein " **filesforpackagingfromproject** "-Element hinzu, und geben Sie die *App\_offline. htm* -Datei an.</span><span class="sxs-lookup"><span data-stu-id="abe5b-189">In the **ItemGroup** element, add a **FilesForPackagingFromProject** item and specify the *App\_offline.htm* file.</span></span>

<span data-ttu-id="abe5b-190">Die *WPP. targets* -Datei sollte in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="abe5b-190">The *.wpp.targets* file should resemble this:</span></span>

[!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample8.xml)]

<span data-ttu-id="abe5b-191">Dies sind die wichtigsten Punkte in diesem Beispiel:</span><span class="sxs-lookup"><span data-stu-id="abe5b-191">These are the key points of note in this example:</span></span>

- <span data-ttu-id="abe5b-192">Das **BeforeTargets** -Attribut fügt dieses Ziel in das WPP ein, indem es angibt, dass es unmittelbar vor dem **copyallfilestosinglefolderforpackage** -Ziel ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="abe5b-192">The **BeforeTargets** attribute inserts this target into the WPP by specifying that it should be executed immediately before the **CopyAllFilesToSingleFolderForPackage** target.</span></span>
- <span data-ttu-id="abe5b-193">Das **filesforpackagingfromproject** -Element verwendet den **destinationrelativepath** -Metadatenwert zum Umbenennen der Datei von *App-\_Offline-Template. htm* in *App\_offline. htm* , wenn Sie der Liste hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-193">The **FilesForPackagingFromProject** item uses the **DestinationRelativePath** metadata value to rename the file from *App\_offline-template.htm* to *App\_offline.htm* as it's added to the list.</span></span>

<span data-ttu-id="abe5b-194">Im nächsten Verfahren wird gezeigt, wie Sie diese *WPP. targets* -Datei einem Webanwendungs Projekt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-194">The next procedure shows you how to add this *.wpp.targets* file to a web application project.</span></span>

<span data-ttu-id="abe5b-195">**So fügen Sie einem Webbereitstellungs Paket eine WPP. targets-Datei hinzu**</span><span class="sxs-lookup"><span data-stu-id="abe5b-195">**To add a .wpp.targets file to a web deployment package**</span></span>

1. <span data-ttu-id="abe5b-196">Öffnen Sie die Projekt Mappe in Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="abe5b-196">Open your solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="abe5b-197">Klicken Sie im **Projektmappen-Explorer** Fenster mit der rechten Maustaste auf den Webanwendungs Projekt Knoten (z. **b. ContactManager. MVC**), zeigen Sie auf **Hinzufügen**, und klicken Sie dann auf **Neues Element**.</span><span class="sxs-lookup"><span data-stu-id="abe5b-197">In the **Solution Explorer** window, right-click your web application project node (for example, **ContactManager.Mvc**), point to **Add**, and then click **New Item**.</span></span>
3. <span data-ttu-id="abe5b-198">Wählen Sie im Dialogfeld **Neues Element hinzufügen** die Vorlage **XML-Datei** aus.</span><span class="sxs-lookup"><span data-stu-id="abe5b-198">In the **Add New Item** dialog box, select the **XML File** template.</span></span>
4. <span data-ttu-id="abe5b-199">Geben Sie im Feld **Name den Namen** *[Project Name] \* \* *. WPP. targets** (z **. b. ContactManager. MVC. WPP. targets**) ein, und klicken Sie dann auf **Hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="abe5b-199">In the **Name** box, type *[project name]\*\*\*.wpp.targets*\* (for example, **ContactManager.Mvc.wpp.targets**), and then click **Add**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image4.png)

    > [!NOTE]
    > <span data-ttu-id="abe5b-200">Wenn Sie dem Stamm Knoten eines Projekts ein neues Element hinzufügen, wird die Datei im selben Ordner wie die Projektdatei erstellt.</span><span class="sxs-lookup"><span data-stu-id="abe5b-200">If you add a new item to the root node of a project, the file is created in the same folder as the project file.</span></span> <span data-ttu-id="abe5b-201">Sie können dies überprüfen, indem Sie den Ordner in Windows-Explorer öffnen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-201">You can verify this by opening the folder in Windows Explorer.</span></span>
5. <span data-ttu-id="abe5b-202">Fügen Sie in der Datei das zuvor beschriebene MSBuild-Markup hinzu.</span><span class="sxs-lookup"><span data-stu-id="abe5b-202">In the file, add the MSBuild markup described previously.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample9.xml)]
6. <span data-ttu-id="abe5b-203">Speichern und schließen Sie die Datei *[Project Name]. WPP. targets* .</span><span class="sxs-lookup"><span data-stu-id="abe5b-203">Save and close the *[project name].wpp.targets* file.</span></span>

<span data-ttu-id="abe5b-204">Wenn Sie das nächste Mal das Webanwendungs Projekt erstellen und packen, wird die WPP *. targets* -Datei automatisch von WPP erkannt.</span><span class="sxs-lookup"><span data-stu-id="abe5b-204">The next time you build and package your web application project, the WPP will automatically detect the *.wpp.targets* file.</span></span> <span data-ttu-id="abe5b-205">Die *App\_Offline-Template. htm* -Datei wird in das resultierende Webbereitstellungs Paket als *App\_offline. htm*eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-205">The *App\_offline-template.htm* file will be included in the resulting web deployment package as *App\_offline.htm*.</span></span>

> [!NOTE]
> <span data-ttu-id="abe5b-206">Wenn bei der Bereitstellung ein Fehler auftritt, bleibt die Datei " *App\_offline. htm* " erhalten, und die Anwendung bleibt offline.</span><span class="sxs-lookup"><span data-stu-id="abe5b-206">If your deployment fails, the *App\_offline.htm* file will remain in place and your application will remain offline.</span></span> <span data-ttu-id="abe5b-207">Dies ist in der Regel das gewünschte Verhalten.</span><span class="sxs-lookup"><span data-stu-id="abe5b-207">This is typically the desired behavior.</span></span> <span data-ttu-id="abe5b-208">Wenn Sie Ihre Anwendung wieder online schalten möchten, können Sie die *App\_Datei "offline. htm* " von Ihrem Webserver löschen.</span><span class="sxs-lookup"><span data-stu-id="abe5b-208">To bring your application back online, you can delete the *App\_offline.htm* file from your web server.</span></span> <span data-ttu-id="abe5b-209">Wenn Sie Fehler beheben und eine erfolgreiche Bereitstellung ausführen, wird die *App\_offline. htm* -Datei entfernt.</span><span class="sxs-lookup"><span data-stu-id="abe5b-209">Alternatively, if you correct any errors and run a successful deployment, the *App\_offline.htm* file will be removed.</span></span>

## <a name="conclusion"></a><span data-ttu-id="abe5b-210">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="abe5b-210">Conclusion</span></span>

<span data-ttu-id="abe5b-211">In diesem Thema wird beschrieben, wie eine Webanwendung für die Dauer einer Bereitstellung offline geschaltet wird, indem eine *App\_offline. htm* -Datei auf dem Zielserver zu Beginn des Bereitstellungs Prozesses veröffentlicht und am Ende entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="abe5b-211">This topic described how to take a web application offline for the duration of a deployment, by publishing an *App\_offline.htm* file to the destination server at the start of the deployment process and removing it at the end.</span></span> <span data-ttu-id="abe5b-212">Außerdem wird beschrieben, wie Sie eine *App\_offline. htm* -Datei in ein Webbereitstellungs Paket einbinden.</span><span class="sxs-lookup"><span data-stu-id="abe5b-212">It also covered how to include an *App\_offline.htm* file in a web deployment package.</span></span>

## <a name="further-reading"></a><span data-ttu-id="abe5b-213">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="abe5b-213">Further Reading</span></span>

<span data-ttu-id="abe5b-214">Weitere Informationen zum Verpackungs-und Bereitstellungs Prozess finden Sie unter [Erstellung und Verpacken von Webanwendungs Projekten](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Konfigurieren von Parametern für die Webpaket Bereitstellung und bereit](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md)stellen von [Webpaketen](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span><span class="sxs-lookup"><span data-stu-id="abe5b-214">For more information on the packaging and deployment process, see [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Configuring Parameters for Web Package Deployment](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md), and [Deploying Web Packages](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span></span>

<span data-ttu-id="abe5b-215">Wenn Sie Ihre Webanwendungen direkt aus Visual Studio heraus veröffentlichen, anstatt den in diesen Tutorials beschriebenen benutzerdefinierten MSBuild-Projektdatei Ansatz zu verwenden, müssen Sie einen etwas anderen Ansatz verwenden, um die Anwendung während der Veröffentlichung offline zu schalten. ESS.</span><span class="sxs-lookup"><span data-stu-id="abe5b-215">If you publish your web applications directly from Visual Studio, rather than using the custom MSBuild project file approach described in these tutorials, you'll need to use a slightly different approach to take your application offline during the publishing process.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="abe5b-216">[Zurück](excluding-files-and-folders-from-deployment.md)
> [Weiter](running-windows-powershell-scripts-from-msbuild-project-files.md)</span><span class="sxs-lookup"><span data-stu-id="abe5b-216">[Previous](excluding-files-and-folders-from-deployment.md)
[Next](running-windows-powershell-scripts-from-msbuild-project-files.md)</span></span>
