---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy
title: Offlineschalten von Webanwendungen mit Web bereitstellen | Microsoft-Dokumentation
author: jrjlee
description: In diesem Thema wird beschrieben, wie Sie eine Webanwendung für die Dauer einer automatisierten Bereitstellung mithilfe der Internetinformationsdienste (Internet Information Services, IIS) Web Depl offline...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 3e9f6e7d-8967-4586-94d5-d3a122f12529
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy
msc.type: authoredcontent
ms.openlocfilehash: 017eceb8567859fdbe28bb87af844eee20dfa525
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/17/2019
ms.locfileid: "59415478"
---
# <a name="taking-web-applications-offline-with-web-deploy"></a><span data-ttu-id="68d9a-103">Offlineschalten von Webanwendungen mit Web Deploy</span><span class="sxs-lookup"><span data-stu-id="68d9a-103">Taking Web Applications Offline with Web Deploy</span></span>

<span data-ttu-id="68d9a-104">durch [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="68d9a-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="68d9a-105">PDF herunterladen</span><span class="sxs-lookup"><span data-stu-id="68d9a-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="68d9a-106">In diesem Thema wird beschrieben, wie Sie eine Webanwendung für die Dauer einer automatisierten Bereitstellung über das Internet Information Services (IIS)-Webbereitstellungstool (Web Deploy) offline nutzen können.</span><span class="sxs-lookup"><span data-stu-id="68d9a-106">This topic describes how to take a web application offline for the duration of an automated deployment using the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span> <span data-ttu-id="68d9a-107">Benutzer, die an die Webanwendung durchsuchen werden umgeleitet, um eine *App\_offline.htm* Datei, bis die Bereitstellung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="68d9a-107">Users who browse to the web application are redirected to an *App\_offline.htm* file until the deployment is complete.</span></span>


<span data-ttu-id="68d9a-108">In diesem Thema ist Teil einer Reihe von Tutorials, die auf der Basis der bereitstellungsanforderungen Enterprise ein fiktives Unternehmen, die mit dem Namen Fabrikam, Inc. Dieser tutorialreihe verwendet eine beispiellösung&#x2014;der [Contact Manager-Lösung](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;zur Darstellung einer Webanwendung mit einem realistischen Maß an Komplexität, einschließlich einer ASP.NET MVC 3-Anwendung, eine Windows-Kommunikation Foundation (WCF)-Dienst und ein Datenbankprojekt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="68d9a-109">Die Methode für die Bereitstellung das Kernstück des in diesen Tutorials basiert auf den geteilten Projekt Dateiansatz beschrieben, die [Grundlegendes zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in dem der Buildprozess durch gesteuert wird zwei Projektdateien&#x2014;enthält Erstellen Sie die Anweisungen, die für jede zielumgebung, und enthält umgebungsspezifische Build & Deployment-Einstellungen gelten.</span><span class="sxs-lookup"><span data-stu-id="68d9a-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="68d9a-110">Zur Erstellungszeit wird die umgebungsspezifischen-Projektdatei in die Unabhängigkeit von der Umgebung Projektdatei, um einen vollständigen Satz von einrichtungsanweisungen bilden zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="68d9a-111">Übersicht über den Task</span><span class="sxs-lookup"><span data-stu-id="68d9a-111">Task Overview</span></span>

<span data-ttu-id="68d9a-112">In vielen Szenarien sollten Sie eine Webanwendung offline zu schalten, während Sie Änderungen an den zugehörigen Komponenten, wie Datenbanken oder Webdiensten vornehmen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-112">In a lot of scenarios, you'll want to take a web application offline while you make changes to related components, like databases or web services.</span></span> <span data-ttu-id="68d9a-113">In der Regel in IIS und ASP.NET können Sie dazu platzieren eine Datei namens *App\_offline.htm* im Stammordner der IIS-Website oder Web-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="68d9a-113">Typically, in IIS and ASP.NET, you accomplish this by placing a file named *App\_offline.htm* in the root folder of the IIS website or web application.</span></span> <span data-ttu-id="68d9a-114">Die *App\_offline.htm* -Datei ist eine standard-HTML-Datei und enthält in der Regel eine einfache Nachricht mit dem Hinweis an, dass der Standort aufgrund von Wartungsarbeiten vorübergehend nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="68d9a-114">The *App\_offline.htm* file is a standard HTML file and will usually contain a simple message advising the user that the site is temporarily unavailable due to maintenance.</span></span> <span data-ttu-id="68d9a-115">Während der *App\_offline.htm* Datei, die im Stammordner der Website vorhanden ist, wird IIS automatisch alle Anforderungen an die Datei umgeleitet.</span><span class="sxs-lookup"><span data-stu-id="68d9a-115">While the *App\_offline.htm* file exists in the root folder of the website, IIS will automatically redirect any requests to the file.</span></span> <span data-ttu-id="68d9a-116">Wenn Sie Updates vorgenommen haben, entfernen Sie die *App\_offline.htm* -Datei und die Website wird fortgesetzt, Verarbeiten von Anforderungen wie gewohnt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-116">When you've finished making updates, you remove the *App\_offline.htm* file and the website resumes serving requests as usual.</span></span>

<span data-ttu-id="68d9a-117">Wenn Sie Web Deploy zum Ausführen von automatisierten oder Schritt für Schritt Bereitstellungen in einer zielumgebung verwenden, möchten Sie möglicherweise integrieren, hinzufügen und Entfernen von der *App\_offline.htm* -Datei in den Bereitstellungsprozess.</span><span class="sxs-lookup"><span data-stu-id="68d9a-117">When you use Web Deploy to perform automated or single-step deployments to a target environment, you may want to incorporate adding and removing the *App\_offline.htm* file into your deployment process.</span></span> <span data-ttu-id="68d9a-118">Zu diesem Zweck müssen Sie diese allgemeinen Aufgaben ausführen:</span><span class="sxs-lookup"><span data-stu-id="68d9a-118">To do this, you'll need to complete these high-level tasks:</span></span>

- <span data-ttu-id="68d9a-119">In der Projektdatei Microsoft Build Engine (MSBuild) kopiert werden sollen, verwenden, um den Bereitstellungsprozess zu steuern, erstellen ein MSBuild-Ziel, die eine *App\_offline.htm* Datei auf den Zielserver vor alle Bereitstellungsaufgaben beginnen Sie mit.</span><span class="sxs-lookup"><span data-stu-id="68d9a-119">In the Microsoft Build Engine (MSBuild) project file that you use to control the deployment process, create an MSBuild target that copies an *App\_offline.htm* file to the destination server before any deployment tasks begin.</span></span>
- <span data-ttu-id="68d9a-120">Fügen Sie einen anderen MSBuild-Ziel, das entfernt die *App\_offline.htm* Datei auf dem Zielserver, nachdem alle Bereitstellungsaufgaben abgeschlossen sind.</span><span class="sxs-lookup"><span data-stu-id="68d9a-120">Add another MSBuild target that removes the *App\_offline.htm* file from the destination server when all deployment tasks are complete.</span></span>
- <span data-ttu-id="68d9a-121">Erstellen Sie in das Webanwendungsprojekt, eine *. wpp.targets* -Datei, die wird, dass sichergestellt ein *App\_offline.htm* Datei wird in das Bereitstellungspaket hinzugefügt, wenn die Web Deploy aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="68d9a-121">In the web application project, create a *.wpp.targets* file that ensures that an *App\_offline.htm* file is added to the deployment package when Web Deploy is invoked.</span></span>

<span data-ttu-id="68d9a-122">In diesem Thema zeigt Sie, wie Sie diese Schritte ausführen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-122">This topic will show you how to perform these procedures.</span></span> <span data-ttu-id="68d9a-123">Die Aufgaben und exemplarische Vorgehensweisen in diesem Thema wird davon ausgegangen, dass Sie bereits eine Lösung erstellt haben, die mindestens ein Webanwendungsprojekt enthält und Sie eine benutzerdefinierte Projektdatei verwenden, um den Bereitstellungsprozess zu steuern, wie in beschrieben [Webbereitstellung in der Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md).</span><span class="sxs-lookup"><span data-stu-id="68d9a-123">The tasks and walkthroughs in this topic assume that you've already created a solution that contains at least one web application project, and that you use a custom project file to control the deployment process as described in [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md).</span></span> <span data-ttu-id="68d9a-124">Alternativ können Sie die [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) Beispielprojektmappe zu den Beispielen im Thema zu folgen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-124">Alternatively, you can use the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution to follow the examples in the topic.</span></span>

## <a name="adding-an-appoffline-file-to-a-web-application-project"></a><span data-ttu-id="68d9a-125">Hinzufügen einer App\_Offline-Datei in ein Webanwendungsprojekt</span><span class="sxs-lookup"><span data-stu-id="68d9a-125">Adding an App\_Offline File to a Web Application Project</span></span>

<span data-ttu-id="68d9a-126">Die erste Aufgabe, die erforderlich ist, Hinzufügen einer *App\_offline* Datei zu Ihrem Webprojekt für die Anwendung:</span><span class="sxs-lookup"><span data-stu-id="68d9a-126">The first task you need to complete is to add an *App\_offline* file to your web application project:</span></span>

- <span data-ttu-id="68d9a-127">Um zu verhindern, dass die Datei in den Entwicklungsprozess stören (nicht soll Ihre Anwendung dauerhaft offline sein), rufen Sie es etwas anders als *App\_offline.htm*.</span><span class="sxs-lookup"><span data-stu-id="68d9a-127">To prevent the file from interfering with the development process (you don't want your application to be permanently offline), you should call it something other than *App\_offline.htm*.</span></span> <span data-ttu-id="68d9a-128">Sie können z. B. benennen Sie die Datei *App\_offline template.htm*.</span><span class="sxs-lookup"><span data-stu-id="68d9a-128">For example, you could name the file *App\_offline-template.htm*.</span></span>
- <span data-ttu-id="68d9a-129">Um zu verhindern, dass die Datei als bereitgestellt – ist, sollten Sie die Buildaktion auf festlegen **keine**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-129">To prevent the file from being deployed as-is, you should set the build action to **None**.</span></span>

<span data-ttu-id="68d9a-130">**Hinzufügen eine App\_offline-Datei in ein Webanwendungsprojekt**</span><span class="sxs-lookup"><span data-stu-id="68d9a-130">**To add an App\_offline file to a web application project**</span></span>

1. <span data-ttu-id="68d9a-131">Öffnen Sie die Projektmappe in Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="68d9a-131">Open your solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="68d9a-132">In der **Projektmappen-Explorer** Fenster mit der rechten Maustaste in des Webanwendungsprojekts, zeigen Sie auf **hinzufügen**, und klicken Sie dann auf **neues Element**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-132">In the **Solution Explorer** window, right-click your web application project, point to **Add**, and then click **New Item**.</span></span>
3. <span data-ttu-id="68d9a-133">In der **neues Element hinzufügen** wählen Sie im Dialogfeld **HTML-Seite**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-133">In the **Add New Item** dialog box, select **HTML Page**.</span></span>
4. <span data-ttu-id="68d9a-134">In der **Namen** geben **App\_offline template.htm**, und klicken Sie dann auf **hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-134">In the **Name** box, type **App\_offline-template.htm**, and then click **Add**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image1.png)
5. <span data-ttu-id="68d9a-135">Hinzufügen von einfacher HTML-Code um Benutzer zu informieren, dass die Anwendung nicht verfügbar ist, und speichern Sie die Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-135">Add some simple HTML to inform users that the application is unavailable, and then save the file.</span></span> <span data-ttu-id="68d9a-136">Schließen Sie keine serverseitigen Tags (z. B. alle Tags, die mit dem Präfix "Asp:").</span><span class="sxs-lookup"><span data-stu-id="68d9a-136">Do not include any server-side tags (for example, any tags that are prefixed with "asp:").</span></span> 

    ![](taking-web-applications-offline-with-web-deploy/_static/image2.png)
6. <span data-ttu-id="68d9a-137">In der **Projektmappen-Explorer** rechten Maustaste auf die neue Datei, und klicken Sie dann auf **Eigenschaften**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-137">In the **Solution Explorer** window, right-click the new file, and then click **Properties**.</span></span>
7. <span data-ttu-id="68d9a-138">In der **Eigenschaften** Fenster in der **Buildvorgang** Zeile **keine**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-138">In the **Properties** window, in the **Build Action** row, select **None**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image3.png)

## <a name="deploying-and-deleting-an-appoffline-file"></a><span data-ttu-id="68d9a-139">Bereitstellen und Löschen einer App\_Offline-Datei</span><span class="sxs-lookup"><span data-stu-id="68d9a-139">Deploying and Deleting an App\_Offline File</span></span>

<span data-ttu-id="68d9a-140">Der nächste Schritt ist zum Ändern Ihrer Bereitstellungslogik kopieren Sie die Datei auf den Zielserver am Anfang des Bereitstellungsprozesses und am Ende entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="68d9a-140">The next step is to modify your deployment logic to copy the file to the destination server at the start of the deployment process and remove it at the end.</span></span>

> [!NOTE]
> <span data-ttu-id="68d9a-141">Im nächste Verfahren wird davon ausgegangen, dass Sie eine benutzerdefinierte MSBuild-Projektdatei verwenden, um den Bereitstellungsprozess steuern, wie in beschrieben [Grundlegendes zur Projektdatei](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="68d9a-141">The next procedure assumes that you're using a custom MSBuild project file to control your deployment process, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span> <span data-ttu-id="68d9a-142">Wenn Sie direkt von Visual Studio bereitstellen, müssen Sie einen anderen Ansatz zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="68d9a-142">If you're deploying direct from Visual Studio, you'll need to use a different approach.</span></span> <span data-ttu-id="68d9a-143">Sayed Ibrahim Hashimi beschreibt einen solchen Ansatz in [Vorgehensweise nehmen Ihre App Offline während der Webveröffentlichung](http://sedodream.com/2012/01/08/HowToTakeYourWebAppOfflineDuringPublishing.aspx).</span><span class="sxs-lookup"><span data-stu-id="68d9a-143">Sayed Ibrahim Hashimi describes one such approach in [How to Take Your Web App Offline During Publishing](http://sedodream.com/2012/01/08/HowToTakeYourWebAppOfflineDuringPublishing.aspx).</span></span>


<span data-ttu-id="68d9a-144">Bereitstellen einer *App\_offline* Datei mit einer Ziel-IIS-Website, müssen Sie MSDeploy.exe mit Aufrufen der [Web Deploy **ContentPath** Anbieter](https://technet.microsoft.com/library/dd569034(WS.10).aspx).</span><span class="sxs-lookup"><span data-stu-id="68d9a-144">To deploy an *App\_offline* file to a destination IIS website, you need to invoke MSDeploy.exe using the [Web Deploy **contentPath** provider](https://technet.microsoft.com/library/dd569034(WS.10).aspx).</span></span> <span data-ttu-id="68d9a-145">Die **ContentPath** -Anbieter unterstützt sowohl physischen Verzeichnispfade und Pfade in IIS-Website oder Anwendung, wodurch die ideale Wahl für die Synchronisierung von einer Datei zwischen einem Visual Studio-Projektordner und einer IIS-Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="68d9a-145">The **contentPath** provider supports both physical directory paths and IIS website or application paths, which makes it the ideal choice for synchronizing a file between a Visual Studio project folder and an IIS web application.</span></span> <span data-ttu-id="68d9a-146">Um die Datei bereitstellen, sieht der MSDeploy-Befehl folgendermaßen aus:</span><span class="sxs-lookup"><span data-stu-id="68d9a-146">To deploy the file, your MSDeploy command should resemble this:</span></span>


[!code-console[Main](taking-web-applications-offline-with-web-deploy/samples/sample1.cmd)]


<span data-ttu-id="68d9a-147">Um die Datei aus dem Zielstandort am Ende des Bereitstellungsprozesses zu entfernen, sieht der MSDeploy-Befehl folgendermaßen aus:</span><span class="sxs-lookup"><span data-stu-id="68d9a-147">To remove the file from the destination site at the end of the deployment process, your MSDeploy command should resemble this:</span></span>


[!code-console[Main](taking-web-applications-offline-with-web-deploy/samples/sample2.cmd)]


<span data-ttu-id="68d9a-148">Um diese Befehle als Teil von einem Build & Deployment-Prozess zu automatisieren, müssen Sie sie in der benutzerdefinierten MSBuild-Projektdatei zu integrieren.</span><span class="sxs-lookup"><span data-stu-id="68d9a-148">To automate these commands as part of a build and deployment process, you need to integrate them into your custom MSBuild project file.</span></span> <span data-ttu-id="68d9a-149">Im nächste Verfahren wird beschrieben, wie zu diesem Zweck wird.</span><span class="sxs-lookup"><span data-stu-id="68d9a-149">The next procedure describes how to do this.</span></span>

<span data-ttu-id="68d9a-150">**Beim Bereitstellen und löschen eine App\_offline-Datei**</span><span class="sxs-lookup"><span data-stu-id="68d9a-150">**To deploy and delete an App\_offline file**</span></span>

1. <span data-ttu-id="68d9a-151">Öffnen Sie in Visual Studio 2010 die MSBuild-Projektdatei, die den Bereitstellungsprozess steuert.</span><span class="sxs-lookup"><span data-stu-id="68d9a-151">In Visual Studio 2010, open the MSBuild project file that controls your deployment process.</span></span> <span data-ttu-id="68d9a-152">In der [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) beispiellösung, dies ist die *Publish.proj* Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-152">In the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution, this is the *Publish.proj* file.</span></span>
2. <span data-ttu-id="68d9a-153">Im Stammverzeichnis **Projekt** -Element, erstellen Sie ein neues **PropertyGroup** Element zum Speichern von Variablen für die *App\_offline* Bereitstellung:</span><span class="sxs-lookup"><span data-stu-id="68d9a-153">In the root **Project** element, create a new **PropertyGroup** element to store variables for the *App\_offline* deployment:</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample3.xml)]
3. <span data-ttu-id="68d9a-154">Die **SourceRoot** Eigenschaft wird an anderer Stelle definiert, der *Publish.proj* Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-154">The **SourceRoot** property is defined elsewhere in the *Publish.proj* file.</span></span> <span data-ttu-id="68d9a-155">Gibt den Speicherort des Stammordners für den Quellinhalt relativ zu den aktuellen Pfad&#x2014;in anderen Worten, relativ zum Speicherort von der *Publish.proj* Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-155">It indicates the location of the root folder for the source content relative to the current path&#x2014;in other words, relative to the location of the *Publish.proj* file.</span></span>
4. <span data-ttu-id="68d9a-156">Die **ContentPath** Anbieter akzeptiert keine relativen Pfade, daher müssen Sie einen absoluten Pfad Ihrer Quelldatei zu erhalten, bevor Sie bereitgestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="68d9a-156">The **contentPath** provider will not accept relative file paths, so you need to get an absolute path to your source file before you can deploy it.</span></span> <span data-ttu-id="68d9a-157">Sie können die [ConvertToAbsolutePath](https://msdn.microsoft.com/library/bb882668.aspx) Aufgabe dazu.</span><span class="sxs-lookup"><span data-stu-id="68d9a-157">You can use the [ConvertToAbsolutePath](https://msdn.microsoft.com/library/bb882668.aspx) task to do this.</span></span>
5. <span data-ttu-id="68d9a-158">Fügen Sie einen neuen **Ziel** Element mit dem Namen **GetAppOfflineAbsolutePath**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-158">Add a new **Target** element named **GetAppOfflineAbsolutePath**.</span></span> <span data-ttu-id="68d9a-159">Innerhalb dieses Ziel verwenden das **ConvertToAbsolutePath** ausführen einen absoluten Pfad zum Abrufen der *App\_offline-Template* Datei in Ihrem Projektordner.</span><span class="sxs-lookup"><span data-stu-id="68d9a-159">Within this target, use the **ConvertToAbsolutePath** task to get an absolute path to the *App\_offline-template* file in your project folder.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample4.xml)]
6. <span data-ttu-id="68d9a-160">Dieses Ziel verwendet, den relativen Pfad zu der *App\_offline-Template* Datei im Projektordner und speichert es in eine neue Eigenschaft als einen absoluten Dateipfad.</span><span class="sxs-lookup"><span data-stu-id="68d9a-160">This target takes the relative path to the *App\_offline-template* file in your project folder and saves it to a new property as an absolute file path.</span></span> <span data-ttu-id="68d9a-161">Die **BeforeTargets** Attribut gibt an, dass es sich bei diesem Ziel vor ausgeführt werden sollen die **DeployAppOffline** Ziel, die Sie im nächsten Schritt erstellen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-161">The **BeforeTargets** attribute specifies that you want this target to execute before the **DeployAppOffline** target, which you'll create in the next step.</span></span>
7. <span data-ttu-id="68d9a-162">Fügen Sie ein neues Ziel, die mit dem Namen **DeployAppOffline**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-162">Add a new target named **DeployAppOffline**.</span></span> <span data-ttu-id="68d9a-163">Rufen Sie den MSDeploy.exe-Befehl, das bereitgestellt wird, innerhalb dieses Ziel Ihrer *App\_offline* Datei auf den Zielserver für das Web.</span><span class="sxs-lookup"><span data-stu-id="68d9a-163">Within this target, invoke the MSDeploy.exe command that deploys your *App\_offline* file to the destination web server.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample5.xml)]
8. <span data-ttu-id="68d9a-164">In diesem Beispiel die **ContactManagerIisPath** Eigenschaft wird an anderer Stelle in der Projektdatei definiert.</span><span class="sxs-lookup"><span data-stu-id="68d9a-164">In this example, the **ContactManagerIisPath** property is defined elsewhere in the project file.</span></span> <span data-ttu-id="68d9a-165">Dies ist einfach ein IIS-Anwendungspfad, in der Form *[IIS-Website-Name] / [Anwendungsname]*.</span><span class="sxs-lookup"><span data-stu-id="68d9a-165">This is simply an IIS application path, in the form *[IIS Website Name]/[Application Name]*.</span></span> <span data-ttu-id="68d9a-166">Eine Bedingung in der Ziel-einschließlich ermöglicht Benutzern, wechseln die *App\_offline* Bereitstellung aktivieren oder deaktivieren, durch Ändern eines Eigenschaftswerts oder ein Befehlszeilen-Parameter.</span><span class="sxs-lookup"><span data-stu-id="68d9a-166">Including a condition in the target enables users to switch the *App\_offline* deployment on or off by changing a property value or providing a command-line parameter.</span></span>
9. <span data-ttu-id="68d9a-167">Fügen Sie ein neues Ziel, die mit dem Namen **DeleteAppOffline**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-167">Add a new target named **DeleteAppOffline**.</span></span> <span data-ttu-id="68d9a-168">In diesem Ziel, rufen Sie den MSDeploy.exe-Befehl, der entfernt Ihre *App\_offline* -Datei aus dem Zielwebserver.</span><span class="sxs-lookup"><span data-stu-id="68d9a-168">Within this target, invoke the MSDeploy.exe command that removes your *App\_offline* file from the destination web server.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample6.xml)]
10. <span data-ttu-id="68d9a-169">Die letzte Aufgabe besteht darin, rufen Sie diese neue Ziele zu geeigneten Zeitpunkten während der Ausführung Ihrer Projektdatei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-169">The final task is to invoke these new targets at appropriate points during the execution of your project file.</span></span> <span data-ttu-id="68d9a-170">Dies ist auf verschiedene Weise möglich.</span><span class="sxs-lookup"><span data-stu-id="68d9a-170">You can do this in various ways.</span></span> <span data-ttu-id="68d9a-171">Z. B. in der *Publish.proj* -Datei, die **FullPublishDependsOn** Eigenschaft gibt eine Liste der Ziele, die ausgeführt werden muss, in Reihenfolge bei der **FullPublish** Standard Ziel wird aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-171">For example, in the *Publish.proj* file, the **FullPublishDependsOn** property specifies a list of targets that must be executed in order when the **FullPublish** default target is invoked.</span></span>
11. <span data-ttu-id="68d9a-172">Ändern die MSBuild-Projektdatei zum Aufrufen der **DeployAppOffline** und **DeleteAppOffline** Ziele zu geeigneten Zeitpunkten in den Veröffentlichungsprozess.</span><span class="sxs-lookup"><span data-stu-id="68d9a-172">Modify your MSBuild project file to invoke the **DeployAppOffline** and **DeleteAppOffline** targets at appropriate points in the publishing process.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample7.xml)]

<span data-ttu-id="68d9a-173">Beim Ausführen der benutzerdefinierten MSBuild-Projektdatei, die *App\_offline* Datei wird unmittelbar nach einem erfolgreichen Build auf dem Server bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="68d9a-173">When you run your custom MSBuild project file, the *App\_offline* file will be deployed to the server immediately after a successful build.</span></span> <span data-ttu-id="68d9a-174">Es wird dann vom Server gelöscht werden, nachdem alle Bereitstellungsaufgaben abgeschlossen wurden.</span><span class="sxs-lookup"><span data-stu-id="68d9a-174">It will then be deleted from the server once all the deployment tasks are complete.</span></span>

## <a name="adding-an-appoffline-file-to-deployment-packages"></a><span data-ttu-id="68d9a-175">Hinzufügen einer App\_Offline-Datei zu Bereitstellungspaketen</span><span class="sxs-lookup"><span data-stu-id="68d9a-175">Adding an App\_Offline File to Deployment Packages</span></span>

<span data-ttu-id="68d9a-176">Je nachdem, wie Sie Ihre Bereitstellung konfigurieren, werden alle vorhandenen Inhalte am Ziel IIS Webanwendung&#x2014;wie die *App\_offline.htm* Datei&#x2014;möglicherweise automatisch gelöscht, wenn Sie ein Web deploy Paket an das Ziel.</span><span class="sxs-lookup"><span data-stu-id="68d9a-176">Depending on how you configure your deployment, any existing content at the destination IIS web application&#x2014;like the *App\_offline.htm* file&#x2014;may be deleted automatically when you deploy a web package to the destination.</span></span> <span data-ttu-id="68d9a-177">Um sicherzustellen, dass die *App\_offline.htm* Datei bleibt für die Dauer der Bereitstellung vorhanden, müssen Sie die Datei in das Webbereitstellungspaket selbst enthalten darüber hinaus die Datei direkt zu Beginn der Bereitstellung Der Bereitstellungsprozess.</span><span class="sxs-lookup"><span data-stu-id="68d9a-177">To ensure that the *App\_offline.htm* file remains in place for the duration of the deployment, you need to include the file within the web deployment package itself in addition to deploying the file directly at the start of the deployment process.</span></span>

- <span data-ttu-id="68d9a-178">Wenn Sie die vorherigen Aufgaben in diesem Thema ausgeführt haben, Sie werde hinzugefügt haben, die *App\_offline.htm* Datei zu Ihrem Webprojekt für die Anwendung unter einem anderen Dateinamen (verwendet *App\_ Offline-template.htm*) und haben legen Sie die Buildaktion auf **keine**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-178">If you've followed the previous tasks in this topic, you'll have added the *App\_offline.htm* file to your web application project under a different filename (we used *App\_offline-template.htm*) and you'll have set the build action to **None**.</span></span> <span data-ttu-id="68d9a-179">Diese Änderungen sind erforderlich, um zu verhindern, dass die Datei aus beeinträchtigen, bei der Entwicklung und Debuggen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-179">These changes are necessary to prevent the file from interfering with development and debugging.</span></span> <span data-ttu-id="68d9a-180">Daher müssen Sie zum Anpassen des Verpackungsprozesses, um sicherzustellen, dass die *App\_offline.htm* Datei in das Webbereitstellungspaket enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="68d9a-180">As a result, you need to customize the packaging process to ensure that the *App\_offline.htm* file is included in the web deployment package.</span></span>

<span data-ttu-id="68d9a-181">Die Web Publishing Pipeline (WPP) verwendet eine Elementliste mit dem Namen **FilesForPackagingFromProject** um eine Liste der Dateien zu erstellen, das in das Webbereitstellungspaket aufgenommen werden soll.</span><span class="sxs-lookup"><span data-stu-id="68d9a-181">The Web Publishing Pipeline (WPP) uses an item list named **FilesForPackagingFromProject** to build a list of files that should be included in the web deployment package.</span></span> <span data-ttu-id="68d9a-182">Sie können den Inhalt Ihrer Web-Pakete anpassen, indem Sie Ihre eigenen Artikel zu dieser Liste hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-182">You can customize the contents of your web packages by adding your own items to this list.</span></span> <span data-ttu-id="68d9a-183">Zu diesem Zweck müssen Sie die folgenden allgemeinen Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="68d9a-183">To do this, you need to complete these high-level steps:</span></span>

1. <span data-ttu-id="68d9a-184">Erstellen Sie eine benutzerdefinierte Projektdatei namens *[Projektname].wpp.targets* im gleichen Ordner wie die Projektdatei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-184">Create a custom project file named *[project name].wpp.targets* in the same folder as your project file.</span></span>

    > [!NOTE]
    > <span data-ttu-id="68d9a-185">Die *. wpp.targets* Datei muss im gleichen Ordner wie die Projektdatei Ihre Web-Anwendung&#x2014;z. B. *ContactManager.Mvc.csproj*&#x2014;nicht im gleichen Ordner wie die benutzerdefinierten die Projektdateien, die Sie verwenden, um den Build & Deployment-Prozess zu steuern.</span><span class="sxs-lookup"><span data-stu-id="68d9a-185">The *.wpp.targets* file needs to go in the same folder as your web application project file&#x2014;for example, *ContactManager.Mvc.csproj*&#x2014;rather than in the same folder as any custom project files you use to control the build and deployment process.</span></span>
2. <span data-ttu-id="68d9a-186">In der *. wpp.targets* Datei, erstellen Sie ein neues MSBuild-Ziel, die ausgeführt wird *vor* der **CopyAllFilesToSingleFolderForPackage** Ziel.</span><span class="sxs-lookup"><span data-stu-id="68d9a-186">In the *.wpp.targets* file, create a new MSBuild target that executes *before* the **CopyAllFilesToSingleFolderForPackage** target.</span></span> <span data-ttu-id="68d9a-187">Dies ist die WPP-Ziel, das eine Liste der Dinge, die im Paket enthalten erstellt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-187">This is the WPP target that builds a list of things to include in the package.</span></span>
3. <span data-ttu-id="68d9a-188">Erstellen Sie in das neue Ziel, eine **ItemGroup** Element.</span><span class="sxs-lookup"><span data-stu-id="68d9a-188">In the new target, create an **ItemGroup** element.</span></span>
4. <span data-ttu-id="68d9a-189">In der **ItemGroup** -Element, Hinzufügen einer **FilesForPackagingFromProject** Element aus, und geben Sie die *App\_offline.htm* Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-189">In the **ItemGroup** element, add a **FilesForPackagingFromProject** item and specify the *App\_offline.htm* file.</span></span>

<span data-ttu-id="68d9a-190">Die *. wpp.targets* Datei sollte diesem ähneln:</span><span class="sxs-lookup"><span data-stu-id="68d9a-190">The *.wpp.targets* file should resemble this:</span></span>


[!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample8.xml)]


<span data-ttu-id="68d9a-191">Dies sind die wichtigsten Punkte der Hinweis in diesem Beispiel:</span><span class="sxs-lookup"><span data-stu-id="68d9a-191">These are the key points of note in this example:</span></span>

- <span data-ttu-id="68d9a-192">Die **BeforeTargets** fügt Attribut dieses Ziel in die WPP vom angeben, die sie unmittelbar vor ausgeführt werden, sollte die **CopyAllFilesToSingleFolderForPackage** Ziel.</span><span class="sxs-lookup"><span data-stu-id="68d9a-192">The **BeforeTargets** attribute inserts this target into the WPP by specifying that it should be executed immediately before the **CopyAllFilesToSingleFolderForPackage** target.</span></span>
- <span data-ttu-id="68d9a-193">Die **FilesForPackagingFromProject** Element verwendet die **DestinationRelativePath** Metadatenwert umbenennen die Datei von *App\_offline template.htm* um *App\_offline.htm* zur Liste hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="68d9a-193">The **FilesForPackagingFromProject** item uses the **DestinationRelativePath** metadata value to rename the file from *App\_offline-template.htm* to *App\_offline.htm* as it's added to the list.</span></span>

<span data-ttu-id="68d9a-194">Im nächste Verfahren erfahren Sie, wie dies hinzufügen *. wpp.targets* Datei in ein Webanwendungsprojekt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-194">The next procedure shows you how to add this *.wpp.targets* file to a web application project.</span></span>

<span data-ttu-id="68d9a-195">**Hinzufügen einer. wpp.targets-Datei auf einem Webbereitstellungspaket**</span><span class="sxs-lookup"><span data-stu-id="68d9a-195">**To add a .wpp.targets file to a web deployment package**</span></span>

1. <span data-ttu-id="68d9a-196">Öffnen Sie die Projektmappe in Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="68d9a-196">Open your solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="68d9a-197">In der **Projektmappen-Explorer** Fenster mit der rechten Maustaste des Projektknoten der Web-Anwendung (z. B. **ContactManager.Mvc**), zeigen Sie auf **hinzufügen**, und klicken Sie dann auf **Neues Element**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-197">In the **Solution Explorer** window, right-click your web application project node (for example, **ContactManager.Mvc**), point to **Add**, and then click **New Item**.</span></span>
3. <span data-ttu-id="68d9a-198">In der **neues Element hinzufügen** wählen Sie im Dialogfeld die **XML-Datei** Vorlage.</span><span class="sxs-lookup"><span data-stu-id="68d9a-198">In the **Add New Item** dialog box, select the **XML File** template.</span></span>
4. <span data-ttu-id="68d9a-199">In der **Namen** geben \*[Projektname] \***.wpp.targets** (z. B. **ContactManager.Mvc.wpp.targets**), und klicken Sie dann auf **hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="68d9a-199">In the **Name** box, type *[project name]\*\*\*.wpp.targets*\* (for example, **ContactManager.Mvc.wpp.targets**), and then click **Add**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image4.png)

    > [!NOTE]
    > <span data-ttu-id="68d9a-200">Wenn Sie auf den Stammknoten eines Projekts ein neues Element hinzufügen, wird die Datei im gleichen Ordner wie die Projektdatei erstellt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-200">If you add a new item to the root node of a project, the file is created in the same folder as the project file.</span></span> <span data-ttu-id="68d9a-201">Sie können dies überprüfen, indem Sie den Ordner in Windows Explorer öffnen.</span><span class="sxs-lookup"><span data-stu-id="68d9a-201">You can verify this by opening the folder in Windows Explorer.</span></span>
5. <span data-ttu-id="68d9a-202">Fügen Sie in der Datei die MSBuild-Markup, das zuvor beschriebene hinzu.</span><span class="sxs-lookup"><span data-stu-id="68d9a-202">In the file, add the MSBuild markup described previously.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample9.xml)]
6. <span data-ttu-id="68d9a-203">Speichern und schließen Sie die *[Projektname].wpp.targets* Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-203">Save and close the *[project name].wpp.targets* file.</span></span>

<span data-ttu-id="68d9a-204">Das nächste Mal Build und das Paket das Webanwendungsprojekt, WPP erkennt automatisch die *. wpp.targets* Datei.</span><span class="sxs-lookup"><span data-stu-id="68d9a-204">The next time you build and package your web application project, the WPP will automatically detect the *.wpp.targets* file.</span></span> <span data-ttu-id="68d9a-205">Die *App\_offline template.htm* Datei enthält das resultierende Webbereitstellungspaket als *App\_offline.htm*.</span><span class="sxs-lookup"><span data-stu-id="68d9a-205">The *App\_offline-template.htm* file will be included in the resulting web deployment package as *App\_offline.htm*.</span></span>

> [!NOTE]
> <span data-ttu-id="68d9a-206">Wenn die Bereitstellung ein Fehler auftritt, die *App\_offline.htm* bleibt die Datei vorhanden und die Anwendung bleibt offline.</span><span class="sxs-lookup"><span data-stu-id="68d9a-206">If your deployment fails, the *App\_offline.htm* file will remain in place and your application will remain offline.</span></span> <span data-ttu-id="68d9a-207">Dies ist normalerweise das gewünschte Verhalten.</span><span class="sxs-lookup"><span data-stu-id="68d9a-207">This is typically the desired behavior.</span></span> <span data-ttu-id="68d9a-208">Um Ihre Anwendung zu bringen wieder online, können Sie löschen die *App\_offline.htm* Datei von Ihrem Webserver.</span><span class="sxs-lookup"><span data-stu-id="68d9a-208">To bring your application back online, you can delete the *App\_offline.htm* file from your web server.</span></span> <span data-ttu-id="68d9a-209">Sie können auch, wenn Sie alle Fehler zu beheben, und führen eine erfolgreiche Bereitstellung, die *App\_offline.htm* Datei wird entfernt.</span><span class="sxs-lookup"><span data-stu-id="68d9a-209">Alternatively, if you correct any errors and run a successful deployment, the *App\_offline.htm* file will be removed.</span></span>


## <a name="conclusion"></a><span data-ttu-id="68d9a-210">Schlussbemerkung</span><span class="sxs-lookup"><span data-stu-id="68d9a-210">Conclusion</span></span>

<span data-ttu-id="68d9a-211">In diesem Thema beschrieben, wie Sie eine Webanwendung für die Dauer einer Bereitstellung offline durch die Veröffentlichung einer *App\_offline.htm* Datei auf den Zielserver am Anfang des Bereitstellungsprozesses, und entfernen Sie sie auf der das Ende.</span><span class="sxs-lookup"><span data-stu-id="68d9a-211">This topic described how to take a web application offline for the duration of a deployment, by publishing an *App\_offline.htm* file to the destination server at the start of the deployment process and removing it at the end.</span></span> <span data-ttu-id="68d9a-212">Er erläutert auch, wie Sie enthalten eine *App\_offline.htm* -Datei in einem Webbereitstellungspaket.</span><span class="sxs-lookup"><span data-stu-id="68d9a-212">It also covered how to include an *App\_offline.htm* file in a web deployment package.</span></span>

## <a name="further-reading"></a><span data-ttu-id="68d9a-213">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="68d9a-213">Further Reading</span></span>

<span data-ttu-id="68d9a-214">Weitere Informationen zu den paketerstellungs- und Bereitstellungsprozess, finden Sie unter [erstellen und Verpacken von Webanwendungsprojekten](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Konfigurieren von Parametern für die Bereitstellung von Paket](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md), und [ Bereitstellen von Webpaketen](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span><span class="sxs-lookup"><span data-stu-id="68d9a-214">For more information on the packaging and deployment process, see [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Configuring Parameters for Web Package Deployment](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md), and [Deploying Web Packages](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span></span>

<span data-ttu-id="68d9a-215">Wenn Sie Ihre Webanwendungen direkt aus Visual Studio veröffentlichen, anstatt mit den benutzerdefinierten MSBuild-Projekt-Datei beschriebenen Ansatz in diesen Lernprogrammen, Sie müssen einen etwas anderen Ansatz zu verwenden, um Ihre Anwendung offline schalten, während der Veröffentlichung der Prozess.</span><span class="sxs-lookup"><span data-stu-id="68d9a-215">If you publish your web applications directly from Visual Studio, rather than using the custom MSBuild project file approach described in these tutorials, you'll need to use a slightly different approach to take your application offline during the publishing process.</span></span> <span data-ttu-id="68d9a-216">Weitere Informationen finden Sie unter [wie Sie Ihre Web-app während der Veröffentlichung](https://go.microsoft.com/?linkid=9805135) (Blogbeitrag).</span><span class="sxs-lookup"><span data-stu-id="68d9a-216">For more information, see [How to take your web app offline during publishing](https://go.microsoft.com/?linkid=9805135) (blog post).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="68d9a-217">[Zurück](excluding-files-and-folders-from-deployment.md)
> [Weiter](running-windows-powershell-scripts-from-msbuild-project-files.md)</span><span class="sxs-lookup"><span data-stu-id="68d9a-217">[Previous](excluding-files-and-folders-from-deployment.md)
[Next](running-windows-powershell-scripts-from-msbuild-project-files.md)</span></span>
