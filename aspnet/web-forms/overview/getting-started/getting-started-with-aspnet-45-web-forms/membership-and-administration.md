---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: Mitgliedschaft und Verwaltung | Microsoft-Dokumentation
author: Erikre
description: Diese tutorialreihe vermittelt Ihnen die Grundlagen zum Entwickeln einer ASP.net Web Forms Anwendung mit ASP.NET 4,5 und Microsoft Visual Studio Express 2013 für wir...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: ab00bc90bfc767d06e747be6dfb973245b5aae88
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78439929"
---
# <a name="membership-and-administration"></a><span data-ttu-id="1527e-103">Mitgliedschaft und Verwaltung</span><span class="sxs-lookup"><span data-stu-id="1527e-103">Membership and Administration</span></span>

<span data-ttu-id="1527e-104">von [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="1527e-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="1527e-105">[Herunterladen eines Wingtip Toys-C#Beispielprojekts ()](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) oder [Herunterladen von E-Book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="1527e-105">[Download Wingtip Toys Sample Project (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="1527e-106">Diese tutorialreihe vermittelt Ihnen die Grundlagen der Entwicklung einer ASP.net Web Forms-Anwendung mit ASP.NET 4,5 und Microsoft Visual Studio Express 2013 für das Web.</span><span class="sxs-lookup"><span data-stu-id="1527e-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="1527e-107">Für diese tutorialreihe steht ein Visual Studio 2013- [Projekt mit C# Quellcode](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="1527e-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="1527e-108">In diesem Tutorial wird gezeigt, wie Sie die Wingtip Toys-Beispielanwendung aktualisieren, um eine benutzerdefinierte Rolle hinzuzufügen und ASP.net Identity zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="1527e-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="1527e-109">Außerdem wird gezeigt, wie Sie eine Verwaltungsseite implementieren, von der der Benutzer mit einer benutzerdefinierten Rolle Produkte zur Website hinzufügen und daraus entfernen kann.</span><span class="sxs-lookup"><span data-stu-id="1527e-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="1527e-110">[ASP.net Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) ist das Mitgliedschaftssystem, das zum Erstellen der ASP.NET-Webanwendung verwendet wird, und ist in ASP.NET 4,5 verfügbar</span><span class="sxs-lookup"><span data-stu-id="1527e-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="1527e-111">ASP.net Identity wird in der Visual Studio 2013 Web Forms-Projektvorlage sowie in den Vorlagen für die [Einzelseiten Anwendung](../../../../single-page-application/index.md) [ASP.NET MVC](../../../../mvc/index.md), [ASP.net-Web-API](../../../../web-api/index.md)und ASP.NET verwendet.</span><span class="sxs-lookup"><span data-stu-id="1527e-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="1527e-112">Sie können das ASP.net Identity System auch speziell mithilfe von nuget installieren, wenn Sie mit einer leeren Webanwendung beginnen.</span><span class="sxs-lookup"><span data-stu-id="1527e-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="1527e-113">In dieser tutorialreihe verwenden Sie jedoch den **Web Forms**ProjectTemplate, der das ASP.net Identity System enthält.</span><span class="sxs-lookup"><span data-stu-id="1527e-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="1527e-114">Mit ASP.net Identity können benutzerspezifische Profildaten problemlos in Anwendungsdaten integriert werden.</span><span class="sxs-lookup"><span data-stu-id="1527e-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="1527e-115">Außerdem können Sie im ASP.NET Identity das Persistenzmodell für die Benutzerprofile in Ihrer Anwendung auswählen.</span><span class="sxs-lookup"><span data-stu-id="1527e-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="1527e-116">Sie können die Daten in einer SQL Server Datenbank oder einem anderen Datenspeicher speichern, einschließlich der *nosql* -Datenspeicher, z. b. Windows Azure Storage Tabellen.</span><span class="sxs-lookup"><span data-stu-id="1527e-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="1527e-117">Dieses Tutorial baut auf dem vorherigen Tutorial mit dem Titel "Checkout und Zahlung mit PayPal" in der Wingtip Toys-tutorialreihe auf.</span><span class="sxs-lookup"><span data-stu-id="1527e-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="1527e-118">Sie lernen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="1527e-118">What you'll learn:</span></span>

- <span data-ttu-id="1527e-119">Verwenden von Code, um der Anwendung eine benutzerdefinierte Rolle und einen Benutzer hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="1527e-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="1527e-120">Einschränken des Zugriffs auf den Verwaltungs Ordner und die Seite.</span><span class="sxs-lookup"><span data-stu-id="1527e-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="1527e-121">Bereitstellen der Navigation für den Benutzer, der zur benutzerdefinierten Rolle gehört.</span><span class="sxs-lookup"><span data-stu-id="1527e-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="1527e-122">Verwenden der Modell Bindung zum Auffüllen eines [Dropdown List](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) -Steuer Elements mit Produktkategorien.</span><span class="sxs-lookup"><span data-stu-id="1527e-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="1527e-123">Hochladen einer Datei in die Webanwendung mithilfe des [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) -Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="1527e-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="1527e-124">Verwenden von Validierungs Steuerelementen zum Implementieren der Eingabevalidierung.</span><span class="sxs-lookup"><span data-stu-id="1527e-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="1527e-125">Vorgehensweise beim Hinzufügen und Entfernen von Produkten aus der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="1527e-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="1527e-126">Diese Features sind im Tutorial enthalten:</span><span class="sxs-lookup"><span data-stu-id="1527e-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="1527e-127">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="1527e-127">ASP.NET Identity</span></span>
- <span data-ttu-id="1527e-128">Konfiguration und Autorisierung</span><span class="sxs-lookup"><span data-stu-id="1527e-128">Configuration and Authorization</span></span>
- <span data-ttu-id="1527e-129">Modellbindung</span><span class="sxs-lookup"><span data-stu-id="1527e-129">Model Binding</span></span>
- <span data-ttu-id="1527e-130">Unaufdringliche Validierung</span><span class="sxs-lookup"><span data-stu-id="1527e-130">Unobtrusive Validation</span></span>

<span data-ttu-id="1527e-131">ASP.net Web Forms bietet Mitgliedschafts Funktionen.</span><span class="sxs-lookup"><span data-stu-id="1527e-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="1527e-132">Mithilfe der Standardvorlage verfügen Sie über integrierte Mitgliedschafts Funktionen, die Sie sofort verwenden können, wenn die Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="1527e-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="1527e-133">In diesem Tutorial wird gezeigt, wie Sie mit ASP.net Identity eine benutzerdefinierte Rolle hinzufügen und dieser Rolle einen Benutzer zuweisen.</span><span class="sxs-lookup"><span data-stu-id="1527e-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="1527e-134">Sie erfahren, wie Sie den Zugriff auf den Ordner "Verwaltung" einschränken.</span><span class="sxs-lookup"><span data-stu-id="1527e-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="1527e-135">Sie fügen dem Ordnerverwaltung eine Seite hinzu, die einem Benutzer mit einer benutzerdefinierten Rolle das Hinzufügen und Entfernen von Produkten und das Anzeigen einer Vorschau eines Produkts ermöglicht, nachdem es hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="1527e-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="1527e-136">Hinzufügen einer benutzerdefinierten Rolle</span><span class="sxs-lookup"><span data-stu-id="1527e-136">Adding a Custom Role</span></span>

<span data-ttu-id="1527e-137">Mithilfe ASP.net Identity können Sie eine benutzerdefinierte Rolle hinzufügen und dieser Rolle mithilfe von Code einen Benutzer zuweisen.</span><span class="sxs-lookup"><span data-stu-id="1527e-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="1527e-138">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf den Ordner *Logic* , und erstellen Sie eine neue Klasse.</span><span class="sxs-lookup"><span data-stu-id="1527e-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="1527e-139">Nennen Sie die neue Klasse *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="1527e-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="1527e-140">Ändern Sie den Code so, dass er wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="1527e-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="1527e-141">Öffnen Sie in **Projektmappen-Explorer**die Datei *Global.asax.cs* .</span><span class="sxs-lookup"><span data-stu-id="1527e-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="1527e-142">Ändern Sie die *Global.asax.cs* -Datei, indem Sie den in gelb markierten Code hinzufügen, sodass er wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="1527e-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="1527e-143">Beachten Sie, dass `AddUserAndRole` rot unterstrichen ist.</span><span class="sxs-lookup"><span data-stu-id="1527e-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="1527e-144">Doppelklicken Sie auf den Code "adduserandrole".</span><span class="sxs-lookup"><span data-stu-id="1527e-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="1527e-145">Der Buchstabe "A" am Anfang der hervorgehobenen Methode wird unterstrichen.</span><span class="sxs-lookup"><span data-stu-id="1527e-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="1527e-146">Zeigen Sie auf den Buchstaben "A", und klicken Sie auf die Benutzeroberfläche, mit der Sie einen Methodenstub für die `AddUserAndRole`-Methode generieren können.</span><span class="sxs-lookup"><span data-stu-id="1527e-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![Mitgliedschaft und Administration-Methodenstub generieren](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="1527e-148">Klicken Sie auf die Option:</span><span class="sxs-lookup"><span data-stu-id="1527e-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="1527e-149">Öffnen Sie die Datei *RoleActions.cs* aus dem Ordner *Logic* .</span><span class="sxs-lookup"><span data-stu-id="1527e-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="1527e-150">Die `AddUserAndRole`-Methode wurde der-Klassendatei hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1527e-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="1527e-151">Ändern Sie die *RoleActions.cs* -Datei, indem Sie die `NotImplementedException` entfernen und den in gelb markierten Code hinzufügen, sodass Sie wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="1527e-151">Modify the *RoleActions.cs* file by removing the `NotImplementedException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="1527e-152">Der obige Code erstellt zunächst einen Daten Bank Kontext für die Mitgliedschafts Datenbank.</span><span class="sxs-lookup"><span data-stu-id="1527e-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="1527e-153">Die Mitgliedschafts Datenbank wird auch als *MDF* -Datei im Ordner *App\_Data* gespeichert.</span><span class="sxs-lookup"><span data-stu-id="1527e-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="1527e-154">Sie können diese Datenbank anzeigen, sobald sich der erste Benutzer bei dieser Webanwendung angemeldet hat.</span><span class="sxs-lookup"><span data-stu-id="1527e-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="1527e-155">Wenn Sie die Mitgliedschafts Daten zusammen mit den Produktdaten speichern möchten, können Sie die Verwendung desselben **dbcontext** in Erwägung gezogen haben, den Sie zum Speichern der Produktdaten im obigen Code verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="1527e-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>

 <span data-ttu-id="1527e-156">Das Schlüsselwort *internal* ist ein Zugriffsmodifizierer für Typen (z. b. Klassen) und Typmember (z. b. Methoden oder Eigenschaften).</span><span class="sxs-lookup"><span data-stu-id="1527e-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="1527e-157">Auf interne Typen oder Member kann nur innerhalb von Dateien zugegriffen werden, die in derselben Assembly *(dll* -Datei) enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="1527e-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="1527e-158">Wenn Sie die Anwendung erstellen, wird eine Assemblydatei *(. dll*) erstellt, die den Code enthält, der beim Ausführen der Anwendung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="1527e-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="1527e-159">Ein `RoleStore`-Objekt, das die Rollen Verwaltung bereitstellt, wird basierend auf dem Daten Bank Kontext erstellt.</span><span class="sxs-lookup"><span data-stu-id="1527e-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1527e-160">Beachten Sie, dass beim Erstellen des `RoleStore` Objekts ein generischer `IdentityRole` Typ verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="1527e-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="1527e-161">Dies bedeutet, dass der `RoleStore` nur `IdentityRole` Objekte enthalten darf.</span><span class="sxs-lookup"><span data-stu-id="1527e-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="1527e-162">Außerdem werden Ressourcen im Arbeitsspeicher durch die Verwendung von Generika besser verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="1527e-162">Also by using Generics, resources in memory are handled better.</span></span>

<span data-ttu-id="1527e-163">Als nächstes wird das `RoleManager`-Objekt auf Grundlage des soeben erstellten `RoleStore` Objekts erstellt.</span><span class="sxs-lookup"><span data-stu-id="1527e-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="1527e-164">Das `RoleManager`-Objekt macht eine Rollen bezogene API verfügbar, die zum automatischen Speichern von Änderungen am `RoleStore`verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="1527e-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="1527e-165">Der `RoleManager` darf nur `IdentityRole` Objekte enthalten, da der Code den `<IdentityRole>` generischen Typ verwendet.</span><span class="sxs-lookup"><span data-stu-id="1527e-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="1527e-166">Sie können die `RoleExists`-Methode aufzurufen, um zu bestimmen, ob die Rolle "CanEdit" in der Mitgliedschafts Datenbank vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="1527e-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="1527e-167">Wenn dies nicht der Fall ist, erstellen Sie die Rolle.</span><span class="sxs-lookup"><span data-stu-id="1527e-167">If it is not, you create the role.</span></span>

<span data-ttu-id="1527e-168">Das Erstellen des `UserManager` Objekts scheint komplizierter als das `RoleManager` Steuerelement, aber es ist beinahe identisch.</span><span class="sxs-lookup"><span data-stu-id="1527e-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="1527e-169">Sie ist nur in einer Zeile und nicht in mehreren codiert.</span><span class="sxs-lookup"><span data-stu-id="1527e-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="1527e-170">Hier wird der Parameter, den Sie übergeben, als neues Objekt instanziiert, das in der Klammer enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="1527e-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="1527e-171">Als Nächstes erstellen Sie den Benutzer "canedituser", indem Sie ein neues `ApplicationUser` Objekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="1527e-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="1527e-172">Wenn Sie den Benutzer erfolgreich erstellt haben, fügen Sie den Benutzer der neuen Rolle hinzu.</span><span class="sxs-lookup"><span data-stu-id="1527e-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="1527e-173">Die Fehlerbehandlung wird später in dieser tutorialreihe im Tutorial "ASP.net Error Handling" (Fehlerbehandlung für Fehler) aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="1527e-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>

<span data-ttu-id="1527e-174">Wenn die Anwendung das nächste Mal gestartet wird, wird der Benutzer mit dem Namen "canedituser" der Rolle "CanEdit" der Anwendung hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1527e-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="1527e-175">Später in diesem Tutorial melden Sie sich als "canedituser"-Benutzer an, um zusätzliche Funktionen anzuzeigen, die Sie in diesem Tutorial hinzufügen werden.</span><span class="sxs-lookup"><span data-stu-id="1527e-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="1527e-176">API-Details zu ASP.net Identity finden Sie im [Microsoft. Aspnet. Identity-Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="1527e-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="1527e-177">Weitere Informationen zum Initialisieren des ASP.net Identity Systems finden Sie unter [aspnettidentitysample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="1527e-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="1527e-178">Einschränken des Zugriffs auf die Verwaltungsseite</span><span class="sxs-lookup"><span data-stu-id="1527e-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="1527e-179">Mit der Wingtip Toys-Beispielanwendung können anonyme Benutzer und angemeldete Benutzer Produkte anzeigen und erwerben.</span><span class="sxs-lookup"><span data-stu-id="1527e-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="1527e-180">Der angemeldete Benutzer, der über die benutzerdefinierte Rolle "CanEdit" verfügt, kann jedoch auf eine eingeschränkte Seite zugreifen, um Produkte hinzuzufügen und zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="1527e-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="1527e-181">Hinzufügen eines Verwaltungs Ordners und einer Seite</span><span class="sxs-lookup"><span data-stu-id="1527e-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="1527e-182">Als Nächstes erstellen Sie einen Ordner mit dem Namen " *Admin* " für den Benutzer "canedituser", der zur benutzerdefinierten Rolle der Wingtip Toys-Beispielanwendung gehört.</span><span class="sxs-lookup"><span data-stu-id="1527e-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="1527e-183">Klicken Sie in **Projektmappen-Explorer** mit der rechten Maustaste auf den Projektnamen (**Wingtip Toys**), und wählen Sie -&gt; **neuen Ordner** **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="1527e-184">Benennen Sie den neuen Ordner *Administrator*.</span><span class="sxs-lookup"><span data-stu-id="1527e-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="1527e-185">Klicken Sie mit der rechten Maustaste auf den Ordner *Admin* , und wählen Sie -&gt; **Neues Element** **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="1527e-186">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1527e-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="1527e-187">Wählen Sie auf der linken Seite die Gruppe <strong>Visual C#</strong> -&gt; <strong>Web</strong> Templates aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="1527e-188">Wählen Sie in der mittleren Liste <strong>Web Form mit Master Seite</strong>aus, nennen Sie es " <em>adminpage. aspx</em>"<strong>,</strong> und wählen Sie dann <strong>Hinzufügen</strong>aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="1527e-189">Wählen Sie die Datei *Site. Master* als Master Seite aus, und klicken Sie dann auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="1527e-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="1527e-190">Fügen Sie eine Web. config-Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="1527e-190">Add a Web.config File</span></span>

<span data-ttu-id="1527e-191">Indem Sie dem *Administrator* Ordner eine *Web. config* -Datei hinzufügen, können Sie den Zugriff auf die im Ordner enthaltene Seite einschränken.</span><span class="sxs-lookup"><span data-stu-id="1527e-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="1527e-192">Klicken Sie mit der rechten Maustaste auf den Ordner *Admin* , und wählen Sie -&gt; **Neues Element** **Hinzufügen**</span><span class="sxs-lookup"><span data-stu-id="1527e-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="1527e-193">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1527e-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="1527e-194">Wählen Sie in der Liste C# der visuellen Webvorlagen die Option <strong>Webkonfigurationsdatei</strong>aus der mittleren Liste aus, übernehmen Sie den Standardnamen " <em>Web. config</em>"<strong>,</strong> und wählen Sie dann <strong>Hinzufügen</strong>aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="1527e-195">Ersetzen Sie den vorhandenen XML-Inhalt in der Datei *Web.config* durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="1527e-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="1527e-196">Speichern Sie die Datei *Web.config* .</span><span class="sxs-lookup"><span data-stu-id="1527e-196">Save the *Web.config* file.</span></span> <span data-ttu-id="1527e-197">Die Datei " *Web. config* " gibt an, dass nur der Benutzer, der der Rolle "CanEdit" der Anwendung angehört, auf die im *Administrator* Ordner enthaltene Seite zugreifen kann.</span><span class="sxs-lookup"><span data-stu-id="1527e-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="1527e-198">Einschließen der benutzerdefinierten Rollen Navigation</span><span class="sxs-lookup"><span data-stu-id="1527e-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="1527e-199">Um dem Benutzer der benutzerdefinierten Rolle "CanEdit" die Navigation zum Abschnitt Verwaltung der Anwendung zu ermöglichen, müssen Sie der Seite *Site. Master* einen Link hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="1527e-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="1527e-200">Nur Benutzer, die der Rolle "CanEdit" angehören, können den **Administrator** Link sehen und auf den Abschnitt "Verwaltung" zugreifen.</span><span class="sxs-lookup"><span data-stu-id="1527e-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="1527e-201">Suchen und öffnen Sie in Projektmappen-Explorer die Seite *Site. Master* .</span><span class="sxs-lookup"><span data-stu-id="1527e-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="1527e-202">Um einen Link für den Benutzer der Rolle "CanEdit" zu erstellen, fügen Sie das in gelber hervorgehobene Markup der folgenden ungeordneten Liste `<ul>`-Elements hinzu, sodass die Liste wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="1527e-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="1527e-203">Öffnen Sie die Datei *Site.Master.cs* .</span><span class="sxs-lookup"><span data-stu-id="1527e-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="1527e-204">Legen Sie den **Admin** -Link nur für den Benutzer "canedituser" sichtbar, indem Sie den in gelb markierten Code dem `Page_Load`-Handler hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="1527e-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="1527e-205">Der `Page_Load`-Handler wird wie folgt angezeigt:</span><span class="sxs-lookup"><span data-stu-id="1527e-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="1527e-206">Wenn die Seite geladen wird, überprüft der Code, ob der angemeldete Benutzer die Rolle "CanEdit" hat.</span><span class="sxs-lookup"><span data-stu-id="1527e-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="1527e-207">Wenn der Benutzer der Rolle "CanEdit" angehört, wird das Span-Element, das den Link zur *adminpage. aspx* -Seite enthält (und folglich der Link in der Spanne), sichtbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="1527e-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="1527e-208">Aktivieren der Produktverwaltung</span><span class="sxs-lookup"><span data-stu-id="1527e-208">Enabling Product Administration</span></span>

<span data-ttu-id="1527e-209">Bisher haben Sie die Rolle "CanEdit" erstellt und einen "canedituser"-Benutzer, einen Verwaltungs Ordner und eine Verwaltungsseite hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1527e-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="1527e-210">Sie haben Zugriffsrechte für den Ordner und die Seite Verwaltung festgelegt und einen Navigations Link für den Benutzer der Rolle "CanEdit" zur Anwendung hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1527e-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="1527e-211">Als Nächstes fügen Sie der *adminpage. aspx* -Seite Markup und Code der *AdminPage.aspx.cs* -Code Behind-Datei hinzu, die dem Benutzer mit der Rolle "CanEdit" das Hinzufügen und Entfernen von Produkten ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="1527e-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="1527e-212">Öffnen Sie in **Projektmappen-Explorer**die Datei " *adminpage. aspx* " aus dem Ordner " *Admin* ".</span><span class="sxs-lookup"><span data-stu-id="1527e-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="1527e-213">Ersetzen Sie das vorhandene Markup durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="1527e-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="1527e-214">Öffnen Sie anschließend die *AdminPage.aspx.cs* -Code Behind-Datei, indem Sie mit der rechten Maustaste auf die Datei " *adminpage. aspx* " klicken und dann **auf Code anzeigen**</span><span class="sxs-lookup"><span data-stu-id="1527e-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="1527e-215">Ersetzen Sie den vorhandenen Code in der Code Behind-Datei *AdminPage.aspx.cs* durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="1527e-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="1527e-216">In dem Code, den Sie für die *AdminPage.aspx.cs* -Code-Behind-Datei eingegeben haben, bewirkt eine Klasse mit dem Namen `AddProducts`, dass der Datenbank Produkte hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="1527e-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="1527e-217">Diese Klasse ist noch nicht vorhanden, sodass Sie Sie jetzt erstellen.</span><span class="sxs-lookup"><span data-stu-id="1527e-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="1527e-218">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf den Ordner *Logic* , und wählen Sie dann -&gt; **Neues Element** **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="1527e-219">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1527e-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="1527e-220">Wählen Sie auf der linken Seite die Gruppe **Visual C#**  -&gt; **Code** Templates aus.</span><span class="sxs-lookup"><span data-stu-id="1527e-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="1527e-221">Wählen Sie dann in der mittleren Liste **Klasse**aus, und nennen Sie Sie *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="1527e-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="1527e-222">Die neue Klassendatei wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1527e-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="1527e-223">Ersetzen Sie den vorhandenen Code durch folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="1527e-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="1527e-224">Die Seite " *adminpage. aspx* " ermöglicht dem Benutzer, der zur Rolle "CanEdit" gehört, das Hinzufügen und Entfernen von Produkten.</span><span class="sxs-lookup"><span data-stu-id="1527e-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="1527e-225">Wenn ein neues Produkt hinzugefügt wird, werden die Details zum Produkt überprüft und dann in die Datenbank eingegeben.</span><span class="sxs-lookup"><span data-stu-id="1527e-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="1527e-226">Das neue Produkt ist sofort für alle Benutzer der Webanwendung verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1527e-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="1527e-227">Unaufdringliche Validierung</span><span class="sxs-lookup"><span data-stu-id="1527e-227">Unobtrusive Validation</span></span>

<span data-ttu-id="1527e-228">Die Produktdetails, die der Benutzer auf der Seite " *adminpage. aspx* " bereitstellt, werden mithilfe von Validierungs Steuerelementen (`RequiredFieldValidator` und `RegularExpressionValidator`) überprüft.</span><span class="sxs-lookup"><span data-stu-id="1527e-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="1527e-229">Diese Steuerelemente verwenden automatisch unaufdringliche Validierung.</span><span class="sxs-lookup"><span data-stu-id="1527e-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="1527e-230">Die unaufdringliche Validierung ermöglicht es den Validierungs Steuerelementen, JavaScript für die Client seitige Validierungs Logik zu verwenden. Dies bedeutet, dass für die Seite keine Überprüfung auf dem Server erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="1527e-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="1527e-231">Standardmäßig ist die unaufdringliche Validierung in der Datei " *Web. config* " basierend auf der folgenden Konfigurationseinstellung enthalten:</span><span class="sxs-lookup"><span data-stu-id="1527e-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="1527e-232">Reguläre Ausdrücke</span><span class="sxs-lookup"><span data-stu-id="1527e-232">Regular Expressions</span></span>

<span data-ttu-id="1527e-233">Der Produkt Preis auf der Seite " *adminpage. aspx* " wird mithilfe eines **RegularExpressionValidator** -Steuer Elements überprüft.</span><span class="sxs-lookup"><span data-stu-id="1527e-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="1527e-234">Dieses Steuerelement überprüft, ob der Wert des zugeordneten Eingabe Steuer Elements (das Textfeld "addproductprice") mit dem vom regulären Ausdruck angegebenen Muster übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="1527e-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="1527e-235">Ein regulärer Ausdruck ist eine Muster Vergleichs Notation, die es Ihnen ermöglicht, bestimmte Zeichen Muster schnell zu finden und abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="1527e-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="1527e-236">Das **RegularExpressionValidator** -Steuerelement enthält eine Eigenschaft mit dem Namen `ValidationExpression`, die den regulären Ausdruck enthält, der zum Überprüfen der Preis Eingabe verwendet wird, wie unten dargestellt:</span><span class="sxs-lookup"><span data-stu-id="1527e-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="1527e-237">FileUpload-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="1527e-237">FileUpload Control</span></span>

<span data-ttu-id="1527e-238">Zusätzlich zu den Eingabe-und Validierungs Steuerelementen haben Sie das **FileUpload** -Steuerelement der Seite " *adminpage. aspx* " hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1527e-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="1527e-239">Dieses Steuerelement bietet die Möglichkeit, Dateien hochzuladen.</span><span class="sxs-lookup"><span data-stu-id="1527e-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="1527e-240">In diesem Fall können Sie nur Bilddateien hochladen.</span><span class="sxs-lookup"><span data-stu-id="1527e-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="1527e-241">Wenn Sie in der Code Behind-Datei (*AdminPage.aspx.cs*) auf den `AddProductButton` klicken, überprüft der Code die `HasFile`-Eigenschaft des **FileUpload** -Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="1527e-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="1527e-242">Wenn das Steuerelement über eine Datei verfügt und der Dateityp (basierend auf der Dateierweiterung) zulässig ist, wird das Bild im Ordner *Images* und im Ordner *Images/Thumbs* der Anwendung gespeichert.</span><span class="sxs-lookup"><span data-stu-id="1527e-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="1527e-243">Modellbindung</span><span class="sxs-lookup"><span data-stu-id="1527e-243">Model Binding</span></span>

<span data-ttu-id="1527e-244">Weiter oben in dieser tutorialreihe haben Sie die Modell Bindung zum Auffüllen eines **ListView** -Steuer Elements, eines **formsview** -Steuer Elements, eines **GridView** -Steuer Elements und eines **DetailView** -Steuer Elements verwendet.</span><span class="sxs-lookup"><span data-stu-id="1527e-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="1527e-245">In diesem Tutorial verwenden Sie die Modell Bindung, um ein **Dropdown List** -Steuerelement mit einer Liste von Produktkategorien aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="1527e-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="1527e-246">Das Markup, das Sie der Datei " *adminpage. aspx* " hinzugefügt haben, enthält ein **Dropdown List** -Steuerelement mit dem Namen `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="1527e-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="1527e-247">Mithilfe der Modell Bindung füllen Sie diese **Dropdown Liste** aus, indem Sie das `ItemType`-Attribut und das `SelectMethod`-Attribut festlegen.</span><span class="sxs-lookup"><span data-stu-id="1527e-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="1527e-248">Das `ItemType`-Attribut gibt an, dass Sie beim Auffüllen des-Steuer Elements den `WingtipToys.Models.Category`-Typ verwenden.</span><span class="sxs-lookup"><span data-stu-id="1527e-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="1527e-249">Sie haben diesen Typ am Anfang dieser tutorialreihe definiert, indem Sie die `Category`-Klasse erstellen (siehe unten).</span><span class="sxs-lookup"><span data-stu-id="1527e-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="1527e-250">Die `Category`-Klasse befindet sich im Ordner " *Models* " in der Datei " *Category.cs* ".</span><span class="sxs-lookup"><span data-stu-id="1527e-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="1527e-251">Das `SelectMethod`-Attribut des **DropDownList** -Steuer Elements gibt an, dass Sie die `GetCategories`-Methode (unten dargestellt) verwenden, die in der Code-Behind-Datei (*AdminPage.aspx.cs*) enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="1527e-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="1527e-252">Diese Methode gibt an, dass eine `IQueryable`-Schnittstelle verwendet wird, um eine Abfrage für einen `Category` Typ auszuwerten.</span><span class="sxs-lookup"><span data-stu-id="1527e-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="1527e-253">Der zurückgegebene Wert wird verwendet, um die **Dropdown List** im Markup der Seite ("*adminpage. aspx*") aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="1527e-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="1527e-254">Der Text, der für jedes Element in der Liste angezeigt wird, wird durch Festlegen des `DataTextField` Attributs angegeben.</span><span class="sxs-lookup"><span data-stu-id="1527e-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="1527e-255">Das `DataTextField`-Attribut verwendet die `CategoryName` der `Category`-Klasse (siehe oben), um jede Kategorie im **DropDownList** -Steuerelement anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="1527e-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="1527e-256">Der tatsächliche Wert, der beim Auswählen eines Elements im **DropDownList** -Steuerelement weitergegeben wird, basiert auf dem `DataValueField`-Attribut.</span><span class="sxs-lookup"><span data-stu-id="1527e-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="1527e-257">Das `DataValueField`-Attribut wird auf die `CategoryID` festgelegt, wie in der `Category`-Klasse definiert (siehe oben).</span><span class="sxs-lookup"><span data-stu-id="1527e-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="1527e-258">Funktionsweise der Anwendung</span><span class="sxs-lookup"><span data-stu-id="1527e-258">How the Application Will Work</span></span>

<span data-ttu-id="1527e-259">Wenn der Benutzer, der zur Rolle "CanEdit" gehört, zum ersten Mal zu der Seite navigiert, wird das `DropDownAddCategory`**DropDownList** -Steuerelement wie oben beschrieben aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="1527e-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="1527e-260">Das `DropDownRemoveProduct`**DropDownList** -Steuerelement wird auch mit Produkten aufgefüllt, die denselben Ansatz verwenden.</span><span class="sxs-lookup"><span data-stu-id="1527e-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="1527e-261">Der Benutzer, der zur Rolle "CanEdit" gehört, wählt den Kategorietyp aus und fügt Produktdetails (**Name**, **Beschreibung**, **Preis**und **Bilddatei**) hinzu.</span><span class="sxs-lookup"><span data-stu-id="1527e-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="1527e-262">Wenn der Benutzer, der der Rolle "CanEdit" angehört, auf die Schaltfläche " **Produkt hinzufügen** " klickt, wird der `AddProductButton_Click` Ereignishandler ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="1527e-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="1527e-263">Der `AddProductButton_Click`-Ereignishandler in der Code Behind-Datei (*AdminPage.aspx.cs*) prüft die Bilddatei, um sicherzustellen, dass Sie den zulässigen Dateitypen *(GIF*, *PNG*, *JPEG*oder *JPG*) entspricht.</span><span class="sxs-lookup"><span data-stu-id="1527e-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="1527e-264">Anschließend wird die Bilddatei in einem Ordner der Wingtip Toys-Beispielanwendung gespeichert.</span><span class="sxs-lookup"><span data-stu-id="1527e-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="1527e-265">Anschließend wird das neue Produkt der Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="1527e-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="1527e-266">Um das Hinzufügen eines neuen Produkts zu erreichen, wird eine neue Instanz der `AddProducts`-Klasse erstellt und benannte Produkte.</span><span class="sxs-lookup"><span data-stu-id="1527e-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="1527e-267">Die `AddProducts`-Klasse verfügt über eine Methode mit dem Namen `AddProduct`, und das Products-Objekt ruft diese Methode auf, um der Datenbank Produkte hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="1527e-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="1527e-268">Wenn der Code das neue Produkt der Datenbank erfolgreich hinzufügt, wird die Seite mit dem Wert `ProductAction=add`der Abfrage Zeichenfolge erneut geladen.</span><span class="sxs-lookup"><span data-stu-id="1527e-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="1527e-269">Wenn die Seite erneut geladen wird, ist die Abfrage Zeichenfolge in der URL enthalten.</span><span class="sxs-lookup"><span data-stu-id="1527e-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="1527e-270">Durch erneutes Laden der Seite kann der Benutzer, der der Rolle "CanEdit" angehört, die Aktualisierungen in den **Dropdown List** -Steuerelementen auf der Seite " *adminpage. aspx* " sofort sehen.</span><span class="sxs-lookup"><span data-stu-id="1527e-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="1527e-271">Durch einschließen der Abfrage Zeichenfolge mit der URL kann die Seite auch eine Erfolgsmeldung für den Benutzer anzeigen, der zur Rolle "CanEdit" gehört.</span><span class="sxs-lookup"><span data-stu-id="1527e-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="1527e-272">Wenn die *adminpage. aspx* -Seite erneut geladen wird, wird das `Page_Load`-Ereignis aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="1527e-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="1527e-273">Der `Page_Load`-Ereignishandler überprüft den Wert der Abfrage Zeichenfolge und bestimmt, ob eine Erfolgsmeldung angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="1527e-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="1527e-274">Ausführen der Anwendung</span><span class="sxs-lookup"><span data-stu-id="1527e-274">Running the Application</span></span>

<span data-ttu-id="1527e-275">Sie können die Anwendung jetzt ausführen, um zu erfahren, wie Sie Elemente im Warenkorb hinzufügen, löschen und aktualisieren können.</span><span class="sxs-lookup"><span data-stu-id="1527e-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="1527e-276">Der Einkaufswagen Gesamt zeigt die Gesamtkosten aller Produkte im Warenkorb an.</span><span class="sxs-lookup"><span data-stu-id="1527e-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="1527e-277">Drücken Sie in Projektmappen-Explorer **F5** , um die Beispielanwendung Wingtip Toys auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1527e-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="1527e-278">Der Browser wird geöffnet und zeigt die Seite *default. aspx* an.</span><span class="sxs-lookup"><span data-stu-id="1527e-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="1527e-279">Klicken Sie oben auf der Seite auf den Link **Anmelden** .</span><span class="sxs-lookup"><span data-stu-id="1527e-279">Click the **Log in** link at the top of the page.</span></span> 

    ![Mitgliedschaft und Verwaltung: Anmelde Link](membership-and-administration/_static/image2.png)

   <span data-ttu-id="1527e-281">Die Seite *Login. aspx* wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="1527e-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="1527e-282">Verwenden Sie den folgenden Benutzernamen und das Kennwort:</span><span class="sxs-lookup"><span data-stu-id="1527e-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="1527e-283">Benutzername: canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="1527e-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="1527e-284">Kennwort: PA $ $Word 1</span><span class="sxs-lookup"><span data-stu-id="1527e-284">Password: Pa$$word1</span></span> 

    ![Mitgliedschaft und Verwaltung-Anmeldeseite](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="1527e-286">Klicken Sie am unteren Rand der Seite auf die Schaltfläche **Anmelden** .</span><span class="sxs-lookup"><span data-stu-id="1527e-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="1527e-287">Klicken Sie oben auf der nächsten Seite auf den Link **Admin** , um zur Seite *adminpage. aspx* zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="1527e-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![Mitgliedschaft und Verwaltung-Administrator Link](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="1527e-289">Um die Eingabevalidierung zu testen, klicken Sie auf die Schaltfläche **Produkt hinzufügen** , ohne Produktdetails hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="1527e-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![Mitgliedschaft und Administration: Administrator Seite](membership-and-administration/_static/image5.png)

   <span data-ttu-id="1527e-291">Beachten Sie, dass die erforderlichen Feld Meldungen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="1527e-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="1527e-292">Fügen Sie die Details für ein neues Produkt hinzu, und klicken Sie dann auf die Schaltfläche **Produkt hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="1527e-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![Mitgliedschaft und Verwaltung-Produkt hinzufügen](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="1527e-294">Wählen Sie im oberen Navigationsmenü die Option **Produkte** aus, um das neu hinzugefügte Produkt anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="1527e-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![Mitgliedschaft und Administration-neues Produktanzeigen](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="1527e-296">Klicken Sie auf den Link **Admin** , um zur Verwaltungsseite zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="1527e-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="1527e-297">Wählen Sie im Abschnitt **Produkt entfernen** der Seite das neue Produkt aus, das Sie in **dropdownlistbox**hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="1527e-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="1527e-298">Klicken Sie auf die Schaltfläche **Produkt entfernen** , um das neue Produkt aus der Anwendung zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="1527e-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![Mitgliedschaft und Verwaltung-Produkt entfernen](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="1527e-300">Wählen Sie im oberen Navigationsmenü die Option **Produkte** aus, um zu bestätigen, dass das Produkt entfernt wurde.</span><span class="sxs-lookup"><span data-stu-id="1527e-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="1527e-301">Klicken Sie auf für den existierenden Verwaltungsmodus **Abmelden** .</span><span class="sxs-lookup"><span data-stu-id="1527e-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="1527e-302">Beachten Sie, dass im oberen Navigationsbereich nicht mehr das Menü Element **Admin** angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="1527e-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="1527e-303">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="1527e-303">Summary</span></span>

<span data-ttu-id="1527e-304">In diesem Tutorial haben Sie eine benutzerdefinierte Rolle und einen Benutzer hinzugefügt, der zur benutzerdefinierten Rolle gehört, den Zugriff auf den Verwaltungs Ordner und die Seite eingeschränkt und die Navigation für den Benutzer bereitgestellt hat, der zur benutzerdefinierten Rolle gehört.</span><span class="sxs-lookup"><span data-stu-id="1527e-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="1527e-305">Sie haben die Modell Bindung verwendet, um ein **Dropdown List** -Steuerelement mit Daten aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="1527e-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="1527e-306">Sie haben das **FileUpload** -Steuerelement und Validierungs Steuerelemente implementiert.</span><span class="sxs-lookup"><span data-stu-id="1527e-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="1527e-307">Außerdem haben Sie erfahren, wie Sie Produkte zu einer Datenbank hinzufügen und daraus entfernen.</span><span class="sxs-lookup"><span data-stu-id="1527e-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="1527e-308">Im nächsten Tutorial erfahren Sie, wie Sie das ASP.NET-Routing implementieren.</span><span class="sxs-lookup"><span data-stu-id="1527e-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="1527e-309">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="1527e-309">Additional Resources</span></span>

<span data-ttu-id="1527e-310">[Web. config-Authorization-Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="1527e-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="1527e-311">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="1527e-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="1527e-312">Bereitstellen einer sicheren ASP.net-Web Forms-App mit Mitgliedschaft, OAuth und SQL-Datenbank auf einer Azure-Website</span><span class="sxs-lookup"><span data-stu-id="1527e-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="1527e-313">Kostenlose Testversion Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="1527e-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="1527e-314">[Zurück](checkout-and-payment-with-paypal.md)
> [Weiter](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="1527e-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
