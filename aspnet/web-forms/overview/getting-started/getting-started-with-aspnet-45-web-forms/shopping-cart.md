---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart
title: Warenkorb | Microsoft-Dokumentation
author: Erikre
description: Diese tutorialreihe vermittelt Ihnen die Grundlagen zum Entwickeln einer ASP.net Web Forms Anwendung mit ASP.NET 4,5 und Microsoft Visual Studio Express 2013 für wir...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 6898c601-6c31-432f-8388-e6843f8a17cb
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart
msc.type: authoredcontent
ms.openlocfilehash: d3b619ebd9448d30857ffbaf17fd245b1d54a662
ms.sourcegitcommit: 88fc80e3f65aebdf61ec9414810ddbc31c543f04
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/22/2020
ms.locfileid: "76519296"
---
# <a name="shopping-cart"></a><span data-ttu-id="7dc1b-103">Einkaufswagen</span><span class="sxs-lookup"><span data-stu-id="7dc1b-103">Shopping Cart</span></span>

<span data-ttu-id="7dc1b-104">von [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="7dc1b-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="7dc1b-105">[Herunterladen eines Wingtip Toys-C#Beispielprojekts ()](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) oder [Herunterladen von E-Book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="7dc1b-105">[Download Wingtip Toys Sample Project (C#)](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](https://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="7dc1b-106">Diese tutorialreihe vermittelt Ihnen die Grundlagen der Entwicklung einer ASP.net Web Forms-Anwendung mit ASP.NET 4,5 und Microsoft Visual Studio Express 2013 für das Web.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="7dc1b-107">Für diese tutorialreihe steht ein Visual Studio 2013- [Projekt mit C# Quellcode](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>

<span data-ttu-id="7dc1b-108">In diesem Tutorial wird die Geschäftslogik beschrieben, die zum Hinzufügen eines Einkaufswagen zum Beispiel ASP.net Web Forms Anwendung Wingtip Toys erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-108">This tutorial describes the business logic required to add a shopping cart to the Wingtip Toys sample ASP.NET Web Forms application.</span></span> <span data-ttu-id="7dc1b-109">Dieses Tutorial baut auf dem vorherigen Tutorial "Anzeigen von Datenelementen und-Details" auf und ist Teil der Wingtip Toy Store-tutorialreihe.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-109">This tutorial builds on the previous tutorial "Display Data Items and Details" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="7dc1b-110">Wenn Sie dieses Tutorial abgeschlossen haben, können die Benutzer ihrer Beispiel-APP die Produkte in Ihrem Warenkorb hinzufügen, entfernen und ändern.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-110">When you've completed this tutorial, the users of your sample app will be able to add, remove, and modify the products in their shopping cart.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="7dc1b-111">Sie lernen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-111">What you'll learn:</span></span>

1. <span data-ttu-id="7dc1b-112">Erstellen eines Einkaufswagen für die Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-112">How to create a shopping cart for the web application.</span></span>
2. <span data-ttu-id="7dc1b-113">Hiermit wird Benutzern das Hinzufügen von Elementen zum Warenkorb ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-113">How to enable users to add items to the shopping cart.</span></span>
3. <span data-ttu-id="7dc1b-114">Hinzufügen eines [GridView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview(v=vs.110).aspx#introduction) -Steuer Elements zum Anzeigen von Einkaufswagen Details</span><span class="sxs-lookup"><span data-stu-id="7dc1b-114">How to add a [GridView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview(v=vs.110).aspx#introduction) control to display shopping cart details.</span></span>
4. <span data-ttu-id="7dc1b-115">Berechnen und Anzeigen der Bestellsumme.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-115">How to calculate and display the order total.</span></span>
5. <span data-ttu-id="7dc1b-116">Entfernen und Aktualisieren von Elementen im Warenkorb</span><span class="sxs-lookup"><span data-stu-id="7dc1b-116">How to remove and update items in the shopping cart.</span></span>
6. <span data-ttu-id="7dc1b-117">Einschließen eines Einkaufswagen Zählers</span><span class="sxs-lookup"><span data-stu-id="7dc1b-117">How to include a shopping cart counter.</span></span>

## <a name="code-features-in-this-tutorial"></a><span data-ttu-id="7dc1b-118">Code Funktionen in diesem Tutorial:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-118">Code features in this tutorial:</span></span>

1. <span data-ttu-id="7dc1b-119">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="7dc1b-119">Entity Framework Code First</span></span>
2. <span data-ttu-id="7dc1b-120">Datenanmerkungen</span><span class="sxs-lookup"><span data-stu-id="7dc1b-120">Data Annotations</span></span>
3. <span data-ttu-id="7dc1b-121">Stark typisierte Daten Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="7dc1b-121">Strongly typed data controls</span></span>
4. <span data-ttu-id="7dc1b-122">Modellbindung</span><span class="sxs-lookup"><span data-stu-id="7dc1b-122">Model binding</span></span>

## <a name="creating-a-shopping-cart"></a><span data-ttu-id="7dc1b-123">Erstellen eines Einkaufswagen</span><span class="sxs-lookup"><span data-stu-id="7dc1b-123">Creating a Shopping Cart</span></span>

<span data-ttu-id="7dc1b-124">Weiter oben in dieser tutorialreihe haben Sie Seiten und Code zum Anzeigen von Produktdaten aus einer-Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-124">Earlier in this tutorial series, you added pages and code to view product data from a database.</span></span> <span data-ttu-id="7dc1b-125">In diesem Tutorial erstellen Sie einen Warenkorb, um die Produkte zu verwalten, die die Benutzer erwerben möchten.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-125">In this tutorial, you'll create a shopping cart to manage the products that users are interested in buying.</span></span> <span data-ttu-id="7dc1b-126">Benutzer können Elemente im Warenkorb durchsuchen und hinzufügen, auch wenn Sie nicht registriert oder angemeldet sind.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-126">Users will be able to browse and add items to the shopping cart even if they are not registered or logged in.</span></span> <span data-ttu-id="7dc1b-127">Zum Verwalten des Einkaufswagen Zugriffs weisen Sie Benutzern eine eindeutige `ID` mithilfe einer Globally Unique Identifier (GUID) zu, wenn der Benutzer zum ersten Mal auf den Warenkorb zugreift.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-127">To manage shopping cart access, you will assign users a unique `ID` using a globally unique identifier (GUID) when the user accesses the shopping cart for the first time.</span></span> <span data-ttu-id="7dc1b-128">Sie speichern diese `ID` mithilfe des ASP.NET-Sitzungs Zustands.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-128">You'll store this `ID` using the ASP.NET Session state.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="7dc1b-129">Der ASP.NET-Sitzungszustand ist ein guter Ort zum Speichern von benutzerspezifischen Informationen, die ablaufen, wenn der Benutzer die Website verlässt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-129">The ASP.NET Session state is a convenient place to store user-specific information which will expire after the user leaves the site.</span></span> <span data-ttu-id="7dc1b-130">Obwohl die Verwendung des Sitzungs Zustands die Auswirkungen auf die Leistung von größeren Websites haben kann, eignet sich die einfache Verwendung des Sitzungs Zustands für Demonstrationszwecke.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-130">While misuse of session state can have performance implications on larger sites, light use of session state works well for demonstration purposes.</span></span> <span data-ttu-id="7dc1b-131">Das Wingtip Toys-Beispiel Projekt zeigt, wie der Sitzungszustand ohne einen externen Anbieter verwendet wird, wobei der Sitzungszustand auf dem Webserver, auf dem die Website gehostet wird, Prozess unabhängig gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-131">The Wingtip Toys sample project shows how to use session state without an external provider, where session state is stored in-process on the web server hosting the site.</span></span> <span data-ttu-id="7dc1b-132">Für größere Standorte, die mehrere Instanzen einer Anwendung bereitstellen, oder für Standorte, die mehrere Instanzen einer Anwendung auf unterschiedlichen Servern ausführen, sollten Sie die Verwendung von **Windows Azure Cache Service**in Erwägung gezogen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-132">For larger sites that provide multiple instances of an application or for sites that run multiple instances of an application on different servers, consider using **Windows Azure Cache Service**.</span></span> <span data-ttu-id="7dc1b-133">Diese Cache Service bietet einen verteilten Cache Dienst, der für die Website extern ist, und löst das Problem der Verwendung des Prozess internen Sitzungs Zustands.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-133">This Cache Service provides a distributed caching service that is external to the web site and solves the problem of using in-process session state.</span></span> <span data-ttu-id="7dc1b-134">Weitere Informationen finden Sie unter Gewusst [wie: Verwenden des ASP.NET-Sitzungs Zustands mit Windows Azure](https://docs.microsoft.com/azure/redis-cache/cache-aspnet-session-state-provider)-Websites.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-134">For more information see, [How to Use ASP.NET Session State with Windows Azure Web Sites](https://docs.microsoft.com/azure/redis-cache/cache-aspnet-session-state-provider).</span></span>

### <a name="add-cartitem-as-a-model-class"></a><span data-ttu-id="7dc1b-135">Hinzufügen von cartitem als Modell Klasse</span><span class="sxs-lookup"><span data-stu-id="7dc1b-135">Add CartItem as a Model Class</span></span>

<span data-ttu-id="7dc1b-136">Weiter oben in dieser tutorialreihe haben Sie das Schema für die Kategorie-und Produktdaten definiert, indem Sie die `Category`-und `Product` Klassen im Ordner *Modelle* erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-136">Earlier in this tutorial series, you defined the schema for the category and product data by creating the `Category` and `Product` classes in the *Models* folder.</span></span> <span data-ttu-id="7dc1b-137">Fügen Sie nun eine neue Klasse hinzu, um das Schema für den Warenkorb zu definieren.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-137">Now, add a new class to define the schema for the shopping cart.</span></span> <span data-ttu-id="7dc1b-138">Später in diesem Tutorial fügen Sie eine Klasse hinzu, um den Datenzugriff auf die `CartItem` Tabelle zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-138">Later in this tutorial, you will add a class to handle data access to the `CartItem` table.</span></span> <span data-ttu-id="7dc1b-139">Diese Klasse stellt die Geschäftslogik bereit, um Elemente im Warenkorb hinzuzufügen, zu entfernen und zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-139">This class will provide the business logic to add, remove, and update items in the shopping cart.</span></span>

1. <span data-ttu-id="7dc1b-140">Klicken Sie mit der rechten Maustaste auf den Ordner *Modelle* , und wählen Sie **Hinzufügen** -&gt; **Neues Element**</span><span class="sxs-lookup"><span data-stu-id="7dc1b-140">Right-click the *Models* folder and select **Add** -&gt; **New Item**.</span></span> 

    ![Warenkorb-neues Element](shopping-cart/_static/image1.png)
2. <span data-ttu-id="7dc1b-142">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-142">The **Add New Item** dialog box is displayed.</span></span> <span data-ttu-id="7dc1b-143">Wählen Sie **Code**aus, und wählen Sie dann **Klasse**aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-143">Select **Code**, and then select **Class**.</span></span> 

    ![Warenkorb-Dialog Feld "Neues Element hinzufügen"](shopping-cart/_static/image2.png)
3. <span data-ttu-id="7dc1b-145">Benennen Sie diese neue Klasse *CartItem.cs*.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-145">Name this new class *CartItem.cs*.</span></span>
4. <span data-ttu-id="7dc1b-146">Klicken Sie auf **Hinzufügen**.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-146">Click **Add**.</span></span>  
   <span data-ttu-id="7dc1b-147">Die neue Klassendatei wird im Editor angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-147">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="7dc1b-148">Ersetzen Sie den Standardcode durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-148">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample1.cs)]

<span data-ttu-id="7dc1b-149">Die `CartItem`-Klasse enthält das Schema, das die einzelnen Produkte definiert, die ein Benutzer in den Warenkorb einfügt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-149">The `CartItem` class contains the schema that will define each product a user adds to the shopping cart.</span></span> <span data-ttu-id="7dc1b-150">Diese Klasse ähnelt den anderen Schema Klassen, die Sie zuvor in dieser tutorialreihe erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-150">This class is similar to the other schema classes you created earlier in this tutorial series.</span></span> <span data-ttu-id="7dc1b-151">Gemäß der Konvention wird von Entity Framework Code First erwartet, dass der Primärschlüssel für die `CartItem` Tabelle entweder `CartItemId` oder `ID`ist.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-151">By convention, Entity Framework Code First expects that the primary key for the `CartItem` table will be either `CartItemId` or `ID`.</span></span> <span data-ttu-id="7dc1b-152">Der Code überschreibt jedoch das Standardverhalten, indem das Daten Anmerkung-`[Key]` Attribut verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-152">However, the code overrides the default behavior by using the data annotation `[Key]` attribute.</span></span> <span data-ttu-id="7dc1b-153">Das `Key`-Attribut der ItemId-Eigenschaft gibt an, dass die `ItemID`-Eigenschaft der Primärschlüssel ist.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-153">The `Key` attribute of the ItemId property specifies that the `ItemID` property is the primary key.</span></span>

<span data-ttu-id="7dc1b-154">Die `CartId`-Eigenschaft gibt die `ID` des Benutzers an, der dem zu erwerbenden Element zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-154">The `CartId` property specifies the `ID` of the user that is associated with the item to purchase.</span></span> <span data-ttu-id="7dc1b-155">Sie fügen Code hinzu, um diesen Benutzer `ID` zu erstellen, wenn der Benutzer auf den Warenkorb zugreift.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-155">You'll add code to create this user `ID` when the user accesses the shopping cart.</span></span> <span data-ttu-id="7dc1b-156">Diese `ID` wird auch als ASP.NET-Sitzungs Variable gespeichert.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-156">This `ID` will also be stored as an ASP.NET Session variable.</span></span>

### <a name="update-the-product-context"></a><span data-ttu-id="7dc1b-157">Aktualisieren des Produkt Kontexts</span><span class="sxs-lookup"><span data-stu-id="7dc1b-157">Update the Product Context</span></span>

<span data-ttu-id="7dc1b-158">Zusätzlich zum Hinzufügen der `CartItem` Klasse müssen Sie die Daten Bank Kontext Klasse aktualisieren, die die Entitäts Klassen verwaltet und den Datenzugriff auf die Datenbank ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-158">In addition to adding the `CartItem` class, you will need to update the database context class that manages the entity classes and that provides data access to the database.</span></span> <span data-ttu-id="7dc1b-159">Zu diesem Zweck fügen Sie der `ProductContext` Klasse die neu erstellte `CartItem` Modell Klasse hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-159">To do this, you will add the newly created `CartItem` model class to the `ProductContext` class.</span></span>

1. <span data-ttu-id="7dc1b-160">Suchen Sie in **Projektmappen-Explorer**die Datei *ProductContext.cs* im Ordner *Models* , und öffnen Sie Sie.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-160">In **Solution Explorer**, find and open the *ProductContext.cs* file in the *Models* folder.</span></span>
2. <span data-ttu-id="7dc1b-161">Fügen Sie der Datei *ProductContext.cs* den markierten Code wie folgt hinzu:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-161">Add the highlighted code to the *ProductContext.cs* file as follows:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample2.cs?highlight=14)]

<span data-ttu-id="7dc1b-162">Wie bereits in dieser tutorialreihe erwähnt, fügt der Code in der *ProductContext.cs* -Datei den `System.Data.Entity`-Namespace hinzu, damit Sie auf alle Kernfunktionen des Entity Framework zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-162">As mentioned previously in this tutorial series, the code in the *ProductContext.cs* file adds the `System.Data.Entity` namespace so that you have access to all the core functionality of the Entity Framework.</span></span> <span data-ttu-id="7dc1b-163">Diese Funktion bietet die Möglichkeit, Daten durcharbeiten mit stark typisierten Objekten abzufragen, einzufügen, zu aktualisieren und zu löschen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-163">This functionality includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span> <span data-ttu-id="7dc1b-164">Die `ProductContext`-Klasse bietet Zugriff auf die neu hinzugefügte `CartItem` Model-Klasse.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-164">The `ProductContext` class adds access to the newly added `CartItem` model class.</span></span>

### <a name="managing-the-shopping-cart-business-logic"></a><span data-ttu-id="7dc1b-165">Verwalten der Einkaufswagen-Geschäftslogik</span><span class="sxs-lookup"><span data-stu-id="7dc1b-165">Managing the Shopping Cart Business Logic</span></span>

<span data-ttu-id="7dc1b-166">Als Nächstes erstellen Sie die `ShoppingCart`-Klasse in einem neuen *Logik* Ordner.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-166">Next, you'll create the `ShoppingCart` class in a new *Logic* folder.</span></span> <span data-ttu-id="7dc1b-167">Die `ShoppingCart`-Klasse übernimmt den Datenzugriff auf die `CartItem`-Tabelle.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-167">The `ShoppingCart` class handles data access to the `CartItem` table.</span></span> <span data-ttu-id="7dc1b-168">Die-Klasse enthält auch die Geschäftslogik, um Elemente im Warenkorb hinzuzufügen, zu entfernen und zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-168">The class will also include the business logic to add, remove, and update items in the shopping cart.</span></span>

<span data-ttu-id="7dc1b-169">Die Warenkorb-Logik, die Sie hinzufügen werden, enthält die Funktionalität zum Verwalten der folgenden Aktionen:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-169">The shopping cart logic that you will add will contain the functionality to manage the following actions:</span></span>

1. <span data-ttu-id="7dc1b-170">Hinzufügen von Elementen zum Warenkorb</span><span class="sxs-lookup"><span data-stu-id="7dc1b-170">Adding items to the shopping cart</span></span>
2. <span data-ttu-id="7dc1b-171">Entfernen von Elementen aus dem Warenkorb</span><span class="sxs-lookup"><span data-stu-id="7dc1b-171">Removing items from the shopping cart</span></span>
3. <span data-ttu-id="7dc1b-172">Die Warenkorb-ID wird erhalten.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-172">Getting the shopping cart ID</span></span>
4. <span data-ttu-id="7dc1b-173">Abrufen von Elementen aus dem Warenkorb</span><span class="sxs-lookup"><span data-stu-id="7dc1b-173">Retrieving items from the shopping cart</span></span>
5. <span data-ttu-id="7dc1b-174">Gesamtmenge aller waren Korb Elemente</span><span class="sxs-lookup"><span data-stu-id="7dc1b-174">Totaling the amount of all the shopping cart items</span></span>
6. <span data-ttu-id="7dc1b-175">Aktualisieren der Warenkorb-Daten</span><span class="sxs-lookup"><span data-stu-id="7dc1b-175">Updating the shopping cart data</span></span>

<span data-ttu-id="7dc1b-176">Eine Einkaufswagen Seite ("*ShoppingCart. aspx*") und die Warenkorb-Klasse wird für den Zugriff auf Einkaufswagen Daten verwendet.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-176">A shopping cart page (*ShoppingCart.aspx*) and the shopping cart class will be used together to access shopping cart data.</span></span> <span data-ttu-id="7dc1b-177">Auf der Seite Warenkorb werden alle Elemente angezeigt, die der Benutzer in den Warenkorb einfügt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-177">The shopping cart page will display all the items the user adds to the shopping cart.</span></span> <span data-ttu-id="7dc1b-178">Neben der Warenkorb-Seite und-Klasse erstellen Sie eine Seite ("*adddecart. aspx*"), um dem Warenkorb Produkte hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-178">Besides the shopping cart page and class, you'll create a page (*AddToCart.aspx*) to add products to the shopping cart.</span></span> <span data-ttu-id="7dc1b-179">Außerdem fügen Sie der Seite " *productList. aspx* " und der Seite " *ProductDetails. aspx* " Code hinzu, der einen Link zur Seite " *adddecart. aspx* " enthält, sodass der Benutzer Produkte zum Warenkorb hinzufügen kann.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-179">You will also add code to the *ProductList.aspx* page and the *ProductDetails.aspx* page that will provide a link to the *AddToCart.aspx* page, so that the user can add products to the shopping cart.</span></span>

<span data-ttu-id="7dc1b-180">Im folgenden Diagramm wird der grundlegende Prozess veranschaulicht, der auftritt, wenn der Benutzer dem Warenkorb ein Produkt hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-180">The following diagram shows the basic process that occurs when the user adds a product to the shopping cart.</span></span>

![Warenkorb: Hinzufügen zum Warenkorb](shopping-cart/_static/image3.png)

<span data-ttu-id="7dc1b-182">Wenn der Benutzer auf der Seite " *productList. aspx* " oder auf der Seite " *ProductDetails. aspx* " auf den Link **zum Warenkorb hinzufügen** klickt, wird die Anwendung zur Seite " *AddTo Cart. aspx* " und dann automatisch zur Seite " *ShoppingCart. aspx* " navigiert.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-182">When the user clicks the **Add To Cart** link on either the *ProductList.aspx* page or the *ProductDetails.aspx* page, the application will navigate to the *AddToCart.aspx* page and then automatically to the *ShoppingCart.aspx* page.</span></span> <span data-ttu-id="7dc1b-183">Auf der Seite " *AddToCart. aspx* " wird das Select-Produkt zum Warenkorb hinzugefügt, indem eine Methode in der Klasse "ShoppingCart" aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-183">The *AddToCart.aspx* page will add the select product to the shopping cart by calling a method in the ShoppingCart class.</span></span> <span data-ttu-id="7dc1b-184">Auf der Seite " *ShoppingCart. aspx* " werden die Produkte angezeigt, die dem Warenkorb hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-184">The *ShoppingCart.aspx* page will display the products that have been added to the shopping cart.</span></span>

#### <a name="creating-the-shopping-cart-class"></a><span data-ttu-id="7dc1b-185">Erstellen der Warenkorb-Klasse</span><span class="sxs-lookup"><span data-stu-id="7dc1b-185">Creating the Shopping Cart Class</span></span>

<span data-ttu-id="7dc1b-186">Die `ShoppingCart` Klasse wird einem separaten Ordner in der Anwendung hinzugefügt, sodass zwischen dem Modell (Modell Ordner), den Seiten (Stamm Ordner) und der Logik (Logik Ordner) ein eindeutiger Unterschied besteht.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-186">The `ShoppingCart` class will be added to a separate folder in the application so that there will be a clear distinction between the model (Models folder), the pages (root folder) and the logic (Logic folder).</span></span>

1. <span data-ttu-id="7dc1b-187">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf das Projekt **wingtiptoys**, und wählen Sie-&gt;**neuen Ordner** **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-187">In **Solution Explorer**, right-click the **WingtipToys**project and select **Add**-&gt;**New Folder**.</span></span> <span data-ttu-id="7dc1b-188">Benennen Sie die neue Ordner *Logik*.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-188">Name the new folder *Logic*.</span></span>
2. <span data-ttu-id="7dc1b-189">Klicken Sie mit der rechten Maustaste auf den Ordner *Logic* , und wählen Sie -&gt; **Neues Element** **Hinzufügen** aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-189">Right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>
3. <span data-ttu-id="7dc1b-190">Fügen Sie eine neue Klassendatei mit dem Namen *ShoppingCartActions.cs*hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-190">Add a new class file named *ShoppingCartActions.cs*.</span></span>
4. <span data-ttu-id="7dc1b-191">Ersetzen Sie den Standardcode durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-191">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample3.cs)]

<span data-ttu-id="7dc1b-192">Die `AddToCart`-Methode ermöglicht das einschließen einzelner Produkte in den Warenkorb basierend auf dem Product `ID`.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-192">The `AddToCart` method enables individual products to be included in the shopping cart based on the product `ID`.</span></span> <span data-ttu-id="7dc1b-193">Das Produkt wird dem Warenkorb hinzugefügt, oder wenn der Warenkorb bereits ein Element für dieses Produkt enthält, wird die Menge inkrementiert.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-193">The product is added to the cart, or if the cart already contains an item for that product, the quantity is incremented.</span></span>

<span data-ttu-id="7dc1b-194">Die `GetCartId`-Methode gibt den Warenkorb `ID` für den Benutzer zurück.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-194">The `GetCartId` method returns the cart `ID` for the user.</span></span> <span data-ttu-id="7dc1b-195">Der Warenkorb-`ID` wird verwendet, um die Elemente zu verfolgen, die ein Benutzer in seinem Warenkorb hat.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-195">The cart `ID` is used to track the items that a user has in their shopping cart.</span></span> <span data-ttu-id="7dc1b-196">Wenn für den Benutzer kein Warenkorb `ID`vorhanden ist, wird eine neue Warenkorb-`ID` erstellt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-196">If the user does not have an existing cart `ID`, a new cart `ID` is created for them.</span></span> <span data-ttu-id="7dc1b-197">Wenn der Benutzer als registrierter Benutzer angemeldet ist, wird der Warenkorb-`ID` auf seinen Benutzernamen festgelegt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-197">If the user is signed in as a registered user, the cart `ID` is set to their user name.</span></span> <span data-ttu-id="7dc1b-198">Wenn der Benutzer jedoch nicht angemeldet ist, wird der Warenkorb-`ID` auf einen eindeutigen Wert (eine GUID) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-198">However, if the user is not signed in, the cart `ID` is set to a unique value (a GUID).</span></span> <span data-ttu-id="7dc1b-199">Eine GUID stellt sicher, dass auf der Grundlage der Sitzung nur ein Warenkorb für jeden Benutzer erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-199">A GUID ensures that only one cart is created for each user, based on session.</span></span>

<span data-ttu-id="7dc1b-200">Die `GetCartItems`-Methode gibt eine Liste der Warenkorb-Elemente für den Benutzer zurück.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-200">The `GetCartItems` method returns a list of shopping cart items for the user.</span></span> <span data-ttu-id="7dc1b-201">Später in diesem Tutorial sehen Sie, dass die Modell Bindung verwendet wird, um die Warenkorb-Elemente im Warenkorb mithilfe der `GetCartItems`-Methode anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-201">Later in this tutorial, you will see that model binding is used to display the cart items in the shopping cart using the `GetCartItems` method.</span></span>

### <a name="creating-the-add-to-cart-functionality"></a><span data-ttu-id="7dc1b-202">Erstellen der Add-to-Cart-Funktionalität</span><span class="sxs-lookup"><span data-stu-id="7dc1b-202">Creating the Add-To-Cart Functionality</span></span>

<span data-ttu-id="7dc1b-203">Wie bereits erwähnt, erstellen Sie eine Verarbeitungsseite mit dem Namen " *AddTo Cart. aspx* ", die zum Hinzufügen neuer Produkte zum Warenkorb des Benutzers verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-203">As mentioned earlier, you will create a processing page named *AddToCart.aspx* that will be used to add new products to the shopping cart of the user.</span></span> <span data-ttu-id="7dc1b-204">Auf dieser Seite wird die `AddToCart`-Methode in der `ShoppingCart`-Klasse aufgerufen, die Sie soeben erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-204">This page will call the `AddToCart` method in the `ShoppingCart` class that you just created.</span></span> <span data-ttu-id="7dc1b-205">Auf der Seite " *AddTo Cart. aspx* " wird davon ausgegangen, dass ein Produkt `ID` an die Seite übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-205">The *AddToCart.aspx* page will expect that a product `ID` is passed to it.</span></span> <span data-ttu-id="7dc1b-206">Diese Produkt `ID` wird verwendet, wenn die `AddToCart`-Methode in der `ShoppingCart`-Klasse aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-206">This product `ID` will be used when calling the `AddToCart` method in the `ShoppingCart` class.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="7dc1b-207">Sie ändern den Code-Behind (*AddToCart.aspx.cs*) für diese Seite und nicht die Seiten-UI (*adddecart. aspx*).</span><span class="sxs-lookup"><span data-stu-id="7dc1b-207">You will be modifying the code-behind (*AddToCart.aspx.cs*) for this page, not the page UI (*AddToCart.aspx*).</span></span>

#### <a name="to-create-the-add-to-cart-functionality"></a><span data-ttu-id="7dc1b-208">So erstellen Sie die Add-to-Cart-Funktionalität:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-208">To create the Add-To-Cart functionality:</span></span>

1. <span data-ttu-id="7dc1b-209">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf das Projekt **wingtiptoys**, und klicken Sie dann auf -&gt; **Neues Element** **Hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-209">In **Solution Explorer**, right-click the **WingtipToys**project, click **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="7dc1b-210">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-210">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="7dc1b-211">Fügen Sie der Anwendung mit dem Namen " *adddecart. aspx*" eine neue Standardseite (Web Form) hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-211">Add a standard new page (Web Form) to the application named *AddToCart.aspx*.</span></span> 

    ![Warenkorb-Webformular hinzufügen](shopping-cart/_static/image4.png)
3. <span data-ttu-id="7dc1b-213">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf die Seite *adddecart. aspx* , und klicken Sie dann auf **Code anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-213">In **Solution Explorer**, right-click the *AddToCart.aspx* page and then click **View Code**.</span></span> <span data-ttu-id="7dc1b-214">Die *AddToCart.aspx.cs* -Code Behind-Datei wird im Editor geöffnet.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-214">The *AddToCart.aspx.cs* code-behind file is opened in the editor.</span></span>
4. <span data-ttu-id="7dc1b-215">Ersetzen Sie den vorhandenen Code im Code Behind *AddToCart.aspx.cs* durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-215">Replace the existing code in the *AddToCart.aspx.cs* code-behind with the following:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample4.cs)]

<span data-ttu-id="7dc1b-216">Wenn die Seite " *adddecart. aspx* " geladen wird, wird der Product `ID` aus der Abfrage Zeichenfolge abgerufen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-216">When the *AddToCart.aspx* page is loaded, the product `ID` is retrieved from the query string.</span></span> <span data-ttu-id="7dc1b-217">Anschließend wird eine Instanz der Warenkorb-Klasse erstellt und verwendet, um die `AddToCart`-Methode aufzurufen, die Sie zuvor in diesem Tutorial hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-217">Next, an instance of the shopping cart class is created and used to call the `AddToCart` method that you added earlier in this tutorial.</span></span> <span data-ttu-id="7dc1b-218">Die `AddToCart`-Methode, die in der *ShoppingCartActions.cs* -Datei enthalten ist, enthält die Logik, um das ausgewählte Produkt dem Warenkorb hinzuzufügen oder die Produktmenge des ausgewählten Produkts zu erhöhen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-218">The `AddToCart` method, contained in the *ShoppingCartActions.cs* file, includes the logic to add the selected product to the shopping cart or increment the product quantity of the selected product.</span></span> <span data-ttu-id="7dc1b-219">Wenn das Produkt nicht zum Warenkorb hinzugefügt wurde, wird das Produkt der `CartItem` Tabelle der Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-219">If the product hasn't been added to the shopping cart, the product is added to the `CartItem` table of the database.</span></span> <span data-ttu-id="7dc1b-220">Wenn das Produkt bereits zum Warenkorb hinzugefügt wurde und der Benutzer ein zusätzliches Element desselben Produkts hinzufügt, wird die Produktmenge in der `CartItem` Tabelle inkrementiert.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-220">If the product has already been added to the shopping cart and the user adds an additional item of the same product, the product quantity is incremented in the `CartItem` table.</span></span> <span data-ttu-id="7dc1b-221">Schließlich wird die Seite zurück an die *ShoppingCart. aspx* -Seite umgeleitet, die Sie im nächsten Schritt hinzufügen, wo der Benutzer eine aktualisierte Liste der Elemente im Warenkorb sehen kann.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-221">Finally, the page redirects back to the *ShoppingCart.aspx* page that you'll add in the next step, where the user sees an updated list of items in the cart.</span></span>

<span data-ttu-id="7dc1b-222">Wie bereits erwähnt, wird ein Benutzer `ID` verwendet, um die Produkte zu identifizieren, die einem bestimmten Benutzer zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-222">As previously mentioned, a user `ID` is used to identify the products that are associated with a specific user.</span></span> <span data-ttu-id="7dc1b-223">Diese `ID` wird zu einer Zeile in der `CartItem` Tabelle hinzugefügt, wenn der Benutzer dem Warenkorb ein Produkt hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-223">This `ID` is added to a row in the `CartItem` table each time the user adds a product to the shopping cart.</span></span>

### <a name="creating-the-shopping-cart-ui"></a><span data-ttu-id="7dc1b-224">Erstellen der Einkaufswagen-Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="7dc1b-224">Creating the Shopping Cart UI</span></span>

<span data-ttu-id="7dc1b-225">Auf der Seite " *ShoppingCart. aspx* " werden die Produkte angezeigt, die der Benutzer dem Warenkorb hinzugefügt hat.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-225">The *ShoppingCart.aspx* page will display the products that the user has added to their shopping cart.</span></span> <span data-ttu-id="7dc1b-226">Außerdem wird die Möglichkeit bereitgestellt, Elemente im Warenkorb hinzuzufügen, zu entfernen und zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-226">It will also provide the ability to add, remove and update items in the shopping cart.</span></span>

1. <span data-ttu-id="7dc1b-227">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf **wingtiptoys**, klicken Sie auf -&gt; **Neues Element** **Hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-227">In **Solution Explorer**, right-click **WingtipToys**, click **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="7dc1b-228">Das Dialogfeld **Neues Element hinzufügen** wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-228">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="7dc1b-229">Fügen Sie eine neue Seite (Web Form) hinzu, die eine Master Seite enthält, indem **Sie Web Form mithilfe der Master Seite**auswählen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-229">Add a new page (Web Form) that includes a master page by selecting **Web Form using Master Page**.</span></span> <span data-ttu-id="7dc1b-230">Nennen Sie die neue Seite " *ShoppingCart. aspx*".</span><span class="sxs-lookup"><span data-stu-id="7dc1b-230">Name the new page *ShoppingCart.aspx*.</span></span>
3. <span data-ttu-id="7dc1b-231">Wählen Sie **Site. Master** aus, um die Master Seite an die neu erstellte *aspx* -Seite anzufügen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-231">Select **Site.Master** to attach the master page to the newly created *.aspx* page.</span></span>
4. <span data-ttu-id="7dc1b-232">Ersetzen Sie auf der Seite *ShoppingCart. aspx* das vorhandene Markup durch das folgende Markup:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-232">In the *ShoppingCart.aspx* page, replace the existing markup with the following markup:</span></span>   

    [!code-aspx[Main](shopping-cart/samples/sample5.aspx)]

<span data-ttu-id="7dc1b-233">Die *ShoppingCart. aspx* -Seite enthält ein **GridView** -Steuerelement mit dem Namen `CartList`.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-233">The *ShoppingCart.aspx* page includes a **GridView** control named `CartList`.</span></span> <span data-ttu-id="7dc1b-234">Dieses Steuerelement verwendet die Modell Bindung, um die Warenkorb-Daten aus der Datenbank an das **GridView** -Steuerelement zu binden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-234">This control uses model binding to bind the shopping cart data from the database to the **GridView** control.</span></span> <span data-ttu-id="7dc1b-235">Wenn Sie die `ItemType`-Eigenschaft des **GridView** -Steuer Elements festlegen, ist der Daten Bindungs Ausdruck `Item` im Markup des-Steuer Elements verfügbar, und das Steuerelement wird stark typisiert.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-235">When you set the `ItemType` property of the **GridView** control, the data-binding expression `Item` is available in the markup of the control and the control becomes strongly typed.</span></span> <span data-ttu-id="7dc1b-236">Wie bereits in dieser tutorialreihe erwähnt, können Sie mithilfe von IntelliSense Details des `Item` Objekts auswählen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-236">As mentioned earlier in this tutorial series, you can select details of the `Item` object using IntelliSense.</span></span> <span data-ttu-id="7dc1b-237">Wenn Sie ein Daten Steuerelement für die Verwendung der Modell Bindung zum Auswählen von Daten konfigurieren möchten, legen Sie die `SelectMethod`-Eigenschaft des Steuer Elements fest.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-237">To configure a data control to use model binding to select data, you set the `SelectMethod` property of the control.</span></span> <span data-ttu-id="7dc1b-238">Im obigen Markup legen Sie die `SelectMethod` für die Verwendung der getshoppingcartitems-Methode fest, die eine Liste von `CartItem` Objekten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-238">In the markup above, you set the `SelectMethod` to use the GetShoppingCartItems method which returns a list of `CartItem` objects.</span></span> <span data-ttu-id="7dc1b-239">Das **GridView** -Daten Steuerelement ruft die Methode zum entsprechenden Zeitpunkt im Lebenszyklus der Seite auf und bindet die zurückgegebenen Daten automatisch.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-239">The **GridView** data control calls the method at the appropriate time in the page life cycle and automatically binds the returned data.</span></span> <span data-ttu-id="7dc1b-240">Die `GetShoppingCartItems`-Methode muss noch hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-240">The `GetShoppingCartItems` method must still be added.</span></span>

#### <a name="retrieving-the-shopping-cart-items"></a><span data-ttu-id="7dc1b-241">Abrufen der Warenkorb-Elemente</span><span class="sxs-lookup"><span data-stu-id="7dc1b-241">Retrieving the Shopping Cart Items</span></span>

<span data-ttu-id="7dc1b-242">Als Nächstes fügen Sie Code zum *ShoppingCart.aspx.cs* -Code-Behind hinzu, um die Warenkorb-Benutzeroberfläche abzurufen und aufzufüllen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-242">Next, you add code to the *ShoppingCart.aspx.cs* code-behind to retrieve and populate the Shopping Cart UI.</span></span>

1. <span data-ttu-id="7dc1b-243">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf die Seite *ShoppingCart. aspx* , und klicken Sie dann auf **Code anzeigen**.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-243">In **Solution Explorer**, right-click the *ShoppingCart.aspx* page and then click **View Code**.</span></span> <span data-ttu-id="7dc1b-244">Die *ShoppingCart.aspx.cs* -Code Behind-Datei wird im Editor geöffnet.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-244">The *ShoppingCart.aspx.cs* code-behind file is opened in the editor.</span></span>
2. <span data-ttu-id="7dc1b-245">Ersetzen Sie den vorhandenen Code durch folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-245">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample6.cs)]

<span data-ttu-id="7dc1b-246">Wie bereits erwähnt, ruft das Daten Steuerelement `GridView` die `GetShoppingCartItems`-Methode zum entsprechenden Zeitpunkt im Lebenszyklus der Seite auf und bindet die zurückgegebenen Daten automatisch.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-246">As mentioned above, the `GridView` data control calls the `GetShoppingCartItems` method at the appropriate time in the page life cycle and automatically binds the returned data.</span></span> <span data-ttu-id="7dc1b-247">Die `GetShoppingCartItems`-Methode erstellt eine Instanz des `ShoppingCartActions`-Objekts.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-247">The `GetShoppingCartItems` method creates an instance of the `ShoppingCartActions` object.</span></span> <span data-ttu-id="7dc1b-248">Anschließend verwendet der Code diese Instanz, um die Elemente im Warenkorb durch Aufrufen der `GetCartItems`-Methode zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-248">Then, the code uses that instance to return the items in the cart by calling the `GetCartItems` method.</span></span>

### <a name="adding-products-to-the-shopping-cart"></a><span data-ttu-id="7dc1b-249">Hinzufügen von Produkten zum Warenkorb</span><span class="sxs-lookup"><span data-stu-id="7dc1b-249">Adding Products to the Shopping Cart</span></span>

<span data-ttu-id="7dc1b-250">Wenn die Seite " *productList. aspx* " oder " *ProductDetails. aspx* " angezeigt wird, kann der Benutzer das Produkt mithilfe eines Links zum Warenkorb hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-250">When either the *ProductList.aspx* or the *ProductDetails.aspx* page is displayed, the user will be able to add the product to the shopping cart using a link.</span></span> <span data-ttu-id="7dc1b-251">Wenn Sie auf den Link klicken, navigiert die Anwendung zur Verarbeitungsseite mit dem Namen " *AddTo Cart. aspx*".</span><span class="sxs-lookup"><span data-stu-id="7dc1b-251">When they click the link, the application navigates to the processing page named *AddToCart.aspx*.</span></span> <span data-ttu-id="7dc1b-252">Auf der Seite *adddecart. aspx* wird die `AddToCart`-Methode in der `ShoppingCart`-Klasse aufgerufen, die Sie zuvor in diesem Tutorial hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-252">The *AddToCart.aspx* page will call the `AddToCart` method in the `ShoppingCart` class that you added earlier in this tutorial.</span></span>

<span data-ttu-id="7dc1b-253">Nun fügen Sie der Seite " *productList. aspx* " und der Seite " *ProductDetails. aspx* " einen Link **zum Warenkorb** hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-253">Now, you'll add an **Add to Cart** link to both the *ProductList.aspx* page and the *ProductDetails.aspx* page.</span></span> <span data-ttu-id="7dc1b-254">Dieser Link enthält die Produkt `ID`, die aus der Datenbank abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-254">This link will include the product `ID` that is retrieved from the database.</span></span>

1. <span data-ttu-id="7dc1b-255">Suchen und öffnen Sie in **Projektmappen-Explorer**die Seite *productList. aspx*.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-255">In **Solution Explorer**, find and open the page named *ProductList.aspx*.</span></span>
2. <span data-ttu-id="7dc1b-256">Fügen Sie das in gelber hervorgehobene Markup zur Seite *productList. aspx* hinzu, sodass die gesamte Seite wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-256">Add the markup highlighted in yellow to the *ProductList.aspx* page so that the entire page appears as follows:</span></span>  

    [!code-aspx[Main](shopping-cart/samples/sample7.aspx?highlight=50-54)]

### <a name="testing-the-shopping-cart"></a><span data-ttu-id="7dc1b-257">Testen des Warenkorbs</span><span class="sxs-lookup"><span data-stu-id="7dc1b-257">Testing the Shopping Cart</span></span>

<span data-ttu-id="7dc1b-258">Führen Sie die Anwendung aus, um zu sehen, wie Sie Produkte zum Warenkorb hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-258">Run the application to see how you add products to the shopping cart.</span></span>

1. <span data-ttu-id="7dc1b-259">Drücken Sie **F5**, um die Anwendung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-259">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="7dc1b-260">Nachdem das Projekt die Datenbank neu erstellt hat, wird der Browser geöffnet und zeigt die Seite *default. aspx* an.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-260">After the project recreates the database, the browser will open and show the *Default.aspx* page.</span></span>
2. <span data-ttu-id="7dc1b-261">Wählen Sie im Navigationsmenü der Kategorie die Option **Autos** aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-261">Select **Cars** from the category navigation menu.</span></span>  
 <span data-ttu-id="7dc1b-262">Die Seite " *productList. aspx* " wird angezeigt, die nur Produkte enthält, die in der Kategorie "Auto" enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-262">The *ProductList.aspx* page is displayed showing only products included in the "Cars" category.</span></span> 

    ![Waren Wagen Wagen](shopping-cart/_static/image5.png)
3. <span data-ttu-id="7dc1b-264">Klicken Sie neben dem ersten aufgeführten Produkt auf den Link **zum Warenkorb hinzufügen** (das konvertierbare Auto).</span><span class="sxs-lookup"><span data-stu-id="7dc1b-264">Click the **Add to Cart** link next to the first product listed (the convertible car).</span></span>   
 <span data-ttu-id="7dc1b-265">Die Seite " *ShoppingCart. aspx* " wird angezeigt und zeigt die Auswahl in Ihrem Warenkorb.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-265">The *ShoppingCart.aspx* page is displayed, showing the selection in your shopping cart.</span></span> 

    ![Warenkorb-Warenkorb](shopping-cart/_static/image6.png)
4. <span data-ttu-id="7dc1b-267">Zeigen Sie weitere Produkte an, indem Sie im Navigationsmenü der Kategorie die Option **Ebenen** auswählen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-267">View additional products by selecting **Planes** from the category navigation menu.</span></span>
5. <span data-ttu-id="7dc1b-268">Klicken Sie neben dem ersten aufgeführten Produkt auf den Link **zum Warenkorb hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-268">Click the **Add to Cart** link next to the first product listed.</span></span>  
 <span data-ttu-id="7dc1b-269">Die Seite " *ShoppingCart. aspx* " wird mit dem zusätzlichen Element angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-269">The *ShoppingCart.aspx* page is displayed with the additional item.</span></span>
6. <span data-ttu-id="7dc1b-270">Schließen Sie den Browser.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-270">Close the browser.</span></span>

### <a name="calculating-and-displaying-the-order-total"></a><span data-ttu-id="7dc1b-271">Berechnen und Anzeigen der Bestellsumme</span><span class="sxs-lookup"><span data-stu-id="7dc1b-271">Calculating and Displaying the Order Total</span></span>

<span data-ttu-id="7dc1b-272">Zusätzlich zum Hinzufügen von Produkten zum Warenkorb fügen Sie der `ShoppingCart`-Klasse eine `GetTotal`-Methode hinzu und zeigen die Gesamtbestellmenge auf der Seite "Warenkorb" an.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-272">In addition to adding products to the shopping cart, you will add a `GetTotal` method to the `ShoppingCart` class and display the total order amount in the shopping cart page.</span></span>

1. <span data-ttu-id="7dc1b-273">Öffnen Sie in **Projektmappen-Explorer**die Datei *ShoppingCartActions.cs* im Ordner *Logic* .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-273">In **Solution Explorer**, open the *ShoppingCartActions.cs* file in the *Logic* folder.</span></span>
2. <span data-ttu-id="7dc1b-274">Fügen Sie die folgende `GetTotal`-Methode, die in gelb hervorgehoben ist, der `ShoppingCart`-Klasse hinzu, sodass die-Klasse wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-274">Add the following `GetTotal` method highlighted in yellow to the `ShoppingCart` class, so that the class appears as follows:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample8.cs?highlight=85-97)]

<span data-ttu-id="7dc1b-275">Zuerst Ruft die `GetTotal`-Methode die ID des Warenkorbs für den Benutzer ab.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-275">First, the `GetTotal` method gets the ID of the shopping cart for the user.</span></span> <span data-ttu-id="7dc1b-276">Dann ruft die Methode den Gesamtwert des Warenkorbs ab, indem der Produkt Preis von der Produktmenge für jedes Produkt multipliziert wird, das im Warenkorb aufgeführt ist.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-276">Then the method gets the cart total by multiplying the product price by the product quantity for each product listed in the cart.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="7dc1b-277">Der obige Code verwendet den Werte zulässt-Typ "`int?`".</span><span class="sxs-lookup"><span data-stu-id="7dc1b-277">The above code uses the nullable type "`int?`".</span></span> <span data-ttu-id="7dc1b-278">Typen, die NULL-Werte zulassen, können alle Werte eines zugrunde liegenden Typs und auch als NULL-Wert darstellen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-278">Nullable types can represent all the values of an underlying type, and also as a null value.</span></span> <span data-ttu-id="7dc1b-279">Weitere Informationen finden Sie unter [Verwenden von Typen](https://msdn.microsoft.com/library/2cf62fcy(v=vs.110).aspx), die NULL-Werte zulassen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-279">For more information see, [Using Nullable Types](https://msdn.microsoft.com/library/2cf62fcy(v=vs.110).aspx).</span></span>

### <a name="modify-the-shopping-cart-display"></a><span data-ttu-id="7dc1b-280">Ändern der Warenkorb-Anzeige</span><span class="sxs-lookup"><span data-stu-id="7dc1b-280">Modify the Shopping Cart Display</span></span>

<span data-ttu-id="7dc1b-281">Im nächsten Schritt ändern Sie den Code für die Seite " *ShoppingCart. aspx* ", um die `GetTotal`-Methode aufzurufen und diese Summe auf der Seite " *ShoppingCart. aspx* " anzuzeigen, wenn die Seite geladen wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-281">Next you'll modify the code for the *ShoppingCart.aspx* page to call the `GetTotal` method and display that total on the *ShoppingCart.aspx* page when the page loads.</span></span>

1. <span data-ttu-id="7dc1b-282">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf die Seite *ShoppingCart. aspx* , und wählen Sie **Code anzeigen**aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-282">In **Solution Explorer**, right-click the *ShoppingCart.aspx* page and select **View Code**.</span></span>
2. <span data-ttu-id="7dc1b-283">Aktualisieren Sie in der Datei *ShoppingCart.aspx.cs* den `Page_Load` Handler, indem Sie den folgenden Code in gelb hervorheben:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-283">In the *ShoppingCart.aspx.cs* file, update the `Page_Load` handler by adding the following code highlighted in yellow:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample9.cs?highlight=16-31)]

<span data-ttu-id="7dc1b-284">Wenn die *ShoppingCart. aspx* -Seite geladen wird, lädt Sie das Warenkorb-Objekt und ruft dann den Warenkorb ab, indem die `GetTotal`-Methode der `ShoppingCart`-Klasse aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-284">When the *ShoppingCart.aspx* page loads, it loads the shopping cart object and then retrieves the shopping cart total by calling the `GetTotal` method of the `ShoppingCart` class.</span></span> <span data-ttu-id="7dc1b-285">Wenn der Warenkorb leer ist, wird eine entsprechende Meldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-285">If the shopping cart is empty, a message to that effect is displayed.</span></span>

### <a name="testing-the-shopping-cart-total"></a><span data-ttu-id="7dc1b-286">Testen des Warenkorbs Gesamt</span><span class="sxs-lookup"><span data-stu-id="7dc1b-286">Testing the Shopping Cart Total</span></span>

<span data-ttu-id="7dc1b-287">Führen Sie die Anwendung jetzt aus, um zu sehen, wie Sie dem Warenkorb nicht nur ein Produkt hinzufügen können, sondern auch den Einkaufswagen gesamt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-287">Run the application now to see how you can not only add a product to the shopping cart, but you can see the shopping cart total.</span></span>

1. <span data-ttu-id="7dc1b-288">Drücken Sie **F5**, um die Anwendung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-288">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="7dc1b-289">Der Browser wird geöffnet und zeigt die Seite *Default.aspx* an.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-289">The browser will open and show the *Default.aspx* page.</span></span>
2. <span data-ttu-id="7dc1b-290">Wählen Sie im Navigationsmenü der Kategorie die Option **Autos** aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-290">Select **Cars** from the category navigation menu.</span></span>
3. <span data-ttu-id="7dc1b-291">Klicken Sie neben dem ersten Produkt auf den Link **zum Warenkorb hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-291">Click the **Add To Cart** link next to the first product.</span></span>   
 <span data-ttu-id="7dc1b-292">Die Seite " *ShoppingCart. aspx* " wird mit dem Gesamtbetrag der Bestellung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-292">The *ShoppingCart.aspx* page is displayed with the order total.</span></span> 

    ![Warenkorb-Wagen Gesamt](shopping-cart/_static/image7.png)
4. <span data-ttu-id="7dc1b-294">Fügen Sie dem Warenkorb einige andere Produkte (z. b. eine Ebene) hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-294">Add some other products (for example, a plane) to the cart.</span></span>
5. <span data-ttu-id="7dc1b-295">Die Seite " *ShoppingCart. aspx* " wird mit einer aktualisierten Summe für alle Produkte angezeigt, die Sie hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-295">The *ShoppingCart.aspx* page is displayed with an updated total for all the products you've added.</span></span> 

    ![Warenkorb: mehrere Produkte](shopping-cart/_static/image8.png)
6. <span data-ttu-id="7dc1b-297">Beenden Sie die laufende APP, indem Sie das Browserfenster schließen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-297">Stop the running app by closing the browser window.</span></span>

### <a name="adding-update-and-checkout-buttons-to-the-shopping-cart"></a><span data-ttu-id="7dc1b-298">Hinzufügen von Update-und Checkout-Schaltflächen zum Warenkorb</span><span class="sxs-lookup"><span data-stu-id="7dc1b-298">Adding Update and Checkout Buttons to the Shopping Cart</span></span>

<span data-ttu-id="7dc1b-299">Damit die Benutzer den Warenkorb ändern können, fügen Sie die Schaltfläche " **Aktualisieren** " und die **Schaltfläche** "Auschecken" zur Warenkorb-Seite hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-299">To allow the users to modify the shopping cart, you'll add an **Update** button and a **Checkout** button to the shopping cart page.</span></span> <span data-ttu-id="7dc1b-300">Die **Schalt** Fläche "Auschecken" wird erst später in dieser tutorialreihe verwendet.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-300">The **Checkout** button is not used until later in this tutorial series.</span></span>

1. <span data-ttu-id="7dc1b-301">Öffnen Sie in **Projektmappen-Explorer**die Seite *ShoppingCart. aspx* im Stammverzeichnis des Webanwendungs Projekts.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-301">In **Solution Explorer**, open the *ShoppingCart.aspx* page in the root of the web application project.</span></span>
2. <span data-ttu-id="7dc1b-302">Um die Schaltfläche " **Aktualisieren** " und **die Schaltfläche** "Auschecken" der Seite " *ShoppingCart. aspx* " hinzuzufügen, fügen Sie das in gelber hervorgehobene Markup dem vorhandenen Markup hinzu, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-302">To add the **Update** button and the **Checkout** button to the *ShoppingCart.aspx* page, add the markup highlighted in yellow to the existing markup, as shown in the following code:</span></span>   

    [!code-aspx[Main](shopping-cart/samples/sample10.aspx?highlight=36-45)]

<span data-ttu-id="7dc1b-303">Wenn der Benutzer auf die Schaltfläche **Aktualisieren** klickt, wird der `UpdateBtn_Click`-Ereignishandler aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-303">When the user clicks the **Update** button, the `UpdateBtn_Click` event handler will be called.</span></span> <span data-ttu-id="7dc1b-304">Dieser Ereignishandler ruft den Code auf, den Sie im nächsten Schritt hinzufügen werden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-304">This event handler will call the code that you'll add in the next step.</span></span>

<span data-ttu-id="7dc1b-305">Als nächstes können Sie den in der *ShoppingCart.aspx.cs* -Datei enthaltenen Code aktualisieren, um die Warenkorb-Elemente zu durchlaufen und die `RemoveItem`-und `UpdateItem` Methoden aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-305">Next, you can update the code contained in the *ShoppingCart.aspx.cs* file to loop through the cart items and call the `RemoveItem` and `UpdateItem` methods.</span></span>

1. <span data-ttu-id="7dc1b-306">Öffnen Sie in **Projektmappen-Explorer**die Datei *ShoppingCart.aspx.cs* im Stammverzeichnis des Webanwendungs Projekts.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-306">In **Solution Explorer**, open the *ShoppingCart.aspx.cs* file in the root of the web application project.</span></span>
2. <span data-ttu-id="7dc1b-307">Fügen Sie die folgenden Code Abschnitte, die in gelb hervorgehoben sind, in die Datei *ShoppingCart.aspx.cs*</span><span class="sxs-lookup"><span data-stu-id="7dc1b-307">Add the following code sections highlighted in yellow to the *ShoppingCart.aspx.cs* file:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample11.cs?highlight=9-11,33,44-89)]

<span data-ttu-id="7dc1b-308">Wenn der Benutzer auf der Seite " *ShoppingCart. aspx* " auf die Schaltfläche " **Aktualisieren** " klickt, wird die updatecartitems-Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-308">When the user clicks the **Update** button on the *ShoppingCart.aspx* page, the UpdateCartItems method is called.</span></span> <span data-ttu-id="7dc1b-309">Die updatecartitems-Methode ruft die aktualisierten Werte für jedes Element im Warenkorb ab.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-309">The UpdateCartItems method gets the updated values for each item in the shopping cart.</span></span> <span data-ttu-id="7dc1b-310">Dann ruft die updatecartitems-Methode die `UpdateShoppingCartDatabase`-Methode auf (die im nächsten Schritt hinzugefügt und erläutert wird), um dem Warenkorb Elemente hinzuzufügen oder daraus zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-310">Then, the UpdateCartItems method calls the `UpdateShoppingCartDatabase` method (added and explained in the next step) to either add or remove items from the shopping cart.</span></span> <span data-ttu-id="7dc1b-311">Nachdem die Datenbank aktualisiert wurde, um die Aktualisierungen des Warenkorbs widerzuspiegeln, wird das **GridView** -Steuerelement auf der Einkaufswagen Seite aktualisiert, indem die `DataBind`-Methode für die **GridView**aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-311">Once the database has been updated to reflect the updates to the shopping cart, the **GridView** control is updated on the shopping cart page by calling the `DataBind` method for the **GridView**.</span></span> <span data-ttu-id="7dc1b-312">Außerdem wird die Gesamtbestellmenge auf der Warenkorb-Seite aktualisiert, um die aktualisierte Liste der Elemente widerzuspiegeln.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-312">Also, the total order amount on the shopping cart page is updated to reflect the updated list of items.</span></span>

### <a name="updating-and-removing-shopping-cart-items"></a><span data-ttu-id="7dc1b-313">Aktualisieren und Entfernen von Warenkorb-Elementen</span><span class="sxs-lookup"><span data-stu-id="7dc1b-313">Updating and Removing Shopping Cart Items</span></span>

<span data-ttu-id="7dc1b-314">Auf der Seite *ShoppingCart. aspx* können Sie sehen, dass Steuerelemente hinzugefügt wurden, um die Menge eines Elements zu aktualisieren und ein Element zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-314">On the *ShoppingCart.aspx* page, you can see controls have been added for updating the quantity of an item and removing an item.</span></span> <span data-ttu-id="7dc1b-315">Fügen Sie nun den Code hinzu, mit dem diese Steuerelemente funktionieren.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-315">Now, add the code that will make these controls work.</span></span>

1. <span data-ttu-id="7dc1b-316">Öffnen Sie in **Projektmappen-Explorer**die Datei *ShoppingCartActions.cs* im Ordner *Logic* .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-316">In **Solution Explorer**, open the *ShoppingCartActions.cs* file in the *Logic* folder.</span></span>
2. <span data-ttu-id="7dc1b-317">Fügen Sie den folgenden Code, der in gelb hervorgehoben ist, der *ShoppingCartActions.cs* -Klassendatei hinzu</span><span class="sxs-lookup"><span data-stu-id="7dc1b-317">Add the following code highlighted in yellow to the *ShoppingCartActions.cs* class file:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample12.cs?highlight=99-213)]

<span data-ttu-id="7dc1b-318">Die `UpdateShoppingCartDatabase`-Methode, die von der `UpdateCartItems`-Methode auf der Seite *ShoppingCart.aspx.cs* aufgerufen wird, enthält die Logik zum Aktualisieren oder Entfernen von Elementen aus dem Warenkorb.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-318">The `UpdateShoppingCartDatabase` method, called from the `UpdateCartItems` method on the *ShoppingCart.aspx.cs* page, contains the logic to either update or remove items from the shopping cart.</span></span> <span data-ttu-id="7dc1b-319">Die `UpdateShoppingCartDatabase`-Methode durchläuft alle Zeilen in der Liste der Einkaufswagen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-319">The `UpdateShoppingCartDatabase` method iterates through all the rows within the shopping cart list.</span></span> <span data-ttu-id="7dc1b-320">Wenn ein waren Korb Element als entfernt markiert wurde oder die Menge kleiner als 1 ist, wird die `RemoveItem`-Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-320">If a shopping cart item has been marked to be removed, or the quantity is less than one, the `RemoveItem` method is called.</span></span> <span data-ttu-id="7dc1b-321">Andernfalls wird das Warenkorb-Element auf Updates geprüft, wenn die `UpdateItem`-Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-321">Otherwise, the shopping cart item is checked for updates when the `UpdateItem` method is called.</span></span> <span data-ttu-id="7dc1b-322">Nachdem das waren Korb Element entfernt oder aktualisiert wurde, werden die Daten Bank Änderungen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-322">After the shopping cart item has been removed or updated, the database changes are saved.</span></span>

<span data-ttu-id="7dc1b-323">Die `ShoppingCartUpdates` Struktur wird verwendet, um alle waren Korb Elemente aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-323">The `ShoppingCartUpdates` structure is used to hold all the shopping cart items.</span></span> <span data-ttu-id="7dc1b-324">Die `UpdateShoppingCartDatabase`-Methode verwendet die `ShoppingCartUpdates`-Struktur, um zu bestimmen, ob eines der Elemente aktualisiert oder entfernt werden muss.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-324">The `UpdateShoppingCartDatabase` method uses the `ShoppingCartUpdates` structure to determine if any of the items need to be updated or removed.</span></span>

<span data-ttu-id="7dc1b-325">Im nächsten Tutorial verwenden Sie die `EmptyCart`-Methode, um den Warenkorb nach dem Erwerb von Produkten zu löschen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-325">In the next tutorial, you will use the `EmptyCart` method to clear the shopping cart after purchasing products.</span></span> <span data-ttu-id="7dc1b-326">Aber vorerst verwenden Sie die `GetCount`-Methode, die Sie soeben der *ShoppingCartActions.cs* -Datei hinzugefügt haben, um zu bestimmen, wie viele Elemente sich im Warenkorb befinden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-326">But for now, you will use the `GetCount` method that you just added to the *ShoppingCartActions.cs* file to determine how many items are in the shopping cart.</span></span>

### <a name="adding-a-shopping-cart-counter"></a><span data-ttu-id="7dc1b-327">Hinzufügen eines Einkaufswagen Zählers</span><span class="sxs-lookup"><span data-stu-id="7dc1b-327">Adding a Shopping Cart Counter</span></span>

<span data-ttu-id="7dc1b-328">Um dem Benutzer die Anzeige der Gesamtzahl der Elemente im Warenkorb zu ermöglichen, fügen Sie der Seite *Site. Master* einen Gegenstand hinzu.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-328">To allow the user to view the total number of items in the shopping cart, you will add a counter to the *Site.Master* page.</span></span> <span data-ttu-id="7dc1b-329">Dieser Counter fungiert auch als Link zum Warenkorb.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-329">This counter will also act as a link to the shopping cart.</span></span>

1. <span data-ttu-id="7dc1b-330">Öffnen Sie in **Projektmappen-Explorer**die Seite *Site. Master* .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-330">In **Solution Explorer**, open the *Site.Master* page.</span></span>
2. <span data-ttu-id="7dc1b-331">Ändern Sie das Markup, indem Sie den Link für den Warenkorb des Warenkorbs dem Navigations Abschnitt hinzufügen, sodass er wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-331">Modify the markup by adding the shopping cart counter link as shown in yellow to the navigation section so it appears as follows:</span></span>  

    [!code-html[Main](shopping-cart/samples/sample13.html?highlight=6)]
3. <span data-ttu-id="7dc1b-332">Aktualisieren Sie anschließend den Code Behind der *Site.Master.cs* -Datei, indem Sie den in gelb markierten Code wie folgt hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="7dc1b-332">Next, update the code-behind of the *Site.Master.cs* file by adding the code highlighted in yellow as follows:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample14.cs?highlight=11,77-84)]

<span data-ttu-id="7dc1b-333">Bevor die Seite als HTML gerendert wird, wird das `Page_PreRender`-Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-333">Before the page is rendered as HTML, the `Page_PreRender` event is raised.</span></span> <span data-ttu-id="7dc1b-334">Im `Page_PreRender`-Handler wird die Gesamtanzahl der Warenkorb durch Aufrufen der `GetCount`-Methode bestimmt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-334">In the `Page_PreRender` handler, the total count of the shopping cart is determined by calling the `GetCount` method.</span></span> <span data-ttu-id="7dc1b-335">Der zurückgegebene Wert wird der `cartCount` Spanne hinzugefügt, die im Markup der *Site. Master* -Seite enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-335">The returned value is added to the `cartCount` span included in the markup of the *Site.Master* page.</span></span> <span data-ttu-id="7dc1b-336">Mit den `<span>`-Tags können innere Elemente ordnungsgemäß gerendert werden.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-336">The `<span>` tags enables the inner elements to be properly rendered.</span></span> <span data-ttu-id="7dc1b-337">Wenn eine Seite der Website angezeigt wird, wird der Gesamt Warenkorb angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-337">When any page of the site is displayed, the shopping cart total will be displayed.</span></span> <span data-ttu-id="7dc1b-338">Der Benutzer kann auch auf den Warenkorb klicken, um den Warenkorb anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-338">The user can also click the shopping cart total to display the shopping cart.</span></span>

## <a name="testing-the-completed-shopping-cart"></a><span data-ttu-id="7dc1b-339">Testen des abgeschlossenen Warenkorbs</span><span class="sxs-lookup"><span data-stu-id="7dc1b-339">Testing the Completed Shopping Cart</span></span>

<span data-ttu-id="7dc1b-340">Sie können die Anwendung jetzt ausführen, um zu erfahren, wie Sie Elemente im Warenkorb hinzufügen, löschen und aktualisieren können.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-340">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="7dc1b-341">Der Einkaufswagen Gesamt zeigt die Gesamtkosten aller Produkte im Warenkorb an.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-341">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="7dc1b-342">Drücken Sie **F5**, um die Anwendung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-342">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="7dc1b-343">Der Browser wird geöffnet und zeigt die Seite *default. aspx* an.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-343">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="7dc1b-344">Wählen Sie im Navigationsmenü der Kategorie die Option **Autos** aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-344">Select **Cars** from the category navigation menu.</span></span>
3. <span data-ttu-id="7dc1b-345">Klicken Sie neben dem ersten Produkt auf den Link **zum Warenkorb hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-345">Click the **Add To Cart** link next to the first product.</span></span>   
 <span data-ttu-id="7dc1b-346">Die Seite " *ShoppingCart. aspx* " wird mit dem Gesamtbetrag der Bestellung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-346">The *ShoppingCart.aspx* page is displayed with the order total.</span></span>
4. <span data-ttu-id="7dc1b-347">Wählen Sie im Navigationsmenü der Kategorie die Option **Ebenen** aus.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-347">Select **Planes** from the category navigation menu.</span></span>
5. <span data-ttu-id="7dc1b-348">Klicken Sie neben dem ersten Produkt auf den Link **zum Warenkorb hinzufügen** .</span><span class="sxs-lookup"><span data-stu-id="7dc1b-348">Click the **Add To Cart** link next to the first product.</span></span>
6. <span data-ttu-id="7dc1b-349">Legen Sie die Menge des ersten Elements im Warenkorb auf 3 fest, und aktivieren Sie das Kontrollkästchen **Element entfernen** des zweiten Elements.<a id="a"></a></span><span class="sxs-lookup"><span data-stu-id="7dc1b-349">Set the quantity of the first item in the shopping cart to 3 and select the **Remove Item** check box of the second item.<a id="a"></a></span></span>
7. <span data-ttu-id="7dc1b-350">Klicken Sie auf die Schaltfläche **Aktualisieren** , um die Warenkorb-Seite zu aktualisieren und die neue Bestellsumme anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-350">Click the **Update** button to update the shopping cart page and display the new order total.</span></span> 

    ![Warenkorb-Warenkorb-Update](shopping-cart/_static/image9.png)

## <a name="summary"></a><span data-ttu-id="7dc1b-352">Summary</span><span class="sxs-lookup"><span data-stu-id="7dc1b-352">Summary</span></span>

<span data-ttu-id="7dc1b-353">In diesem Tutorial haben Sie einen Warenkorb für die Beispielanwendung Wingtip Toys Web Forms erstellt.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-353">In this tutorial, you have created a shopping cart for the Wingtip Toys Web Forms sample application.</span></span> <span data-ttu-id="7dc1b-354">In diesem Tutorial haben Sie Entity Framework Code First, Daten Anmerkungen, stark typisierte Daten Steuerelemente und Modell Bindung verwendet.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-354">During this tutorial you have used Entity Framework Code First, data annotations, strongly typed data controls, and model binding.</span></span>

<span data-ttu-id="7dc1b-355">Der Warenkorb unterstützt das Hinzufügen, löschen und Aktualisieren von Elementen, die der Benutzer für den Kauf ausgewählt hat.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-355">The shopping cart supports adding, deleting, and updating items that the user has selected for purchase.</span></span> <span data-ttu-id="7dc1b-356">Zusätzlich zur Implementierung der Warenkorb-Funktion haben Sie erfahren, wie Sie waren Korb Elemente in einem **GridView** -Steuerelement anzeigen und die Bestellsumme berechnen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-356">In addition to implementing the shopping cart functionality, you have learned how to display shopping cart items in a **GridView** control and calculate the order total.</span></span>

<span data-ttu-id="7dc1b-357">Um zu verstehen, wie die beschriebene Funktionalität in einer realen Geschäftsanwendung funktioniert, können Sie das Beispiel für [nopcommerce](https://github.com/nopSolutions/nopCommerce) -ASP.net Based Open Source-e-Commerce-Einkaufswagen anzeigen.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-357">In order to understand how the described functionality works in a real business application, you can view the example of [nopCommerce](https://github.com/nopSolutions/nopCommerce) - ASP.NET based open source eCommerce shopping cart.</span></span> <span data-ttu-id="7dc1b-358">Ursprünglich war es auf Web Forms und im Laufe der Jahre aufgebaut, das es in MVC verlagert hat und jetzt ASP.net Core.</span><span class="sxs-lookup"><span data-stu-id="7dc1b-358">Originally, it was built on Web Forms and over the years it moved to MVC and now to ASP.NET Core.</span></span>

## <a name="addition-information"></a><span data-ttu-id="7dc1b-359">Zusätzliche Informationen</span><span class="sxs-lookup"><span data-stu-id="7dc1b-359">Addition Information</span></span>

[<span data-ttu-id="7dc1b-360">Überblick über den ASP.NET-Sitzungsstatus</span><span class="sxs-lookup"><span data-stu-id="7dc1b-360">ASP.NET Session State Overview</span></span>](https://msdn.microsoft.com/library/ms178581.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="7dc1b-361">[Zurück](display_data_items_and_details.md)
> [Weiter](checkout-and-payment-with-paypal.md)</span><span class="sxs-lookup"><span data-stu-id="7dc1b-361">[Previous](display_data_items_and_details.md)
[Next](checkout-and-payment-with-paypal.md)</span></span>
