---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb
title: Verarbeiten von nicht behandelten Ausnahmen (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Wenn ein Laufzeitfehler in einer Webanwendung in der Produktion auftritt, ist es wichtig, einen Entwickler zu benachrichtigen und den Fehler zu protokollieren, damit er möglicherweise bei einem La-...
ms.author: riande
ms.date: 06/09/2009
ms.assetid: 051296f0-9519-4e78-835c-d868da13b0a0
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 8d2e12af29bd95ce9898fa6a5e81be8b7a761f76
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78473637"
---
# <a name="processing-unhandled-exceptions-vb"></a><span data-ttu-id="f7a3b-103">Verarbeiten von Ausnahmefehlern (VB)</span><span class="sxs-lookup"><span data-stu-id="f7a3b-103">Processing Unhandled Exceptions (VB)</span></span>

<span data-ttu-id="f7a3b-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f7a3b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f7a3b-105">[Anzeigen oder Herunterladen von Beispielcode](https://github.com/dotnet/AspNetDocs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb/samples) ([Vorgehensweise zum Herunterladen](/aspnet/core/tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="f7a3b-105">[View or download sample code](https://github.com/dotnet/AspNetDocs/tree/master/aspnet/web-forms/overview/older-versions-getting-started/deploying-web-site-projects/processing-unhandled-exceptions-vb/samples) ([how to download](/aspnet/core/tutorials/index#how-to-download-a-sample))</span></span>

> <span data-ttu-id="f7a3b-106">Wenn ein Laufzeitfehler in einer Webanwendung in der Produktion auftritt, ist es wichtig, einen Entwickler zu benachrichtigen und den Fehler zu protokollieren, damit er zu einem späteren Zeitpunkt diagnostiziert werden kann.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-106">When a runtime error occurs on a web application in production it is important to notify a developer and to log the error so that it may be diagnosed at a later point in time.</span></span> <span data-ttu-id="f7a3b-107">Dieses Tutorial bietet einen Überblick darüber, wie ASP.net Laufzeitfehler verarbeitet und eine Möglichkeit bietet, benutzerdefinierten Code immer dann auszuführen, wenn eine nicht behandelte Ausnahme auf die ASP.NET-Laufzeit zugreift.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-107">This tutorial provides an overview of how ASP.NET processes runtime errors and looks at one way to have custom code execute whenever an unhandled exception bubbles up to the ASP.NET runtime.</span></span>

## <a name="introduction"></a><span data-ttu-id="f7a3b-108">Einführung</span><span class="sxs-lookup"><span data-stu-id="f7a3b-108">Introduction</span></span>

<span data-ttu-id="f7a3b-109">Wenn eine nicht behandelte Ausnahme in einer ASP.NET-Anwendung auftritt, wird die ASP.NET-Laufzeit hochskalieren. Dadurch wird das `Error`-Ereignis ausgelöst, und die entsprechende Fehlerseite wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-109">When an unhandled exception occurs in an ASP.NET application, it bubbles up to the ASP.NET runtime, which raises the `Error` event and displays the appropriate error page.</span></span> <span data-ttu-id="f7a3b-110">Es gibt drei verschiedene Arten von Fehlerseiten: den gelben Bildschirm für den Laufzeitfehler (Ysod); Ausnahme Details Ysod; und benutzerdefinierte Fehlerseiten.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-110">There are three different types of error pages: the Runtime Error Yellow Screen of Death (YSOD); the Exception Details YSOD; and custom error pages.</span></span> <span data-ttu-id="f7a3b-111">Im [vorherigen Tutorial](displaying-a-custom-error-page-vb.md) haben wir die Anwendung so konfiguriert, dass Sie eine benutzerdefinierte Fehlerseite für Remote Benutzer verwendet, und die Ausnahme Details Ysod für Benutzer, die lokal besuchen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-111">In the [preceding tutorial](displaying-a-custom-error-page-vb.md) we configured the application to use a custom error page for remote users and the Exception Details YSOD for users visiting locally.</span></span>

<span data-ttu-id="f7a3b-112">Die Verwendung einer benutzerfreundlichen, benutzerfreundlichen Fehlerseite, die dem Aussehen und dem Gefühl der Site entspricht, wird dem Standard-Lauf Zeit Fehler Ysod vorgezogen, aber das Anzeigen einer benutzerdefinierten Fehlerseite ist nur ein Teil einer umfassenden Lösung für die Fehlerbehandlung.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-112">Using a human-friendly custom error page that matches the look and feel of the site is preferred to the default Runtime Error YSOD, but displaying a custom error page is only one part of a comprehensive error handling solution.</span></span> <span data-ttu-id="f7a3b-113">Wenn in einer Anwendung in der Produktionsumgebung ein Fehler auftritt, ist es wichtig, dass die Entwickler über den Fehler benachrichtigt werden, damit Sie die Ursache der Ausnahme lösen und beheben können.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-113">When an error occurs in an application in production, it is important that the developers are notified of the error so that they can unearth the cause of the exception and address it.</span></span> <span data-ttu-id="f7a3b-114">Außerdem sollten die Fehlerdetails protokolliert werden, damit der Fehler zu einem späteren Zeitpunkt untersucht und diagnostiziert werden kann.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-114">Furthermore, the error's details should be logged so that the error can be examined and diagnosed at a later point in time.</span></span>

<span data-ttu-id="f7a3b-115">In diesem Tutorial wird gezeigt, wie Sie auf die Details einer nicht behandelten Ausnahme zugreifen, damit Sie protokolliert und von einem Entwickler benachrichtigt werden können.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-115">This tutorial shows how to access the details of an unhandled exception so that they can be logged and a developer notified.</span></span> <span data-ttu-id="f7a3b-116">In den beiden folgenden Tutorials werden die Fehler Protokollierungs Bibliotheken untersucht, die Entwicklern nach einiger Konfiguration automatisch über Laufzeitfehler benachrichtigt und deren Details protokolliert werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-116">The two tutorials following this one explore error logging libraries that, after a bit of configuration, will automatically notify developers of runtime errors and log their details.</span></span>

> [!NOTE]
> <span data-ttu-id="f7a3b-117">Die in diesem Tutorial untersuchten Informationen sind besonders nützlich, wenn Sie nicht behandelte Ausnahmen auf eindeutige oder angepasste Weise verarbeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-117">The information examined in this tutorial is most useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="f7a3b-118">In Fällen, in denen Sie die Ausnahme nur protokollieren und einen Entwickler benachrichtigen müssen, ist die Verwendung einer Fehler Protokollierungs Bibliothek der Weg.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-118">In cases where you only need to log the exception and notify a developer, using an error logging library is the way to go.</span></span> <span data-ttu-id="f7a3b-119">In den nächsten beiden Tutorials wird eine Übersicht über zwei dieser Bibliotheken bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-119">The next two tutorials provide an overview of two such libraries.</span></span>

## <a name="executing-code-when-theerrorevent-is-raised"></a><span data-ttu-id="f7a3b-120">Ausführen von Code, wenn das`Error`-Ereignis ausgelöst wird</span><span class="sxs-lookup"><span data-stu-id="f7a3b-120">Executing Code When The`Error`Event Is Raised</span></span>

<span data-ttu-id="f7a3b-121">Ereignisse bieten einen Mechanismus, mit dem signalisiert werden kann, dass etwas interessantes aufgetreten ist, und für ein anderes Objekt das Ausführen von Code als Reaktion.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-121">Events provide an object a mechanism for signaling that something interesting has occurred, and for another object to execute code in response.</span></span> <span data-ttu-id="f7a3b-122">Als ASP.NET-Entwickler sind Sie daran gewöhnt, in Bezug auf Ereignisse zu denken.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-122">As an ASP.NET developer you are accustomed to thinking in terms of events.</span></span> <span data-ttu-id="f7a3b-123">Wenn Sie Code ausführen möchten, wenn der Besucher auf eine bestimmte Schaltfläche klickt, erstellen Sie einen Ereignishandler für das `Click`-Ereignis der Schaltfläche, und fügen Sie den Code dort ein.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-123">If you want to run some code when the visitor clicks a particular Button, you create an event handler for that Button's `Click` event and put your code there.</span></span> <span data-ttu-id="f7a3b-124">Da die ASP.NET-Laufzeit das [`Error`-Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) auslöst, wenn eine nicht behandelte Ausnahme auftritt, folgt der Code für die Protokollierung der Fehlerdetails in einem Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-124">Given that the ASP.NET runtime raises its [`Error` event](https://msdn.microsoft.com/library/system.web.httpapplication.error.aspx) whenever an unhandled exception occurs, it follows that the code for logging the error's details would go in an event handler.</span></span> <span data-ttu-id="f7a3b-125">Aber wie erstellen Sie einen Ereignishandler für das `Error` Ereignis?</span><span class="sxs-lookup"><span data-stu-id="f7a3b-125">But how do you create an event handler for the `Error` event?</span></span>

<span data-ttu-id="f7a3b-126">Das `Error` Ereignis ist eines von vielen Ereignissen in der [`HttpApplication`-Klasse](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) , die während der Lebensdauer einer Anforderung in bestimmten Phasen in der HTTP-Pipeline ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-126">The `Error` event is one of many events in the [`HttpApplication` class](https://msdn.microsoft.com/library/system.web.httpapplication.aspx) that are raised at certain stages in the HTTP pipeline during the lifetime of a request.</span></span> <span data-ttu-id="f7a3b-127">Beispielsweise wird das [`BeginRequest` Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) der `HttpApplication` Klasse zu Beginn jeder Anforderung ausgelöst. Das [`AuthenticateRequest` Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) wird ausgelöst, wenn der Anforderer von einem Sicherheitsmodul identifiziert wurde.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-127">For example, the `HttpApplication` class's [`BeginRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.beginrequest.aspx) is raised at the start of every request; its [`AuthenticateRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authenticaterequest.aspx) is raised when a security module has identified the requestor.</span></span> <span data-ttu-id="f7a3b-128">Diese `HttpApplication` Ereignisse haben der Seiten Entwickler die Möglichkeit, benutzerdefinierte Logik an den verschiedenen Punkten der Lebensdauer einer Anforderung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-128">These `HttpApplication` events give the page developer a means to execute custom logic at the various points in the lifetime of a request.</span></span>

<span data-ttu-id="f7a3b-129">Ereignishandler für die `HttpApplication` Ereignisse können in eine spezielle Datei namens `Global.asax`eingefügt werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-129">Event handlers for the `HttpApplication` events can be placed in a special file named `Global.asax`.</span></span> <span data-ttu-id="f7a3b-130">Um diese Datei auf Ihrer Website zu erstellen, fügen Sie dem Stammverzeichnis Ihrer Website ein neues Element mit der globalen Anwendungs Klassen Vorlage mit dem Namen `Global.asax`hinzu.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-130">To create this file in your website, add a new item to the root of your website using the Global Application Class template with the name `Global.asax`.</span></span>

[![](processing-unhandled-exceptions-vb/_static/image2.png)](processing-unhandled-exceptions-vb/_static/image1.png)

<span data-ttu-id="f7a3b-131">**Abbildung 1**: Hinzufügen von `Global.asax` zu Ihrer Webanwendung</span><span class="sxs-lookup"><span data-stu-id="f7a3b-131">**Figure 1**: Add `Global.asax` To Your Web Application</span></span>  
 <span data-ttu-id="f7a3b-132">([Klicken Sie, um das Bild in voller Größe anzuzeigen](processing-unhandled-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f7a3b-132">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image3.png))</span></span>

<span data-ttu-id="f7a3b-133">Der Inhalt und die Struktur der von Visual Studio erstellten `Global.asax` Datei unterscheiden sich geringfügig je nachdem, ob Sie ein Webanwendungs Projekt (WAP) oder ein Website Projekt (WSP) verwenden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-133">The contents and structure of the `Global.asax` file created by Visual Studio differ slightly based on whether you are using a Web Application Project (WAP) or Web Site Project (WSP).</span></span> <span data-ttu-id="f7a3b-134">Bei einem WAP wird der `Global.asax` als zwei separate Dateien implementiert: `Global.asax` und `Global.asax.vb`.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-134">With a WAP, the `Global.asax` is implemented as two separate files - `Global.asax` and `Global.asax.vb`.</span></span> <span data-ttu-id="f7a3b-135">Die `Global.asax` Datei enthält nichts, aber eine `@Application` Direktive, die auf die `.vb` Datei verweist. die Ereignishandler, die von Interesse sind, werden in der `Global.asax.vb`-Datei definiert.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-135">The `Global.asax` file contains nothing but an `@Application` directive that references the `.vb` file; the event handlers of interest are defined in the `Global.asax.vb` file.</span></span> <span data-ttu-id="f7a3b-136">Für wsps wird nur eine einzelne Datei erstellt, `Global.asax`und die Ereignishandler werden in einem `<script runat="server">` Block definiert.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-136">For WSPs, only a single file is created, `Global.asax`, and the event handlers are defined in a `<script runat="server">` block.</span></span>

<span data-ttu-id="f7a3b-137">Die `Global.asax` Datei, die in einem WAP durch die globale Anwendungs Klassen Vorlage von Visual Studio erstellt wurde, enthält Ereignishandler mit dem Namen `Application_BeginRequest`, `Application_AuthenticateRequest`und `Application_Error`, bei denen es sich um Ereignishandler für die `HttpApplication` Ereignisse `BeginRequest`, `AuthenticateRequest`und `Error`handelt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-137">The `Global.asax` file created in a WAP by Visual Studio's Global Application Class template includes event handlers named `Application_BeginRequest`, `Application_AuthenticateRequest`, and `Application_Error`, which are event handlers for the `HttpApplication` events `BeginRequest`, `AuthenticateRequest`, and `Error`, respectively.</span></span> <span data-ttu-id="f7a3b-138">Es gibt auch Ereignishandler mit dem Namen `Application_Start`, `Session_Start`, `Application_End`und `Session_End`, bei denen es sich um Ereignishandler handelt, die beim Start der Webanwendung ausgelöst werden, wenn eine neue Sitzung gestartet wird, wenn die Anwendung beendet wird, bzw. Wenn eine Sitzung beendet wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-138">There are also event handlers named `Application_Start`, `Session_Start`, `Application_End`, and `Session_End`, which are event handlers that fire when the web application starts, when a new session starts, when the application ends, and when a session ends, respectively.</span></span> <span data-ttu-id="f7a3b-139">Die `Global.asax` Datei, die in einem WSP von Visual Studio erstellt wurde, enthält nur die Ereignishandler `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`und `Session_End`.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-139">The `Global.asax` file created in a WSP by Visual Studio contains just the `Application_Error`, `Application_Start`, `Session_Start`, `Application_End`, and `Session_End` event handlers.</span></span>

> [!NOTE]
> <span data-ttu-id="f7a3b-140">Wenn Sie die ASP.NET-Anwendung bereitstellen, müssen Sie die `Global.asax` Datei in die Produktionsumgebung kopieren.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-140">When deploying the ASP.NET application you need to copy the `Global.asax` file to the production environment.</span></span> <span data-ttu-id="f7a3b-141">Die `Global.asax.vb`-Datei, die im WAP erstellt wird, muss nicht in die Produktion kopiert werden, da dieser Code in die Assembly des Projekts kompiliert wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-141">The `Global.asax.vb` file, which is created in the WAP, does not need to be copied to production because this code is compiled into the project's assembly.</span></span>

<span data-ttu-id="f7a3b-142">Die von der globalen Anwendungs Klassen Vorlage von Visual Studio erstellten Ereignishandler sind nicht vollständig.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-142">The event handlers created by Visual Studio's Global Application Class template are not exhaustive.</span></span> <span data-ttu-id="f7a3b-143">Sie können einen Ereignishandler für ein beliebiges `HttpApplication` Ereignis hinzufügen, indem Sie den Ereignishandler `Application_EventName`benennen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-143">You can add an event handler for any `HttpApplication` event by naming the event handler `Application_EventName`.</span></span> <span data-ttu-id="f7a3b-144">Beispielsweise können Sie den folgenden Code in der `Global.asax`-Datei hinzufügen, um einen Ereignishandler für das [`AuthorizeRequest`-Ereignis](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx)zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="f7a3b-144">For example, you could add the following code to the `Global.asax` file to create an event handler for the [`AuthorizeRequest` event](https://msdn.microsoft.com/library/system.web.httpapplication.authorizerequest.aspx):</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample1.vb)]

<span data-ttu-id="f7a3b-145">Ebenso können Sie alle von der globalen Anwendungs Klassen Vorlage erstellten Ereignishandler entfernen, die nicht benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-145">Likewise, you can remove any event handlers created by the Global Application Class template that are not needed.</span></span> <span data-ttu-id="f7a3b-146">Für dieses Tutorial benötigen wir nur einen Ereignishandler für das `Error`-Ereignis. Sie können die anderen Ereignishandler aus der `Global.asax` Datei entfernen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-146">For this tutorial we only require an event handler for the `Error` event; feel free to remove the other event handlers from the `Global.asax` file.</span></span>

> [!NOTE]
> <span data-ttu-id="f7a3b-147">*HTTP-Module* bieten eine weitere Möglichkeit zum Definieren von Ereignis Handlern für `HttpApplication` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-147">*HTTP Modules* offer another way to define event handlers for `HttpApplication` events.</span></span> <span data-ttu-id="f7a3b-148">HTTP-Module werden als Klassendatei erstellt, die direkt innerhalb des Webanwendungs Projekts platziert oder in eine separate Klassenbibliothek aufgeteilt werden kann.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-148">HTTP Modules are created as a class file that can be placed directly within the web application project or separated out into a separate class library.</span></span> <span data-ttu-id="f7a3b-149">Da Sie in eine Klassenbibliothek aufgeteilt werden können, bieten HTTP-Module ein flexibleres und wiederverwendbares Modell zum Erstellen von `HttpApplication` Ereignis Handlern.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-149">Because they can be separated out into a class library, HTTP Modules offer a more flexible and reusable model for creating `HttpApplication` event handlers.</span></span> <span data-ttu-id="f7a3b-150">Während die `Global.asax` Datei spezifisch für die Webanwendung ist, in der Sie sich befindet, können HTTP-Module in Assemblys kompiliert werden. zu diesem Zeitpunkt ist das Hinzufügen des HTTP-Moduls zu einer Website ganz einfach, wenn die Assembly im Ordner `Bin` gelöscht und das Modul in `Web.config`registriert wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-150">Whereas the `Global.asax` file is specific to the web application where it resides, HTTP Modules can be compiled into assemblies, at which point adding the HTTP Module to a website is as simple as dropping the assembly in the `Bin` folder and registering the Module in `Web.config`.</span></span> <span data-ttu-id="f7a3b-151">In diesem Tutorial wird das Erstellen und Verwenden von HTTP-Modulen nicht untersucht. die zwei in den folgenden beiden Tutorials verwendeten Fehler Protokollierungs Bibliotheken werden jedoch als HTTP-Module implementiert.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-151">This tutorial does not look at creating and using HTTP Modules, but the two error logging libraries used in the following two tutorials are implemented as HTTP Modules.</span></span> <span data-ttu-id="f7a3b-152">Weitere Hintergrundinformationen zu den Vorteilen von HTTP-Modulen finden Sie unter [Verwenden von HTTP-Modulen und-Handlern zum Erstellen von austauschbaren ASP.NET-Komponenten](https://msdn.microsoft.com/library/aa479332.aspx).</span><span class="sxs-lookup"><span data-stu-id="f7a3b-152">For more background on the benefits of HTTP Modules refer to [Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components](https://msdn.microsoft.com/library/aa479332.aspx).</span></span>

## <a name="retrieving-information-about-the-unhandled-exception"></a><span data-ttu-id="f7a3b-153">Abrufen von Informationen über die nicht behandelte Ausnahme</span><span class="sxs-lookup"><span data-stu-id="f7a3b-153">Retrieving Information About the Unhandled Exception</span></span>

<span data-ttu-id="f7a3b-154">An dieser Stelle haben wir eine Global. asax-Datei mit einem `Application_Error`-Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-154">At this point we have a Global.asax file with an `Application_Error` event handler.</span></span> <span data-ttu-id="f7a3b-155">Wenn dieser Ereignishandler ausgeführt wird, müssen wir einen Entwickler über den Fehler benachrichtigen und seine Details protokollieren.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-155">When this event handler executes we need to notify a developer of the error and log its details.</span></span> <span data-ttu-id="f7a3b-156">Um diese Aufgaben auszuführen, müssen wir zuerst die Details der ausgelöste Ausnahme bestimmen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-156">To accomplish these tasks we first need to determine the details of the exception that was raised.</span></span> <span data-ttu-id="f7a3b-157">Verwenden Sie die`GetLastError`- [Methode](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) des Server Objekts zum Abrufen der Details der nicht behandelten Ausnahme, die das Auslösen des `Error` Ereignisses bewirkt hat.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-157">Use the Server object's [`GetLastError` method](https://msdn.microsoft.com/library/system.web.httpserverutility.getlasterror.aspx) to retrieve details of the unhandled exception that caused the `Error` event to fire.</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="f7a3b-158">Die `GetLastError`-Methode gibt ein Objekt vom Typ `Exception`zurück. Hierbei handelt es sich um den Basistyp für alle Ausnahmen in der .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-158">The `GetLastError` method returns an object of type `Exception`, which is the base type for all exceptions in the .NET Framework.</span></span> <span data-ttu-id="f7a3b-159">Im obigen Code wird jedoch das vom `GetLastError` zurückgegebene Ausnahme Objekt in ein `HttpException` Objekt umgewandelt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-159">However, in the code above I am casting the Exception object returned by `GetLastError` into an `HttpException` object.</span></span> <span data-ttu-id="f7a3b-160">Wenn das `Error` Ereignis ausgelöst wird, weil eine Ausnahme während der Verarbeitung einer ASP.NET-Ressource ausgelöst wurde, wird die ausgelöste Ausnahme in eine `HttpException`umgerückt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-160">If the `Error` event is being fired because an exception was thrown during the processing of an ASP.NET resource then the exception that was thrown is wrapped within an `HttpException`.</span></span> <span data-ttu-id="f7a3b-161">Um die tatsächliche Ausnahme, die das Fehler Ereignis ausgelöst hat, zu erhalten, verwenden Sie die `InnerException`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-161">To get the actual exception that precipitated the Error event use the `InnerException` property.</span></span> <span data-ttu-id="f7a3b-162">Wenn das `Error` Ereignis aufgrund einer HTTP-basierten Ausnahme ausgelöst wurde (z. b. eine Anforderung für eine nicht vorhandene Seite), wird eine `HttpException` ausgelöst, aber keine innere Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-162">If the `Error` event was raised because of an HTTP-based exception, such as a request for a non-existent page, an `HttpException` is thrown, but it does not have an inner exception.</span></span>

<span data-ttu-id="f7a3b-163">Der folgende Code verwendet die `GetLastErrormessage`, um Informationen über die Ausnahme abzurufen, die das `Error` Ereignis ausgelöst hat, wobei die `HttpException` in einer Variablen mit dem Namen `lastErrorWrapper`gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-163">The following code uses the `GetLastErrormessage` to retrieve information about the exception that triggered the `Error` event, storing the `HttpException` in a variable named `lastErrorWrapper`.</span></span> <span data-ttu-id="f7a3b-164">Anschließend werden der Typ, die Nachricht und die Stapel Überwachung der Ursprungs Ausnahme in drei Zeichen folgen Variablen gespeichert. dabei wird überprüft, ob es sich bei der `lastErrorWrapper` um die eigentliche Ausnahme handelt, die das `Error` Ereignis ausgelöst hat (im Fall von http-basierten Ausnahmen), oder ob es sich um einen Wrapper für eine Ausnahme handelt, die während der Verarbeitung der Anforderung ausgelöst wurde.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-164">It then stores the type, message, and stack trace of the originating exception in three string variables, checking to see if the `lastErrorWrapper` is the actual exception that triggered the `Error` event (in the case of HTTP-based exceptions) or if it's merely a wrapper for an exception that was thrown while processing the request.</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="f7a3b-165">An diesem Punkt verfügen Sie über alle Informationen, die Sie benötigen, um Code zu schreiben, mit dem die Details der Ausnahme in einer Datenbanktabelle protokolliert werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-165">At this point you have all the information you need to write code that will log the exception's details to a database table.</span></span> <span data-ttu-id="f7a3b-166">Sie können eine Datenbanktabelle mit Spalten für alle Fehlerdetails von Interesse erstellen, z. b. den Typ, die Nachricht, die Stapel Überwachung usw., zusammen mit anderen nützlichen Informationen, wie z. b. die URL der angeforderten Seite und den Namen des aktuell angemeldeten Benutzers.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-166">You could create a database table with columns for each of the error details of interest - the type, the message, the stack trace, and so on - along with other useful pieces of information, such as the URL of the requested page and the name of the currently logged on user.</span></span> <span data-ttu-id="f7a3b-167">Im `Application_Error`-Ereignishandler stellen Sie dann eine Verbindung mit der Datenbank her und fügen einen Datensatz in die Tabelle ein.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-167">In the `Application_Error` event handler you would then connect to the database and insert a record into the table.</span></span> <span data-ttu-id="f7a3b-168">Ebenso könnten Sie Code hinzufügen, um einen Entwickler über den Fehler per e-Mail zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-168">Likewise, you could add code to alert a developer of the error via email.</span></span>

<span data-ttu-id="f7a3b-169">Die in den nächsten beiden Tutorials untersuchten Fehler Protokollierungs Bibliotheken stellen eine solche Funktionalität bereit, sodass Sie diese Fehler Protokollierung und Benachrichtigung nicht selbst erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-169">The error logging libraries examined in the next two tutorials provide such functionality out of the box, so there's no need to build this error logging and notification yourself.</span></span> <span data-ttu-id="f7a3b-170">Um jedoch zu veranschaulichen, dass das `Error` Ereignis ausgelöst wird und der `Application_Error`-Ereignishandler zum Protokollieren von Fehlerdetails und zum Benachrichtigen eines Entwicklers verwendet werden kann, fügen Sie Code hinzu, der einen Entwickler benachrichtigt, wenn ein Fehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-170">However, to illustrate that the `Error` event is being raised and that the `Application_Error` event handler can be used to log error details and notify a developer, let's add code that notifies a developer when an error occurs.</span></span>

## <a name="notifying-a-developer-when-an-unhandled-exception-occurs"></a><span data-ttu-id="f7a3b-171">Benachrichtigen eines Entwicklers, wenn eine nicht behandelte Ausnahme auftritt</span><span class="sxs-lookup"><span data-stu-id="f7a3b-171">Notifying a Developer When an Unhandled Exception Occurs</span></span>

<span data-ttu-id="f7a3b-172">Wenn in der Produktionsumgebung eine nicht behandelte Ausnahme auftritt, ist es wichtig, das Entwicklungsteam darauf aufmerksam zu machen, dass Sie den Fehler bewerten und ermitteln können, welche Aktionen ausgeführt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-172">When an unhandled exception occurs in the production environment it is important to alert the development team so that they can assess the error and determine what actions need to be taken.</span></span> <span data-ttu-id="f7a3b-173">Wenn beim Herstellen einer Verbindung mit der Datenbank z. b. ein Fehler auftritt, müssen Sie die Verbindungs Zeichenfolge überprüfen und ggf. ein Support Ticket mit Ihrem Webhostingunternehmen öffnen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-173">For example, if there is an error in connecting to the database then you'll need to double check your connection string and, perhaps, open a support ticket with your web hosting company.</span></span> <span data-ttu-id="f7a3b-174">Wenn die Ausnahme aufgrund eines Programmierfehlers aufgetreten ist, muss möglicherweise zusätzlicher Code oder eine Validierungs Logik hinzugefügt werden, um solche Fehler in der Zukunft zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-174">If the exception occurred because of a programming error, additional code or validation logic may need to be added to prevent such errors in the future.</span></span>

<span data-ttu-id="f7a3b-175">Die .NET Framework Klassen im [`System.Net.Mail`-Namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) erleichtern das Senden einer e-Mail.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-175">The .NET Framework classes in the [`System.Net.Mail` namespace](https://msdn.microsoft.com/library/system.net.mail.aspx) make it easy to send an email.</span></span> <span data-ttu-id="f7a3b-176">Die [`MailMessage`-Klasse](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) stellt eine e-Mail-Nachricht dar und verfügt über Eigenschaften wie `To`, `From`, `Subject`, `Body`und `Attachments`.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-176">The [`MailMessage` class](https://msdn.microsoft.com/library/system.net.mail.mailmessage.aspx) represents an email message and has properties like `To`, `From`, `Subject`, `Body`, and `Attachments`.</span></span> <span data-ttu-id="f7a3b-177">Der `SmtpClass` wird verwendet, um ein `MailMessage` Objekt mithilfe eines angegebenen SMTP-Servers zu senden. die SMTP-Servereinstellungen können Programm gesteuert oder deklarativ im`<system.net>`- [Element](https://msdn.microsoft.com/library/6484zdc1.aspx) in der `Web.config file`angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-177">The `SmtpClass` is used to send a `MailMessage` object using a specified SMTP server; the SMTP server settings can be specified programmatically or declaratively in the [`<system.net>` element](https://msdn.microsoft.com/library/6484zdc1.aspx) in the `Web.config file`.</span></span> <span data-ttu-id="f7a3b-178">Weitere Informationen zum Senden von e-Mail-Nachrichten in einer ASP.NET-Anwendung finden Sie in meinem Artikel, [Senden von e-Mails in ASP.net und in](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)den häufig gestellten Fragen zu [System .net. Mail](http://systemnetmail.com/).</span><span class="sxs-lookup"><span data-stu-id="f7a3b-178">For more information on sending email messages in an ASP.NET application check out my article, [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx), and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>

> [!NOTE]
> <span data-ttu-id="f7a3b-179">Das `<system.net>`-Element enthält die SMTP-Servereinstellungen, die von der `SmtpClient`-Klasse zum Senden einer e-Mail verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-179">The `<system.net>` element contains the SMTP server settings used by the `SmtpClient` class when sending an email.</span></span> <span data-ttu-id="f7a3b-180">Ihr Webhostingunternehmen verfügt wahrscheinlich über einen SMTP-Server, den Sie zum Senden von e-Mails von Ihrer Anwendung verwenden können.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-180">Your web hosting company likely has an SMTP server that you can use to send email from your application.</span></span> <span data-ttu-id="f7a3b-181">Informationen zu den SMTP-Servereinstellungen, die Sie in Ihrer Webanwendung verwenden sollten, finden Sie im Abschnitt zur Unterstützung des Webhosts.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-181">Consult your web host's support section for information on the SMTP server settings you should use in your web application.</span></span>

<span data-ttu-id="f7a3b-182">Fügen Sie dem `Application_Error`-Ereignishandler den folgenden Code hinzu, um dem Entwickler eine e-Mail zu senden, wenn ein Fehler auftritt:</span><span class="sxs-lookup"><span data-stu-id="f7a3b-182">Add the following code to the `Application_Error` event handler to send a developer an email when an error occurs:</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample4.vb)]

<span data-ttu-id="f7a3b-183">Der obige Code ist zwar recht langwierig, aber der größte Teil des Codes erstellt den HTML-Code, der in der e-Mail angezeigt wird, die an den Entwickler gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-183">While the above code is quite lengthy, the bulk of it creates the HTML that appears in the email sent to the developer.</span></span> <span data-ttu-id="f7a3b-184">Der Code beginnt mit dem Verweis auf die `HttpException`, die von der `GetLastError`-Methode (`lastErrorWrapper`) zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-184">The code starts by referencing the `HttpException` returned by the `GetLastError` method (`lastErrorWrapper`).</span></span> <span data-ttu-id="f7a3b-185">Die tatsächliche Ausnahme, die von der Anforderung ausgelöst wurde, wird über `lastErrorWrapper.InnerException` abgerufen und der Variablen `lastError`zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-185">The actual exception that was raised by the request is retrieved via `lastErrorWrapper.InnerException` and is assigned to the variable `lastError`.</span></span> <span data-ttu-id="f7a3b-186">Der Typ, die Nachricht und die Stapel Überwachungsinformationen werden aus `lastError` abgerufen und in drei Zeichen folgen Variablen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-186">The type, message, and stack trace information is retrieved from `lastError` and stored in three string variables.</span></span>

<span data-ttu-id="f7a3b-187">Als nächstes wird ein `MailMessage` Objekt mit dem Namen "`mm`" erstellt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-187">Next, a `MailMessage` object named `mm` is created.</span></span> <span data-ttu-id="f7a3b-188">Der e-Mail-Text ist im HTML-Format formatiert und zeigt die URL der angeforderten Seite, den Namen des aktuell angemeldeten Benutzers und Informationen zur Ausnahme an (Typ, Nachricht und Stapel Überwachung).</span><span class="sxs-lookup"><span data-stu-id="f7a3b-188">The email body is HTML formatted and displays the URL of the requested page, the name of the currently logged on user, and information about the exception (the type, message, and stack trace).</span></span> <span data-ttu-id="f7a3b-189">Eines der coolthings für die `HttpException`-Klasse besteht darin, dass Sie den HTML-Code generieren können, der zum Erstellen der Ausnahme Details gelb Screen of Death (Ysod) durch Aufrufen der [GetHtmlErrorMessage-Methode](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx)verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-189">One of the cool things about the `HttpException` class is that you can generate the HTML used to create the Exception Details Yellow Screen of Death (YSOD) by calling the [GetHtmlErrorMessage method](https://msdn.microsoft.com/library/system.web.httpexception.gethtmlerrormessage.aspx).</span></span> <span data-ttu-id="f7a3b-190">Diese Methode wird hier verwendet, um die Ausnahme Details Ysod-Markup abzurufen und Sie der e-Mail als Anlage hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-190">This method is used here to retrieve the Exception Details YSOD markup and add it to the email as an attachment.</span></span> <span data-ttu-id="f7a3b-191">Eine Vorsicht: Wenn die Ausnahme, die das `Error` Ereignis ausgelöst hat, eine HTTP-basierte Ausnahme war (z. b. eine Anforderung für eine nicht vorhandene Seite), gibt die `GetHtmlErrorMessage`-Methode `null`zurück.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-191">One word of caution: if the exception that triggered the `Error` event was an HTTP-based exception (such as a request for a non-existent page) then the `GetHtmlErrorMessage` method will return `null`.</span></span>

<span data-ttu-id="f7a3b-192">Der letzte Schritt besteht darin, die `MailMessage`zu senden.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-192">The final step is to send the `MailMessage`.</span></span> <span data-ttu-id="f7a3b-193">Dies erfolgt durch Erstellen einer neuen `SmtpClient`-Methode und Aufrufen der `Send`-Methode.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-193">This is done by creating a new `SmtpClient` method and calling its `Send` method.</span></span>

> [!NOTE]
> <span data-ttu-id="f7a3b-194">Bevor Sie diesen Code in Ihrer Webanwendung verwenden, müssen Sie die Werte in den `ToAddress`-und `FromAddress` Konstanten von support@example.com in eine beliebige e-Mail-Adresse ändern, an die die Fehlerbenachrichtigungs-e-Mail gesendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-194">Before using this code in your web application you'll want to change the values in the `ToAddress` and `FromAddress` constants from support@example.com to whatever email address the error notification email should be sent to and originate from.</span></span> <span data-ttu-id="f7a3b-195">Sie müssen auch die SMTP-Servereinstellungen im Abschnitt `<system.net>` in `Web.config`angeben.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-195">You'll also need to specify SMTP server settings in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="f7a3b-196">Überprüfen Sie die zu verwendenden SMTP-Servereinstellungen über Ihren webhostinstanbieter.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-196">Consult your web host provider to determine the SMTP server settings to use.</span></span>

<span data-ttu-id="f7a3b-197">Wenn dieser Code immer vorhanden ist, wird dem Entwickler eine e-Mail-Nachricht gesendet, die den Fehler zusammenfasst und die Ysod enthält.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-197">With this code in place anytime there's an error the developer is sent an email message that summarizes the error and includes the YSOD.</span></span> <span data-ttu-id="f7a3b-198">Im vorangehenden Tutorial haben wir einen Laufzeitfehler durch den Besuch von Genre. aspx und das Übergeben eines ungültigen `ID` Werts über die QueryString, wie `Genre.aspx?ID=foo`, veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-198">In the preceding tutorial we demonstrated a runtime error by visiting Genre.aspx and passing in an invalid `ID` value through the querystring, like `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="f7a3b-199">Wenn Sie die Seite mit der `Global.asax` Datei direkt aufrufen, erhalten Sie dieselbe Benutzerumgebung wie im vorherigen Tutorial: in der Entwicklungsumgebung sehen Sie weiterhin die Ausnahme Details gelbe Bildschirm "Tod", während Sie in der Produktionsumgebung die benutzerdefinierte Fehlerseite sehen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-199">Visiting the page with the `Global.asax` file in place produces the same user experience as in the preceding tutorial - in the development environment you'll continue to see the Exception Details Yellow Screen of Death, while in the production environment you'll see the custom error page.</span></span> <span data-ttu-id="f7a3b-200">Zusätzlich zu diesem vorhandenen Verhalten wird dem Entwickler eine e-Mail gesendet.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-200">In addition to this existing behavior, the developer is sent an email.</span></span>

<span data-ttu-id="f7a3b-201">**Abbildung 2** zeigt die beim Besuch `Genre.aspx?ID=foo`empfangene e-Mail.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-201">**Figure 2** shows the email received when visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="f7a3b-202">Der e-Mail-Text fasst die Ausnahme Informationen zusammen, während die `YSOD.htm` Anlage den Inhalt anzeigt, der in der Ausnahme Details Ysod angezeigt wird (siehe **Abbildung 3**).</span><span class="sxs-lookup"><span data-stu-id="f7a3b-202">The email body summarizes the exception information, while the `YSOD.htm` attachment displays the content that is shown in the Exception Details YSOD (see **Figure 3**).</span></span>

[![](processing-unhandled-exceptions-vb/_static/image5.png)](processing-unhandled-exceptions-vb/_static/image4.png)

<span data-ttu-id="f7a3b-203">**Abbildung 2**: dem Entwickler wird eine e-Mail-Benachrichtigung gesendet, wenn eine nicht behandelte Ausnahme vorliegt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-203">**Figure 2**: The Developer Is Sent An Email Notification Whenever There's An Unhandled Exception</span></span>  
 <span data-ttu-id="f7a3b-204">([Klicken Sie, um das Bild in voller Größe anzuzeigen](processing-unhandled-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f7a3b-204">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image6.png))</span></span>

[![](processing-unhandled-exceptions-vb/_static/image8.png)](processing-unhandled-exceptions-vb/_static/image7.png)

<span data-ttu-id="f7a3b-205">**Abbildung 3**: die e-Mail-Benachrichtigung enthält die Ausnahme Details Ysod als Anlage.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-205">**Figure 3**: The Email Notification Includes the Exception Details YSOD As An Attachment</span></span>  
 <span data-ttu-id="f7a3b-206">([Klicken Sie, um das Bild in voller Größe anzuzeigen](processing-unhandled-exceptions-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f7a3b-206">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image9.png))</span></span>

## <a name="what-about-using-the-custom-error-page"></a><span data-ttu-id="f7a3b-207">Was ist mit der Verwendung der benutzerdefinierten Fehlerseite?</span><span class="sxs-lookup"><span data-stu-id="f7a3b-207">What About Using the Custom Error Page?</span></span>

<span data-ttu-id="f7a3b-208">In diesem Tutorial wurde gezeigt, wie `Global.asax` und der `Application_Error`-Ereignishandler verwendet werden, um Code auszuführen, wenn eine nicht behandelte Ausnahme auftritt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-208">This tutorial showed how to use `Global.asax` and the `Application_Error` event handler to execute code when an unhandled exception occurs.</span></span> <span data-ttu-id="f7a3b-209">Insbesondere wurde dieser Ereignishandler verwendet, um einen Entwickler über einen Fehler zu benachrichtigen. Wir könnten ihn erweitern, um auch die Fehlerdetails in einer Datenbank zu protokollieren.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-209">Specifically, we used this event handler to notify a developer of an error; we could extend it to also log the error details in a database.</span></span> <span data-ttu-id="f7a3b-210">Das vorhanden sein des `Application_Error` Ereignis Handlers wirkt sich nicht auf die Benutzeroberflächen des Endbenutzers aus.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-210">The presence of the `Application_Error` event handler does not affect the end user's experience.</span></span> <span data-ttu-id="f7a3b-211">Die konfigurierte Fehlerseite wird weiterhin angezeigt. dabei handelt es sich um die Fehler Details Ysod, den Laufzeitfehler Ysod oder die benutzerdefinierte Fehlerseite.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-211">They still see the configured error page, be it the Error Details YSOD, the Runtime Error YSOD, or the custom error page.</span></span>

<span data-ttu-id="f7a3b-212">Wenn eine benutzerdefinierte Fehlerseite verwendet wird, sollten Sie sich natürlich wundern, ob die `Global.asax`-Datei und das `Application_Error` Ereignis notwendig sind.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-212">It's natural to wonder whether the `Global.asax` file and `Application_Error` event is necessary when using a custom error page.</span></span> <span data-ttu-id="f7a3b-213">Wenn ein Fehler auftritt, wird dem Benutzer die benutzerdefinierte Fehlerseite angezeigt. Warum kann der Code nicht zum Benachrichtigen des Entwicklers und zum Protokollieren der Fehlerdetails in der Code-Behind-Klasse der benutzerdefinierten Fehlerseite hinzugefügt werden?</span><span class="sxs-lookup"><span data-stu-id="f7a3b-213">When an error occurs the user is shown the custom error page so why can't we put the code to notify the developer and log the error details into the code-behind class of the custom error page?</span></span> <span data-ttu-id="f7a3b-214">Obwohl Sie der Code Behind-Klasse der benutzerdefinierten Fehlerseite Code hinzufügen können, haben Sie keinen Zugriff auf die Details der Ausnahme, die das `Error` Ereignis ausgelöst hat, wenn Sie das Verfahren verwenden, das wir im vorherigen Tutorial untersucht haben.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-214">While you can certainly add code to the custom error page's code-behind class you do not have access to the details of the exception that triggered the `Error` event when using the technique we explored in the preceding tutorial.</span></span> <span data-ttu-id="f7a3b-215">Wenn Sie die `GetLastError` Methode von der benutzerdefinierten Fehlerseite aufrufen, wird `Nothing`zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-215">Calling the `GetLastError` method from the custom error page returns `Nothing`.</span></span>

<span data-ttu-id="f7a3b-216">Der Grund für dieses Verhalten liegt darin, dass die benutzerdefinierte Fehlerseite über eine Umleitung erreicht wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-216">The reason for this behavior is because the custom error page is reached via a redirect.</span></span> <span data-ttu-id="f7a3b-217">Wenn eine nicht behandelte Ausnahme die ASP.NET Runtime erreicht, löst die ASP.net-Engine das `Error`-Ereignis aus (das den `Application_Error`-Ereignishandler ausführt) und *leitet* den Benutzer dann zur benutzerdefinierten Fehlerseite um, indem ein `Response.Redirect(customErrorPageUrl)`ausgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-217">When an unhandled exception reaches the ASP.NET runtime the ASP.NET engine raises its `Error` event (which executes the `Application_Error` event handler) and then *redirects* the user to the custom error page by issuing a `Response.Redirect(customErrorPageUrl)`.</span></span> <span data-ttu-id="f7a3b-218">Die `Response.Redirect`-Methode sendet eine Antwort an den Client mit dem Statuscode HTTP 302, der den Browser anweist, eine neue URL anzufordern, nämlich die benutzerdefinierte Fehlerseite.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-218">The `Response.Redirect` method sends a response to the client with an HTTP 302 status code, instructing the browser to request a new URL, namely the custom error page.</span></span> <span data-ttu-id="f7a3b-219">Der Browser fordert diese neue Seite dann automatisch an.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-219">The browser then automatically requests this new page.</span></span> <span data-ttu-id="f7a3b-220">Sie können feststellen, dass die benutzerdefinierte Fehlerseite separat von der Seite angefordert wurde, aus der der Fehler entstanden ist, weil die Adressleiste des Browsers in die URL der benutzerdefinierten Fehlerseite wechselt (siehe **Abbildung 4**).</span><span class="sxs-lookup"><span data-stu-id="f7a3b-220">You can tell that the custom error page was requested separately from the page where the error originated because the browser's Address bar changes to the custom error page URL (see **Figure 4**).</span></span>

[![](processing-unhandled-exceptions-vb/_static/image11.png)](processing-unhandled-exceptions-vb/_static/image10.png)

<span data-ttu-id="f7a3b-221">**Abbildung 4**: Wenn ein Fehler auftritt, wird der Browser an die URL der benutzerdefinierten Fehlerseite umgeleitet.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-221">**Figure 4**: When an Error Occurs the Browser Gets Redirected to the Custom Error Page URL</span></span>  
 <span data-ttu-id="f7a3b-222">([Klicken Sie, um das Bild in voller Größe anzuzeigen](processing-unhandled-exceptions-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f7a3b-222">([Click to view full-size image](processing-unhandled-exceptions-vb/_static/image12.png))</span></span>

<span data-ttu-id="f7a3b-223">Der Nettoeffekt ist, dass die Anforderung, bei der die nicht behandelte Ausnahme aufgetreten ist, beendet wird, wenn der Server mit der HTTP 302-Umleitung antwortet.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-223">The net effect is that the request where the unhandled exception occurred ends when the server responds with the HTTP 302 redirect.</span></span> <span data-ttu-id="f7a3b-224">Bei der nachfolgenden Anforderung an die benutzerdefinierte Fehlerseite handelt es sich um eine Brand neue Anforderung. an diesem Punkt hat das ASP.NET-Modul die Fehlerinformationen verworfen und verfügt darüber hinaus nicht über die Möglichkeit, die nicht behandelte Ausnahme in der vorherigen Anforderung der neuen Anforderung für die benutzerdefinierte Fehlerseite zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-224">The subsequent request to the custom error page is a brand new request; by this point the ASP.NET engine has discarded the error information and, moreover, has no way to associate the unhandled exception in the previous request with the new request for the custom error page.</span></span> <span data-ttu-id="f7a3b-225">Aus diesem Grund gibt `GetLastError` `null` zurück, wenn es von der benutzerdefinierten Fehlerseite aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-225">This is why `GetLastError` returns `null` when called from the custom error page.</span></span>

<span data-ttu-id="f7a3b-226">Es ist jedoch möglich, dass die benutzerdefinierte Fehlerseite während der gleichen Anforderung ausgeführt wird, die den Fehler verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-226">However, it is possible to have the custom error page executed during the same request that caused the error.</span></span> <span data-ttu-id="f7a3b-227">Mit der [`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) -Methode wird die Ausführung an die angegebene URL übertragen und innerhalb derselben Anforderung verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-227">The [`Server.Transfer(url)`](https://msdn.microsoft.com/library/system.web.httpserverutility.transfer.aspx) method transfers execution to the specified URL and processes it within the same request.</span></span> <span data-ttu-id="f7a3b-228">Sie können den Code im `Application_Error`-Ereignishandler in die Code Behind-Klasse der benutzerdefinierten Fehlerseite verschieben und `Global.asax` Sie durch den folgenden Code ersetzen:</span><span class="sxs-lookup"><span data-stu-id="f7a3b-228">You could move the code in the `Application_Error` event handler to the custom error page's code-behind class, replacing it in `Global.asax` with the following code:</span></span>

[!code-vb[Main](processing-unhandled-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="f7a3b-229">Wenn eine nicht behandelte Ausnahme auftritt, überträgt der `Application_Error` Ereignishandler die Steuerung auf der Grundlage des HTTP-Statuscodes an die entsprechende benutzerdefinierte Fehlerseite.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-229">Now when an unhandled exception occurs the `Application_Error` event handler transfers control to the appropriate custom error page based on the HTTP status code.</span></span> <span data-ttu-id="f7a3b-230">Da das Steuerelement übertragen wurde, kann die benutzerdefinierte Fehlerseite über `Server.GetLastError` auf die Informationen zur Ausnahme Ausnahme zugreifen und den Entwickler über den Fehler informieren und seine Details protokollieren.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-230">Because control was transferred, the custom error page has access to the unhandled exception information via `Server.GetLastError` and can notify a developer of the error and log its details.</span></span> <span data-ttu-id="f7a3b-231">Der `Server.Transfer`-Befehl beendet die ASP.net-Engine daran, den Benutzer an die benutzerdefinierte Fehlerseite weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-231">The `Server.Transfer` call stops the ASP.NET engine from redirecting the user to the custom error page.</span></span> <span data-ttu-id="f7a3b-232">Stattdessen wird der Inhalt der benutzerdefinierten Fehlerseite als Antwort auf die Seite zurückgegeben, die den Fehler generiert hat.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-232">Instead, the custom error page's content is returned as the response to the page that generated the error.</span></span>

## <a name="summary"></a><span data-ttu-id="f7a3b-233">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="f7a3b-233">Summary</span></span>

<span data-ttu-id="f7a3b-234">Wenn eine nicht behandelte Ausnahme in einer ASP.NET-Webanwendung auftritt, löst die ASP.NET-Laufzeit das `Error`-Ereignis aus und zeigt die konfigurierte Fehlerseite an.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-234">When an unhandled exception occurs in an ASP.NET web application the ASP.NET runtime raises the `Error` event and displays the configured error page.</span></span> <span data-ttu-id="f7a3b-235">Wir können den Entwickler über den Fehler benachrichtigen, seine Details protokollieren oder auf andere Weise verarbeiten, indem Sie einen Ereignishandler für das Fehler Ereignis erstellen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-235">We can notify the developer of the error, log its details, or process it in some other fashion, by creating an event handler for the Error event.</span></span> <span data-ttu-id="f7a3b-236">Es gibt zwei Möglichkeiten, einen Ereignishandler für `HttpApplication` Ereignisse wie `Error`zu erstellen: in der `Global.asax`-Datei oder in einem HTTP-Modul.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-236">There are two ways to create an event handler for `HttpApplication` events like `Error`: in the `Global.asax` file or from an HTTP Module.</span></span> <span data-ttu-id="f7a3b-237">In diesem Tutorial wurde gezeigt, wie Sie einen `Error` Ereignishandler in der `Global.asax`-Datei erstellen, die Entwicklern über einen Fehler über eine e-Mail-Nachricht benachrichtigt.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-237">This tutorial showed how to create an `Error` event handler in the `Global.asax` file that notifies developers of an error by means of an email message.</span></span>

<span data-ttu-id="f7a3b-238">Das Erstellen eines `Error` Ereignis Handlers ist nützlich, wenn Sie nicht behandelte Ausnahmen auf eindeutige oder angepasste Weise verarbeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-238">Creating an `Error` event handler is useful if you need to process unhandled exceptions in some unique or customized manner.</span></span> <span data-ttu-id="f7a3b-239">Das Erstellen eines eigenen `Error` Ereignis Handlers zum Protokollieren der Ausnahme oder zum Benachrichtigen eines Entwicklers ist jedoch nicht die effizienteste Verwendung ihrer Zeit, da bereits eine kostenlose und leicht zu verwendende Fehler Protokollierungs Bibliothek vorhanden ist, die innerhalb weniger Minuten eingerichtet werden kann.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-239">However, creating your own `Error` event handler to log the exception or to notify a developer is not the most efficient use of your time as there already exist free and easy to use error logging libraries that can be setup in a matter of minutes.</span></span> <span data-ttu-id="f7a3b-240">In den nächsten beiden Tutorials werden zwei solcher Bibliotheken untersucht.</span><span class="sxs-lookup"><span data-stu-id="f7a3b-240">The next two tutorials examine two such libraries.</span></span>

<span data-ttu-id="f7a3b-241">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="f7a3b-241">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f7a3b-242">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="f7a3b-242">Further Reading</span></span>

<span data-ttu-id="f7a3b-243">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="f7a3b-243">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f7a3b-244">ASP.net Übersicht über HTTP-Module und HTTP-Handler</span><span class="sxs-lookup"><span data-stu-id="f7a3b-244">ASP.NET HTTP Modules and HTTP Handlers Overview</span></span>](https://support.microsoft.com/kb/307985)
- [<span data-ttu-id="f7a3b-245">Ordnungsgemäße Reaktion auf nicht behandelte Ausnahmen: Verarbeitung nicht behandelter Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="f7a3b-245">Gracefully Responding to Unhandled Exceptions - Processing Unhandled Exceptions</span></span>](http://aspnet.4guysfromrolla.com/articles/091306-1.aspx)
- [<span data-ttu-id="f7a3b-246">`HttpApplication`-Klasse und das ASP.NET-Anwendungs Objekt</span><span class="sxs-lookup"><span data-stu-id="f7a3b-246">`HttpApplication` Class and the ASP.NET Application Object</span></span>](http://www.eggheadcafe.com/articles/20030211.asp)
- [<span data-ttu-id="f7a3b-247">HTTP-Handler und HTTP-Module in ASP.net</span><span class="sxs-lookup"><span data-stu-id="f7a3b-247">HTTP Handlers and HTTP Modules in ASP.NET</span></span>](http://www.15seconds.com/Issue/020417.htm)
- [<span data-ttu-id="f7a3b-248">Senden von e-Mails in ASP.net</span><span class="sxs-lookup"><span data-stu-id="f7a3b-248">Sending Email in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx)
- [<span data-ttu-id="f7a3b-249">Grundlegendes zur `Global.asax` Datei</span><span class="sxs-lookup"><span data-stu-id="f7a3b-249">Understanding the `Global.asax` File</span></span>](http://aspalliance.com/1114_Understanding_the_Globalasax_file.all)
- [<span data-ttu-id="f7a3b-250">Verwenden von HTTP-Modulen und-Handlern zum Erstellen von austauschbaren ASP.NET-Komponenten</span><span class="sxs-lookup"><span data-stu-id="f7a3b-250">Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components</span></span>](https://msdn.microsoft.com/library/aa479332.aspx)
- [<span data-ttu-id="f7a3b-251">Arbeiten mit der ASP.net-`Global.asax` Datei</span><span class="sxs-lookup"><span data-stu-id="f7a3b-251">Working with the ASP.NET `Global.asax` File</span></span>](http://articles.techrepublic.com.com/5100-10878_11-5771721.html)
- [<span data-ttu-id="f7a3b-252">Arbeiten mit `HttpApplication`-Instanzen</span><span class="sxs-lookup"><span data-stu-id="f7a3b-252">Working with `HttpApplication` Instances</span></span>](https://msdn.microsoft.com/library/a0xez8f2.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="f7a3b-253">[Zurück](displaying-a-custom-error-page-vb.md)
> [Weiter](logging-error-details-with-asp-net-health-monitoring-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f7a3b-253">[Previous](displaying-a-custom-error-page-vb.md)
[Next](logging-error-details-with-asp-net-health-monitoring-vb.md)</span></span>
