---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
title: Einführung in Entity Framework 4,0 Database First und ASP.NET 4 Web Forms-Part 4 | Microsoft-Dokumentation
author: tdykstra
description: Die Beispiel-Webanwendung der Beispiel-Web-App veranschaulicht, wie Sie mithilfe der Entity Framework Web Forms Anwendungen erstellen. Die Beispielanwendung ist...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: ceb9e60f-957c-4d25-9331-cc527de96a33
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-4
msc.type: authoredcontent
ms.openlocfilehash: eb75a76038466bf30738387ed4739687de1df944
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78518283"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-4"></a><span data-ttu-id="07f00-104">Ersten Schritte mit Entity Framework 4,0 Database First und ASP.NET 4 Web Forms-Teil 4</span><span class="sxs-lookup"><span data-stu-id="07f00-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 4</span></span>

<span data-ttu-id="07f00-105">von [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="07f00-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="07f00-106">Die Beispiel-Webanwendung der Beispiel-Web-App veranschaulicht, wie Sie ASP.net-Web Forms Anwendungen mithilfe von Entity Framework 4,0 und Visual Studio 2010 erstellen.</span><span class="sxs-lookup"><span data-stu-id="07f00-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="07f00-107">Weitere Informationen zur tutorialreihe finden Sie [im ersten Tutorial der Reihe](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="07f00-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="working-with-related-data"></a><span data-ttu-id="07f00-108">Arbeiten mit verwandten Daten</span><span class="sxs-lookup"><span data-stu-id="07f00-108">Working with Related Data</span></span>

<span data-ttu-id="07f00-109">Im vorherigen Tutorial haben Sie das `EntityDataSource`-Steuerelement verwendet, um Daten zu filtern, zu sortieren und zu gruppieren.</span><span class="sxs-lookup"><span data-stu-id="07f00-109">In the previous tutorial you used the `EntityDataSource` control to filter, sort, and group data.</span></span> <span data-ttu-id="07f00-110">In diesem Tutorial werden verwandte Daten angezeigt und aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="07f00-110">In this tutorial you'll display and update related data.</span></span>

<span data-ttu-id="07f00-111">Sie erstellen die Seite Dozenten, auf der eine Liste der Dozenten angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="07f00-111">You'll create the Instructors page that shows a list of instructors.</span></span> <span data-ttu-id="07f00-112">Wenn Sie einen Dozenten auswählen, wird eine Liste der Kurse angezeigt, die von diesem Dozenten gelehrt werden.</span><span class="sxs-lookup"><span data-stu-id="07f00-112">When you select an instructor, you see a list of courses taught by that instructor.</span></span> <span data-ttu-id="07f00-113">Wenn Sie einen Kurs auswählen, werden die Details für den Kurs und eine Liste der im Kurs registrierten Studenten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07f00-113">When you select a course, you see details for the course and a list of students enrolled in the course.</span></span> <span data-ttu-id="07f00-114">Sie können den Namen des Dozenten, das Einstellungs Datum und die Büro Zuweisung bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="07f00-114">You can edit the instructor name, hire date, and office assignment.</span></span> <span data-ttu-id="07f00-115">Die Office-Zuweisung ist eine separate Entitätenmenge, auf die Sie über eine Navigations Eigenschaft zugreifen.</span><span class="sxs-lookup"><span data-stu-id="07f00-115">The office assignment is a separate entity set that you access through a navigation property.</span></span>

<span data-ttu-id="07f00-116">Sie können Master Daten mit Detaildaten in Markup oder im Code verknüpfen.</span><span class="sxs-lookup"><span data-stu-id="07f00-116">You can link master data to detail data in markup or in code.</span></span> <span data-ttu-id="07f00-117">In diesem Teil des Tutorials verwenden Sie beide Methoden.</span><span class="sxs-lookup"><span data-stu-id="07f00-117">In this part of the tutorial, you'll use both methods.</span></span>

<span data-ttu-id="07f00-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-118">[![Image01](the-entity-framework-and-aspnet-getting-started-part-4/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image1.png)</span></span>

## <a name="displaying-and-updating-related-entities-in-a-gridview-control"></a><span data-ttu-id="07f00-119">Anzeigen und aktualisieren verwandter Entitäten in einem GridView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="07f00-119">Displaying and Updating Related Entities in a GridView Control</span></span>

<span data-ttu-id="07f00-120">Erstellen Sie eine neue Webseite namens " *Dozenten. aspx* ", die die Master Seite " *Site. Master* " verwendet, und fügen Sie das folgende Markup zum `Content`-Steuerelement mit dem Namen `Content2`hinzu:</span><span class="sxs-lookup"><span data-stu-id="07f00-120">Create a new web page named *Instructors.aspx* that uses the *Site.Master* master page, and add the following markup to the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample1.aspx)]

<span data-ttu-id="07f00-121">Dieses Markup erstellt ein `EntityDataSource` Steuerelement, das Dozenten auswählt und Updates aktiviert.</span><span class="sxs-lookup"><span data-stu-id="07f00-121">This markup creates an `EntityDataSource` control that selects instructors and enables updates.</span></span> <span data-ttu-id="07f00-122">Das `div`-Element konfiguriert Markup so, dass es auf der linken Seite dargestellt wird, sodass Sie später eine-Spalte hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="07f00-122">The `div` element configures markup to render on the left so that you can add a column on the right later.</span></span>

<span data-ttu-id="07f00-123">Fügen Sie zwischen dem `EntityDataSource` Markup und dem schließenden `</div>`-Tag das folgende Markup hinzu, das ein `GridView`-Steuerelement und ein `Label` Steuerelement erstellt, das Sie für Fehlermeldungen verwenden:</span><span class="sxs-lookup"><span data-stu-id="07f00-123">Between the `EntityDataSource` markup and the closing `</div>` tag, add the following markup that creates a `GridView` control and a `Label` control that you'll use for error messages:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample2.aspx)]

<span data-ttu-id="07f00-124">Dieses `GridView` Steuerelement aktiviert die Zeilenauswahl, hebt die ausgewählte Zeile mit einer hellgrauen Hintergrundfarbe hervor und gibt Handler (die Sie später erstellen) für die `SelectedIndexChanged`-und `Updating`-Ereignisse an.</span><span class="sxs-lookup"><span data-stu-id="07f00-124">This `GridView` control enables row selection, highlights the selected row with a light gray background color, and specifies handlers (which you'll create later) for the `SelectedIndexChanged` and `Updating` events.</span></span> <span data-ttu-id="07f00-125">Außerdem gibt Sie `PersonID` für die `DataKeyNames`-Eigenschaft an, sodass der Schlüsselwert der ausgewählten Zeile an ein anderes Steuerelement weitergegeben werden kann, das Sie später hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="07f00-125">It also specifies `PersonID` for the `DataKeyNames` property, so that the key value of the selected row can be passed to another control that you'll add later.</span></span>

<span data-ttu-id="07f00-126">Die letzte Spalte enthält die Büro Zuweisung des Dozenten, die in einer Navigations Eigenschaft der `Person` Entität gespeichert wird, da Sie von einer zugeordneten Entität stammt.</span><span class="sxs-lookup"><span data-stu-id="07f00-126">The last column contains the instructor's office assignment, which is stored in a navigation property of the `Person` entity because it comes from an associated entity.</span></span> <span data-ttu-id="07f00-127">Beachten Sie, dass das `EditItemTemplate` Element `Eval` anstelle von `Bind`angibt, da das `GridView` Steuerelement nicht direkt an Navigations Eigenschaften gebunden werden kann, um Sie zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="07f00-127">Notice that the `EditItemTemplate` element specifies `Eval` instead of `Bind`, because the `GridView` control cannot directly bind to navigation properties in order to update them.</span></span> <span data-ttu-id="07f00-128">Die Office-Zuweisung wird im Code aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="07f00-128">You'll update the office assignment in code.</span></span> <span data-ttu-id="07f00-129">Zu diesem Zweck benötigen Sie einen Verweis auf das `TextBox`-Steuerelement, das Sie im `Init` Ereignis des `TextBox`-Steuer Elements speichern und speichern können.</span><span class="sxs-lookup"><span data-stu-id="07f00-129">To do that, you'll need a reference to the `TextBox` control, and you'll get and save that in the `TextBox` control's `Init` event.</span></span>

<span data-ttu-id="07f00-130">Nach dem `GridView`-Steuerelement handelt es sich um ein `Label` Steuerelement, das für Fehlermeldungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="07f00-130">Following the `GridView` control is a `Label` control that's used for error messages.</span></span> <span data-ttu-id="07f00-131">Die `Visible`-Eigenschaft des Steuer Elements ist `false`, und der Ansichts Zustand ist deaktiviert, sodass die Bezeichnung nur dann angezeigt wird, wenn der Code Sie als Reaktion auf einen Fehler sichtbar macht.</span><span class="sxs-lookup"><span data-stu-id="07f00-131">The control's `Visible` property is `false`, and view state is turned off, so that the label will appear only when code makes it visible in response to an error.</span></span>

<span data-ttu-id="07f00-132">Öffnen Sie die Datei *Instructors.aspx.cs* , und fügen Sie die folgende `using`-Anweisung hinzu:</span><span class="sxs-lookup"><span data-stu-id="07f00-132">Open the *Instructors.aspx.cs* file and add the following `using` statement:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample3.cs)]

<span data-ttu-id="07f00-133">Fügen Sie direkt nach der Deklaration der partiellen Klassennamen ein privates Klassenfeld hinzu, um einen Verweis auf das Textfeld für die Office-Zuweisung zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="07f00-133">Add a private class field immediately after the partial-class name declaration to hold a reference to the office assignment text box.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample4.cs)]

<span data-ttu-id="07f00-134">Fügen Sie einen Stub für den `SelectedIndexChanged` Ereignishandler hinzu, für den Sie später Code hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="07f00-134">Add a stub for the `SelectedIndexChanged` event handler that you'll add code for later.</span></span> <span data-ttu-id="07f00-135">Fügen Sie außerdem einen Handler für das `Init` Ereignis des Office-Zuweisungs `TextBox`-Steuer Elements hinzu, damit Sie einen Verweis auf das `TextBox`-Steuerelement speichern können.</span><span class="sxs-lookup"><span data-stu-id="07f00-135">Also add a handler for the office assignment `TextBox` control's `Init` event so that you can store a reference to the `TextBox` control.</span></span> <span data-ttu-id="07f00-136">Sie verwenden diese Referenz, um den Wert zu erhalten, den der Benutzer eingegeben hat, um die mit der Navigations Eigenschaft verknüpfte Entität zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="07f00-136">You'll use this reference to get the value the user entered in order to update the entity associated with the navigation property.</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample5.cs)]

<span data-ttu-id="07f00-137">Sie verwenden das `Updating`-Ereignis des `GridView`-Steuer Elements, um die `Location`-Eigenschaft der zugeordneten `OfficeAssignment` Entität zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="07f00-137">You'll use the `GridView` control's `Updating` event to update the `Location` property of the associated `OfficeAssignment` entity.</span></span> <span data-ttu-id="07f00-138">Fügen Sie den folgenden Handler für das `Updating`-Ereignis hinzu:</span><span class="sxs-lookup"><span data-stu-id="07f00-138">Add the following handler for the `Updating` event:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample6.cs)]

<span data-ttu-id="07f00-139">Dieser Code wird ausgeführt, wenn der Benutzer in einer `GridView` Zeile auf **Aktualisieren** klickt.</span><span class="sxs-lookup"><span data-stu-id="07f00-139">This code is run when the user clicks **Update** in a `GridView` row.</span></span> <span data-ttu-id="07f00-140">Der Code verwendet LINQ to Entities, um die `OfficeAssignment` Entität abzurufen, die der aktuellen `Person` Entität zugeordnet ist. dabei wird die `PersonID` der ausgewählten Zeile aus dem Ereignis Argument verwendet.</span><span class="sxs-lookup"><span data-stu-id="07f00-140">The code uses LINQ to Entities to retrieve the `OfficeAssignment` entity that's associated with the current `Person` entity, using the `PersonID` of the selected row from the event argument.</span></span>

<span data-ttu-id="07f00-141">Der Code führt dann abhängig von dem Wert im `InstructorOfficeTextBox` Steuerelement eine der folgenden Aktionen aus:</span><span class="sxs-lookup"><span data-stu-id="07f00-141">The code then takes one of the following actions depending on the value in the `InstructorOfficeTextBox` control:</span></span>

- <span data-ttu-id="07f00-142">Wenn das Textfeld einen Wert hat und keine zu Aktualisier `OfficeAssignment` Entität vorhanden ist, wird eines erstellt.</span><span class="sxs-lookup"><span data-stu-id="07f00-142">If the text box has a value and there's no `OfficeAssignment` entity to update, it creates one.</span></span>
- <span data-ttu-id="07f00-143">Wenn das Textfeld einen Wert enthält und eine `OfficeAssignment` Entität vorhanden ist, aktualisiert es den Wert der `Location`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="07f00-143">If the text box has a value and there's an `OfficeAssignment` entity, it updates the `Location` property value.</span></span>
- <span data-ttu-id="07f00-144">Wenn das Textfeld leer ist und eine `OfficeAssignment` Entität vorhanden ist, wird die Entität gelöscht.</span><span class="sxs-lookup"><span data-stu-id="07f00-144">If the text box is empty and an `OfficeAssignment` entity exists, it deletes the entity.</span></span>

<span data-ttu-id="07f00-145">Anschließend werden die Änderungen in der Datenbank gespeichert.</span><span class="sxs-lookup"><span data-stu-id="07f00-145">After this, it saves the changes to the database.</span></span> <span data-ttu-id="07f00-146">Wenn eine Ausnahme auftritt, wird eine Fehlermeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07f00-146">If an exception occurs, it displays an error message.</span></span>

<span data-ttu-id="07f00-147">Führen Sie die Seite aus.</span><span class="sxs-lookup"><span data-stu-id="07f00-147">Run the page.</span></span>

<span data-ttu-id="07f00-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-148">[![Image02](the-entity-framework-and-aspnet-getting-started-part-4/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image3.png)</span></span>

<span data-ttu-id="07f00-149">Klicken Sie auf **Bearbeiten** , und ändern Sie alle Felder in Textfelder.</span><span class="sxs-lookup"><span data-stu-id="07f00-149">Click **Edit** and all fields change to text boxes.</span></span>

<span data-ttu-id="07f00-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-150">[![Image03](the-entity-framework-and-aspnet-getting-started-part-4/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image5.png)</span></span>

<span data-ttu-id="07f00-151">Ändern Sie die Werte, einschließlich der **Office-Zuweisung**.</span><span class="sxs-lookup"><span data-stu-id="07f00-151">Change any of these values, including **Office Assignment**.</span></span> <span data-ttu-id="07f00-152">Klicken Sie auf **Aktualisieren** , und die Änderungen werden in der Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07f00-152">Click **Update** and you'll see the changes reflected in the list.</span></span>

## <a name="displaying-related-entities-in-a-separate-control"></a><span data-ttu-id="07f00-153">Anzeigen verwandter Entitäten in einem separaten Steuerelement</span><span class="sxs-lookup"><span data-stu-id="07f00-153">Displaying Related Entities in a Separate Control</span></span>

<span data-ttu-id="07f00-154">Jeder Dozenten kann einen oder mehrere Kurse unterrichten. daher fügen Sie ein `EntityDataSource`-Steuerelement und ein `GridView`-Steuerelement hinzu, um die Kurse aufzulisten, die mit dem in den Dozenten `GridView`-Steuerelement verknüpften Dozenten verknüpft sind.</span><span class="sxs-lookup"><span data-stu-id="07f00-154">Each instructor can teach one or more courses, so you'll add an `EntityDataSource` control and a `GridView` control to list the courses associated with whichever instructor is selected in the instructors `GridView` control.</span></span> <span data-ttu-id="07f00-155">Fügen Sie zum Erstellen einer Überschrift und der `EntityDataSource`-Steuerelement für Kurs Entitäten das folgende Markup zwischen der Fehlermeldung `Label`-Steuerelement und dem schließenden `</div>`-Tag hinzu:</span><span class="sxs-lookup"><span data-stu-id="07f00-155">To create a heading and the `EntityDataSource` control for courses entities, add the following markup between the error message `Label` control and the closing `</div>` tag:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample7.aspx)]

<span data-ttu-id="07f00-156">Der `Where`-Parameter enthält den Wert des `PersonID` des Dozenten, dessen Zeile im `InstructorsGridView`-Steuerelement ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-156">The `Where` parameter contains the value of the `PersonID` of the instructor whose row is selected in the `InstructorsGridView` control.</span></span> <span data-ttu-id="07f00-157">Die `Where`-Eigenschaft enthält einen untergeordneten SELECT-Befehl, der alle zugeordneten `Person` Entitäten aus der `People` Navigations Eigenschaft einer `Course` Entität abruft und die `Course` Entität nur dann auswählt, wenn eine der zugeordneten `Person` Entitäten den ausgewählten `PersonID` Wert enthält.</span><span class="sxs-lookup"><span data-stu-id="07f00-157">The `Where` property contains a subselect command that gets all associated `Person` entities from a `Course` entity's `People` navigation property and selects the `Course` entity only if one of the associated `Person` entities contains the selected `PersonID` value.</span></span>

<span data-ttu-id="07f00-158">Um das `GridView` Steuerelement zu erstellen, fügen Sie das folgende Markup direkt nach dem Steuerelement `CoursesEntityDataSource` (vor dem schließenden `</div>`-Tag) hinzu:</span><span class="sxs-lookup"><span data-stu-id="07f00-158">To create the `GridView` control., add the following markup immediately following the `CoursesEntityDataSource` control (before the closing `</div>` tag):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample8.aspx)]

<span data-ttu-id="07f00-159">Da keine Kurse angezeigt werden, wenn kein Dozenten ausgewählt ist, wird ein `EmptyDataTemplate`-Element eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="07f00-159">Because no courses will be displayed if no instructor is selected, an `EmptyDataTemplate` element is included.</span></span>

<span data-ttu-id="07f00-160">Führen Sie die Seite aus.</span><span class="sxs-lookup"><span data-stu-id="07f00-160">Run the page.</span></span>

<span data-ttu-id="07f00-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-161">[![Image04](the-entity-framework-and-aspnet-getting-started-part-4/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image7.png)</span></span>

<span data-ttu-id="07f00-162">Wählen Sie einen Dozenten aus, dem ein oder mehrere Kurse zugewiesen sind, und der Kurs oder die Kurse werden in der Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="07f00-162">Select an instructor who has one or more courses assigned, and the course or courses appear in the list.</span></span> <span data-ttu-id="07f00-163">(Hinweis: Obwohl das Datenbankschema mehrere Kurse zulässt, verfügt der Dozenten in den Testdaten, die in der Datenbank bereitgestellt werden, über mehr als einen Kurs.</span><span class="sxs-lookup"><span data-stu-id="07f00-163">(Note: although the database schema allows multiple courses, in the test data supplied with the database no instructor actually has more than one course.</span></span> <span data-ttu-id="07f00-164">Sie können der Datenbank selbst Kurse mithilfe des **Server-Explorer** Fensters oder der Seite " *coursesadd. aspx* " hinzufügen, die Sie in einem späteren Tutorial hinzufügen.)</span><span class="sxs-lookup"><span data-stu-id="07f00-164">You can add courses to the database yourself using the **Server Explorer** window or the *CoursesAdd.aspx* page, which you'll add in a later tutorial.)</span></span>

<span data-ttu-id="07f00-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-165">[![Image05](the-entity-framework-and-aspnet-getting-started-part-4/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image9.png)</span></span>

<span data-ttu-id="07f00-166">Das `CoursesGridView`-Steuerelement zeigt nur einige Kurs Felder an.</span><span class="sxs-lookup"><span data-stu-id="07f00-166">The `CoursesGridView` control shows only a few course fields.</span></span> <span data-ttu-id="07f00-167">Wenn Sie alle Details für einen Kurs anzeigen möchten, verwenden Sie ein `DetailsView`-Steuerelement für den Kurs, den der Benutzer auswählt.</span><span class="sxs-lookup"><span data-stu-id="07f00-167">To display all the details for a course, you'll use a `DetailsView` control for the course that the user selects.</span></span> <span data-ttu-id="07f00-168">Fügen Sie in " *Dozenten. aspx*" nach dem schließenden `</div>` Tag das folgende Markup hinzu (stellen Sie sicher, dass Sie **Dieses Markup hinter** dem schließenden div-Tag platzieren, nicht davor):</span><span class="sxs-lookup"><span data-stu-id="07f00-168">In *Instructors.aspx*, add the following markup after the closing `</div>` tag (make sure you place this markup **after** the closing div tag, not before it):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample9.aspx)]

<span data-ttu-id="07f00-169">Mit diesem Markup wird ein `EntityDataSource` Steuerelement erstellt, das an die `Courses` Entitätenmenge gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-169">This markup creates an `EntityDataSource` control that's bound to the `Courses` entity set.</span></span> <span data-ttu-id="07f00-170">Die `Where`-Eigenschaft wählt einen Kurs mithilfe des `CourseID` Werts der ausgewählten Zeile in den Kursen `GridView`-Steuerelement aus.</span><span class="sxs-lookup"><span data-stu-id="07f00-170">The `Where` property selects a course using the `CourseID` value of the selected row in the courses `GridView` control.</span></span> <span data-ttu-id="07f00-171">Das Markup gibt einen Handler für das `Selected`-Ereignis an, das Sie später zum Anzeigen von Studenten Qualitäten verwenden. Dies ist eine weitere Ebene, die in der Hierarchie weiter unten ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-171">The markup specifies a handler for the `Selected` event, which you'll use later for displaying student grades, which is another level lower in the hierarchy.</span></span>

<span data-ttu-id="07f00-172">Erstellen Sie in *Instructors.aspx.cs*den folgenden Stub für die `CourseDetailsEntityDataSource_Selected`-Methode.</span><span class="sxs-lookup"><span data-stu-id="07f00-172">In *Instructors.aspx.cs*, create the following stub for the `CourseDetailsEntityDataSource_Selected` method.</span></span> <span data-ttu-id="07f00-173">(Sie füllen diesen Stub später in diesem Tutorial aus. vorerst benötigen Sie den Stub, damit die Seite kompiliert und ausgeführt wird.)</span><span class="sxs-lookup"><span data-stu-id="07f00-173">(You'll fill this stub out later in the tutorial; for now, you need it so that the page will compile and run.)</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample10.cs)]

<span data-ttu-id="07f00-174">Führen Sie die Seite aus.</span><span class="sxs-lookup"><span data-stu-id="07f00-174">Run the page.</span></span>

<span data-ttu-id="07f00-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-175">[![Image06](the-entity-framework-and-aspnet-getting-started-part-4/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image11.png)</span></span>

<span data-ttu-id="07f00-176">Anfänglich sind keine Kursdetails vorhanden, da kein Kurs ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-176">Initially there are no course details because no course is selected.</span></span> <span data-ttu-id="07f00-177">Wählen Sie einen Dozenten aus, dem ein Kurs zugewiesen ist, und wählen Sie dann einen Kurs aus, um die Details anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="07f00-177">Select an instructor who has a course assigned, and then select a course to see the details.</span></span>

<span data-ttu-id="07f00-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-178">[![Image07](the-entity-framework-and-aspnet-getting-started-part-4/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image13.png)</span></span>

## <a name="using-the-entitydatasource-selected-event-to-display-related-data"></a><span data-ttu-id="07f00-179">Verwenden des "Selected"-Ereignisses von EntityDataSource zum Anzeigen verwandter Daten</span><span class="sxs-lookup"><span data-stu-id="07f00-179">Using the EntityDataSource "Selected" Event to Display Related Data</span></span>

<span data-ttu-id="07f00-180">Schließlich möchten Sie alle registrierten Studenten und deren Noten für den ausgewählten Kurs anzeigen.</span><span class="sxs-lookup"><span data-stu-id="07f00-180">Finally, you want to show all of the enrolled students and their grades for the selected course.</span></span> <span data-ttu-id="07f00-181">Zu diesem Zweck verwenden Sie das `Selected`-Ereignis des `EntityDataSource` Steuer Elements, das an den Kurs `DetailsView`gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-181">To do this, you'll use the `Selected` event of the `EntityDataSource` control bound to the course `DetailsView`.</span></span>

<span data-ttu-id="07f00-182">Fügen Sie in *Dozenten. aspx*das folgende Markup nach dem `DetailsView`-Steuerelement hinzu:</span><span class="sxs-lookup"><span data-stu-id="07f00-182">In *Instructors.aspx*, add the following markup after the `DetailsView` control:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample11.aspx)]

<span data-ttu-id="07f00-183">Dieses Markup erstellt ein `ListView` Steuerelement, das eine Liste von Schülern und deren Noten für den ausgewählten Kurs anzeigt.</span><span class="sxs-lookup"><span data-stu-id="07f00-183">This markup creates a `ListView` control that displays a list of students and their grades for the selected course.</span></span> <span data-ttu-id="07f00-184">Es wurde keine Datenquelle angegeben, da Sie das Steuerelement im Code übernehmen.</span><span class="sxs-lookup"><span data-stu-id="07f00-184">No data source is specified because you'll databind the control in code.</span></span> <span data-ttu-id="07f00-185">Das `EmptyDataTemplate`-Element enthält eine Meldung, die angezeigt wird, wenn kein Kurs ausgewählt ist – in diesem Fall sind keine anzuzeigenden Studenten vorhanden.</span><span class="sxs-lookup"><span data-stu-id="07f00-185">The `EmptyDataTemplate` element provides a message to display when no course is selected—in that case, there are no students to display.</span></span> <span data-ttu-id="07f00-186">Das `LayoutTemplate` Element erstellt eine HTML-Tabelle zum Anzeigen der Liste, und die `ItemTemplate` gibt die anzuzeigenden Spalten an.</span><span class="sxs-lookup"><span data-stu-id="07f00-186">The `LayoutTemplate` element creates an HTML table to display the list, and the `ItemTemplate` specifies the columns to display.</span></span> <span data-ttu-id="07f00-187">Die Student-ID und die Student-Klasse stammen aus der `StudentGrade`-Entität, und der Student Name wird von der `Person` Entität abgeleitet, die der Entity Framework in der `Person` Navigations Eigenschaft der `StudentGrade`-Entität verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="07f00-187">The student ID and the student grade are from the `StudentGrade` entity, and the student name is from the `Person` entity that the Entity Framework makes available in the `Person` navigation property of the `StudentGrade` entity.</span></span>

<span data-ttu-id="07f00-188">Ersetzen Sie in *Instructors.aspx.cs*die `CourseDetailsEntityDataSource_Selected`-Methode stubout durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="07f00-188">In *Instructors.aspx.cs*, replace the stubbed-out `CourseDetailsEntityDataSource_Selected` method with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample12.cs)]

<span data-ttu-id="07f00-189">Das Ereignis Argument für dieses Ereignis stellt die ausgewählten Daten in Form einer Auflistung bereit, die 0 (null) Elemente enthält, wenn nichts ausgewählt ist, oder ein Element, wenn eine `Course` Entität ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-189">The event argument for this event provides the selected data in the form of a collection, which will have zero items if nothing is selected or one item if a `Course` entity is selected.</span></span> <span data-ttu-id="07f00-190">Wenn eine `Course` Entität ausgewählt ist, verwendet der Code die `First`-Methode, um die Auflistung in ein einzelnes Objekt zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="07f00-190">If a `Course` entity is selected, the code uses the `First` method to convert the collection to a single object.</span></span> <span data-ttu-id="07f00-191">Anschließend werden `StudentGrade` Entitäten aus der Navigations Eigenschaft abgerufen, in eine Auflistung konvertiert und das `GradesListView` Steuerelement an die Auflistung gebunden.</span><span class="sxs-lookup"><span data-stu-id="07f00-191">It then gets `StudentGrade` entities from the navigation property, converts them to a collection, and binds the `GradesListView` control to the collection.</span></span>

<span data-ttu-id="07f00-192">Dies ist ausreichend, um die Qualität anzuzeigen, aber Sie möchten sicherstellen, dass die Meldung in der leeren Daten Vorlage angezeigt wird, wenn die Seite zum ersten Mal angezeigt wird, und wenn kein Kurs ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-192">This is sufficient to display grades, but you want to make sure that the message in the empty data template is displayed the first time the page is displayed and whenever a course is not selected.</span></span> <span data-ttu-id="07f00-193">Erstellen Sie hierzu die folgende Methode, die Sie von zwei Stellen aus abrufen:</span><span class="sxs-lookup"><span data-stu-id="07f00-193">To do that, create the following method, which you'll call from two places:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample13.cs)]

<span data-ttu-id="07f00-194">Aufrufen Sie diese neue Methode aus der `Page_Load`-Methode, um die leere Daten Vorlage anzuzeigen, wenn die Seite zum ersten Mal angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="07f00-194">Call this new method from the `Page_Load` method to display the empty data template the first time the page is displayed.</span></span> <span data-ttu-id="07f00-195">Und über die `InstructorsGridView_SelectedIndexChanged`-Methode aufrufen, da dieses Ereignis ausgelöst wird, wenn ein Dozent ausgewählt wird. das bedeutet, dass neue Kurse in die Kurse `GridView` Steuer Elements geladen werden und keine noch ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="07f00-195">And call it from the `InstructorsGridView_SelectedIndexChanged` method because that event is raised when an instructor is selected, which means new courses are loaded into the courses `GridView` control and none is selected yet.</span></span> <span data-ttu-id="07f00-196">Dies sind die beiden Aufrufe:</span><span class="sxs-lookup"><span data-stu-id="07f00-196">Here are the two calls:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample14.cs)]

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-4/samples/sample15.cs)]

<span data-ttu-id="07f00-197">Führen Sie die Seite aus.</span><span class="sxs-lookup"><span data-stu-id="07f00-197">Run the page.</span></span>

<span data-ttu-id="07f00-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-198">[![Image08](the-entity-framework-and-aspnet-getting-started-part-4/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image15.png)</span></span>

<span data-ttu-id="07f00-199">Wählen Sie einen Dozenten aus, dem ein Kurs zugewiesen ist, und wählen Sie dann den Kurs aus.</span><span class="sxs-lookup"><span data-stu-id="07f00-199">Select an instructor that has a course assigned, and then select the course.</span></span>

<span data-ttu-id="07f00-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="07f00-200">[![Image09](the-entity-framework-and-aspnet-getting-started-part-4/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-4/_static/image17.png)</span></span>

<span data-ttu-id="07f00-201">Sie haben nun einige Möglichkeiten gesehen, mit verwandten Daten zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="07f00-201">You have now seen a few ways to work with related data.</span></span> <span data-ttu-id="07f00-202">Im folgenden Tutorial erfahren Sie, wie Sie Beziehungen zwischen vorhandenen Entitäten hinzufügen, Beziehungen entfernen und eine neue Entität hinzufügen, die über eine Beziehung zu einer vorhandenen Entität verfügt.</span><span class="sxs-lookup"><span data-stu-id="07f00-202">In the following tutorial, you'll learn how to add relationships between existing entities, how to remove relationships, and how to add a new entity that has a relationship to an existing entity.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="07f00-203">[Zurück](the-entity-framework-and-aspnet-getting-started-part-3.md)
> [Weiter](the-entity-framework-and-aspnet-getting-started-part-5.md)</span><span class="sxs-lookup"><span data-stu-id="07f00-203">[Previous](the-entity-framework-and-aspnet-getting-started-part-3.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-5.md)</span></span>
