---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: Einführung in Entity Framework 4,0 Database First und ASP.NET 4 Web Forms-Part 7 | Microsoft-Dokumentation
author: tdykstra
description: Die Beispiel-Webanwendung der Beispiel-Web-App veranschaulicht, wie Sie mithilfe der Entity Framework Web Forms Anwendungen erstellen. Die Beispielanwendung ist...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: 18d4b44c5e23fd6942c3adf48a33a5602e6df6d0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78488523"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="2bbda-104">Die ersten Schritte mit Entity Framework 4,0 Database First und ASP.NET 4 Web Forms Teil 7</span><span class="sxs-lookup"><span data-stu-id="2bbda-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>

<span data-ttu-id="2bbda-105">von [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="2bbda-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="2bbda-106">Die Beispiel-Webanwendung der Beispiel-Web-App veranschaulicht, wie Sie ASP.net-Web Forms Anwendungen mithilfe von Entity Framework 4,0 und Visual Studio 2010 erstellen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="2bbda-107">Weitere Informationen zur tutorialreihe finden Sie [im ersten Tutorial der Reihe](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="2bbda-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="using-stored-procedures"></a><span data-ttu-id="2bbda-108">Verwenden von gespeicherten Prozeduren</span><span class="sxs-lookup"><span data-stu-id="2bbda-108">Using Stored Procedures</span></span>

<span data-ttu-id="2bbda-109">Im vorherigen Tutorial haben Sie ein "Tabelle pro Hierarchie"-Vererbungsmuster implementiert.</span><span class="sxs-lookup"><span data-stu-id="2bbda-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="2bbda-110">In diesem Tutorial erfahren Sie, wie Sie gespeicherte Prozeduren verwenden, um mehr Kontrolle über den Datenbankzugriff zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="2bbda-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="2bbda-111">Mit der Entity Framework können Sie angeben, dass gespeicherte Prozeduren für den Datenbankzugriff verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="2bbda-112">Für jeden Entitätstyp können Sie eine gespeicherte Prozedur angeben, die zum Erstellen, aktualisieren oder Löschen von Entitäten dieses Typs verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="2bbda-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="2bbda-113">Im Datenmodell können Sie dann Verweise auf gespeicherte Prozeduren hinzufügen, die Sie zum Ausführen von Aufgaben wie dem Abrufen von Entitätenmengen verwenden können.</span><span class="sxs-lookup"><span data-stu-id="2bbda-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="2bbda-114">Die Verwendung gespeicherter Prozeduren ist eine gängige Anforderung für den Datenbankzugriff</span><span class="sxs-lookup"><span data-stu-id="2bbda-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="2bbda-115">In einigen Fällen kann es erforderlich sein, dass der gesamte Datenbankzugriff durch gespeicherte Prozeduren aus Sicherheitsgründen durchlaufen wird.</span><span class="sxs-lookup"><span data-stu-id="2bbda-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="2bbda-116">In anderen Fällen empfiehlt es sich, Geschäftslogik in einige der Prozesse zu erstellen, die vom Entity Framework beim Aktualisieren der Datenbank verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2bbda-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="2bbda-117">Wenn z. b. eine Entität gelöscht wird, können Sie Sie in eine Archivdatenbank kopieren.</span><span class="sxs-lookup"><span data-stu-id="2bbda-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="2bbda-118">Oder wenn eine Zeile aktualisiert wird, können Sie eine Zeile in eine Protokollierungs Tabelle schreiben, in der aufgezeichnet wird, wer die Änderung vorgenommen hat.</span><span class="sxs-lookup"><span data-stu-id="2bbda-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="2bbda-119">Sie können diese Arten von Aufgaben in einer gespeicherten Prozedur ausführen, die aufgerufen wird, wenn der Entity Framework eine Entität löscht oder eine Entität aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="2bbda-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="2bbda-120">Wie im vorherigen Tutorial werden Sie keine neuen Seiten erstellen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="2bbda-121">Stattdessen ändern Sie die Art und Weise, in der der Entity Framework auf die Datenbank für einige der Seiten zugreift, die Sie bereits erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="2bbda-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="2bbda-122">In diesem Tutorial erstellen Sie in der-Datenbank gespeicherte Prozeduren zum Einfügen von `Student` und `Instructor` Entitäten.</span><span class="sxs-lookup"><span data-stu-id="2bbda-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="2bbda-123">Sie werden dem Datenmodell hinzugefügt, und Sie geben an, dass der Entity Framework diese zum Hinzufügen von `Student` und `Instructor` Entitäten zur Datenbank verwenden soll.</span><span class="sxs-lookup"><span data-stu-id="2bbda-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="2bbda-124">Außerdem erstellen Sie eine gespeicherte Prozedur, die Sie zum Abrufen von `Course` Entitäten verwenden können.</span><span class="sxs-lookup"><span data-stu-id="2bbda-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="2bbda-125">Erstellen von gespeicherten Prozeduren in der Datenbank</span><span class="sxs-lookup"><span data-stu-id="2bbda-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="2bbda-126">(Wenn Sie die Datei " *School. mdf* " aus dem Projekt verwenden, das in diesem Tutorial zum Herunterladen verfügbar ist, können Sie diesen Abschnitt überspringen, da die gespeicherten Prozeduren bereits vorhanden sind.)</span><span class="sxs-lookup"><span data-stu-id="2bbda-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="2bbda-127">Erweitern Sie in **Server-Explorer**den Eintrag *School. mdf*, klicken Sie mit der rechten Maustaste auf **gespeicherte Prozeduren**, und wählen Sie dann **neue gespeicherte Prozedur**</span><span class="sxs-lookup"><span data-stu-id="2bbda-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="2bbda-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="2bbda-129">Kopieren Sie die folgenden SQL-Anweisungen, und fügen Sie Sie in das Fenster gespeicherte Prozedur ein. ersetzen Sie dabei die gespeicherte Prozedur Skeleton.</span><span class="sxs-lookup"><span data-stu-id="2bbda-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="2bbda-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="2bbda-131">`Student` Entitäten verfügen über vier Eigenschaften: `PersonID`, `LastName`, `FirstName`und `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="2bbda-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="2bbda-132">Die Datenbank generiert den ID-Wert automatisch, und die gespeicherte Prozedur akzeptiert Parameter für die anderen drei.</span><span class="sxs-lookup"><span data-stu-id="2bbda-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="2bbda-133">Die gespeicherte Prozedur gibt den Wert des Daten Satz Schlüssels der neuen Zeile zurück, damit der Entity Framework den Wert in der Version der Entität nachverfolgen kann, die er im Arbeitsspeicher speichert.</span><span class="sxs-lookup"><span data-stu-id="2bbda-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="2bbda-134">Speichern und schließen Sie das Fenster gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="2bbda-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="2bbda-135">Erstellen Sie eine gespeicherte Prozedur `InsertInstructor` auf die gleiche Weise, und verwenden Sie dabei die folgenden SQL-Anweisungen:</span><span class="sxs-lookup"><span data-stu-id="2bbda-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="2bbda-136">Erstellen Sie `Update` gespeicherten Prozeduren auch für `Student`-und `Instructor` Entitäten.</span><span class="sxs-lookup"><span data-stu-id="2bbda-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="2bbda-137">(In der Datenbank ist bereits eine gespeicherte Prozedur `DeletePerson` vorhanden, die sowohl für `Instructor` als auch für `Student` Entitäten verwendet werden kann.)</span><span class="sxs-lookup"><span data-stu-id="2bbda-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="2bbda-138">In diesem Tutorial ordnen Sie alle drei Funktionen (INSERT, Update und DELETE) für jeden Entitätstyp zu.</span><span class="sxs-lookup"><span data-stu-id="2bbda-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="2bbda-139">Mit dem Entity Framework Version 4 können Sie nur eine oder zwei dieser Funktionen gespeicherten Prozeduren zuordnen, ohne die anderen zuzuordnen, mit einer Ausnahme: Wenn Sie die Update-Funktion, jedoch nicht die Delete-Funktion zuordnen, löst die Entity Framework eine Ausnahme aus, wenn Sie Es wurde versucht, eine Entität zu löschen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="2bbda-140">In der Entity Framework Version 3,5 gab es bei der Zuordnung gespeicherter Prozeduren keine sehr hohe Flexibilität: Wenn Sie eine Funktion zugeordnet haben, mussten Sie alle drei zuordnen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="2bbda-141">Um eine gespeicherte Prozedur zu erstellen, die Daten liest, anstatt Daten zu aktualisieren, erstellen Sie eine, die alle `Course` Entitäten mit den folgenden SQL-Anweisungen auswählt:</span><span class="sxs-lookup"><span data-stu-id="2bbda-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="2bbda-142">Hinzufügen der gespeicherten Prozeduren zum Datenmodell</span><span class="sxs-lookup"><span data-stu-id="2bbda-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="2bbda-143">Die gespeicherten Prozeduren werden nun in der Datenbank definiert, müssen jedoch dem Datenmodell hinzugefügt werden, um Sie für die Entity Framework verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="2bbda-144">Öffnen Sie *School Model. edmx*, klicken Sie mit der rechten Maustaste auf die Entwurfs Oberfläche, und wählen Sie **Modell aus Datenbank aktualisieren aus**.</span><span class="sxs-lookup"><span data-stu-id="2bbda-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="2bbda-145">Erweitern Sie im Dialogfeld **Datenbankobjekte auswählen** auf der Registerkarte **Hinzufügen** den Eintrag **gespeicherte Prozeduren**, wählen Sie die neu erstellten gespeicherten Prozeduren und die gespeicherte Prozedur `DeletePerson` aus, und klicken Sie dann auf **Fertig**stellen</span><span class="sxs-lookup"><span data-stu-id="2bbda-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="2bbda-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="2bbda-147">Zuordnung der gespeicherten Prozeduren</span><span class="sxs-lookup"><span data-stu-id="2bbda-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="2bbda-148">Klicken Sie im Datenmodell-Designer mit der rechten Maustaste auf die `Student` Entität, und wählen Sie **Zuordnung der gespeicherten Prozedur**</span><span class="sxs-lookup"><span data-stu-id="2bbda-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="2bbda-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="2bbda-150">Das Fenster **Mappingdetails** wird angezeigt. in diesem Fenster können Sie gespeicherte Prozeduren angeben, die vom Entity Framework zum Einfügen, aktualisieren und Löschen von Entitäten dieses Typs verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="2bbda-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="2bbda-152">Legen Sie die **Insert** -Funktion auf **insertstudent**fest.</span><span class="sxs-lookup"><span data-stu-id="2bbda-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="2bbda-153">Das Fenster zeigt eine Liste von Parametern gespeicherter Prozeduren an, die jeweils einer Entitäts Eigenschaft zugeordnet werden müssen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="2bbda-154">Zwei davon werden automatisch zugeordnet, da die Namen identisch sind.</span><span class="sxs-lookup"><span data-stu-id="2bbda-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="2bbda-155">Es gibt keine Entitäts Eigenschaft mit dem Namen `FirstName`. Daher müssen Sie `FirstMidName` manuell aus einer Dropdown Liste auswählen, in der die verfügbaren Entitäts Eigenschaften angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="2bbda-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="2bbda-156">(Dies liegt daran, dass Sie den Namen der `FirstName`-Eigenschaft in `FirstMidName` im ersten Tutorial geändert haben.)</span><span class="sxs-lookup"><span data-stu-id="2bbda-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="2bbda-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="2bbda-158">Ordnen Sie im gleichen mappingdetailsfenster die `Update`-Funktion der gespeicherten Prozedur `UpdateStudent` zu (stellen Sie sicher, dass Sie `FirstMidName` wie für die gespeicherte Prozedur `Insert` als Parameterwert für `FirstName`und die `Delete`-Funktion für die gespeicherte Prozedur `DeletePerson` angeben.</span><span class="sxs-lookup"><span data-stu-id="2bbda-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="2bbda-159">[![Image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="2bbda-160">Befolgen Sie dasselbe Verfahren, um die gespeicherten Prozeduren INSERT, Update und DELETE für Dozenten der `Instructor`-Entität zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="2bbda-161">[![Image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="2bbda-162">Für gespeicherte Prozeduren, die Daten lesen und nicht aktualisieren, verwenden Sie das Fenster **Modell Browser** , um die gespeicherte Prozedur dem zurückgegebenen Entitätstyp zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="2bbda-163">Klicken Sie im Datenmodell-Designer mit der rechten Maustaste auf die Entwurfs Oberfläche, und wählen Sie **Modell Browser**aus.</span><span class="sxs-lookup"><span data-stu-id="2bbda-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="2bbda-164">Öffnen Sie den Knoten **SchoolModel. Store** , und öffnen Sie dann den Knoten **gespeicherte Prozeduren** .</span><span class="sxs-lookup"><span data-stu-id="2bbda-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="2bbda-165">Klicken Sie mit der rechten Maustaste auf die gespeicherte Prozedur `GetCourses` und wählen Sie **Funktions Import hinzufügen**aus.</span><span class="sxs-lookup"><span data-stu-id="2bbda-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="2bbda-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="2bbda-167">Im Dialogfeld **Funktions Import hinzufügen** unter **gibt eine Auflistung von** Select- **Entitäten**zurück, und wählen Sie dann `Course` als Entitätstyp zurück.</span><span class="sxs-lookup"><span data-stu-id="2bbda-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="2bbda-168">Wenn Sie fertig sind, klicken Sie auf **OK**.</span><span class="sxs-lookup"><span data-stu-id="2bbda-168">When you're done, click **OK**.</span></span> <span data-ttu-id="2bbda-169">Speichern und schließen Sie die *edmx* -Datei.</span><span class="sxs-lookup"><span data-stu-id="2bbda-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="2bbda-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="2bbda-171">Verwenden gespeicherter Prozeduren INSERT, Update und DELETE</span><span class="sxs-lookup"><span data-stu-id="2bbda-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="2bbda-172">Gespeicherte Prozeduren zum Einfügen, aktualisieren und Löschen von Daten werden automatisch von der Entity Framework verwendet, nachdem Sie Sie dem Datenmodell hinzugefügt und den entsprechenden Entitäten zugeordnet haben.</span><span class="sxs-lookup"><span data-stu-id="2bbda-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="2bbda-173">Sie können jetzt die Seite " *studentsadd. aspx* " ausführen, und jedes Mal, wenn Sie einen neuen Studenten erstellen, verwendet die Entity Framework die gespeicherte Prozedur `InsertStudent`, um die neue Zeile der `Student` Tabelle hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="2bbda-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="2bbda-175">Führen Sie die Seite *students. aspx* aus, und der neue Student wird in der Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2bbda-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="2bbda-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="2bbda-177">Ändern Sie den Namen, um zu überprüfen, ob die Funktion Update funktioniert, und löschen Sie dann den Studenten, um sicherzustellen, dass die Funktion Delete funktioniert.</span><span class="sxs-lookup"><span data-stu-id="2bbda-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="2bbda-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="2bbda-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="2bbda-179">Verwenden von gespeicherten Prozeduren auswählen</span><span class="sxs-lookup"><span data-stu-id="2bbda-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="2bbda-180">In der Entity Framework werden gespeicherte Prozeduren wie `GetCourses`nicht automatisch ausgeführt, und Sie können nicht mit dem `EntityDataSource`-Steuerelement verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2bbda-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="2bbda-181">Um Sie zu verwenden, werden Sie aus dem Code aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-181">To use them, you call them from code.</span></span>

<span data-ttu-id="2bbda-182">Öffnen Sie die Datei *InstructorsCourses.aspx.cs* .</span><span class="sxs-lookup"><span data-stu-id="2bbda-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="2bbda-183">Die `PopulateDropDownLists`-Methode verwendet eine LINQ-to-Entities-Abfrage, um alle Kurs Entitäten abzurufen, sodass Sie die Liste durchlaufen und feststellen kann, welchen eine der Dozenten zugewiesen ist und welche nicht zugewiesen sind:</span><span class="sxs-lookup"><span data-stu-id="2bbda-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="2bbda-184">Ersetzen Sie dies durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="2bbda-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="2bbda-185">Die Seite verwendet nun die gespeicherte Prozedur `GetCourses`, um die Liste aller Kurse abzurufen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="2bbda-186">Führen Sie die Seite aus, um zu überprüfen, ob Sie wie zuvor funktioniert hat.</span><span class="sxs-lookup"><span data-stu-id="2bbda-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="2bbda-187">(Die Navigations Eigenschaften von Entitäten, die von einer gespeicherten Prozedur abgerufen werden, werden möglicherweise nicht automatisch mit den Daten aufgefüllt, die sich auf diese Entitäten beziehen, abhängig von `ObjectContext` Standardeinstellungen</span><span class="sxs-lookup"><span data-stu-id="2bbda-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="2bbda-188">Weitere Informationen finden Sie unter [Laden verwandter Objekte](https://msdn.microsoft.com/library/bb896272.aspx) in der MSDN Library.)</span><span class="sxs-lookup"><span data-stu-id="2bbda-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="2bbda-189">Im nächsten Tutorial erfahren Sie, wie Sie dynamische Daten-Funktionalität verwenden, um das Programmieren und Testen von Daten Formatierungs-und Validierungsregeln zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="2bbda-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="2bbda-190">Anstatt für jede Webseiten Regel, wie z. b. Datenformat Zeichenfolgen, anzugeben, und unabhängig davon, ob ein Feld erforderlich ist, können Sie diese Regeln in den Metadaten des Datenmodells angeben, die automatisch auf jeder Seite angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="2bbda-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2bbda-191">[Zurück](the-entity-framework-and-aspnet-getting-started-part-6.md)
> [Weiter](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="2bbda-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>
