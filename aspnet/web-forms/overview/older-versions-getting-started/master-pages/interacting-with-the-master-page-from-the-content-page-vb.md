---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
title: Interaktion mit der Master Seite von der Inhaltsseite (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Untersucht, wie Methoden, Eigenschaften usw. der Master Seite aus dem Code auf der Seite Inhalt aufgerufen werden.
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 081fe010-ba0f-4e7d-b4ba-774840b601c2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-master-page-from-the-content-page-vb
msc.type: authoredcontent
ms.openlocfilehash: fe1f7b80b26ff25c1ce744e4f823e3fb35eea074
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78441195"
---
# <a name="interacting-with-the-master-page-from-the-content-page-vb"></a><span data-ttu-id="3a181-103">Interaktion mit der Inhaltsseite über die Masterseite (VB)</span><span class="sxs-lookup"><span data-stu-id="3a181-103">Interacting with the Master Page from the Content Page (VB)</span></span>

<span data-ttu-id="3a181-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3a181-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3a181-105">[Code herunterladen](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) oder [PDF herunterladen](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="3a181-105">[Download Code](https://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_06_VB.pdf)</span></span>

> <span data-ttu-id="3a181-106">Untersucht, wie Methoden, Eigenschaften usw. der Master Seite aus dem Code auf der Seite Inhalt aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-106">Examines how to call methods, set properties, etc. of the Master Page from code in the Content Page.</span></span>

## <a name="introduction"></a><span data-ttu-id="3a181-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="3a181-107">Introduction</span></span>

<span data-ttu-id="3a181-108">Im Verlauf der letzten fünf Tutorials haben wir uns mit dem Erstellen einer Master Seite, dem Definieren von Inhalts Bereichen, dem Binden von ASP.NET-Seiten an eine Master Seite und dem Definieren von Seiten spezifischem Inhalt beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="3a181-108">Over the course of the past five tutorials we have looked at how to create a master page, define content regions, bind ASP.NET pages to a master page, and define page-specific content.</span></span> <span data-ttu-id="3a181-109">Wenn ein Besucher eine bestimmte Inhaltsseite anfordert, werden das Markup der Inhalts-und Masterseiten zur Laufzeit miteinander verschmolzen, was zum Rendern einer vereinheitlichten Steuerelement Hierarchie führt.</span><span class="sxs-lookup"><span data-stu-id="3a181-109">When a visitor requests a particular content page, the content and master pages' markup are fused at runtime, resulting in the rendering of a unified control hierarchy.</span></span> <span data-ttu-id="3a181-110">Daher haben wir bereits eine Möglichkeit gesehen, wie die Master Seite und eine ihrer Inhaltsseiten interagieren können: die Inhaltsseite gibt das Markup aus, das in die contentplachalter-Steuerelemente der Master Seite übersetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="3a181-110">Therefore, we have already seen one way in which the master page and one of its content pages can interact: the content page spells out the markup to transfuse into the master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="3a181-111">Wir haben noch untersucht, wie die Master Seite und die Inhaltsseite Programm gesteuert interagieren können.</span><span class="sxs-lookup"><span data-stu-id="3a181-111">What we have yet to examine is how the master page and content page can interact programmatically.</span></span> <span data-ttu-id="3a181-112">Zusätzlich zum Definieren des Markups für die contentplachalter-Steuerelemente der Master Seite kann eine Inhaltsseite auch den öffentlichen Eigenschaften der Master Seite Werte zuweisen und deren öffentliche Methoden aufrufen.</span><span class="sxs-lookup"><span data-stu-id="3a181-112">In addition to defining the markup for the master page's ContentPlaceHolder controls, a content page can also assign values to its master page's public properties and invoke its public methods.</span></span> <span data-ttu-id="3a181-113">Auf ähnliche Weise kann eine Master Seite mit ihren Inhaltsseiten interagieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-113">Similarly, a master page may interact with its content pages.</span></span> <span data-ttu-id="3a181-114">Während die programmgesteuerte Interaktion zwischen einer Master-und einer Inhaltsseite weniger häufig ist als die Interaktion zwischen ihren deklarativen Markups, gibt es viele Szenarios, in denen eine solche programmgesteuerte Interaktion erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="3a181-114">While programmatic interaction between a master and content page is less common than the interaction between their declarative markups, there are many scenarios where such programmatic interaction is needed.</span></span>

<span data-ttu-id="3a181-115">In diesem Tutorial untersuchen wir, wie eine Inhaltsseite Programm gesteuert mit der Master Seite interagieren kann. im nächsten Tutorial wird erläutert, wie die Master Seite auf ähnliche Weise mit ihren Inhaltsseiten interagieren kann.</span><span class="sxs-lookup"><span data-stu-id="3a181-115">In this tutorial we examine how a content page can programmatically interact with its master page; in the next tutorial we will look at how the master page can similarly interact with its content pages.</span></span>

## <a name="examples-of-programmatic-interaction-between-a-content-page-and-its-master-page"></a><span data-ttu-id="3a181-116">Beispiele für die programmgesteuerte Interaktion zwischen einer Inhaltsseite und ihrer Master Seite</span><span class="sxs-lookup"><span data-stu-id="3a181-116">Examples of Programmatic Interaction Between a Content Page and its Master Page</span></span>

<span data-ttu-id="3a181-117">Wenn ein bestimmter Bereich einer Seite Seite für Seite konfiguriert werden muss, verwenden wir ein contentplachalter-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="3a181-117">When a particular region of a page needs to be configured on a page-by-page basis, we use a ContentPlaceHolder control.</span></span> <span data-ttu-id="3a181-118">Aber wie sieht es mit Situationen aus, in denen die Mehrzahl der Seiten eine bestimmte Ausgabe ausgeben muss, aber eine kleine Anzahl von Seiten muss Sie so anpassen, dass Sie etwas anderes zeigt?</span><span class="sxs-lookup"><span data-stu-id="3a181-118">But what about situations where the majority of pages need to emit a certain output, but a small number of pages need to customize it to show something else?</span></span> <span data-ttu-id="3a181-119">Ein Beispiel, das wir im Lernprogramm mit [*mehreren Content-und Standard Inhalten*](multiple-contentplaceholders-and-default-content-vb.md) untersucht haben, beinhaltet die Anzeige einer Anmelde Schnittstelle auf jeder Seite.</span><span class="sxs-lookup"><span data-stu-id="3a181-119">One such example, which we examined in the [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial, involves displaying a login interface on each page.</span></span> <span data-ttu-id="3a181-120">Die meisten Seiten sollten zwar eine Anmelde Schnittstelle enthalten, Sie sollten jedoch für eine Handvoll Seiten unterdrückt werden, z. b.: die Haupt Anmeldeseite (`Login.aspx`). die Seite "Konto erstellen"; und andere Seiten, auf die nur authentifizierte Benutzer zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="3a181-120">While most pages should include a login interface, it should be suppressed for a handful of pages, such as: the main login page (`Login.aspx`); the Create Account page; and other pages that are only accessible to authenticated users.</span></span> <span data-ttu-id="3a181-121">Im Tutorial " [*mehrere Inhalts Platzhalter und Standard Inhalte*](multiple-contentplaceholders-and-default-content-vb.md) " wurde gezeigt, wie Sie den Standard Inhalt für einen contentplachalter auf der Master Seite definieren und dann auf den Seiten überschreiben, auf denen der Standard Inhalt nicht gewünscht war.</span><span class="sxs-lookup"><span data-stu-id="3a181-121">The [*Multiple ContentPlaceHolders and Default Content*](multiple-contentplaceholders-and-default-content-vb.md) tutorial showed how to define the default content for a ContentPlaceHolder in the master page and then how to override it in those pages where the default content was not wanted.</span></span>

<span data-ttu-id="3a181-122">Eine andere Möglichkeit besteht darin, eine öffentliche Eigenschaft oder Methode auf der Master Seite zu erstellen, die angibt, ob die Anmelde Schnittstelle angezeigt oder ausgeblendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="3a181-122">Another option is to create a public property or method within the master page that indicates whether to show or hide the login interface.</span></span> <span data-ttu-id="3a181-123">Die Master Seite könnte z. b. eine öffentliche Eigenschaft mit dem Namen `ShowLoginUI` enthalten, deren Wert verwendet wurde, um die `Visible`-Eigenschaft des Login-Steuer Elements auf der Master Seite festzulegen.</span><span class="sxs-lookup"><span data-stu-id="3a181-123">For example, the master page might include a public property named `ShowLoginUI` whose value was used to set the `Visible` property of the Login control in the master page.</span></span> <span data-ttu-id="3a181-124">Die Inhaltsseiten, auf denen die Anmelde Benutzeroberfläche unterdrückt werden soll, können dann die `ShowLoginUI`-Eigenschaft Programm gesteuert auf `False`festlegen.</span><span class="sxs-lookup"><span data-stu-id="3a181-124">Those content pages where the login user interface should be suppressed could then programmatically set the `ShowLoginUI` property to `False`.</span></span>

<span data-ttu-id="3a181-125">Möglicherweise ist das häufigste Beispiel für die Interaktion von Inhalten und der Master Seite, wenn die auf der Master Seite angezeigten Daten aktualisiert werden müssen, nachdem eine Aktion auf der Inhaltsseite aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="3a181-125">Perhaps the most common example of content and master page interaction occurs when data displayed in the master page needs to be refreshed after some action has transpired in the content page.</span></span> <span data-ttu-id="3a181-126">Betrachten Sie eine Master Seite, die eine GridView enthält, in der die fünf zuletzt hinzugefügten Datensätze aus einer bestimmten Datenbanktabelle angezeigt werden und eine ihrer Inhaltsseiten eine Schnittstelle zum Hinzufügen neuer Datensätze zu derselben Tabelle enthält.</span><span class="sxs-lookup"><span data-stu-id="3a181-126">Consider a master page that includes a GridView that displays the five most recently added records from a particular database table, and that one of its content pages includes an interface for adding new records to that same table.</span></span>

<span data-ttu-id="3a181-127">Wenn ein Benutzer die Seite besucht, um einen neuen Datensatz hinzuzufügen, werden die fünf zuletzt hinzugefügten Datensätze auf der Master Seite angezeigt.</span><span class="sxs-lookup"><span data-stu-id="3a181-127">When a user visits the page to add a new record, she sees the five most recently added records displayed in the master page.</span></span> <span data-ttu-id="3a181-128">Nachdem Sie die Werte für die Spalten des neuen Datensatzes ausgefüllt haben, wird das Formular übermittelt.</span><span class="sxs-lookup"><span data-stu-id="3a181-128">After filling in the values for the new record's columns, she submits the form.</span></span> <span data-ttu-id="3a181-129">Wenn für die GridView auf der Master Seite die `EnableViewState`-Eigenschaft auf true (Standardeinstellung) festgelegt ist, wird der zugehörige Inhalt aus dem Ansichts Zustand neu geladen. Folglich werden die fünf gleichen Datensätze angezeigt, auch wenn ein neuerer Datensatz soeben der Datenbank hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-129">Assuming that the GridView in the master page has its `EnableViewState` property set to True (the default), its content is reloaded from view state and, consequently, the five same records are displayed even though a newer record was just added to the database.</span></span> <span data-ttu-id="3a181-130">Dadurch kann der Benutzer verwirrend sein.</span><span class="sxs-lookup"><span data-stu-id="3a181-130">This may confuse the user.</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-131">Auch wenn Sie den Ansichts Zustand der GridView deaktivieren, sodass er bei jedem Postback an die zugrunde liegende Datenquelle zurückgebunden wird, wird der soeben hinzugefügte Datensatz immer noch nicht angezeigt, da die Daten zuvor im Seiten Lebenszyklus an die GridView gebunden sind, als wenn der neue Datensatz dem datab hinzugefügt wird. Wissens.</span><span class="sxs-lookup"><span data-stu-id="3a181-131">Even if you disable the GridView's view state so that it rebinds to its underlying data source on every postback, it still won't show the just-added record because the data is bound to the GridView earlier in the page lifecycle than when the new record is added to the database.</span></span>

<span data-ttu-id="3a181-132">Um dies zu beheben, damit der soeben hinzugefügte Datensatz in der GridView der Master Seite im Postback angezeigt wird, müssen wir die GridView anweisen, eine erneute Bindung an die Datenquelle herzustellen, *nachdem* der neue Datensatz der Datenbank hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-132">To remedy this so that the just-added record is displayed in the master page's GridView on postback we need to instruct the GridView to rebind to its data source *after* the new record has been added to the database.</span></span> <span data-ttu-id="3a181-133">Dies erfordert eine Interaktion zwischen dem Inhalt und den Masterseiten, da die Schnittstelle zum Hinzufügen des neuen Datensatzes (und seiner Ereignishandler) auf der Seite Inhalt angezeigt wird, die zu Aktualisier Ende GridView jedoch auf der Master Seite angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-133">This requires interaction between the content and master pages because the interface for adding the new record (and its event handlers) are in the content page but the GridView that needs to be refreshed is in the master page.</span></span>

<span data-ttu-id="3a181-134">Da die Aktualisierung der Anzeige der Master Seite von einem Ereignishandler auf der Seite Inhalt einer der gängigsten Anforderungen für die Interaktion von Inhalten und Masterseiten ist, betrachten wir dieses Thema ausführlicher.</span><span class="sxs-lookup"><span data-stu-id="3a181-134">Because refreshing the master page's display from an event handler in the content page is one of the most common needs for content and master page interaction, let's explore this topic in more detail.</span></span> <span data-ttu-id="3a181-135">Der Download für dieses Tutorial enthält eine Microsoft SQL Server 2005 Express Edition-Datenbank mit dem Namen `NORTHWIND.MDF` im `App_Data` Ordner der Website.</span><span class="sxs-lookup"><span data-stu-id="3a181-135">The download for this tutorial includes a Microsoft SQL Server 2005 Express Edition database named `NORTHWIND.MDF` in the website's `App_Data` folder.</span></span> <span data-ttu-id="3a181-136">In der Northwind-Datenbank werden Produkt-, Mitarbeiter-und Vertriebsinformationen für ein fiktives Unternehmen, Northwind Traders, gespeichert.</span><span class="sxs-lookup"><span data-stu-id="3a181-136">The Northwind database stores product, employee, and sales information for a fictitious company, Northwind Traders.</span></span>

<span data-ttu-id="3a181-137">In Schritt 1 werden die fünf zuletzt hinzugefügten Produkte in einer GridView auf der Master Seite angezeigt.</span><span class="sxs-lookup"><span data-stu-id="3a181-137">Step 1 walks through displaying the five most recently added products in a GridView in the master page.</span></span> <span data-ttu-id="3a181-138">Schritt 2 erstellt eine Inhaltsseite zum Hinzufügen neuer Produkte.</span><span class="sxs-lookup"><span data-stu-id="3a181-138">Step 2 creates a content page for adding new products.</span></span> <span data-ttu-id="3a181-139">In Schritt 3 wird erläutert, wie Sie öffentliche Eigenschaften und Methoden auf der Master Seite erstellen, und Schritt 4 veranschaulicht, wie Sie eine programmgesteuerte Schnittstelle mit diesen Eigenschaften und Methoden von der Inhaltsseite aus erstellen.</span><span class="sxs-lookup"><span data-stu-id="3a181-139">Step 3 looks at how to create public properties and methods in the master page, and Step 4 illustrates how to programmatically interface with these properties and methods from the content page.</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-140">In diesem Tutorial werden die Besonderheiten der Arbeit mit Daten in ASP.net nicht behandelt.</span><span class="sxs-lookup"><span data-stu-id="3a181-140">This tutorial does not delve into the specifics of working with data in ASP.NET.</span></span> <span data-ttu-id="3a181-141">Die Schritte zum Einrichten der Master Seite zum Anzeigen von Daten und der Inhaltsseite für das Einfügen von Daten sind fertig, aber immer noch.</span><span class="sxs-lookup"><span data-stu-id="3a181-141">The steps for setting up the master page to display data and the content page for inserting data are complete, yet breezy.</span></span> <span data-ttu-id="3a181-142">Eine ausführlichere Betrachtung der Anzeige und des Einfügens von Daten und der Verwendung der SqlDataSource-und GridView-Steuerelemente finden Sie im Abschnitt Weitere Messwerte am Ende dieses Tutorials.</span><span class="sxs-lookup"><span data-stu-id="3a181-142">For a more in-depth look at displaying and inserting data and using the SqlDataSource and GridView controls, consult the resources in the Further Readings section at the end of this tutorial.</span></span>

## <a name="step-1-displaying-the-five-most-recently-added-products-in-the-master-page"></a><span data-ttu-id="3a181-143">Schritt 1: Anzeigen der fünf zuletzt hinzugefügten Produkte auf der Master Seite</span><span class="sxs-lookup"><span data-stu-id="3a181-143">Step 1: Displaying the Five Most Recently Added Products in the Master Page</span></span>

<span data-ttu-id="3a181-144">Öffnen Sie die Master Seite Site. Master, und fügen Sie der `leftContent` `<div>`eine Bezeichnung und ein GridView-Steuerelement hinzu.</span><span class="sxs-lookup"><span data-stu-id="3a181-144">Open the Site.master master page and add a Label and a GridView control to the `leftContent` `<div>`.</span></span> <span data-ttu-id="3a181-145">Löschen Sie die `Text`-Eigenschaft der Bezeichnung, legen Sie die `EnableViewState`-Eigenschaft auf `False`und deren `ID`-Eigenschaft auf `GridMessage`fest. Legen Sie die `ID`-Eigenschaft der GridView auf `RecentProducts`fest.</span><span class="sxs-lookup"><span data-stu-id="3a181-145">Clear out the Label's `Text` property, set its `EnableViewState` property to `False`, and its `ID` property to `GridMessage`; set the GridView's `ID` property to `RecentProducts`.</span></span> <span data-ttu-id="3a181-146">Erweitern Sie anschließend im Designer das Smarttag der GridView, und wählen Sie die Bindung an eine neue Datenquelle aus.</span><span class="sxs-lookup"><span data-stu-id="3a181-146">Next, from the Designer, expand the GridView's smart tag and choose to bind it to a new data source.</span></span> <span data-ttu-id="3a181-147">Dadurch wird der Assistent zum Konfigurieren von Datenquellen gestartet.</span><span class="sxs-lookup"><span data-stu-id="3a181-147">This launches the Data Source Configuration wizard.</span></span> <span data-ttu-id="3a181-148">Da die Datenbank Northwind im `App_Data` Ordner eine Microsoft SQL Server Datenbank ist, wählen Sie aus, ob Sie eine SqlDataSource erstellen möchten, indem Sie auswählen (siehe Abbildung 1). Benennen Sie die SqlDataSource-`RecentProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3a181-148">Because the Northwind database in the `App_Data` folder is a Microsoft SQL Server database, choose to create a SqlDataSource by selecting (see Figure 1); name the SqlDataSource `RecentProductsDataSource`.</span></span>

<span data-ttu-id="3a181-149">[![das GridView-Steuerelement an ein SqlDataSource-Steuerelement namens recentproductdatasource binden.](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-149">[![Bind the GridView to a SqlDataSource Control Named RecentProductsDataSource](interacting-with-the-master-page-from-the-content-page-vb/_static/image2.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image1.png)</span></span>

<span data-ttu-id="3a181-150">**Abbildung 01**: Binden der GridView an ein SqlDataSource-Steuerelement mit dem Namen `RecentProductsDataSource` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-150">**Figure 01**: Bind the GridView to a SqlDataSource Control Named `RecentProductsDataSource` ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image3.png))</span></span>

<span data-ttu-id="3a181-151">Im nächsten Schritt werden wir aufgefordert, anzugeben, mit welcher Datenbank eine Verbindung hergestellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="3a181-151">The next step asks us to specify what database to connect to.</span></span> <span data-ttu-id="3a181-152">Wählen Sie in der Dropdown Liste die `NORTHWIND.MDF` Datenbankdatei aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="3a181-152">Choose the `NORTHWIND.MDF` database file from the drop-down list and click Next.</span></span> <span data-ttu-id="3a181-153">Da diese Datenbank zum ersten Mal verwendet wird, bietet der Assistent die Verwendung der Verbindungs Zeichenfolge in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="3a181-153">Because this is the first time we've used this database, the wizard will offer to store the connection string in `Web.config`.</span></span> <span data-ttu-id="3a181-154">Speichern Sie die Verbindungs Zeichenfolge mit dem Namen `NorthwindConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="3a181-154">Have it store the connection string using the name `NorthwindConnectionString`.</span></span>

<span data-ttu-id="3a181-155">[![Herstellen einer Verbindung mit der Northwind-Datenbank](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-155">[![Connect to the Northwind Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image5.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image4.png)</span></span>

<span data-ttu-id="3a181-156">**Abbildung 02**: Herstellen der Verbindung mit der Northwind-Datenbank ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-156">**Figure 02**: Connect to the Northwind Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image6.png))</span></span>

<span data-ttu-id="3a181-157">Der Assistent zum Konfigurieren von Datenquellen bietet zwei Möglichkeiten, um die Abfrage anzugeben, die zum Abrufen von Daten verwendet wird:</span><span class="sxs-lookup"><span data-stu-id="3a181-157">The Configure Data Source wizard provides two means by which we can specify the query used to retrieve data:</span></span>

- <span data-ttu-id="3a181-158">Durch Angeben einer benutzerdefinierten SQL-Anweisung oder gespeicherten Prozedur oder</span><span class="sxs-lookup"><span data-stu-id="3a181-158">By specifying a custom SQL statement or stored procedure, or</span></span>
- <span data-ttu-id="3a181-159">Durch Auswahl einer Tabelle oder Sicht und anschließendes angeben der zurück zugebende Spalten</span><span class="sxs-lookup"><span data-stu-id="3a181-159">By picking a table or view and then specifying the columns to return</span></span>

<span data-ttu-id="3a181-160">Da wir nur die fünf zuletzt hinzugefügten Produkte zurückgeben möchten, müssen wir eine benutzerdefinierte SQL-Anweisung angeben.</span><span class="sxs-lookup"><span data-stu-id="3a181-160">Because we want to return just the five most recently added products, we need to specify a custom SQL statement.</span></span> <span data-ttu-id="3a181-161">Verwenden Sie die folgende `SELECT` Abfrage:</span><span class="sxs-lookup"><span data-stu-id="3a181-161">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample1.sql)]

<span data-ttu-id="3a181-162">Das `TOP 5`-Schlüsselwort gibt nur die ersten fünf Datensätze aus der Abfrage zurück.</span><span class="sxs-lookup"><span data-stu-id="3a181-162">The `TOP 5` keyword returns only the first five records from the query.</span></span> <span data-ttu-id="3a181-163">Der Primärschlüssel der `Products` Tabelle (`ProductID`) ist eine `IDENTITY` Spalte, mit der wir sichergestellt werden, dass jedes neue Produkt, das der Tabelle hinzugefügt wird, einen größeren Wert als der vorherige Eintrag hat.</span><span class="sxs-lookup"><span data-stu-id="3a181-163">The `Products` table's primary key, `ProductID`, is an `IDENTITY` column, which assures us that each new product added to the table will have a larger value than the previous entry.</span></span> <span data-ttu-id="3a181-164">Wenn Sie die Ergebnisse nach `ProductID` in absteigender Reihenfolge sortieren, werden die Produkte zurückgegeben, beginnend mit den zuletzt erstellten.</span><span class="sxs-lookup"><span data-stu-id="3a181-164">Therefore, sorting the results by `ProductID` in descending order returns the products starting with the most recently created ones.</span></span>

<span data-ttu-id="3a181-165">[die fünf zuletzt hinzugefügten Produkte werden ![zurückgegeben.](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-165">[![Return the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image8.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image7.png)</span></span>

<span data-ttu-id="3a181-166">**Abbildung 03**: Zurückgeben der fünf zuletzt hinzugefügten Produkte ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-166">**Figure 03**: Return the Five Most Recently Added Products  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image9.png))</span></span>

<span data-ttu-id="3a181-167">Nachdem Sie den Assistenten abgeschlossen haben, generiert Visual Studio zwei boundfields für die GridView, um die `ProductName`-und `UnitPrice` Felder anzuzeigen, die von der Datenbank zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-167">After completing the wizard, Visual Studio generates two BoundFields for the GridView to display the `ProductName` and `UnitPrice` fields returned from the database.</span></span> <span data-ttu-id="3a181-168">An diesem Punkt sollte das deklarative Markup der Master Seite ein Markup enthalten, das dem folgenden ähnelt:</span><span class="sxs-lookup"><span data-stu-id="3a181-168">At this point your master page's declarative markup should include markup similar to the following:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample2.aspx)]

<span data-ttu-id="3a181-169">Wie Sie sehen, enthält das Markup Folgendes: das Beschriftungs-websteuer Element (`GridMessage`). die GridView-`RecentProducts`mit zwei boundfields. und ein SqlDataSource-Steuerelement, das die fünf zuletzt hinzugefügten Produkte zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="3a181-169">As you can see, the markup contains: the Label Web control (`GridMessage`); the GridView `RecentProducts`, with two BoundFields; and a SqlDataSource control that returns the five most recently added products.</span></span>

<span data-ttu-id="3a181-170">Wenn Sie diese GridView erstellt und das zugehörige SqlDataSource-Steuerelement konfiguriert haben, besuchen Sie die Website über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="3a181-170">With this GridView created and its SqlDataSource control configured, visit the website through a browser.</span></span> <span data-ttu-id="3a181-171">Wie in Abbildung 4 gezeigt, wird ein Raster in der unteren linken Ecke angezeigt, in dem die fünf zuletzt hinzugefügten Produkte aufgeführt sind.</span><span class="sxs-lookup"><span data-stu-id="3a181-171">As Figure 4 shows, you will see a grid in the lower left corner that lists the five most recently added products.</span></span>

<span data-ttu-id="3a181-172">[![in der GridView werden die fünf zuletzt hinzugefügten Produkte angezeigt.](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-172">[![The GridView Displays the Five Most Recently Added Products](interacting-with-the-master-page-from-the-content-page-vb/_static/image11.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image10.png)</span></span>

<span data-ttu-id="3a181-173">**Abbildung 04**: in der GridView werden die fünf zuletzt hinzugefügten Produkte angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-173">**Figure 04**: The GridView Displays the Five Most Recently Added Products ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image12.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-174">Sie können die Darstellung der GridView jederzeit bereinigen.</span><span class="sxs-lookup"><span data-stu-id="3a181-174">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="3a181-175">Einige Vorschläge umfassen das Formatieren des angezeigten `UnitPrice` Werts als Währung und das Verwenden von Hintergrundfarben und Schriftarten, um die Darstellung des Rasters zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="3a181-175">Some suggestions include formatting the displayed `UnitPrice` value as a currency and using background colors and fonts to improve the grid's appearance.</span></span>

## <a name="step-2-creating-a-content-page-to-add-new-products"></a><span data-ttu-id="3a181-176">Schritt 2: Erstellen einer Inhaltsseite zum Hinzufügen neuer Produkte</span><span class="sxs-lookup"><span data-stu-id="3a181-176">Step 2: Creating a Content Page to Add New Products</span></span>

<span data-ttu-id="3a181-177">Die nächste Aufgabe besteht darin, eine Inhaltsseite zu erstellen, von der ein Benutzer der `Products` Tabelle ein neues Produkt hinzufügen kann.</span><span class="sxs-lookup"><span data-stu-id="3a181-177">Our next task is to create a content page from which a user can add a new product to the `Products` table.</span></span> <span data-ttu-id="3a181-178">Fügen Sie eine neue Inhaltsseite zum Ordner "`Admin`" mit dem Namen `AddProduct.aspx`hinzu, und stellen Sie sicher, dass Sie an die `Site.master` Master Seite gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="3a181-178">Add a new content page to the `Admin` folder named `AddProduct.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="3a181-179">Abbildung 5 zeigt die Projektmappen-Explorer, nachdem diese Seite der Website hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-179">Figure 5 shows the Solution Explorer after this page has been added to the website.</span></span>

<span data-ttu-id="3a181-180">[![dem Administrator Ordner eine neue ASP.NET-Seite hinzufügen](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-180">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-master-page-from-the-content-page-vb/_static/image14.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image13.png)</span></span>

<span data-ttu-id="3a181-181">**Abbildung 05**: Hinzufügen einer neuen ASP.NET-Seite zum Ordner "`Admin`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-181">**Figure 05**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image15.png))</span></span>

<span data-ttu-id="3a181-182">Beachten Sie, dass im Tutorial zum [*angeben des Titels, der Meta-Tags und anderer HTML-Header in der Master Seite*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) eine benutzerdefinierte Basis Seiten Klasse mit dem Namen `BasePage` erstellt wurde, die den Titel der Seite generiert hat, wenn er nicht explizit festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-182">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial we created a custom base page class named `BasePage` that generated the page's title if it was not explicitly set.</span></span> <span data-ttu-id="3a181-183">Wechseln Sie zur Code Behind-Klasse der `AddProduct.aspx` Seite, und lassen Sie Sie von `BasePage` (anstelle von `System.Web.UI.Page`) ableiten.</span><span class="sxs-lookup"><span data-stu-id="3a181-183">Go to the `AddProduct.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="3a181-184">Aktualisieren Sie abschließend die `Web.sitemap` Datei, sodass Sie einen Eintrag für diese Lektion enthält.</span><span class="sxs-lookup"><span data-stu-id="3a181-184">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="3a181-185">Fügen Sie das folgende Markup unterhalb der `<siteMapNode>` für die Lektion namens Probleme der Steuerelement-ID hinzu:</span><span class="sxs-lookup"><span data-stu-id="3a181-185">Add the following markup beneath the `<siteMapNode>` for the Control ID Naming Issues lesson:</span></span>

[!code-xml[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample3.xml)]

<span data-ttu-id="3a181-186">Wie in Abbildung 6 gezeigt, wird das Hinzufügen dieses `<siteMapNode>` Elements in der Liste der Lektionen widergespiegelt.</span><span class="sxs-lookup"><span data-stu-id="3a181-186">As shown in Figure 6, the addition of this `<siteMapNode>` element is reflected in the Lessons list.</span></span>

<span data-ttu-id="3a181-187">Kehren Sie zu `AddProduct.aspx`zurück.</span><span class="sxs-lookup"><span data-stu-id="3a181-187">Return to `AddProduct.aspx`.</span></span> <span data-ttu-id="3a181-188">Fügen Sie im Inhalts Steuerelement für den `MainContent` contentplachalter ein DetailsView-Steuerelement hinzu, und benennen Sie es `NewProduct`.</span><span class="sxs-lookup"><span data-stu-id="3a181-188">In the Content control for the `MainContent` ContentPlaceHolder, add a DetailsView control and name it `NewProduct`.</span></span> <span data-ttu-id="3a181-189">Binden Sie die DetailsView an ein neues SqlDataSource-Steuerelement mit dem Namen `NewProductDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3a181-189">Bind the DetailsView to a new SqlDataSource control named `NewProductDataSource`.</span></span> <span data-ttu-id="3a181-190">Konfigurieren Sie den Assistenten wie bei SqlDataSource in Schritt 1 so, dass er die Datenbank Northwind verwendet, und wählen Sie eine benutzerdefinierte SQL-Anweisung aus.</span><span class="sxs-lookup"><span data-stu-id="3a181-190">Like with the SqlDataSource in Step 1, configure the wizard so that it uses the Northwind database and choose to specify a custom SQL statement.</span></span> <span data-ttu-id="3a181-191">Da die DetailsView zum Hinzufügen von Elementen zur Datenbank verwendet wird, müssen wir sowohl eine `SELECT`-Anweisung als auch eine `INSERT`-Anweisung angeben.</span><span class="sxs-lookup"><span data-stu-id="3a181-191">Because the DetailsView will be used to add items to the database, we need to specify both a `SELECT` statement and an `INSERT` statement.</span></span> <span data-ttu-id="3a181-192">Verwenden Sie die folgende `SELECT` Abfrage:</span><span class="sxs-lookup"><span data-stu-id="3a181-192">Use the following `SELECT` query:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample4.sql)]

<span data-ttu-id="3a181-193">Fügen Sie dann auf der Registerkarte Einfügen die folgende `INSERT`-Anweisung hinzu:</span><span class="sxs-lookup"><span data-stu-id="3a181-193">Then, from the INSERT tab, add the following `INSERT` statement:</span></span>

[!code-sql[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample5.sql)]

<span data-ttu-id="3a181-194">Nachdem Sie den Assistenten abgeschlossen haben, wechseln Sie zum Smarttag der DetailsView, und aktivieren Sie das Kontrollkästchen "Einfügen aktivieren".</span><span class="sxs-lookup"><span data-stu-id="3a181-194">After completing the wizard go to the DetailsView's smart tag and check the "Enable Inserting" checkbox.</span></span> <span data-ttu-id="3a181-195">Dadurch wird der DetailsView ein CommandField hinzugefügt, dessen `ShowInsertButton`-Eigenschaft auf true festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="3a181-195">This adds a CommandField to the DetailsView with its `ShowInsertButton` property set to True.</span></span> <span data-ttu-id="3a181-196">Da diese DetailsView ausschließlich für das Einfügen von Daten verwendet wird, legen Sie die `DefaultMode`-Eigenschaft der DetailsView auf `Insert`fest.</span><span class="sxs-lookup"><span data-stu-id="3a181-196">Because this DetailsView will be used solely for inserting data, set the DetailsView's `DefaultMode` property to `Insert`.</span></span>

<span data-ttu-id="3a181-197">Das ist schon alles!</span><span class="sxs-lookup"><span data-stu-id="3a181-197">That's all there is to it!</span></span> <span data-ttu-id="3a181-198">Testen Sie diese Seite.</span><span class="sxs-lookup"><span data-stu-id="3a181-198">Let's test this page.</span></span> <span data-ttu-id="3a181-199">Besuchen Sie `AddProduct.aspx` über einen Browser, und geben Sie einen Namen und einen Preis ein (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="3a181-199">Visit `AddProduct.aspx` through a browser, enter a name and price (see Figure 6).</span></span>

<span data-ttu-id="3a181-200">[![der Datenbank ein neues Produkt hinzufügen](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-200">[![Add a New Product to the Database](interacting-with-the-master-page-from-the-content-page-vb/_static/image17.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image16.png)</span></span>

<span data-ttu-id="3a181-201">**Abbildung 06**: Hinzufügen eines neuen Produkts zur Datenbank ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-201">**Figure 06**: Add a New Product to the Database  ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image18.png))</span></span>

<span data-ttu-id="3a181-202">Nachdem Sie den Namen und den Preis für das neue Produkt eingegeben haben, klicken Sie auf die Schaltfläche einfügen.</span><span class="sxs-lookup"><span data-stu-id="3a181-202">After typing in the name and price for your new product, click the Insert button.</span></span> <span data-ttu-id="3a181-203">Dies bewirkt, dass das Formular Postback durchgesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-203">This causes the form to postback.</span></span> <span data-ttu-id="3a181-204">Beim Postback wird die `INSERT`-Anweisung des SqlDataSource-Steuer Elements ausgeführt. die beiden Parameter werden mit den vom Benutzer eingegebenen Werten in den zwei TextBox-Steuerelementen der DetailsView aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="3a181-204">On postback, the SqlDataSource control's `INSERT` statement is executed; its two parameters are populated with the user-entered values in the DetailsView's two TextBox controls.</span></span> <span data-ttu-id="3a181-205">Leider gibt es kein visuelles Feedback, dass eine Einfügung aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="3a181-205">Unfortunately, there is no visual feedback that an insert has occurred.</span></span> <span data-ttu-id="3a181-206">Es wäre schön, dass eine Meldung angezeigt wird, die bestätigt, dass ein neuer Datensatz hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-206">It would be nice to have a message displayed, confirming that a new record has been added.</span></span> <span data-ttu-id="3a181-207">Ich lasse dies als Übung für den Reader aus.</span><span class="sxs-lookup"><span data-stu-id="3a181-207">I leave this as an exercise for the reader.</span></span> <span data-ttu-id="3a181-208">Nach dem Hinzufügen eines neuen Datensatzes aus der DetailsView zeigt die GridView auf der Master Seite weiterhin dieselben fünf Datensätze an wie zuvor. der soeben hinzugefügte Datensatz ist nicht enthalten.</span><span class="sxs-lookup"><span data-stu-id="3a181-208">Also, after adding a new record from the DetailsView the GridView in the master page still shows the same five records as before; it does not include the just-added record.</span></span> <span data-ttu-id="3a181-209">Wir untersuchen, wie dies in den nächsten Schritten behoben werden kann.</span><span class="sxs-lookup"><span data-stu-id="3a181-209">We'll examine how to remedy this in the upcoming steps.</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-210">Zusätzlich zum Hinzufügen einer Form des visuellen Feedbacks, dass die Einfügung erfolgreich war, empfiehlt es sich, auch die einfügeschnittstelle der DetailsView so zu aktualisieren, dass Sie die Validierung einschließt.</span><span class="sxs-lookup"><span data-stu-id="3a181-210">In addition to adding some form of visual feedback that the insert has succeeded, I'd encourage you to also update the DetailsView's inserting interface to include validation.</span></span> <span data-ttu-id="3a181-211">Zurzeit ist keine Validierung vorhanden.</span><span class="sxs-lookup"><span data-stu-id="3a181-211">Currently, there is no validation.</span></span> <span data-ttu-id="3a181-212">Wenn ein Benutzer einen ungültigen Wert für das `UnitPrice` Feld, z. b. "zu teuer", eingibt, wird eine Ausnahme beim Postback ausgelöst, wenn das System versucht, diese Zeichenfolge in eine Dezimalzahl zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-212">If a user enters an invalid value for the `UnitPrice` field, such as "Too expensive," an exception will be thrown on postback when the system attempts to convert that string into a decimal.</span></span> <span data-ttu-id="3a181-213">Weitere Informationen zum Anpassen der einfügeschnittstelle finden Sie im Tutorial [ *Anpassen der Daten Änderungs Schnittstelle* ](https://asp.net/learn/data-access/tutorial-20-vb.aspx) in der Reihe " [Arbeiten mit Daten](../../data-access/index.md)".</span><span class="sxs-lookup"><span data-stu-id="3a181-213">For more information on customizing the inserting interface, refer to the [*Customizing the Data Modification Interface* tutorial](https://asp.net/learn/data-access/tutorial-20-vb.aspx) from my [Working with Data tutorial series](../../data-access/index.md).</span></span>

## <a name="step-3-creating-public-properties-and-methods-in-the-master-page"></a><span data-ttu-id="3a181-214">Schritt 3: Erstellen von öffentlichen Eigenschaften und Methoden auf der Master Seite</span><span class="sxs-lookup"><span data-stu-id="3a181-214">Step 3: Creating Public Properties and Methods in the Master Page</span></span>

<span data-ttu-id="3a181-215">In Schritt 1 haben wir auf der Master Seite ein Label-websteuer Element mit dem Namen `GridMessage` oberhalb der GridView hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="3a181-215">In Step 1 we added a Label Web control named `GridMessage` above the GridView in the master page.</span></span> <span data-ttu-id="3a181-216">Diese Bezeichnung soll optional eine Meldung anzeigen.</span><span class="sxs-lookup"><span data-stu-id="3a181-216">This Label is intended to optionally display a message.</span></span> <span data-ttu-id="3a181-217">Wenn Sie z. b. der `Products` Tabelle einen neuen Datensatz hinzugefügt haben, möchten Sie möglicherweise eine Meldung anzeigen, die Folgendes enthält: "*ProductName* wurde der Datenbank hinzugefügt."</span><span class="sxs-lookup"><span data-stu-id="3a181-217">For example, after adding a new record to the `Products` table, we might want to show a message that reads: "*ProductName* has been added to the database."</span></span> <span data-ttu-id="3a181-218">Anstatt den Text für diese Bezeichnung auf der Master Seite hart zu codieren, möchten wir möglicherweise, dass die Nachricht von der Inhaltsseite angepasst wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-218">Rather than hard-code the text for this Label in the master page, we might want the message to be customizable by the content page.</span></span>

<span data-ttu-id="3a181-219">Da das Label-Steuerelement als geschützte Element Variable innerhalb der Master Seite implementiert ist, kann auf Inhaltsseiten nicht direkt zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-219">Because the Label control is implemented as a protected member variable within the master page it cannot be accessed directly from content pages.</span></span> <span data-ttu-id="3a181-220">Um die Bezeichnung in einer Master Seite von der Inhaltsseite aus zu bearbeiten (oder für jedes websteuer Element auf der Master Seite), müssen wir auf der Master Seite eine öffentliche Eigenschaft erstellen, die das websteuer Element verfügbar macht oder als Proxy fungiert, mit dem eine ihrer Eigenschaften sein kann.  auf.</span><span class="sxs-lookup"><span data-stu-id="3a181-220">In order to work with the Label within a master page from the content page (or, for that matter, any Web control in the master page) we need to create a public property in the master page that exposes the Web control or serves as a proxy by which one of its properties can be accessed.</span></span> <span data-ttu-id="3a181-221">Fügen Sie der Code Behind-Klasse der Master Seite die folgende Syntax hinzu, um die `Text`-Eigenschaft der Bezeichnung verfügbar zu machen:</span><span class="sxs-lookup"><span data-stu-id="3a181-221">Add the following syntax to the master page's code-behind class to expose the Label's `Text` property:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample6.vb)]

<span data-ttu-id="3a181-222">Wenn der `Products` Tabelle auf einer Inhaltsseite ein neuer Datensatz hinzugefügt wird, muss die `RecentProducts` GridView auf der Master Seite erneut an die zugrunde liegende Datenquelle gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-222">When a new record is added to the `Products` table from a content page the `RecentProducts` GridView in the master page needs to rebind to its underlying data source.</span></span> <span data-ttu-id="3a181-223">Zum erneuten Binden der GridView-Methode wird die `DataBind`-Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="3a181-223">To rebind the GridView call its `DataBind` method.</span></span> <span data-ttu-id="3a181-224">Da die GridView auf der Master Seite nicht Programm gesteuert für die Inhaltsseiten zugänglich ist, müssen wir eine öffentliche Methode auf der Master Seite erstellen, die die Daten bei der aufgerufenen wieder an die GridView bindet.</span><span class="sxs-lookup"><span data-stu-id="3a181-224">Because the GridView in the master page is not programmatically accessible to the content pages, we need to create a public method in the master page that, when called, rebinds the data to the GridView.</span></span> <span data-ttu-id="3a181-225">Fügen Sie der Code Behind-Klasse der Master Seite die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="3a181-225">Add the following method to the master page's code-behind class:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample7.vb)]

<span data-ttu-id="3a181-226">Wenn die `GridMessageText`-Eigenschaft und `RefreshRecentProductsGrid`-Methode vorhanden sind, kann jede Inhaltsseite den Wert der `Text` Eigenschaft `GridMessage` Bezeichnung Programm gesteuert festlegen oder lesen oder die Daten erneut an die `RecentProducts` GridView binden.</span><span class="sxs-lookup"><span data-stu-id="3a181-226">With the `GridMessageText` property and `RefreshRecentProductsGrid` method in place, any content page can programmatically set or read the value of the `GridMessage` Label's `Text` property or rebind the data to the `RecentProducts` GridView.</span></span> <span data-ttu-id="3a181-227">In Schritt 4 wird der Zugriff auf die öffentlichen Eigenschaften und Methoden der Master Seite über eine Inhaltsseite untersucht.</span><span class="sxs-lookup"><span data-stu-id="3a181-227">Step 4 examines how to access the master page's public properties and methods from a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-228">Vergessen Sie nicht, die Eigenschaften und Methoden der Master Seite als `Public`zu markieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-228">Don't forget to mark the master page's properties and methods as `Public`.</span></span> <span data-ttu-id="3a181-229">Wenn Sie diese Eigenschaften und Methoden nicht explizit als `Public`bezeichnen, kann auf Sie nicht über die Inhaltsseite zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-229">If you do not explicitly denote these properties and methods as `Public`, they will not be accessible from the content page.</span></span>

## <a name="step-4-calling-the-master-pages-public-members-from-a-content-page"></a><span data-ttu-id="3a181-230">Schritt 4: Aufrufen der öffentlichen Member der Master Seite über eine Inhaltsseite</span><span class="sxs-lookup"><span data-stu-id="3a181-230">Step 4: Calling the Master Page's Public Members from a Content Page</span></span>

<span data-ttu-id="3a181-231">Nun, da die Master Seite über die erforderlichen öffentlichen Eigenschaften und Methoden verfügt, sind wir bereit, diese Eigenschaften und Methoden auf der Seite "`AddProduct.aspx` Inhalt" aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="3a181-231">Now that the master page has the necessary public properties and methods, we're ready to invoke these properties and methods from the `AddProduct.aspx` content page.</span></span> <span data-ttu-id="3a181-232">Insbesondere müssen wir die `GridMessageText`-Eigenschaft der Master Seite festlegen und ihre `RefreshRecentProductsGrid`-Methode aufzurufen, nachdem das neue Produkt der Datenbank hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-232">Specifically, we need to set the master page's `GridMessageText` property and call its `RefreshRecentProductsGrid` method after the new product has been added to the database.</span></span> <span data-ttu-id="3a181-233">Alle ASP.NET Data Web-Steuerelemente lösen Ereignisse unmittelbar vor und nach dem Durchführen verschiedener Aufgaben aus, die es Seiten Entwicklern erleichtern, eine programmgesteuerte Aktion entweder vor oder nach der Aufgabe auszuführen.</span><span class="sxs-lookup"><span data-stu-id="3a181-233">All the ASP.NET data Web controls fire events immediately before and after completing various tasks, which make it easy for page developers to take some programmatic action either before or after the task.</span></span> <span data-ttu-id="3a181-234">Wenn z. b. der Endbenutzer auf die Schaltfläche Einfügen der DetailsView klickt, löst die DetailsView bei Postback das `ItemInserting`-Ereignis aus, bevor der Einfügungs Workflow gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-234">For example, when the end user clicks the DetailsView's Insert button, on postback the DetailsView raises its `ItemInserting` event before beginning the inserting workflow.</span></span> <span data-ttu-id="3a181-235">Anschließend wird der Datensatz in die Datenbank eingefügt.</span><span class="sxs-lookup"><span data-stu-id="3a181-235">It then inserts the record into the database.</span></span> <span data-ttu-id="3a181-236">Danach löst die DetailsView das `ItemInserted`-Ereignis aus.</span><span class="sxs-lookup"><span data-stu-id="3a181-236">Following that, the DetailsView raises its `ItemInserted` event.</span></span> <span data-ttu-id="3a181-237">Um mit der Master Seite zu arbeiten, nachdem das neue Produkt hinzugefügt wurde, erstellen Sie daher einen Ereignishandler für das `ItemInserted`-Ereignis der DetailsView.</span><span class="sxs-lookup"><span data-stu-id="3a181-237">Therefore, in order to work with the master page after the new product has been added, create an event handler for the DetailsView's `ItemInserted` event.</span></span>

<span data-ttu-id="3a181-238">Es gibt zwei Möglichkeiten, wie eine Inhaltsseite Programm gesteuert mit der Master Seite in eine Schnittstelle gehen kann:</span><span class="sxs-lookup"><span data-stu-id="3a181-238">There are two ways that a content page can programmatically interface with its master page:</span></span>

- <span data-ttu-id="3a181-239">Verwenden der `Page.Master`-Eigenschaft, die einen lose typisierten Verweis auf die Master Seite zurückgibt, oder</span><span class="sxs-lookup"><span data-stu-id="3a181-239">Using the `Page.Master` property, which returns a loosely-typed reference to the master page, or</span></span>
- <span data-ttu-id="3a181-240">Geben Sie den Master Seitentyp der Seite oder den Dateipfad über eine `@MasterType` Direktive an. Dadurch wird der Seite mit dem Namen `Master`automatisch eine stark typisierte Eigenschaft hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="3a181-240">Specify the page's master page type or file path via a `@MasterType` directive; this automatically adds a strongly-typed property to the page named `Master`.</span></span>

<span data-ttu-id="3a181-241">Sehen wir uns beide Ansätze genauer an.</span><span class="sxs-lookup"><span data-stu-id="3a181-241">Let's examine both approaches.</span></span>

### <a name="using-the-loosely-typedpagemasterproperty"></a><span data-ttu-id="3a181-242">Verwenden der lose typisierten`Page.Master`-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="3a181-242">Using the Loosely-Typed`Page.Master`Property</span></span>

<span data-ttu-id="3a181-243">Alle ASP.NET Webseiten müssen von der `Page`-Klasse abgeleitet werden, die sich im `System.Web.UI`-Namespace befindet.</span><span class="sxs-lookup"><span data-stu-id="3a181-243">All ASP.NET web pages must derive from the `Page` class, which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="3a181-244">Die `Page`-Klasse enthält eine [`Master`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) , die einen Verweis auf die Master Seite der Seite zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="3a181-244">The `Page` class includes a [`Master` property](https://msdn.microsoft.com/library/system.web.ui.page.master.aspx) that returns a reference to the page's master page.</span></span> <span data-ttu-id="3a181-245">Wenn die Seite keine Master Seite hat `Master` gibt `Nothing`zurück.</span><span class="sxs-lookup"><span data-stu-id="3a181-245">If the page does not have a master page `Master` returns `Nothing`.</span></span>

<span data-ttu-id="3a181-246">Die `Master`-Eigenschaft gibt ein Objekt vom Typ " [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) " zurück (auch im `System.Web.UI` Namespace). Dies ist der Basistyp, von dem alle Masterseiten abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-246">The `Master` property returns an object of type [`MasterPage`](https://msdn.microsoft.com/library/system.web.ui.masterpage.aspx) (also located in the `System.Web.UI` namespace) which is the base type from which all master pages derive from.</span></span> <span data-ttu-id="3a181-247">Damit öffentliche Eigenschaften oder Methoden verwendet werden können, die auf der Master Seite unserer Website definiert sind, müssen wir das `MasterPage` Objekt, das von der `Master`-Eigenschaft zurückgegeben wird, in den entsprechenden Typ umwandeln.</span><span class="sxs-lookup"><span data-stu-id="3a181-247">Therefore, to use public properties or methods defined in our website's master page we must cast the `MasterPage` object returned from the `Master` property to the appropriate type.</span></span> <span data-ttu-id="3a181-248">Da wir unsere Masterseiten Datei `Site.master`benannt haben, wurde die Code-Behind-Klasse `Site`benannt.</span><span class="sxs-lookup"><span data-stu-id="3a181-248">Because we named our master page file `Site.master`, the code-behind class was named `Site`.</span></span> <span data-ttu-id="3a181-249">Daher wandelt der folgende Code die `Page.Master`-Eigenschaft in eine Instanz der `Site`-Klasse um.</span><span class="sxs-lookup"><span data-stu-id="3a181-249">Therefore, the following code casts the `Page.Master` property to an instance of the `Site` class.</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample8.vb)]

<span data-ttu-id="3a181-250">Nachdem wir nun die lose typisierte `Page.Master` Eigenschaft in den Standorttyp eingefügt haben, können wir auf die Eigenschaften und Methoden verweisen, die für den Standort spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="3a181-250">Now that we have casted the loosely-typed `Page.Master` property to the Site type we can reference the properties and methods specific to Site.</span></span> <span data-ttu-id="3a181-251">Wie in Abbildung 7 gezeigt, wird die öffentliche Eigenschaften `GridMessageText` in der IntelliSense-Dropdown-Anzeige angezeigt.</span><span class="sxs-lookup"><span data-stu-id="3a181-251">As Figure 7 shows, the public property `GridMessageText` appears in the IntelliSense drop-down.</span></span>

<span data-ttu-id="3a181-252">[![IntelliSense zeigt die öffentlichen Eigenschaften und Methoden unserer Master Seite an.](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-252">[![IntelliSense Shows our Master Page's Public Properties and Methods](interacting-with-the-master-page-from-the-content-page-vb/_static/image20.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image19.png)</span></span>

<span data-ttu-id="3a181-253">**Abbildung 07**: IntelliSense zeigt die öffentlichen Eigenschaften und Methoden unserer Master Seite[an (Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-253">**Figure 07**: IntelliSense Shows our Master Page's Public Properties and Methods ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image21.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-254">Wenn Sie die Masterseiten Datei `MasterPage.master` haben, wird der Code Behind-Klassenname der Master Seite `MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="3a181-254">If you named your master page file `MasterPage.master` then the master page's code-behind class name is `MasterPage`.</span></span> <span data-ttu-id="3a181-255">Dies kann zu mehrdeutigem Code führen, wenn die Umwandlung vom Typ `System.Web.UI.MasterPage` in Ihre `MasterPage` Klasse durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-255">This can lead to ambiguous code when casting from the type `System.Web.UI.MasterPage` to your `MasterPage` class.</span></span> <span data-ttu-id="3a181-256">Kurz gesagt, Sie müssen den Typ, in den Sie umgewandelt werden, vollständig qualifizieren, was bei der Verwendung des Website-Projekt Modells etwas kompliziert sein kann.</span><span class="sxs-lookup"><span data-stu-id="3a181-256">In short, you need to fully qualify the type you are casting to, which can be a little tricky when using the Web Site Project model.</span></span> <span data-ttu-id="3a181-257">Ich möchte entweder sicherstellen, dass Sie beim Erstellen der Master Seite einen anderen Namen als `MasterPage.master` haben oder einen stark typisierten Verweis auf die Master Seite erstellen.</span><span class="sxs-lookup"><span data-stu-id="3a181-257">My suggestion would be to either make sure that when you create your master page you name it something other than `MasterPage.master` or, even better, create a strongly-typed reference to the master page.</span></span>

### <a name="creating-a-strongly-typed-reference-with-themastertypedirective"></a><span data-ttu-id="3a181-258">Erstellen eines stark typisierten Verweises mit der`@MasterType`-Direktive</span><span class="sxs-lookup"><span data-stu-id="3a181-258">Creating a Strongly-Typed Reference with the`@MasterType`Directive</span></span>

<span data-ttu-id="3a181-259">Wenn Sie sich genau ansehen, sehen Sie, dass die Code-Behind-Klasse einer ASP.NET-Seite eine partielle Klasse ist (Beachten Sie das `Partial`-Schlüsselwort in der Klassendefinition).</span><span class="sxs-lookup"><span data-stu-id="3a181-259">If you look closely you can see that an ASP.NET page's code-behind class is a partial class (note the `Partial` keyword in the class definition).</span></span> <span data-ttu-id="3a181-260">Partielle Klassen wurden in C# und Visual Basic with.NET Framework 2,0 eingeführt und ermöglichen es, den Membern einer Klasse in einer kurzen Zahl über mehrere Dateien hinweg zu definieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-260">Partial classes were introduced in C# and Visual Basic with.NET Framework 2.0 and, in a nutshell, allow for a class's members to be defined across multiple files.</span></span> <span data-ttu-id="3a181-261">Die Code-Behind-Klasse File-`AddProduct.aspx.vb`z. b. enthält den Code, den wir, den Seiten Entwickler, erstellen.</span><span class="sxs-lookup"><span data-stu-id="3a181-261">The code-behind class file - `AddProduct.aspx.vb`, for example - contains the code that we, the page developer, create.</span></span> <span data-ttu-id="3a181-262">Zusätzlich zu unserem Code erstellt die ASP.net-Engine automatisch eine separate Klassendatei mit Eigenschaften und Ereignis Handlern in, die das deklarative Markup in die Klassenhierarchie der Seite übersetzen.</span><span class="sxs-lookup"><span data-stu-id="3a181-262">In addition to our code, the ASP.NET engine automatically creates a separate class file with properties and event handlers in that translate the declarative markup into the page's class hierarchy.</span></span>

<span data-ttu-id="3a181-263">Die automatische Codegenerierung, die jedes Mal auftritt, wenn eine ASP.NET-Seite besucht wird, ist für einige sehr interessante und nützliche Möglichkeiten geeignet.</span><span class="sxs-lookup"><span data-stu-id="3a181-263">The automatic code generation that occurs whenever an ASP.NET page is visited paves the way for some rather interesting and useful possibilities.</span></span> <span data-ttu-id="3a181-264">Wenn wir bei Masterseiten der ASP.net-Engine mitteilen, welche Master Seite von unserer Inhaltsseite verwendet wird, generiert Sie eine stark typisierte `Master`-Eigenschaft für uns.</span><span class="sxs-lookup"><span data-stu-id="3a181-264">In the case of master pages, if we tell the ASP.NET engine what master page is being used by our content page it generates a strongly-typed `Master` property for us.</span></span>

<span data-ttu-id="3a181-265">Verwenden Sie die [`@MasterType`-Direktive](https://msdn.microsoft.com/library/ms228274.aspx) , um die ASP.net-Engine über den Master Seitentyp der Inhaltsseite zu informieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-265">Use the [`@MasterType` directive](https://msdn.microsoft.com/library/ms228274.aspx) to inform the ASP.NET engine of the content page's master page type.</span></span> <span data-ttu-id="3a181-266">Die `@MasterType`-Direktive kann entweder den Typnamen der Master Seite oder den zugehörigen Dateipfad akzeptieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-266">The `@MasterType` directive can accept either the type name of the master page or its file path.</span></span> <span data-ttu-id="3a181-267">Um anzugeben, dass die `AddProduct.aspx` Seite `Site.master` als Master Seite verwendet, fügen Sie die folgende Direktive am Anfang der `AddProduct.aspx`hinzu:</span><span class="sxs-lookup"><span data-stu-id="3a181-267">To specify that the `AddProduct.aspx` page uses `Site.master` as its master page, add the following directive to the top of `AddProduct.aspx`:</span></span>

[!code-aspx[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample9.aspx)]

<span data-ttu-id="3a181-268">Diese Direktive weist die ASP.net-Engine an, einen stark typisierten Verweis auf die Master Seite über eine Eigenschaft mit dem Namen `Master`hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="3a181-268">This directive instructs the ASP.NET engine to add a strongly-typed reference to the master page through a property named `Master`.</span></span> <span data-ttu-id="3a181-269">Wenn die `@MasterType`-Direktive vorhanden ist, können die öffentlichen Eigenschaften und Methoden der `Site.master` Master Seite direkt über die `Master`-Eigenschaft aufgerufen werden, ohne dass Umwandlungen vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="3a181-269">With the `@MasterType` directive in place, we can call the `Site.master` master page's public properties and methods directly through the `Master` property without any casts.</span></span>

> [!NOTE]
> <span data-ttu-id="3a181-270">Wenn Sie die `@MasterType`-Direktive weglassen, wird die Syntax `Page.Master` und `Master` dasselbe Ergebnis zurückgeben: ein lose typisiertes Objekt zur Master Seite der Seite.</span><span class="sxs-lookup"><span data-stu-id="3a181-270">If you omit the `@MasterType` directive, the syntax `Page.Master` and `Master` return the same thing: a loosely-typed object to the page's master page.</span></span> <span data-ttu-id="3a181-271">Wenn Sie die `@MasterType`-Direktive einschließen, gibt `Master` einen stark typisierten Verweis auf die angegebene Master Seite zurück.</span><span class="sxs-lookup"><span data-stu-id="3a181-271">If you include the `@MasterType` directive then `Master` returns a strongly-typed reference to the specified master page.</span></span> <span data-ttu-id="3a181-272">`Page.Master`gibt jedoch immer noch einen locker-typisierten Verweis zurück.</span><span class="sxs-lookup"><span data-stu-id="3a181-272">`Page.Master`, however, still returns a loosely-typed reference.</span></span> <span data-ttu-id="3a181-273">Eine ausführlichere Betrachtung der Gründe, warum dies der Fall ist und wie die `Master`-Eigenschaft erstellt wird, wenn die `@MasterType`-Direktive enthalten ist, finden Sie im Blogeintrag von [K. Scott allen](http://odetocode.com/blogs/scott/default.aspx) [`@MasterType` in ASP.NET 2,0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span><span class="sxs-lookup"><span data-stu-id="3a181-273">For a more thorough look at why this is the case and how the `Master` property is constructed when the `@MasterType` directive is included, see [K. Scott Allen](http://odetocode.com/blogs/scott/default.aspx)'s blog entry [`@MasterType` in ASP.NET 2.0](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx).</span></span>

### <a name="updating-the-master-page-after-adding-a-new-product"></a><span data-ttu-id="3a181-274">Aktualisieren der Master Seite nach dem Hinzufügen eines neuen Produkts</span><span class="sxs-lookup"><span data-stu-id="3a181-274">Updating the Master Page After Adding a New Product</span></span>

<span data-ttu-id="3a181-275">Nachdem wir nun wissen, wie die öffentlichen Eigenschaften und Methoden einer Master Seite auf einer Inhaltsseite aufgerufen werden, können wir die `AddProduct.aspx` Seite aktualisieren, sodass die Master Seite nach dem Hinzufügen eines neuen Produkts aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-275">Now that we know how to invoke a master page's public properties and methods from a content page, we're ready to update the `AddProduct.aspx` page so that the master page is refreshed after adding a new product.</span></span> <span data-ttu-id="3a181-276">Zu Beginn von Schritt 4 haben wir einen Ereignishandler für das `ItemInserting`-Ereignis des DetailsView-Steuer Elements erstellt, das unmittelbar nach dem Hinzufügen des neuen Produkts zur Datenbank ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="3a181-276">At the beginning of Step 4 we created an event handler for the DetailsView control's `ItemInserting` event, which executes immediately after the new product has been added to the database.</span></span> <span data-ttu-id="3a181-277">Fügen Sie dem Ereignishandler folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="3a181-277">Add the following code to that event handler:</span></span>

[!code-vb[Main](interacting-with-the-master-page-from-the-content-page-vb/samples/sample10.vb)]

<span data-ttu-id="3a181-278">Der obige Code verwendet sowohl die lose typisierte `Page.Master`-Eigenschaft als auch die stark typisierte `Master`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="3a181-278">The above code uses both the loosely-typed `Page.Master` property and the strongly-typed `Master` property.</span></span> <span data-ttu-id="3a181-279">Beachten Sie, dass die `GridMessageText`-Eigenschaft auf "*ProductName* wurde dem Raster hinzugefügt..." festgelegt ist. Die Werte des soeben hinzugefügten Produkts sind über die `e.Values` Auflistung verfügbar. wie Sie sehen können, erfolgt der Zugriff auf den soeben hinzugefügten `ProductName` Wert über `e.Values("ProductName")`.</span><span class="sxs-lookup"><span data-stu-id="3a181-279">Note that the `GridMessageText` property is set to "*ProductName* added to grid..." The just-added product's values are accessible through the `e.Values` collection; as you can see, the just-added `ProductName` value is accessed via `e.Values("ProductName")`.</span></span>

<span data-ttu-id="3a181-280">Abbildung 8 zeigt die `AddProduct.aspx` Seite unmittelbar nach dem Hinzufügen eines neuen Produkts, das der-Datenbank hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="3a181-280">Figure 8 shows the `AddProduct.aspx` page immediately after a new product - Scott's Soda - has been added to the database.</span></span> <span data-ttu-id="3a181-281">Beachten Sie, dass der soeben hinzugefügte Produktname in der Bezeichnung der Master Seite vermerkt ist und dass die GridView aktualisiert wurde, um das Produkt und den Preis einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="3a181-281">Note that the just-added product name is noted in the master page's Label and that the GridView has been refreshed to include the product and its price.</span></span>

<span data-ttu-id="3a181-282">[![die Bezeichnung und die GridView der Master Seite das soeben hinzugefügte Produkt](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3a181-282">[![The Master Page's Label and GridView Show the Just-Added Product](interacting-with-the-master-page-from-the-content-page-vb/_static/image23.png)](interacting-with-the-master-page-from-the-content-page-vb/_static/image22.png)</span></span>

<span data-ttu-id="3a181-283">**Abbildung 08**: die Bezeichnung und die GridView der Master Seite zeigen das soeben hinzugefügte Produkt an ([Klicken Sie, um das Bild in voller Größe anzuzeigen](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3a181-283">**Figure 08**: The Master Page's Label and GridView Show the Just-Added Product ([Click to view full-size image](interacting-with-the-master-page-from-the-content-page-vb/_static/image24.png))</span></span>

## <a name="summary"></a><span data-ttu-id="3a181-284">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="3a181-284">Summary</span></span>

<span data-ttu-id="3a181-285">Idealerweise sind eine Master Seite und ihre Inhaltsseiten vollständig voneinander getrennt und erfordern keine Interaktions Ebene.</span><span class="sxs-lookup"><span data-stu-id="3a181-285">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="3a181-286">Während Masterseiten und Inhaltsseiten mit diesem Ziel entworfen werden sollten, gibt es eine Reihe allgemeiner Szenarien, in denen eine Inhaltsseite mit der Master Seite in eine Schnittstelle gesetzt werden muss.</span><span class="sxs-lookup"><span data-stu-id="3a181-286">While master pages and content pages should be designed with that goal in mind, there are a number of common scenarios in which a content page must interface with its master page.</span></span> <span data-ttu-id="3a181-287">Einer der häufigsten Gründe ist das Aktualisieren eines bestimmten Teils der Masterseiten Anzeige auf der Grundlage einer Aktion, die auf der Inhaltsseite aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="3a181-287">One of the most common reasons centers around updating a particular portion of the master page display based on some action that transpired in the content page.</span></span>

<span data-ttu-id="3a181-288">Die gute Nachricht ist, dass es relativ einfach ist, eine Inhaltsseite Programm gesteuert mit der Master Seite zu interagieren.</span><span class="sxs-lookup"><span data-stu-id="3a181-288">The good news is that it's relatively straightforward to have a content page programmatically interact with its master page.</span></span> <span data-ttu-id="3a181-289">Beginnen Sie, indem Sie auf der Master Seite öffentliche Eigenschaften oder Methoden erstellen, die die Funktionalität Kapseln, die von einer Inhaltsseite aufgerufen werden muss.</span><span class="sxs-lookup"><span data-stu-id="3a181-289">Start by creating public properties or methods in the master page that encapsulate the functionality that needs to be invoked by a content page.</span></span> <span data-ttu-id="3a181-290">Greifen Sie dann auf der Seite Inhalt über die lose typisierte `Page.Master`-Eigenschaft auf die Eigenschaften und Methoden der Master Seite zu, oder verwenden Sie die `@MasterType`-Direktive, um einen stark typisierten Verweis auf die Master Seite zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="3a181-290">Then, in the content page, access the master page's properties and methods through the loosely-typed `Page.Master` property or use the `@MasterType` directive to create a strongly-typed reference to the master page.</span></span>

<span data-ttu-id="3a181-291">Im nächsten Tutorial wird erläutert, wie die Master Seite Programm gesteuert mit einer ihrer Inhaltsseiten interagieren kann.</span><span class="sxs-lookup"><span data-stu-id="3a181-291">In the next tutorial we examine how to have the master page programmatically interact with one of its content pages.</span></span>

<span data-ttu-id="3a181-292">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="3a181-292">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="3a181-293">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="3a181-293">Further Reading</span></span>

<span data-ttu-id="3a181-294">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="3a181-294">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="3a181-295">Zugreifen auf und Aktualisieren von Daten in ASP.net</span><span class="sxs-lookup"><span data-stu-id="3a181-295">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="3a181-296">ASP.net Master Seiten: Tipps, Tricks und Traps</span><span class="sxs-lookup"><span data-stu-id="3a181-296">ASP.NET Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="3a181-297">`@MasterType` in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="3a181-297">`@MasterType` in ASP.NET 2.0</span></span>](http://odetocode.com/Blogs/scott/archive/2005/07/16/1944.aspx)
- [<span data-ttu-id="3a181-298">Übergeben von Informationen zwischen Inhalt und Master Seiten</span><span class="sxs-lookup"><span data-stu-id="3a181-298">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="3a181-299">Arbeiten mit Daten in ASP.net-Tutorials</span><span class="sxs-lookup"><span data-stu-id="3a181-299">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="3a181-300">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="3a181-300">About the Author</span></span>

<span data-ttu-id="3a181-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor mehrerer ASP/ASP. net-Bücher und Gründer von 4GuysFromRolla.com, hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="3a181-301">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3a181-302">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="3a181-302">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3a181-303">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 3,5 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3a181-303">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="3a181-304">Scott kann über [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/)erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="3a181-304">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="3a181-305">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="3a181-305">Special Thanks To</span></span>

<span data-ttu-id="3a181-306">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="3a181-306">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3a181-307">Lead Prüfer für dieses Tutorial war Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="3a181-307">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="3a181-308">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="3a181-308">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3a181-309">Wenn dies der Fall ist, löschen Sie eine Zeile bei [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3a181-309">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3a181-310">[Zurück](control-id-naming-in-content-pages-vb.md)
> [Weiter](interacting-with-the-content-page-from-the-master-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3a181-310">[Previous](control-id-naming-in-content-pages-vb.md)
[Next](interacting-with-the-content-page-from-the-master-page-vb.md)</span></span>
