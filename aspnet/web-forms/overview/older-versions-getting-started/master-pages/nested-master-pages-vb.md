---
uid: web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
title: Masted Master Pages (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Zeigt, wie eine Master Seite innerhalb einer anderen geschachtelt wird.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 14d9aa1b-4dca-43a0-aa9d-a6e891fee019
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 9bb39712855c37f5cbcbb447f7691e9451b8dc92
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78461451"
---
# <a name="nested-master-pages-vb"></a><span data-ttu-id="32222-103">Geschachtelte Masterseiten (VB)</span><span class="sxs-lookup"><span data-stu-id="32222-103">Nested Master Pages (VB)</span></span>

<span data-ttu-id="32222-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="32222-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="32222-105">[Code herunterladen](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) oder [PDF herunterladen](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="32222-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_VB.pdf)</span></span>

> <span data-ttu-id="32222-106">Zeigt, wie eine Master Seite innerhalb einer anderen geschachtelt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-106">Shows how to nest one master page within another.</span></span>

## <a name="introduction"></a><span data-ttu-id="32222-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="32222-107">Introduction</span></span>

<span data-ttu-id="32222-108">Im Verlauf der letzten neun Tutorials haben wir gesehen, wie Sie ein Standort weites Layout mit Masterseiten implementieren.</span><span class="sxs-lookup"><span data-stu-id="32222-108">Over the course of the past nine tutorials we have seen how to implement a site-wide layout with master pages.</span></span> <span data-ttu-id="32222-109">Kurz gesagt: mithilfe von Masterseiten können wir, den Seiten Entwickler, ein gemeinsames Markup auf der Master Seite zusammen mit bestimmten Regionen definieren, die auf Inhaltsseiten einzeln angepasst werden können.</span><span class="sxs-lookup"><span data-stu-id="32222-109">In a nutshell, master pages allow us, the page developer, to define common markup in the master page along with specific regions that can be customized on a content page-by-content page basis.</span></span> <span data-ttu-id="32222-110">Die contentplachalter-Steuerelemente in einer Master Seite zeigen die anpassbaren Bereiche an. Das angepasste Markup für die contentplachalter-Steuerelemente wird auf der Inhaltsseite über Inhalts Steuerelemente definiert.</span><span class="sxs-lookup"><span data-stu-id="32222-110">The ContentPlaceHolder controls in a master page indicate the customizable regions; the customized markup for the ContentPlaceHolder controls are defined in the content page via Content controls.</span></span>

<span data-ttu-id="32222-111">Die bisher untersuchten Masterseiten Techniken sind hervorragend, wenn Sie über ein einzelnes Layout verfügen, das für die gesamte Website verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="32222-111">The master page techniques we've explored thus far are great if you have a single layout used across the entire site.</span></span> <span data-ttu-id="32222-112">Viele große Websites verfügen jedoch über ein Site Layout, das in verschiedenen Abschnitten angepasst ist.</span><span class="sxs-lookup"><span data-stu-id="32222-112">However, many large websites have a site layout that is customized across various sections.</span></span> <span data-ttu-id="32222-113">Stellen Sie sich z. b. eine Health Care-Anwendung vor, die vom Krankenhaus Personal zum Verwalten von Patienteninformationen, Aktivitäten und Rechnungen verwendet wird</span><span class="sxs-lookup"><span data-stu-id="32222-113">For example, consider a health care application used by hospital staff to manage patient information, activities, and billing.</span></span> <span data-ttu-id="32222-114">In dieser Anwendung sind möglicherweise drei Arten von Webseiten vorhanden:</span><span class="sxs-lookup"><span data-stu-id="32222-114">There may be three types of web pages in this application:</span></span>

- <span data-ttu-id="32222-115">Mitarbeiter spezifische Seiten, auf denen Mitarbeiter Mitglieder die Verfügbarkeit aktualisieren, Zeitpläne anzeigen oder Urlaubszeit anfordern können.</span><span class="sxs-lookup"><span data-stu-id="32222-115">Staff member-specific pages where staff members can update availability, view schedules, or request vacation time.</span></span>
- <span data-ttu-id="32222-116">Patientenspezifische Seiten, auf denen Mitarbeiter Mitgliederinformationen für einen bestimmten Patienten anzeigen oder bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="32222-116">Patient-specific pages where staff members view or edit information for a specific patient.</span></span>
- <span data-ttu-id="32222-117">Abrechnungs spezifische Seiten, bei denen die Buchhaltungs Prüfer aktuelle anspruchsstatus-und Finanzberichte überprüfen.</span><span class="sxs-lookup"><span data-stu-id="32222-117">Billing-specific pages where accountants review current claim statuses and financial reports.</span></span>

<span data-ttu-id="32222-118">Jede Seite kann ein gemeinsames Layout haben, z. b. ein Menü oben und eine Reihe häufig verwendeter Links im unteren Bereich.</span><span class="sxs-lookup"><span data-stu-id="32222-118">Every page might share a common layout, such as a menu across the top and a series of frequently used links along the bottom.</span></span> <span data-ttu-id="32222-119">Die Mitarbeiter-, Patienten-und Abrechnungs spezifischen Seiten müssen jedoch möglicherweise dieses generische Layout anpassen.</span><span class="sxs-lookup"><span data-stu-id="32222-119">But the staff-, patient-, and billing-specific pages may need to customize this generic layout.</span></span> <span data-ttu-id="32222-120">Beispielsweise sollten alle Personal spezifischen Seiten eine Kalender-und Aufgabenliste enthalten, die die Verfügbarkeit des aktuell angemeldeten Benutzers und den täglichen Zeitplan anzeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-120">For example, perhaps all staff-specific pages should include a calendar and task list showing the currently logged on user's availability and daily schedule.</span></span> <span data-ttu-id="32222-121">Möglicherweise müssen alle patientenspezifischen Seiten den Namen, die Adresse und die Versicherungsinformationen für den Patienten anzeigen, dessen Informationen bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="32222-121">Perhaps all patient-specific pages need to show the name, address, and insurance information for the patient whose information is being edited.</span></span>

<span data-ttu-id="32222-122">Es ist möglich, solche angepassten Layouts mithilfe von untergeordneten *Seiten*zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="32222-122">It's possible to create such customized layouts by using *nested master pages*.</span></span> <span data-ttu-id="32222-123">Um das oben beschriebene Szenario zu implementieren, erstellen Sie zunächst eine Master Seite, die das Site weite Layout, den Menü-und den Fußzeile-Inhalt definiert, wobei Inhalts Platzhalter die anpassbaren Bereiche definieren.</span><span class="sxs-lookup"><span data-stu-id="32222-123">To implement the above scenario, we would start by creating a master page that defined the site-wide layout, the menu and footer content, with ContentPlaceHolders defining the customizable regions.</span></span> <span data-ttu-id="32222-124">Anschließend erstellen wir drei nebeneinander erstellte Masterseiten, eine für jeden Typ von Webseite.</span><span class="sxs-lookup"><span data-stu-id="32222-124">We would then create three nested master pages, one for each type of web page.</span></span> <span data-ttu-id="32222-125">Jede Seite mit der Seite "Master" definiert den Inhalt unter dem Typ der Inhaltsseiten, die die Master Seite verwenden.</span><span class="sxs-lookup"><span data-stu-id="32222-125">Each nested master page would define the content among the type of content pages that use the master page.</span></span> <span data-ttu-id="32222-126">Mit anderen Worten: die Seite für die Seite für patientenspezifische Inhaltsseiten enthält Markup und programmgesteuerte Logik zum Anzeigen von Informationen über den zu bearbeitenden Patienten.</span><span class="sxs-lookup"><span data-stu-id="32222-126">In other words, the nested master page for patient-specific content pages would include markup and programmatic logic for displaying information about the patient being edited.</span></span> <span data-ttu-id="32222-127">Wenn Sie eine neue patientenspezifische Seite erstellen, binden wir Sie an diese vorgebundene Master Seite.</span><span class="sxs-lookup"><span data-stu-id="32222-127">When creating a new patient-specific page we would bind it to this nested master page.</span></span>

<span data-ttu-id="32222-128">In diesem Tutorial werden die Vorteile der vorgerufenen Masterseiten hervorgehoben.</span><span class="sxs-lookup"><span data-stu-id="32222-128">This tutorial starts by highlighting the benefits of nested master pages.</span></span> <span data-ttu-id="32222-129">Anschließend wird gezeigt, wie Sie die Erstellung und Verwendung von masted Masterseiten durchführen.</span><span class="sxs-lookup"><span data-stu-id="32222-129">It then shows how to create and use nested master pages.</span></span>

> [!NOTE]
> <span data-ttu-id="32222-130">In der Version 2,0 der .NET Framework sind möglicherweise gezwischenbte Masterseiten möglich.</span><span class="sxs-lookup"><span data-stu-id="32222-130">Nested master pages have been possible since version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="32222-131">Visual Studio 2005 enthielt jedoch keine Entwurfszeit Unterstützung für die Unterstützung von untergeordneten Seiten.</span><span class="sxs-lookup"><span data-stu-id="32222-131">However, Visual Studio 2005 did not include design-time support for nested master pages.</span></span> <span data-ttu-id="32222-132">Die gute Nachricht ist, dass Visual Studio 2008 eine umfangreiche Entwurfszeit-Ober Arbeit für die Verwendung von auf der Master Seite Verfügbarkeit bietet.</span><span class="sxs-lookup"><span data-stu-id="32222-132">The good news is that Visual Studio 2008 offers a rich design-time experience for nested master pages.</span></span> <span data-ttu-id="32222-133">Wenn Sie daran interessiert sind, die Verwendung von in der Liste verwendeten Masterseiten zu verwenden, aber weiterhin Visual Studio 2005 verwenden, lesen Sie den Blogbeitrag von [Scott Guthrie](https://weblogs.asp.net/scottgu/), [Tipps für gemasterte Masterseiten in VS 2005-Entwurfszeit](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span><span class="sxs-lookup"><span data-stu-id="32222-133">If you are interested in using nested master pages but are still using Visual Studio 2005, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [Tips for Nested Master Pages in VS 2005 Design-Time](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span></span>

## <a name="the-benefits-of-nested-master-pages"></a><span data-ttu-id="32222-134">Die Vorteile der in der Liste vorgerufenen Master Seiten</span><span class="sxs-lookup"><span data-stu-id="32222-134">The Benefits of Nested Master Pages</span></span>

<span data-ttu-id="32222-135">Viele Websites verfügen über einen übergreifenden Website Entwurf sowie weitere angepasste Entwürfe, die für bestimmte Seiten Typen spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="32222-135">Many websites have an overarching site design as well as more customized designs specific to certain types of pages.</span></span> <span data-ttu-id="32222-136">In der Demo-Webanwendung haben wir beispielsweise einen rudimentären Verwaltungsabschnitt (die Seiten im Ordner "`~/Admin`") erstellt.</span><span class="sxs-lookup"><span data-stu-id="32222-136">For instance, in our demo web application we have created a rudimentary Administration section (the pages in the `~/Admin` folder).</span></span> <span data-ttu-id="32222-137">Derzeit verwenden die Webseiten im Ordner "`~/Admin`" dieselbe Master Seite wie die Seiten, die sich nicht im Abschnitt "Verwaltung" befinden (`Site.master` oder `Alternate.master`, abhängig von der Auswahl des Benutzers).</span><span class="sxs-lookup"><span data-stu-id="32222-137">Currently the web pages in the `~/Admin` folder use the same master page as those pages not in the administration section (namely, `Site.master` or `Alternate.master`, depending on the user's selection).</span></span>

> [!NOTE]
> <span data-ttu-id="32222-138">Geben Sie vorerst an, dass unsere Website nur eine Master Seite hat, `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="32222-138">For now, pretend that our site has just one master page, `Site.master`.</span></span> <span data-ttu-id="32222-139">In diesem Tutorial wird die Verwendung von untergeordneten Seiten mit zwei (oder mehr) Masterseiten behandelt, die mit der Verwendung einer auf einer Seite mit der Seite "eine Reihe von Dashboardseite" beginnen.</span><span class="sxs-lookup"><span data-stu-id="32222-139">We'll address using nested master pages with two (or more) master pages starting with "Using a Nested Master Page for the Administration Section" later in this tutorial.</span></span>

<span data-ttu-id="32222-140">Stellen Sie sich vor, dass wir das Layout der Verwaltungs Seiten angepasst haben, um zusätzliche Informationen oder Links zu enthalten, die andernfalls nicht auf anderen Seiten der Website vorhanden wären.</span><span class="sxs-lookup"><span data-stu-id="32222-140">Imagine that we were asked to customize the layout of the Administration pages to include additional information or links that would not otherwise be present in other pages in the site.</span></span> <span data-ttu-id="32222-141">Es gibt vier Techniken, um diese Anforderung zu implementieren:</span><span class="sxs-lookup"><span data-stu-id="32222-141">There are four techniques to implement this requirement:</span></span>

1. <span data-ttu-id="32222-142">Fügen Sie die Verwaltungs spezifischen Informationen und Verknüpfungen zu jeder Inhaltsseite im Ordner "`~/Admin`" manuell hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-142">Manually add the Administration-specific information and links to every content page in the `~/Admin` folder.</span></span>
2. <span data-ttu-id="32222-143">Aktualisieren Sie die Seite `Site.master` Master, sodass Sie die Verwaltungs Abschnitts spezifischen Informationen und Links enthält, und fügen Sie dann der Master Seite Code hinzu, um diese Abschnitte basierend darauf anzuzeigen oder auszublenden, ob eine der Verwaltungs Seiten besucht wird.</span><span class="sxs-lookup"><span data-stu-id="32222-143">Update the `Site.master` master page to include the Administration section-specific information and links, and then add code to the master page to show or hide these sections based on whether one of the Administration pages is being visited.</span></span>
3. <span data-ttu-id="32222-144">Erstellen Sie eine neue Master Seite speziell für den Abschnitt Verwaltung, kopieren Sie das Markup aus `Site.master`, fügen Sie die Verwaltungs Abschnitts spezifischen Informationen und Verknüpfungen hinzu, und aktualisieren Sie dann die Inhaltsseiten im Ordner `~/Admin`, damit diese neue Master Seite verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="32222-144">Create a new master page specifically for the Administration section, copy over the markup from `Site.master`, add the Administration section-specific information and links, and then update the content pages in the `~/Admin` folder to use this new master page.</span></span>
4. <span data-ttu-id="32222-145">Erstellen Sie eine auf der Seite mit der Seite für die Verbindung an `Site.master` und die Inhaltsseiten im Ordner "`~/Admin`" diese neue, auf der Seite verwendete Master Seite.</span><span class="sxs-lookup"><span data-stu-id="32222-145">Create a nested master page that binds to `Site.master` and have the content pages in the `~/Admin` folder use this new nested master page.</span></span> <span data-ttu-id="32222-146">Diese vordefinierte Master Seite enthält nur die zusätzlichen Informationen und Verknüpfungen, die spezifisch für die Verwaltungs Seiten sind. Sie müssen das bereits in `Site.master`definierte Markup nicht wiederholen.</span><span class="sxs-lookup"><span data-stu-id="32222-146">This nested master page would include just the additional information and links specific to the Administration pages and would not need to repeat the markup already defined in `Site.master`.</span></span>

<span data-ttu-id="32222-147">Die erste Option ist die am wenigsten schmackbare.</span><span class="sxs-lookup"><span data-stu-id="32222-147">The first option is the least palatable.</span></span> <span data-ttu-id="32222-148">Der Hauptpunkt der Verwendung von Masterseiten besteht darin, das manuelle Kopieren und Einfügen von allgemeinen Markup Daten auf neue ASP.NET Seiten zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="32222-148">The whole point of using master pages is to move away from having to manually copy and paste common markup to new ASP.NET pages.</span></span> <span data-ttu-id="32222-149">Die zweite Option ist akzeptabel, bewirkt aber, dass die Anwendung weniger wartungsfähig ist, da Sie die Masterseiten mit Markup aufführt, das nur gelegentlich angezeigt wird, und dass Entwickler die Master Seite bearbeiten müssen, um dieses Markup zu umgehen. genau, wird ein bestimmtes Markup angezeigt, wenn es ausgeblendet ist.</span><span class="sxs-lookup"><span data-stu-id="32222-149">The second option is acceptable, but makes the application less maintainable as it bulks up the master pages with markup that is only occasionally displayed and requires developers editing the master page to work around this markup and to have to remember when, exactly, certain markup is displayed versus when it is hidden.</span></span> <span data-ttu-id="32222-150">Diese Vorgehensweise ist weniger anpassbar als Anpassungen von mehr und mehr Webseiten, die von dieser einzelnen Master Seite untergebracht werden müssen.</span><span class="sxs-lookup"><span data-stu-id="32222-150">This approach would be less tenable as customizations from more and more types of web pages needed to be accommodated by this single master page.</span></span>

<span data-ttu-id="32222-151">Mit der dritten Option werden die Übersichtlichkeit und die Komplexitäts Probleme mit der zweiten Option entfernt.</span><span class="sxs-lookup"><span data-stu-id="32222-151">The third option removes the clutter and complexity issues the surfaced with the second option.</span></span> <span data-ttu-id="32222-152">Der Hauptnachteil von Option 3 besteht jedoch darin, dass es erforderlich ist, das gemeinsame Layout von `Site.master` in die neue Verwaltungs Abschnitts spezifische Master Seite zu kopieren und einzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-152">However, option three's main drawback is that it requires us to copy and paste the common layout from `Site.master` to the new Administration section-specific master page.</span></span> <span data-ttu-id="32222-153">Wenn Sie sich später entscheiden, das standortweite Layout zu ändern, müssen Sie daran denken, es an zwei Stellen zu ändern.</span><span class="sxs-lookup"><span data-stu-id="32222-153">If we later decide to change the site-wide layout we have to remember to change it in two places.</span></span>

<span data-ttu-id="32222-154">Mit der vierten Option, den Geviert enden Seiten, können wir das Beste aus den zweiten und dritten Optionen machen.</span><span class="sxs-lookup"><span data-stu-id="32222-154">The fourth option, nested master pages, give us the best of the second and third options.</span></span> <span data-ttu-id="32222-155">Die Standort weiten Layoutinformationen werden in einer Datei verwaltet: der Master Seite auf oberster Ebene, während der für bestimmte Regionen spezifische Inhalt in verschiedene Dateien aufgeteilt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-155">The site-wide layout information is maintained in one file - the top-level master page - while the content specific to particular regions is separated out into different files.</span></span>

<span data-ttu-id="32222-156">Dieses Tutorial beginnt mit einem Blick auf das Erstellen und Verwenden einer einfachen, auf einer Seite eingefügten Master Seite.</span><span class="sxs-lookup"><span data-stu-id="32222-156">This tutorial starts with a look at creating and using a simple nested master page.</span></span> <span data-ttu-id="32222-157">Wir erstellen eine neue, neue Master Seite auf oberster Ebene, zwei auf der Seite vorgenannte Masterseiten und zwei Inhaltsseiten.</span><span class="sxs-lookup"><span data-stu-id="32222-157">We create a brand new top-level master page, two nested master pages, and two content pages.</span></span> <span data-ttu-id="32222-158">Beginnend mit der Seite "using a netsted Master page for the Administration Section" (über eine Seite mit einer Liste der Dashboardseite für den Verwaltungsabschnitt) wird beschrieben, wie Sie die vorhandene Masterseiten Architektur aktualisieren, um</span><span class="sxs-lookup"><span data-stu-id="32222-158">Starting with "Using a Nested Master Page for the Administration Section," we look at updating our existing master page architecture to include the use of nested master pages.</span></span> <span data-ttu-id="32222-159">Insbesondere erstellen wir eine Seite für eine Seite mit einer Liste und verwenden diese, um zusätzliche benutzerdefinierte Inhalte für die Inhaltsseiten im Ordner "`~/Admin`" einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="32222-159">Specifically, we create a nested master page and use it to include additional custom content for the content pages in the `~/Admin` folder.</span></span>

## <a name="step-1-creating-a-simple-top-level-master-page"></a><span data-ttu-id="32222-160">Schritt 1: Erstellen einer einfachen Master Seite auf oberster Ebene</span><span class="sxs-lookup"><span data-stu-id="32222-160">Step 1: Creating a Simple Top-Level Master Page</span></span>

<span data-ttu-id="32222-161">Wenn Sie einen auf einer der vorhandenen Masterseiten basierenden, auf einer der obersten Ebene verwendeten Masterseiten erstellen und dann eine vorhandene Inhaltsseite aktualisieren, um diese neue, nicht für die Master Seite der obersten Ebene zu verwenden, wird eine gewisse Komplexität verursacht, da die vorhandenen Inhaltsseiten bereits einen bestimmten Wert erwarten. Contentplachalter-Steuerelemente, die auf der Master Seite der obersten Ebene definiert sind.</span><span class="sxs-lookup"><span data-stu-id="32222-161">Creating a nested master based on one of the existing master pages and then updating an existing content page to use this new nested master page instead of the top-level master page entails some complexity because the existing content pages already expect certain ContentPlaceHolder controls defined in the top-level master page.</span></span> <span data-ttu-id="32222-162">Aus diesem Grund muss die Seite für die untergeordneten Master Seite auch dieselben contentplachalter-Steuerelemente mit denselben Namen enthalten.</span><span class="sxs-lookup"><span data-stu-id="32222-162">Therefore, the nested master page must also include the same ContentPlaceHolder controls with the same names.</span></span> <span data-ttu-id="32222-163">Außerdem verfügt unsere besondere Demoanwendung über Zweimaster Seiten (`Site.master` und `Alternate.master`), die einer Inhaltsseite basierend auf den Einstellungen eines Benutzers dynamisch zugewiesen werden, was diese Komplexität weiter erhöht.</span><span class="sxs-lookup"><span data-stu-id="32222-163">Furthermore, our particular demo application has two master pages (`Site.master` and `Alternate.master`) that are dynamically assigned to a content page based on a user's preferences, which further adds to this complexity.</span></span> <span data-ttu-id="32222-164">Wir sehen uns nun an, wie Sie die vorhandene Anwendung für die Verwendung von untergeordneten Masterseiten später in diesem Tutorial aktualisieren, aber wir konzentrieren uns zunächst auf ein einfaches Beispiel für ein Beispiel für eine Beispiel-Master Seite.</span><span class="sxs-lookup"><span data-stu-id="32222-164">We will look at updating the existing application to use nested master pages later in this tutorial, but let's first focus on a simple nested master pages example.</span></span>

<span data-ttu-id="32222-165">Erstellen Sie einen neuen Ordner mit dem Namen `NestedMasterPages`, und fügen Sie diesem Ordner mit dem Namen `Simple.master`eine neue Masterseiten Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-165">Create a new folder named `NestedMasterPages` and then add a new master page file to that folder named `Simple.master`.</span></span> <span data-ttu-id="32222-166">(In Abbildung 1 finden Sie einen Screenshot der Projektmappen-Explorer, nachdem dieser Ordner und die Datei hinzugefügt wurden.) Ziehen Sie die `AlternateStyles.css` Stylesheet-Datei aus dem Projektmappen-Explorer auf den Designer.</span><span class="sxs-lookup"><span data-stu-id="32222-166">(See Figure 1 for a screen shot of the Solution Explorer after this folder and file have been added.) Drag the `AlternateStyles.css` style sheet file from the Solution Explorer onto the Designer.</span></span> <span data-ttu-id="32222-167">Dadurch wird der Stylesheet-Datei im `<head>`-Element ein `<link>` Element hinzugefügt. Anschließend sollte das Markup der `<head>` Elemente der Master Seite wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="32222-167">This adds a `<link>` element to the style sheet file in the `<head>` element, after which the master page's `<head>` element's markup should look like:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample1.aspx)]

<span data-ttu-id="32222-168">Fügen Sie als nächstes das folgende Markup im Webformular `Simple.master`hinzu:</span><span class="sxs-lookup"><span data-stu-id="32222-168">Next, add the following markup within the Web Form of `Simple.master`:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="32222-169">Dieses Markup zeigt einen Link mit dem Titel "verknüpfte Master Seiten (Simple)" am oberen Rand der Seite in einer großen weißen Schriftart in einem Navy-Hintergrund an.</span><span class="sxs-lookup"><span data-stu-id="32222-169">This markup displays a link titled "Nested Master Pages (Simple)" at the top of the page in a large white font on a navy background.</span></span> <span data-ttu-id="32222-170">Unterhalb dieses-`MainContent` contentplachalter.</span><span class="sxs-lookup"><span data-stu-id="32222-170">Beneath that is the `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="32222-171">Abbildung 1 zeigt die `Simple.master` Master Seite, wenn Sie im Visual Studio-Designer geladen wird.</span><span class="sxs-lookup"><span data-stu-id="32222-171">Figure 1 shows the `Simple.master` master page when loaded in the Visual Studio Designer.</span></span>

<span data-ttu-id="32222-172">[![die Seite "auf der Seite" auf der Seite "Seite" definiert Inhalte definiert, die für die Seiten im](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="32222-172">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image2.png)](nested-master-pages-vb/_static/image1.png)</span></span>

<span data-ttu-id="32222-173">**Abbildung 01**: die Seite "vordefiniert" definiert Inhalte, die für die Seiten im Abschnitt "Verwaltung" spezifisch sind ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="32222-173">**Figure 01**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image3.png))</span></span>

## <a name="step-2-creating-a-simple-nested-master-page"></a><span data-ttu-id="32222-174">Schritt 2: Erstellen einer einfachen, auf einer Seite eingefügten Master Seite</span><span class="sxs-lookup"><span data-stu-id="32222-174">Step 2: Creating a Simple Nested Master Page</span></span>

<span data-ttu-id="32222-175">`Simple.master` enthält zwei contentplachalter-Steuerelemente: den `MainContent` contentplachalter, den wir innerhalb des Webformulars hinzugefügt haben, zusammen mit dem `head` contentplachalter im `<head>` Element.</span><span class="sxs-lookup"><span data-stu-id="32222-175">`Simple.master` contains two ContentPlaceHolder controls: the `MainContent` ContentPlaceHolder we added within the Web Form along with the `head` ContentPlaceHolder in the `<head>` element.</span></span> <span data-ttu-id="32222-176">Wenn eine Inhaltsseite erstellt und an `Simple.master` gebunden werden soll, würde die Inhaltsseite zwei Inhalts Steuerelemente enthalten, die auf die beiden Content-Platzhalter verweisen.</span><span class="sxs-lookup"><span data-stu-id="32222-176">If we were to create a content page and bind it to `Simple.master` the content page would have two Content controls referencing the two ContentPlaceHolders.</span></span> <span data-ttu-id="32222-177">Ebenso gilt, wenn wir eine Seite mit einer auf einer Seite erstellten Master Seite erstellen und diese an `Simple.master` binden.</span><span class="sxs-lookup"><span data-stu-id="32222-177">Similarly, if we create a nested master page and bind it to `Simple.master` then the nested master page will have two Content controls.</span></span>

<span data-ttu-id="32222-178">Fügen wir dem Ordner "`NestedMasterPages`" eine neue Seite mit dem Namen "`SimpleNested.master`" hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-178">Let's add a new nested master page to the `NestedMasterPages` folder named `SimpleNested.master`.</span></span> <span data-ttu-id="32222-179">Klicken Sie mit der rechten Maustaste auf den Ordner `NestedMasterPages`, und wählen Sie neues Element hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-179">Right-click on the `NestedMasterPages` folder and choose Add New Item.</span></span> <span data-ttu-id="32222-180">Dadurch wird das Dialogfeld Neues Element hinzufügen in Abbildung 2 angezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-180">This brings up the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="32222-181">Wählen Sie den Vorlagentyp der Master Seite aus, und geben Sie den Namen der neuen Master Seite ein.</span><span class="sxs-lookup"><span data-stu-id="32222-181">Select the Master Page template type and type in the name of the new master page.</span></span> <span data-ttu-id="32222-182">Aktivieren Sie das Kontrollkästchen "Master Seite auswählen", um anzugeben, dass es sich bei der neuen Master Seite um eine Seite mit der Master Seite handelt.</span><span class="sxs-lookup"><span data-stu-id="32222-182">To indicate that the new master page should be a nested master page, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="32222-183">Klicken Sie anschließend auf die Schaltfläche hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-183">Next, click the Add button.</span></span> <span data-ttu-id="32222-184">Dadurch wird das gleiche Dialogfeld "Master Seite auswählen" angezeigt, das beim Binden einer Inhaltsseite an eine Master Seite angezeigt wird (siehe Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="32222-184">This will display the same Select a Master Page dialog box you see when binding a content page to a master page (see Figure 3).</span></span> <span data-ttu-id="32222-185">Wählen Sie im Ordner `NestedMasterPages` die `Simple.master` Master Seite aus, und klicken Sie auf OK.</span><span class="sxs-lookup"><span data-stu-id="32222-185">Choose the `Simple.master` master page in the `NestedMasterPages` folder and click OK.</span></span>

> [!NOTE]
> <span data-ttu-id="32222-186">Wenn Sie Ihre ASP.NET-Website mit dem Webanwendungs Projekt Modell anstelle des Website Projekt Modells erstellt haben, wird im Dialogfeld Neues Element hinzufügen in Abbildung 2 das Kontrollkästchen "Master Seite auswählen" nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-186">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="32222-187">Wenn Sie bei Verwendung des Webanwendungs Projekt Modells eine Seite mit einer untergeordneten Master Seite erstellen möchten, müssen Sie die Vorlage für die Vorlage für die Vorlage für die Vorlage (anstelle der Vorlage für die Master Seite</span><span class="sxs-lookup"><span data-stu-id="32222-187">To create a nested master page when using the Web Application Project model you must choose the Nested Master Page template (instead of the Master Page template).</span></span> <span data-ttu-id="32222-188">Nachdem Sie die Vorlage für die Vorlage für die Vorlage und das Klicken auf hinzufügen ausgewählt haben, wird das gleiche in Abbildung 3 dargestellte Dialogfeld "Master Seite auswählen" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-188">After selecting the Nested Master Page template and clicking Add, the same Select a Master Page dialog box shown in Figure 3 will appear.</span></span>

<span data-ttu-id="32222-189">[![aktivieren Sie das Kontrollkästchen &quot;Master Seite auswählen&quot;, um eine Liste der untergeordneten Masterseiten hinzuzufügen.](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="32222-189">[![Check the &quot;Select master page&quot; Checkbox to Add a Nested Master Page](nested-master-pages-vb/_static/image5.png)](nested-master-pages-vb/_static/image4.png)</span></span>

<span data-ttu-id="32222-190">**Abbildung 02**: Aktivieren Sie das Kontrollkästchen "Master Seite auswählen", um eine voreingesterte Master Seite hinzuzufügen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image6.png)).</span><span class="sxs-lookup"><span data-stu-id="32222-190">**Figure 02**: Check the "Select master page" Checkbox to Add a Nested Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image6.png))</span></span>

<span data-ttu-id="32222-191">[Binden Sie die Seite für die Seite "" auf der Seite "Simple. Master" ![.](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="32222-191">[![Bind the Nested Master Page to the Simple.master Master Page](nested-master-pages-vb/_static/image8.png)](nested-master-pages-vb/_static/image7.png)</span></span>

<span data-ttu-id="32222-192">**Abbildung 03**: Binden der Seite für die vorgebundene Master Seite an die `Simple.master` Master Seite ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="32222-192">**Figure 03**: Bind the Nested Master Page to the `Simple.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image9.png))</span></span>

<span data-ttu-id="32222-193">Das deklarative Markup der der dargestellten Master Seite, wie unten gezeigt, enthält zwei Inhalts Steuerelemente, die auf die beiden contentplachalter-Steuerelemente der obersten Ebene verweisen.</span><span class="sxs-lookup"><span data-stu-id="32222-193">The nested master page's declarative markup, shown below, contains two Content controls referencing the top-level master page's two ContentPlaceHolder controls.</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="32222-194">Mit Ausnahme der `<%@ Master %>`-Direktive ist das anfängliche deklarative Markup der gemasterten Master Seite mit dem Markup identisch, das anfänglich generiert wird, wenn eine Inhaltsseite an dieselbe Master Seite auf oberster Ebene gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="32222-194">Except for the `<%@ Master %>` directive, the nested master page's initial declarative markup is identical to the markup that is initially generated when binding a content page to the same top-level master page.</span></span> <span data-ttu-id="32222-195">Wie die `<%@ Page %>`-Direktive einer Inhaltsseite enthält die `<%@ Master %>`-Direktive hier ein `MasterPageFile`-Attribut, das die übergeordnete Master Seite der Seite der Seite angibt.</span><span class="sxs-lookup"><span data-stu-id="32222-195">Like a content page's `<%@ Page %>` directive, the `<%@ Master %>` directive here includes a `MasterPageFile` attribute that specifies the nested master page's parent master page.</span></span> <span data-ttu-id="32222-196">Der Hauptunterschied zwischen der Seite für die untergeordneten Master Seite und einer Inhaltsseite, die an dieselbe Master Seite auf oberster Ebene gebunden ist, besteht darin, dass die Seite für die vorgebundene Master Seite contentplac-Steuerelemente enthalten kann</span><span class="sxs-lookup"><span data-stu-id="32222-196">The main difference between the nested master page and a content page bound to the same top-level master page is that the nested master page can include ContentPlaceHolder controls.</span></span> <span data-ttu-id="32222-197">Die contentplachalter-Steuerelemente der untergeordneten Seite definieren die Bereiche, in denen die Inhaltsseiten das Markup anpassen können.</span><span class="sxs-lookup"><span data-stu-id="32222-197">The nested master page's ContentPlaceHolder controls define the regions where the content pages can customize the markup.</span></span>

<span data-ttu-id="32222-198">Aktualisieren Sie diese geschachtelte Master Seite, sodass Sie den Text "Hello, from simplentzig!" anzeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-198">Update this nested master page so that it displays the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="32222-199">im Inhalts Steuerelement, das dem `MainContent` contentplachalter-Steuerelement entspricht.</span><span class="sxs-lookup"><span data-stu-id="32222-199">in the Content control that corresponds to the `MainContent` ContentPlaceHolder control.</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample4.aspx)]

<span data-ttu-id="32222-200">Nachdem Sie dieses Add-in hinzugefügt haben, speichern Sie die Seite für die vorgebundene Master Seite, und fügen Sie dann eine neue Inhaltsseite zum Ordner "`NestedMasterPages`" mit `SimpleNested.master` dem Namen `Default.aspx`hinzu</span><span class="sxs-lookup"><span data-stu-id="32222-200">After making this addition, save the nested master page and then add a new content page to the `NestedMasterPages` folder named `Default.aspx`, and bind it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="32222-201">Wenn Sie diese Seite hinzufügen, sind Sie möglicherweise überrascht, dass Sie keine Inhalts Steuerelemente enthält (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="32222-201">Upon adding this page you may be surprised to see that it contains no Content controls (see Figure 4)!</span></span> <span data-ttu-id="32222-202">Auf einer Inhaltsseite kann nur auf die contentplatzhalter der über *geordneten* Master Seite zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="32222-202">A content page can only access its *parent* master page's ContentPlaceHolders.</span></span> <span data-ttu-id="32222-203">`SimpleNested.master` enthält keine contentplachalter-Steuerelemente. Daher können alle an diese Master Seite gebundenen Inhaltsseiten keine Inhalts Steuerelemente enthalten.</span><span class="sxs-lookup"><span data-stu-id="32222-203">`SimpleNested.master` does not contain any ContentPlaceHolder controls; therefore, any content page bound to this master page cannot contain any Content controls.</span></span>

<span data-ttu-id="32222-204">[![die neue Inhaltsseite keine Inhalts Steuerelemente enthält.](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="32222-204">[![The New Content Page Contains No Content Controls](nested-master-pages-vb/_static/image11.png)](nested-master-pages-vb/_static/image10.png)</span></span>

<span data-ttu-id="32222-205">**Abbildung 04**: die neue Inhaltsseite enthält keine Inhalts Steuerelemente ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="32222-205">**Figure 04**: The New Content Page Contains No Content Controls ([Click to view full-size image](nested-master-pages-vb/_static/image12.png))</span></span>

<span data-ttu-id="32222-206">Zu diesem Zweck müssen Sie die Seite für die untergeordneten Master Seite (`SimpleNested.master`) aktualisieren, um contentplachalter-Steuerelemente einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="32222-206">What we need to do is update the nested master page (`SimpleNested.master`) to include ContentPlaceHolder controls.</span></span> <span data-ttu-id="32222-207">In der Regel möchten Sie, dass ihre untergeordneten Masterseiten für jeden contentplachalter, der durch die übergeordnete Master Seite definiert ist, einen contentplachalter enthalten. Dadurch kann die untergeordnete Master Seite oder Inhaltsseite mit jedem der Inhalts Platzhalter der obersten Ebene der Master Seite verwendet werden. Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="32222-207">Typically you'll want your nested master pages to include a ContentPlaceHolder for each ContentPlaceHolder defined by its parent master page, thereby allowing its child master page or content page to work with any of the top-level master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="32222-208">Aktualisieren Sie die `SimpleNested.master` Master Seite, um einen contentplachalter in den beiden Inhalts Steuerelementen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-208">Update the `SimpleNested.master` master page to include a ContentPlaceHolder in its two Content controls.</span></span> <span data-ttu-id="32222-209">Erteilen Sie dem contentplachalter-Steuerelement denselben Namen wie das contentplachalter-Steuerelement, auf das sich das Inhalts Steuerelement bezieht.</span><span class="sxs-lookup"><span data-stu-id="32222-209">Give the ContentPlaceHolder controls the same name as the ContentPlaceHolder control their Content control refers to.</span></span> <span data-ttu-id="32222-210">Fügen Sie dem Content-Steuerelement in `SimpleNested.master`, das auf den `MainContent` contentplachalter in `Simple.master`verweist, ein contentplachalter-Steuerelement mit dem Namen `MainContent` hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-210">That is, add a ContentPlaceHolder control named `MainContent` to the Content control in `SimpleNested.master` that references the `MainContent` ContentPlaceHolder in `Simple.master`.</span></span> <span data-ttu-id="32222-211">Gehen Sie im Inhalts Steuerelement, das auf die `head` contentplachalter verweist, genauso vor.</span><span class="sxs-lookup"><span data-stu-id="32222-211">Do the same thing in the Content control that references the `head` ContentPlaceHolder.</span></span>

> [!NOTE]
> <span data-ttu-id="32222-212">Es empfiehlt sich, die contentplachalter-Steuerelemente auf der Seite für die untergeordneten Master Seite genauso zu benennen wie die contentplatzhalter auf der Master Seite der obersten Ebene. diese Benennungs Symmetrie ist jedoch nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="32222-212">While I recommend naming the ContentPlaceHolder controls in the nested master page the same as the ContentPlaceHolders in the top-level master page, this naming symmetry is not required.</span></span> <span data-ttu-id="32222-213">Sie können die contentplachalter-Steuerelemente auf der Seite für die untergeordneten Elemente beliebig benennen.</span><span class="sxs-lookup"><span data-stu-id="32222-213">You can give the ContentPlaceHolder controls in your nested master page any name you like.</span></span> <span data-ttu-id="32222-214">Es ist jedoch leichter zu merken, welche Content-Platzhalter welchen Bereichen der Seite entsprechen, wenn meine Master Seite auf oberster Ebene und die untergeordneten Masterseiten dieselben Namen verwenden.</span><span class="sxs-lookup"><span data-stu-id="32222-214">However, I find it easier to remember what ContentPlaceHolders correspond with what regions of the page if my top-level master page and nested master pages use the same names.</span></span>

<span data-ttu-id="32222-215">Nachdem Sie diese Ergänzungen vorgenommen haben, sollte das deklarative Markup der `SimpleNested.master` Master Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="32222-215">After making these additions your `SimpleNested.master` master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="32222-216">Löschen Sie die Seite `Default.aspx` Inhalt, die wir soeben erstellt haben, und fügen Sie Sie erneut hinzu, um Sie an die `SimpleNested.master` Master Seite zu binden.</span><span class="sxs-lookup"><span data-stu-id="32222-216">Delete the `Default.aspx` content page we just created and then re-add it, binding it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="32222-217">Dieses Mal fügt Visual Studio dem `Default.aspx`zwei Inhalts Steuerelemente hinzu, die auf die in `SimpleNested.master` definierten contentplatzhalter verweisen (siehe Abbildung 6).</span><span class="sxs-lookup"><span data-stu-id="32222-217">This time Visual Studio adds two Content controls to the `Default.aspx`, referencing the ContentPlaceHolders now defined in `SimpleNested.master` (see Figure 6).</span></span> <span data-ttu-id="32222-218">Fügen Sie den Text "Hello, from default. aspx!" hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-218">Add the text, "Hello, from Default.aspx!"</span></span> <span data-ttu-id="32222-219">im Inhalts Steuerelement, auf das `MainContent`verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="32222-219">in the Content control that referenced `MainContent`.</span></span>

<span data-ttu-id="32222-220">Abbildung 5 zeigt die hier beteiligten drei Entitäten-`Simple.master`, `SimpleNested.master`und `Default.aspx` und die Beziehung zueinander.</span><span class="sxs-lookup"><span data-stu-id="32222-220">Figure 5 shows the three entities involved here - `Simple.master`, `SimpleNested.master`, and `Default.aspx` - and how they relate to one another.</span></span> <span data-ttu-id="32222-221">Wie das Diagramm zeigt, implementiert die Seite für die untergeordnete Master Seite Inhalts Steuerelemente für den contentplachalter ihres übergeordneten Elements.</span><span class="sxs-lookup"><span data-stu-id="32222-221">As the diagram shows, the nested master page implements Content controls for its parent's ContentPlaceHolder.</span></span> <span data-ttu-id="32222-222">Wenn auf diese Regionen für die Inhaltsseite zugegriffen werden muss, muss die Seite "auf der Seite" der Seite "" der Inhalts Steuerung eigene Content-Platzhalter hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-222">If these regions need to be accessible to the content page, the nested master page must add its own ContentPlaceHolders to the Content controls.</span></span>

<span data-ttu-id="32222-223">[das Layout der Inhaltsseite wird ![auf der obersten Ebene und in der Liste der übergeordneten Master Seiten vorgegeben.](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="32222-223">[![The Top-Level and Nested Master Pages Dictate the Content Page's Layout](nested-master-pages-vb/_static/image14.png)](nested-master-pages-vb/_static/image13.png)</span></span>

<span data-ttu-id="32222-224">**Abbildung 05**: das Layout der Inhaltsseite wird auf der obersten Ebene und in der Liste der übergeordneten Master Seiten vorgegeben ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="32222-224">**Figure 05**: The Top-Level and Nested Master Pages Dictate the Content Page's Layout ([Click to view full-size image](nested-master-pages-vb/_static/image15.png))</span></span>

<span data-ttu-id="32222-225">Dieses Verhalten veranschaulicht, wie eine Inhaltsseite oder eine Master Seite nur von der übergeordneten Master Seite erkannt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-225">This behavior illustrates how a content page or master page is only cognizant of its parent master page.</span></span> <span data-ttu-id="32222-226">Dieses Verhalten wird auch durch den Visual Studio-Designer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-226">This behavior is also indicated by the Visual Studio Designer.</span></span> <span data-ttu-id="32222-227">Abbildung 6 zeigt den Designer für `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="32222-227">Figure 6 shows the Designer for `Default.aspx`.</span></span> <span data-ttu-id="32222-228">Während der Designer eindeutig anzeigt, welche Bereiche von der Inhaltsseite bearbeitet werden können und welche Teile nicht sind, wird nicht unterschieden, welche nicht bearbeitbaren Bereiche von der gisted Master Seite stammen und welche Regionen von der Master Seite auf oberster Ebene stammen.</span><span class="sxs-lookup"><span data-stu-id="32222-228">While the Designer clearly shows what regions are editable from the content page and what portions aren't, it doesn't disambiguate what non-editable regions are from the nested master page and what regions are from the top-level master page.</span></span>

<span data-ttu-id="32222-229">[![die Inhaltsseite nun Inhalts Steuerelemente für die Content-Platzhalter der auf der Seite der nsted Master Seite enthält](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="32222-229">[![The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders](nested-master-pages-vb/_static/image17.png)](nested-master-pages-vb/_static/image16.png)</span></span>

<span data-ttu-id="32222-230">**Abbildung 06**: auf der Inhaltsseite sind nun Inhalts Steuerelemente für die contentplatzhalter der Seite der Hauptseite enthalten ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="32222-230">**Figure 06**: The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders ([Click to view full-size image](nested-master-pages-vb/_static/image18.png))</span></span>

## <a name="step-3-adding-a-second-simple-nested-master-page"></a><span data-ttu-id="32222-231">Schritt 3: Hinzufügen einer zweiten einfachen, auf der Seite eingefügten Seite</span><span class="sxs-lookup"><span data-stu-id="32222-231">Step 3: Adding a Second Simple Nested Master Page</span></span>

<span data-ttu-id="32222-232">Der Vorteil von untergeordneten Masterseiten ist deutlicher, wenn es mehrere unterschiedliche Masterseiten gibt.</span><span class="sxs-lookup"><span data-stu-id="32222-232">The benefit of nested master pages is more evident when there are multiple nested master pages.</span></span> <span data-ttu-id="32222-233">Um diesen Vorteil zu veranschaulichen, erstellen Sie im Ordner "`NestedMasterPages`" eine weitere Seite mit einer anderen Seite. Benennen Sie diese neue, `SimpleNestedAlternate.master` Seite, und binden Sie Sie an die `Simple.master` Master Seite.</span><span class="sxs-lookup"><span data-stu-id="32222-233">To illustrate this benefit, create another nested master page in the `NestedMasterPages` folder; name this new nested master page `SimpleNestedAlternate.master` and bind it to the `Simple.master` master page.</span></span> <span data-ttu-id="32222-234">Fügen Sie die contentplachalter-Steuerelemente in den zwei Inhalts Steuerelementen der nten Master Seite hinzu, wie in Schritt 2 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-234">Add ContentPlaceHolder controls in the nested master page's two Content controls like we did in Step 2.</span></span> <span data-ttu-id="32222-235">Fügen Sie außerdem den Text "Hello, from simplenestedalternate!" hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-235">Also add the text, "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="32222-236">im Inhalts Steuerelement, das der `MainContent` contentplachalter der obersten Ebene der Master Seite entspricht.</span><span class="sxs-lookup"><span data-stu-id="32222-236">in the Content control that corresponds to the top-level master page's `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="32222-237">Nachdem Sie diese Änderungen vorgenommen haben, sollte das deklarative Markup der neuen Seite der neuen Master Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="32222-237">After making these changes your new nested master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample6.aspx)]

<span data-ttu-id="32222-238">Erstellen Sie im Ordner "`NestedMasterPages`" eine Inhaltsseite mit dem Namen `Alternate.aspx`, und binden Sie Sie an die `SimpleNestedAlternate.master` die Seite "Master".</span><span class="sxs-lookup"><span data-stu-id="32222-238">Create a content page named `Alternate.aspx` in the `NestedMasterPages` folder and bind it to the `SimpleNestedAlternate.master` nested master page.</span></span> <span data-ttu-id="32222-239">Fügen Sie den Text "Hello, from Alternate!" hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-239">Add the text, "Hello, from Alternate!"</span></span> <span data-ttu-id="32222-240">im Inhalts Steuerelement, das `MainContent`entspricht.</span><span class="sxs-lookup"><span data-stu-id="32222-240">in the Content control that corresponds to `MainContent`.</span></span> <span data-ttu-id="32222-241">Abbildung 7 zeigt `Alternate.aspx`, wenn Sie im Visual Studio-Designer angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="32222-241">Figure 7 shows `Alternate.aspx` when viewed through the Visual Studio Designer.</span></span>

<span data-ttu-id="32222-242">[![Alternate. aspx ist an die "simplenestedalternate. Master"-Master Seite gebunden.](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="32222-242">[![Alternate.aspx is Bound to the SimpleNestedAlternate.master Master Page](nested-master-pages-vb/_static/image20.png)](nested-master-pages-vb/_static/image19.png)</span></span>

<span data-ttu-id="32222-243">**Abbildung 07**: `Alternate.aspx` ist an die `SimpleNestedAlternate.master` Master Seite gebunden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="32222-243">**Figure 07**: `Alternate.aspx` is Bound to the `SimpleNestedAlternate.master` Master Page ([Click to view full-size image](nested-master-pages-vb/_static/image21.png))</span></span>

<span data-ttu-id="32222-244">Vergleichen Sie den Designer in Abbildung 7 mit dem Designer in Abbildung 6.</span><span class="sxs-lookup"><span data-stu-id="32222-244">Compare the Designer in Figure 7 to the Designer in Figure 6.</span></span> <span data-ttu-id="32222-245">Beide Inhaltsseiten verwenden dasselbe Layout, das auf der Master Seite der obersten Ebene (`Simple.master`) definiert ist, nämlich den Titel "eingefügter Lernprogramm für Masterseiten (Simple)".</span><span class="sxs-lookup"><span data-stu-id="32222-245">Both content pages share the same layout defined in the top-level master page (`Simple.master`), namely the "Nested Master Pages Tutorial (Simple)" title.</span></span> <span data-ttu-id="32222-246">In den übergeordneten Masterseiten haben beide jedoch unterschiedliche Inhalte definiert: der Text "Hello, from simplentzig!"</span><span class="sxs-lookup"><span data-stu-id="32222-246">Yet both have distinct content defined in their parent master pages - the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="32222-247">in Abbildung 6 und "Hello, from simplenestedalternate!"</span><span class="sxs-lookup"><span data-stu-id="32222-247">in Figure 6 and "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="32222-248">in Abbildung 7.</span><span class="sxs-lookup"><span data-stu-id="32222-248">in Figure 7.</span></span> <span data-ttu-id="32222-249">Diese Unterschiede sind in diesem Beispiel trivial, aber Sie können dieses Beispiel erweitern, um aussagekräftigere Unterschiede zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="32222-249">Granted, these differences here are trivial, but you could extend this example to include more meaningful differences.</span></span> <span data-ttu-id="32222-250">Beispielsweise kann die Seite `SimpleNested.master` ein Menü mit spezifischen Optionen für Ihre Inhaltsseiten enthalten, während `SimpleNestedAlternate.master` möglicherweise Informationen zu den Inhaltsseiten enthält, die an Sie gebunden sind.</span><span class="sxs-lookup"><span data-stu-id="32222-250">For instance, the `SimpleNested.master` page might include a menu with options specific to its content pages, whereas `SimpleNestedAlternate.master` might have information pertinent to the content pages that bind to it.</span></span>

<span data-ttu-id="32222-251">Stellen Sie sich nun vor, dass wir eine Änderung an dem übergeordneten Site Layout vornehmen müssen.</span><span class="sxs-lookup"><span data-stu-id="32222-251">Now, imagine that we needed to make a change to the overarching site layout.</span></span> <span data-ttu-id="32222-252">Angenommen, Sie möchten eine Liste gemeinsamer Links zu allen Inhaltsseiten hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-252">For example, imagine that we wanted to add a list of common links to all content pages.</span></span> <span data-ttu-id="32222-253">Um dies zu erreichen, aktualisieren wir die Master Seite auf oberster Ebene, `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="32222-253">To accomplish this we update the top-level master page, `Simple.master`.</span></span> <span data-ttu-id="32222-254">Alle Änderungen, die in den gespiegelten Masterseiten und durch Erweiterung ihrer Inhaltsseiten sofort wiedergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="32222-254">Any changes there are immediately reflected in its nested master pages and, by extension, their content pages.</span></span>

<span data-ttu-id="32222-255">Um die Benutzerfreundlichkeit zu veranschaulichen, mit der wir das übergeordnete Standort Layout ändern können, öffnen Sie die Seite `Simple.master` Master, und fügen Sie das folgende Markup zwischen den Elementen `topContent` und `mainContent` `<div>` hinzu:</span><span class="sxs-lookup"><span data-stu-id="32222-255">To demonstrate the ease with which we can change the overarching site layout, open the `Simple.master` master page and add the following markup between the `topContent` and `mainContent` `<div>` elements:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample7.aspx)]

<span data-ttu-id="32222-256">Dadurch werden zwei Links zum Anfang jeder Seite hinzugefügt, die an `Simple.master`, `SimpleNested.master`oder `SimpleNestedAlternate.master`gebunden werden. Diese Änderungen gelten sofort für alle untergeordneten Seiten und ihre Inhaltsseiten.</span><span class="sxs-lookup"><span data-stu-id="32222-256">This adds two links to the top of every page that binds to `Simple.master`, `SimpleNested.master`, or `SimpleNestedAlternate.master`; these changes apply to all nested master pages and their content pages immediately.</span></span> <span data-ttu-id="32222-257">Abbildung 8 zeigt `Alternate.aspx`, wenn Sie in einem Browser angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="32222-257">Figure 8 shows `Alternate.aspx` when viewed through a browser.</span></span> <span data-ttu-id="32222-258">Beachten Sie das Hinzufügen der Links oben auf der Seite (im Vergleich zu Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="32222-258">Note the addition of the links at the top of the page (compared to Figure 7).</span></span>

<span data-ttu-id="32222-259">[![, die auf die Master Seite auf oberster Ebene geändert wurden, werden sofort in den von Ihnen gespiegelten Masterseiten und ihren Inhaltsseiten reflektiert.](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="32222-259">[![Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages](nested-master-pages-vb/_static/image23.png)](nested-master-pages-vb/_static/image22.png)</span></span>

<span data-ttu-id="32222-260">**Abbildung 08**: Änderungen an der Master Seite auf oberster Ebene werden sofort in den geänderten Masterseiten und ihren Inhaltsseiten widergespiegelt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="32222-260">**Figure 08**: Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages ([Click to view full-size image](nested-master-pages-vb/_static/image24.png))</span></span>

## <a name="using-a-nested-master-page-for-the-administration-section"></a><span data-ttu-id="32222-261">Verwenden einer im Abschnitt "Verwaltung" verwendeten Seite für die Verwaltung</span><span class="sxs-lookup"><span data-stu-id="32222-261">Using a Nested Master Page for the Administration Section</span></span>

<span data-ttu-id="32222-262">An dieser Stelle haben wir uns mit den Vorteilen der geschlagenen Masterseiten beschäftigt und gesehen, wie Sie in einer ASP.NET-Anwendung erstellt und verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="32222-262">At this point we have looked at the advantages of nested master pages and have seen how to create and use them in an ASP.NET application.</span></span> <span data-ttu-id="32222-263">Die Beispiele in den Schritten 1, 2 und 3 beinhalteten jedoch das Erstellen einer neuen Master Seite auf oberster Ebene, neuer, von der Liste erstellter Masterseiten und neuer Inhaltsseiten.</span><span class="sxs-lookup"><span data-stu-id="32222-263">The examples in Steps 1, 2, and 3, however, involved creating a new top-level master page, new nested master pages, and new content pages.</span></span> <span data-ttu-id="32222-264">Was ist, wenn einer Website eine neue, auf der obersten Ebene bestehende Master Seite und Inhaltsseiten hinzugefügt werden?</span><span class="sxs-lookup"><span data-stu-id="32222-264">What about adding a new nested master page to a website with an existing top-level master page and content pages?</span></span>

<span data-ttu-id="32222-265">Das Integrieren einer auf einer vorhandenen Website bestehenden Website in eine vorhandene Website und die Zuordnung zu vorhandenen Inhaltsseiten erfordert etwas mehr Aufwand als von Grund auf neu zu beginnen.</span><span class="sxs-lookup"><span data-stu-id="32222-265">Integrating a nested master page into an existing website and associating it with existing content pages requires a bit more effort than starting from scratch.</span></span> <span data-ttu-id="32222-266">In den Schritten 4, 5, 6 und 7 werden diese Herausforderungen erläutert, da wir unsere Demoanwendung erweitern, um eine neue, auf der Seite mit dem Namen `AdminNested.master`, die Anweisungen für den Administrator enthält und die von den ASP.NET-Seiten im Ordner `~/Admin` verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="32222-266">Steps 4, 5, 6, and 7 explore these challenges as we augment our demo application to include a new nested master page named `AdminNested.master` that contains instructions for the administrator and is used by the ASP.NET pages in the `~/Admin` folder.</span></span>

<span data-ttu-id="32222-267">Durch die Integration einer voreingefallenen Master Seite in unsere Demoanwendung werden folgende Hürden eingeführt:</span><span class="sxs-lookup"><span data-stu-id="32222-267">Integrating a nested master page into our demo application introduces the following hurdles:</span></span>

- <span data-ttu-id="32222-268">Die vorhandenen Inhaltsseiten im `~/Admin` Ordner weisen bestimmte Erwartungen von der Master Seite auf.</span><span class="sxs-lookup"><span data-stu-id="32222-268">The existing content pages in the `~/Admin` folder have certain expectations from their master page.</span></span> <span data-ttu-id="32222-269">Zunächst erwarten Sie, dass bestimmte contentplachalter-Steuerelemente vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="32222-269">For starters, they expect certain ContentPlaceHolder controls to be present.</span></span> <span data-ttu-id="32222-270">Außerdem wird auf den Seiten "`~/Admin/AddProduct.aspx`" und "`~/Admin/Products.aspx`" die öffentliche `RefreshRecentProductsGrid`-Methode der Master Seite aufgerufen, deren `GridMessageText`-Eigenschaft festgelegt oder ein Ereignishandler für das `PricesDoubled` Ereignis festgelegt.</span><span class="sxs-lookup"><span data-stu-id="32222-270">Furthermore, the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages call the master page's public `RefreshRecentProductsGrid` method, set its `GridMessageText` property, or have an event handler for its `PricesDoubled` event.</span></span> <span data-ttu-id="32222-271">Folglich muss unsere auf der Seite mit der Seite für die Master Seite dieselben contentplatzhalter und öffentlichen Member bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="32222-271">Consequently, our nested master page must provide the same ContentPlaceHolders and public members.</span></span>
- <span data-ttu-id="32222-272">Im vorherigen Tutorial haben wir die `BasePage` Klasse verbessert, um die `MasterPageFile`-Eigenschaft des `Page` Objekts basierend auf einer Sitzungsvariablen dynamisch festzulegen.</span><span class="sxs-lookup"><span data-stu-id="32222-272">In the preceding tutorial we enhanced the `BasePage` class to dynamically set the `Page` object's `MasterPageFile` property based on a Session variable.</span></span> <span data-ttu-id="32222-273">Wie werden dynamische Masterseiten unterstützt, wenn Sie mit der Verwendung von untergeordneten Masterseiten?</span><span class="sxs-lookup"><span data-stu-id="32222-273">How to we support dynamic master pages when using nested master pages?</span></span>

<span data-ttu-id="32222-274">Diese beiden Herausforderungen stellen eine Oberfläche dar, wenn wir die Seite für die untergeordneten Master Seite erstellen und auf unseren vorhandenen Inhaltsseiten verwenden.</span><span class="sxs-lookup"><span data-stu-id="32222-274">These two challenges will surface as we build the nested master page and use it from our existing content pages.</span></span> <span data-ttu-id="32222-275">Diese Probleme werden untersucht und aufgetreten.</span><span class="sxs-lookup"><span data-stu-id="32222-275">We'll investigate and surmount these issues as they arise.</span></span>

## <a name="step-4-creating-the-nested-master-page"></a><span data-ttu-id="32222-276">Schritt 4: Erstellen der eingefügten Master Seite</span><span class="sxs-lookup"><span data-stu-id="32222-276">Step 4: Creating the Nested Master Page</span></span>

<span data-ttu-id="32222-277">Unsere erste Aufgabe besteht darin, die von den Seiten im Abschnitt "Verwaltung" zu verwendende Seite für die vorseitige Master Seite zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="32222-277">Our first task is to create the nested master page to be used by the pages in the Administration section.</span></span> <span data-ttu-id="32222-278">Wie in Schritt 2 gezeigt, müssen Sie beim Hinzufügen einer neuen, auf einer neuen Seite beschriebenen Master Seite die übergeordnete Master Seite der Seite der Seite angeben.</span><span class="sxs-lookup"><span data-stu-id="32222-278">As we saw in Step 2, when adding a new nested master page we need to specify the nested master page's parent master page.</span></span> <span data-ttu-id="32222-279">Wir haben jedoch Zweimaster Seiten auf oberster Ebene: `Site.master` und `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="32222-279">But we have two top-level master pages: `Site.master` and `Alternate.master`.</span></span> <span data-ttu-id="32222-280">Wir erinnern uns, dass wir im vorherigen Tutorial `Alternate.master` erstellt und Code in der `BasePage`-Klasse geschrieben haben, die die `MasterPageFile`-Eigenschaft des `Page`-Objekts zur Laufzeit entweder auf `Site.master` oder `Alternate.master`, abhängig vom Wert der `MyMasterPage` Sitzungsvariablen, festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="32222-280">Recall that we created `Alternate.master` in the preceding tutorial and wrote code in the `BasePage` class that set the `Page` object's `MasterPageFile` property at runtime to either `Site.master` or `Alternate.master` depending on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="32222-281">Wie konfigurieren wir unsere geschachtelte Master Seite so, dass Sie die entsprechende Master Seite auf oberster Ebene verwendet?</span><span class="sxs-lookup"><span data-stu-id="32222-281">How do we configure our nested master page so that it uses the appropriate top-level master page?</span></span> <span data-ttu-id="32222-282">Es gibt zwei Möglichkeiten:</span><span class="sxs-lookup"><span data-stu-id="32222-282">We have two options:</span></span>

- <span data-ttu-id="32222-283">Erstellen Sie zwei vorgebundene Masterseiten, `AdminNestedSite.master` und `AdminNestedAlternate.master`, und binden Sie diese an die Masterseiten der obersten Ebene `Site.master` bzw. `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="32222-283">Create two nested master pages, `AdminNestedSite.master` and `AdminNestedAlternate.master`, and bind them to the top-level master pages `Site.master` and `Alternate.master`, respectively.</span></span> <span data-ttu-id="32222-284">In `BasePage`haben wir die `MasterPageFile` des `Page` Objekts auf die entsprechende geschachtelte Master Seite festgelegt.</span><span class="sxs-lookup"><span data-stu-id="32222-284">In `BasePage`, then, we'd set the `Page` object's `MasterPageFile` to the appropriate nested master page.</span></span>
- <span data-ttu-id="32222-285">Erstellen Sie eine einzelne, für die Seite verwendete Master Seite, und lassen Sie die Inhaltsseiten diese bestimmte Master Seite verwenden.</span><span class="sxs-lookup"><span data-stu-id="32222-285">Create a single nested master page and have the content pages use this particular master page.</span></span> <span data-ttu-id="32222-286">Zur Laufzeit müssten wir die `MasterPageFile`-Eigenschaft der geschachtelte-Master Seite zur Laufzeit auf die entsprechende Master Seite auf oberster Ebene festlegen.</span><span class="sxs-lookup"><span data-stu-id="32222-286">Then, at runtime, we'd need to set the nested master page's `MasterPageFile` property to the appropriate top-level master page at runtime.</span></span> <span data-ttu-id="32222-287">(Wie Sie vielleicht schon einmal herausgefunden haben, verfügen Masterseiten auch über eine `MasterPageFile`-Eigenschaft.)</span><span class="sxs-lookup"><span data-stu-id="32222-287">(As you might have figured out by now, master pages also have a `MasterPageFile` property.)</span></span>

<span data-ttu-id="32222-288">Verwenden Sie die zweite Option.</span><span class="sxs-lookup"><span data-stu-id="32222-288">Let's use the second option.</span></span> <span data-ttu-id="32222-289">Erstellen Sie eine einzelne Auslagerungs Datei im Ordner "`~/Admin`" mit dem Namen `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="32222-289">Create a single nested master page file in the `~/Admin` folder named `AdminNested.master`.</span></span> <span data-ttu-id="32222-290">Da sowohl `Site.master` als auch `Alternate.master` denselben Satz an contentplachalter-Steuerelementen aufweisen, ist es egal, an welche Master Seite Sie gebunden sind. Ich empfehle Ihnen jedoch, Sie für die Konsistenz an `Site.master` zu binden.</span><span class="sxs-lookup"><span data-stu-id="32222-290">Because both `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls, it doesn't matter what master page you bind it to, although I encourage you to bind it to `Site.master` for consistency's sake.</span></span>

<span data-ttu-id="32222-291">[![fügen Sie dem Ordner ~/Admin eine "masted Master"-Seite hinzu.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="32222-291">[![Add a Nested Master Page to the ~/Admin Folder.](nested-master-pages-vb/_static/image26.png)](nested-master-pages-vb/_static/image25.png)</span></span>

<span data-ttu-id="32222-292">**Abbildung 09**: Hinzufügen einer masted Master Seite zum Ordner "`~/Admin`".</span><span class="sxs-lookup"><span data-stu-id="32222-292">**Figure 09**: Add a Nested Master Page to the `~/Admin` Folder.</span></span> <span data-ttu-id="32222-293">([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="32222-293">([Click to view full-size image](nested-master-pages-vb/_static/image27.png))</span></span>

<span data-ttu-id="32222-294">Da die geöffnette Master Seite an eine Master Seite mit vier contentplachalter-Steuerelementen gebunden ist, fügt Visual Studio dem ursprünglichen Markup der neuen Datei der Geviert ten Master Seite vier Inhalts Steuerelemente hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-294">Because the nested master page is bound to a master page with four ContentPlaceHolder controls, Visual Studio adds four Content controls to the new nested master page file's initial markup.</span></span> <span data-ttu-id="32222-295">Fügen Sie wie in den Schritten 2 und 3 ein contentplachalter-Steuerelement in jedem Inhalts Steuerelement hinzu, und geben Sie dabei den gleichen Namen wie das contentplachalter-Steuerelement der obersten Ebene der Master Seite an.</span><span class="sxs-lookup"><span data-stu-id="32222-295">Like we did in Steps 2 and 3, add a ContentPlaceHolder control in each Content control, giving it the same name as the top-level master page's ContentPlaceHolder control.</span></span> <span data-ttu-id="32222-296">Fügen Sie dem Content-Steuerelement, das dem `MainContent` contentplachalter entspricht, auch das folgende Markup hinzu:</span><span class="sxs-lookup"><span data-stu-id="32222-296">Also add the following markup to the Content control that corresponds to the `MainContent` ContentPlaceHolder:</span></span>

[!code-html[Main](nested-master-pages-vb/samples/sample8.html)]

<span data-ttu-id="32222-297">Definieren Sie als nächstes die `instructions` CSS-Klasse in den `Styles.css`-und `AlternateStyles.css`-CSS-Dateien.</span><span class="sxs-lookup"><span data-stu-id="32222-297">Next, define the `instructions` CSS class in the `Styles.css` and `AlternateStyles.css` CSS files.</span></span> <span data-ttu-id="32222-298">Die folgenden CSS-Regeln bewirken, dass HTML-Elemente, die mit der `instructions`-Klasse formatiert sind, mit einer hellen gelben Hintergrundfarbe und einem schwarzen, durch festen Rahmen angezeigt werden:</span><span class="sxs-lookup"><span data-stu-id="32222-298">The following CSS rules cause HTML elements styled with the `instructions` class to be displayed with a light yellow background color and a black, solid border:</span></span>

[!code-css[Main](nested-master-pages-vb/samples/sample9.css)]

<span data-ttu-id="32222-299">Da dieses Markup der Seite der gemasterten Master Seite hinzugefügt wurde, wird es nur auf den Seiten angezeigt, die diese gemasterte Master Seite verwenden (also auf den Seiten im Abschnitt Verwaltung).</span><span class="sxs-lookup"><span data-stu-id="32222-299">Because this markup has been added to the nested master page, it will only appear in those pages that use this nested master page (namely, the pages in the Administration section).</span></span>

<span data-ttu-id="32222-300">Nachdem Sie diese Ergänzungen auf der Seite für die vorgenommenen Änderungen vorgenommen haben, sollte Ihr deklaratives Markup in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="32222-300">After making these additions to your nested master page, its declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample10.aspx)]

<span data-ttu-id="32222-301">Beachten Sie, dass jedes Inhalts Steuerelement über ein contentplachalter-Steuerelement verfügt und dass den `ID` Eigenschaften der contentplachalter-Steuerelemente die gleichen Werte wie die entsprechenden contentplachalter-Steuerelemente auf der Master Seite der obersten Ebene zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="32222-301">Note that each Content control has a ContentPlaceHolder control and that the ContentPlaceHolder controls' `ID` properties are assigned the same values as the corresponding ContentPlaceHolder controls in the top-level master page.</span></span> <span data-ttu-id="32222-302">Darüber hinaus wird das Verwaltungs Abschnitts spezifische Markup im `MainContent` contentplachalter angezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-302">Moreover, the Administration section-specific markup appears in the `MainContent` ContentPlaceHolder.</span></span>

<span data-ttu-id="32222-303">Abbildung 10 zeigt die `AdminNested.master` die Seite für die untergeordneten Master Seite, wenn Sie im Visual Studio-Designer angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-303">Figure 10 shows the `AdminNested.master` nested master page when viewed through Visual Studio's Designer.</span></span> <span data-ttu-id="32222-304">Die Anweisungen werden im gelben Feld am oberen Rand des `MainContent` Content-Steuer Elements angezeigt.</span><span class="sxs-lookup"><span data-stu-id="32222-304">You can see the instructions in the yellow box at the top of the `MainContent` Content control.</span></span>

<span data-ttu-id="32222-305">[![die Seite für die vorgenannte Master Seite erweitert die Master Seite auf oberster Ebene, sodass Sie Anweisungen für den Administrator enthält.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="32222-305">[![The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.](nested-master-pages-vb/_static/image29.png)](nested-master-pages-vb/_static/image28.png)</span></span>

<span data-ttu-id="32222-306">**Abbildung 10**: die vorgenannte Master Seite erweitert die Master Seite auf oberster Ebene, um Anweisungen für den Administrator einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="32222-306">**Figure 10**: The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.</span></span> <span data-ttu-id="32222-307">([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="32222-307">([Click to view full-size image](nested-master-pages-vb/_static/image30.png))</span></span>

## <a name="step-5-updating-the-existing-content-pages-to-use-the-new-nested-master-page"></a><span data-ttu-id="32222-308">Schritt 5: Aktualisieren der vorhandenen Inhaltsseiten für die Verwendung der neuen, auf der Seite verwendeten Master Seite</span><span class="sxs-lookup"><span data-stu-id="32222-308">Step 5: Updating the Existing Content Pages to Use the New Nested Master Page</span></span>

<span data-ttu-id="32222-309">Jedes Mal, wenn wir dem Bereich "Verwaltung" eine neue Inhaltsseite hinzufügen, müssen wir diese an die soeben erstellte `AdminNested.master` Master Seite binden.</span><span class="sxs-lookup"><span data-stu-id="32222-309">Anytime we add a new content page to the Administration section we need to bind it to the `AdminNested.master` master page we just created.</span></span> <span data-ttu-id="32222-310">Aber wie sieht es mit den vorhandenen Inhaltsseiten aus?</span><span class="sxs-lookup"><span data-stu-id="32222-310">But what about the existing content pages?</span></span> <span data-ttu-id="32222-311">Derzeit werden alle Inhaltsseiten der Website von der `BasePage`-Klasse abgeleitet, die die Master Seite der Inhaltsseite zur Laufzeit Programm gesteuert festlegt.</span><span class="sxs-lookup"><span data-stu-id="32222-311">Currently, all content pages in the site derive from the `BasePage` class, which programmatically sets the content page's master page at runtime.</span></span> <span data-ttu-id="32222-312">Dies ist nicht das gewünschte Verhalten für die Inhaltsseiten im Abschnitt "Verwaltung".</span><span class="sxs-lookup"><span data-stu-id="32222-312">This is not the behavior we want for the content pages in the Administration section.</span></span> <span data-ttu-id="32222-313">Stattdessen möchten wir, dass diese Inhaltsseiten immer die `AdminNested.master` Seite verwenden.</span><span class="sxs-lookup"><span data-stu-id="32222-313">Instead, we want these content pages to always use the `AdminNested.master` page.</span></span> <span data-ttu-id="32222-314">Es liegt in der Verantwortung der Seite "auf der Seite" auf der Seite "Seite", die die richtige Inhaltsseite auf oberster Ebene zur Laufzeit auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="32222-314">It will be the responsibility of the nested master page to choose the right top-level content page at runtime.</span></span>

<span data-ttu-id="32222-315">Um dieses gewünschte Verhalten am besten zu erreichen, erstellen Sie eine neue benutzerdefinierte Basis Seiten Klasse mit dem Namen `AdminBasePage`, die die `BasePage`-Klasse erweitert.</span><span class="sxs-lookup"><span data-stu-id="32222-315">To best way to achieve this desired behavior is to create a new custom base page class named `AdminBasePage` that extends the `BasePage` class.</span></span> <span data-ttu-id="32222-316">`AdminBasePage` können dann die `SetMasterPageFile` überschreiben und die `MasterPageFile` des `Page` Objekts auf den hart codierten Wert "~/admin/AdminNested.Master" festlegen.</span><span class="sxs-lookup"><span data-stu-id="32222-316">`AdminBasePage` can then override the `SetMasterPageFile` and set the `Page` object's `MasterPageFile` to the hard-coded value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="32222-317">Auf diese Weise verwendet jede Seite, die von `AdminBasePage` abgeleitet wird, `AdminNested.master`, während jede Seite, die von `BasePage` abgeleitet wird, die `MasterPageFile`-Eigenschaft dynamisch auf "~/Site.Master" oder "~/Alternate.Master" basierend auf dem Wert der `MyMasterPage` Sitzungsvariablen festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-317">In this way, any page that derives from `AdminBasePage` will use `AdminNested.master`, whereas any page that derives from `BasePage` will have its `MasterPageFile` property set dynamically to either "~/Site.master" or "~/Alternate.master" based on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="32222-318">Fügen Sie zunächst eine neue Klassendatei zum `App_Code` Ordner mit dem Namen `AdminBasePage.vb`hinzu.</span><span class="sxs-lookup"><span data-stu-id="32222-318">Start by adding a new class file to the `App_Code` folder named `AdminBasePage.vb`.</span></span> <span data-ttu-id="32222-319">`AdminBasePage` `BasePage` erweitern und dann die `SetMasterPageFile`-Methode überschreiben.</span><span class="sxs-lookup"><span data-stu-id="32222-319">Have `AdminBasePage` extend `BasePage` and then override the `SetMasterPageFile` method.</span></span> <span data-ttu-id="32222-320">Weisen Sie in dieser Methode den `MasterPageFile` den Wert "~/admin/AdminNested.Master" zu.</span><span class="sxs-lookup"><span data-stu-id="32222-320">In that method assign the `MasterPageFile` the value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="32222-321">Nachdem Sie diese Änderungen vorgenommen haben, sollte die Klassendatei in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="32222-321">After making these changes your class file should look similar to the following:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample11.vb)]

<span data-ttu-id="32222-322">Nun müssen die vorhandenen Inhaltsseiten im Verwaltungsabschnitt von `AdminBasePage` abgeleitet werden, anstatt `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="32222-322">We now need to have the existing content pages in the Administration section derive from `AdminBasePage` instead of `BasePage`.</span></span> <span data-ttu-id="32222-323">Wechseln Sie für jede Inhaltsseite im Ordner "`~/Admin`" zur Code Behind-Klassendatei, und nehmen Sie diese Änderung vor.</span><span class="sxs-lookup"><span data-stu-id="32222-323">Go to the code-behind class file for each content page in the `~/Admin` folder and make this change.</span></span> <span data-ttu-id="32222-324">In `~/Admin/Default.aspx` Sie z. b. die Code-Behind-Klassen Deklaration von ändern:</span><span class="sxs-lookup"><span data-stu-id="32222-324">For example, in `~/Admin/Default.aspx` you'd change the code-behind class declaration from:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample12.vb)]

<span data-ttu-id="32222-325">Nach:</span><span class="sxs-lookup"><span data-stu-id="32222-325">To:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample13.vb)]

<span data-ttu-id="32222-326">In Abbildung 11 ist dargestellt, wie die Master Seite auf oberster Ebene (`Site.master` oder `Alternate.master`), die Seite für die Zusammenstellung der Seite (`AdminNested.master`) und die Inhaltsseiten des Verwaltungs Abschnitts aufeinander zueinander stehen.</span><span class="sxs-lookup"><span data-stu-id="32222-326">Figure 11 depicts how the top-level master page (`Site.master` or `Alternate.master`), the nested master page (`AdminNested.master`), and the Administration section content pages relate to one another.</span></span>

<span data-ttu-id="32222-327">[![die Seite "auf der Seite" auf der Seite "Seite" definiert Inhalte definiert, die für die Seiten im](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="32222-327">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-vb/_static/image32.png)](nested-master-pages-vb/_static/image31.png)</span></span>

<span data-ttu-id="32222-328">**Abbildung 11**: die Seite "vordefiniert" definiert Inhalte, die für die Seiten im Abschnitt "Verwaltung" spezifisch sind ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="32222-328">**Figure 11**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-vb/_static/image33.png))</span></span>

## <a name="step-6-mirroring-the-master-pages-public-methods-and-properties"></a><span data-ttu-id="32222-329">Schritt 6: Spiegeln der öffentlichen Methoden und Eigenschaften der Master Seite</span><span class="sxs-lookup"><span data-stu-id="32222-329">Step 6: Mirroring the Master Page's Public Methods and Properties</span></span>

<span data-ttu-id="32222-330">Beachten Sie, dass die `~/Admin/AddProduct.aspx`-und `~/Admin/Products.aspx` Seiten Programm gesteuert mit der Master Seite interagieren: `~/Admin/AddProduct.aspx` die öffentliche `RefreshRecentProductsGrid`-Methode der Master Seite aufruft und deren `GridMessageText`-Eigenschaft festlegt. `~/Admin/Products.aspx` über einen Ereignishandler für das `PricesDoubled`-Ereignis verfügt.</span><span class="sxs-lookup"><span data-stu-id="32222-330">Recall that the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages interact programmatically with the master page: `~/Admin/AddProduct.aspx` calls the master page's public `RefreshRecentProductsGrid` method and sets its `GridMessageText` property; `~/Admin/Products.aspx` has an event handler for the `PricesDoubled` event.</span></span> <span data-ttu-id="32222-331">Im vorherigen Tutorial haben wir eine `MustInherit` `BaseMasterPage` Klasse erstellt, die diese öffentlichen Member definiert.</span><span class="sxs-lookup"><span data-stu-id="32222-331">In the preceding tutorial we created a `MustInherit` `BaseMasterPage` class that defined these public members.</span></span>

<span data-ttu-id="32222-332">Auf den Seiten `~/Admin/AddProduct.aspx` und `~/Admin/Products.aspx` wird davon ausgegangen, dass die Master Seite von der `BaseMasterPage`-Klasse abgeleitet ist.</span><span class="sxs-lookup"><span data-stu-id="32222-332">The `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages assume that their master page derives from the `BaseMasterPage` class.</span></span> <span data-ttu-id="32222-333">Die `AdminNested.master` Seite erweitert jedoch derzeit die `System.Web.UI.MasterPage` Klasse.</span><span class="sxs-lookup"><span data-stu-id="32222-333">The `AdminNested.master` page, however, currently extends the `System.Web.UI.MasterPage` class.</span></span> <span data-ttu-id="32222-334">Daher wird beim Besuch `~/Admin/Products.aspx` eine `InvalidCastException` mit der folgenden Meldung ausgelöst: "das Objekt des Typs" ASP. admin\_adminnested\_Master "kann nicht in den Typ" basemasterpage "umgewandelt werden.</span><span class="sxs-lookup"><span data-stu-id="32222-334">As a result, when visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown with the message: "Unable to cast object of type 'ASP.admin\_adminnested\_master' to type 'BaseMasterPage'."</span></span>

<span data-ttu-id="32222-335">Um dieses Problem zu beheben, muss die `AdminNested.master` Code Behind-Klasse `BaseMasterPage`erweitert werden.</span><span class="sxs-lookup"><span data-stu-id="32222-335">To fix this we need to have the `AdminNested.master` code-behind class extend `BaseMasterPage`.</span></span> <span data-ttu-id="32222-336">Aktualisieren Sie die Code-Behind-Klassen Deklaration der blten Master Seite von:</span><span class="sxs-lookup"><span data-stu-id="32222-336">Update the nested master page's code-behind class declaration from:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample14.vb)]

<span data-ttu-id="32222-337">Nach:</span><span class="sxs-lookup"><span data-stu-id="32222-337">To:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample15.vb)]

<span data-ttu-id="32222-338">Wir sind noch nicht fertig.</span><span class="sxs-lookup"><span data-stu-id="32222-338">We're not done yet.</span></span> <span data-ttu-id="32222-339">Wir müssen die als `MustOverride`markierten Member außer Kraft setzen, nämlich `RefreshRecentProductsGrid` und `GridMessageText`.</span><span class="sxs-lookup"><span data-stu-id="32222-339">We need to override the members marked as `MustOverride`, namely `RefreshRecentProductsGrid` and `GridMessageText`.</span></span> <span data-ttu-id="32222-340">Diese Member werden von den Masterseiten der obersten Ebene verwendet, um Ihre Benutzeroberflächen zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="32222-340">These members are used by the top-level master pages to update their user interfaces.</span></span> <span data-ttu-id="32222-341">(Nur die `Site.master` Master Seite verwendet diese Methoden, obwohl beide Masterseiten der obersten Ebene diese Methoden implementieren, da beide `BaseMasterPage`erweitern.)</span><span class="sxs-lookup"><span data-stu-id="32222-341">(Actually, only the `Site.master` master page uses these methods, although both top-level master pages implement these methods, since both extend `BaseMasterPage`.)</span></span>

<span data-ttu-id="32222-342">Obwohl diese Member in `AdminNested.master`implementiert werden müssen, müssen all diese Implementierungen einfach denselben Member auf der obersten Ebene der Master Seite aufzurufen, die von der schsted Master Seite verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="32222-342">While we need to implement these members in `AdminNested.master`, all these implementations need to do is simply call the same member in the top-level master page used by the nested master page.</span></span> <span data-ttu-id="32222-343">Wenn z. b. eine Inhaltsseite im Verwaltungsabschnitt die `RefreshRecentProductsGrid` Methode der schten Master Seite aufruft, muss die gesamte schalte Master Seite wiederum `Site.master` oder `Alternate.master``RefreshRecentProductsGrid` Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="32222-343">For instance, when a content page in the Administration section calls the nested master page's `RefreshRecentProductsGrid` method, all the nested master page needs to do is, in turn, call `Site.master` or `Alternate.master`'s `RefreshRecentProductsGrid` method.</span></span>

<span data-ttu-id="32222-344">Um dies zu erreichen, fügen Sie zunächst die folgende `@MasterType`-Direktive am Anfang `AdminNested.master`hinzu:</span><span class="sxs-lookup"><span data-stu-id="32222-344">To achieve this, start by adding the following `@MasterType` directive to the top of `AdminNested.master`:</span></span>

[!code-aspx[Main](nested-master-pages-vb/samples/sample16.aspx)]

<span data-ttu-id="32222-345">Beachten Sie, dass die `@MasterType`-Direktive der Code-Behind-Klasse mit dem Namen `Master`eine stark typisierte Eigenschaft hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="32222-345">Recall that the `@MasterType` directive adds a strongly-typed property to the code-behind class named `Master`.</span></span> <span data-ttu-id="32222-346">Überschreiben Sie dann die `RefreshRecentProductsGrid`-und `GridMessageText`-Member, und delegieren Sie einfach den Aufruf an die zugehörige-Methode des `Master`:</span><span class="sxs-lookup"><span data-stu-id="32222-346">Then override the `RefreshRecentProductsGrid` and `GridMessageText` members and simply delegate the call to the `Master`'s corresponding method:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample17.vb)]

<span data-ttu-id="32222-347">Wenn dieser Code vorhanden ist, sollten Sie in der Lage sein, die Inhaltsseiten im Abschnitt Verwaltung zu besuchen und zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="32222-347">With this code in place, you should be able to visit and use the content pages in the Administration section.</span></span> <span data-ttu-id="32222-348">In Abbildung 12 wird die `~/Admin/Products.aspx` Seite angezeigt, wenn Sie in einem Browser angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-348">Figure 12 shows the `~/Admin/Products.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="32222-349">Wie Sie sehen können, enthält die Seite das Feld Verwaltungsanweisungen, das auf der Seite für die vordefinierte Master Seite definiert ist.</span><span class="sxs-lookup"><span data-stu-id="32222-349">As you can see, the page includes the Administration Instructions box, which is defined in the nested master page.</span></span>

<span data-ttu-id="32222-350">[![die Inhaltsseiten im Abschnitt "Verwaltung" Anweisungen oben auf jeder Seite enthalten.](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="32222-350">[![The Content Pages in the Administration Section Include Instructions at the Top of Each Page](nested-master-pages-vb/_static/image35.png)](nested-master-pages-vb/_static/image34.png)</span></span>

<span data-ttu-id="32222-351">**Abbildung 12**: die Inhaltsseiten im Abschnitt "Verwaltung" enthalten Anweisungen oben auf jeder Seite ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="32222-351">**Figure 12**: The Content Pages in the Administration Section Include Instructions at the Top of Each Page ([Click to view full-size image](nested-master-pages-vb/_static/image36.png))</span></span>

## <a name="step-7-using-the-appropriate-top-level-master-page-at-runtime"></a><span data-ttu-id="32222-352">Schritt 7: Verwenden der entsprechenden Master Seite auf oberster Ebene zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="32222-352">Step 7: Using the Appropriate Top-Level Master Page at Runtime</span></span>

<span data-ttu-id="32222-353">Während alle Inhaltsseiten im Verwaltungsabschnitt voll funktionsfähig sind, verwenden Sie alle dieselbe Master Seite auf oberster Ebene und ignorieren die vom Benutzer ausgewählte Master Seite bei `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="32222-353">While all the content pages in the Administration section are fully functional, they all use the same top-level master page and ignore the master page selected by the user at `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="32222-354">Dieses Verhalten ist darauf zurückzuführen, dass die `MasterPageFile`-Eigenschaft der geteigenten Master Seite statisch auf `Site.master` in der `<%@ Master %>`-Direktive festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="32222-354">This behavior is due to the fact that the nested master page has its `MasterPageFile` property statically set to `Site.master` in its `<%@ Master %>` directive.</span></span>

<span data-ttu-id="32222-355">Um die vom Endbenutzer ausgewählte Master Seite auf oberster Ebene zu verwenden, müssen wir die `MasterPageFile`-Eigenschaft des `AdminNested.master`auf den Wert in der `MyMasterPage` Session-Variablen festlegen.</span><span class="sxs-lookup"><span data-stu-id="32222-355">To use the top-level master page selected by the end user we need to set the `AdminNested.master`'s `MasterPageFile` property to the value in the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="32222-356">Da wir die `MasterPageFile` Eigenschaften der Inhaltsseiten in `BasePage`festlegen, werden Sie möglicherweise feststellen, dass die `MasterPageFile`-Eigenschaft der-Master Seite in `BaseMasterPage` oder in der Code Behind-Klasse des `AdminNested.master`festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="32222-356">Because we set the content pages' `MasterPageFile` properties in `BasePage`, you may think that we would set the nested master page's `MasterPageFile` property in `BaseMasterPage` or in the `AdminNested.master`'s code-behind class.</span></span> <span data-ttu-id="32222-357">Dies funktioniert jedoch nicht, da die `MasterPageFile`-Eigenschaft am Ende der PreInit-Phase festgelegt werden muss.</span><span class="sxs-lookup"><span data-stu-id="32222-357">This won't work, however, because we need to have set the `MasterPageFile` property by the end of the PreInit stage.</span></span> <span data-ttu-id="32222-358">Die früheste Zeit, die Sie Programm gesteuert auf den Seiten Lebenszyklus von einer Master Seite aus tippen können, ist die Initialisierungsphase (die nach der PreInit-Phase auftritt).</span><span class="sxs-lookup"><span data-stu-id="32222-358">The earliest time that we can programmatically tap into the page lifecycle from a master page is the Init stage (which occurs after the PreInit stage).</span></span>

<span data-ttu-id="32222-359">Aus diesem Grund müssen wir die `MasterPageFile`-Eigenschaft der-Eigenschaft der-Master Seite auf den Inhaltsseiten festlegen.</span><span class="sxs-lookup"><span data-stu-id="32222-359">Therefore, we need to set the nested master page's `MasterPageFile` property from the content pages.</span></span> <span data-ttu-id="32222-360">Die einzigen Inhaltsseiten, die die `AdminNested.master` Master Seite verwenden, werden von `AdminBasePage`abgeleitet.</span><span class="sxs-lookup"><span data-stu-id="32222-360">The only content pages that use the `AdminNested.master` master page derive from `AdminBasePage`.</span></span> <span data-ttu-id="32222-361">Daher können wir diese Logik hier einfügen.</span><span class="sxs-lookup"><span data-stu-id="32222-361">Therefore, we can put this logic there.</span></span> <span data-ttu-id="32222-362">In Schritt 5 haben wir die `SetMasterPageFile`-Methode überschritten und die `MasterPageFile`-Eigenschaft des Page-Objekts auf "~/admin/AdminNested.Master" festgelegt.</span><span class="sxs-lookup"><span data-stu-id="32222-362">In Step 5 we overrode the `SetMasterPageFile` method, setting the Page object's `MasterPageFile` property to "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="32222-363">Aktualisieren Sie `SetMasterPageFile`, um auch die `MasterPageFile`-Eigenschaft der Master Seite auf das in der Sitzung gespeicherte Ergebnis festzulegen:</span><span class="sxs-lookup"><span data-stu-id="32222-363">Update `SetMasterPageFile` to also set the master page's `MasterPageFile` property to the result stored in Session:</span></span>

[!code-vb[Main](nested-master-pages-vb/samples/sample18.vb)]

<span data-ttu-id="32222-364">Die `GetMasterPageFileFromSession`-Methode, die wir der `BasePage`-Klasse im vorherigen Tutorial hinzugefügt haben, gibt den entsprechenden Datei Pfad der Master Seite basierend auf dem Sitzungsvariablen Wert zurück.</span><span class="sxs-lookup"><span data-stu-id="32222-364">The `GetMasterPageFileFromSession` method, which we added to the `BasePage` class in the preceding tutorial, returns the appropriate master page file path based on the Session variable value.</span></span>

<span data-ttu-id="32222-365">Nachdem diese Änderung vorgenommen wurde, wird die Auswahl der Master Seite des Benutzers in den Abschnitt Verwaltung übernommen.</span><span class="sxs-lookup"><span data-stu-id="32222-365">With this change in place, the user's master page selection carries over to the Administration section.</span></span> <span data-ttu-id="32222-366">In Abbildung 13 wird dieselbe Seite wie in Abbildung 12 gezeigt, aber nachdem der Benutzer seine Masterseiten Auswahl in `Alternate.master`geändert hat.</span><span class="sxs-lookup"><span data-stu-id="32222-366">Figure 13 shows the same page as Figure 12, but after the user has changed their master page selection to `Alternate.master`.</span></span>

<span data-ttu-id="32222-367">[![die Seite "auf der Seite" auf der Seite "auf der Seite für die Seite](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="32222-367">[![The Nested Administration Page Uses the Top-Level Master Page Selected by the User](nested-master-pages-vb/_static/image38.png)](nested-master-pages-vb/_static/image37.png)</span></span>

<span data-ttu-id="32222-368">**Abbildung 13**: auf der Seite "auf der Seite" der Seite "wird die vom Benutzer ausgewählte Master Seite auf oberster Ebene verwendet ([Klicken Sie, um das Bild in voller Größe anzuzeigen](nested-master-pages-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="32222-368">**Figure 13**: The Nested Administration Page Uses the Top-Level Master Page Selected by the User ([Click to view full-size image](nested-master-pages-vb/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="32222-369">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="32222-369">Summary</span></span>

<span data-ttu-id="32222-370">Ähnlich wie Inhaltsseiten an eine Master Seite gebunden werden können, ist es möglich, eine untergeordnete Master Seite zu erstellen, indem eine untergeordnete Master Seite an eine übergeordnete Master Seite gebunden wird.</span><span class="sxs-lookup"><span data-stu-id="32222-370">Much like how content pages can bind to a master page, it is possible to create nested master pages by having a child master page bind to a parent master page.</span></span> <span data-ttu-id="32222-371">Die untergeordnete Master Seite kann Inhalts Steuerelemente für jeden der übergeordneten Inhalts Platzhalter definieren. Er kann dann seine eigenen contentplachalter-Steuerelemente (sowie andere Markup) zu diesen Inhalts Steuerelementen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="32222-371">The child master page may define Content controls for each of its parent's ContentPlaceHolders; it can then add its own ContentPlaceHolder controls (as well as other markup) to these Content controls.</span></span> <span data-ttu-id="32222-372">Die Verwendung von in großen Webanwendungen untergeordneten Seiten ist sehr nützlich, wenn alle Seiten ein übergreifendes Aussehen und Gefühl haben, aber für bestimmte Abschnitte der Website sind eindeutige Anpassungen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="32222-372">Nested master pages are quite useful in large web applications where all pages share an overarching look and feel, yet certain sections of the site require unique customizations.</span></span>

<span data-ttu-id="32222-373">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="32222-373">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="32222-374">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="32222-374">Further Reading</span></span>

<span data-ttu-id="32222-375">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="32222-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="32222-376">ASP.net-Master Seiten</span><span class="sxs-lookup"><span data-stu-id="32222-376">Nested ASP.NET Master Pages</span></span>](https://msdn.microsoft.com/library/x2b3ktt7.aspx)
- [<span data-ttu-id="32222-377">Tipps für die Entwurfsseiten und VS 2005-Entwurfszeit</span><span class="sxs-lookup"><span data-stu-id="32222-377">Tips for Nested Master Pages and VS 2005 Design-Time</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)
- [<span data-ttu-id="32222-378">VS 2008-Unterstützung für unterstützte Master Seiten</span><span class="sxs-lookup"><span data-stu-id="32222-378">VS 2008 Nested Master Page Support</span></span>](https://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

### <a name="about-the-author"></a><span data-ttu-id="32222-379">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="32222-379">About the Author</span></span>

<span data-ttu-id="32222-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor mehrerer ASP/ASP. net-Bücher und Gründer von 4GuysFromRolla.com, hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="32222-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="32222-381">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="32222-381">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="32222-382">Sein letztes Buch ist [*Sams Teach Yourself ASP.NET 3,5 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="32222-382">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="32222-383">Scott kann über [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/)erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="32222-383">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="32222-384">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="32222-384">Special Thanks To</span></span>

<span data-ttu-id="32222-385">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="32222-385">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="32222-386">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="32222-386">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="32222-387">Wenn dies der Fall ist, löschen Sie eine Zeile bei [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="32222-387">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="32222-388">Previous</span><span class="sxs-lookup"><span data-stu-id="32222-388">Previous</span></span>](specifying-the-master-page-programmatically-vb.md)
