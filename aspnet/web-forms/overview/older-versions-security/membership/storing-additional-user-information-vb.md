---
uid: web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
title: Speichern zusätzlicher Benutzerinformationen (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial beantworten wir diese Frage, indem wir eine sehr rudimentäre Gäste Buch Anwendung aufbauen. In diesem Fall werden wir verschiedene Optionen für modeli betrachten...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: ee4b924e-8002-4dc3-819f-695fca1ff867
msc.legacyurl: /web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
msc.type: authoredcontent
ms.openlocfilehash: cb352de6f7c2d117b41532112a87956c8dde62f8
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74639175"
---
# <a name="storing-additional-user-information-vb"></a><span data-ttu-id="c67a2-104">Speichern von zusätzlichen Benutzerinformationen (VB)</span><span class="sxs-lookup"><span data-stu-id="c67a2-104">Storing Additional User Information (VB)</span></span>

<span data-ttu-id="c67a2-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c67a2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c67a2-106">[Code herunterladen](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) oder [PDF herunterladen](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="c67a2-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span></span>

> <span data-ttu-id="c67a2-107">In diesem Tutorial beantworten wir diese Frage, indem wir eine sehr rudimentäre Gäste Buch Anwendung aufbauen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-107">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="c67a2-108">Dabei werden verschiedene Optionen zum Modellieren von Benutzerinformationen in einer Datenbank erläutert. Anschließend wird erläutert, wie Sie diese Daten den Benutzerkonten zuordnen, die vom Mitgliedschafts Framework erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-108">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span>

## <a name="introduction"></a><span data-ttu-id="c67a2-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="c67a2-109">Introduction</span></span>

<span data-ttu-id="c67a2-110">ASP. Das Mitgliedschafts Framework von NET bietet eine flexible Oberfläche zum Verwalten von Benutzern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-110">ASP.NET's Membership framework offers a flexible interface for managing users.</span></span> <span data-ttu-id="c67a2-111">Die Mitgliedschafts-API umfasst Methoden zum Überprüfen von Anmelde Informationen, zum Abrufen von Informationen über den aktuell angemeldeten Benutzer, zum Erstellen eines neuen Benutzerkontos und zum Löschen eines Benutzerkontos.</span><span class="sxs-lookup"><span data-stu-id="c67a2-111">The Membership API includes methods for validating credentials, retrieving information about the currently logged on user, creating a new user account, and deleting a user account, among others.</span></span> <span data-ttu-id="c67a2-112">Jedes Benutzerkonto im Mitgliedschafts Framework enthält nur die Eigenschaften, die zum Überprüfen von Anmelde Informationen und zum Ausführen wichtiger Benutzerkonto bezogenen Aufgaben erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-112">Each user account in the Membership framework contains only the properties needed for validating credentials and performing essential user account-related tasks.</span></span> <span data-ttu-id="c67a2-113">Dies wird durch die Methoden und Eigenschaften der`MembershipUser`- [Klasse](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)gezeigt, die ein Benutzerkonto im Mitgliedschafts Framework modelliert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-113">This is evidenced by the methods and properties of the [`MembershipUser` class](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which models a user account in the Membership framework.</span></span> <span data-ttu-id="c67a2-114">Diese Klasse verfügt über Eigenschaften wie [`UserName`](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx)und [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx)sowie Methoden wie [`GetPassword`](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) und [`UnlockUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="c67a2-114">This class has properties like [`UserName`](https://msdn.microsoft.com/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/library/system.web.security.membershipuser.email.aspx), and [`IsLockedOut`](https://msdn.microsoft.com/library/system.web.security.membershipuser.islockedout.aspx), and methods like [`GetPassword`](https://msdn.microsoft.com/library/system.web.security.membershipuser.getpassword.aspx) and [`UnlockUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.unlockuser.aspx).</span></span>

<span data-ttu-id="c67a2-115">Oft müssen Anwendungen zusätzliche Benutzerinformationen speichern, die nicht im Mitgliedschafts Framework enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-115">Oftentimes, applications need to store additional user information not included in the Membership framework.</span></span> <span data-ttu-id="c67a2-116">Beispielsweise muss ein Onlinehändler möglicherweise jedem Benutzer die Versand-und abrechnungsadressen, Zahlungsinformationen, Übermittlungs Einstellungen und die Telefonnummer des Kontakts speichern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-116">For example, an online retailer might need to let each user store her shipping and billing addresses, payment information, delivery preferences, and contact phone number.</span></span> <span data-ttu-id="c67a2-117">Außerdem ist jede Bestellung im System einem bestimmten Benutzerkonto zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-117">Furthermore, each order in the system is associated with a particular user account.</span></span>

<span data-ttu-id="c67a2-118">Die `MembershipUser`-Klasse enthält keine Eigenschaften wie `PhoneNumber` oder `DeliveryPreferences` oder `PastOrders`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-118">The `MembershipUser` class does not include properties like `PhoneNumber` or `DeliveryPreferences` or `PastOrders`.</span></span> <span data-ttu-id="c67a2-119">Wie werden die Benutzerinformationen, die von der Anwendung benötigt werden, nachverfolgt und in das Mitgliedschafts Framework integriert?</span><span class="sxs-lookup"><span data-stu-id="c67a2-119">So how do we track the user information needed by the application and have it integrate with the Membership framework?</span></span> <span data-ttu-id="c67a2-120">In diesem Tutorial beantworten wir diese Frage, indem wir eine sehr rudimentäre Gäste Buch Anwendung aufbauen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-120">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="c67a2-121">Dabei werden verschiedene Optionen zum Modellieren von Benutzerinformationen in einer Datenbank erläutert. Anschließend wird erläutert, wie Sie diese Daten den Benutzerkonten zuordnen, die vom Mitgliedschafts Framework erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-121">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="c67a2-122">Fangen wir an!</span><span class="sxs-lookup"><span data-stu-id="c67a2-122">Let's get started!</span></span>

## <a name="step-1-creating-the-guestbook-applications-data-model"></a><span data-ttu-id="c67a2-123">Schritt 1: Erstellen des Datenmodells für die Gäste Buch Anwendung</span><span class="sxs-lookup"><span data-stu-id="c67a2-123">Step 1: Creating the Guestbook Application's Data Model</span></span>

<span data-ttu-id="c67a2-124">Es gibt eine Vielzahl von Verfahren, die zum Erfassen von Benutzerinformationen in einer Datenbank verwendet werden können, und die Sie den Benutzerkonten zuordnen, die durch das Mitgliedschafts Framework erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-124">There are a variety of techniques that can be employed to capture user information in a database and associate it with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="c67a2-125">Um diese Techniken zu veranschaulichen, muss die Tutorial-Webanwendung erweitert werden, damit Sie eine Art Benutzer bezogener Daten erfasst.</span><span class="sxs-lookup"><span data-stu-id="c67a2-125">In order to illustrate these techniques, we will need to augment the tutorial web application so that it captures some sort of user-related data.</span></span> <span data-ttu-id="c67a2-126">(Derzeit enthält das Datenmodell der Anwendung nur die Anwendungs Dienst Tabellen, die vom `SqlMembershipProvider`benötigt werden.)</span><span class="sxs-lookup"><span data-stu-id="c67a2-126">(Currently, the application's data model contains only the application services tables needed by the `SqlMembershipProvider`.)</span></span>

<span data-ttu-id="c67a2-127">Erstellen Sie eine sehr einfache Gäste Buch Anwendung, bei der ein authentifizierter Benutzer einen Kommentar hinterlassen kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-127">Let's create a very simple guestbook application where an authenticated user can leave a comment.</span></span> <span data-ttu-id="c67a2-128">Zusätzlich zum Speichern von Gäste Buch Kommentaren erlauben wir jedem Benutzer, seine Homepage, Homepage und Signatur zu speichern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-128">In addition to storing guestbook comments, let's allow each user to store his home town, homepage, and signature.</span></span> <span data-ttu-id="c67a2-129">Wenn bereitgestellt, werden die Homepage, die Homepage und die Signatur des Benutzers für jede Nachricht angezeigt, die er im Gäste Buch verbleiben muss.</span><span class="sxs-lookup"><span data-stu-id="c67a2-129">If provided, the user's home town, homepage, and signature will appear on each message he has left in the guestbook.</span></span>

### <a name="adding-theguestbookcommentstable"></a><span data-ttu-id="c67a2-130">Hinzufügen der`GuestbookComments`Tabelle</span><span class="sxs-lookup"><span data-stu-id="c67a2-130">Adding the`GuestbookComments`Table</span></span>

<span data-ttu-id="c67a2-131">Um die Gäste Buch Kommentare zu erfassen, müssen wir eine Datenbanktabelle mit dem Namen `GuestbookComments` erstellen, die Spalten wie `CommentId`, `Subject`, `Body`und `CommentDate`enthält.</span><span class="sxs-lookup"><span data-stu-id="c67a2-131">In order to capture the guestbook comments, we need to create a database table named `GuestbookComments` that has columns like `CommentId`, `Subject`, `Body`, and `CommentDate`.</span></span> <span data-ttu-id="c67a2-132">Außerdem muss jeder Datensatz in der `GuestbookComments` Tabelle auf den Benutzer verweisen, der den Kommentar hinterlassen hat.</span><span class="sxs-lookup"><span data-stu-id="c67a2-132">We also need to have each record in the `GuestbookComments` table reference the user who left the comment.</span></span>

<span data-ttu-id="c67a2-133">Um diese Tabelle zur Datenbank hinzuzufügen, wechseln Sie zum Datenbank-Explorer in Visual Studio, und führen Sie einen Drilldown in die `SecurityTutorials` Datenbank aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-133">To add this table to our database, go to the Database Explorer in Visual Studio and drill down into the `SecurityTutorials` database.</span></span> <span data-ttu-id="c67a2-134">Klicken Sie mit der rechten Maustaste auf den Ordner Tabellen, und wählen Sie neue Tabelle hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-134">Right-click on the Tables folder and choose Add New Table.</span></span> <span data-ttu-id="c67a2-135">Dadurch wird eine Schnittstelle geöffnet, mit der wir die Spalten für die neue Tabelle definieren können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-135">This brings up an interface that allows us to define the columns for the new table.</span></span>

<span data-ttu-id="c67a2-136">[![der securitytutorials-Datenbank eine neue Tabelle hinzufügen](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-136">[![Add a New Table to the SecurityTutorials Database](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span></span>

<span data-ttu-id="c67a2-137">**Abbildung 1**: Hinzufügen einer neuen Tabelle zur `SecurityTutorials` Datenbank ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-137">**Figure 1**: Add a New Table to the `SecurityTutorials` Database  ([Click to view full-size image](storing-additional-user-information-vb/_static/image3.png))</span></span>

<span data-ttu-id="c67a2-138">Definieren Sie als nächstes die Spalten des `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-138">Next, define the `GuestbookComments`'s columns.</span></span> <span data-ttu-id="c67a2-139">Fügen Sie zunächst eine Spalte mit dem Namen `CommentId` vom Typ `uniqueidentifier`hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-139">Start by adding a column named `CommentId` of type `uniqueidentifier`.</span></span> <span data-ttu-id="c67a2-140">In dieser Spalte wird jeder Kommentar im Gäste Buch eindeutig identifiziert, sodass keine `NULL` s zugelassen und als Primärschlüssel der Tabelle gekennzeichnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-140">This column will uniquely identify each comment in the guestbook, so disallow `NULL` s and mark it as the table's primary key.</span></span> <span data-ttu-id="c67a2-141">Anstatt einen Wert für das Feld `CommentId` für jede `INSERT`bereitzustellen, können wir angeben, dass ein neuer `uniqueidentifier` Wert automatisch für dieses Feld auf `INSERT` generiert werden soll, indem der Standardwert der Spalte auf `NEWID()`festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-141">Rather than providing a value for the `CommentId` field on each `INSERT`, we can indicate that a new `uniqueidentifier` value should be automatically generated for this field on `INSERT` by setting the column's default value to `NEWID()`.</span></span> <span data-ttu-id="c67a2-142">Nachdem Sie dieses erste Feld hinzugefügt, als Primärschlüssel markiert und seinen Standardwert eingestellt haben, sollte der Bildschirm in etwa wie in Abbildung 2 dargestellt aussehen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-142">After adding this first field, marking it as the primary key, and settings its default value, your screen should look similar to the screen shot shown in Figure 2.</span></span>

<span data-ttu-id="c67a2-143">[![eine primäre Spalte namens "CommentID" hinzufügen.](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-143">[![Add a Primary Column Named CommentId](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span></span>

<span data-ttu-id="c67a2-144">**Abbildung 2**: Hinzufügen einer primären Spalte mit dem Namen `CommentId` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-144">**Figure 2**: Add a Primary Column Named `CommentId` ([Click to view full-size image](storing-additional-user-information-vb/_static/image6.png))</span></span>

<span data-ttu-id="c67a2-145">Fügen Sie als nächstes eine Spalte mit dem Namen `Subject` vom Typ `nvarchar(50)` und eine Spalte mit dem Namen `Body` vom Typ `nvarchar(MAX)`hinzu, wobei `NULL` s in beiden Spalten nicht zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-145">Next, add a column named `Subject` of type `nvarchar(50)` and a column named `Body` of type `nvarchar(MAX)`, disallowing `NULL` s in both columns.</span></span> <span data-ttu-id="c67a2-146">Fügen Sie danach eine Spalte mit dem Namen `CommentDate` vom Typ `datetime`hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-146">Following that, add a column named `CommentDate` of type `datetime`.</span></span> <span data-ttu-id="c67a2-147">Deaktivieren Sie `NULL` s, und legen Sie den Standardwert der `CommentDate` Spalte auf `getdate()`fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-147">Disallow `NULL` s and set the `CommentDate` column's default value to `getdate()`.</span></span>

<span data-ttu-id="c67a2-148">Nur noch müssen Sie eine Spalte hinzufügen, die jedem Gäste Buch Kommentar ein Benutzerkonto zuordnet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-148">All that remains is to add a column that associates a user account with each guestbook comment.</span></span> <span data-ttu-id="c67a2-149">Eine Möglichkeit besteht darin, eine Spalte mit dem Namen `UserName` vom Typ `nvarchar(256)`hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-149">One option would be to add a column named `UserName` of type `nvarchar(256)`.</span></span> <span data-ttu-id="c67a2-150">Dies ist eine geeignete Wahl, wenn Sie einen anderen Mitgliedschafts Anbieter als den `SqlMembershipProvider`verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-150">This is a suitable choice when using a Membership provider other than the `SqlMembershipProvider`.</span></span> <span data-ttu-id="c67a2-151">Wenn Sie die `SqlMembershipProvider`aber in dieser tutorialreihe verwenden, ist die `UserName` Spalte in der `aspnet_Users` Tabelle nicht garantiert eindeutig.</span><span class="sxs-lookup"><span data-stu-id="c67a2-151">But when using the `SqlMembershipProvider`, as we are in this tutorial series, the `UserName` column in the `aspnet_Users` table is not guaranteed to be unique.</span></span> <span data-ttu-id="c67a2-152">Der Primärschlüssel der `aspnet_Users` Tabelle ist `UserId` und hat den Typ `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-152">The `aspnet_Users` table's primary key is `UserId` and is of type `uniqueidentifier`.</span></span> <span data-ttu-id="c67a2-153">Daher benötigt die `GuestbookComments` Tabelle eine Spalte mit dem Namen `UserId` vom Typ `uniqueidentifier` (`NULL` Werte werden nicht zugelassen).</span><span class="sxs-lookup"><span data-stu-id="c67a2-153">Therefore, the `GuestbookComments` table needs a column named `UserId` of type `uniqueidentifier` (disallowing `NULL` values).</span></span> <span data-ttu-id="c67a2-154">Fügen Sie diese Spalte hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-154">Go ahead and add this column.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-155">Wie im Tutorial [*Erstellen des Mitgliedschafts Schemas in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) erläutert, ist das Mitgliedschafts Framework so konzipiert, dass mehrere Webanwendungen mit unterschiedlichen Benutzerkonten denselben Benutzerspeicher gemeinsam nutzen können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-155">As we discussed in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial, the Membership framework is designed to enable multiple web applications with different user accounts to share the same user store.</span></span> <span data-ttu-id="c67a2-156">Dies erfolgt durch Partitionierung von Benutzerkonten in verschiedenen Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-156">It does this by partitioning user accounts into different applications.</span></span> <span data-ttu-id="c67a2-157">Und obwohl jeder Benutzername innerhalb einer Anwendung eindeutig eindeutig ist, kann derselbe Benutzername in verschiedenen Anwendungen verwendet werden, die denselben Benutzerspeicher verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-157">And while each username is guaranteed to be unique within an application, the same username may be used in different applications using the same user store.</span></span> <span data-ttu-id="c67a2-158">Es gibt eine zusammengesetzte `UNIQUE` Einschränkung in der `aspnet_Users` Tabelle der Felder `UserName` und `ApplicationId`, aber nicht nur eines für das `UserName` Feld.</span><span class="sxs-lookup"><span data-stu-id="c67a2-158">There is a composite `UNIQUE` constraint in the `aspnet_Users` table on the `UserName` and `ApplicationId` fields, but not one on just the `UserName` field.</span></span> <span data-ttu-id="c67a2-159">Folglich ist es möglich, dass die ASPNET-\_Benutzertabelle über zwei (oder mehr) Datensätze mit demselben `UserName` Wert verfügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-159">Consequently, it is possible for the aspnet\_Users table to have two (or more) records with the same `UserName` value.</span></span> <span data-ttu-id="c67a2-160">Es gibt jedoch eine `UNIQUE` Einschränkung für das `UserId` Feld der `aspnet_Users` Tabelle (da es sich um den Primärschlüssel handelt).</span><span class="sxs-lookup"><span data-stu-id="c67a2-160">There is, however, a `UNIQUE` constraint on the `aspnet_Users` table's `UserId` field (since it is the primary key).</span></span> <span data-ttu-id="c67a2-161">Eine `UNIQUE` Einschränkung ist wichtig, da keine FOREIGN KEY-Einschränkung zwischen den Tabellen "`GuestbookComments`" und "`aspnet_Users`" hergestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-161">A `UNIQUE` constraint is important because without it we cannot establish a foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables.</span></span>

<span data-ttu-id="c67a2-162">Nachdem Sie die Spalte `UserId` hinzugefügt haben, speichern Sie die Tabelle, indem Sie auf das Symbol Speichern auf der Symbolleiste klicken.</span><span class="sxs-lookup"><span data-stu-id="c67a2-162">After adding the `UserId` column, save the table by clicking on the Save icon in the Toolbar.</span></span> <span data-ttu-id="c67a2-163">Benennen Sie die neue Tabelle `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-163">Name the new table `GuestbookComments`.</span></span>

<span data-ttu-id="c67a2-164">Bei der `GuestbookComments` Tabelle ist ein letztes Problem aufgetreten: Wir müssen eine [Foreign Key-Einschränkung](https://msdn.microsoft.com/library/ms175464.aspx) zwischen der `GuestbookComments.UserId` Spalte und der `aspnet_Users.UserId` Spalte erstellen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-164">We have one last issue to attend to with the `GuestbookComments` table: we need to create a [foreign key constraint](https://msdn.microsoft.com/library/ms175464.aspx) between the `GuestbookComments.UserId` column and the `aspnet_Users.UserId` column.</span></span> <span data-ttu-id="c67a2-165">Um dies zu erreichen, klicken Sie auf das Beziehungs Symbol in der Symbolleiste, um das Dialogfeld Fremdschlüssel Beziehungen aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-165">To achieve this, click the Relationship icon in the Toolbar to launch the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="c67a2-166">(Alternativ können Sie dieses Dialogfeld starten, indem Sie zum Menü Tabellen-Designer wechseln und Beziehungen auswählen.)</span><span class="sxs-lookup"><span data-stu-id="c67a2-166">(Alternatively, you can launch this dialog box by going to the Table Designer menu and choosing Relationships.)</span></span>

<span data-ttu-id="c67a2-167">Klicken Sie unten links im Dialogfeld Fremdschlüssel Beziehungen auf die Schaltfläche hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-167">Click the Add button in the lower left corner of the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="c67a2-168">Dadurch wird eine neue FOREIGN KEY-Einschränkung hinzugefügt, obwohl wir weiterhin die Tabellen definieren müssen, die an der Beziehung beteiligt sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-168">This will add a new foreign key constraint, although we still need to define the tables that participate in the relationship.</span></span>

<span data-ttu-id="c67a2-169">[![das Dialog Feld Fremdschlüssel Beziehungen zum Verwalten der FOREIGN KEY-Einschränkungen einer Tabelle verwenden.](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-169">[![Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span></span>

<span data-ttu-id="c67a2-170">**Abbildung 3**: Verwenden des Dialog Felds Fremdschlüssel Beziehungen zum Verwalten der FOREIGN KEY-Einschränkungen einer Tabelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-170">**Figure 3**: Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints  ([Click to view full-size image](storing-additional-user-information-vb/_static/image9.png))</span></span>

<span data-ttu-id="c67a2-171">Klicken Sie anschließend auf der rechten Seite in der Zeile "Tabellen-und Spalten Spezifikationen" auf das Symbol mit den Auslassungs Punkten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-171">Next, click the ellipses icon in the "Table and Columns Specifications" row on the right.</span></span> <span data-ttu-id="c67a2-172">Dadurch wird das Dialogfeld Tabellen und Spalten geöffnet, in dem wir die Primärschlüssel Tabelle und-Spalte sowie die Fremdschlüssel Spalte aus der `GuestbookComments` Tabelle angeben können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-172">This will launch the Tables and Columns dialog box, from which we can specify the primary key table and column and the foreign key column from the `GuestbookComments` table.</span></span> <span data-ttu-id="c67a2-173">Wählen Sie insbesondere `aspnet_Users` und `UserId` als Primärschlüssel Tabelle und-Spalte aus, und `UserId` aus der `GuestbookComments` Tabelle als Fremdschlüssel Spalte (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="c67a2-173">In particular, select `aspnet_Users` and `UserId` as the primary key table and column, and `UserId` from the `GuestbookComments` table as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="c67a2-174">Nachdem Sie die Primär-und Fremdschlüssel Tabellen und-Spalten definiert haben, klicken Sie auf OK, um zum Dialogfeld Fremdschlüssel Beziehungen zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-174">After defining the primary and foreign key tables and columns, click OK to return to the Foreign Key Relationships dialog box.</span></span>

<span data-ttu-id="c67a2-175">[![eine FOREIGN KEY-Einschränkung zwischen den Tabellen aspnet_Users und guesbookcomments herzustellen.](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-175">[![Establish a Foreign Key Constraint Between the aspnet_Users and GuesbookComments Tables](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span></span>

<span data-ttu-id="c67a2-176">**Abbildung 4**: Einrichten einer FOREIGN KEY-Einschränkung zwischen den Tabellen "`aspnet_Users`" und "`GuesbookComments`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-176">**Figure 4**: Establish a Foreign Key Constraint Between the `aspnet_Users` and `GuesbookComments` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image12.png))</span></span>

<span data-ttu-id="c67a2-177">An diesem Punkt wurde die FOREIGN KEY-Einschränkung eingerichtet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-177">At this point the foreign key constraint has been established.</span></span> <span data-ttu-id="c67a2-178">Wenn diese Einschränkung vorhanden ist, wird die [relationale Integrität](http://en.wikipedia.org/wiki/Referential_integrity) zwischen den beiden Tabellen sichergestellt, indem sichergestellt wird, dass nie ein Gästebucheintrag auf ein nicht vorhandenes Benutzerkonto verweist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-178">The presence of this constraint ensures [relational integrity](http://en.wikipedia.org/wiki/Referential_integrity) between the two tables by guaranteeing that there will never be a guestbook entry referring to a non-existent user account.</span></span> <span data-ttu-id="c67a2-179">Standardmäßig lässt eine FOREIGN KEY-Einschränkung nicht zu, dass ein übergeordneter Datensatz gelöscht wird, wenn entsprechende untergeordnete Datensätze vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-179">By default, a foreign key constraint will disallow a parent record to be deleted if there are corresponding child records.</span></span> <span data-ttu-id="c67a2-180">Das heißt, wenn ein Benutzer einen oder mehrere Gäste Buch Kommentare erstellt und dann versucht, das Benutzerkonto zu löschen, schlägt der Löschvorgang fehl, es sei denn, seine Gäste Buch Kommentare werden zuerst gelöscht.</span><span class="sxs-lookup"><span data-stu-id="c67a2-180">That is, if a user makes one or more guestbook comments, and then we attempt to delete that user account, the delete will fail unless his guestbook comments are deleted first.</span></span>

<span data-ttu-id="c67a2-181">Foreign Key-Einschränkungen können so konfiguriert werden, dass die zugehörigen untergeordneten Datensätze automatisch gelöscht werden, wenn ein übergeordneter Datensatz gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-181">Foreign key constraints can be configured to automatically delete the associated child records when a parent record is deleted.</span></span> <span data-ttu-id="c67a2-182">Anders ausgedrückt: Wir können diese Foreign Key-Einschränkung so einrichten, dass die Gästebucheinträge eines Benutzers automatisch gelöscht werden, wenn Ihr Benutzerkonto gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-182">In other words, we can setup this foreign key constraint so that a user's guestbook entries are automatically deleted when her user account is deleted.</span></span> <span data-ttu-id="c67a2-183">Erweitern Sie hierzu den Abschnitt "INSERT-und Update-Spezifikation", und legen Sie die Eigenschaft "Regel löschen" auf Cascade fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-183">To accomplish this, expand the "INSERT And UPDATE Specification" section and set the "Delete Rule" property to Cascade.</span></span>

<span data-ttu-id="c67a2-184">[![die FOREIGN KEY-Einschränkung So konfigurieren, dass Löschvorgänge gelöscht werden](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-184">[![Configure the Foreign Key Constraint to Cascade Deletes](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span></span>

<span data-ttu-id="c67a2-185">**Abbildung 5**: Konfigurieren der FOREIGN KEY-Einschränkung zum Kaskadieren von Lösch Vorgängen ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-185">**Figure 5**: Configure the Foreign Key Constraint to Cascade Deletes  ([Click to view full-size image](storing-additional-user-information-vb/_static/image15.png))</span></span>

<span data-ttu-id="c67a2-186">Um die FOREIGN KEY-Einschränkung zu speichern, klicken Sie auf die Schaltfläche Schließen, um die Fremdschlüssel Beziehungen zu beenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-186">To save the foreign key constraint, click the Close button to exit out of the Foreign Key Relationships.</span></span> <span data-ttu-id="c67a2-187">Klicken Sie dann auf der Symbolleiste auf das Symbol speichern, um die Tabelle und die Beziehung zu speichern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-187">Then click the Save icon in the Toolbar to save the table and the this relationship.</span></span>

### <a name="storing-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="c67a2-188">Speichern der Homepage, Homepage und Signatur des Benutzers</span><span class="sxs-lookup"><span data-stu-id="c67a2-188">Storing the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="c67a2-189">Die `GuestbookComments` Tabelle veranschaulicht, wie Informationen gespeichert werden, die eine 1: n-Beziehung mit Benutzerkonten gemeinsam haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-189">The `GuestbookComments` table illustrates how to store information that shares a one-to-many relationship with user accounts.</span></span> <span data-ttu-id="c67a2-190">Da jedes Benutzerkonto über eine beliebige Anzahl zugeordneter Kommentare verfügen kann, wird diese Beziehung modelliert, indem eine Tabelle erstellt wird, in der die Kommentare enthalten sind, die eine Spalte enthalten, die jeden Kommentar mit einem bestimmten Benutzer verknüpft.</span><span class="sxs-lookup"><span data-stu-id="c67a2-190">Since each user account may have an arbitrary number of associated comments, this relationship is modeled by creating a table to hold the set of comments that includes a column that links back each comment to a particular user.</span></span> <span data-ttu-id="c67a2-191">Wenn Sie die `SqlMembershipProvider`verwenden, wird dieser Link am besten festgelegt, indem eine Spalte mit dem Namen `UserId` vom Typ `uniqueidentifier` und eine FOREIGN KEY-Einschränkung zwischen dieser Spalte und `aspnet_Users.UserId`erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-191">When using the `SqlMembershipProvider`, this link is best established by creating a column named `UserId` of type `uniqueidentifier` and a foreign key constraint between this column and `aspnet_Users.UserId`.</span></span>

<span data-ttu-id="c67a2-192">Wir müssen nun jedem Benutzerkonto drei Spalten zuordnen, um die Homepage, die Homepage und die Signatur des Benutzers zu speichern, die in seinen Gäste Buch Kommentaren angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-192">We now need to associate three columns with each user account to store the user's home town, homepage, and signature, which will appear in his guestbook comments.</span></span> <span data-ttu-id="c67a2-193">Hierfür gibt es verschiedene Möglichkeiten:</span><span class="sxs-lookup"><span data-stu-id="c67a2-193">There are number of different ways to accomplish this:</span></span>

- <span data-ttu-id="c67a2-194"><strong>Fügen Sie den</strong> Tabellen<strong>`aspnet_Users`</strong> <strong>oder</strong> <strong>`aspnet_Membership`</strong>neue Spalten hinzu <strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="c67a2-194"><strong>Add new columns to the</strong><strong>`aspnet_Users`</strong><strong>or</strong><strong>`aspnet_Membership`</strong><strong>tables.</strong></span></span> <span data-ttu-id="c67a2-195">Diese Vorgehensweise wird nicht empfohlen, da das vom `SqlMembershipProvider`verwendete Schema geändert wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-195">I would not recommend this approach because it modifies the schema used by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="c67a2-196">Diese Entscheidung kann zurückkehren, um Sie auf den Weg zu bringen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-196">This decision may come back to haunt you down the road.</span></span> <span data-ttu-id="c67a2-197">Beispiel: Was ist, wenn in einer zukünftigen Version von ASP.net ein anderes `SqlMembershipProvider` Schema verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-197">For example, what if a future version of ASP.NET uses a different `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="c67a2-198">Microsoft kann ein Tool zum Migrieren der ASP.NET 2,0-`SqlMembershipProvider` Daten zum neuen Schema enthalten. Wenn Sie jedoch das Schema "ASP.NET 2,0 `SqlMembershipProvider`" geändert haben, ist eine solche Konvertierung möglicherweise nicht möglich.</span><span class="sxs-lookup"><span data-stu-id="c67a2-198">Microsoft may include a tool to migrate the ASP.NET 2.0 `SqlMembershipProvider` data to the new schema, but if you have modified the ASP.NET 2.0 `SqlMembershipProvider` schema, such a conversion may not be possible.</span></span>

- <span data-ttu-id="c67a2-199">**Verwenden Sie ASP. Das Profil Framework von NET, das eine Profil Eigenschaft für die Homepage, die Homepage und die Signatur definiert.**</span><span class="sxs-lookup"><span data-stu-id="c67a2-199">**Use ASP.NET's Profile framework, defining a profile property for the home town, homepage, and signature.**</span></span> <span data-ttu-id="c67a2-200">ASP.NET enthält ein Profil Framework, das zum Speichern zusätzlicher Benutzer spezifischer Daten konzipiert ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-200">ASP.NET includes a Profile framework that is designed to store additional user-specific data.</span></span> <span data-ttu-id="c67a2-201">Wie das Mitgliedschafts Framework wird das Profil Framework über das Anbieter Modell erstellt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-201">Like the Membership framework, the Profile framework is built atop the provider model.</span></span> <span data-ttu-id="c67a2-202">Der .NET Framework wird mit einem `SqlProfileProvider` ausgeliefert, der Profildaten in einer SQL Server-Datenbank speichert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-202">The .NET Framework ships with a `SqlProfileProvider` that stores profile data in a SQL Server database.</span></span> <span data-ttu-id="c67a2-203">Tatsächlich verfügt unsere Datenbank bereits über die Tabelle, die vom `SqlProfileProvider` (`aspnet_Profile`) verwendet wird, da Sie hinzugefügt wurde, als wir die Anwendungsdienste wieder in das Tutorial [*Erstellen des Mitgliedschafts Schemas in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) eingefügt haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-203">In fact, our database already has the table used by the `SqlProfileProvider` (`aspnet_Profile`), as it was added when we added the application services back in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial.</span></span>   
  <span data-ttu-id="c67a2-204">Der Hauptvorteil des Profil-Frameworks besteht darin, dass Entwickler die Profil Eigenschaften in `Web.config` definieren können – es muss kein Code geschrieben werden, um die Profildaten in den und aus dem zugrunde liegenden Datenspeicher zu serialisieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-204">The main benefit of the Profile framework is that it allows for developers to define the profile properties in `Web.config` – no code needs to be written to serialize the profile data to and from the underlying data store.</span></span> <span data-ttu-id="c67a2-205">Kurz gesagt, ist es unglaublich einfach, einen Satz von Profil Eigenschaften zu definieren und mit Ihnen im Code zu arbeiten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-205">In short, it is incredibly easy to define a set of profile properties and to work with them in code.</span></span> <span data-ttu-id="c67a2-206">Das Profilsystem bleibt jedoch bei der Versionsverwaltung sehr viel zu wünschen. Wenn Sie also eine Anwendung haben, in der Sie erwarten, dass neue benutzerspezifische Eigenschaften zu einem späteren Zeitpunkt hinzugefügt werden, oder wenn vorhandene vorhanden sind, die entfernt oder geändert werden sollen, ist das Profil Framework möglicherweise nicht das  beste Option.</span><span class="sxs-lookup"><span data-stu-id="c67a2-206">However, the Profile system leaves a lot to be desired when it comes to versioning, so if you have an application where you expect new user-specific properties to be added at a later time, or existing ones to be removed or modified, then the Profile framework may not be the best option.</span></span> <span data-ttu-id="c67a2-207">Darüber hinaus speichert der `SqlProfileProvider` die Profil Eigenschaften in einer streng denormalisierten Weise, sodass es nicht möglich ist, Abfragen direkt für die Profildaten auszuführen (z. b., wie viele Benutzer eine Heim Stadt von New York haben).</span><span class="sxs-lookup"><span data-stu-id="c67a2-207">Moreover, the `SqlProfileProvider` stores the profile properties in a highly denormalized fashion, making it next to impossible to run queries directly against the profile data (such as, how many users have a home town of New York).</span></span>   
  <span data-ttu-id="c67a2-208">Weitere Informationen zum Profil Framework finden Sie im Abschnitt "Weitere Messwerte" am Ende dieses Tutorials.</span><span class="sxs-lookup"><span data-stu-id="c67a2-208">For more information on the Profile framework, consult the "Further Readings" section at the end of this tutorial.</span></span>

- <span data-ttu-id="c67a2-209"><strong>Fügen Sie diese drei Spalten einer neuen Tabelle in der-Datenbank hinzu, und richten Sie eine 1:1-Beziehung zwischen dieser Tabelle und</strong> <strong>`aspnet_Users`</strong>ein <strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="c67a2-209"><strong>Add these three columns to a new table in the database and establish a one-to-one relationship between this table and</strong><strong>`aspnet_Users`</strong><strong>.</strong></span></span> <span data-ttu-id="c67a2-210">Diese Vorgehensweise umfasst etwas mehr Arbeit als das Profil Framework, bietet jedoch maximale Flexibilität bei der Modellierung der zusätzlichen Benutzereigenschaften in der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="c67a2-210">This approach involves a bit more work than with the Profile framework, but offers maximum flexibility in how the additional user properties are modeled in the database.</span></span> <span data-ttu-id="c67a2-211">Dies ist die Option, die in diesem Tutorial verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-211">This is the option we will use in this tutorial.</span></span>

<span data-ttu-id="c67a2-212">Wir erstellen eine neue Tabelle namens "`UserProfiles`", um die Homepage, die Homepage und die Signatur für jeden Benutzer zu speichern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-212">We will create a new table called `UserProfiles` to save the home town, homepage, and signature for each user.</span></span> <span data-ttu-id="c67a2-213">Klicken Sie im Fenster Datenbank-Explorer mit der rechten Maustaste auf den Ordner Tabellen, und wählen Sie die Option zum Erstellen einer neuen Tabelle aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-213">Right-click on the Tables folder in the Database Explorer window and choose to create a new table.</span></span> <span data-ttu-id="c67a2-214">Benennen Sie die erste Spalte `UserId` und legen Sie deren Typ auf `uniqueidentifier`fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-214">Name the first column `UserId` and set its type to `uniqueidentifier`.</span></span> <span data-ttu-id="c67a2-215">Lassen Sie `NULL` Werte nicht zu, und markieren Sie die Spalte als Primärschlüssel.</span><span class="sxs-lookup"><span data-stu-id="c67a2-215">Disallow `NULL` values and mark the column as a primary key.</span></span> <span data-ttu-id="c67a2-216">Fügen Sie als nächstes Spalten mit dem Namen: `HomeTown` vom Typ `nvarchar(50)`; hinzu. `HomepageUrl` vom Typ `nvarchar(100)`; und Signatur vom Typ `nvarchar(500)`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-216">Next, add columns named: `HomeTown` of type `nvarchar(50)`; `HomepageUrl` of type `nvarchar(100)`; and Signature of type `nvarchar(500)`.</span></span> <span data-ttu-id="c67a2-217">Jede dieser drei Spalten kann einen `NULL` Wert akzeptieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-217">Each of these three columns can accept a `NULL` value.</span></span>

<span data-ttu-id="c67a2-218">[Erstellen der Tabelle "userprofiles" ![](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-218">[![Create the UserProfiles Table](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span></span>

<span data-ttu-id="c67a2-219">**Abbildung 6**: Erstellen der `UserProfiles` Tabelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-219">**Figure 6**: Create the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image18.png))</span></span>

<span data-ttu-id="c67a2-220">Speichern Sie die Tabelle, und benennen Sie Sie `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-220">Save the table and name it `UserProfiles`.</span></span> <span data-ttu-id="c67a2-221">Richten Sie schließlich eine FOREIGN KEY-Einschränkung zwischen dem `UserId` Feld der `UserProfiles` Tabelle und dem `aspnet_Users.UserId` Feld ein.</span><span class="sxs-lookup"><span data-stu-id="c67a2-221">Lastly, establish a foreign key constraint between the `UserProfiles` table's `UserId` field and the `aspnet_Users.UserId` field.</span></span> <span data-ttu-id="c67a2-222">Wie bei der FOREIGN KEY-Einschränkung zwischen den Tabellen "`GuestbookComments`" und "`aspnet_Users`" wird diese Einschränkung gelöscht.</span><span class="sxs-lookup"><span data-stu-id="c67a2-222">As we did with the foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables, have this constraint cascade deletes.</span></span> <span data-ttu-id="c67a2-223">Da das `UserId`-Feld in `UserProfiles` der Primärschlüssel ist, wird dadurch sichergestellt, dass für jedes Benutzerkonto nicht mehr als ein Datensatz in der `UserProfiles`-Tabelle vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-223">Since the `UserId` field in `UserProfiles` is the primary key, this ensures that there will be no more than one record in the `UserProfiles` table for each user account.</span></span> <span data-ttu-id="c67a2-224">Dieser Beziehungstyp wird als eins-zu-eins bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-224">This type of relationship is referred to as one-to-one.</span></span>

<span data-ttu-id="c67a2-225">Nachdem wir nun das Datenmodell erstellt haben, können wir es verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-225">Now that we have the data model created, we are ready to use it.</span></span> <span data-ttu-id="c67a2-226">In den Schritten 2 und 3 wird erläutert, wie der aktuell angemeldete Benutzer seine Homepage-, Homepage-und Signatur Informationen anzeigen und bearbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-226">In Steps 2 and 3 we will look at how the currently logged on user can view and edit their home town, homepage, and signature information.</span></span> <span data-ttu-id="c67a2-227">In Schritt 4 erstellen wir die Schnittstelle für authentifizierte Benutzer, um neue Kommentare an das Gäste Buch zu senden und die vorhandenen anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-227">In Step 4 we will create the interface for authenticated users to submit new comments to the guestbook and view the existing ones.</span></span>

## <a name="step-2-displaying-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="c67a2-228">Schritt 2: Anzeigen der Homepage, der Startseite und der Signatur des Benutzers</span><span class="sxs-lookup"><span data-stu-id="c67a2-228">Step 2: Displaying the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="c67a2-229">Es gibt eine Vielzahl von Möglichkeiten, den derzeit angemeldeten Benutzer zu gestatten, seine Homepage, Homepage und Signatur Informationen anzuzeigen und zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-229">There are a variety of ways to allow the currently logged on user to view and edit his home town, homepage, and signature information.</span></span> <span data-ttu-id="c67a2-230">Wir könnten die Benutzeroberfläche manuell mit den Steuerelementen "TextBox" und "Label" erstellen, oder Sie können eines der datenweb Steuerelemente verwenden, z. b. das DetailsView-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="c67a2-230">We could manually create the user interface with TextBox and Label controls or we could use one of the data Web controls, such as the DetailsView control.</span></span> <span data-ttu-id="c67a2-231">Um die Daten Bank `SELECT` und `UPDATE` Anweisungen auszuführen, können wir ADO.NET-Code in der Code Behind-Klasse unserer Seite schreiben oder alternativ einen deklarativen Ansatz mit SqlDataSource einsetzen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-231">To perform the database `SELECT` and `UPDATE` statements we could write ADO.NET code in our page's code-behind class or, alternatively, employ a declarative approach with the SqlDataSource.</span></span> <span data-ttu-id="c67a2-232">Im Idealfall würde unsere Anwendung eine mehrstufige Architektur enthalten, die entweder Programm gesteuert aus der Code Behind-Klasse der Seite oder deklarativ über das ObjectDataSource-Steuerelement aufgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-232">Ideally our application would contain a tiered architecture, which we could either invoke programmatically from the page's code-behind class or declaratively via the ObjectDataSource control.</span></span>

<span data-ttu-id="c67a2-233">Da sich diese tutorialreihe auf Formular Authentifizierung, Autorisierung, Benutzerkonten und Rollen konzentriert, wird eine gründliche Erörterung dieser unterschiedlichen Datenzugriffs Optionen oder Gründe für die direkte Ausführung von SQL-Anweisungen durch eine mehrstufige Architektur bevorzugt. auf der Seite ASP.net.</span><span class="sxs-lookup"><span data-stu-id="c67a2-233">Since this tutorial series focuses on forms authentication, authorization, user accounts, and roles, there will not be a thorough discussion of these different data access options or why a tiered architecture is preferred over executing SQL statements directly from the ASP.NET page.</span></span> <span data-ttu-id="c67a2-234">Ich werde Ihnen die Verwendung von DetailsView und SqlDataSource – die schnellste und einfachste Option – erläutern, aber die erörterten Konzepte können sicherlich auch auf Alternative websteuer Elemente und Datenzugriffs Logik angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-234">I am going to walk through using a DetailsView and SqlDataSource – the quickest and easiest option – but the concepts discussed can certainly be applied to alternative Web controls and data access logic.</span></span> <span data-ttu-id="c67a2-235">Weitere Informationen zum Arbeiten mit Daten in ASP.net finden Sie in der tutorialreihe *[Arbeiten mit Daten in ASP.NET 2,0](../../data-access/index.md)* .</span><span class="sxs-lookup"><span data-stu-id="c67a2-235">For more information on working with data in ASP.NET, refer to my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series.</span></span>

<span data-ttu-id="c67a2-236">Öffnen Sie die Seite `AdditionalUserInfo.aspx` im Ordner `Membership`, und fügen Sie der Seite ein DetailsView-Steuerelement hinzu, indem Sie die Eigenschaft ID auf `UserProfile` festlegen und deren `Width`-und `Height` Eigenschaften löschen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-236">Open the `AdditionalUserInfo.aspx` page in the `Membership` folder and add a DetailsView control to the page, setting its ID property to `UserProfile` and clearing out its `Width` and `Height` properties.</span></span> <span data-ttu-id="c67a2-237">Erweitern Sie das Smarttag der DetailsView, und binden Sie es an ein neues Datenquellen-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="c67a2-237">Expand the DetailsView's Smart Tag and choose to bind it to a new data source control.</span></span> <span data-ttu-id="c67a2-238">Dadurch wird der Assistent zum Konfigurieren von Datenquellen gestartet (siehe Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="c67a2-238">This will launch the DataSource Configuration Wizard (see Figure 7).</span></span> <span data-ttu-id="c67a2-239">Im ersten Schritt werden Sie aufgefordert, den Daten Quellentyp anzugeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-239">The first step asks you to specify the data source type.</span></span> <span data-ttu-id="c67a2-240">Da wir direkt eine Verbindung mit der `SecurityTutorials`-Datenbank herstellen werden, wählen Sie das Daten Bank Symbol aus, und geben Sie die `ID` als `UserProfileDataSource`an.</span><span class="sxs-lookup"><span data-stu-id="c67a2-240">Since we are going to connect directly to the `SecurityTutorials` database, choose the Database icon, specifying the `ID` as `UserProfileDataSource`.</span></span>

<span data-ttu-id="c67a2-241">[![ein neues SqlDataSource-Steuerelement mit dem Namen userprofiledatasource hinzufügen.](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-241">[![Add a New SqlDataSource Control Named UserProfileDataSource](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span></span>

<span data-ttu-id="c67a2-242">**Abbildung 7**: Hinzufügen eines neuen SqlDataSource-Steuer Elements namens `UserProfileDataSource` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-242">**Figure 7**: Add a New SqlDataSource Control Named `UserProfileDataSource` ([Click to view full-size image](storing-additional-user-information-vb/_static/image21.png))</span></span>

<span data-ttu-id="c67a2-243">Im nächsten Bildschirm werden Sie aufgefordert, die Datenbank zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-243">The next screen prompts for the database to use.</span></span> <span data-ttu-id="c67a2-244">Wir haben bereits eine Verbindungs Zeichenfolge in `Web.config` für die `SecurityTutorials`-Datenbank definiert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-244">We have already defined a connection string in `Web.config` for the `SecurityTutorials` database.</span></span> <span data-ttu-id="c67a2-245">Der Name der Verbindungs Zeichenfolge – `SecurityTutorialsConnectionString` – sollte in der Dropdown Liste enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="c67a2-245">This connection string name – `SecurityTutorialsConnectionString` – should be in the drop-down list.</span></span> <span data-ttu-id="c67a2-246">Wählen Sie diese Option aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c67a2-246">Select this option and click Next.</span></span>

<span data-ttu-id="c67a2-247">[Wählen Sie in der Dropdown Liste ![securitytutorialsconnectionstring aus.](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-247">[![Choose SecurityTutorialsConnectionString from the Drop-Down List](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span></span>

<span data-ttu-id="c67a2-248">**Abbildung 8**: Auswählen von `SecurityTutorialsConnectionString` in der Dropdown Liste ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-248">**Figure 8**: Choose `SecurityTutorialsConnectionString` from the Drop-Down List  ([Click to view full-size image](storing-additional-user-information-vb/_static/image24.png))</span></span>

<span data-ttu-id="c67a2-249">Der nachfolgende Bildschirm fordert Sie auf, die abzufragende Tabelle und die Spalten anzugeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-249">The subsequent screen asks us to specify the table and columns to query.</span></span> <span data-ttu-id="c67a2-250">Wählen Sie in der Dropdown Liste die `UserProfiles` Tabelle aus, und überprüfen Sie alle Spalten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-250">Choose the `UserProfiles` table from the drop-down list and check all of the columns.</span></span>

<span data-ttu-id="c67a2-251">[![alle Spalten aus der Tabelle "userprofiles" zurück.](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-251">[![Bring Back All of the Columns from the UserProfiles Table](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span></span>

<span data-ttu-id="c67a2-252">**Abbildung 9**: zurückziehen aller Spalten aus der `UserProfiles` Tabelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-252">**Figure 9**: Bring Back All of the Columns from the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image27.png))</span></span>

<span data-ttu-id="c67a2-253">Die aktuelle Abfrage in Abbildung 9 gibt *alle* Datensätze in `UserProfiles`zurück, aber wir interessieren uns nur für den aktuell angemeldeten Benutzereintrag.</span><span class="sxs-lookup"><span data-stu-id="c67a2-253">The current query in Figure 9 returns *all* of the records in `UserProfiles`, but we are only interested in the currently logged on user's record.</span></span> <span data-ttu-id="c67a2-254">Um eine `WHERE`-Klausel hinzuzufügen, klicken Sie auf die Schaltfläche `WHERE`, um das Dialogfeld `WHERE` Klausel hinzufügen anzuzeigen (siehe Abbildung 10).</span><span class="sxs-lookup"><span data-stu-id="c67a2-254">To add a `WHERE` clause, click the `WHERE` button to bring up the Add `WHERE` Clause dialog box (see Figure 10).</span></span> <span data-ttu-id="c67a2-255">Hier können Sie die Spalte auswählen, nach der gefiltert werden soll, den Operator und die Quelle des Filter Parameters.</span><span class="sxs-lookup"><span data-stu-id="c67a2-255">Here you can select the column to filter on, the operator, and the source of the filter parameter.</span></span> <span data-ttu-id="c67a2-256">Wählen Sie `UserId` als Spalte und "=" als Operator aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-256">Select `UserId` as the column and "=" as the Operator.</span></span>

<span data-ttu-id="c67a2-257">Leider gibt es keine integrierte Parameter Quelle, um den `UserId` Wert des aktuell angemeldeten Benutzers zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-257">Unfortunately there is no built-in parameter source to return the currently logged on user's `UserId` value.</span></span> <span data-ttu-id="c67a2-258">Dieser Wert muss Programm gesteuert verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-258">We will need to grab this value programmatically.</span></span> <span data-ttu-id="c67a2-259">Legen Sie daher die Dropdown Liste Quelle auf "None" fest. Klicken Sie auf die Schaltfläche hinzufügen, um den Parameter hinzuzufügen, und klicken Sie dann auf OK.</span><span class="sxs-lookup"><span data-stu-id="c67a2-259">Therefore, set the Source drop-down list to "None," click the Add button to add the parameter, and then click OK.</span></span>

<span data-ttu-id="c67a2-260">[![einen Filter Parameter in der Spalte "UserID" hinzufügen.](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-260">[![Add a Filter Parameter on the UserId Column](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span></span>

<span data-ttu-id="c67a2-261">**Abbildung 10**: Hinzufügen eines Filter Parameters in der Spalte "`UserId`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-261">**Figure 10**: Add a Filter Parameter on the `UserId` Column  ([Click to view full-size image](storing-additional-user-information-vb/_static/image30.png))</span></span>

<span data-ttu-id="c67a2-262">Nachdem Sie auf OK geklickt haben, wird der Bildschirm zurückgegeben, der in Abbildung 9 angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-262">After clicking OK you will be returned to the screen shown in Figure 9.</span></span> <span data-ttu-id="c67a2-263">Die SQL-Abfrage unten auf dem Bildschirm sollte jedoch eine `WHERE`-Klausel enthalten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-263">This time, however, the SQL query at the bottom of the screen should include a `WHERE` clause.</span></span> <span data-ttu-id="c67a2-264">Klicken Sie auf Weiter, um zum Bildschirm "Test Abfrage" zu gelangen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-264">Click Next to move on to the "Test Query" screen.</span></span> <span data-ttu-id="c67a2-265">Hier können Sie die Abfrage ausführen und die Ergebnisse anzeigen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-265">Here you can run the query and see the results.</span></span> <span data-ttu-id="c67a2-266">Klicken Sie auf Fertig stellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-266">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="c67a2-267">Nach dem Abschließen des Assistenten zum Konfigurieren von Datenquellen erstellt Visual Studio das SqlDataSource-Steuerelement basierend auf den im Assistenten angegebenen Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-267">Upon completing the DataSource Configuration Wizard, Visual Studio creates the SqlDataSource control based on the settings specified in the wizard.</span></span> <span data-ttu-id="c67a2-268">Darüber hinaus fügt Sie der DetailsView für jede Spalte, die von der `SelectCommand`von SqlDataSource zurückgegeben wird, "boundfields" manuell hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-268">Moreover, it manually adds BoundFields to the DetailsView for each column returned by the SqlDataSource's `SelectCommand`.</span></span> <span data-ttu-id="c67a2-269">Es ist nicht erforderlich, das Feld "`UserId`" in der DetailsView anzuzeigen, da der Benutzer diesen Wert nicht kennen muss.</span><span class="sxs-lookup"><span data-stu-id="c67a2-269">There's no need to show the `UserId` field in the DetailsView, since the user does not need to know this value.</span></span> <span data-ttu-id="c67a2-270">Sie können dieses Feld direkt aus dem deklarativen Markup des DetailsView-Steuer Elements entfernen oder durch Klicken auf den Link "Felder bearbeiten" aus dem Smarttag.</span><span class="sxs-lookup"><span data-stu-id="c67a2-270">You can remove this field directly from the DetailsView control's declarative markup or by clicking the "Edit Fields" link from its Smart Tag.</span></span>

<span data-ttu-id="c67a2-271">An diesem Punkt sollte das deklarative Markup der Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="c67a2-271">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample1.aspx)]

<span data-ttu-id="c67a2-272">Der `UserId`-Parameter des SqlDataSource-Steuer Elements muss Programm gesteuert auf den `UserId` des aktuell angemeldeten Benutzers festgelegt werden, bevor die Daten ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-272">We need to programmatically set the SqlDataSource control's `UserId` parameter to the currently logged in user's `UserId` before the data is selected.</span></span> <span data-ttu-id="c67a2-273">Dies kann erreicht werden, indem ein Ereignishandler für das `Selecting` Ereignis von SqlDataSource erstellt und dort der folgende Code hinzugefügt wird:</span><span class="sxs-lookup"><span data-stu-id="c67a2-273">This can be accomplished by creating an event handler for the SqlDataSource's `Selecting` event and adding the following code there:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample2.vb)]

<span data-ttu-id="c67a2-274">Der obige Code beginnt mit dem Abrufen eines Verweises auf den aktuell angemeldeten Benutzer durch Aufrufen der `GetUser`-Methode der `Membership`-Klasse.</span><span class="sxs-lookup"><span data-stu-id="c67a2-274">The above code starts by obtaining a reference to the currently logged on user by calling the `Membership` class's `GetUser` method.</span></span> <span data-ttu-id="c67a2-275">Dadurch wird ein `MembershipUser` Objekt zurückgegeben, dessen `ProviderUserKey`-Eigenschaft die `UserId`enthält.</span><span class="sxs-lookup"><span data-stu-id="c67a2-275">This returns a `MembershipUser` object, whose `ProviderUserKey` property contains the `UserId`.</span></span> <span data-ttu-id="c67a2-276">Der `UserId` Wert wird dann dem `@UserId` Parameter von SqlDataSource zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-276">The `UserId` value is then assigned to the SqlDataSource's `@UserId` parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-277">Die `Membership.GetUser()`-Methode gibt Informationen über den aktuell angemeldeten Benutzer zurück.</span><span class="sxs-lookup"><span data-stu-id="c67a2-277">The `Membership.GetUser()` method returns information about the currently logged on user.</span></span> <span data-ttu-id="c67a2-278">Wenn ein anonymer Benutzer die Seite besucht, wird der Wert `Nothing`zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-278">If an anonymous user is visiting the page, it will return a value of `Nothing`.</span></span> <span data-ttu-id="c67a2-279">In einem solchen Fall führt dies zu einer `NullReferenceException` in der folgenden Codezeile, wenn versucht wird, die `ProviderUserKey`-Eigenschaft zu lesen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-279">In such a case, this will lead to a `NullReferenceException` on the following line of code when attempting to read the `ProviderUserKey` property.</span></span> <span data-ttu-id="c67a2-280">Natürlich müssen Sie sich keine Gedanken darüber machen, `Membership.GetUser()` auf der `AdditionalUserInfo.aspx` Seite nichts zurückgibt, da wir die URL-Autorisierung in einem vorherigen Tutorial konfiguriert haben, damit nur authentifizierte Benutzer auf die ASP.NET-Ressourcen in diesem Ordner zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-280">Of course, we don't have to worry about `Membership.GetUser()` returning Nothing in the `AdditionalUserInfo.aspx` page because we configured URL authorization in a previous tutorial so that only authenticated users could access the ASP.NET resources in this folder.</span></span> <span data-ttu-id="c67a2-281">Wenn Sie auf einer Seite mit dem anonymen Zugriff auf Informationen über den aktuell angemeldeten Benutzer zugreifen müssen, stellen Sie sicher, dass das `MembershipUser` Objekt, das von der `GetUser()`-Methode zurückgegeben wurde, vor dem verweisen auf seine Eigenschaften nicht auf nichts festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-281">If you need to access information about the currently logged on user in a page where anonymous access is permitted, make sure to check that the `MembershipUser` object returned from the `GetUser()` method is not Nothing before referencing its properties.</span></span>

<span data-ttu-id="c67a2-282">Wenn Sie die `AdditionalUserInfo.aspx` Seite über einen Browser besuchen, wird eine leere Seite angezeigt, da wir der `UserProfiles` Tabelle noch Zeilen hinzufügen müssen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-282">If you visit the `AdditionalUserInfo.aspx` page through a browser you will see a blank page because we have yet to add any rows to the `UserProfiles` table.</span></span> <span data-ttu-id="c67a2-283">In Schritt 6 wird erläutert, wie das Steuerelement "kreateuserwizard" so angepasst wird, dass der `UserProfiles` Tabelle automatisch eine neue Zeile hinzugefügt wird, wenn ein neues Benutzerkonto erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-283">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span> <span data-ttu-id="c67a2-284">Vorerst müssen wir jedoch manuell einen Datensatz in der Tabelle erstellen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-284">For now, however, we will need to manually create a record in the table.</span></span>

<span data-ttu-id="c67a2-285">Navigieren Sie zum Datenbank-Explorer in Visual Studio, und erweitern Sie den Ordner Tabellen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-285">Navigate to the Database Explorer in Visual Studio and expand the Tables folder.</span></span> <span data-ttu-id="c67a2-286">Klicken Sie mit der rechten Maustaste auf die `aspnet_Users` Tabelle, und wählen Sie "Tabellendaten anzeigen", um die Datensätze in der Tabelle anzuzeigen. Führen Sie die gleichen Schritte für die `UserProfiles` Tabelle aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-286">Right-click on the `aspnet_Users` table and choose "Show Table Data" to see the records in the table; do the same thing for the `UserProfiles` table.</span></span> <span data-ttu-id="c67a2-287">Abbildung 11 zeigt diese Ergebnisse, wenn Sie vertikal nebeneinander angeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-287">Figure 11 shows these results when tiled vertically.</span></span> <span data-ttu-id="c67a2-288">In meiner Datenbank gibt es zurzeit `aspnet_Users` Datensätze für Bruce, Fred und Tito, aber keine Datensätze in der `UserProfiles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="c67a2-288">In my database there are currently `aspnet_Users` records for Bruce, Fred, and Tito, but no records in the `UserProfiles` table.</span></span>

<span data-ttu-id="c67a2-289">[![werden die Inhalte der Tabellen "aspnet_Users" und "userprofiles" angezeigt.](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-289">[![The Contents of the aspnet_Users and UserProfiles Tables are Displayed](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span></span>

<span data-ttu-id="c67a2-290">**Abbildung 11**: der Inhalt der Tabellen "`aspnet_Users`" und "`UserProfiles`" wird angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-290">**Figure 11**: The Contents of the `aspnet_Users` and `UserProfiles` Tables are Displayed  ([Click to view full-size image](storing-additional-user-information-vb/_static/image33.png))</span></span>

<span data-ttu-id="c67a2-291">Fügen Sie der `UserProfiles` Tabelle einen neuen Datensatz hinzu, indem Sie die Werte für die Felder `HomeTown`, `HomepageUrl`und `Signature` manuell eingeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-291">Add a new record to the `UserProfiles` table by manually typing in values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span> <span data-ttu-id="c67a2-292">Die einfachste Möglichkeit, einen gültigen `UserId` Wert im neuen `UserProfiles` Datensatz zu erhalten, besteht darin, das Feld `UserId` aus einem bestimmten Benutzerkonto in der `aspnet_Users` Tabelle auszuwählen und es in `UserId` zu kopieren und in `UserProfiles`Feld einzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-292">The easiest way to get a valid `UserId` value in the new `UserProfiles` record is to select the `UserId` field from a particular user account in the `aspnet_Users` table and copy and paste it into the `UserId` field in `UserProfiles`.</span></span> <span data-ttu-id="c67a2-293">In Abbildung 12 wird die `UserProfiles` Tabelle angezeigt, nachdem für Bruce ein neuer Datensatz hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="c67a2-293">Figure 12 shows the `UserProfiles` table after a new record has been added for Bruce.</span></span>

<span data-ttu-id="c67a2-294">[der Benutzerprofile für Bruce wurde ![ein Datensatz hinzugefügt.](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-294">[![A Record was Added to UserProfiles for Bruce](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span></span>

<span data-ttu-id="c67a2-295">**Abbildung 12**: ein Datensatz wurde `UserProfiles` für Bruce hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-295">**Figure 12**: A Record was Added to `UserProfiles` for Bruce  ([Click to view full-size image](storing-additional-user-information-vb/_static/image36.png))</span></span>

<span data-ttu-id="c67a2-296">Kehren Sie zum `AdditionalUserInfo.aspx page`zurück, das als "Bruce" angemeldet ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-296">Return to the `AdditionalUserInfo.aspx page`, logged in as Bruce.</span></span> <span data-ttu-id="c67a2-297">Siehe Abbildung 13 zeigt, dass die Einstellungen von Bruce angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-297">As Figure 13 shows, Bruce's settings are displayed.</span></span>

<span data-ttu-id="c67a2-298">[![dem aktuell besuchten Benutzer werden seine Einstellungen angezeigt.](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-298">[![The Currently Visiting User is Shown His Settings](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span></span>

<span data-ttu-id="c67a2-299">**Abbildung 13**: der aktuell besuchte Benutzer zeigt seine Einstellungen an ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-299">**Figure 13**: The Currently Visiting User is Shown His Settings  ([Click to view full-size image](storing-additional-user-information-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-300">Fügen Sie der `UserProfiles` Tabelle für jeden Mitgliedschafts Benutzer manuell Datensätze hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-300">Go ahead and manually add records in the `UserProfiles` table for each Membership user.</span></span> <span data-ttu-id="c67a2-301">In Schritt 6 wird erläutert, wie das Steuerelement "kreateuserwizard" so angepasst wird, dass der `UserProfiles` Tabelle automatisch eine neue Zeile hinzugefügt wird, wenn ein neues Benutzerkonto erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-301">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span>

## <a name="step-3-allowing-the-user-to-edit-his-home-town-homepage-and-signature"></a><span data-ttu-id="c67a2-302">Schritt 3: zulassen, dass der Benutzer seine Homepage, Homepage und Signatur bearbeitet</span><span class="sxs-lookup"><span data-stu-id="c67a2-302">Step 3: Allowing the User to Edit His Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="c67a2-303">An diesem Punkt kann der aktuell angemeldete Benutzer seine Homepage, die Homepage und die Signatur Einstellung anzeigen, Sie aber noch nicht ändern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-303">At this point the currently logged in user can view their home town, homepage, and signature setting, but they cannot yet modify them.</span></span> <span data-ttu-id="c67a2-304">Wir aktualisieren das DetailsView-Steuerelement, damit die Daten bearbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-304">Let's update the DetailsView control so that the data can be edited.</span></span>

<span data-ttu-id="c67a2-305">Als erstes müssen wir eine `UpdateCommand` für SqlDataSource hinzufügen und dabei die auszuführende `UPDATE` Anweisung und die entsprechenden Parameter angeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-305">The first thing we need to do is add an `UpdateCommand` for the SqlDataSource, specifying the `UPDATE` statement to execute and its corresponding parameters.</span></span> <span data-ttu-id="c67a2-306">Wählen Sie die SqlDataSource aus, und klicken Sie im Eigenschaftenfenster auf die Auslassungs Punkte neben der UpdateQuery-Eigenschaft, um das Dialogfeld Befehls-und Parameter-Editor aufzurufende.</span><span class="sxs-lookup"><span data-stu-id="c67a2-306">Select the SqlDataSource and, from the Properties window, click on the ellipses next to the UpdateQuery property to bring up the Command and Parameter Editor dialog box.</span></span> <span data-ttu-id="c67a2-307">Geben Sie die folgende `UPDATE`-Anweisung in das Textfeld ein:</span><span class="sxs-lookup"><span data-stu-id="c67a2-307">Enter the following `UPDATE` statement into the textbox:</span></span>

[!code-sql[Main](storing-additional-user-information-vb/samples/sample3.sql)]

<span data-ttu-id="c67a2-308">Klicken Sie anschließend auf die Schaltfläche "Parameter aktualisieren", die für jeden Parameter in der `UPDATE` Anweisung einen Parameter in der `UpdateParameters`-Sammlung des SqlDataSource-Steuer Elements erstellt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-308">Next, click the "Refresh Parameters" button, which will create a parameter in the SqlDataSource control's `UpdateParameters` collection for each of the parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="c67a2-309">Lassen Sie die Quelle für alle Parameter auf None festgelegt, und klicken Sie auf die Schaltfläche OK, um das Dialogfeld abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-309">Leave the source for all of the parameters set to None and click the OK button to complete the dialog box.</span></span>

<span data-ttu-id="c67a2-310">[![den UpdateCommand und UpdateParameters von SqlDataSource angeben](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-310">[![Specify the SqlDataSource's UpdateCommand and UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span></span>

<span data-ttu-id="c67a2-311">**Abbildung 14**: Angeben der `UpdateCommand` und `UpdateParameters` von SqlDataSource ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-311">**Figure 14**: Specify the SqlDataSource's `UpdateCommand` and `UpdateParameters` ([Click to view full-size image](storing-additional-user-information-vb/_static/image42.png))</span></span>

<span data-ttu-id="c67a2-312">Aufgrund der Ergänzungen, die wir am SqlDataSource-Steuerelement vorgenommen haben, kann das DetailsView-Steuerelement jetzt die Bearbeitung unterstützen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-312">Due to the additions we made to the SqlDataSource control, the DetailsView control can now support editing.</span></span> <span data-ttu-id="c67a2-313">Aktivieren Sie das Kontrollkästchen "Bearbeitung aktivieren" aus dem Smarttag der DetailsView.</span><span class="sxs-lookup"><span data-stu-id="c67a2-313">From the DetailsView's Smart Tag, check the "Enable Editing" checkbox.</span></span> <span data-ttu-id="c67a2-314">Dadurch wird der `Fields`-Auflistung des Steuer Elements ein CommandField hinzugefügt, dessen `ShowEditButton`-Eigenschaft auf true festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-314">This adds a CommandField to the control's `Fields` collection with its `ShowEditButton` property set to True.</span></span> <span data-ttu-id="c67a2-315">Dadurch wird eine Bearbeitungs Schaltfläche gerendert, wenn die DetailsView im schreibgeschützten Modus angezeigt wird und die Schaltflächen aktualisieren und Abbrechen, wenn Sie im Bearbeitungsmodus angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-315">This renders an Edit button when the DetailsView is displayed in read-only mode and Update and Cancel buttons when displayed in edit mode.</span></span> <span data-ttu-id="c67a2-316">Anstatt dass der Benutzer auf "Bearbeiten" klicken muss, kann die DetailsView in einem "immer bearbeitbaren" Zustand dargestellt werden, indem die [`DefaultMode`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) des DetailsView-Steuer Elements auf "`Edit`" festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-316">Rather than requiring the user to click Edit, though, we can have the DetailsView render in an "always editable" state by setting the DetailsView control's [`DefaultMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) to `Edit`.</span></span>

<span data-ttu-id="c67a2-317">Mit diesen Änderungen sollte das deklarative Markup Ihres DetailsView-Steuer Elements in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="c67a2-317">With these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample4.aspx)]

<span data-ttu-id="c67a2-318">Beachten Sie das Hinzufügen von CommandField und der `DefaultMode`-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c67a2-318">Note the addition of the CommandField and the `DefaultMode` property.</span></span>

<span data-ttu-id="c67a2-319">Testen Sie diese Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="c67a2-319">Go ahead and test this page through a browser.</span></span> <span data-ttu-id="c67a2-320">Beim Besuch eines Benutzers, der über einen entsprechenden Datensatz in `UserProfiles`verfügt, werden die Einstellungen des Benutzers in einer editierbaren Schnittstelle angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-320">When visiting with a user that has a corresponding record in `UserProfiles`, the user's settings are displayed in an editable interface.</span></span>

<span data-ttu-id="c67a2-321">[![DetailsView eine bearbeitbare Schnittstelle rendert](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-321">[![The DetailsView Renders an Editable Interface](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span></span>

<span data-ttu-id="c67a2-322">**Abbildung 15**: die DetailsView rendert eine bearbeitbare Schnittstelle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-322">**Figure 15**: The DetailsView Renders an Editable Interface  ([Click to view full-size image](storing-additional-user-information-vb/_static/image45.png))</span></span>

<span data-ttu-id="c67a2-323">Ändern Sie die Werte, und klicken Sie auf die Schaltfläche Aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-323">Try changing the values and clicking the Update button.</span></span> <span data-ttu-id="c67a2-324">Es wird angezeigt, als ob nichts passiert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-324">It appears as if nothing happens.</span></span> <span data-ttu-id="c67a2-325">Es gibt ein Postback, und die Werte werden in der Datenbank gespeichert, aber es gibt kein visuelles Feedback, dass der Speicher aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-325">There is a postback and the values are saved to the database, but there's no visual feedback that the save occurred.</span></span>

<span data-ttu-id="c67a2-326">Um dies zu beheben, kehren Sie zu Visual Studio zurück, und fügen Sie ein Label-Steuerelement oberhalb der DetailsView hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-326">To remedy this, return to Visual Studio and add a Label control above the DetailsView.</span></span> <span data-ttu-id="c67a2-327">Legen Sie den `ID` auf `SettingsUpdatedMessage`, seine `Text`-Eigenschaft auf "Ihre Einstellungen wurden aktualisiert" und dessen `Visible` und `EnableViewState` Eigenschaften auf `False`fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-327">Set its `ID` to `SettingsUpdatedMessage`, its `Text` property to "Your settings have been updated," and its `Visible` and `EnableViewState` properties to `False`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample5.aspx)]

<span data-ttu-id="c67a2-328">Wir müssen die `SettingsUpdatedMessage` Bezeichnung immer dann anzeigen, wenn die DetailsView aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-328">We need to display the `SettingsUpdatedMessage` Label whenever the DetailsView is updated.</span></span> <span data-ttu-id="c67a2-329">Erstellen Sie hierzu einen Ereignishandler für das `ItemUpdated`-Ereignis der DetailsView, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="c67a2-329">To accomplish this, create an event handler for the DetailsView's `ItemUpdated` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample6.vb)]

<span data-ttu-id="c67a2-330">Kehren Sie über einen Browser zur Seite `AdditionalUserInfo.aspx` zurück, und aktualisieren Sie die Daten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-330">Return to the `AdditionalUserInfo.aspx` page through a browser and update the data.</span></span> <span data-ttu-id="c67a2-331">Dieses Mal wird eine hilfreiche Statusmeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-331">This time, a helpful status message is displayed.</span></span>

<span data-ttu-id="c67a2-332">[![eine kurze Meldung angezeigt wird, wenn die Einstellungen aktualisiert werden.](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-332">[![A Short Message is Displayed When the Settings are Updated](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span></span>

<span data-ttu-id="c67a2-333">**Abbildung 16**: eine kurze Meldung wird angezeigt, wenn die Einstellungen aktualisiert werden ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-333">**Figure 16**: A Short Message is Displayed When the Settings are Updated  ([Click to view full-size image](storing-additional-user-information-vb/_static/image48.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-334">Die Bearbeitungs Schnittstelle des DetailsView-Steuer Elements lässt sich sehr viel wünschen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-334">The DetailsView control's editing interface leaves a lot to be desired.</span></span> <span data-ttu-id="c67a2-335">Es verwendet Textfelder mit Standardgröße, das Signatur Feld sollte jedoch wahrscheinlich ein mehrzeilige Textfeld sein.</span><span class="sxs-lookup"><span data-stu-id="c67a2-335">It uses standard-sized textboxes, but the Signature field should probably be a multi-line textbox.</span></span> <span data-ttu-id="c67a2-336">Ein RegularExpressionValidator sollte verwendet werden, um sicherzustellen, dass die URL der Startseite, sofern eingegeben, mit "http://" oder "https://" beginnt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-336">A RegularExpressionValidator should be used to ensure that the homepage URL, if entered, starts with "http://" or "https://".</span></span> <span data-ttu-id="c67a2-337">Da für das DetailsView-Steuerelement die `DefaultMode`-Eigenschaft auf `Edit`festgelegt ist, führt die Schaltfläche Abbrechen keine Aktion aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-337">Moreover, since the DetailsView control has its `DefaultMode` property set to `Edit`, the Cancel button does not do anything.</span></span> <span data-ttu-id="c67a2-338">Er sollte entweder entfernt werden, oder der Benutzer wird, wenn er darauf geklickt hat, an eine andere Seite umgeleitet (z. b. `~/Default.aspx`).</span><span class="sxs-lookup"><span data-stu-id="c67a2-338">It should either be removed or, when clicked, redirect the user to some other page (such as `~/Default.aspx`).</span></span> <span data-ttu-id="c67a2-339">Ich lasse diese Verbesserungen als Übung für den Reader aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-339">I leave these enhancements as an exercise for the reader.</span></span>

### <a name="adding-a-link-to-theadditionaluserinfoaspxpage-in-the-master-page"></a><span data-ttu-id="c67a2-340">Hinzufügen eines Links zur Seite "`AdditionalUserInfo.aspx`" in der Master Seite</span><span class="sxs-lookup"><span data-stu-id="c67a2-340">Adding a Link to the`AdditionalUserInfo.aspx`Page in the Master Page</span></span>

<span data-ttu-id="c67a2-341">Derzeit stellt die Website keine Verknüpfungen zur Seite `AdditionalUserInfo.aspx` bereit.</span><span class="sxs-lookup"><span data-stu-id="c67a2-341">Currently, the website does not provide any links to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="c67a2-342">Die einzige Möglichkeit, Sie zu erreichen, besteht darin, die URL der Seite direkt in die Adressleiste des Browsers einzugeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-342">The only way to reach it is to enter the page's URL directly into the browser's Address bar.</span></span> <span data-ttu-id="c67a2-343">Fügen Sie auf der Seite "`Site.master` Master" einen Link zu dieser Seite hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-343">Let's add a link to this page in the `Site.master` master page.</span></span>

<span data-ttu-id="c67a2-344">Beachten Sie, dass die Master Seite ein LoginView-websteuer Element in der `LoginContent` contentplachalter enthält, das unterschiedliche Markup für authentifizierte und anonyme Besucher anzeigt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-344">Recall that the master page contains a LoginView Web control in its `LoginContent` ContentPlaceHolder that displays different markup for authenticated and anonymous visitors.</span></span> <span data-ttu-id="c67a2-345">Aktualisieren Sie das `LoggedInTemplate` des LoginView-Steuer Elements, um einen Link zur `AdditionalUserInfo.aspx` Seite einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-345">Update the LoginView control's `LoggedInTemplate` to include a link to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="c67a2-346">Nachdem Sie diese Änderungen vorgenommen haben, sollte das deklarative Markup des LoginView-Steuer Elements in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="c67a2-346">After making these changes the LoginView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample7.aspx)]

<span data-ttu-id="c67a2-347">Beachten Sie das Hinzufügen des `lnkUpdateSettings` Hyperlink-Steuer Elements zum `LoggedInTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-347">Note the addition of the `lnkUpdateSettings` HyperLink control to the `LoggedInTemplate`.</span></span> <span data-ttu-id="c67a2-348">Mit diesem Link können authentifizierte Benutzer schnell zu der Seite springen, um Ihre Home-, Homepage-und Signatur Einstellungen anzuzeigen und zu ändern.</span><span class="sxs-lookup"><span data-stu-id="c67a2-348">With this link in place, authenticated users can quickly jump to the page to view and modify their home town, homepage, and signature settings.</span></span>

## <a name="step-4-adding-new-guestbook-comments"></a><span data-ttu-id="c67a2-349">Schritt 4: Hinzufügen neuer Gäste Buch Kommentare</span><span class="sxs-lookup"><span data-stu-id="c67a2-349">Step 4: Adding New Guestbook Comments</span></span>

<span data-ttu-id="c67a2-350">Auf der `Guestbook.aspx` Seite können authentifizierte Benutzer das Gäste Buch anzeigen und einen Kommentar hinterlassen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-350">The `Guestbook.aspx` page is where authenticated users can view the guestbook and leave a comment.</span></span> <span data-ttu-id="c67a2-351">Beginnen wir mit dem Erstellen der-Schnittstelle, um neue Gäste Buch Kommentare hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-351">Let's start with creating the interface to add new guestbook comments.</span></span>

<span data-ttu-id="c67a2-352">Öffnen Sie die Seite "`Guestbook.aspx`" in Visual Studio, und erstellen Sie eine Benutzeroberfläche, die aus zwei TextBox-Steuerelementen besteht, eine für den Betreff des neuen Kommentars und eine für den Text.</span><span class="sxs-lookup"><span data-stu-id="c67a2-352">Open the `Guestbook.aspx` page in Visual Studio and construct a user interface consisting of two TextBox controls, one for the new comment's subject and one for its body.</span></span> <span data-ttu-id="c67a2-353">Legen Sie die `ID`-Eigenschaft des ersten TextBox-Steuer Elements auf `Subject` und dessen `Columns`-Eigenschaft auf 40 fest. Legen Sie den `ID` für das auf `Body`, dessen `TextMode` auf `MultiLine`und seine `Width`-und `Rows`-Eigenschaften auf "95%" bzw. 8 fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-353">Set the first TextBox control's `ID` property to `Subject` and its `Columns` property to 40; set second's `ID` to `Body`, its `TextMode` to `MultiLine`, and its `Width` and `Rows` properties to "95%" and 8, respectively.</span></span> <span data-ttu-id="c67a2-354">Um die Benutzeroberfläche abzuschließen, fügen Sie ein Schaltflächen-websteuer Element mit dem Namen `PostCommentButton` hinzu, und legen Sie dessen `Text`-Eigenschaft auf "Post your comment"</span><span class="sxs-lookup"><span data-stu-id="c67a2-354">To complete the user interface, add a Button Web control named `PostCommentButton` and set its `Text` property to "Post Your Comment".</span></span>

<span data-ttu-id="c67a2-355">Da für jeden Gäste Buch Kommentar ein Betreff und Text erforderlich ist, fügen Sie für jedes der Textfelder ein "Requirements dfieldvalidator"-Element hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-355">Since each guestbook comment requires a subject and body, add a RequiredFieldValidator for each of the TextBoxes.</span></span> <span data-ttu-id="c67a2-356">Legen Sie die `ValidationGroup`-Eigenschaft dieser Steuerelemente auf "entercomment" fest. Ebenso legen Sie die `ValidationGroup`-Eigenschaft des `PostCommentButton`-Steuer Elements auf "entercomment" fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-356">Set the `ValidationGroup` property of these controls to "EnterComment"; likewise, set the `PostCommentButton` control's `ValidationGroup` property to "EnterComment".</span></span> <span data-ttu-id="c67a2-357">Weitere Informationen zu ASP. Die Validierungs Steuerelemente von NET, Auschecken der [Formular Validierung in ASP.net](http://www.4guysfromrolla.com/webtech/090200-1.shtml), über [Lagern der Validierungs Steuerelemente in ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)und des [Tutorials zur Validierung von Server Steuerelementen](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) auf [W3Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="c67a2-357">For more information on ASP.NET's validation controls, check out [Form Validation in ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx), and the [Validation Server Controls Tutorial](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) on [W3Schools](http://www.w3schools.com/).</span></span>

<span data-ttu-id="c67a2-358">Nach dem Erstellen der Benutzeroberfläche sollte das deklarative Markup der Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="c67a2-358">After crafting the user interface your page's declarative markup should look something like the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample8.aspx)]

<span data-ttu-id="c67a2-359">Wenn die Benutzeroberfläche fertig ist, besteht die nächste Aufgabe darin, einen neuen Datensatz in die `GuestbookComments` Tabelle einzufügen, wenn auf die `PostCommentButton` geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-359">With the user interface complete, our next task is to insert a new record into the `GuestbookComments` table when the `PostCommentButton` is clicked.</span></span> <span data-ttu-id="c67a2-360">Dies kann auf verschiedene Weise erreicht werden: Wir können ADO.NET-Code in den `Click`-Ereignishandler der Schaltfläche schreiben. Wir können der Seite ein SqlDataSource-Steuerelement hinzufügen, dessen `InsertCommand`konfigurieren und dann seine `Insert`-Methode aus dem `Click`-Ereignishandler aufzurufen. oder wir könnten eine mittlere Ebene erstellen, die für das Einfügen neuer Gäste Buch Kommentare verantwortlich ist, und diese Funktionalität aus dem `Click`-Ereignishandler aufrufen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-360">This can be accomplished in a number of ways: we can write ADO.NET code in the Button's `Click` event handler; we can add a SqlDataSource control to the page, configure its `InsertCommand`, and then call its `Insert` method from the `Click` event handler; or we could build a middle tier that was responsible for inserting new guestbook comments, and invoke this functionality from the `Click` event handler.</span></span> <span data-ttu-id="c67a2-361">Da wir uns in Schritt 3 mit der Verwendung von SqlDataSource beschäftigt haben, verwenden wir hier ADO.NET-Code.</span><span class="sxs-lookup"><span data-stu-id="c67a2-361">Since we looked at using a SqlDataSource in Step 3, let's use ADO.NET code here.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-362">Die ADO.NET-Klassen, die für den programmgesteuerten Zugriff auf Daten aus einer Microsoft SQL Server Datenbank verwendet werden, befinden sich im `System.Data.SqlClient`-Namespace.</span><span class="sxs-lookup"><span data-stu-id="c67a2-362">The ADO.NET classes used to programmatically access data from a Microsoft SQL Server database are located in the `System.Data.SqlClient` namespace.</span></span> <span data-ttu-id="c67a2-363">Möglicherweise müssen Sie diesen Namespace in die Code Behind-Klasse Ihrer Seite importieren (z. b. `Imports System.Data.SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="c67a2-363">You may need to import this namespace into your page's code-behind class (i.e., `Imports System.Data.SqlClient`).</span></span>

<span data-ttu-id="c67a2-364">Erstellen Sie einen Ereignishandler für das `Click` Ereignis des `PostCommentButton`, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="c67a2-364">Create an event handler for the `PostCommentButton`'s `Click` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample9.vb)]

<span data-ttu-id="c67a2-365">Der `Click` Ereignishandler prüft zunächst, ob die vom Benutzer bereitgestellten Daten gültig sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-365">The `Click` event handler starts by checking that the user-supplied data is valid.</span></span> <span data-ttu-id="c67a2-366">Wenn dies nicht der Fall ist, wird der Ereignishandler beendet, bevor ein Datensatz eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-366">If it is not, the event handler exits before inserting a record.</span></span> <span data-ttu-id="c67a2-367">Wenn die angegebenen Daten gültig sind, wird der `UserId` Wert des aktuell angemeldeten Benutzers abgerufen und in der `currentUserId` lokalen Variablen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-367">Assuming the supplied data is valid, the currently logged on user's `UserId` value is retrieved and stored in the `currentUserId` local variable.</span></span> <span data-ttu-id="c67a2-368">Dieser Wert ist erforderlich, da beim Einfügen eines Datensatzes in `GuestbookComments`ein `UserId` Wert angegeben werden muss.</span><span class="sxs-lookup"><span data-stu-id="c67a2-368">This value is needed because we must supply a `UserId` value when inserting a record into `GuestbookComments`.</span></span>

<span data-ttu-id="c67a2-369">Danach wird die Verbindungs Zeichenfolge für die `SecurityTutorials`-Datenbank aus `Web.config` abgerufen, und die `INSERT` SQL-Anweisung wird angegeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-369">Following that, the connection string for the `SecurityTutorials` database is retrieved from `Web.config` and the `INSERT` SQL statement is specified.</span></span> <span data-ttu-id="c67a2-370">Anschließend wird ein `SqlConnection` Objekt erstellt und geöffnet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-370">A `SqlConnection` object is then created and opened.</span></span> <span data-ttu-id="c67a2-371">Als nächstes wird ein `SqlCommand` Objekt erstellt, und die Werte für die Parameter, die in der `INSERT` Abfrage verwendet werden, werden zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-371">Next, a `SqlCommand` object is constructed and the values for the parameters used in the `INSERT` query are assigned.</span></span> <span data-ttu-id="c67a2-372">Die `INSERT`-Anweisung wird dann ausgeführt, und die Verbindung wurde geschlossen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-372">The `INSERT` statement is then executed and the connection closed.</span></span> <span data-ttu-id="c67a2-373">Am Ende des Ereignis Handlers werden die `Text` Eigenschaften der `Subject` und `Body` Textfelder gelöscht, sodass die Werte des Benutzers nicht über das Postback hinweg beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-373">At the end of the event handler, the `Subject` and `Body` TextBoxes' `Text` properties are cleared out so that the user's values are not persisted across the postback.</span></span>

<span data-ttu-id="c67a2-374">Testen Sie diese Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="c67a2-374">Go ahead and test out this page in a browser.</span></span> <span data-ttu-id="c67a2-375">Da sich diese Seite im `Membership` Ordner befindet, ist Sie für anonyme Besucher nicht zugänglich.</span><span class="sxs-lookup"><span data-stu-id="c67a2-375">Since this page is in the `Membership` folder it is not accessible to anonymous visitors.</span></span> <span data-ttu-id="c67a2-376">Daher müssen Sie sich zuerst anmelden (sofern Sie dies noch nicht getan haben).</span><span class="sxs-lookup"><span data-stu-id="c67a2-376">Therefore, you will need to first log on (if you have not already).</span></span> <span data-ttu-id="c67a2-377">Geben Sie in die Textfelder `Subject` und `Body` einen Wert ein, und klicken Sie auf die Schaltfläche `PostCommentButton`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-377">Enter a value into the `Subject` and `Body` TextBoxes and click the `PostCommentButton` button.</span></span> <span data-ttu-id="c67a2-378">Dadurch wird `GuestbookComments`ein neuer Datensatz hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-378">This will cause a new record to be added to `GuestbookComments`.</span></span> <span data-ttu-id="c67a2-379">Beim Postback werden der von Ihnen angegebene Betreff und der Text aus den Textfeldern gelöscht.</span><span class="sxs-lookup"><span data-stu-id="c67a2-379">On postback, the subject and body you provided are wiped from the TextBoxes.</span></span>

<span data-ttu-id="c67a2-380">Nachdem Sie auf die `PostCommentButton` Schaltfläche geklickt haben, ist kein visuelles Feedback vorhanden, dass der Kommentar dem Gäste Buch hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="c67a2-380">After clicking the `PostCommentButton` button there is no visual feedback that the comment was added to the guestbook.</span></span> <span data-ttu-id="c67a2-381">Wir müssen diese Seite dennoch aktualisieren, damit Sie die vorhandenen Gäste Buch Kommentare anzeigt, die wir in Schritt 5 ausführen werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-381">We still need to update this page to display the existing guestbook comments, which we will do in Step 5.</span></span> <span data-ttu-id="c67a2-382">Nachdem wir dies erreicht haben, wird der soeben hinzugefügte Kommentar in der Liste der Kommentare angezeigt, der entsprechendes visuelles Feedback bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-382">Once we accomplish that, the just-added comment will appear in the list of comments, providing adequate visual feedback.</span></span> <span data-ttu-id="c67a2-383">Vergewissern Sie sich vorerst, dass Ihr Gäste Buch Kommentar gespeichert wurde, indem Sie den Inhalt der `GuestbookComments` Tabelle untersuchen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-383">For now, confirm that your guestbook comment was saved by examining the contents of the `GuestbookComments` table.</span></span>

<span data-ttu-id="c67a2-384">In Abbildung 17 wird der Inhalt der `GuestbookComments` Tabelle angezeigt, nachdem zwei Kommentare verbleiben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-384">Figure 17 shows the contents of the `GuestbookComments` table after two comments have been left.</span></span>

<span data-ttu-id="c67a2-385">[![Sie die Gäste Buch Kommentare in der Tabelle guestbookcomments sehen.](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-385">[![You Can See the Guestbook Comments in the GuestbookComments Table](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span></span>

<span data-ttu-id="c67a2-386">**Abbildung 17**: die Gäste Buch Kommentare werden in der `GuestbookComments` Tabelle angezeigt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-386">**Figure 17**: You Can See the Guestbook Comments in the `GuestbookComments` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image51.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-387">Wenn ein Benutzer versucht, einen Gäste Buch Kommentar einzufügen, der potenziell gefährliche Markup – wie z. b. html – enthält, löst ASP.net eine `HttpRequestValidationException`aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-387">If a user attempts to insert a guestbook comment that contains potentially dangerous markup – such as HTML – ASP.NET will throw an `HttpRequestValidationException`.</span></span> <span data-ttu-id="c67a2-388">Weitere Informationen zu dieser Ausnahme, warum Sie ausgelöst wird und wie Sie zulassen, dass Benutzer potenziell gefährliche Werte einreichen, finden Sie im [Whitepaper zur Anforderungs Validierung](../../../../whitepapers/request-validation.md).</span><span class="sxs-lookup"><span data-stu-id="c67a2-388">To learn more about this exception, why it's thrown, and how to permit users to submit potentially dangerous values, consult the [Request Validation Whitepaper](../../../../whitepapers/request-validation.md).</span></span>

## <a name="step-5-listing-the-existing-guestbook-comments"></a><span data-ttu-id="c67a2-389">Schritt 5: Auflisten der vorhandenen Gäste Buch Kommentare</span><span class="sxs-lookup"><span data-stu-id="c67a2-389">Step 5: Listing the Existing Guestbook Comments</span></span>

<span data-ttu-id="c67a2-390">Zusätzlich zum hinterlassen von Kommentaren sollte ein Benutzer, der die `Guestbook.aspx` Seite besucht, auch die vorhandenen Kommentare des Gästebuchs anzeigen können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-390">In addition to leaving comments, a user visiting the `Guestbook.aspx` page should also be able to view the guestbook's existing comments.</span></span> <span data-ttu-id="c67a2-391">Fügen Sie zu diesem Zweck dem unteren Rand der Seite ein ListView-Steuerelement mit dem Namen `CommentList` hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-391">To accomplish this, add a ListView control named `CommentList` to the bottom of the page.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-392">Das ListView-Steuerelement ist neu in ASP.net, Version 3,5.</span><span class="sxs-lookup"><span data-stu-id="c67a2-392">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="c67a2-393">Es wurde entwickelt, um eine Liste von Elementen in einem sehr anpassbaren und flexiblen Layout anzuzeigen, bietet aber trotzdem integrierte Bearbeitungs-, Einfüge-, Lösch-, Paging-und Sortierungs Funktionen wie die GridView.</span><span class="sxs-lookup"><span data-stu-id="c67a2-393">It is designed to display a list of items in a very customizable and flexible layout, yet still offer built-in editing, inserting, deleting, paging, and sorting functionality like the GridView.</span></span> <span data-ttu-id="c67a2-394">Wenn Sie ASP.NET 2,0 verwenden, müssen Sie stattdessen das DataList-Steuerelement oder das Repeater-Steuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-394">If you are using ASP.NET 2.0, you will need to use the DataList or Repeater control instead.</span></span> <span data-ttu-id="c67a2-395">Weitere Informationen zur Verwendung von ListView finden Sie im Blogeintrag von [Scott Guthrie](https://weblogs.asp.net/scottgu/), [dem ASP: ListView-Steuer](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)Element und meinem Artikel zum [Anzeigen von Daten mit dem ListView-Steuer](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)Element.</span><span class="sxs-lookup"><span data-stu-id="c67a2-395">For more information on using the ListView, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [The asp:ListView Control](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx), and my article, [Displaying Data with the ListView Control](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>

<span data-ttu-id="c67a2-396">Öffnen Sie das Smarttag von ListView, und binden Sie das Steuerelement aus der Dropdown Liste Datenquelle auswählen an eine neue Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="c67a2-396">Open the ListView's Smart Tag and, from the Choose Data Source drop-down list, bind the control to a new data source.</span></span> <span data-ttu-id="c67a2-397">Wie in Schritt 2 gezeigt, wird der Assistent zum Konfigurieren von Datenquellen gestartet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-397">As we saw in Step 2, this will launch the Data Source Configuration Wizard.</span></span> <span data-ttu-id="c67a2-398">Wählen Sie das Daten Bank Symbol aus, benennen Sie das resultierende SqlDataSource-`CommentsDataSource`, und klicken Sie auf OK.</span><span class="sxs-lookup"><span data-stu-id="c67a2-398">Select the Database icon, name the resulting SqlDataSource `CommentsDataSource`, and click OK.</span></span> <span data-ttu-id="c67a2-399">Wählen Sie als nächstes die `SecurityTutorialsConnectionString` Verbindungs Zeichenfolge aus der Dropdown Liste aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c67a2-399">Next, select the `SecurityTutorialsConnectionString` connection string from the drop-down list and click Next.</span></span>

<span data-ttu-id="c67a2-400">An dieser Stelle in Schritt 2 haben wir die abzufragende Daten angegeben, indem wir die `UserProfiles` Tabelle aus der Dropdown Liste auswählen und die Spalten auswählen, die zurückgegeben werden sollen (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="c67a2-400">At this point in Step 2 we specified the data to query by picking the `UserProfiles` table from the drop-down list and selecting the columns to return (refer back to Figure 9).</span></span> <span data-ttu-id="c67a2-401">Diesmal möchten wir jedoch eine SQL-Anweisung erstellen, die nicht nur die Datensätze aus `GuestbookComments`abruft, sondern auch die Homepage, die Homepage, die Signatur und den Benutzernamen des kommentners.</span><span class="sxs-lookup"><span data-stu-id="c67a2-401">This time, however, we want to craft a SQL statement that pulls back not only the records from `GuestbookComments`, but also the commenter's home town, homepage, signature, and username.</span></span> <span data-ttu-id="c67a2-402">Wählen Sie daher die Options Schaltfläche "benutzerdefinierte SQL-Anweisung oder gespeicherte Prozedur angeben" aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="c67a2-402">Therefore, select the "Specify a custom SQL statement or stored procedure" radio button and click Next.</span></span>

<span data-ttu-id="c67a2-403">Dadurch wird der Bildschirm "benutzerdefinierte Anweisungen oder gespeicherte Prozeduren definieren" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-403">This will bring up the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="c67a2-404">Klicken Sie auf die Schaltfläche Abfrage-Generator, um die Abfrage grafisch zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-404">Click the Query Builder button to graphically build the query.</span></span> <span data-ttu-id="c67a2-405">Der Abfrage-Generator beginnt mit der Aufforderung, die Tabellen anzugeben, von denen Abfragen ausgeführt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-405">The Query Builder starts by prompting us to specify the tables we want to query from.</span></span> <span data-ttu-id="c67a2-406">Wählen Sie die Tabellen `GuestbookComments`, `UserProfiles`und `aspnet_Users` aus, und klicken Sie auf OK.</span><span class="sxs-lookup"><span data-stu-id="c67a2-406">Select the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables and click OK.</span></span> <span data-ttu-id="c67a2-407">Dadurch werden alle drei Tabellen zur Entwurfs Oberfläche hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-407">This will add all three tables to the design surface.</span></span> <span data-ttu-id="c67a2-408">Da es unter den Tabellen `GuestbookComments`, `UserProfiles`und `aspnet_Users` Foreign Key-Einschränkungen gibt, `JOIN` die Abfrage-Generator diese Tabellen automatisch.</span><span class="sxs-lookup"><span data-stu-id="c67a2-408">Since there are foreign key constraints amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables, the Query Builder automatically `JOIN` s these tables.</span></span>

<span data-ttu-id="c67a2-409">Sie müssen nur noch die Spalten angeben, die zurückgegeben werden sollen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-409">All that remains is to specify the columns to return.</span></span> <span data-ttu-id="c67a2-410">Wählen Sie in der `GuestbookComments` Tabelle die Spalten `Subject`, `Body`und `CommentDate` aus. Gibt die Spalten `HomeTown`, `HomepageUrl`und `Signature` aus der `UserProfiles` Tabelle zurück. und geben `UserName` aus `aspnet_Users`zurück.</span><span class="sxs-lookup"><span data-stu-id="c67a2-410">From the `GuestbookComments` table select the `Subject`, `Body`, and `CommentDate` columns; return the `HomeTown`, `HomepageUrl`, and `Signature` columns from the `UserProfiles` table; and return `UserName` from `aspnet_Users`.</span></span> <span data-ttu-id="c67a2-411">Fügen Sie dem Ende der `SELECT` Abfrage außerdem "`ORDER BY CommentDate DESC`" hinzu, damit die letzten Beiträge zuerst zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-411">Also, add "`ORDER BY CommentDate DESC`" to the end of the `SELECT` query so that the most recent posts are returned first.</span></span> <span data-ttu-id="c67a2-412">Nachdem Sie diese Auswahl getroffen haben, sollte die Abfrage-Generator-Schnittstelle ähnlich wie der Screenshot in Abbildung 18 aussehen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-412">After making these selections, your Query Builder interface should look similar to the screen shot in Figure 18.</span></span>

<span data-ttu-id="c67a2-413">[![die erstellte Abfrage mit den Tabellen guestbookcomments, userprofiles und aspnet_Users verbunden ist.](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-413">[![The Constructed Query JOINs the GuestbookComments, UserProfiles, and aspnet_Users Tables](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span></span>

<span data-ttu-id="c67a2-414">**Abbildung 18**: die erstellte Abfrage `JOIN` s die Tabellen "`GuestbookComments`", "`UserProfiles`" und "`aspnet_Users`" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-414">**Figure 18**: The Constructed Query `JOIN` s the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image54.png))</span></span>

<span data-ttu-id="c67a2-415">Klicken Sie auf OK, um das Fenster Abfrage-Generator zu schließen und zum Bildschirm "benutzerdefinierte Anweisungen oder gespeicherte Prozeduren definieren" zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-415">Click OK to close the Query Builder window and return to the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="c67a2-416">Klicken Sie auf Weiter, um zum Bildschirm "Test Abfrage" zu gelangen. dort können Sie die Abfrageergebnisse anzeigen, indem Sie auf die Schaltfläche Test Abfrage klicken.</span><span class="sxs-lookup"><span data-stu-id="c67a2-416">Click Next to advance to the "Test Query" screen, where you may view the query results by clicking the Test Query button.</span></span> <span data-ttu-id="c67a2-417">Wenn Sie fertig sind, klicken Sie auf Fertigstellen, um den Assistenten zum Konfigurieren von Datenquellen abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-417">When you're ready, click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="c67a2-418">Wenn wir den Assistenten zum Konfigurieren von Datenquellen in Schritt 2 abgeschlossen haben, wurde die `Fields` Auflistung des zugeordneten DetailsView-Steuer Elements aktualisiert und enthält nun ein BoundField für jede Spalte, die vom `SelectCommand`zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="c67a2-418">When we completed the Configure Data Source wizard in Step 2, the associated DetailsView control's `Fields` collection was updated to include a BoundField for each column returned by the `SelectCommand`.</span></span> <span data-ttu-id="c67a2-419">Die ListView bleibt jedoch unverändert. Wir müssen weiterhin das Layout definieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-419">The ListView, however, remains unchanged; we still need to define its layout.</span></span> <span data-ttu-id="c67a2-420">Das ListView-Layout kann manuell über sein deklaratives Markup oder die Option "ListView konfigurieren" im Smarttags erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-420">The ListView's layout can be constructed manually through its declarative markup or from the "Configure ListView" option in its Smart Tag.</span></span> <span data-ttu-id="c67a2-421">Ich ziehe es in der Regel vor, das Markup per Hand zu definieren, aber ich verwende eine beliebige Methode für Sie.</span><span class="sxs-lookup"><span data-stu-id="c67a2-421">I usually prefer defining the markup by hand, but use whatever method is most natural to you.</span></span>

<span data-ttu-id="c67a2-422">Am Ende habe ich die folgenden `LayoutTemplate`, `ItemTemplate`und `ItemSeparatorTemplate` für das ListView-Steuerelement verwendet:</span><span class="sxs-lookup"><span data-stu-id="c67a2-422">I ended up using the following `LayoutTemplate`, `ItemTemplate`, and `ItemSeparatorTemplate` for my ListView control:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample10.aspx)]

<span data-ttu-id="c67a2-423">Der `LayoutTemplate` definiert das vom Steuerelement ausgegebene Markup, während der `ItemTemplate` jedes von SqlDataSource zurückgegebene Element rendert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-423">The `LayoutTemplate` defines the markup emitted by the control, while the `ItemTemplate` renders each item returned by the SqlDataSource.</span></span> <span data-ttu-id="c67a2-424">Das resultierende Markup des `ItemTemplate`wird in das `itemPlaceholder` Steuerelement des `LayoutTemplate`eingefügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-424">The `ItemTemplate`'s resulting markup is placed in the `LayoutTemplate`'s `itemPlaceholder` control.</span></span> <span data-ttu-id="c67a2-425">Zusätzlich zum `itemPlaceholder`enthält die `LayoutTemplate` ein DataPager-Steuerelement, das die ListView so einschränkt, dass nur 10 Gäste Buch Kommentare pro Seite (Standard) angezeigt werden, und es wird eine pagingschnittstelle gerendert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-425">In addition to the `itemPlaceholder`, the `LayoutTemplate` includes a DataPager control, which limits the ListView to showing just 10 guestbook comments per page (the default) and renders a paging interface.</span></span>

<span data-ttu-id="c67a2-426">Meine `ItemTemplate` zeigt den Betreff jedes Gäste Buch Kommentars in einem `<h4>`-Element mit dem Text an, der unterhalb des Subjekts liegt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-426">My `ItemTemplate` displays each guestbook comment's subject in an `<h4>` element with the body situated below the subject.</span></span> <span data-ttu-id="c67a2-427">Beachten Sie, dass die für die Anzeige des Texts verwendete Syntax die von der `Eval("Body")` Datenbindung-Anweisung zurückgegebenen Daten annimmt, Sie in eine Zeichenfolge konvertiert und Zeilenumbrüche durch das `<br />`-Element ersetzt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-427">Note that syntax used for displaying the body takes the data returned by the `Eval("Body")` databinding statement, converts it to a string, and replaces line breaks with the `<br />` element.</span></span> <span data-ttu-id="c67a2-428">Diese Konvertierung wird benötigt, um die beim Einreichen des Kommentars eingegebenen Zeilenumbrüche anzuzeigen, da Leerräume von HTML ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-428">This conversion is needed in order to show the line breaks entered when submitting the comment since whitespace is ignored by HTML.</span></span> <span data-ttu-id="c67a2-429">Die Signatur des Benutzers wird unter dem Text in kursiv Schrift angezeigt, gefolgt von der Homepage des Benutzers, einem Link zu seiner Homepage, dem Datum und der Uhrzeit, zu der der Kommentar erstellt wurde, und dem Benutzernamen der Person, die den Kommentar hinterlassen hat.</span><span class="sxs-lookup"><span data-stu-id="c67a2-429">The user's signature is displayed beneath the body in italics, followed by the user's home town, a link to his homepage, the date and time the comment was made, and the username of the person who left the comment.</span></span>

<span data-ttu-id="c67a2-430">Nehmen Sie sich einen Moment Zeit, um die Seite in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-430">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="c67a2-431">Hier werden die Kommentare angezeigt, die Sie dem-Gästebuch in Schritt 5 hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-431">You should see the comments that you added to the guestbook in Step 5 displayed here.</span></span>

<span data-ttu-id="c67a2-432">[!["guest guest. aspx" zeigt nun die Kommentare des Gästebuchs an](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-432">[![Guestbook.aspx Now Displays the Guestbook's Comments](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span></span>

<span data-ttu-id="c67a2-433">**Abbildung 19**: `Guestbook.aspx` zeigt nun die Kommentare des Gästebuchs[an (Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-433">**Figure 19**: `Guestbook.aspx` Now Displays the Guestbook's Comments  ([Click to view full-size image](storing-additional-user-information-vb/_static/image57.png))</span></span>

<span data-ttu-id="c67a2-434">Versuchen Sie, dem Gäste Buch einen neuen Kommentar hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-434">Try adding a new comment to the guestbook.</span></span> <span data-ttu-id="c67a2-435">Wenn Sie auf die `PostCommentButton` Schaltfläche klicken, wird die Seite zurückgesendet, und der Kommentar wird der Datenbank hinzugefügt, aber das ListView-Steuerelement wird nicht aktualisiert, um den neuen Kommentar anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-435">Upon clicking the `PostCommentButton` button the page posts back and the comment is added to the database, but the ListView control is not updated to show the new comment.</span></span> <span data-ttu-id="c67a2-436">Dies kann mit folgenden Aktionen korrigiert werden:</span><span class="sxs-lookup"><span data-stu-id="c67a2-436">This can be fixed by either:</span></span>

- <span data-ttu-id="c67a2-437">Aktualisieren des `Click` Ereignis Handlers der `PostCommentButton` Schaltfläche, damit die `DataBind()` Methode des ListView-Steuer Elements aufgerufen wird, nachdem der neue Kommentar in die Datenbank eingefügt wurde, oder</span><span class="sxs-lookup"><span data-stu-id="c67a2-437">Updating the `PostCommentButton` button's `Click` event handler so that it invokes the ListView control's `DataBind()` method after inserting the new comment into the database, or</span></span>
- <span data-ttu-id="c67a2-438">Festlegen der `EnableViewState`-Eigenschaft des ListView-Steuer Elements auf `False`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-438">Setting the ListView control's `EnableViewState` property to `False`.</span></span> <span data-ttu-id="c67a2-439">Dieser Ansatz funktioniert, da der Ansichts Zustand des Steuer Elements deaktiviert wird, muss er bei jedem Postback erneut an die zugrunde liegenden Daten gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-439">This approach works because by disabling the control's view state, it must rebind to the underlying data on every postback.</span></span>

<span data-ttu-id="c67a2-440">Die in diesem Tutorial herunterladbare Tutorial-Website veranschaulicht beide Techniken.</span><span class="sxs-lookup"><span data-stu-id="c67a2-440">The tutorial website downloadable from this tutorial illustrates both techniques.</span></span> <span data-ttu-id="c67a2-441">Die `EnableViewState`-Eigenschaft des ListView-Steuer Elements, die `False` werden soll, und der Code, der zum programmgesteuerten erneuten Binden der Daten an die ListView benötigt wird, ist im `Click`-Ereignishandler vorhanden, aber auskommentiert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-441">The ListView control's `EnableViewState` property to `False` and the code needed to programmatically rebind the data to the ListView is present in the `Click` event handler, but is commented out.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-442">Die Seite "`AdditionalUserInfo.aspx`" ermöglicht dem Benutzer die Anzeige und Bearbeitung Ihrer Homepage-, Homepage-und Signatur Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-442">Currently the `AdditionalUserInfo.aspx` page allows the user to view and edit their home town, homepage, and signature settings.</span></span> <span data-ttu-id="c67a2-443">Es kann sinnvoll sein, `AdditionalUserInfo.aspx` zu aktualisieren, um die Gäste Buch Kommentare des angemeldeten Benutzers anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-443">It might be nice to update `AdditionalUserInfo.aspx` to display the logged in user's guestbook comments.</span></span> <span data-ttu-id="c67a2-444">Das heißt, zusätzlich zur Untersuchung und Bearbeitung Ihrer Informationen kann ein Benutzer die `AdditionalUserInfo.aspx` Seite aufrufen, um zu sehen, welche Gäste Buch Kommentare Sie in der Vergangenheit gemacht haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-444">That is, in addition to examining and modifying her information, a user can visit the `AdditionalUserInfo.aspx` page to see what guestbook comments she's made in the past.</span></span> <span data-ttu-id="c67a2-445">Ich lasse dies als Übung für den interessierten Reader aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-445">I leave this as an exercise for the interested reader.</span></span>

## <a name="step-6-customizing-the-createuserwizard-control-to-include-an-interface-for-the-home-town-homepage-and-signature"></a><span data-ttu-id="c67a2-446">Schritt 6: Anpassen des Steuer Elements "kreateuserwizard", um eine Schnittstelle für die Homepage, die Homepage und die Signatur einzuschließen</span><span class="sxs-lookup"><span data-stu-id="c67a2-446">Step 6: Customizing the CreateUserWizard Control to Include an Interface for the Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="c67a2-447">Die von der `Guestbook.aspx` Seite verwendete `SELECT` Abfrage verwendet einen `INNER JOIN`, um die verknüpften Datensätze zwischen den Tabellen `GuestbookComments`, `UserProfiles`und `aspnet_Users` zu kombinieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-447">The `SELECT` query used by the `Guestbook.aspx` page uses an `INNER JOIN` to combine the related records amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables.</span></span> <span data-ttu-id="c67a2-448">Wenn ein Benutzer, der keinen Datensatz in `UserProfiles` erstellt, einen Gäste Buch Kommentar erstellt, wird der Kommentar nicht in der ListView angezeigt, da der `INNER JOIN` nur `GuestbookComments` Datensätze zurückgibt, wenn in `UserProfiles` und `aspnet_Users`übereinstimmende Datensätze vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-448">If a user that has no record in `UserProfiles` makes a guestbook comment, the comment won't be displayed in the ListView because the `INNER JOIN` only returns `GuestbookComments` records when there are matching records in `UserProfiles` and `aspnet_Users`.</span></span> <span data-ttu-id="c67a2-449">Und wie in Schritt 3 gezeigt, verfügt ein Benutzer nicht über einen Datensatz in `UserProfiles` er seine Einstellungen auf der Seite `AdditionalUserInfo.aspx` nicht anzeigen oder bearbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-449">And as we saw in Step 3, if a user does not have a record in `UserProfiles` she cannot view or edit her settings in the `AdditionalUserInfo.aspx` page.</span></span>

<span data-ttu-id="c67a2-450">Aufgrund unserer Entwurfsentscheidungen ist es natürlich wichtig, dass jedes Benutzerkonto im Mitgliedschaftssystem über einen übereinstimmenden Datensatz in der `UserProfiles` Tabelle verfügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-450">Needless to say, due to our design decisions it is important that every user account in the Membership system have a matching record in the `UserProfiles` table.</span></span> <span data-ttu-id="c67a2-451">Wir möchten, dass ein entsprechender Datensatz hinzugefügt wird, der `UserProfiles` wird, wenn ein neues Mitgliedschafts Benutzerkonto über den "feeuserwizard" erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-451">What we want is for a corresponding record to be added to `UserProfiles` whenever a new Membership user account is created through the CreateUserWizard.</span></span>

<span data-ttu-id="c67a2-452">Wie im Tutorial [*Erstellen von Benutzerkonten*](creating-user-accounts-vb.md) erläutert, löst das Steuerelement "kreateuserwizard" das [`CreatedUser`-Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx)aus, nachdem das neue Mitgliedschafts Benutzerkonto erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="c67a2-452">As discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, after the new Membership user account is created the CreateUserWizard control raises its [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span></span> <span data-ttu-id="c67a2-453">Wir können einen Ereignishandler für dieses Ereignis erstellen, die UserID für den soeben erstellten Benutzer erhalten und dann einen Datensatz in die `UserProfiles` Tabelle mit Standardwerten für die Spalten `HomeTown`, `HomepageUrl`und `Signature` einfügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-453">We can create an event handler for this event, get the UserId for the just-created user, and then insert a record into the `UserProfiles` table with default values for the `HomeTown`, `HomepageUrl`, and `Signature` columns.</span></span> <span data-ttu-id="c67a2-454">Darüber hinaus ist es möglich, den Benutzer zur Eingabe dieser Werte aufzufordern, indem er die Schnittstelle des Steuer Elements "kreateuserwizard" anpasst, um zusätzliche Textfelder einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-454">What's more, it is possible to prompt the user for these values by customizing the CreateUserWizard control's interface to include additional TextBoxes.</span></span>

<span data-ttu-id="c67a2-455">Sehen wir uns zunächst an, wie der `UserProfiles` Tabelle im `CreatedUser`-Ereignishandler eine neue Zeile mit Standardwerten hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-455">Let's first look at how to add a new row to the `UserProfiles` table in the `CreatedUser` event handler with default values.</span></span> <span data-ttu-id="c67a2-456">Danach erfahren Sie, wie Sie die Benutzeroberfläche des Steuer Elements "anateuserwizard" so anpassen, dass es zusätzliche Formularfelder zum Erfassen der Homepage, der Homepage und der Signatur des neuen Benutzers enthält.</span><span class="sxs-lookup"><span data-stu-id="c67a2-456">Following that, we will see how to customize the CreateUserWizard control's user interface to include additional form fields to collect the new user's home town, homepage, and signature.</span></span>

### <a name="adding-a-default-row-touserprofiles"></a><span data-ttu-id="c67a2-457">Hinzufügen einer Standardzeile zu`UserProfiles`</span><span class="sxs-lookup"><span data-stu-id="c67a2-457">Adding a Default Row to`UserProfiles`</span></span>

<span data-ttu-id="c67a2-458">Im Tutorial [*Erstellen von Benutzerkonten*](creating-user-accounts-vb.md) haben wir der Seite "`CreatingUserAccounts.aspx`" im Ordner "`Membership`" ein "kreateuserwizard"-Steuerelement hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-458">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we added a CreateUserWizard control to the `CreatingUserAccounts.aspx` page in the `Membership` folder.</span></span> <span data-ttu-id="c67a2-459">Damit das Steuerelement "kreateuserwizard" `UserProfiles` Tabelle bei der Erstellung des Benutzerkontos einen Datensatz hinzufügen kann, müssen wir die Funktionalität des Steuer Elements "kreateuserwizard" aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-459">In order to have the CreateUserWizard control add a record to `UserProfiles` table upon user account creation, we need to update the CreateUserWizard control's functionality.</span></span> <span data-ttu-id="c67a2-460">Anstatt diese Änderungen auf der Seite "`CreatingUserAccounts.aspx`" vorzunehmen, fügen wir `EnhancedCreateUserWizard.aspx` Seite nun ein neues Steuerelement "kreateuserwizard" hinzu und nehmen dort die Änderungen für dieses Tutorial vor.</span><span class="sxs-lookup"><span data-stu-id="c67a2-460">Rather than making these changes to the `CreatingUserAccounts.aspx` page, let's instead add a new CreateUserWizard control to `EnhancedCreateUserWizard.aspx` page and make the modifications for this tutorial there.</span></span>

<span data-ttu-id="c67a2-461">Öffnen Sie in Visual Studio die Seite `EnhancedCreateUserWizard.aspx`, und ziehen Sie das Steuerelement "kreateuserwizard" aus der Toolbox auf die Seite.</span><span class="sxs-lookup"><span data-stu-id="c67a2-461">Open the `EnhancedCreateUserWizard.aspx` page in Visual Studio and drag a CreateUserWizard control from the Toolbox onto the page.</span></span> <span data-ttu-id="c67a2-462">Legen Sie die `ID`-Eigenschaft des-Steuer Elements für das-Steuerelement auf `NewUserWizard`fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-462">Set the CreateUserWizard control's `ID` property to `NewUserWizard`.</span></span> <span data-ttu-id="c67a2-463">Wie im Tutorial Erstellen von [*Benutzerkonten*](creating-user-accounts-vb.md) erläutert, wird der Besucher von der Standardbenutzer Oberfläche von "feateuserwizard" aufgefordert, die erforderlichen Informationen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-463">As we discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, the CreateUserWizard's default user interface prompts the visitor for the necessary information.</span></span> <span data-ttu-id="c67a2-464">Nachdem diese Informationen angegeben wurden, erstellt das Steuerelement intern ein neues Benutzerkonto im Mitgliedschafts Framework, ohne dass eine einzige Codezeile geschrieben werden muss.</span><span class="sxs-lookup"><span data-stu-id="c67a2-464">Once this information has been supplied, the control internally creates a new user account in the Membership framework, all without us having to write a single line of code.</span></span>

<span data-ttu-id="c67a2-465">Das Steuerelement "kreateuserwizard" löst während des Workflows eine Reihe von Ereignissen aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-465">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="c67a2-466">Nachdem ein Besucher die Anforderungs Informationen bereitgestellt und das Formular übermittelt hat, löst das Steuerelement "kreateuserwizard" zunächst sein [`CreatingUser` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx)aus.</span><span class="sxs-lookup"><span data-stu-id="c67a2-466">After a visitor supplies the request information and submits the form, the CreateUserWizard control initially fires its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="c67a2-467">Wenn während des Erstellungs Vorgangs ein Problem auftritt, wird das [`CreateUserError` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) ausgelöst. Wenn der Benutzer jedoch erfolgreich erstellt wurde, wird das [`CreatedUser`-Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c67a2-467">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="c67a2-468">Im Tutorial [*Erstellen von Benutzerkonten*](creating-user-accounts-vb.md) haben wir einen Ereignishandler für das `CreatingUser`-Ereignis erstellt, um sicherzustellen, dass der angegebene Benutzername keine führenden oder nachfolgenden Leerzeichen enthielt und dass der Benutzername nicht an einer beliebigen Stelle im Kennwort angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-468">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we created an event handler for the `CreatingUser` event to ensure that the supplied username did not contain any leading or trailing spaces, and that the username did not appear anywhere in the password.</span></span>

<span data-ttu-id="c67a2-469">Um der `UserProfiles` Tabelle für den soeben erstellten Benutzer eine Zeile hinzuzufügen, müssen wir einen Ereignishandler für das `CreatedUser`-Ereignis erstellen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-469">In order to add a row in the `UserProfiles` table for the just-created user, we need to create an event handler for the `CreatedUser` event.</span></span> <span data-ttu-id="c67a2-470">Zum Zeitpunkt der Auslösung des `CreatedUser` Ereignisses wurde das Benutzerkonto bereits im Mitgliedschafts Framework erstellt, sodass wir den Wert "UserID" des Kontos abrufen können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-470">By the time the `CreatedUser` event has fired, the user account has already been created in the Membership framework, enabling us to retrieve the account's UserId value.</span></span>

<span data-ttu-id="c67a2-471">Erstellen Sie einen Ereignishandler für das `CreatedUser` Ereignis des `NewUserWizard`, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="c67a2-471">Create an event handler for the `NewUserWizard`'s `CreatedUser` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample11.vb)]

<span data-ttu-id="c67a2-472">Der obige Code ist durch Abrufen der UserID des soeben hinzugefügten Benutzerkontos.</span><span class="sxs-lookup"><span data-stu-id="c67a2-472">The above code beings by retrieving the UserId of the just-added user account.</span></span> <span data-ttu-id="c67a2-473">Dies wird erreicht, indem die `Membership.GetUser(username)`-Methode verwendet wird, um Informationen zu einem bestimmten Benutzer zurückzugeben, und anschließend die `ProviderUserKey`-Eigenschaft zum Abrufen Ihrer UserID zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-473">This is accomplished by using the `Membership.GetUser(username)` method to return information about a particular user, and then using the `ProviderUserKey` property to retrieve their UserId.</span></span> <span data-ttu-id="c67a2-474">Der Benutzername, der vom Benutzer im Steuerelement "kreateuserwizard" eingegeben wurde, ist über die [`UserName`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx)verfügbar.</span><span class="sxs-lookup"><span data-stu-id="c67a2-474">The username entered by the user in the CreateUserWizard control is available via its [`UserName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span></span>

<span data-ttu-id="c67a2-475">Als nächstes wird die Verbindungs Zeichenfolge aus `Web.config` abgerufen, und die `INSERT`-Anweisung wird angegeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-475">Next, the connection string is retrieved from `Web.config` and the `INSERT` statement is specified.</span></span> <span data-ttu-id="c67a2-476">Die erforderlichen ADO.NET-Objekte werden instanziiert und der Befehl ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-476">The necessary ADO.NET objects are instantiated and the command executed.</span></span> <span data-ttu-id="c67a2-477">Der Code weist dem `@HomeTown`-, `@HomepageUrl`-und `@Signature`-Parameter eine [`DBNull`](https://msdn.microsoft.com/library/system.dbnull.aspx) Instanz zu. Dies hat Auswirkungen auf das Einfügen von Daten Bank `NULL` Werten für die `HomeTown`-, `HomepageUrl`-und `Signature`-Felder.</span><span class="sxs-lookup"><span data-stu-id="c67a2-477">The code assigns a [`DBNull`](https://msdn.microsoft.com/library/system.dbnull.aspx) instance to the `@HomeTown`, `@HomepageUrl`, and `@Signature` parameters, which has the effect of inserting database `NULL` values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span>

<span data-ttu-id="c67a2-478">Besuchen Sie die Seite `EnhancedCreateUserWizard.aspx` über einen Browser, und erstellen Sie ein neues Benutzerkonto.</span><span class="sxs-lookup"><span data-stu-id="c67a2-478">Visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account.</span></span> <span data-ttu-id="c67a2-479">Kehren Sie anschließend zu Visual Studio zurück, und untersuchen Sie den Inhalt der Tabellen "`aspnet_Users`" und "`UserProfiles`" (wie in Abbildung 12 dargestellt).</span><span class="sxs-lookup"><span data-stu-id="c67a2-479">After doing so, return to Visual Studio and examine the contents of the `aspnet_Users` and `UserProfiles` tables (like we did back in Figure 12).</span></span> <span data-ttu-id="c67a2-480">Das neue Benutzerkonto sollte in `aspnet_Users` und eine entsprechende `UserProfiles` Zeile (mit `NULL` Werte für `HomeTown`, `HomepageUrl`und `Signature`) angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-480">You should see the new user account in `aspnet_Users` and a corresponding `UserProfiles` row (with `NULL` values for `HomeTown`, `HomepageUrl`, and `Signature`).</span></span>

<span data-ttu-id="c67a2-481">[![ein neues Benutzerkonto und ein Benutzerprofil-Datensatz hinzugefügt wurden.](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-481">[![A New User Account and UserProfiles Record Have Been Added](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span></span>

<span data-ttu-id="c67a2-482">**Abbildung 20**: Es wurde ein neues Benutzerkonto und `UserProfiles` Datensatz hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-482">**Figure 20**: A New User Account and `UserProfiles` Record Have Been Added  ([Click to view full-size image](storing-additional-user-information-vb/_static/image60.png))</span></span>

<span data-ttu-id="c67a2-483">Nachdem der Besucher seine neuen Kontoinformationen eingegeben und auf die Schaltfläche "Benutzer erstellen" geklickt hat, wird das Benutzerkonto erstellt und der `UserProfiles` Tabelle eine Zeile hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-483">After the visitor has supplied his new account information and clicked the "Create User" button, the user account is created and a row added to the `UserProfiles` table.</span></span> <span data-ttu-id="c67a2-484">Der Assistent zum Anzeigen der `CompleteWizardStep`zeigt dann die zugehörige an, in der eine Erfolgsmeldung und eine Schaltfläche "weiter" angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-484">The CreateUserWizard then displays its `CompleteWizardStep`, which displays a success message and a Continue button.</span></span> <span data-ttu-id="c67a2-485">Wenn Sie auf die Schaltfläche "weiter" klicken, wird ein Postback ausgelöst, aber es wird keine Aktion ausgeführt, sodass der Benutzer auf der `EnhancedCreateUserWizard.aspx` Seite hängen bleibt</span><span class="sxs-lookup"><span data-stu-id="c67a2-485">Clicking the Continue button causes a postback, but no action is taken, leaving the user stuck on the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="c67a2-486">Wir können eine URL angeben, an die der Benutzer gesendet wird, wenn auf die Schaltfläche "weiter" mit der`ContinueDestinationPageUrl`- [Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx)des Steuer Elements "kreateuserwizard" geklickt wird</span><span class="sxs-lookup"><span data-stu-id="c67a2-486">We can specify a URL to send the user to when the Continue button is clicked via the CreateUserWizard control's [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span> <span data-ttu-id="c67a2-487">Legen Sie die `ContinueDestinationPageUrl`-Eigenschaft auf "~/Membership/AdditionalUserInfo.aspx" fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-487">Set the `ContinueDestinationPageUrl` property to "~/Membership/AdditionalUserInfo.aspx".</span></span> <span data-ttu-id="c67a2-488">Dadurch wird der neue Benutzer `AdditionalUserInfo.aspx`, wo er seine Einstellungen anzeigen und aktualisieren kann.</span><span class="sxs-lookup"><span data-stu-id="c67a2-488">This takes the new user to `AdditionalUserInfo.aspx`, where they can view and update their settings.</span></span>

### <a name="customizing-the-createuserwizards-interface-to-prompt-for-the-new-users-home-town-homepage-and-signature"></a><span data-ttu-id="c67a2-489">Anpassen der Benutzeroberfläche von "feateuserwizard", um zur Eingabe des Orts, der Homepage und der Signatur des neuen Benutzers aufzufordern</span><span class="sxs-lookup"><span data-stu-id="c67a2-489">Customizing the CreateUserWizard's Interface to Prompt for the New User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="c67a2-490">Die standardmäßige Oberfläche des Steuer Elements "kreateuserwizard" ist für einfache Konto Erstellungs Szenarien ausreichend, in denen nur wichtige Benutzerkontoinformationen wie Benutzername, Kennwort und e-Mail gesammelt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-490">The CreateUserWizard control's default interface is sufficient for simple account creation scenarios where only core user account information like username, password, and email need be collected.</span></span> <span data-ttu-id="c67a2-491">Aber was ist, wenn wir den Besucher beim Erstellen Ihres Kontos zum Eingeben Ihrer Homepage, Homepage und Signatur auffordern möchten?</span><span class="sxs-lookup"><span data-stu-id="c67a2-491">But what if we wanted to prompt the visitor to enter her home town, homepage, and signature while creating her account?</span></span> <span data-ttu-id="c67a2-492">Es ist möglich, die Schnittstelle des Steuer Elements "kreateuserwizard" anzupassen, um zusätzliche Informationen bei der Registrierung zu erfassen. diese Informationen können im `CreatedUser` Ereignishandler verwendet werden, um zusätzliche Datensätze in die zugrunde liegende Datenbank einzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-492">It is possible to customize the CreateUserWizard control's interface to collect additional information at signup, and this information may be used in the `CreatedUser` event handler to insert additional records into the underlying database.</span></span>

<span data-ttu-id="c67a2-493">Das Steuerelement "kreateuserwizard" erweitert das ASP.NET-Assistenten-Steuerelement, bei dem es sich um ein Steuerelement handelt, mit dem Seiten Entwickler eine Reihe geordneter `WizardSteps`definieren können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-493">The CreateUserWizard control extends the ASP.NET Wizard control, which is a control that allows a page developer to define a series of ordered `WizardSteps`.</span></span> <span data-ttu-id="c67a2-494">Das Assistenten-Steuerelement rendert den aktiven Schritt und stellt eine Navigationsschnittstelle bereit, die es dem Besucher ermöglicht, diese Schritte zu durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-494">The Wizard control renders the active step and provides a navigation interface that allows the visitor to move through these steps.</span></span> <span data-ttu-id="c67a2-495">Das Assistenten-Steuerelement ist ideal, um eine lange Aufgabe in mehrere kurze Schritte zu unterteilen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-495">The Wizard control is ideal for breaking down a long task into several short steps.</span></span> <span data-ttu-id="c67a2-496">Weitere Informationen zum Assistenten-Steuerelement finden Sie unter [Erstellen einer Schritt-für-Schritt-Benutzeroberfläche mit dem ASP.NET 2,0-Assistenten-Steuer](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)Element.</span><span class="sxs-lookup"><span data-stu-id="c67a2-496">For more information on the Wizard control, see [Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span></span>

<span data-ttu-id="c67a2-497">Das Standard Markup des-Steuer Elements von "kreateuserwizard" definiert zwei `WizardSteps`: `CreateUserWizardStep` und `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-497">The CreateUserWizard control's default markup defines two `WizardSteps`: `CreateUserWizardStep` and `CompleteWizardStep`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample12.aspx)]

<span data-ttu-id="c67a2-498">Der erste `WizardStep`, `CreateUserWizardStep`, rendert die-Schnittstelle, die zur Eingabe von Benutzername, Kennwort, e-Mail-Adresse usw. auffordert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-498">The first `WizardStep`, `CreateUserWizardStep`, renders the interface that prompts for the username, password, email, and so on.</span></span> <span data-ttu-id="c67a2-499">Nachdem der Besucher diese Informationen bereitgestellt und auf "Benutzer erstellen" geklickt hat, wird der `CompleteWizardStep`angezeigt, der die Erfolgsmeldung und die Schaltfläche "weiter" anzeigt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-499">After the visitor supplies this information and clicks "Create User", she is shown the `CompleteWizardStep`, which shows the success message and a Continue button.</span></span>

<span data-ttu-id="c67a2-500">Um die Schnittstelle des Steuer Elements "kreateuserwizard" so anzupassen, dass zusätzliche Formularfelder enthalten sind, können wir</span><span class="sxs-lookup"><span data-stu-id="c67a2-500">To customize the CreateUserWizard control's interface to include additional form fields, we can:</span></span>

- <span data-ttu-id="c67a2-501"><strong>Erstellen Sie mindestens eine neue</strong> <strong>`WizardStep`</strong> <strong>s, um die zusätzlichen Benutzeroberflächen Elemente zu enthalten</strong>.</span><span class="sxs-lookup"><span data-stu-id="c67a2-501"><strong>Create one or more new</strong><strong>`WizardStep`</strong><strong>s to contain the additional user interface elements</strong>.</span></span> <span data-ttu-id="c67a2-502">Klicken Sie zum Hinzufügen eines neuen `WizardStep` zum "feateuserwizard" auf den Link "`WizardStep` s hinzufügen/entfernen" des Smarttags, um den `WizardStep` Auflistungs-Editor zu starten.</span><span class="sxs-lookup"><span data-stu-id="c67a2-502">To add a new `WizardStep` to the CreateUserWizard, click the "Add/Remove `WizardStep` s" link from its Smart Tag to launch the `WizardStep` Collection Editor.</span></span> <span data-ttu-id="c67a2-503">Von dort aus können Sie die Schritte im Assistenten hinzufügen, entfernen oder neu anordnen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-503">From there you can add, remove, or reorder the steps in the wizard.</span></span> <span data-ttu-id="c67a2-504">Dies ist der Ansatz, den wir für dieses Tutorial verwenden werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-504">This is the approach we will use for this tutorial.</span></span>

- <span data-ttu-id="c67a2-505"><strong>Konvertieren Sie den</strong> <strong>`CreateUserWizardStep`</strong> <strong>in eine bearbeitbare</strong> <strong>`WizardStep`</strong> <strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="c67a2-505"><strong>Convert the</strong><strong>`CreateUserWizardStep`</strong><strong>into an editable</strong><strong>`WizardStep`</strong><strong>.</strong></span></span> <span data-ttu-id="c67a2-506">Dadurch wird die `CreateUserWizardStep` durch eine äquivalente `WizardStep` ersetzt, deren Markup eine Benutzeroberfläche definiert, die dem `CreateUserWizardStep`entspricht.</span><span class="sxs-lookup"><span data-stu-id="c67a2-506">This replaces the `CreateUserWizardStep` with an equivalent `WizardStep` whose markup defines a user interface that matches the `CreateUserWizardStep`'s.</span></span> <span data-ttu-id="c67a2-507">Indem die `CreateUserWizardStep` in eine `WizardStep` umgewandelt wird, können wir die Steuerelemente neu positionieren oder diesem Schritt zusätzliche Benutzeroberflächen Elemente hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-507">By converting the `CreateUserWizardStep` into a `WizardStep` we can reposition the controls or add additional user interface elements to this step.</span></span> <span data-ttu-id="c67a2-508">Wenn Sie die `CreateUserWizardStep` oder `CompleteWizardStep` in eine bearbeitbare `WizardStep`konvertieren möchten, klicken Sie auf den Link "Benutzer Schritt anpassen" oder "Schritt für Schritt anpassen" aus dem Smarttag des Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="c67a2-508">To convert the `CreateUserWizardStep` or `CompleteWizardStep` into an editable `WizardStep`, click the "Customize Create User Step" or "Customize Complete Step" link from the control's Smart Tag.</span></span>

- <span data-ttu-id="c67a2-509">**Verwenden Sie eine Kombination der beiden oben genannten Optionen.**</span><span class="sxs-lookup"><span data-stu-id="c67a2-509">**Use some combination of the above two options.**</span></span>

<span data-ttu-id="c67a2-510">Beachten Sie, dass das Steuerelement "" von "Create User" (Benutzerkonto erstellen) im `CreateUserWizardStep`das Erstellungs Verfahren für das Benutzerkonto ausführt, wenn Sie auf die Schaltfläche "Benutzer erstellen" klicken.</span><span class="sxs-lookup"><span data-stu-id="c67a2-510">One important thing to keep in mind is that the CreateUserWizard control executes its user account creation process when the "Create User" button is clicked from within its `CreateUserWizardStep`.</span></span> <span data-ttu-id="c67a2-511">Es spielt keine Rolle, ob nach dem `CreateUserWizardStep` weitere `WizardStep` s vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="c67a2-511">It doesn't matter if there are additional `WizardStep` s after the `CreateUserWizardStep` or not.</span></span>

<span data-ttu-id="c67a2-512">Wenn Sie dem Steuerelement "kreateuserwizard" eine benutzerdefinierte `WizardStep` hinzufügen, um zusätzliche Benutzereingaben zu erfassen, können Sie die benutzerdefinierte `WizardStep` vor oder nach dem `CreateUserWizardStep`platzieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-512">When adding a custom `WizardStep` to the CreateUserWizard control to collect additional user input, the custom `WizardStep` can be placed before or after the `CreateUserWizardStep`.</span></span> <span data-ttu-id="c67a2-513">Wenn Sie vor dem `CreateUserWizardStep` wird, sind die zusätzlichen Benutzereingaben, die vom benutzerdefinierten `WizardStep` gesammelt werden, für den `CreatedUser`-Ereignishandler verfügbar.</span><span class="sxs-lookup"><span data-stu-id="c67a2-513">If it comes before the `CreateUserWizardStep` then the additional user input collected from the custom `WizardStep` is available for the `CreatedUser` event handler.</span></span> <span data-ttu-id="c67a2-514">Wenn die benutzerdefinierte `WizardStep` jedoch nach `CreateUserWizardStep` erfolgt, wenn die benutzerdefinierte `WizardStep` angezeigt wird, wurde das neue Benutzerkonto bereits erstellt, und das `CreatedUser` Ereignis wurde bereits ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c67a2-514">However, if the custom `WizardStep` comes after `CreateUserWizardStep` then by the time the custom `WizardStep` is displayed the new user account has already been created and the `CreatedUser` event has already fired.</span></span>

<span data-ttu-id="c67a2-515">Abbildung 21 zeigt den Workflow, wenn der hinzugefügte `WizardStep` dem `CreateUserWizardStep`vorangestellt ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-515">Figure 21 shows the workflow when the added `WizardStep` precedes the `CreateUserWizardStep`.</span></span> <span data-ttu-id="c67a2-516">Da die zusätzlichen Benutzerinformationen zum Zeitpunkt der Auslösung des `CreatedUser` Ereignisses erfasst wurden, müssen Sie lediglich den `CreatedUser`-Ereignishandler aktualisieren, um diese Eingaben abzurufen und diese für die Parameterwerte der `INSERT` Anweisung (anstatt `DBNull.Value`) zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-516">Since the additional user information has been collected by the time the `CreatedUser` event fires, all we have to do is update the `CreatedUser` event handler to retrieve these inputs and use those for the `INSERT` statement's parameter values (rather than `DBNull.Value`).</span></span>

<span data-ttu-id="c67a2-517">[![Sie den Workflow "feeuserwizard", wenn ein zusätzlicher WizardStep dem "feeudstep" vorangestellt ist.](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-517">[![The CreateUserWizard Workflow When an Additional WizardStep Precedes the CreateUserWizardStep](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span></span>

<span data-ttu-id="c67a2-518">**Abbildung 21**: der Workflow "buildeuserwizard", wenn ein zusätzlicher `WizardStep` dem `CreateUserWizardStep` vorangestellt ist ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-518">**Figure 21**: The CreateUserWizard Workflow When an Additional `WizardStep` Precedes the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image63.png))</span></span>

<span data-ttu-id="c67a2-519">Wenn die benutzerdefinierte `WizardStep` *nach* der `CreateUserWizardStep`platziert wird, wird der Vorgang "Benutzerkonto erstellen" durchgeführt, bevor der Benutzer die Möglichkeit hat, Ihre Homepage, Homepage oder Signatur einzugeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-519">If the custom `WizardStep` is placed *after* the `CreateUserWizardStep`, however, the create user account process occurs before the user has had a chance to enter her home town, homepage, or signature.</span></span> <span data-ttu-id="c67a2-520">In diesem Fall müssen diese zusätzlichen Informationen in die Datenbank eingefügt werden, nachdem das Benutzerkonto erstellt wurde, wie in Abbildung 22 veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="c67a2-520">In such a case, this additional information needs to be inserted into the database after the user account has been created, as Figure 22 illustrates.</span></span>

<span data-ttu-id="c67a2-521">[![Sie den Workflow "feeuserwizard", wenn ein zusätzlicher WizardStep nach dem "febereuserwizardstep"-Schritt ausgeführt wird.](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-521">[![The CreateUserWizard Workflow When an Additional WizardStep Comes After the CreateUserWizardStep](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span></span>

<span data-ttu-id="c67a2-522">**Abbildung 22**: der Workflow "buildeuserwizard", wenn ein zusätzliches `WizardStep` nach dem `CreateUserWizardStep` kommt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-522">**Figure 22**: The CreateUserWizard Workflow When an Additional `WizardStep` Comes After the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image66.png))</span></span>

<span data-ttu-id="c67a2-523">Der in Abbildung 22 dargestellte Workflow wartet auf das Einfügen eines Datensatzes in die `UserProfiles` Tabelle, bis Schritt 2 abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-523">The workflow shown in Figure 22 waits to insert a record into the `UserProfiles` table until after Step 2 completes.</span></span> <span data-ttu-id="c67a2-524">Wenn der Besucher seinen Browser nach Schritt 1 schließt, haben wir jedoch einen Zustand erreicht, in dem ein Benutzerkonto erstellt wurde, der `UserProfiles`jedoch kein Datensatz hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="c67a2-524">If the visitor closes her browser after step 1, however, we will have reached a state where a user account was created, but no record was added to `UserProfiles`.</span></span> <span data-ttu-id="c67a2-525">Eine Problem Umgehung besteht darin, einen Datensatz mit `NULL`-oder Standardwerten in `UserProfiles` in den `CreatedUser`-Ereignishandler einzufügen (der nach Schritt 1 ausgelöst wird), und diesen Datensatz nach Abschluss von Schritt 2 zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="c67a2-525">One workaround is to have a record with `NULL` or default values inserted into `UserProfiles` in the `CreatedUser` event handler (which fires after step 1), and then update this record after step 2 completes.</span></span> <span data-ttu-id="c67a2-526">Dadurch wird sichergestellt, dass für das Benutzerkonto ein `UserProfiles` Datensatz hinzugefügt wird, auch wenn der Benutzer den Registrierungsprozess in der Mitte durchläuft.</span><span class="sxs-lookup"><span data-stu-id="c67a2-526">This ensures that a `UserProfiles` record will be added for the user account even if the user quits the registration process midway through.</span></span>

<span data-ttu-id="c67a2-527">In diesem Tutorial erstellen wir eine neue `WizardStep`, die nach dem `CreateUserWizardStep`, aber vor dem `CompleteWizardStep`auftritt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-527">For this tutorial let's create a new `WizardStep` that occurs after the `CreateUserWizardStep` but before the `CompleteWizardStep`.</span></span> <span data-ttu-id="c67a2-528">Zuerst soll der WizardStep eingerichtet und konfiguriert werden, und dann sehen wir uns den Code an.</span><span class="sxs-lookup"><span data-stu-id="c67a2-528">Let's first get the WizardStep in place and configured and then we'll look at the code.</span></span>

<span data-ttu-id="c67a2-529">Wählen Sie im smarttagfeld des Steuer Elements "kreateuserwizard" die Option "`WizardStep` s hinzufügen/entfernen" aus, die das Dialogfeld `WizardStep` Auflistungs-Editor öffnet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-529">From the CreateUserWizard control's Smart Tag, select the "Add/Remove `WizardStep` s", which brings up the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="c67a2-530">Fügen Sie einen neuen `WizardStep`hinzu, und legen Sie dessen `ID` auf `UserSettings`, dessen `Title` auf "Ihre Einstellungen" und `StepType` auf `Step`fest.</span><span class="sxs-lookup"><span data-stu-id="c67a2-530">Add a new `WizardStep`, setting its `ID` to `UserSettings`, its `Title` to "Your Settings" and its `StepType` to `Step`.</span></span> <span data-ttu-id="c67a2-531">Positionieren Sie diese dann so, dass Sie nach dem `CreateUserWizardStep` ("registrieren Sie sich für Ihr neues Konto") und vor dem `CompleteWizardStep` ("Complete") angezeigt wird, wie in Abbildung 23 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-531">Then position it so that it comes after the `CreateUserWizardStep` ("Sign Up for Your New Account") and before the `CompleteWizardStep` ("Complete"), as shown in Figure 23.</span></span>

<span data-ttu-id="c67a2-532">[![dem Steuerelement "kreateuserwizard" einen neuen WizardStep hinzufügen](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="c67a2-532">[![Add a New WizardStep to the CreateUserWizard Control](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span></span>

<span data-ttu-id="c67a2-533">**Abbildung 23**: Hinzufügen eines neuen `WizardStep` zum Steuerelement "kreateuserwizard" ([Klicken Sie, um das Bild in voller Größe anzuzeigen](storing-additional-user-information-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="c67a2-533">**Figure 23**: Add a New `WizardStep` to the CreateUserWizard Control  ([Click to view full-size image](storing-additional-user-information-vb/_static/image69.png))</span></span>

<span data-ttu-id="c67a2-534">Klicken Sie auf OK, um das Dialogfeld `WizardStep` Auflistungs-Editor</span><span class="sxs-lookup"><span data-stu-id="c67a2-534">Click OK to close the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="c67a2-535">Die neue `WizardStep` wird durch das aktualisierte deklarative Markup des-Steuer Elements von "upateuserwizard" angezeigt:</span><span class="sxs-lookup"><span data-stu-id="c67a2-535">The new `WizardStep` is evidenced by the CreateUserWizard control's updated declarative markup:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample13.aspx)]

<span data-ttu-id="c67a2-536">Beachten Sie das neue `<asp:WizardStep>` Element.</span><span class="sxs-lookup"><span data-stu-id="c67a2-536">Note the new `<asp:WizardStep>` element.</span></span> <span data-ttu-id="c67a2-537">Wir müssen die Benutzeroberfläche hinzufügen, um die Homepage, Homepage und Signatur des neuen Benutzers zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-537">We need to add the user interface to collect the new user's home town, homepage, and signature here.</span></span> <span data-ttu-id="c67a2-538">Sie können diesen Inhalt in der deklarativen Syntax oder über den Designer eingeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-538">You can enter this content in the declarative syntax or through the Designer.</span></span> <span data-ttu-id="c67a2-539">Um den Designer zu verwenden, wählen Sie den Schritt "Ihre Einstellungen" aus der Dropdown Liste im smarttagtag aus, um den Schritt im Designer anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-539">To use the Designer, select the "Your Settings" step from the drop-down list in the Smart Tag to see the step in the Designer.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-540">Wenn Sie in der Dropdown Liste des Smarttags einen Schritt auswählen, wird die [`ActiveStepIndex`-Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx)des Steuer Elements "" des-Steuer Elements aktualisiert, das den Index des Anfangs Schritts angibt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-540">Selecting a step through the Smart Tag's drop-down list updates the CreateUserWizard control's [`ActiveStepIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), which specifies the index of the starting step.</span></span> <span data-ttu-id="c67a2-541">Wenn Sie diese Dropdown Liste verwenden, um den Schritt "Ihre Einstellungen" im Designer zu bearbeiten, müssen Sie Sie daher auf "für Ihr neues Konto registrieren" zurücksetzen, damit dieser Schritt angezeigt wird, wenn Benutzer die `EnhancedCreateUserWizard.aspx` Seite besuchen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-541">Therefore, if you use this drop-down list to edit the "Your Settings" step in the Designer, be sure to set it back to "Sign Up for Your New Account" so that this step is shown when users first visit the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="c67a2-542">Erstellen Sie eine Benutzeroberfläche innerhalb des Schritts "Ihre Einstellungen", die drei Textfeld-Steuerelemente mit den Namen `HomeTown`, `HomepageUrl`und `Signature`enthält.</span><span class="sxs-lookup"><span data-stu-id="c67a2-542">Create a user interface within the "Your Settings" step that contains three TextBox controls named `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="c67a2-543">Nachdem Sie diese Schnittstelle erstellt haben, sollte das deklarative Markup von "kreateuserwizard" in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="c67a2-543">After constructing this interface, the CreateUserWizard's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample14.aspx)]

<span data-ttu-id="c67a2-544">Besuchen Sie diese Seite über einen Browser, und erstellen Sie ein neues Benutzerkonto, in dem Sie Werte für die Homepage, die Homepage und die Signatur angeben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-544">Go ahead and visit this page through a browser and create a new user account, specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="c67a2-545">Nach Abschluss des-`CreateUserWizardStep` wird das Benutzerkonto im Mitgliedschafts Framework erstellt, und der `CreatedUser`-Ereignishandler wird ausgeführt. Dadurch wird `UserProfiles`eine neue Zeile hinzugefügt, jedoch mit einem Datenbank-`NULL` Wert für `HomeTown`, `HomepageUrl`und `Signature`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-545">After completing the `CreateUserWizardStep` the user account is created in the Membership framework and the `CreatedUser` event handler runs, which adds a new row to `UserProfiles`, but with a database `NULL` value for `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="c67a2-546">Die für "Home", "Homepage" und "Signatur" eingegebenen Werte werden niemals verwendet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-546">The values entered for the home town, homepage, and signature are never used.</span></span> <span data-ttu-id="c67a2-547">Das Ergebnis ist ein neues Benutzerkonto mit einem `UserProfiles` Datensatz, dessen `HomeTown`, `HomepageUrl`und `Signature` Felder noch angegeben werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-547">The net result is a new user account with a `UserProfiles` record whose `HomeTown`, `HomepageUrl`, and `Signature` fields have yet to be specified.</span></span>

<span data-ttu-id="c67a2-548">Wir müssen nach dem Schritt "Ihre Einstellungen" Code ausführen, der die vom Benutzer eingegebenen Werte Home, honepage und Signature annimmt und den entsprechenden `UserProfiles` Datensatz aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="c67a2-548">We need to execute code after the "Your Settings" step that takes the home town, honepage, and signature values entered by the user and updates the appropriate `UserProfiles` record.</span></span> <span data-ttu-id="c67a2-549">Jedes Mal, wenn der Benutzer zwischen den Schritten in einem Assistenten-Steuerelement wechselt, wird das [`ActiveStepChanged` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) des Assistenten ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c67a2-549">Each time the user moves between steps in a Wizard control, the Wizard's [`ActiveStepChanged` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) fires.</span></span> <span data-ttu-id="c67a2-550">Wir können einen Ereignishandler für dieses Ereignis erstellen und die `UserProfiles` Tabelle aktualisieren, wenn der Schritt "Ihre Einstellungen" abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-550">We can create an event handler for this event and update the `UserProfiles` table when the "Your Settings" step has completed.</span></span>

<span data-ttu-id="c67a2-551">Fügen Sie einen Ereignishandler für das `ActiveStepChanged`-Ereignis von "feateuserwizard" hinzu, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="c67a2-551">Add an event handler for the CreateUserWizard's `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample15.vb)]

<span data-ttu-id="c67a2-552">Der obige Code beginnt mit der Bestimmung, ob wir soeben den Schritt "Complete" (fertig) erreicht haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-552">The above code starts by determining if we have just reached the "Complete" step.</span></span> <span data-ttu-id="c67a2-553">Da der Schritt "abschließen" unmittelbar nach dem Schritt "Ihre Einstellungen" erfolgt, wenn der Besucher den Schritt "abschließen" erreicht, bedeutet dies, dass Sie den Schritt "Ihre Einstellungen" gerade abgeschlossen haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-553">Since the "Complete" step occurs immediately after the "Your Settings" step, then when the visitor reaches "Complete" step that means she just finished the "Your Settings" step.</span></span>

<span data-ttu-id="c67a2-554">In einem solchen Fall müssen wir Programm gesteuert auf die Textfeld-Steuerelemente innerhalb der `UserSettings WizardStep`verweisen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-554">In such a case, we need to programmatically reference the TextBox controls within the `UserSettings WizardStep`.</span></span> <span data-ttu-id="c67a2-555">Dies wird erreicht, indem zuerst die `FindControl`-Methode verwendet wird, um Programm gesteuert auf die `UserSettings WizardStep`zu verweisen, und dann erneut auf die Textfelder innerhalb des `WizardStep`verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="c67a2-555">This is accomplished by first using the `FindControl` method to programmatically referencing the `UserSettings WizardStep`, and then again to reference the TextBoxes from within the `WizardStep`.</span></span> <span data-ttu-id="c67a2-556">Nachdem auf die Textfelder verwiesen wurde, können wir die `UPDATE`-Anweisung ausführen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-556">Once the TextBoxes have been referenced, we're ready to execute the `UPDATE` statement.</span></span> <span data-ttu-id="c67a2-557">Die `UPDATE`-Anweisung verfügt über die gleiche Anzahl von Parametern wie die `INSERT`-Anweisung im `CreatedUser`-Ereignishandler, aber hier werden die vom Benutzer bereitgestellten Home-, Homepage-und Signatur Werte verwendet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-557">The `UPDATE` statement has the same number of parameters as the `INSERT` statement in the `CreatedUser` event handler, but here we use the home town, homepage, and signature values supplied by the user.</span></span>

<span data-ttu-id="c67a2-558">Wenn dieser Ereignishandler vorhanden ist, besuchen Sie die Seite `EnhancedCreateUserWizard.aspx` über einen Browser, und erstellen Sie ein neues Benutzerkonto, in dem die Werte für Home, Homepage und Signature angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-558">With this event handler in place, visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="c67a2-559">Nachdem Sie das neue Konto erstellt haben, sollten Sie auf die Seite `AdditionalUserInfo.aspx` umgeleitet werden, auf der die soeben eingegebenen Informationen zu Homepage, Homepage und Signatur angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-559">After creating the new account you should be redirected to the `AdditionalUserInfo.aspx` page, where the just-entered home town, homepage, and signature information is displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="c67a2-560">Unsere Website verfügt zurzeit über zwei Seiten, von denen ein Besucher ein neues Konto erstellen kann: `CreatingUserAccounts.aspx` und `EnhancedCreateUserWizard.aspx`.</span><span class="sxs-lookup"><span data-stu-id="c67a2-560">Our website currently has two pages from which a visitor can create a new account: `CreatingUserAccounts.aspx` and `EnhancedCreateUserWizard.aspx`.</span></span> <span data-ttu-id="c67a2-561">Die Seite "Sitemap und Anmeldung" der Website verweist auf die Seite "`CreatingUserAccounts.aspx`", aber die `CreatingUserAccounts.aspx` Seite fordert den Benutzer nicht zur Eingabe von Orts-, Homepage-und Signatur Informationen auf und fügt `UserProfiles`keine entsprechende Zeile hinzu.</span><span class="sxs-lookup"><span data-stu-id="c67a2-561">The website's sitemap and login page point to the `CreatingUserAccounts.aspx` page, but the `CreatingUserAccounts.aspx` page does not prompt the user for their home town, homepage, and signature information and does not add a corresponding row to `UserProfiles`.</span></span> <span data-ttu-id="c67a2-562">Aktualisieren Sie daher die `CreatingUserAccounts.aspx` Seite so, dass Sie diese Funktion bietet, oder aktualisieren Sie die Seite "Sitemap" und "Login" so, dass Sie anstelle `CreatingUserAccounts.aspx`auf `EnhancedCreateUserWizard.aspx` verweist.</span><span class="sxs-lookup"><span data-stu-id="c67a2-562">Therefore, either update the `CreatingUserAccounts.aspx` page so that it offers this functionality or update the sitemap and login page to reference `EnhancedCreateUserWizard.aspx` instead of `CreatingUserAccounts.aspx`.</span></span> <span data-ttu-id="c67a2-563">Wenn Sie die zweite Option auswählen, achten Sie darauf, dass Sie die `Web.config` Datei des `Membership` Ordners aktualisieren, damit anonyme Benutzer auf die `EnhancedCreateUserWizard.aspx` Seite zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="c67a2-563">If you choose the latter option, be sure to update the `Membership` folder's `Web.config` file so as to allow anonymous users access to the `EnhancedCreateUserWizard.aspx` page.</span></span>

## <a name="summary"></a><span data-ttu-id="c67a2-564">Summary</span><span class="sxs-lookup"><span data-stu-id="c67a2-564">Summary</span></span>

<span data-ttu-id="c67a2-565">In diesem Tutorial haben wir Techniken zum Modellieren von Daten im Zusammenhang mit Benutzerkonten innerhalb des Mitgliedschafts-Frameworks behandelt.</span><span class="sxs-lookup"><span data-stu-id="c67a2-565">In this tutorial we looked at techniques for modeling data that is related to user accounts within the Membership framework.</span></span> <span data-ttu-id="c67a2-566">Insbesondere haben wir uns mit der Modellierung von Entitäten beschäftigt, die eine 1: n-Beziehung mit Benutzerkonten und Daten gemeinsam nutzen, die eine 1:1-Beziehung gemeinsam haben.</span><span class="sxs-lookup"><span data-stu-id="c67a2-566">In particular, we looked at modeling entities that share a one-to-many relationship with user accounts as well as data that shares a one-to-one relationship.</span></span> <span data-ttu-id="c67a2-567">Außerdem haben wir gesehen, wie diese verwandten Informationen angezeigt, eingefügt und aktualisiert werden können. Beispiele hierfür sind das SqlDataSource-Steuerelement und andere Benutzer, die ADO.NET-Code verwenden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-567">Furthermore, we saw how this related information could be displayed, inserted, and updated, with some examples using the SqlDataSource control and others using ADO.NET code.</span></span>

<span data-ttu-id="c67a2-568">In diesem Tutorial wird die Betrachtung von Benutzerkonten abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-568">This tutorial completes our look at user accounts.</span></span> <span data-ttu-id="c67a2-569">Beginnend mit dem nächsten Tutorial werden wir uns mit den Rollen befassen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-569">Starting with the next tutorial we will turn our attention to roles.</span></span> <span data-ttu-id="c67a2-570">In den nächsten Tutorials wird das Rollen Framework erläutert, das Erstellen neuer Rollen, das Zuweisen von Rollen zu Benutzern, das Ermitteln der Rollen, zu denen ein Benutzer gehört, und das Anwenden der rollenbasierten Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="c67a2-570">Over the next several tutorials we will look at the Roles framework, see how to create new roles, how to assign roles to users, how to determine what roles a user belongs to, and how to apply role-based authorization.</span></span>

<span data-ttu-id="c67a2-571">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="c67a2-571">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="c67a2-572">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="c67a2-572">Further Reading</span></span>

<span data-ttu-id="c67a2-573">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="c67a2-573">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="c67a2-574">Zugreifen auf und Aktualisieren von Daten in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="c67a2-574">Accessing and Updating Data in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="c67a2-575">ASP.NET 2,0-Assistenten-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="c67a2-575">ASP.NET 2.0 Wizard Control</span></span>](https://weblogs.asp.net/scottgu/archive/2006/02/21/438732.aspx)
- [<span data-ttu-id="c67a2-576">Erstellen einer Schritt-für-Schritt-Benutzeroberfläche mit dem ASP.NET 2,0-Assistenten-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="c67a2-576">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="c67a2-577">Erstellen von benutzerdefinierten DataSource-Steuerelement Parametern</span><span class="sxs-lookup"><span data-stu-id="c67a2-577">Creating Custom DataSource Control Parameters</span></span>](http://aspnet.4guysfromrolla.com/articles/110106-1.aspx)
- [<span data-ttu-id="c67a2-578">Anpassen des Steuer Elements "kreateuserwizard"</span><span class="sxs-lookup"><span data-stu-id="c67a2-578">Customizing the CreateUserWizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx)
- [<span data-ttu-id="c67a2-579">Schnellstarts für DetailsView-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="c67a2-579">DetailsView Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/detailsview.aspx)
- [<span data-ttu-id="c67a2-580">Anzeigen von Daten mit dem ListView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="c67a2-580">Displaying Data with the ListView Control</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="c67a2-581">Dissecting der Validierungs Steuerelemente in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="c67a2-581">Dissecting the Validation Controls in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)
- [<span data-ttu-id="c67a2-582">Bearbeiten und Löschen von Daten</span><span class="sxs-lookup"><span data-stu-id="c67a2-582">Editing Insert and Deleting Data</span></span>](../../data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)
- [<span data-ttu-id="c67a2-583">Formular Validierung in ASP.net</span><span class="sxs-lookup"><span data-stu-id="c67a2-583">Form Validation in ASP.NET</span></span>](http://www.4guysfromrolla.com/webtech/090200-1.shtml)
- [<span data-ttu-id="c67a2-584">Sammeln von benutzerdefinierten Benutzer Registrierungsinformationen</span><span class="sxs-lookup"><span data-stu-id="c67a2-584">Gathering Custom User Registration Information</span></span>](https://weblogs.asp.net/scottgu/archive/2006/07/05/Tip_2F00_Trick_3A00_-Gathering-Custom-User-Registration-Information.aspx)
- [<span data-ttu-id="c67a2-585">Profile in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="c67a2-585">Profiles in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/440.aspx)
- [<span data-ttu-id="c67a2-586">Das ASP: ListView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="c67a2-586">The asp:ListView Control</span></span>](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)
- [<span data-ttu-id="c67a2-587">Schnellstart für Benutzerprofile</span><span class="sxs-lookup"><span data-stu-id="c67a2-587">User Profiles QuickStart</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/profile/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="c67a2-588">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="c67a2-588">About the Author</span></span>

<span data-ttu-id="c67a2-589">Scott Mitchell, Autor mehrerer ASP/ASP. net-Bücher und Gründer von 4GuysFromRolla.com, hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="c67a2-589">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c67a2-590">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="c67a2-590">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c67a2-591">Sein letztes Buch ist *[Sams Teach Yourself ASP.NET 2,0 in 24 Stunden](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="c67a2-591">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="c67a2-592">Scott kann über [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/)erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="c67a2-592">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="c67a2-593">Besonders vielen Dank...</span><span class="sxs-lookup"><span data-stu-id="c67a2-593">Special Thanks To…</span></span>

<span data-ttu-id="c67a2-594">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="c67a2-594">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c67a2-595">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="c67a2-595">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c67a2-596">Wenn dies der Fall ist, können Sie eine Zeile in [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)ablegen.</span><span class="sxs-lookup"><span data-stu-id="c67a2-596">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c67a2-597">Vorheriges</span><span class="sxs-lookup"><span data-stu-id="c67a2-597">Previous</span></span>](user-based-authorization-vb.md)
