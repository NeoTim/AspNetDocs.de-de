---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
title: Validieren von Benutzer Anmelde Informationen anhand des Mitgliedschafts Benutzerspeicher (c#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial wird erläutert, wie Sie die Anmelde Informationen eines Benutzers anhand der programmgesteuerten Mittel und des Anmeldungs Steuer Elements überprüfen.
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 61aa4e08-aa81-4aeb-8ebe-19ba7a65e04c
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
msc.type: authoredcontent
ms.openlocfilehash: fd50f4e63c75cf77eb21629d0c11a859da6b357d
ms.sourcegitcommit: 4e6d586faadbe4d9ef27122f86335ec9385134af
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/28/2020
ms.locfileid: "89045233"
---
# <a name="validating-user-credentials-against-the-membership-user-store-c"></a><span data-ttu-id="ac765-103">Überprüfen der Anmeldeinformationen anhand des Mitgliedschaftsbenutzerspeichers (C#)</span><span class="sxs-lookup"><span data-stu-id="ac765-103">Validating User Credentials Against the Membership User Store (C#)</span></span>

<span data-ttu-id="ac765-104">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ac765-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ac765-105">[Code herunterladen](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) oder [PDF herunterladen](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="ac765-105">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span></span>

> <span data-ttu-id="ac765-106">In diesem Tutorial wird erläutert, wie Sie die Anmelde Informationen eines Benutzers anhand der programmgesteuerten Mittel und des Anmeldungs Steuer Elements anhand des Mitgliedschafts Benutzerspeicher überprüfen.</span><span class="sxs-lookup"><span data-stu-id="ac765-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="ac765-107">Wir sehen uns auch an, wie die Darstellung und das Verhalten des Anmeldungs Steuer Elements angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="ac765-108">Einführung</span><span class="sxs-lookup"><span data-stu-id="ac765-108">Introduction</span></span>

<span data-ttu-id="ac765-109">Im <a id="Tutorial05"></a> [vorherigen Tutorial](creating-user-accounts-cs.md) haben wir uns mit dem Erstellen eines neuen Benutzerkontos im Mitgliedschafts Framework beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="ac765-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-cs.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="ac765-110">Wir haben uns zunächst mit dem programmgesteuerten Erstellen von Benutzerkonten über die `Membership` -Methode der Klasse beschäftigt `CreateUser` und dann mit dem websteuer Element CreateUserWizard untersucht.</span><span class="sxs-lookup"><span data-stu-id="ac765-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="ac765-111">Auf der Anmeldeseite werden jedoch derzeit die angegebenen Anmelde Informationen anhand einer hart codierten Liste von Benutzernamen-und Kenn Wortpaaren überprüft.</span><span class="sxs-lookup"><span data-stu-id="ac765-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="ac765-112">Wir müssen die Logik der Anmeldeseite aktualisieren, damit die Anmelde Informationen im Benutzerspeicher des Mitgliedschafts Frameworks überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="ac765-113">Ähnlich wie beim Erstellen von Benutzerkonten können Anmelde Informationen Programm gesteuert oder deklarativ überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="ac765-114">Die Mitgliedschafts-API enthält eine Methode zum programmgesteuerten Überprüfen der Anmelde Informationen eines Benutzers für den Benutzerspeicher.</span><span class="sxs-lookup"><span data-stu-id="ac765-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="ac765-115">Und ASP.net wird mit dem Login-websteuer Element ausgeliefert, das eine Benutzeroberfläche mit Textfeldern für den Benutzernamen und das Kennwort und eine Schaltfläche zum Anmelden rendert.</span><span class="sxs-lookup"><span data-stu-id="ac765-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="ac765-116">In diesem Tutorial wird erläutert, wie Sie die Anmelde Informationen eines Benutzers anhand der programmgesteuerten Mittel und des Anmeldungs Steuer Elements anhand des Mitgliedschafts Benutzerspeicher überprüfen.</span><span class="sxs-lookup"><span data-stu-id="ac765-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="ac765-117">Wir sehen uns auch an, wie die Darstellung und das Verhalten des Anmeldungs Steuer Elements angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="ac765-118">Legen Sie direkt los.</span><span class="sxs-lookup"><span data-stu-id="ac765-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="ac765-119">Schritt 1: Überprüfen der Anmelde Informationen anhand des Mitgliedschafts Benutzerspeicher</span><span class="sxs-lookup"><span data-stu-id="ac765-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="ac765-120">Bei Websites, die die Formular Authentifizierung verwenden, meldet sich ein Benutzer an der Website an, indem er eine Anmeldeseite eingibt und seine Anmelde Informationen eingibt.</span><span class="sxs-lookup"><span data-stu-id="ac765-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="ac765-121">Diese Anmelde Informationen werden dann mit dem Benutzerspeicher verglichen.</span><span class="sxs-lookup"><span data-stu-id="ac765-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="ac765-122">Wenn Sie gültig sind, wird dem Benutzer ein Formular Authentifizierungs Ticket erteilt, bei dem es sich um ein Sicherheits Token handelt, das die Identität und Authentizität des Besuchers angibt.</span><span class="sxs-lookup"><span data-stu-id="ac765-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="ac765-123">Verwenden Sie die `Membership` - [ `ValidateUser` Methode](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)der-Klasse, um einen Benutzer mit dem Mitgliedschafts Framework zu validieren.</span><span class="sxs-lookup"><span data-stu-id="ac765-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="ac765-124">Die- `ValidateUser` Methode nimmt zwei Eingabeparameter an: *`username`* und *`password`* gibt einen booleschen Wert zurück, der angibt, ob die Anmelde Informationen gültig sind.</span><span class="sxs-lookup"><span data-stu-id="ac765-124">The `ValidateUser` method takes in two input parameters - *`username`* and *`password`* - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="ac765-125">Wie bei der- `CreateUser` Methode, die wir im vorherigen Tutorial überprüft haben, delegiert die- `ValidateUser` Methode die tatsächliche Validierung an den konfigurierten Mitgliedschafts Anbieter.</span><span class="sxs-lookup"><span data-stu-id="ac765-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="ac765-126">`SqlMembershipProvider`Überprüft die angegebenen Anmelde Informationen, indem er das angegebene Kennwort des Benutzers über die `aspnet_Membership_GetPasswordWithFormat` gespeicherte Prozedur erhält.</span><span class="sxs-lookup"><span data-stu-id="ac765-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="ac765-127">Beachten Sie, dass die Kenn `SqlMembershipProvider` Wörter von Benutzern in einem von drei Formaten speichert: Clear, verschlüsselt oder Hash.</span><span class="sxs-lookup"><span data-stu-id="ac765-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="ac765-128">Die `aspnet_Membership_GetPasswordWithFormat` gespeicherte Prozedur gibt das Kennwort im RAW-Format zurück.</span><span class="sxs-lookup"><span data-stu-id="ac765-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="ac765-129">Bei verschlüsselten oder Hash Kennwörtern transformiert der den `SqlMembershipProvider` *`password`* in die Methode übergebenen Wert `ValidateUser` in den entsprechenden verschlüsselten oder Hashwert und vergleicht ihn dann mit dem, was von der Datenbank zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="ac765-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the *`password`* value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="ac765-130">Wenn das in der Datenbank gespeicherte Kennwort mit dem vom Benutzer eingegebenen formatierten Kennwort übereinstimmt, sind die Anmelde Informationen gültig.</span><span class="sxs-lookup"><span data-stu-id="ac765-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="ac765-131">Aktualisieren Sie die Anmeldeseite (~/ `Login.aspx` ), damit die angegebenen Anmelde Informationen anhand des Mitgliedschafts Framework-Benutzer Stores überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="ac765-132">Wir haben diese Anmeldeseite im Abschnitt <a id="Tutorial02"></a> [*Übersicht über die Formular Authentifizierung*](../introduction/an-overview-of-forms-authentication-cs.md) erstellt und eine Schnittstelle mit zwei Textfeldern für Benutzername und Kennwort, ein Kontrollkästchen für die Erinnerung und eine Anmelde Schaltfläche erstellt (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="ac765-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="ac765-133">Der Code überprüft die eingegebenen Anmelde Informationen anhand einer hart codierten Liste von Benutzernamen-und Kenn Wortpaaren (Scott/Password, jisun/Password und SAM/Password).</span><span class="sxs-lookup"><span data-stu-id="ac765-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="ac765-134">Im Tutorial zur <a id="Tutorial03"></a> [*Konfiguration von Formular Authentifizierung und erweiterten Themen*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) haben wir den Code der Anmeldeseite aktualisiert, um zusätzliche Informationen in der Eigenschaft des Formular Authentifizierungs Tickets zu speichern `UserData` .</span><span class="sxs-lookup"><span data-stu-id="ac765-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="ac765-135">[![Die Benutzeroberfläche der Anmeldeseite enthält zwei Textfelder, eine CheckBoxList und eine Schaltfläche.](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span></span>

<span data-ttu-id="ac765-136">**Abbildung 1**: die Benutzeroberfläche der Anmeldeseite enthält zwei Textfelder, eine CheckBoxList und eine Schaltfläche ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="ac765-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span></span>

<span data-ttu-id="ac765-137">Die Benutzeroberfläche der Anmeldeseite kann unverändert bleiben, aber wir müssen den Ereignishandler der Anmelde Schaltfläche durch Code ersetzen, der `Click` den Benutzer mit dem Mitgliedschafts Framework-Benutzerspeicher überprüft.</span><span class="sxs-lookup"><span data-stu-id="ac765-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="ac765-138">Aktualisieren Sie den Ereignishandler so, dass der zugehörige Code wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="ac765-138">Update the event handler so that its code appears as follows:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample1.cs)]

<span data-ttu-id="ac765-139">Dieser Code ist erstaunlich einfach.</span><span class="sxs-lookup"><span data-stu-id="ac765-139">This code is remarkably simple.</span></span> <span data-ttu-id="ac765-140">Wir beginnen mit dem Aufrufen der- `Membership.ValidateUser` Methode und übergeben den angegebenen Benutzernamen und das zugehörige Kennwort.</span><span class="sxs-lookup"><span data-stu-id="ac765-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="ac765-141">Wenn diese Methode true zurückgibt, wird der Benutzer über die `FormsAuthentication` RedirectFromLoginPage-Methode der Klasse bei der Site angemeldet.</span><span class="sxs-lookup"><span data-stu-id="ac765-141">If that method returns true, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="ac765-142">(Wie in der <a id="Tutorial2"></a> In der Übersicht über das Tutorial zur [*Formular Authentifizierung*](../introduction/an-overview-of-forms-authentication-cs.md) wird das `FormsAuthentication.RedirectFromLoginPage` Formular Authentifizierungs Ticket erstellt, und der Benutzer wird dann zur entsprechenden Seite umgeleitet.) Wenn die Anmelde Informationen ungültig sind, wird die `InvalidCredentialsMessage` Bezeichnung jedoch angezeigt, und der Benutzer wird darüber informiert, dass der Benutzername oder das Kennwort falsch war.</span><span class="sxs-lookup"><span data-stu-id="ac765-142">(As we discussed in the <a id="Tutorial2"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="ac765-143">Das ist schon alles!</span><span class="sxs-lookup"><span data-stu-id="ac765-143">That's all there is to it!</span></span>

<span data-ttu-id="ac765-144">Um zu testen, ob die Anmeldeseite erwartungsgemäß funktioniert, versuchen Sie, sich mit einem der Benutzerkonten anzumelden, die Sie im vorherigen Tutorial erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="ac765-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="ac765-145">Wenn Sie noch kein Konto erstellt haben, erstellen Sie ein Konto auf der `~/Membership/CreatingUserAccounts.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="ac765-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-146">Wenn der Benutzer die Anmelde Informationen eingibt und das Formular der Anmeldeseite sendet, werden die Anmelde Informationen, einschließlich Ihres Kennworts, über das Internet als nur- *Text*an den Webserver übertragen.</span><span class="sxs-lookup"><span data-stu-id="ac765-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="ac765-147">Dies bedeutet, dass der Benutzername und das Kennwort von Hacker-Ermittlung des Netzwerk Datenverkehrs angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="ac765-148">Um dies zu verhindern, ist es von entscheidender Bedeutung, den Netzwerk Datenverkehr mithilfe von [SSL (Secure Socket Layer)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)zu verschlüsseln.</span><span class="sxs-lookup"><span data-stu-id="ac765-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="ac765-149">Dadurch wird sichergestellt, dass die Anmelde Informationen (und das HTML-Markup der gesamten Seite) ab dem Zeitpunkt, an dem Sie den Browser verlassen, verschlüsselt werden, bis Sie vom Webserver empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="ac765-150">Wie das Mitgliedschafts Framework ungültige Anmeldeversuche behandelt</span><span class="sxs-lookup"><span data-stu-id="ac765-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="ac765-151">Wenn ein Besucher die Anmeldeseite erreicht und seine Anmelde Informationen übermittelt, sendet der Browser eine HTTP-Anforderung an die Anmeldeseite.</span><span class="sxs-lookup"><span data-stu-id="ac765-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="ac765-152">Wenn die Anmelde Informationen gültig sind, enthält die HTTP-Antwort das Authentifizierungs Ticket in einem Cookie.</span><span class="sxs-lookup"><span data-stu-id="ac765-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="ac765-153">Aus diesem Grund könnte ein Hacker, der versucht, in ihren Standort zu unterbrechen, ein Programm erstellen, das HTTP-Anforderungen mit einem gültigen Benutzernamen und einer Vermutung am Kennwort an die Anmeldeseite sendet.</span><span class="sxs-lookup"><span data-stu-id="ac765-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="ac765-154">Wenn die Kenn Wort Schätzung richtig ist, gibt die Anmeldeseite das Authentifizierungs Ticket Cookie zurück. zu diesem Zeitpunkt weiß das Programm, dass es auf ein gültiges Paar aus Benutzername und Kennwort gestoßen ist.</span><span class="sxs-lookup"><span data-stu-id="ac765-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="ac765-155">Durch Brute-Force kann ein solches Programm möglicherweise auf das Kennwort eines Benutzers stoßen, insbesondere, wenn das Kennwort schwach ist.</span><span class="sxs-lookup"><span data-stu-id="ac765-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="ac765-156">Um solche Brute-Force-Angriffe zu vermeiden, sperrt das Mitgliedschafts Framework einen Benutzer, wenn innerhalb eines bestimmten Zeitraums eine bestimmte Anzahl von erfolglosen Anmelde versuchen vorliegt.</span><span class="sxs-lookup"><span data-stu-id="ac765-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="ac765-157">Die genauen Parameter können mit den folgenden beiden Konfigurationseinstellungen für den Mitgliedschafts Anbieter konfiguriert werden:</span><span class="sxs-lookup"><span data-stu-id="ac765-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="ac765-158">`maxInvalidPasswordAttempts` : gibt an, wie viele ungültige Kenn Wort Versuche für den Benutzer innerhalb des Zeitraums zulässig sind, bevor das Konto gesperrt wird. Der Standardwert ist 5.</span><span class="sxs-lookup"><span data-stu-id="ac765-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="ac765-159">`passwordAttemptWindow` : gibt den Zeitraum in Minuten an, in dem die angegebene Anzahl von ungültigen Anmelde versuchen bewirkt, dass das Konto gesperrt wird. Der Standardwert ist 10.</span><span class="sxs-lookup"><span data-stu-id="ac765-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="ac765-160">Wenn ein Benutzer gesperrt wurde, kann er sich erst anmelden, wenn ein Administrator Ihr Konto entsperrt.</span><span class="sxs-lookup"><span data-stu-id="ac765-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="ac765-161">Wenn ein Benutzer gesperrt ist, gibt die `ValidateUser` Methode *immer* zurück `false` , auch wenn gültige Anmelde Informationen angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-161">When a user is locked out, the `ValidateUser` method will *always* return `false`, even if valid credentials are supplied.</span></span> <span data-ttu-id="ac765-162">Wenngleich dieses Verhalten die Wahrscheinlichkeit verringert, dass ein Hacker über Brute-Force-Methoden in Ihre Website unterteilt wird, kann es dazu führen, dass ein gültiger Benutzer gesperrt wird, der das Kennwort vergessen hat oder versehentlich die Feststell Sperre oder einen ungültigen Typisierungs Tag aufweist.</span><span class="sxs-lookup"><span data-stu-id="ac765-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="ac765-163">Leider gibt es kein integriertes Tool zum Entsperren eines Benutzerkontos.</span><span class="sxs-lookup"><span data-stu-id="ac765-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="ac765-164">Zum Entsperren eines Kontos können Sie die Datenbank direkt ändern: Ändern Sie das `IsLockedOut` Feld in der `aspnet_Membership` Tabelle für das entsprechende Benutzerkonto, oder erstellen Sie eine webbasierte Schnittstelle, die ausgesperrte Konten mit Optionen zum Entsperren auflistet.</span><span class="sxs-lookup"><span data-stu-id="ac765-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="ac765-165">In einem zukünftigen Tutorial wird das Erstellen von Verwaltungs Schnittstellen für das Ausführen allgemeiner Benutzerkonten-und Rollen bezogener Aufgaben untersucht.</span><span class="sxs-lookup"><span data-stu-id="ac765-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-166">Ein Nachteil der- `ValidateUser` Methode besteht darin, dass, wenn die angegebenen Anmelde Informationen ungültig sind, keine Erklärung dazu bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="ac765-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="ac765-167">Die Anmelde Informationen sind möglicherweise ungültig, weil im Benutzerspeicher kein entsprechendes Benutzername/Kennwort-Paar vorhanden ist oder der Benutzer noch nicht genehmigt wurde oder weil der Benutzer gesperrt wurde. In Schritt 4 sehen Sie, wie eine ausführlichere Meldung an den Benutzer angezeigt wird, wenn der Anmeldeversuch fehlschlägt.</span><span class="sxs-lookup"><span data-stu-id="ac765-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="ac765-168">Schritt 2: Erfassen von Anmelde Informationen über das Anmeldungs-websteuer Element</span><span class="sxs-lookup"><span data-stu-id="ac765-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="ac765-169">Das [Anmeldungs-websteuer](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) Element rendert eine Standardbenutzer Oberfläche, die dem von uns in der Übersicht über die <a id="SKM5"></a> [*Formular Authentifizierung*](../introduction/an-overview-of-forms-authentication-cs.md) erstellten Tutorial sehr ähnlich ist.</span><span class="sxs-lookup"><span data-stu-id="ac765-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="SKM5"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial.</span></span> <span data-ttu-id="ac765-170">Mit dem Login-Steuerelement können wir die Schnittstelle erstellen, um die Anmelde Informationen des Besuchers zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="ac765-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="ac765-171">Außerdem signiert das Anmeldungs Steuerelement den Benutzer automatisch (vorausgesetzt, die übermittelten Anmelde Informationen sind gültig), sodass wir keinen Code schreiben müssen.</span><span class="sxs-lookup"><span data-stu-id="ac765-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="ac765-172">Wir aktualisieren `Login.aspx` die manuell erstellte Schnittstelle und den Code durch ein Login-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="ac765-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="ac765-173">Entfernen Sie zunächst das vorhandene Markup und den Code in `Login.aspx` .</span><span class="sxs-lookup"><span data-stu-id="ac765-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="ac765-174">Sie können Sie ganz einfach löschen oder einfach kommentieren. Um deklaratives Markup auszukommentieren, müssen Sie es mit den Trennzeichen und umschließen `<%--` `--%>` .</span><span class="sxs-lookup"><span data-stu-id="ac765-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="ac765-175">Sie können diese Trennzeichen manuell eingeben, oder Sie können, wie in Abbildung 2 gezeigt, den Text auswählen, der auskommentiert werden soll, und dann auf der Symbolleiste auf das Symbol ausgewählte Zeilen auskommentieren klicken.</span><span class="sxs-lookup"><span data-stu-id="ac765-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="ac765-176">Entsprechend können Sie das Symbol Auskommentieren der ausgewählten Zeilen verwenden, um den ausgewählten Code in der Code Behind-Klasse auszukommentieren.</span><span class="sxs-lookup"><span data-stu-id="ac765-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="ac765-177">[![Kommentieren Sie das vorhandene deklarative Markup und den Quellcode in "Login. aspx" aus.](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span></span>

<span data-ttu-id="ac765-178">**Abbildung 2**: auskommentieren des vorhandenen deklarativen Markups und des Quellcodes in `Login.aspx` ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in `Login.aspx` ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-179">Das Symbol auskommentieren des ausgewählten Zeilen Symbols ist nicht verfügbar, wenn Sie das deklarative Markup in Visual Studio 2005 anzeigen.</span><span class="sxs-lookup"><span data-stu-id="ac765-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="ac765-180">Wenn Sie nicht Visual Studio 2008 verwenden, müssen Sie die Trennzeichen und manuell hinzufügen `<%--` `--%>` .</span><span class="sxs-lookup"><span data-stu-id="ac765-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="ac765-181">Ziehen Sie als nächstes ein Anmelde Steuerelement aus der Toolbox auf die Seite, und legen Sie die zugehörige- `ID` Eigenschaft auf fest `myLogin` .</span><span class="sxs-lookup"><span data-stu-id="ac765-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="ac765-182">An diesem Punkt sollte der Bildschirm in etwa wie in Abbildung 3 aussehen.</span><span class="sxs-lookup"><span data-stu-id="ac765-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="ac765-183">Beachten Sie, dass die Standardschnittstelle des Anmeldungs Steuer Elements Textfeld-Steuerelemente für den Benutzernamen und das Kennwort, das nächste Kontrollkästchen Speichern und eine Anmelde Schaltfläche enthält.</span><span class="sxs-lookup"><span data-stu-id="ac765-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="ac765-184">Es gibt auch Steuer `RequiredFieldValidator` Elemente für die beiden Textfelder.</span><span class="sxs-lookup"><span data-stu-id="ac765-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="ac765-185">[![Fügen Sie der Seite ein Anmelde Steuerelement hinzu.](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span></span>

<span data-ttu-id="ac765-186">**Abbildung 3**: Hinzufügen eines Anmelde Steuer Elements zur Seite ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span></span>

<span data-ttu-id="ac765-187">Und wir sind fertig!</span><span class="sxs-lookup"><span data-stu-id="ac765-187">And we're done!</span></span> <span data-ttu-id="ac765-188">Wenn Sie auf die Schaltfläche Anmelden des Anmeldungs Steuer Elements klicken, wird ein Postback ausgeführt, und das Login-Steuerelement ruft die- `Membership.ValidateUser` Methode auf und übergibt den eingegebenen Benutzernamen und das Kennwort.</span><span class="sxs-lookup"><span data-stu-id="ac765-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="ac765-189">Wenn die Anmelde Informationen ungültig sind, zeigt das Anmeldungs Steuerelement eine solche Meldung an.</span><span class="sxs-lookup"><span data-stu-id="ac765-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="ac765-190">Wenn die Anmelde Informationen jedoch gültig sind, erstellt das Anmelde Steuerelement das Formular Authentifizierungs Ticket und leitet den Benutzer an die entsprechende Seite weiter.</span><span class="sxs-lookup"><span data-stu-id="ac765-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="ac765-191">Das-Anmelde Steuerelement verwendet vier Faktoren, um die entsprechende Seite zu bestimmen, an die der Benutzer nach erfolgreicher Anmeldung umgeleitet werden soll:</span><span class="sxs-lookup"><span data-stu-id="ac765-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="ac765-192">Gibt an, ob sich das Anmelde Steuerelement auf der Anmeldeseite befindet, wie durch `loginUrl` Festlegen von in der Konfiguration der Formular Authentifizierung definiert. der Standardwert dieser Einstellung lautet: `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="ac765-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="ac765-193">Das vorhanden sein eines `ReturnUrl` QueryString-Parameters</span><span class="sxs-lookup"><span data-stu-id="ac765-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="ac765-194">Der Wert der [ `DestinationUrl` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx) des Anmeldungs Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="ac765-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="ac765-195">Der `defaultUrl` in den Konfigurationseinstellungen der Formular Authentifizierung angegebene Wert. der Standardwert dieser Einstellung ist `Default.aspx`</span><span class="sxs-lookup"><span data-stu-id="ac765-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is `Default.aspx`</span></span>

<span data-ttu-id="ac765-196">Abbildung 4 zeigt, wie das Anmeldungs Steuerelement diese vier Parameter verwendet, um die entsprechende Seiten Entscheidung zu treffen.</span><span class="sxs-lookup"><span data-stu-id="ac765-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="ac765-197">[![Fügen Sie der Seite ein Anmelde Steuerelement hinzu.](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span></span>

<span data-ttu-id="ac765-198">**Abbildung 4**: Hinzufügen eines Anmelde Steuer Elements zur Seite ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span></span>

<span data-ttu-id="ac765-199">Nehmen Sie sich einen Moment Zeit, um das Anmeldungs Steuerelement zu testen, indem Sie die Website über einen Browser besuchen und sich als vorhandener Benutzer im Mitgliedschafts Framework anmelden.</span><span class="sxs-lookup"><span data-stu-id="ac765-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="ac765-200">Die gerenderte Schnittstelle des Anmelde Steuer Elements ist hochgradig konfigurierbar.</span><span class="sxs-lookup"><span data-stu-id="ac765-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="ac765-201">Es gibt eine Reihe von Eigenschaften, die ihre Darstellung beeinflussen. Darüber hinaus kann das Login-Steuerelement in eine Vorlage konvertiert werden, um das Layout der Benutzeroberflächen Elemente genau zu steuern.</span><span class="sxs-lookup"><span data-stu-id="ac765-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="ac765-202">Im weiteren Verlauf dieses Schritts wird untersucht, wie die Darstellung und das Layout angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="ac765-203">Anpassen der Darstellung des Anmeldungs Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="ac765-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="ac765-204">Die Standard Eigenschafts Einstellungen des Login-Steuer Elements stellen eine Benutzeroberfläche mit einem Titel (anmelden), Textfeld-und Bezeichnungs Steuerelement für die Eingaben für Benutzername und Kennwort, das nächste Kontrollkästchen Speichern und eine Anmelde Schaltfläche dar.</span><span class="sxs-lookup"><span data-stu-id="ac765-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="ac765-205">Der Anschein ist, dass diese Elemente über die zahlreichen Eigenschaften des Anmeldungs Steuer Elements konfiguriert werden können.</span><span class="sxs-lookup"><span data-stu-id="ac765-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="ac765-206">Darüber hinaus können zusätzliche Benutzeroberflächen Elemente, wie z. b. ein Link zu einer Seite, um ein neues Benutzerkonto zu erstellen, hinzugefügt werden, indem eine Eigenschaft oder zwei festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="ac765-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="ac765-207">Wir beschäftigen uns ein paar Zeit, um die Darstellung unseres Login-Steuer Elements zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="ac765-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="ac765-208">Da `Login.aspx` auf der Seite bereits Text am oberen Rand der Seite angezeigt wird, die Anmelde Informationen meldet, ist der Titel des Anmeldungs Steuer Elements überflüssig.</span><span class="sxs-lookup"><span data-stu-id="ac765-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="ac765-209">Löschen Sie daher den [ `TitleText` Eigenschafts](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) Wert, um den Titel des Anmeldungs Steuer Elements zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="ac765-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="ac765-210">Benutzer Name: und Kennwort: Bezeichnungen Links von zwei TextBox-Steuerelementen können über die [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) [ `PasswordLabelText` Eigenschaften](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)und angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="ac765-211">Ändern Sie den Benutzernamen: Bezeichnung in "Benutzername:".</span><span class="sxs-lookup"><span data-stu-id="ac765-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="ac765-212">Die Formatvorlagen und TextBox-Stile können über die-Eigenschaft bzw. die-Eigenschaft konfiguriert werden [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) . [ `TextBoxStyle` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)</span><span class="sxs-lookup"><span data-stu-id="ac765-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="ac765-213">Die Text-Eigenschaft für das nächste Mal speichern kann über das Anmeldungs Steuerelement festgelegt werden, und der aktivierte [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx) Standardzustand kann über den [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (standardmäßig false) konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="ac765-214">Legen Sie die-Eigenschaft auf "true" fest, `RememberMeSet` damit das Kontrollkästchen "merken Sie sich das nächste Mal" standardmäßig aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="ac765-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="ac765-215">Das Login-Steuerelement verfügt über zwei Eigenschaften zum Anpassen des Layouts der Steuerelemente der Benutzeroberfläche.</span><span class="sxs-lookup"><span data-stu-id="ac765-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="ac765-216">Der [`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) gibt an, ob der Benutzername: und das Kennwort: Bezeichnungen auf der linken Seite der entsprechenden Textfelder (Standard) oder darüber angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-216">The [`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="ac765-217">Der [`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) gibt an, ob sich die Eingaben für Benutzername und Kennwort vertikal (eins oberhalb der anderen) oder horizontal befinden.</span><span class="sxs-lookup"><span data-stu-id="ac765-217">The [`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="ac765-218">Diese beiden Eigenschaften werden auf die Standardeinstellungen festgelegt, aber ich empfehle Ihnen, diese beiden Eigenschaften auf Ihre nicht standardmäßigen Werte festzulegen, um den resultierenden Effekt anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="ac765-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-219">Im nächsten Abschnitt, in dem Sie das Layout des Anmeldungs Steuer Elements konfigurieren, betrachten wir die Verwendung von Vorlagen, um das genaue Layout der Benutzeroberflächen Elemente des layoutsteuer Elements zu definieren.</span><span class="sxs-lookup"><span data-stu-id="ac765-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="ac765-220">Schließen Sie die Eigenschafts Einstellungen des Anmeldungs Steuer Elements [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) ein, indem Sie die [ `CreateUserUrl` Eigenschaften](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) und auf noch nicht registriert festlegen</span><span class="sxs-lookup"><span data-stu-id="ac765-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="ac765-221">Erstellen Sie ein Konto.</span><span class="sxs-lookup"><span data-stu-id="ac765-221">Create an account!</span></span> <span data-ttu-id="ac765-222">und `~/Membership/CreatingUserAccounts.aspx` bzw.</span><span class="sxs-lookup"><span data-stu-id="ac765-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="ac765-223">Dadurch wird der-Schnittstelle des Anmelde Steuer Elements ein Link hinzugefügt, der auf die Seite verweist, die wir im <a id="SKM6"></a> [vorherigen Tutorial](creating-user-accounts-cs.md)erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="ac765-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="SKM6"></a>[preceding tutorial](creating-user-accounts-cs.md).</span></span> <span data-ttu-id="ac765-224">Die Eigenschaften und-Eigenschaften und-Eigenschaften des Anmelde Steuer Elements [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) [ `HelpPageUrl` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) funktionieren auf die gleiche Weise wie das Rendern von Links zu einer Hilfeseite und einer Kenn Wort Wiederherstellungs Seite. [ `PasswordRecoveryUrl` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx)</span><span class="sxs-lookup"><span data-stu-id="ac765-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="ac765-225">Nachdem Sie diese Eigenschaften geändert haben, sollten das deklarative Markup und die Darstellung Ihres Anmeldungs Steuer Elements in etwa wie in Abbildung 5 dargestellt aussehen.</span><span class="sxs-lookup"><span data-stu-id="ac765-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="ac765-226">[![Die Eigenschaften Werte des Anmeldungs Steuer Elements legen seine Darstellung](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span></span>

<span data-ttu-id="ac765-227">**Abbildung 5**: die Eigenschaftswerte des Anmeldungs Steuer Elements legen seine Darstellung[vor (Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="ac765-228">Konfigurieren des Layouts des Anmeldungs Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="ac765-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="ac765-229">Die Standardbenutzer Oberfläche des Anmeldungs-websteuer Elements legt die Schnittstelle in einem HTML-Code fest `<table>` .</span><span class="sxs-lookup"><span data-stu-id="ac765-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="ac765-230">Aber was ist, wenn wir eine präzisere Kontrolle über die gerenderte Ausgabe benötigen?</span><span class="sxs-lookup"><span data-stu-id="ac765-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="ac765-231">Vielleicht möchten wir den `<table>` durch eine Reihe von `<div>` Tags ersetzen.</span><span class="sxs-lookup"><span data-stu-id="ac765-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="ac765-232">Oder was geschieht, wenn die Anwendung zusätzliche Anmelde Informationen für die Authentifizierung erfordert?</span><span class="sxs-lookup"><span data-stu-id="ac765-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="ac765-233">Viele Finanz Websites erfordern beispielsweise, dass Benutzer nicht nur einen Benutzernamen und ein Kennwort angeben, sondern auch eine persönliche Identifikationsnummer (PIN) oder andere identifizierende Informationen.</span><span class="sxs-lookup"><span data-stu-id="ac765-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="ac765-234">Der Grund dafür ist, dass das Anmelde Steuerelement in eine Vorlage konvertiert werden kann, von der aus das deklarative Markup der Schnittstelle explizit definiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="ac765-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="ac765-235">Wir müssen zwei Schritte durchführen, um das Anmeldungs Steuerelement zu aktualisieren, um zusätzliche Anmelde Informationen zu sammeln:</span><span class="sxs-lookup"><span data-stu-id="ac765-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="ac765-236">Aktualisieren Sie die-Schnittstelle des Anmelde Steuer Elements, um websteuer Elemente zum Erfassen der zusätzlichen Anmelde Informationen einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="ac765-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="ac765-237">Überschreiben Sie die interne Authentifizierungs Logik des Anmelde Steuer Elements so, dass ein Benutzer nur authentifiziert wird, wenn der Benutzername und das Kennwort gültig sind und die zusätzlichen Anmelde Informationen gültig sind.</span><span class="sxs-lookup"><span data-stu-id="ac765-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="ac765-238">Zum Ausführen der ersten Aufgabe müssen wir das Login-Steuerelement in eine Vorlage konvertieren und die erforderlichen websteuer Elemente hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ac765-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="ac765-239">Wie bei der zweiten Aufgabe kann die Authentifizierungs Logik des Anmeldungs Steuer Elements ersetzt werden, indem ein Ereignishandler für das- [ `Authenticate` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)des-Steuer Elements erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ac765-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="ac765-240">Aktualisieren Sie das Anmelde Steuerelement, damit Benutzer Benutzername, Kennwort und e-Mail-Adresse eingeben und nur den Benutzer authentifizieren können, wenn die angegebene e-Mail-Adresse mit Ihrer e-Mail-Adresse in der Datei übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="ac765-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="ac765-241">Zuerst muss die-Schnittstelle des Anmelde Steuer Elements in eine Vorlage konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="ac765-242">Wählen Sie im Smarttag des Anmeldungs Steuer Elements die Option in Vorlage konvertieren aus.</span><span class="sxs-lookup"><span data-stu-id="ac765-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="ac765-243">[![Konvertieren des Anmelde Steuer Elements in eine Vorlage](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span></span>

<span data-ttu-id="ac765-244">**Abbildung 6**: Konvertieren des Anmeldungs Steuer Elements in eine Vorlage ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-245">Wenn Sie das Anmeldungs Steuerelement auf seine vorab Vorlagen Version zurücksetzen möchten, klicken Sie auf den Link Zurücksetzen des Smarttags des-Steuer Elements.</span><span class="sxs-lookup"><span data-stu-id="ac765-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="ac765-246">Beim Umrechnen des Anmeldungs Steuer Elements in eine Vorlage wird dem `LayoutTemplate` deklarativen Markup des Steuer Elements ein hinzugefügt, wobei HTML-Elemente und websteuer Elemente die Benutzeroberfläche definieren.</span><span class="sxs-lookup"><span data-stu-id="ac765-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="ac765-247">Wie in Abbildung 7 gezeigt, werden durch die Typumwandlung in eine Vorlage eine Reihe von Eigenschaften aus dem Eigenschaftenfenster entfernt, z. b., `TitleText` `CreateUserUrl` usw., da diese Eigenschaftswerte bei Verwendung einer Vorlage ignoriert werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="ac765-248">[![Es sind weniger Eigenschaften verfügbar, wenn das Login-Steuerelement in eine Vorlage konvertiert wird.](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span></span>

<span data-ttu-id="ac765-249">**Abbildung 7**: Es sind weniger Eigenschaften verfügbar, wenn das Anmelde Steuerelement in eine Vorlage konvertiert wird ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span></span>

<span data-ttu-id="ac765-250">Das HTML-Markup in `LayoutTemplate` kann bei Bedarf geändert werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="ac765-251">Ebenso können Sie neue websteuer Elemente zur Vorlage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ac765-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="ac765-252">Es ist jedoch wichtig, dass die wichtigsten websteuer Elemente des Anmelde Steuer Elements in der Vorlage verbleiben und die zugewiesenen Werte beibehalten werden `ID` .</span><span class="sxs-lookup"><span data-stu-id="ac765-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="ac765-253">Entfernen oder benennen Sie insbesondere die `UserName` Textfelder oder nicht `Password` , das `RememberMe` Kontrollkästchen, die `LoginButton` Schaltfläche, die `FailureText` Bezeichnung oder die Steuer `RequiredFieldValidator` Elemente.</span><span class="sxs-lookup"><span data-stu-id="ac765-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="ac765-254">Um die e-Mail-Adresse des Besuchers zu erfassen, müssen wir der Vorlage ein Textfeld hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="ac765-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="ac765-255">Fügen Sie das folgende deklarative Markup zwischen der Tabellenzeile ( `<tr>` ), die das `Password` Textfeld enthält, und der Tabellenzeile mit dem Kontrollkästchen nächste Uhrzeit speichern hinzu:</span><span class="sxs-lookup"><span data-stu-id="ac765-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample2.aspx)]

<span data-ttu-id="ac765-256">Nachdem Sie das `Email` Textfeld hinzugefügt haben, besuchen Sie die Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="ac765-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="ac765-257">Wie in Abbildung 8 gezeigt, enthält die Benutzeroberfläche des Anmeldungs Steuer Elements jetzt ein drittes Textfeld.</span><span class="sxs-lookup"><span data-stu-id="ac765-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="ac765-258">[![Das Login-Steuerelement enthält jetzt ein Textfeld für die e-Mail-Adresse des Benutzers.](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span></span>

<span data-ttu-id="ac765-259">**Abbildung 8**: das Anmeldungs Steuerelement enthält jetzt ein Textfeld für die e-Mail-Adresse des Benutzers ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span></span>

<span data-ttu-id="ac765-260">An diesem Punkt verwendet das Anmeldungs Steuerelement immer noch die- `Membership.ValidateUser` Methode, um die angegebenen Anmelde Informationen zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="ac765-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="ac765-261">Dementsprechend hat der in das Textfeld eingegebene Wert `Email` keinen Einfluss darauf, ob sich der Benutzer anmelden kann.</span><span class="sxs-lookup"><span data-stu-id="ac765-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="ac765-262">In Schritt 3 wird erläutert, wie Sie die Authentifizierungs Logik des Anmeldungs Steuer Elements überschreiben, sodass die Anmelde Informationen nur gültig sind, wenn der Benutzername und das Kennwort gültig sind und die angegebene e-Mail-Adresse mit der e-Mail-Adresse der Datei übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="ac765-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="ac765-263">Schritt 3: Ändern der Authentifizierungs Logik des Anmeldungs Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="ac765-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="ac765-264">Wenn ein Besucher Ihre Anmelde Informationen bereitstellt und auf die Schaltfläche Anmelden klickt, wird ein Postback durchlaufen, und das Anmelde Steuerelement durchläuft seinen Authentifizierungs Workflow.</span><span class="sxs-lookup"><span data-stu-id="ac765-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="ac765-265">Der Workflow beginnt mit der Erhöhung des- [ `LoggingIn` Ereignisses](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="ac765-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="ac765-266">Alle diesem Ereignis zugeordneten Ereignishandler können den Anmeldevorgang abbrechen, indem Sie die- `e.Cancel` Eigenschaft auf festlegen `true` .</span><span class="sxs-lookup"><span data-stu-id="ac765-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `true`.</span></span>

<span data-ttu-id="ac765-267">Wenn der Anmeldevorgang nicht abgebrochen wird, wird der Workflow durch das Erhöhen des- [ `Authenticate` Ereignisses](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="ac765-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="ac765-268">Wenn ein Ereignishandler für das-Ereignis vorhanden ist `Authenticate` , muss bestimmt werden, ob die angegebenen Anmelde Informationen gültig sind oder nicht.</span><span class="sxs-lookup"><span data-stu-id="ac765-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="ac765-269">Wenn kein Ereignishandler angegeben ist, verwendet das-Anmelde Steuerelement die- `Membership.ValidateUser` Methode, um die Gültigkeit der Anmelde Informationen zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="ac765-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="ac765-270">Wenn die angegebenen Anmelde Informationen gültig sind, wird das Formular Authentifizierungs Ticket erstellt, das- [ `LoggedIn` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) ausgelöst, und der Benutzer wird an die entsprechende Seite umgeleitet.</span><span class="sxs-lookup"><span data-stu-id="ac765-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="ac765-271">Wenn die Anmelde Informationen jedoch als ungültig eingestuft werden, wird das- [ `LoginError` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) ausgelöst, und es wird eine Meldung angezeigt, die den Benutzer darüber informiert, dass Ihre Anmelde Informationen ungültig sind.</span><span class="sxs-lookup"><span data-stu-id="ac765-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="ac765-272">Standardmäßig legt das Login-Steuerelement bei einem Fehler einfach die `FailureText` Text-Eigenschaft des Label-Steuer Elements auf eine Fehlermeldung fest (der Anmeldeversuch war nicht erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="ac765-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="ac765-273">Versuchen Sie es noch mal.)</span><span class="sxs-lookup"><span data-stu-id="ac765-273">Please try again ).</span></span> <span data-ttu-id="ac765-274">Wenn jedoch die- [ `FailureAction` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) des Anmeldungs Steuer Elements auf festgelegt ist `RedirectToLoginPage` , gibt das Anmelde Steuerelement einen `Response.Redirect` an die Anmeldeseite aus, die den QueryString-Parameter anfügt `loginfailure=1` (was bewirkt, dass das Anmeldungs Steuerelement die Fehlermeldung anzeigt).</span><span class="sxs-lookup"><span data-stu-id="ac765-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="ac765-275">Abbildung 9 enthält ein Flussdiagramm des Authentifizierungs Workflows.</span><span class="sxs-lookup"><span data-stu-id="ac765-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="ac765-276">[![Der Authentifizierungs Workflow des Anmeldungs Steuer Elements.](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span></span>

<span data-ttu-id="ac765-277">**Abbildung 9**: der Authentifizierungs Workflow des Anmeldungs Steuer Elements ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-278">Wenn Sie sich Fragen, ob Sie die Seite der Seite verwenden würden `FailureAction` `RedirectToLogin` , sehen Sie sich das folgende Szenario an.</span><span class="sxs-lookup"><span data-stu-id="ac765-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="ac765-279">`Site.master`Zurzeit hat unsere Master Seite aktuell den Text "Hello, Stranger", der in der linken Spalte angezeigt wird, wenn Sie von einem anonymen Benutzer besucht wird. angenommen, Sie möchten den Text durch ein Anmelde Steuerelement ersetzen.</span><span class="sxs-lookup"><span data-stu-id="ac765-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="ac765-280">Dadurch kann sich ein anonymer Benutzer über eine beliebige Seite auf der Website anmelden, anstatt ihn direkt auf die Anmeldeseite zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="ac765-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="ac765-281">Wenn sich ein Benutzer jedoch nicht über das Anmelde Steuerelement anmelden konnte, das von der Master Seite gerendert wurde, ist es möglicherweise sinnvoll, Sie an die Anmeldeseite () umzuleiten, `Login.aspx` da diese Seite wahrscheinlich zusätzliche Anweisungen, Links und andere Hilfe enthält, wie z. b</span><span class="sxs-lookup"><span data-stu-id="ac765-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="ac765-282">Erstellen des `Authenticate` Ereignis Handlers</span><span class="sxs-lookup"><span data-stu-id="ac765-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="ac765-283">Um die benutzerdefinierte Authentifizierungs Logik einzuschließen, müssen wir einen Ereignishandler für das-Ereignis des Anmeldungs Steuer Elements erstellen `Authenticate` .</span><span class="sxs-lookup"><span data-stu-id="ac765-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="ac765-284">Durch das Erstellen eines Ereignis Handlers für das- `Authenticate` Ereignis wird die folgende Ereignishandlerdefinition generiert:</span><span class="sxs-lookup"><span data-stu-id="ac765-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample3.cs)]

<span data-ttu-id="ac765-285">Wie Sie sehen können, `Authenticate` wird dem Ereignishandler ein Objekt vom Typ [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) als zweiter Eingabeparameter übergeben.</span><span class="sxs-lookup"><span data-stu-id="ac765-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="ac765-286">Die- `AuthenticateEventArgs` Klasse enthält eine boolesche Eigenschaft `Authenticated` mit dem Namen, die verwendet wird, um anzugeben, ob die angegebenen Anmelde Informationen gültig sind.</span><span class="sxs-lookup"><span data-stu-id="ac765-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="ac765-287">Unsere Aufgabe ist es, hier Code zu schreiben, der bestimmt, ob die angegebenen Anmelde Informationen gültig sind, und die- `e.Authenticate` Eigenschaft entsprechend festzulegen.</span><span class="sxs-lookup"><span data-stu-id="ac765-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="ac765-288">Bestimmen und Validieren der angegebenen Anmelde Informationen</span><span class="sxs-lookup"><span data-stu-id="ac765-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="ac765-289">Verwenden Sie die Eigenschaften und des Anmeldungs Steuer Elements [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) , um die vom Benutzer eingegebenen Benutzernamen-und Kenn Wort Anmelde Informationen zu bestimmen. [ `Password` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx)</span><span class="sxs-lookup"><span data-stu-id="ac765-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="ac765-290">Um die in alle zusätzlichen websteuer Elemente eingegebenen Werte (z. b. das `Email` Textfeld, das wir im vorherigen Schritt hinzugefügt haben) zu bestimmen, rufen *`LoginControlID`* `.FindControl` Sie mithilfe von (" *`controlID`* ") einen programmatischen Verweis auf das websteuer Element in der Vorlage ab, dessen- `ID` Eigenschaft gleich ist *`controlID`* .</span><span class="sxs-lookup"><span data-stu-id="ac765-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use *`LoginControlID`*`.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="ac765-291">Um beispielsweise einen Verweis auf das `Email` Textfeld zu erhalten, verwenden Sie den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="ac765-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`TextBox EmailTextBox = myLogin.FindControl("Email") as TextBox;`

<span data-ttu-id="ac765-292">Um die Anmelde Informationen des Benutzers zu überprüfen, müssen wir zwei Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="ac765-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="ac765-293">Sicherstellen, dass der angegebene Benutzername und das Kennwort gültig sind</span><span class="sxs-lookup"><span data-stu-id="ac765-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="ac765-294">Stellen Sie sicher, dass die eingegebene e-Mail-Adresse der e-Mail-Adresse für den Benutzer entspricht</span><span class="sxs-lookup"><span data-stu-id="ac765-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="ac765-295">Um die erste Überprüfung zu erreichen, können wir einfach die `Membership.ValidateUser` Methode wie in Schritt 1 verwenden.</span><span class="sxs-lookup"><span data-stu-id="ac765-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="ac765-296">Bei der zweiten Überprüfung müssen wir die e-Mail-Adresse des Benutzers bestimmen, damit wir ihn mit der e-Mail-Adresse vergleichen können, die Sie in das TextBox-Steuerelement eingegeben haben.</span><span class="sxs-lookup"><span data-stu-id="ac765-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="ac765-297">Um Informationen zu einem bestimmten Benutzer zu erhalten, verwenden Sie die `Membership` - [ `GetUser` Methode](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)der-Klasse.</span><span class="sxs-lookup"><span data-stu-id="ac765-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="ac765-298">Die- `GetUser` Methode verfügt über eine Reihe von über Ladungen.</span><span class="sxs-lookup"><span data-stu-id="ac765-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="ac765-299">Wenn Sie ohne Angabe von Parametern verwendet wird, werden Informationen über den aktuell angemeldeten Benutzer zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="ac765-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="ac765-300">Wenn Sie Informationen zu einem bestimmten Benutzer abrufen möchten, müssen Sie `GetUser` den Benutzernamen übergeben.</span><span class="sxs-lookup"><span data-stu-id="ac765-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="ac765-301">In jedem Fall `GetUser` gibt ein- [ `MembershipUser` Objekt](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)zurück, das Eigenschaften wie `UserName` ,, `Email` `IsApproved` , `IsOnline` usw. enthält.</span><span class="sxs-lookup"><span data-stu-id="ac765-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="ac765-302">Der folgende Code implementiert diese beiden Überprüfungen.</span><span class="sxs-lookup"><span data-stu-id="ac765-302">The following code implements these two checks.</span></span> <span data-ttu-id="ac765-303">Wenn beide übergeben werden, dann `e.Authenticate` wird auf festgelegt `true` , andernfalls wird Sie zugewiesen `false` .</span><span class="sxs-lookup"><span data-stu-id="ac765-303">If both pass, then `e.Authenticate` is set to `true`, otherwise it is assigned `false`.</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample4.cs)]

<span data-ttu-id="ac765-304">Wenn dieser Code vorhanden ist, versuchen Sie, sich als gültiger Benutzer anzumelden, und geben Sie den richtigen Benutzernamen, das Kennwort und die e-Mail-Adresse ein.</span><span class="sxs-lookup"><span data-stu-id="ac765-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="ac765-305">Versuchen Sie es erneut, aber verwenden Sie dieses Mal absichtlich eine falsche e-Mail-Adresse (siehe Abbildung 10).</span><span class="sxs-lookup"><span data-stu-id="ac765-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="ac765-306">Probieren Sie es schließlich mit einem nicht vorhandenen Benutzernamen ein drittes Mal aus.</span><span class="sxs-lookup"><span data-stu-id="ac765-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="ac765-307">Im ersten Fall sollten Sie erfolgreich an der Website angemeldet sein, aber in den letzten beiden Fällen sollten Sie die Meldung ungültige Anmelde Informationen für das Anmelde Steuerelement sehen.</span><span class="sxs-lookup"><span data-stu-id="ac765-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="ac765-308">[![Tito kann sich bei der Angabe einer falschen e-Mail-Adresse nicht anmelden](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span></span>

<span data-ttu-id="ac765-309">**Abbildung 10**: Tito kann sich nicht anmelden, wenn eine falsche e-Mail-Adresse bereitgestellt wird ([Klicken Sie, um das Bild in voller Größe](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="ac765-310">Wie im Abschnitt Gewusst wie: Ausführen von ungültigen Anmelde versuchen durch das Mitgliedschafts Framework in Schritt 1, wenn die `Membership.ValidateUser` Methode aufgerufen wird und ungültige Anmelde Informationen weitergegeben werden, verfolgt Sie den ungültigen Anmeldeversuch nach und sperrt den Benutzer, wenn er einen bestimmten Schwellenwert von ungültigen versuchen innerhalb eines bestimmten Zeitfensters überschreitet.</span><span class="sxs-lookup"><span data-stu-id="ac765-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="ac765-311">Da die benutzerdefinierte Authentifizierungs Logik die- `ValidateUser` Methode aufruft, wird durch ein falsches Kennwort für einen gültigen Benutzernamen der Wert für den ungültigen Anmeldeversuch erhöht. dieser Wert wird jedoch nicht inkrementiert, wenn der Benutzername und das Kennwort gültig sind, die e-Mail-Adresse aber falsch ist.</span><span class="sxs-lookup"><span data-stu-id="ac765-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="ac765-312">Wahrscheinlich ist dieses Verhalten geeignet, da es unwahrscheinlich ist, dass ein Hacker den Benutzernamen und das Kennwort kennt, aber Brute-Force-Verfahren verwenden muss, um die e-Mail-Adresse des Benutzers zu bestimmen.</span><span class="sxs-lookup"><span data-stu-id="ac765-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="ac765-313">Schritt 4: verbessern der Meldung zur ungültigen Anmelde Informationen des Anmelde Steuer Elements</span><span class="sxs-lookup"><span data-stu-id="ac765-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="ac765-314">Wenn ein Benutzer versucht, sich mit ungültigen Anmelde Informationen anzumelden, zeigt das Anmeldungs Steuerelement eine Meldung mit dem Hinweis an, dass der Anmeldeversuch nicht erfolgreich war.</span><span class="sxs-lookup"><span data-stu-id="ac765-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="ac765-315">Insbesondere zeigt das Steuerelement die Meldung an, die von der- [ `FailureText` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx)angegeben wird, die den Standardwert ihres Anmelde Versuchs nicht erfolgreich war.</span><span class="sxs-lookup"><span data-stu-id="ac765-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="ac765-316">Versuchen Sie es erneut.</span><span class="sxs-lookup"><span data-stu-id="ac765-316">Please try again.</span></span>

<span data-ttu-id="ac765-317">Beachten Sie, dass es viele Gründe gibt, warum die Anmelde Informationen eines Benutzers ungültig sein können:</span><span class="sxs-lookup"><span data-stu-id="ac765-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="ac765-318">Der Benutzername darf nicht vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="ac765-318">The username may not exist</span></span>
- <span data-ttu-id="ac765-319">Der Benutzername ist vorhanden, aber das Kennwort ist ungültig.</span><span class="sxs-lookup"><span data-stu-id="ac765-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="ac765-320">Der Benutzername und das Kennwort sind gültig, aber der Benutzer ist noch nicht genehmigt.</span><span class="sxs-lookup"><span data-stu-id="ac765-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="ac765-321">Der Benutzername und das Kennwort sind gültig, aber der Benutzer ist gesperrt (wahrscheinlich, weil er die Anzahl der ungültigen Anmeldeversuche innerhalb des angegebenen Zeitraums überschritten hat).</span><span class="sxs-lookup"><span data-stu-id="ac765-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="ac765-322">Möglicherweise gibt es auch andere Gründe, wenn Sie benutzerdefinierte Authentifizierungs Logik verwenden.</span><span class="sxs-lookup"><span data-stu-id="ac765-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="ac765-323">Beispielsweise können mit dem Code, den wir in Schritt 3 geschrieben haben, der Benutzername und das Kennwort gültig sein, die e-Mail-Adresse ist jedoch möglicherweise falsch.</span><span class="sxs-lookup"><span data-stu-id="ac765-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="ac765-324">Unabhängig davon, warum die Anmelde Informationen ungültig sind, wird im Anmelde Steuerelement dieselbe Fehlermeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="ac765-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="ac765-325">Dieses fehlende Feedback kann für einen Benutzer verwirrend sein, dessen Konto noch nicht genehmigt wurde oder der gesperrt wurde. Mit etwas Arbeit können wir jedoch festlegen, dass das Anmeldungs Steuerelement eine geeignetere Meldung anzeigt.</span><span class="sxs-lookup"><span data-stu-id="ac765-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="ac765-326">Wenn ein Benutzer versucht, sich mit ungültigen Anmelde Informationen anzumelden, löst das-Anmelde Steuerelement sein `LoginError` Ereignis aus.</span><span class="sxs-lookup"><span data-stu-id="ac765-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="ac765-327">Erstellen Sie einen Ereignishandler für dieses Ereignis, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="ac765-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample5.cs)]

<span data-ttu-id="ac765-328">Der obige Code beginnt mit dem Festlegen der-Eigenschaft des Anmeldungs Steuer Elements `FailureText` auf den Standardwert (Ihr Anmeldeversuch war nicht erfolgreich.</span><span class="sxs-lookup"><span data-stu-id="ac765-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="ac765-329">Versuchen Sie es noch mal.)</span><span class="sxs-lookup"><span data-stu-id="ac765-329">Please try again ).</span></span> <span data-ttu-id="ac765-330">Anschließend wird überprüft, ob der angegebene Benutzername einem vorhandenen Benutzerkonto zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="ac765-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="ac765-331">Wenn dies der Fall ist, werden die `MembershipUser` -und-Eigenschaften des resultierenden Objekts `IsLockedOut` `IsApproved` angenommen, um zu bestimmen, ob das Konto gesperrt wurde oder noch nicht genehmigt wurde.</span><span class="sxs-lookup"><span data-stu-id="ac765-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="ac765-332">In beiden Fällen wird die- `FailureText` Eigenschaft auf einen entsprechenden-Wert aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="ac765-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="ac765-333">Um diesen Code zu testen, versuchen Sie absichtlich, sich als vorhandener Benutzer anzumelden, aber verwenden Sie ein falsches Kennwort.</span><span class="sxs-lookup"><span data-stu-id="ac765-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="ac765-334">Führen Sie diese fünfmal in einer Zeile innerhalb eines Zeitraums von 10 Minuten aus, und das Konto wird gesperrt. Wie in Abbildung 11 dargestellt, treten bei nachfolgenden Anmelde versuchen immer Fehler auf (selbst mit dem richtigen Kennwort), aber jetzt wird die Beschreibung angezeigt, dass Ihr Konto aufgrund zu vieler ungültiger Anmeldeversuche gesperrt wurde.</span><span class="sxs-lookup"><span data-stu-id="ac765-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="ac765-335">Wenden Sie sich an den Administrator, damit die Nachricht nicht gesperrt ist.</span><span class="sxs-lookup"><span data-stu-id="ac765-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="ac765-336">[![Tito hat zu viele ungültige Anmeldeversuche durchgeführt und wurde gesperrt.](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="ac765-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span></span>

<span data-ttu-id="ac765-337">**Abbildung 11**: Tito hat zu viele ungültige Anmeldeversuche durchgeführt und wurde gesperrt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="ac765-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ac765-338">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="ac765-338">Summary</span></span>

<span data-ttu-id="ac765-339">Vor diesem Tutorial haben unsere Anmeldeseite die angegebenen Anmelde Informationen anhand einer hart codierten Liste von Benutzername/Kennwort-Paaren überprüft.</span><span class="sxs-lookup"><span data-stu-id="ac765-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="ac765-340">In diesem Tutorial haben wir die Seite aktualisiert, um die Anmelde Informationen anhand des Mitgliedschafts Frameworks zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="ac765-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="ac765-341">In Schritt 1 haben wir uns mit der programmgesteuerten Verwendung der `Membership.ValidateUser` Methode beschäftigt.</span><span class="sxs-lookup"><span data-stu-id="ac765-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="ac765-342">In Schritt 2 haben wir unsere manuell erstellte Benutzeroberfläche und den Code durch das Login-Steuerelement ersetzt.</span><span class="sxs-lookup"><span data-stu-id="ac765-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="ac765-343">Das-Anmelde Steuerelement rendert eine Standard Anmelde Benutzeroberfläche und überprüft die Anmelde Informationen des Benutzers automatisch anhand des Mitgliedschafts-Frameworks.</span><span class="sxs-lookup"><span data-stu-id="ac765-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="ac765-344">Außerdem signiert das Anmeldungs Steuerelement im Falle gültiger Anmelde Informationen den Benutzer über die Formular Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="ac765-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="ac765-345">Kurz gesagt, ist eine voll funktionsfähige Anmelde Benutzer Funktionalität verfügbar, indem Sie einfach das Anmelde Steuerelement auf eine Seite ziehen, ohne zusätzliches deklaratives Markup oder Code.</span><span class="sxs-lookup"><span data-stu-id="ac765-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="ac765-346">Außerdem ist das Anmeldungs Steuerelement hochgradig anpassbar und ermöglicht ein gutes Maß an Kontrolle über die gerenderte Benutzeroberfläche und die Authentifizierungs Logik.</span><span class="sxs-lookup"><span data-stu-id="ac765-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="ac765-347">An diesem Punkt können Besucher unserer Website ein neues Benutzerkonto erstellen und sich bei der Website anmelden, aber wir haben noch immer das Einschränken des Zugriffs auf Seiten basierend auf dem authentifizierten Benutzer untersucht.</span><span class="sxs-lookup"><span data-stu-id="ac765-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="ac765-348">Zurzeit kann jeder Benutzer, der authentifiziert oder anonym ist, jede Seite auf unserer Website anzeigen.</span><span class="sxs-lookup"><span data-stu-id="ac765-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="ac765-349">Neben dem Steuern des Zugriffs auf die Seiten unserer Website auf Benutzerbasis haben wir möglicherweise bestimmte Seiten, deren Funktionalität vom Benutzer abhängt.</span><span class="sxs-lookup"><span data-stu-id="ac765-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="ac765-350">Im nächsten Tutorial wird erläutert, wie der Zugriff und die in-Page-Funktionalität basierend auf dem angemeldeten Benutzer eingeschränkt werden.</span><span class="sxs-lookup"><span data-stu-id="ac765-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="ac765-351">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="ac765-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="ac765-352">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="ac765-352">Further Reading</span></span>

<span data-ttu-id="ac765-353">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="ac765-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ac765-354">Anzeigen benutzerdefinierter Nachrichten für gesperrten und nicht genehmigte Benutzer</span><span class="sxs-lookup"><span data-stu-id="ac765-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="ac765-355">Überprüfen der Mitgliedschaft, Rollen und Profile von ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="ac765-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="ac765-356">Vorgehensweise: Erstellen einer ASP.net-Anmeldeseite</span><span class="sxs-lookup"><span data-stu-id="ac765-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="ac765-357">Technische Dokumentation zum Anmelde Steuerelement</span><span class="sxs-lookup"><span data-stu-id="ac765-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="ac765-358">Verwenden der Anmeldungs Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="ac765-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="ac765-359">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="ac765-359">About the Author</span></span>

<span data-ttu-id="ac765-360">Scott Mitchell, Autor mehrerer ASP/ASP. net-Bücher und Gründer von 4GuysFromRolla.com, hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="ac765-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ac765-361">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="ac765-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ac765-362">Sein letztes Buch ist *[Sams Teach Yourself ASP.NET 2,0 in 24 Stunden](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="ac765-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="ac765-363">Scott kann bei [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) oder über seinen Blog von erreicht werden [http://ScottOnWriting.NET](http://scottonwriting.net/) .</span><span class="sxs-lookup"><span data-stu-id="ac765-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="ac765-364">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="ac765-364">Special Thanks To</span></span>

<span data-ttu-id="ac765-365">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="ac765-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ac765-366">Die führenden Reviewer für dieses Tutorial waren Teresa Murphy und Michael Olivero.</span><span class="sxs-lookup"><span data-stu-id="ac765-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="ac765-367">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="ac765-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ac765-368">Wenn dies der Fall ist, löschen Sie die Zeile in [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com) .</span><span class="sxs-lookup"><span data-stu-id="ac765-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ac765-369">[Zurück](creating-user-accounts-cs.md)
> [Weiter](user-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="ac765-369">[Previous](creating-user-accounts-cs.md)
[Next](user-based-authorization-cs.md)</span></span>
