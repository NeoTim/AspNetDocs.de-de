---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
title: Zuweisen von Rollen für Benutzer (c#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial werden. Sie erstellen zwei ASP.NET-Seiten zur Unterstützung bei der Verwaltung, welche Benutzer welche Rollen angehören. Die erste Seite enthält Funktionen, durch was finden Sie unter...
ms.author: riande
ms.date: 03/24/2008
ms.assetid: d522639a-5aca-421e-9a76-d73f95607f57
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-cs
msc.type: authoredcontent
ms.openlocfilehash: 482460248fb070b273c1ff97515152cacf66dbce
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108705"
---
# <a name="assigning-roles-to-users-c"></a><span data-ttu-id="6dc2d-104">Zuweisen von Rollen an Benutzer (C#)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-104">Assigning Roles to Users (C#)</span></span>

<span data-ttu-id="6dc2d-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6dc2d-106">[Code herunterladen](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) oder [PDF-Datei herunterladen](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_cs.pdf)</span></span>

> <span data-ttu-id="6dc2d-107">In diesem Tutorial werden. Sie erstellen zwei ASP.NET-Seiten zur Unterstützung bei der Verwaltung, welche Benutzer welche Rollen angehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="6dc2d-108">Die erste Seite enthält Funktionen, um festzustellen, welche Benutzer zu einer bestimmten Rolle gehören welche Rollen, die ein bestimmter Benutzer gehört, und die Möglichkeit zum Zuweisen oder entfernen einen bestimmten Benutzer aus einer bestimmten Rolle.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="6dc2d-109">Wir werden in der zweiten Seite des Steuerelements CreateUserWizard erweitern, enthalten einen Schritt zum angeben, welche Rollen zu der neu erstellte Benutzer gehört.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="6dc2d-110">Dies ist nützlich in Szenarien, in denen ein Administrator neue Benutzerkonten erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

## <a name="introduction"></a><span data-ttu-id="6dc2d-111">Einführung</span><span class="sxs-lookup"><span data-stu-id="6dc2d-111">Introduction</span></span>

<span data-ttu-id="6dc2d-112">Die <a id="_msoanchor_1"> </a> [vorherigen Tutorial](creating-and-managing-roles-cs.md) untersucht das Rollen-Framework und die `SqlRoleProvider`; erläutert, wie Sie mit der `Roles` Klasse zu erstellen, abrufen und Löschen von Rollen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-cs.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="6dc2d-113">Zusätzlich zum Erstellen und Löschen von Rollen, müssen wir in der Lage, beim Zuweisen oder Entfernen von Benutzern aus einer Rolle sein.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="6dc2d-114">Leider wird ASP.NET nicht geliefert, mit allen Websteuerelementen für die Verwaltung, welche Benutzer welche Rollen angehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="6dc2d-115">Stattdessen müssen wir unsere eigene ASP.NET-Seiten, um diese Zuordnungen verwalten erstellen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="6dc2d-116">Die gute Nachricht ist, dass das Hinzufügen und Entfernen von Benutzern zu Rollen ist recht einfach.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="6dc2d-117">Die `Roles` Klasse enthält eine Reihe von Methoden zum Hinzufügen von einem oder mehreren Benutzern zu einer oder mehreren Rollen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="6dc2d-118">In diesem Tutorial werden. Sie erstellen zwei ASP.NET-Seiten zur Unterstützung bei der Verwaltung, welche Benutzer welche Rollen angehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="6dc2d-119">Die erste Seite enthält Funktionen, um festzustellen, welche Benutzer zu einer bestimmten Rolle gehören welche Rollen, die ein bestimmter Benutzer gehört, und die Möglichkeit zum Zuweisen oder entfernen einen bestimmten Benutzer aus einer bestimmten Rolle.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="6dc2d-120">Wir werden in der zweiten Seite des Steuerelements CreateUserWizard erweitern, enthalten einen Schritt zum angeben, welche Rollen zu der neu erstellte Benutzer gehört.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="6dc2d-121">Dies ist nützlich in Szenarien, in denen ein Administrator neue Benutzerkonten erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="6dc2d-122">Fangen wir an!</span><span class="sxs-lookup"><span data-stu-id="6dc2d-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="6dc2d-123">Auflisten von welchen Benutzern Rollen angehören</span><span class="sxs-lookup"><span data-stu-id="6dc2d-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="6dc2d-124">Der erste Tagesordnungspunkt für dieses Tutorial ist die Erstellung einer Webseite, aus der Benutzern Rollen zugewiesen werden können.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="6dc2d-125">Bevor wir uns mit Benutzern zu Rollen zuweisen befassen, lassen Sie uns zuerst darauf konzentrieren bestimmen, welche Benutzer welche Rollen angehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="6dc2d-126">Es gibt zwei Möglichkeiten, diese Informationen angezeigt: "Rolle" oder "von"Benutzer angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="6dc2d-127">Können wir den Besucher eine Rolle auszuwählen, und zeigen sie alle Benutzer, die die Rolle (der "by" Role"Display) angehören, oder konnte den Besucher, wählen Sie einen Benutzer aus, und zeigen sie die Rollen zugewiesen, die diesem Benutzer (die"von Benutzer"Display) aufgefordert.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="6dc2d-128">Die Ansicht "von" Role"eignet sich in Situationen, in dem wissen möchte, der Besucher die Gruppe von Benutzern, die zu einer bestimmten Rolle gehören; die Ansicht "von Benutzer" ist ideal, wenn der Besucher, Rollen für einen bestimmten Benutzer wissen muss.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="6dc2d-129">Werfen wir unserer Seite, die sowohl "Role" und "von Benutzer" sind Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="6dc2d-130">Zunächst wird mit dem Erstellen der Schnittstelle "von Benutzer".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="6dc2d-131">Diese Schnittstelle besteht aus einem Dropdown-Liste und eine Liste von Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="6dc2d-132">Die Dropdownliste wird mit der Gruppe von Benutzern im System aufgefüllt. die Kontrollkästchen werden die Rollen aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="6dc2d-133">Durch Auswahl eines Benutzers aus der Dropdown-Liste überprüft diese Rollen, die, denen der Benutzer gehört.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="6dc2d-134">Die Person, die auf der Seite dann aktivieren oder deaktivieren Sie die Kontrollkästchen zum Hinzufügen oder entfernen den ausgewählten Benutzer aus den entsprechenden Rollen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="6dc2d-135">Mit einer Dropdown-Liste in die Benutzerkonten ist nicht ideale Wahl für Websites, gibt es möglicherweise Hunderte von Benutzerkonten.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="6dc2d-136">Eine Dropdown-Liste wurde entwickelt, damit der Benutzer ein Element aus einer relativ kurzen Liste der Optionen auswählen kann.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="6dc2d-137">Es wird schnell unhandlich, wächst die Anzahl der Listenelemente.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="6dc2d-138">Wenn Sie eine Website erstellen, die potenziell großen Anzahl von Benutzerkonten verfügen sollen, Sie sollten in Betracht, eine alternative Benutzeroberfläche, wie z. B. einer navigierbaren GridView-Ansicht oder eine filterbar-Schnittstelle, die auflistet fordert den Besucher, mit einen Buchstaben zu wählen und dann nur Zeigt die Benutzer, deren Benutzername mit dem ausgewählten Buchstaben beginnt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>

## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="6dc2d-139">Schritt 1: Erstellen der Benutzeroberfläche "Von Benutzer"</span><span class="sxs-lookup"><span data-stu-id="6dc2d-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="6dc2d-140">Öffnen der `UsersAndRoles.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="6dc2d-141">Fügen Sie am oberen Rand der Seite, ein Label-Steuerelement mit dem Namen `ActionStatus` und lösche die `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="6dc2d-142">Wir zum Bereitstellen von Feedback zu den Aktionen, die ausgeführt wird, Anzeigen von Meldungen wie diese Bezeichnung verwenden, "Benutzer Tito hinzugefügt wurde die Rolle" Administratoren"" oder "Benutzer Jisun wurde aus entfernt die Rolle" Supervisor"."</span><span class="sxs-lookup"><span data-stu-id="6dc2d-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="6dc2d-143">Um diese erstellen, Nachrichten hervor, legen Sie die Bezeichnung des `CssClass` Eigenschaft auf "Wichtig".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample1.aspx)]

<span data-ttu-id="6dc2d-144">Fügen Sie die folgende CSS-Klassendefinition, um die `Styles.css` Stylesheet:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-cs/samples/sample2.css)]

<span data-ttu-id="6dc2d-145">Diese CSS-Definition weist den Browser an die Bezeichnung, die umfangreiche und rote Schrift angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="6dc2d-146">Abbildung 1 zeigt diesen Effekt über Visual Studio-Designer.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>

<span data-ttu-id="6dc2d-147">[![CssClass--Eigenschaft der Bezeichnung ergibt ein großes, rotes Schriftart](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-cs/_static/image2.png)](assigning-roles-to-users-cs/_static/image1.png)</span></span>

<span data-ttu-id="6dc2d-148">**Abbildung 1**: Der Bezeichnung des `CssClass` führt zu einer großen, Red-Schriftart ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image3.png))</span></span>

<span data-ttu-id="6dc2d-149">Fügen Sie einem DropDownList-Steuerelement auf der Seite legen Sie als Nächstes die `ID` Eigenschaft `UserList`, und legen Sie dessen `AutoPostBack` Eigenschaft auf "true".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="6dc2d-150">Wir verwenden diese DropDownList aller Benutzer im System aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="6dc2d-151">Diese Dropdownliste wird auf eine Auflistung von MembershipUser Objekte gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="6dc2d-152">Da soll der Dropdownliste die UserName-Eigenschaft des Objekts MembershipUser anzuzeigen (und als Wert für die Listenelemente verwenden), legen Sie die DropDownList `DataTextField` und `DataValueField` Eigenschaften auf "UserName".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="6dc2d-153">Fügen Sie unterhalb der Dropdownliste einen Repeater, mit dem Namen `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="6dc2d-154">Diesen Repeater werden alle Rollen im System als eine Reihe von Kontrollkästchen aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="6dc2d-155">Definieren des Repeaters `ItemTemplate` mithilfe der folgenden deklarativen Markups:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample3.aspx)]

<span data-ttu-id="6dc2d-156">Die `ItemTemplate` Markup enthält ein einzelnes Kontrollkästchen-Steuerelement mit dem Namen `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="6dc2d-157">Des Kontrollkästchens `AutoPostBack` Eigenschaft auf "true" festgelegt ist und die `Text` Eigenschaft gebunden ist `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="6dc2d-158">Der Grund dafür die Databinding-Syntax ist einfach `Container.DataItem` liegt daran, dass das Framework Rollen gibt die Liste von Rollennamen als Zeichenfolgenarray zurück, und es diesem Zeichenfolgenarray, das wir an der Repeater Bindung erfolgt ist.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="6dc2d-159">Eine ausführliche Beschreibung der warum diese Syntax verwendet wird, um den Inhalt eines Arrays an eine Web-Steuerelement gebunden anzuzeigen ist, würde den Rahmen dieses Tutorials.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="6dc2d-160">Weitere Informationen zu dieser Angelegenheit, finden Sie unter [binden ein Array von skalaren auf ein Websteuerelement Daten](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="6dc2d-161">An diesem Punkt sollte Ihre "von Benutzer" Schnittstelle deklaratives Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample4.aspx)]

<span data-ttu-id="6dc2d-162">Wir können nun den Code zum Binden Sie die Gruppe von Benutzerkonten in der Dropdownliste und den Satz von Rollen, des Repeaters schreiben.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="6dc2d-163">Fügen Sie in der Seite des Code-Behind-Klasse eine Methode, die mit dem Namen `BindUsersToUserList` und eine weitere mit dem Namen `BindRolesList`, mit dem folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample5.cs)]

<span data-ttu-id="6dc2d-164">Die `BindUsersToUserList` Methode ruft alle Benutzerkonten im System über die [ `Membership.GetAllUsers` Methode](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="6dc2d-165">Dies gibt eine [ `MembershipUserCollection` Objekt](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), dies ist eine Auflistung von [ `MembershipUser` Instanzen](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="6dc2d-166">Klicken Sie dann an diese Auflistung gebunden ist die `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="6dc2d-167">Die `MembershipUser` Instanzen dieser Zusammensetzung die Auflistung enthalten eine Vielzahl von Eigenschaften, z. B. `UserName`, `Email`, `CreationDate`, und `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="6dc2d-168">Um der Dropdownliste den Wert der anzuzeigenden weisen die `UserName` -Eigenschaft, sicher, dass die `UserList` DropDownList `DataTextField` und `DataValueField` auf "UserName" festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="6dc2d-169">Die `Membership.GetAllUsers` Methode verfügt über zwei Überladungen: eine, die keine Eingabeparameter akzeptiert und gibt alle Benutzer und eine, die ganzzahlige Werte für die Seite "Index" und "Seitengröße akzeptiert und nur die angegebene Teilmenge der Benutzer zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="6dc2d-170">Wenn werden große Mengen von Benutzerkonten, die in einer navigierbaren Element der Benutzeroberfläche angezeigt wird, kann die zweite Überladung verwendet werden, effizienter Seite über die Benutzer, da nur die genaue Teilmenge von Benutzerkonten anstelle aller Textknoten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>

<span data-ttu-id="6dc2d-171">Der `BindRolesToList` Methode beginnt mit dem Aufrufen der `Roles` Klasse [ `GetAllRoles` Methode](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), die ein Zeichenfolgenarray mit den Rollen im System zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="6dc2d-172">Diese Zeichenfolgen-Array wird dann an den Repeater gebunden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="6dc2d-173">Abschließend müssen wir diese beiden Methoden aufrufen, beim ersten die Seite laden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="6dc2d-174">Fügen Sie dem `Page_Load` -Ereignishandler folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample6.cs)]

<span data-ttu-id="6dc2d-175">Können Sie mit diesem Code werden die Seite über einen Browser besuchen; Ihr Bildschirm sollte ähnlich wie in Abbildung 2 aussehen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="6dc2d-176">Alle Benutzerkonten werden in der Dropdown Liste und darunter, aufgefüllt jede Rolle wird als ein Kontrollkästchen angezeigt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="6dc2d-177">Da wir legen die `AutoPostBack` Eigenschaften der DropDownList und Kontrollkästchen auf "true", ändern den ausgewählten Benutzer oder das Überprüfen und Deaktivieren einer Rolle bewirkt, dass einen Postback.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="6dc2d-178">Keine Aktion wird jedoch ausgeführt, da wir noch Code schreiben, um diese Aktionen zu behandeln müssen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="6dc2d-179">Wir werden diese Aufgaben in den nächsten beiden Abschnitten in Angriff nehmen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-179">We'll tackle these tasks in the next two sections.</span></span>

<span data-ttu-id="6dc2d-180">[![Die Seite zeigt die Benutzer und Rollen](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-cs/_static/image5.png)](assigning-roles-to-users-cs/_static/image4.png)</span></span>

<span data-ttu-id="6dc2d-181">**Abbildung 2**: Die Seite zeigt die Benutzer und Rollen ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image6.png))</span></span>

### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="6dc2d-182">Überprüfen die Rollen gehört von der ausgewählte Benutzer zu</span><span class="sxs-lookup"><span data-stu-id="6dc2d-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="6dc2d-183">Beim ersten Laden die Seite, oder wenn Besucher einen neuen Benutzer aus der Dropdown-Liste auswählt, müssen wir aktualisieren den `UsersRoleList`die Kontrollkästchen, damit eine bestimmte Rolle Kontrollkästchen aktiviert ist, nur dann, wenn der ausgewählte Benutzer, die dieser Rolle gehört.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="6dc2d-184">Um dies zu erreichen, erstellen Sie eine Methode namens `CheckRolesForSelectedUser` durch den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample7.cs)]

<span data-ttu-id="6dc2d-185">Der obige Code zunächst bestimmen, die der ausgewählte Benutzer ist.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="6dc2d-186">Klicken Sie dann der Rollen-Klasse verwendet [ `GetRolesForUser(userName)` Methode](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) des angegebenen Benutzers-Satz von Rollen als Zeichenfolgenarray zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="6dc2d-187">Als Nächstes des Repeater-Elemente aufgelistet werden und die entsprechenden `RoleCheckBox` Kontrollkästchen wird programmgesteuert auf die verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="6dc2d-188">Das Kontrollkästchen aktiviert ist, nur dann, wenn die Rolle, die es entspricht der in enthalten ist das `selectedUsersRoles` Zeichenfolgenarray.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="6dc2d-189">Die `selectedUserRoles.Contains<string>(...)` Syntax wird nicht kompiliert werden, wenn Sie ASP.NET Version 2.0 verwenden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-189">The `selectedUserRoles.Contains<string>(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="6dc2d-190">Die `Contains<string>` Methode ist Teil der [LINQ-Bibliothek](http://en.wikipedia.org/wiki/Language_Integrated_Query), dies ist neu in ASP.NET 3.5.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-190">The `Contains<string>` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="6dc2d-191">Wenn Sie noch ASP.NET Version 2.0 verwenden, verwenden Sie die [ `Array.IndexOf<string>` Methode](https://msdn.microsoft.com/library/eha9t187.aspx) stattdessen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf<string>` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>

<span data-ttu-id="6dc2d-192">Die `CheckRolesForSelectedUser` -Methode in zwei Fällen aufgerufen werden muss: beim ersten die Seite laden, und wenn die `UserList` DropDownLists ausgewählte Index geändert wird.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="6dc2d-193">Daher rufen diese Methode aus der `Page_Load` -Ereignishandler (nach dem Aufrufen der `BindUsersToUserList` und `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="6dc2d-194">Darüber hinaus erstellen Sie einen Ereignishandler für die DropDownList `SelectedIndexChanged` Ereignis und rufen Sie diese Methode von dort aus.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample8.cs)]

<span data-ttu-id="6dc2d-195">Mit diesem Code werden können Sie die Seite über den Browser testen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="6dc2d-196">Da jedoch die `UsersAndRoles.aspx` Seite derzeit verfügt nicht über die Möglichkeit zum Zuweisen von Benutzern zu Rollen, die keine Benutzer Rollen haben.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="6dc2d-197">Erstellen wir die Schnittstelle für das Zuweisen von Benutzern zu Rollen in Kürze, damit Sie Mein Wort, das dieser Code funktioniert, und stellen Sie sicher, dass dies der Fall höher ist, oder Sie können Benutzer manuell zu Rollen hinzufügen, durch Einfügen von Datensätzen in der `aspnet_UsersInRoles` Tabelle, um diese Functi zu testen. jetzt Onality.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="6dc2d-198">Zuweisen und Entfernen von Benutzern aus Rollen</span><span class="sxs-lookup"><span data-stu-id="6dc2d-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="6dc2d-199">Wenn der Besucher markiert oder ein Kontrollkästchen in der `UsersRoleList` Repeater müssen wir zum Hinzufügen oder entfernen den ausgewählten Benutzer aus der entsprechenden Rolle.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="6dc2d-200">Des Kontrollkästchens `AutoPostBack` Eigenschaftensatz wird zurzeit auf "true", die einen Postback verursacht jedes Mal, wenn ein Kontrollkästchen im Wiederholungsmodul aktiviert oder deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="6dc2d-201">Kurz gesagt: Wir müssen einen Ereignishandler für des Kontrollkästchen des erstellen `CheckChanged` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="6dc2d-202">Da das Kontrollkästchen in der ein Repeater-Steuerelement ist, müssen wir die Grundlagen der Ereignis-Handler manuell hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="6dc2d-203">Starten Sie durch Hinzufügen des ereignishandlers für die Code-Behind-Klasse als eine `protected` -Methode, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-203">Start by adding the event handler to the code-behind class as a `protected` method, like so:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample9.cs)]

<span data-ttu-id="6dc2d-204">Wir zurück zum Schreiben von Code für diese Ereignishandler gleich.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="6dc2d-205">Zuerst wird aber wir schließen die Infrastruktur für die Ereignisbehandlung.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="6dc2d-206">Über das Kontrollkästchen innerhalb des Repeaters `ItemTemplate`, fügen `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="6dc2d-207">Diese Syntax verbindet die `RoleCheckBox_CheckChanged` -Ereignishandler der `RoleCheckBox`des `CheckedChanged` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample10.aspx)]

<span data-ttu-id="6dc2d-208">Unsere letzte Aufgabe ist zum Abschließen der `RoleCheckBox_CheckChanged` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="6dc2d-209">Wir müssen zunächst durch Verweisen auf das CheckBox-Steuerelement, das das Ereignis ausgelöst hat, da diese Kontrollkästchen-Instanz an des Benutzers wurde von Rolle aktiviert oder deaktiviert ist, über die `Text` und `Checked` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="6dc2d-210">Mithilfe dieser Informationen zusammen mit dem Benutzernamen des ausgewählten Benutzers wir hinzufügen oder entfernen Sie den Benutzer aus der Rolle über die `Roles` Klasse [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) oder [ `RemoveUserFromRole` Methode](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample11.cs)]

<span data-ttu-id="6dc2d-211">Der obige Code beginnt, durch Programmgesteuertes Verweisen auf das Kontrollkästchen, das das Ereignis ausgelöst hat, verfügbar über den `sender` input-Parameters.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="6dc2d-212">Wenn das Kontrollkästchen aktiviert ist, wird der ausgewählte Benutzer der angegebenen Rolle ist, andernfalls hinzugefügt, die sie aus der Rolle entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="6dc2d-213">In beiden Fällen die `ActionStatus` Bezeichnung wird eine Meldung angezeigt, die Zusammenfassung der gerade ausgeführten Aktion.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="6dc2d-214">Nehmen Sie einen Moment Zeit, um diese Seite über einen Browser zu testen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="6dc2d-215">Wählen Sie Benutzer Tito, und fügen Sie Tito für Administratoren und Supervisor-Rollen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>

<span data-ttu-id="6dc2d-216">[![Tito wurde die Administratoren und Rollen für Vorgesetzte hinzugefügt](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-cs/_static/image8.png)](assigning-roles-to-users-cs/_static/image7.png)</span></span>

<span data-ttu-id="6dc2d-217">**Abbildung 3**: Tito wurde hinzugefügt, die Administratoren und Supervisor-Rollen ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image9.png))</span></span>

<span data-ttu-id="6dc2d-218">Wählen Sie anschließend Benutzer Bruce aus der Dropdown-Liste ein.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="6dc2d-219">Es wird ein Postback und des Repeaters Kontrollkästchen werden aktualisiert, über die `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="6dc2d-220">Da Rollen noch nicht Bruce gehört, werden die beiden Kontrollkästchen deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="6dc2d-221">Fügen Sie anschließend Bruce zur Rolle "Supervisor" ein.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-221">Next, add Bruce to the Supervisors role.</span></span>

<span data-ttu-id="6dc2d-222">[![Bruce wurde die Rolle "Supervisor" hinzugefügt](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-cs/_static/image11.png)](assigning-roles-to-users-cs/_static/image10.png)</span></span>

<span data-ttu-id="6dc2d-223">**Abbildung 4**: Bruce Funktion wurde in die Rolle "Supervisor" ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image12.png))</span></span>

<span data-ttu-id="6dc2d-224">Um die Funktionalität des überprüfen die `CheckRolesForSelectedUser` -Methode, ein Benutzer als Tito oder Bruce auswählen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="6dc2d-225">Beachten Sie, wie die Kontrollkästchen automatisch deaktiviert werden, gibt an, dass sie keine Rollen gehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="6dc2d-226">An Tito zurück.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-226">Return to Tito.</span></span> <span data-ttu-id="6dc2d-227">Administratoren und Supervisor Kontrollkästchen sollte überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="6dc2d-228">Schritt 2: Erstellen der Benutzeroberfläche "Durch die Rollen"</span><span class="sxs-lookup"><span data-stu-id="6dc2d-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="6dc2d-229">An diesem Punkt haben die Schnittstelle "von Benutzer" und können mit der Umgang mit der Schnittstelle "durch die Rollen" beginnen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="6dc2d-230">Die Schnittstelle "durch die Rollen" fordert den Benutzer auf eine Rolle aus der Dropdown-Liste auswählen und zeigt dann die Gruppe von Benutzern, die zu dieser Rolle in einer GridView-Ansicht gehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="6dc2d-231">Fügen Sie ein anderes DropDownList-Steuerelement, das `UsersAndRoles.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-231">Add another DropDownList control to the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="6dc2d-232">In diesem Beispiel unter dem Repeater-Steuerelement platzieren, nennen Sie es `RoleList`, und legen Sie dessen `AutoPostBack` Eigenschaft auf "true".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="6dc2d-233">Klicken Sie unterhalb, das Hinzufügen einer GridView-Ansicht, und nennen Sie sie `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="6dc2d-234">Diese GridView werden die Benutzer aufgelistet, die die ausgewählte Rolle angehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="6dc2d-235">Legen Sie des GridView `AutoGenerateColumns` Eigenschaft auf "false", fügen Sie ein TemplateField zum Raster des `Columns` Sammlung, und legen Sie dessen `HeaderText` Eigenschaft auf "Benutzer".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="6dc2d-236">Definieren Sie das TemplateField des `ItemTemplate` , damit diese den Wert des Ausdrucks Databinding anzeigt `Container.DataItem` in die `Text` -Eigenschaft einer Bezeichnung, die mit dem Namen `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="6dc2d-237">Nach dem Hinzufügen und Konfigurieren von GridView, sollte Ihre "von" Role"Schnittstelle deklaratives Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample12.aspx)]

<span data-ttu-id="6dc2d-238">Wir müssen zum Auffüllen der `RoleList` DropDownList für den Satz von Rollen im System.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="6dc2d-239">Aktualisieren Sie zu diesem Zweck die `BindRolesToList` Methode bindet ist das Zeichenfolgenarray von zurückgegebenen der `Roles.GetAllRoles` Methode, um die `RolesList` DropDownList (als auch die `UsersRoleList` Repeater).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample13.cs)]

<span data-ttu-id="6dc2d-240">Die letzten beiden Zeilen in der `BindRolesToList` Methode wurden hinzugefügt, um den Satz von Rollen zum Binden der `RoleList` DropDownList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="6dc2d-241">Abbildung 5 zeigt das Ergebnis bei der Anzeige über einen Browser – ein Dropdown-Liste, die mit dem System-Rollen aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>

<span data-ttu-id="6dc2d-242">[![Die Rollen werden in der RoleList-Dropdownliste angezeigt.](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-cs/_static/image14.png)](assigning-roles-to-users-cs/_static/image13.png)</span></span>

<span data-ttu-id="6dc2d-243">**Abbildung 5**: Die Rollen werden angezeigt, der `RoleList` DropDownList ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image15.png))</span></span>

### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="6dc2d-244">Die Benutzer werden angezeigt, die der ausgewählten Rolle gehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="6dc2d-245">Beim ersten Laden der Seite, oder wenn eine neue Rolle auswählen, wird die `RoleList` DropDownList, müssen wir die Liste der Benutzer anzuzeigen, die dieser Rolle in der GridView zu gehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="6dc2d-246">Erstellen Sie eine Methode mit dem Namen `DisplayUsersBelongingToRole` mithilfe des folgenden Codes:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample14.cs)]

<span data-ttu-id="6dc2d-247">Diese Methode startet durch Abrufen der ausgewählten Rolle aus der `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="6dc2d-248">Anschließend wird mithilfe der [ `Roles.GetUsersInRole(roleName)` Methode](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) ein Zeichenfolgenarray der Benutzernamen der Benutzer abgerufen, die dieser Rolle angehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="6dc2d-249">Dieses Array wird dann gebunden, um die `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="6dc2d-250">Diese Methode muss in zwei Situationen aufgerufen werden: beim erstmaligen die Seite laden, und wenn die ausgewählte Rolle in der `RoleList` DropDownList-Änderungen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="6dc2d-251">Aktualisieren Sie daher die `Page_Load` -Ereignishandler, damit diese Methode aufgerufen wird, nach dem Aufruf von `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="6dc2d-252">Als Nächstes erstellen Sie einen Ereignishandler für die `RoleList`des `SelectedIndexChanged` -Ereignis, und rufen Sie diese Methode von dort aus zu.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample15.cs)]

<span data-ttu-id="6dc2d-253">Mit diesem Code werden die `RolesUserList` GridView diese Benutzer, die die ausgewählte Rolle angehören, sollte angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="6dc2d-254">Wie in Abbildung 6 gezeigt, besteht die Rolle "Supervisor" zwei Elemente aus: Bruce und Tito.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>

<span data-ttu-id="6dc2d-255">[![GridView zeigt die Benutzer, die der ausgewählten Rolle gehören.](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-cs/_static/image17.png)](assigning-roles-to-users-cs/_static/image16.png)</span></span>

<span data-ttu-id="6dc2d-256">**Abbildung 6**: Die GridView Listet die Benutzer, gehören die Rolle "ausgewählt" ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image18.png))</span></span>

### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="6dc2d-257">Entfernen von Benutzern aus der ausgewählten Rolle</span><span class="sxs-lookup"><span data-stu-id="6dc2d-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="6dc2d-258">Wir erweitern die `RolesUserList` GridView, enthalten eine Spalte mit "Remove"-Schaltflächen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="6dc2d-259">Klicken auf die Schaltfläche "Entfernen" für einen bestimmten Benutzer entfernt sie aus dieser Rolle.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="6dc2d-260">Starten Sie durch das Hinzufügen eines Felds der löschen-Schaltfläche an die GridView.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="6dc2d-261">Stellen Sie dieses Feld als die meisten archivierten links angezeigt, und ändern Sie seine `DeleteText` Eigenschaft von "Delete" (Standard) auf "Entfernen".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>

<span data-ttu-id="6dc2d-262">[![Hinzufügen der](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-262">[![Add the](assigning-roles-to-users-cs/_static/image20.png)](assigning-roles-to-users-cs/_static/image19.png)</span></span>

<span data-ttu-id="6dc2d-263">**Abbildung 7**: Fügen Sie die Schaltfläche "Entfernen" an die GridView ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image21.png))</span></span>

<span data-ttu-id="6dc2d-264">Wenn auf die Schaltfläche "Entfernen" geklickt, wird ein Postback Sicherheitsvorschriften und GridView `RowDeleting` Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="6dc2d-265">Wir müssen einen Ereignishandler für dieses Ereignis erstellen und Schreiben von Code, der der Benutzer von der ausgewählten Rolle entfernt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="6dc2d-266">Erstellen Sie den Ereignishandler, und fügen Sie den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-266">Create the event handler and then add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample16.cs)]

<span data-ttu-id="6dc2d-267">Der Code beginnt, durch den Namen der ausgewählten Rolle bestimmen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="6dc2d-268">Es wird dann programmgesteuert Verweise der `UserNameLabel` Steuerelement aus der Zeile, deren "Remove"-Schaltfläche geklickt wurde, um zu ermitteln, den Benutzernamen des Benutzers entfernen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="6dc2d-269">Der Benutzer wird dann entfernt, aus der Rolle über einen Aufruf an die `Roles.RemoveUserFromRole` Methode.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="6dc2d-270">Die `RolesUserList` GridView wird dann aktualisiert und eine Meldung wird angezeigt, über die `ActionStatus` Beschriftungs-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="6dc2d-271">Die Schaltfläche "Entfernen" erfordert ein beliebiges Bestätigung durch den Benutzer vor dem Entfernen des Benutzers aus der Rolle nicht.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="6dc2d-272">Ich lade Sie gewisse Bestätigung durch den Benutzer hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="6dc2d-273">Eine der einfachsten Möglichkeiten, eine Aktion zu bestätigen ist über ein Dialogfeld für die clientseitige bestätigen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="6dc2d-274">Weitere Informationen zu dieser Technik finden Sie unter [Hinzufügen der clientseitigen Bestätigung beim Löschen von](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>

<span data-ttu-id="6dc2d-275">Abbildung 8 zeigt die Seite, nachdem Benutzer Tito aus der Supervisor-Gruppe entfernt wurde.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>

<span data-ttu-id="6dc2d-276">[![Leider ist Tito nicht mehr Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-cs/_static/image23.png)](assigning-roles-to-users-cs/_static/image22.png)</span></span>

<span data-ttu-id="6dc2d-277">**Abbildung 8**: Leider Tito ist nicht mehr einen Vorgesetzten ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image24.png))</span></span>

### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="6dc2d-278">Hinzufügen neuer Benutzer zu der ausgewählten Rolle</span><span class="sxs-lookup"><span data-stu-id="6dc2d-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="6dc2d-279">Zusammen mit der Benutzer aus der ausgewählten Rolle entfernt haben, sollte der Besucher auf diese Seite auch der ausgewählten Rolle einen Benutzer hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="6dc2d-280">Optimale Schnittstelle für das Hinzufügen eines Benutzers zu der ausgewählten Rolle hängt von der Anzahl von Benutzerkonten, die Sie erwarten, dass ab.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="6dc2d-281">Wenn Ihre Website mit nur wenigen Dutzend Benutzerkonten gespeichert werden soll oder weniger beträgt, können Sie hier einem DropDownList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="6dc2d-282">Wenn es möglicherweise Tausende von Benutzerkonten, möchten Sie eine Benutzeroberfläche enthalten, die den Besucher auf der Seite über die Konten, suchen Sie nach einem bestimmten Konto oder das Filtern der Benutzerkonten in eine andere Art zulässt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="6dc2d-283">Für diese Seite verwenden wir eine sehr einfache Schnittstelle, die unabhängig von der Anzahl von Benutzerkonten im System arbeitet.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="6dc2d-284">Insbesondere verwenden wir ein Textfeld, aufgefordert wird des Besuchers den Benutzernamen des Benutzers eingeben, die sie der ausgewählten Rolle hinzufügen möchte.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="6dc2d-285">Wenn kein Benutzer mit diesem Namen vorhanden ist oder wenn der Benutzer bereits Mitglied der Rolle ist, wir eine Nachricht in zeigen `ActionStatus` Bezeichnung.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="6dc2d-286">Aber wenn der Benutzer vorhanden ist, und es kein Mitglied der Rolle ist, wir sie der Rolle hinzufügen und das Raster zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="6dc2d-287">Fügen Sie einem Textfeld und einer Schaltfläche unterhalb der GridView hinzu.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="6dc2d-288">Festlegen des Textfelds `ID` zu `UserNameToAddToRole` und legen Sie die `ID` und `Text` Eigenschaften `AddUserToRoleButton` und "Hinzufügen zu Benutzerrolle" bzw.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample17.aspx)]

<span data-ttu-id="6dc2d-289">Als Nächstes erstellen Sie eine `Click` -Ereignishandler für die `AddUserToRoleButton` und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample18.cs)]

<span data-ttu-id="6dc2d-290">Der Großteil des Codes in der `Click` -Ereignishandler führt verschiedene Überprüfungen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="6dc2d-291">Dadurch wird sichergestellt, dass der Besucher mit einen Benutzernamen in angegeben die `UserNameToAddToRole` Textfeld, das der Benutzer im System vorhanden ist, und nicht bereits in die ausgewählte Rolle gehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="6dc2d-292">Wenn diese überprüft, ob ein Fehler auftritt, wird eine entsprechende Meldung angezeigt, `ActionStatus` und der Ereignishandler beendet ist.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="6dc2d-293">Wenn alle Überprüfungen erfolgreich sind, wird der Benutzer hinzugefügt, auf die Rolle über die `Roles.AddUserToRole` Methode.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="6dc2d-294">Danach die TextBox `Text` Eigenschaft deaktiviert ist, wird die GridView aktualisiert, und die `ActionStatus` Bezeichnung zeigt die Meldung, dass der angegebene Benutzer der ausgewählten Rolle erfolgreich hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="6dc2d-295">Um sicherzustellen, dass der angegebene Benutzer nicht bereits in die ausgewählte Rolle gehört, verwenden wir die [ `Roles.IsUserInRole(userName, roleName)` Methode](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), ein boolescher Wert, der zurückgegeben, ob *Benutzername* ist ein Mitglied *RoleName*.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="6dc2d-296">Wir verwenden diese Methode in der <a id="_msoanchor_2"> </a> [nächsten Tutorial](role-based-authorization-cs.md) Wenn sehen wir uns an rollenbasierte Autorisierung.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-cs.md) when we look at role-based authorization.</span></span>

<span data-ttu-id="6dc2d-297">Finden Sie auf der Seite über einen Browser, und wählen Sie die Rolle der Vorgesetzte aus dem `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="6dc2d-298">Versuchen Sie, einen ungültigen Benutzernamen einzugeben – Daraufhin sollte eine Meldung angezeigt, dass der Benutzer im System nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>

<span data-ttu-id="6dc2d-299">[![Sie können nicht zu einer Rolle einen nicht existierende Benutzer hinzufügen.](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-cs/_static/image26.png)](assigning-roles-to-users-cs/_static/image25.png)</span></span>

<span data-ttu-id="6dc2d-300">**Abbildung 9**: Sie können nicht vorhandener Benutzer nicht zu einer Rolle hinzufügen ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image27.png))</span></span>

<span data-ttu-id="6dc2d-301">Versuchen Sie nun das Hinzufügen eines gültigen Benutzers aus.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-301">Now try adding a valid user.</span></span> <span data-ttu-id="6dc2d-302">Fahren Sie fort, und wieder Tito hinzu, der Supervisor-Rolle.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-302">Go ahead and re-add Tito to the Supervisors role.</span></span>

<span data-ttu-id="6dc2d-303">[![Hier ist der Tito Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-cs/_static/image29.png)](assigning-roles-to-users-cs/_static/image28.png)</span></span>

<span data-ttu-id="6dc2d-304">**Abbildung 10**: Hier ist der Tito Supervisor!</span><span class="sxs-lookup"><span data-stu-id="6dc2d-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="6dc2d-305">([Klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-305">([Click to view full-size image](assigning-roles-to-users-cs/_static/image30.png))</span></span>

## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="6dc2d-306">Schritt 3: Cross-Aktualisierung der "Von Benutzer" und "Von der Rolle" Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="6dc2d-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="6dc2d-307">Die `UsersAndRoles.aspx` Seite bietet zwei unterschiedliche Benutzeroberflächen für die Verwaltung von Benutzern und Rollen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="6dc2d-308">Derzeit werden diese beiden Schnittstellen unabhängig voneinander fungieren, daher ist es möglich, dass eine Änderung in einer Schnittstelle in der anderen nicht sofort wiedergegeben werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="6dc2d-309">Beispiel: Angenommen, dass der Besucher auf der Seite die Supervisor-Rolle von auswählt der `RoleList` DropDownList, der Bruce und Tito als Member enthält.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="6dc2d-310">Anschließend wählt der Besucher Tito aus der `UserList` DropDownList, die die Kontrollkästchen für Administratoren und Supervisor überprüft wird, in der `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="6dc2d-311">Wenn der Besucher, klicken Sie dann die Rolle des Vorgesetzten aus der Repeater markiert, wird Tito aus der Supervisor-Rolle entfernt diese Änderung wird nicht widergespiegelt, in der Schnittstelle "von" Role".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="6dc2d-312">Das GridView zeigt weiterhin Tito als Mitglied der Rolle "Supervisor".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="6dc2d-313">Um dies zu beheben, müssen wir GridView zu aktualisieren, wenn eine Rolle ist, aktiviert oder deaktiviert ist, aus, der `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="6dc2d-314">Ebenso müssen wir Repeater zu aktualisieren, wenn ein Benutzer entfernt oder zu einer Rolle über die Schnittstelle "von der Rolle" hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="6dc2d-315">Der Repeater in der Schnittstelle "von Benutzer" wird aktualisiert, durch den Aufruf der `CheckRolesForSelectedUser` Methode.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="6dc2d-316">Die Schnittstelle "von der Rolle" kann geändert werden, der `RolesUserList` GridView `RowDeleting` -Ereignishandler und die `AddUserToRoleButton` Schaltfläche `Click` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="6dc2d-317">Aus diesem Grund müssen wir rufen die `CheckRolesForSelectedUser` Methode aus einer dieser Methoden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample19.cs)]

<span data-ttu-id="6dc2d-318">Auf ähnliche Weise wird die GridView in der Schnittstelle "von der Rolle" durch den Aufruf aktualisiert die `DisplayUsersBelongingToRole` -Methode und die Schnittstelle "von Benutzer" wird geändert, durch die `RoleCheckBox_CheckChanged` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="6dc2d-319">Aus diesem Grund müssen wir rufen die `DisplayUsersBelongingToRole` Methode aus diesem Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample20.cs)]

<span data-ttu-id="6dc2d-320">Mit diesen kleinere Änderungen am Code der Schnittstellen "von Benutzer" und "von der Rolle" nun korrekt Cross-Update.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="6dc2d-321">Klicken Sie zur Überprüfung finden Sie auf der Seite über einen Browser, und wählen Sie Tito und Supervisor aus der `UserList` und `RoleList` DropDownList-Steuerelementen, bzw.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="6dc2d-322">Beachten Sie, wie Sie die Rolle der Vorgesetzte für Tito aus der Repeater in der Schnittstelle "von Benutzer" deaktivieren, Tito automatisch aus der GridView in der Schnittstelle "von" Role"entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="6dc2d-323">Der Vorgesetzte Kontrollkästchen in der Schnittstelle "von Benutzer" Hinzufügen von Tito zurück an die Rolle "Supervisor" von der Schnittstelle "von der Rolle" automatisch erneut überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="6dc2d-324">Schritt 4: Anpassen der CreateUserWizard enthält einen Schritt "Rollen angeben"</span><span class="sxs-lookup"><span data-stu-id="6dc2d-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="6dc2d-325">In der <a id="_msoanchor_3"> </a> [ *Erstellen von Benutzerkonten* ](../membership/creating-user-accounts-cs.md) Tutorial erläutert, wie Sie mit, dass das Steuerelement CreateUserWizard bieten eine Schnittstelle zum Erstellen eines neuen Benutzerkontos.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-cs.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="6dc2d-326">Das Steuerelement CreateUserWizard kann auf zwei Arten verwendet werden:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="6dc2d-327">Als Mittel zur Besucher, um ihr eigenes Benutzerkonto auf der Website zu erstellen und</span><span class="sxs-lookup"><span data-stu-id="6dc2d-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="6dc2d-328">Als eine Möglichkeit für Administratoren zum Erstellen neuer Konten</span><span class="sxs-lookup"><span data-stu-id="6dc2d-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="6dc2d-329">Im ersten Anwendungsfall ein Besucher darum geht, den Standort und füllt die CreateUserWizard, ihre Informationen eingeben, um auf der Website zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="6dc2d-330">Im zweiten Fall erstellt ein Administrator ein neues Konto für eine andere Person.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="6dc2d-331">Wenn Sie ein Konto von einem Administrator für eine andere Person erstellt wird, kann es hilfreich sein, ermöglichen dem Administrator, welche Rollen angeben, das neue Benutzerkonto gehört.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="6dc2d-332">In der <a id="_msoanchor_4"> </a> [ *speichern* *zusätzliche Benutzerinformationen* ](../membership/storing-additional-user-information-cs.md) Tutorial erläutert, wie die CreateUserWizard durch Hinzufügen zusätzlicher anpassen `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="6dc2d-333">Sehen wir uns an, wie einen zusätzlichen Schritt der CreateUserWizard hinzufügen, um die neue Rollen des Benutzers angeben.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="6dc2d-334">Öffnen der `CreateUserWizardWithRoles.aspx` Seite, und fügen Sie ein Steuerelement CreateUserWizard, die mit dem Namen `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="6dc2d-335">Legen Sie die `ContinueDestinationPageUrl` Eigenschaft "~ /" default.aspx "".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="6dc2d-336">Da die Idee dabei ist, dass ein Administrator dieses Steuerelement CreateUserWizard verwenden, neue Benutzerkonten erstellen, legen Sie die `LoginCreatedUser` Eigenschaft auf "false".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="6dc2d-337">Dies `LoginCreatedUser` Eigenschaft gibt an, ob der Besucher automatisch als des gerade erstellten Benutzers angemeldet ist, und wird auf "true standardmäßig".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="6dc2d-338">Wir legen ihn auf false fest, denn wenn ein Administrator ein neues Konto erstellt, die wir ihn als sich angemeldet bleiben möchten.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="6dc2d-339">Wählen Sie als Nächstes die "hinzufügen/entfernen `WizardSteps`..." option die CreateUserWizards Smarttag, und fügen Sie einen neuen `WizardStep`wird durch das Festlegen der `ID` zu `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="6dc2d-340">Verschieben der `SpecifyRolesStep WizardStep` , damit es nach dem Schritt "SSO für Ihr neues Konto", aber vor dem Schritt "Abschließen" geht.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="6dc2d-341">Festlegen der `WizardStep`des `Title` Eigenschaft auf "Geben Sie Roles", die `StepType` Eigenschaft, um `Step`, und die zugehörige `AllowReturn` Eigenschaft auf "false".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>

<span data-ttu-id="6dc2d-342">[![Hinzufügen der](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-342">[![Add the](assigning-roles-to-users-cs/_static/image32.png)](assigning-roles-to-users-cs/_static/image31.png)</span></span>

<span data-ttu-id="6dc2d-343">**Abbildung 11**: Fügen Sie die "Geben Sie Rollen" `WizardStep` auf die CreateUserWizard ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image33.png))</span></span>

<span data-ttu-id="6dc2d-344">Nach dieser Änderung sollte Ihre CreateUserWizards deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-cs/samples/sample21.aspx)]

<span data-ttu-id="6dc2d-345">"Geben Sie Mitglied der Rollen" `WizardStep`, Hinzufügen einer "CheckBoxList" mit dem Namen `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList`.</span></span> <span data-ttu-id="6dc2d-346">Diese "CheckBoxList" werden die verfügbaren Rollen aufgelistet und aktivieren die Person, die auf der Seite, um Rollen zu überprüfen, der neu erstellte Benutzer gehört.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-346">This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="6dc2d-347">Wir bleiben mit zwei Codieraufgaben: zuerst müssen wir Auffüllen der `RoleList` "CheckBoxList" mit den Rollen im System; Zweitens müssen wir den erstellten Benutzer für die ausgewählten Rollen hinzuzufügen, wenn der Benutzer aus dem Schritt "Geben Sie Roles" mit dem Schritt "Abschließen".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-347">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="6dc2d-348">Wir können die erste Aufgabe beim Erreichen der `Page_Load` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-348">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="6dc2d-349">Der folgende code programmgesteuert Verweise der `RoleList` Kontrollkästchen auf der ersten finden Sie auf der Seite und die Rollen im System an sie bindet.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-349">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample22.cs)]

<span data-ttu-id="6dc2d-350">Der obige Code sollte bekannt vorkommen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-350">The above code should look familiar.</span></span> <span data-ttu-id="6dc2d-351">In der <a id="_msoanchor_5"> </a> [ *speichern* *zusätzliche Benutzerinformationen* ](../membership/storing-additional-user-information-cs.md) Tutorial verwendet zwei `FindControl` Anweisungen, um auf ein Steuerelement zu verweisen. von innerhalb einer benutzerdefinierten `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-351">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-cs.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="6dc2d-352">Und der Code, der die Rollen "CheckBoxList" gebunden wurde zuvor in diesem Tutorial entnommen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-352">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="6dc2d-353">Um die zweite Aufgabe als Programmierer auszuführen, den müssen wir wissen, wenn der Schritt "Geben Sie Roles" abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-353">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="6dc2d-354">Beachten Sie, die die CreateUserWizard ein `ActiveStepChanged` Ereignis, das jedes Mal ausgelöst wird, der Besucher, die von einem Schritt zu einem anderen navigiert.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-354">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="6dc2d-355">Hier können wir bestimmen, ob der Benutzer im Schritt "Abgeschlossen" erreicht hat; Wenn dies der Fall ist, müssen wir den Benutzer der ausgewählten Rollen hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-355">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="6dc2d-356">Erstellen Sie einen Ereignishandler für die `ActiveStepChanged` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-356">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-csharp[Main](assigning-roles-to-users-cs/samples/sample23.cs)]

<span data-ttu-id="6dc2d-357">Wenn der Benutzer nur den Schritt "Abgeschlossen" erreicht hat, wird der Ereignishandler Listet die Elemente von der `RoleList` "CheckBoxList" und dem gerade erstellten Benutzer der ausgewählten Rollen zugewiesen ist.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-357">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="6dc2d-358">Besuchen Sie diese Seite über einen Browser ein.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-358">Visit this page through a browser.</span></span> <span data-ttu-id="6dc2d-359">Der erste Schritt bei der CreateUserWizard ist der standard "SSO für Ihr neues Konto" Schritt, der für den neuen Benutzernamen, Kennwort, e-Mail- und anderen wichtigen Informationen aufgefordert werden.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-359">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="6dc2d-360">Geben Sie die Informationen zum Erstellen eines neuen Benutzers mit dem Namen Wanda aus.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-360">Enter the information to create a new user named Wanda.</span></span>

<span data-ttu-id="6dc2d-361">[![Erstellen eines neuen Benutzers mit dem Namen Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-361">[![Create a New User Named Wanda](assigning-roles-to-users-cs/_static/image35.png)](assigning-roles-to-users-cs/_static/image34.png)</span></span>

<span data-ttu-id="6dc2d-362">**Abbildung 12**: Erstellen Sie einen neuen Benutzer mit dem Namen Wanda ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-362">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image36.png))</span></span>

<span data-ttu-id="6dc2d-363">Klicken Sie auf die Schaltfläche "Benutzer erstellen".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-363">Click the "Create User" button.</span></span> <span data-ttu-id="6dc2d-364">Ruft die CreateUserWizard intern die `Membership.CreateUser` -Methode, erstellen das neue Benutzerkonto ein, und klicken Sie dann im Verlauf mit dem nächsten Schritt, "Rollen angeben."</span><span class="sxs-lookup"><span data-stu-id="6dc2d-364">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="6dc2d-365">Hier werden die Standortsystemrollen aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-365">Here the system roles are listed.</span></span> <span data-ttu-id="6dc2d-366">Aktivieren Sie das Kontrollkästchen der Supervisor aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-366">Check the Supervisors checkbox and click Next.</span></span>

<span data-ttu-id="6dc2d-367">[![Stellen Sie Wanda Mitglied der Rolle "Supervisor"](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-367">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-cs/_static/image38.png)](assigning-roles-to-users-cs/_static/image37.png)</span></span>

<span data-ttu-id="6dc2d-368">**Abbildung 13**: Stellen Sie Wanda Mitglied der Rolle "Supervisor" ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-368">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image39.png))</span></span>

<span data-ttu-id="6dc2d-369">Klicken Sie auf Weiter bewirkt, dass ein Postback und Updates der `ActiveStep` mit dem Schritt "Abschließen".</span><span class="sxs-lookup"><span data-stu-id="6dc2d-369">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="6dc2d-370">In der `ActiveStepChanged` -Ereignishandler das zuletzt erstellte Benutzerkonto wird der Vorgesetzte-Rolle zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-370">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="6dc2d-371">Um dies zu überprüfen, zurück zu den `UsersAndRoles.aspx` Seite und wählen Sie Vorgesetzte aus der `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-371">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="6dc2d-372">Wie in Abbildung 14 gezeigt, der Supervisor jetzt drei Benutzer bestehen: Bruce, Tito und Wanda.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-372">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>

<span data-ttu-id="6dc2d-373">[![Bruce, Tito und Wanda sind alle Supervisor](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-373">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-cs/_static/image41.png)](assigning-roles-to-users-cs/_static/image40.png)</span></span>

<span data-ttu-id="6dc2d-374">**Abbildung 14**: Bruce, Tito und Wanda sind alle Vorgesetzte ([klicken Sie, um das Bild in voller Größe anzeigen](assigning-roles-to-users-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="6dc2d-374">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-cs/_static/image42.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6dc2d-375">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="6dc2d-375">Summary</span></span>

<span data-ttu-id="6dc2d-376">Die Rollen-Framework bietet Methoden zum Abrufen von Informationen zu eines bestimmten Benutzers Rollen und Methoden zum bestimmen, welche Benutzer zu einer bestimmten Rolle gehören.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-376">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="6dc2d-377">Darüber hinaus stehen eine Reihe von Methoden zum Hinzufügen und entfernen einen oder mehrere Benutzer auf eine oder mehrere Rollen zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-377">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="6dc2d-378">In diesem Tutorial haben wir uns nur zwei der folgenden Methoden: `AddUserToRole` und `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-378">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="6dc2d-379">Es gibt weitere Varianten, die entwickelt, um mehrere Benutzer zu einer einzelnen Rolle hinzufügen und einen einzelnen Benutzer mehreren Rollen zuweisen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-379">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="6dc2d-380">In diesem Tutorial enthalten auch einen Blick auf das Erweitern des Steuerelements CreateUserWizard sollen eine `WizardStep` Rollen des neu erstellten Benutzers an.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-380">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="6dc2d-381">Solch ein Schritt können Administratoren den Prozess zum Erstellen von Benutzerkonten für neue Benutzer zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-381">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="6dc2d-382">An diesem Punkt haben Sie erfahren, wie zum Erstellen und Löschen von Rollen und Benutzer hinzufügen und Entfernen von Rollen.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-382">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="6dc2d-383">Aber wir haben dafür noch zum Anwenden der rollenbasierten Autorisierung betrachten.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-383">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="6dc2d-384">In der <a id="_msoanchor_6"> </a> [nachfolgenden Tutorial](role-based-authorization-cs.md) betrachten wir definieren Regeln auf URL-Autorisierung pro Rolle-von-Rolle sowie wie die Rollen des aktuell angemeldeten Benutzers zur Einschränkung der Seite auf Funktionalität abhängig.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-384">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-cs.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="6dc2d-385">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="6dc2d-385">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6dc2d-386">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="6dc2d-386">Further Reading</span></span>

<span data-ttu-id="6dc2d-387">Weitere Informationen zu den Themen in diesem Tutorial erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="6dc2d-387">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6dc2d-388">ASP.NET Web Site Administration Tool Overview</span><span class="sxs-lookup"><span data-stu-id="6dc2d-388">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="6dc2d-389">Untersuchen ASP. NET Mitgliedschaft, Rollen und Profile</span><span class="sxs-lookup"><span data-stu-id="6dc2d-389">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="6dc2d-390">Paralleles eigene Websiteverwaltungs-Tool</span><span class="sxs-lookup"><span data-stu-id="6dc2d-390">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="6dc2d-391">Der Autor</span><span class="sxs-lookup"><span data-stu-id="6dc2d-391">About the Author</span></span>

<span data-ttu-id="6dc2d-392">Scott Mitchell, Autor von mehreren Büchern zu ASP/ASP.NET und Gründer von 4GuysFromRolla.com, ist seit 1998 mit Microsoft-Web-Technologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-392">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6dc2d-393">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-393">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6dc2d-394">Sein neueste Buch wird *[Sams Schulen selbst ASP.NET 2.0 in 24 Stunden](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-394">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="6dc2d-395">Scott erreicht werden kann, zur [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="6dc2d-395">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="6dc2d-396">Besonderen Dank an...</span><span class="sxs-lookup"><span data-stu-id="6dc2d-396">Special Thanks To…</span></span>

<span data-ttu-id="6dc2d-397">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-397">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6dc2d-398">Führendes Prüfer für dieses Tutorial wurde Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="6dc2d-398">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="6dc2d-399">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="6dc2d-399">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6dc2d-400">Wenn dies der Fall ist, löschen Sie mir eine Linie an [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-400">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6dc2d-401">[Zurück](creating-and-managing-roles-cs.md)
> [Weiter](role-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="6dc2d-401">[Previous](creating-and-managing-roles-cs.md)
[Next](role-based-authorization-cs.md)</span></span>
