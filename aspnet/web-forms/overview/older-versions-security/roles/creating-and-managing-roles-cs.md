---
uid: web-forms/overview/older-versions-security/roles/creating-and-managing-roles-cs
title: Erstellen und Verwalten von Rollen (c#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial werden die erforderlichen Schritte zum Konfigurieren des Rollen-Framework. Danach werden wir Webseiten zum Erstellen und Löschen Rollen erstellen.
ms.author: riande
ms.date: 03/24/2008
ms.assetid: 113f10b3-a19a-471b-8ff6-db3c79ce8a91
msc.legacyurl: /web-forms/overview/older-versions-security/roles/creating-and-managing-roles-cs
msc.type: authoredcontent
ms.openlocfilehash: a4028abf8b1593c98cb3daad03d8699a13af447d
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 05/06/2019
ms.locfileid: "65132037"
---
# <a name="creating-and-managing-roles-c"></a><span data-ttu-id="00f6f-104">Erstellen und Verwalten von Rollen (C#)</span><span class="sxs-lookup"><span data-stu-id="00f6f-104">Creating and Managing Roles (C#)</span></span>

<span data-ttu-id="00f6f-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="00f6f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="00f6f-106">[Code herunterladen](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.09.zip) oder [PDF-Datei herunterladen](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="00f6f-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.09.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_cs.pdf)</span></span>

> <span data-ttu-id="00f6f-107">In diesem Tutorial werden die erforderlichen Schritte zum Konfigurieren des Rollen-Framework.</span><span class="sxs-lookup"><span data-stu-id="00f6f-107">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="00f6f-108">Danach werden wir Webseiten zum Erstellen und Löschen Rollen erstellen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-108">Following that, we will build web pages to create and delete roles.</span></span>

## <a name="introduction"></a><span data-ttu-id="00f6f-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="00f6f-109">Introduction</span></span>

<span data-ttu-id="00f6f-110">In der <a id="_msoanchor_1"> </a> [ *Benutzerbasierte Autorisierung* ](../membership/user-based-authorization-cs.md) Tutorial wir mithilfe von URL-Autorisierung auf gewisse Benutzer beschränken, aus einer Reihe von Seiten betrachtet und untersucht die deklarative und programmgesteuerte Verfahren für die Anpassung einer ASP.NET-Seite-Funktionen, die basierend auf den Benutzer aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-110">In the <a id="_msoanchor_1"></a>[*User-Based Authorization*](../membership/user-based-authorization-cs.md) tutorial we looked at using URL authorization to restrict certain users from a set of pages and explored declarative and programmatic techniques for adjusting an ASP.NET page's functionality based on the visiting user.</span></span> <span data-ttu-id="00f6f-111">Gewähren der Berechtigung für den Zugriff auf oder Funktionen pro Benutzer mit dem Benutzernamen, kann jedoch ein verwaltungsalbtraum in Szenarien werden, wobei viele Benutzerkonten vorhanden sind, oder wenn Benutzer Berechtigungen häufig ändern.</span><span class="sxs-lookup"><span data-stu-id="00f6f-111">Granting permission for page access or functionality on a user-by-user basis, however, can become a maintenance nightmare in scenarios where there are many user accounts or when users' privileges change often.</span></span> <span data-ttu-id="00f6f-112">Jedes Mal ein Benutzer erhält oder verliert der Autorisierung für eine bestimmte Aufgabe auszuführen, muss der Administrator die entsprechenden Regeln auf URL-Autorisierung, deklaratives Markup und Code zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="00f6f-112">Any time a user gains or loses authorization to perform a particular task, the administrator needs to update the appropriate URL authorization rules, declarative markup, and code.</span></span>

<span data-ttu-id="00f6f-113">Es hilft Ihnen bei der um Benutzer in Gruppen zu klassifizieren oder *Rollen* und Anwenden von Berechtigungen pro Rolle-von-Rolle.</span><span class="sxs-lookup"><span data-stu-id="00f6f-113">It usually helps to classify users into groups or *roles* and then to apply permissions on a role-by-role basis.</span></span> <span data-ttu-id="00f6f-114">Die meisten Webanwendungen haben z. B. einen bestimmten Satz von Seiten oder Aufgaben, die nur für Administratoren reserviert sind.</span><span class="sxs-lookup"><span data-stu-id="00f6f-114">For example, most web applications have a certain set of pages or tasks that are reserved only for administrative users.</span></span> <span data-ttu-id="00f6f-115">Die Verfahren verwenden, Erkenntnisse in die *Benutzerbasierte Autorisierung* Tutorial, würden wir hinzufügen, die entsprechende URL-Autorisierungsregeln, deklaratives Markup und Code für die angegebenen Benutzerkonten administrative Aufgaben ausführen können.</span><span class="sxs-lookup"><span data-stu-id="00f6f-115">Using the techniques learned in the *User-Based Authorization* tutorial, we would add the appropriate URL authorization rules, declarative markup, and code to allow the specified user accounts to perform administrative tasks.</span></span> <span data-ttu-id="00f6f-116">Aber wenn ein neuer Administrator hinzugefügt wurde oder ein bestehenden Administrator erforderlich, damit ihre Administratorrechte widerrufen, müssten wir zurück, und aktualisieren die Konfigurationsdateien und Webseiten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-116">But if a new administrator was added or if an existing administrator needed to have her administration rights revoked, we would have to return and update the configuration files and web pages.</span></span> <span data-ttu-id="00f6f-117">Mit Rollen konnten wir allerdings erstellen Sie eine Rolle namens Administratoren und weisen diese vertrauenswürdigen Benutzer die Rolle "Administratoren".</span><span class="sxs-lookup"><span data-stu-id="00f6f-117">With roles, however, we could create a role called Administrators and assign those trusted users to the Administrators role.</span></span> <span data-ttu-id="00f6f-118">Als Nächstes fügen wir die entsprechende URL-Autorisierungsregeln, deklaratives Markup und Code zu der Rolle "Administratoren" für die verschiedenen Verwaltungsaufgaben hinzu.</span><span class="sxs-lookup"><span data-stu-id="00f6f-118">Next, we would add the appropriate URL authorization rules, declarative markup, and code to allow the Administrators role to perform the various administrative tasks.</span></span> <span data-ttu-id="00f6f-119">Mit dieser Infrastruktur vorhanden ist ist der Website neue Administratoren hinzufügen oder Entfernen von vorhandenen so einfach wie das ein- oder Entfernen des Benutzers aus der Rolle "Administratoren".</span><span class="sxs-lookup"><span data-stu-id="00f6f-119">With this infrastructure in place, adding new administrators to the site or removing existing ones is as simple as including or removing the user from the Administrators role.</span></span> <span data-ttu-id="00f6f-120">Es sind keine Konfiguration, deklaratives Markup oder Änderungen am Code erforderlich.</span><span class="sxs-lookup"><span data-stu-id="00f6f-120">No configuration, declarative markup, or code changes are necessary.</span></span>

<span data-ttu-id="00f6f-121">ASP.NET bietet ein Rollen-Framework zum Definieren von Rollen, und mit Benutzerkonten verknüpft werden.</span><span class="sxs-lookup"><span data-stu-id="00f6f-121">ASP.NET offers a Roles framework for defining roles and associating them with user accounts.</span></span> <span data-ttu-id="00f6f-122">Fügen Sie Benutzer oder Benutzer aus einer Rolle entfernen, bestimmen die Gruppe von Benutzern, die zu einer bestimmten Rolle gehören, und feststellen, ob ein Benutzer einer bestimmten Rolle angehört, mit dem Rollen-Framework, das können wir erstellen und Löschen von Rollen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-122">With the Roles framework we can create and delete roles, add users to or remove users from a role, determine the set of users that belong to a particular role, and tell whether a user belongs to a particular role.</span></span> <span data-ttu-id="00f6f-123">Nachdem das Framework für die Rollen konfiguriert wurde, können wir beschränken den Zugriff auf Seiten pro Rolle-von-Role durch URL-Autorisierungsregeln und ein- oder ausblenden Zusatzinformationen oder Funktionen auf einer Seite, die basierend auf Rollen des angemeldeten Benutzers.</span><span class="sxs-lookup"><span data-stu-id="00f6f-123">Once the Roles framework has been configured, we can limit access to pages on a role-by-role basis through URL authorization rules and show or hide additional information or functionality on a page based on the currently logged on user's roles.</span></span>

<span data-ttu-id="00f6f-124">In diesem Tutorial werden die erforderlichen Schritte zum Konfigurieren des Rollen-Framework.</span><span class="sxs-lookup"><span data-stu-id="00f6f-124">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="00f6f-125">Danach werden wir Webseiten zum Erstellen und Löschen Rollen erstellen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-125">Following that, we will build web pages to create and delete roles.</span></span> <span data-ttu-id="00f6f-126">In der <a id="_msoanchor_2"> </a> [ *Zuweisen von Rollen an Benutzer* ](assigning-roles-to-users-cs.md) Tutorial betrachten wir das Hinzufügen und Entfernen von Benutzern Rollen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-126">In the <a id="_msoanchor_2"></a>[*Assigning Roles to Users*](assigning-roles-to-users-cs.md) tutorial we will look at how to add and remove users from roles.</span></span> <span data-ttu-id="00f6f-127">Und klicken Sie in der <a id="_msoanchor_3"> </a> [ *rollenbasierte Autorisierung* ](role-based-authorization-cs.md) Tutorial wird gezeigt, wie mit den Zugriff auf Seiten pro Rolle-von-Rolle sowie Gewusst wie: Anpassen der Seite auf Funktionalität je beschränken Klicken Sie auf die Website besucht Rolle des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="00f6f-127">And in the <a id="_msoanchor_3"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial we will see how to limit access to pages on a role-by-role basis along with how to adjust page functionality depending on the visiting user's role.</span></span> <span data-ttu-id="00f6f-128">Fangen wir an!</span><span class="sxs-lookup"><span data-stu-id="00f6f-128">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="00f6f-129">Schritt 1: Hinzufügen von ASP.NET-Seiten</span><span class="sxs-lookup"><span data-stu-id="00f6f-129">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="00f6f-130">In diesem Tutorial und die nächsten beiden werden wir verschiedene Funktionen im Zusammenhang mit Rollen und Funktionen untersuchen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-130">In this tutorial and the next two we will be examining various roles-related functions and capabilities.</span></span> <span data-ttu-id="00f6f-131">Wir benötigen eine Reihe von ASP.NET-Seiten in den Themen in diesen Tutorials untersucht implementieren.</span><span class="sxs-lookup"><span data-stu-id="00f6f-131">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="00f6f-132">Diese Seiten zu erstellen, und die Sitemap zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="00f6f-132">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="00f6f-133">Zunächst erstellen Sie einen neuen Ordner im Projekt mit dem Namen `Roles`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-133">Start by creating a new folder in the project named `Roles`.</span></span> <span data-ttu-id="00f6f-134">Fügen Sie vier neue ASP.NET-Seiten, die `Roles` Ordner, verknüpfen jede Seite mit den `Site.master` Masterseite.</span><span class="sxs-lookup"><span data-stu-id="00f6f-134">Next, add four new ASP.NET pages to the `Roles` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="00f6f-135">Benennen Sie die Seiten ein:</span><span class="sxs-lookup"><span data-stu-id="00f6f-135">Name the pages:</span></span>

- `ManageRoles.aspx`
- `UsersAndRoles.aspx`
- `CreateUserWizardWithRoles.aspx`
- `RoleBasedAuthorization.aspx`

<span data-ttu-id="00f6f-136">An diesem Punkt sollte Ihr Projekts des Projektmappen-Explorer im Screenshot dargestellt in Abbildung 1 ähneln.</span><span class="sxs-lookup"><span data-stu-id="00f6f-136">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="00f6f-137">[![Vier neue Seiten wurden in den Ordner Rollen hinzugefügt](creating-and-managing-roles-cs/_static/image2.png)](creating-and-managing-roles-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-137">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-cs/_static/image2.png)](creating-and-managing-roles-cs/_static/image1.png)</span></span>

<span data-ttu-id="00f6f-138">**Abbildung 1**: Vier neue Seiten hinzugefügt wurden, die `Roles` Ordner ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-138">**Figure 1**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image3.png))</span></span>

<span data-ttu-id="00f6f-139">Jede Seite, an diesem Punkt müssen die beiden Inhaltssteuerelemente, einer für jede von der Masterseite ContentPlaceHolder-Steuerelemente: `MainContent` und `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-139">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample1.aspx)]

<span data-ttu-id="00f6f-140">Bedenken Sie, dass die `LoginContent` ContentPlaceHolder Standard-Markup zeigt einen Link zum Anmelden oder Abmelden auf den Standort, je nachdem, ob der Benutzer authentifiziert wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-140">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="00f6f-141">Das Vorhandensein der `Content2` Content-Steuerelement auf der ASP.NET-Seite wird jedoch die Masterseite Standardmarkup überschreibt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-141">The presence of the `Content2` Content control in the ASP.NET page, however, overrides the master page's default markup.</span></span> <span data-ttu-id="00f6f-142">Wie wir unter <a id="_msoanchor_4"> </a> [ *eine Übersicht der Formularauthentifizierung* ](../introduction/an-overview-of-forms-authentication-cs.md) überschreiben das Standardmarkup Tutorial eignet sich für Seiten, in dem wir nicht anzeigen anmeldebezogene möchten, die Optionen in der linken Spalte.</span><span class="sxs-lookup"><span data-stu-id="00f6f-142">As we discussed in <a id="_msoanchor_4"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, overriding the default markup is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="00f6f-143">Für diese vier Seiten, allerdings möchten wir zum Anzeigen der Masterseite Standardmarkup für das `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="00f6f-143">For these four pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="00f6f-144">Daher entfernen deklarative Markup für die `Content2` Inhaltssteuerelement.</span><span class="sxs-lookup"><span data-stu-id="00f6f-144">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="00f6f-145">Danach sollte jede der vier Seitenmarkup nur ein Inhaltssteuerelement enthalten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-145">After doing so, each of the four page's markup should contain just one Content control.</span></span>

<span data-ttu-id="00f6f-146">Zum Schluss aktualisieren wir die Sitemap (`Web.sitemap`) sollen diese neue Webseiten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-146">Finally, let's update the site map (`Web.sitemap`) to include these new web pages.</span></span> <span data-ttu-id="00f6f-147">Die folgenden XML-Code nach dem Hinzufügen der `<siteMapNode>` wir für die Mitgliedschaft Lernprogramme hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-147">Add the following XML after the `<siteMapNode>` we added for the Membership tutorials.</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample2.xml)]

<span data-ttu-id="00f6f-148">Besuchen Sie die Website über einen Browser, mit der sitezuordnung aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="00f6f-148">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="00f6f-149">Wie in Abbildung 2 gezeigt, enthält die Navigation auf der linken Seite nun Elemente für die Rollen-Lernprogramme.</span><span class="sxs-lookup"><span data-stu-id="00f6f-149">As Figure 2 shows, the navigation on the left now includes items for the Roles tutorials.</span></span>

<span data-ttu-id="00f6f-150">[![Vier neue Seiten wurden in den Ordner Rollen hinzugefügt](creating-and-managing-roles-cs/_static/image5.png)](creating-and-managing-roles-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-150">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-cs/_static/image5.png)](creating-and-managing-roles-cs/_static/image4.png)</span></span>

<span data-ttu-id="00f6f-151">**Abbildung 2**: Vier neue Seiten hinzugefügt wurden, die `Roles` Ordner ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-151">**Figure 2**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image6.png))</span></span>

## <a name="step-2-specifying-and-configuring-the-roles-framework-provider"></a><span data-ttu-id="00f6f-152">Schritt 2: Angeben und Konfigurieren des Rollen-Framework-Datenanbieters</span><span class="sxs-lookup"><span data-stu-id="00f6f-152">Step 2: Specifying and Configuring the Roles Framework Provider</span></span>

<span data-ttu-id="00f6f-153">Wie das mitgliedschaftsframework wird das Framework für die Rollen auf dem Anbietermodell erstellt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-153">Like the Membership framework, the Roles framework is built atop the provider model.</span></span> <span data-ttu-id="00f6f-154">Siehe die <a id="_msoanchor_5"> </a> [ *Grundlagen der Sicherheit und Unterstützung für ASP.NET* ](../introduction/security-basics-and-asp-net-support-cs.md) Tutorial .NET Framework ausgeliefert wird, mit drei integrierte Rollen: [ `AuthorizationStoreRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx) , [ `WindowsTokenRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), und [ `SqlRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span><span class="sxs-lookup"><span data-stu-id="00f6f-154">As discussed in the <a id="_msoanchor_5"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-cs.md) tutorial, the .NET Framework ships with three built-in Roles providers: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), and [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span></span> <span data-ttu-id="00f6f-155">Diese tutorialreihe konzentriert sich auf die `SqlRoleProvider`, die Microsoft SQL Server-Datenbank als rollenspeicher verwendet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-155">This tutorial series focuses on the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span>

<span data-ttu-id="00f6f-156">Unter der Hauptebene die Rollen-Framework und `SqlRoleProvider` genau wie das mitgliedschaftsframework Geschäfts- und `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-156">Underneath the covers the Roles framework and `SqlRoleProvider` work just like the Membership framework and `SqlMembershipProvider`.</span></span> <span data-ttu-id="00f6f-157">Das .NET Framework enthält eine `Roles` Klasse, die als API zu Rollen Framework fungiert.</span><span class="sxs-lookup"><span data-stu-id="00f6f-157">The .NET Framework contains a `Roles` class that serves as the API to the Roles framework.</span></span> <span data-ttu-id="00f6f-158">Die `Roles` -Klasse verfügt über statische Methoden wie `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`und so weiter.</span><span class="sxs-lookup"><span data-stu-id="00f6f-158">The `Roles` class has static methods like `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, and so forth.</span></span> <span data-ttu-id="00f6f-159">Wenn eine der folgenden Methoden aufgerufen wird, die `Roles` Klasse der Aufruf an den konfigurierten Anbieter delegiert.</span><span class="sxs-lookup"><span data-stu-id="00f6f-159">When one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="00f6f-160">Die `SqlRoleProvider` arbeitet mit den Tabellen rollenspezifische (`aspnet_Roles` und `aspnet_UsersInRoles`) in der Antwort.</span><span class="sxs-lookup"><span data-stu-id="00f6f-160">The `SqlRoleProvider` works with the role-specific tables (`aspnet_Roles` and `aspnet_UsersInRoles`) in response.</span></span>

<span data-ttu-id="00f6f-161">Zum Verwenden der `SqlRoleProvider` Anbieter in unserer Anwendung, müssen wir angeben, welche Datenbank als Speicher verwendet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-161">In order to use the `SqlRoleProvider` provider in our application, we need to specify what database to use as the store.</span></span> <span data-ttu-id="00f6f-162">Die `SqlRoleProvider` erwartet, dass die angegebene Rolle Store bestimmte Datenbanktabellen, Ansichten und gespeicherte Prozeduren haben.</span><span class="sxs-lookup"><span data-stu-id="00f6f-162">The `SqlRoleProvider` expects the specified role store to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="00f6f-163">Diese erforderlichen Datenbankobjekte können hinzugefügt werden, mithilfe der [ `aspnet_regsql.exe` Tool](https://msdn.microsoft.com/library/ms229862.aspx).</span><span class="sxs-lookup"><span data-stu-id="00f6f-163">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="00f6f-164">An diesem Punkt haben wir bereits eine Datenbank mit dem Schema für die `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-164">At this point we already have a database with the schema necessary for the `SqlRoleProvider`.</span></span> <span data-ttu-id="00f6f-165">In der <a id="_msoanchor_6"> </a> [ *Erstellen des Mitgliedschaftsschemas in SQL Server* ](../membership/creating-the-membership-schema-in-sql-server-cs.md) Tutorial, die wir erstellt, eine Datenbank namens haben `SecurityTutorials.mdf` und `aspnet_regsql.exe` um die Anwendung hinzuzufügen Dienste, die die erforderlichen Datenbankobjekte enthalten die `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-165">Back in the <a id="_msoanchor_6"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) tutorial we created a database named `SecurityTutorials.mdf` and used `aspnet_regsql.exe` to add the application services, which included the database objects required by the `SqlRoleProvider`.</span></span> <span data-ttu-id="00f6f-166">Aus diesem Grund Es muss lediglich das Rollen-Framework, um Unterstützung zu aktivieren und verwenden, teilen die `SqlRoleProvider` mit der `SecurityTutorials.mdf` Datenbank als rollenspeicher.</span><span class="sxs-lookup"><span data-stu-id="00f6f-166">Therefore we just need to tell the Roles framework to enable role support and to use the `SqlRoleProvider` with the `SecurityTutorials.mdf` database as the role store.</span></span>

<span data-ttu-id="00f6f-167">Das Framework für die Rollen konfiguriert ist, über die &lt; `roleManager` &gt; Element in der Anwendung `Web.config` Datei.</span><span class="sxs-lookup"><span data-stu-id="00f6f-167">The Roles framework is configured via the &lt;`roleManager`&gt; element in the application's `Web.config` file.</span></span> <span data-ttu-id="00f6f-168">Standardmäßig ist die rollenunterstützung deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="00f6f-168">By default, role support is disabled.</span></span> <span data-ttu-id="00f6f-169">Um es zu aktivieren, müssen Sie festlegen der [ &lt; `roleManager` &gt; ](https://msdn.microsoft.com/library/ms164660.aspx) des Elements `enabled` Attribut `true` wie folgt:</span><span class="sxs-lookup"><span data-stu-id="00f6f-169">To enable it, you must set the [&lt;`roleManager`&gt;](https://msdn.microsoft.com/library/ms164660.aspx) element's `enabled` attribute to `true` like so:</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample3.xml)]

<span data-ttu-id="00f6f-170">Standardmäßig alle Webanwendungen verfügen über einen Rollenanbieter, der mit dem Namen `AspNetSqlRoleProvider` des Typs `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-170">By default, all web applications have a Roles provider named `AspNetSqlRoleProvider` of type `SqlRoleProvider`.</span></span> <span data-ttu-id="00f6f-171">In diesem Standardanbieter registriert ist `machine.config` (am `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span><span class="sxs-lookup"><span data-stu-id="00f6f-171">This default provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample4.xml)]

<span data-ttu-id="00f6f-172">Des Anbieters `connectionStringName` Attribut gibt an, die Rolle Store, die verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-172">The provider's `connectionStringName` attribute specifies the role store that is used.</span></span> <span data-ttu-id="00f6f-173">Die `AspNetSqlRoleProvider` -Anbieter legt die dieses Attribut auf `LocalSqlServer`, ebenfalls definiert `machine.config` und zeigt, wird standardmäßig mit einer SQL Server 2005 Express Edition-Datenbank in der `App_Data` Ordner mit dem Namen `aspnet.mdf`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-173">The `AspNetSqlRoleProvider` provider sets this attribute to `LocalSqlServer`, which is also defined in `machine.config` and points, by default, to a SQL Server 2005 Express Edition database in the `App_Data` folder named `aspnet.mdf`.</span></span>

<span data-ttu-id="00f6f-174">Daher, wenn wir einfach das Rollen-Framework ermöglichen, ohne alle Anbieterinformationen in der Anwendung `Web.config` -Datei, die Anwendung verwendet, den registriert Rollen Standardanbieter `AspNetSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-174">Consequently, if we simply enable the Roles framework without specifying any provider information in our application's `Web.config` file, the application uses the default registered Roles provider, `AspNetSqlRoleProvider`.</span></span> <span data-ttu-id="00f6f-175">Wenn die `~/App_Data/aspnet.mdf` Datenbank ist nicht vorhanden, die ASP.NET-Laufzeit automatisch erstellt, und fügen Sie das Schema der Application-Dienste.</span><span class="sxs-lookup"><span data-stu-id="00f6f-175">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="00f6f-176">Allerdings möchten wir verwenden die `aspnet.mdf` Datenbank; stattdessen verwendet werden soll die `SecurityTutorials.mdf` -Datenbank, die wir bereits erstellt und die Anwendung Dienstschema in hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="00f6f-176">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database that we have already created and added the application services schema to.</span></span> <span data-ttu-id="00f6f-177">Diese Änderung kann auf zwei Arten erfolgen:</span><span class="sxs-lookup"><span data-stu-id="00f6f-177">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="00f6f-178"><strong>Geben Sie einen Wert für die</strong><strong>`LocalSqlServer`</strong><strong>Namen der Verbindungszeichenfolge der</strong><strong>`Web.config`</strong><strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="00f6f-178"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="00f6f-179">Durch Überschreiben der `LocalSqlServer` Name für Verbindungszeichenfolgenwert in `Web.config`, verwenden wir den Standardanbieter für registrierte Rollen (`AspNetSqlRoleProvider`), damit er ordnungsgemäß funktioniert mit den `SecurityTutorials.mdf` Datenbank.</span><span class="sxs-lookup"><span data-stu-id="00f6f-179">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Roles provider (`AspNetSqlRoleProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="00f6f-180">Weitere Informationen zu dieser Technik finden Sie unter [Scott Guthrie](https://weblogs.asp.net/scottgu/)Blogbeitrag [Konfigurieren von ASP.NET 2.0-Anwendungsdienste für Verwenden von SQL Server 2000 oder SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span><span class="sxs-lookup"><span data-stu-id="00f6f-180">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="00f6f-181"><strong>Fügen Sie einen neuen registrierten Anbieter vom Typ</strong><strong>`SqlRoleProvider`</strong><strong>und konfigurieren Sie die</strong><strong>`connectionStringName`</strong><strong>Einstellung aus, um auf dieverweisen</strong> <strong>`SecurityTutorials.mdf`</strong> <strong>Datenbank.</strong></span><span class="sxs-lookup"><span data-stu-id="00f6f-181"><strong>Add a new registered provider of type</strong><strong>`SqlRoleProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="00f6f-182">Dies ist der Ansatz ich empfohlen und verwendet die <a id="_msoanchor_7"> </a> [ *Erstellen des Mitgliedschaftsschemas in SQL Server* ](../membership/creating-the-membership-schema-in-sql-server-cs.md) und ist der Ansatz, die ich verwende in diesem Tutorial auch.</span><span class="sxs-lookup"><span data-stu-id="00f6f-182">This is the approach I recommended and used in the <a id="_msoanchor_7"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) tutorial, and it is the approach I will use in this tutorial as well.</span></span>

<span data-ttu-id="00f6f-183">Fügen Sie das folgende konfigurationsmarkup von Rollen, um die `Web.config` Datei.</span><span class="sxs-lookup"><span data-stu-id="00f6f-183">Add the following Roles configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="00f6f-184">Dieses Markup registriert einen neuen Anbieter mit dem Namen `SecurityTutorialsSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-184">This markup registers a new provider named `SecurityTutorialsSqlRoleProvider`.</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample5.xml)]

<span data-ttu-id="00f6f-185">Das obenstehende Markup definiert die `SecurityTutorialsSqlRoleProvider` als Standardanbieter (über die `defaultProvider` -Attribut in der `<roleManager>` Element).</span><span class="sxs-lookup"><span data-stu-id="00f6f-185">The above markup defines the `SecurityTutorialsSqlRoleProvider` as the default provider (via the `defaultProvider` attribute in the `<roleManager>` element).</span></span> <span data-ttu-id="00f6f-186">Außerdem wird die `SecurityTutorialsSqlRoleProvider`des `applicationName` auf `SecurityTutorials`, weist die gleichen `applicationName` wie für den Mitgliedschaftsanbieter (`SecurityTutorialsSqlMembershipProvider`).</span><span class="sxs-lookup"><span data-stu-id="00f6f-186">It also sets the `SecurityTutorialsSqlRoleProvider`'s `applicationName` setting to `SecurityTutorials`, which is the same `applicationName` setting used by the Membership provider (`SecurityTutorialsSqlMembershipProvider`).</span></span> <span data-ttu-id="00f6f-187">Obwohl hier nicht angezeigt, die [ `<add>` Element](https://msdn.microsoft.com/library/ms164662.aspx) für die `SqlRoleProvider` enthält möglicherweise auch eine `commandTimeout` Attribut, das Datenbank-Zeitlimit in Sekunden an.</span><span class="sxs-lookup"><span data-stu-id="00f6f-187">While not shown here, the [`<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) for the `SqlRoleProvider` may also contain a `commandTimeout` attribute to specify the database timeout duration, in seconds.</span></span> <span data-ttu-id="00f6f-188">Der Standardwert ist 30.</span><span class="sxs-lookup"><span data-stu-id="00f6f-188">The default value is 30.</span></span>

<span data-ttu-id="00f6f-189">Mit diesem konfigurationsmarkup vorhanden können wir zum Einstieg rollenfunktion in unserer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="00f6f-189">With this configuration markup in place, we are ready to start using role functionality within our application.</span></span>

> [!NOTE]
> <span data-ttu-id="00f6f-190">Das obenstehende konfigurationsmarkup wird die Verwendung der &lt; `roleManager` &gt; des Elements `enabled` und `defaultProvider` Attribute.</span><span class="sxs-lookup"><span data-stu-id="00f6f-190">The above configuration markup illustrates using the &lt;`roleManager`&gt; element's `enabled` and `defaultProvider` attributes.</span></span> <span data-ttu-id="00f6f-191">Es gibt eine Reihe von anderen Attributen, die beeinflussen, wie das Framework Rollen Rolleninformationen pro Benutzer mit dem Benutzernamen zuordnet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-191">There are a number of other attributes that affect how the Roles framework associates role information on a user-by-user basis.</span></span> <span data-ttu-id="00f6f-192">Wir werden diese Einstellungen im Untersuchen der <a id="_msoanchor_8"> </a> [ *rollenbasierte Autorisierung* ](role-based-authorization-cs.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="00f6f-192">We will examine these settings in the <a id="_msoanchor_8"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial.</span></span>

## <a name="step-3-examining-the-roles-api"></a><span data-ttu-id="00f6f-193">Schritt 3: Untersuchen die Rollen-API.</span><span class="sxs-lookup"><span data-stu-id="00f6f-193">Step 3: Examining the Roles API</span></span>

<span data-ttu-id="00f6f-194">Die Rollen-Framework Funktionen werden verfügbar gemacht, über die [ `Roles` Klasse](https://msdn.microsoft.com/library/system.web.security.roles.aspx), die 13 statische Methoden zum Ausführen von Vorgängen rollenbasierte enthält.</span><span class="sxs-lookup"><span data-stu-id="00f6f-194">The Roles framework's functionality is exposed via the [`Roles` class](https://msdn.microsoft.com/library/system.web.security.roles.aspx), which contains thirteen static methods for performing role-based operations.</span></span> <span data-ttu-id="00f6f-195">Wenn wir sehen uns erstellen und Löschen von Rollen in den Schritte4 und 6 werden verwendet, die [ `CreateRole` ](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) und [ `DeleteRole` ](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) -Methoden, die hinzufügen oder entfernen eine Rolle aus dem System.</span><span class="sxs-lookup"><span data-stu-id="00f6f-195">When we look at creating and deleting roles in Steps 4 and 6 we will use the [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) and [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) methods, which add or remove a role from the system.</span></span>

<span data-ttu-id="00f6f-196">Um eine Liste aller Rollen im System abzurufen, verwenden die [ `GetAllRoles` Methode](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (siehe Schritt 5).</span><span class="sxs-lookup"><span data-stu-id="00f6f-196">To get a list of all of the roles in the system, use the [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (see Step 5).</span></span> <span data-ttu-id="00f6f-197">Die [ `RoleExists` Methode](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) gibt einen booleschen Wert, der angibt, ob eine angegebene Rolle vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="00f6f-197">The [`RoleExists` method](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) returns a Boolean value indicating whether a specified role exists.</span></span>

<span data-ttu-id="00f6f-198">Im nächsten Tutorial untersuchen wir zum Zuordnen von Benutzern zu Rollen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-198">In the next tutorial we will examine how to associate users with roles.</span></span> <span data-ttu-id="00f6f-199">Die `Roles` Klasse [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [ `AddUserToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [ `AddUsersToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), und [ `AddUsersToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) Methoden hinzufügen eine oder mehrere Benutzer eine oder mehrere Rollen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-199">The `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), and [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) methods add one or more users to one or more roles.</span></span> <span data-ttu-id="00f6f-200">Um Benutzern Rollen zu entfernen, verwenden die [ `RemoveUserFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [ `RemoveUserFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [ `RemoveUsersFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), oder [ `RemoveUsersFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) -Methoden.</span><span class="sxs-lookup"><span data-stu-id="00f6f-200">To remove users from roles, use the [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), or [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) methods.</span></span>

<span data-ttu-id="00f6f-201">In der <a id="_msoanchor_9"> </a> [ *rollenbasierte Autorisierung* ](role-based-authorization-cs.md) Tutorial betrachten wir Methoden zum programmgesteuerten ein- oder Ausblenden von Funktionen anhand der Rolle des aktuell angemeldeten Benutzers.</span><span class="sxs-lookup"><span data-stu-id="00f6f-201">In the <a id="_msoanchor_9"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial we will look at ways to programmatically show or hide functionality based on the currently logged in user's role.</span></span> <span data-ttu-id="00f6f-202">Zu diesem Zweck verwenden wir die `Role` Klasse [ `FindUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [ `GetRolesForUser` ](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [ `GetUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), oder [ `IsUserInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) Methoden.</span><span class="sxs-lookup"><span data-stu-id="00f6f-202">To accomplish this, we can use the `Role` class's [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), or [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) methods.</span></span>

> [!NOTE]
> <span data-ttu-id="00f6f-203">Denken Sie daran, die einem beliebigen Zeitpunkt eine der folgenden Methoden aufgerufen wird, die `Roles` Klasse der Aufruf an den konfigurierten Anbieter delegiert.</span><span class="sxs-lookup"><span data-stu-id="00f6f-203">Keep in mind that any time one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="00f6f-204">In unserem Fall ist dies bedeutet, dass der Aufruf an gesendet werden die `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-204">In our case, this means that the call is being sent to the `SqlRoleProvider`.</span></span> <span data-ttu-id="00f6f-205">Die `SqlRoleProvider` führt dann die entsprechende Datenbank-Vorgang basierend auf der aufgerufenen Methode.</span><span class="sxs-lookup"><span data-stu-id="00f6f-205">The `SqlRoleProvider` then performs the appropriate database operation based on the invoked method.</span></span> <span data-ttu-id="00f6f-206">Z. B. den Code `Roles.CreateRole("Administrators")` führt die `SqlRoleProvider` Ausführen der `aspnet_Roles_CreateRole` gespeicherte Prozedur, die Fügt einen neuen Datensatz in die `aspnet_Roles` Tabelle, die mit dem Namen Administrators.</span><span class="sxs-lookup"><span data-stu-id="00f6f-206">For example, the code `Roles.CreateRole("Administrators")` results in the `SqlRoleProvider` executing the `aspnet_Roles_CreateRole` stored procedure, which inserts a new record into the `aspnet_Roles` table named Administrators .</span></span>

<span data-ttu-id="00f6f-207">Prüft, dass der Rest dieses Tutorials mit der `Roles` Klasse `CreateRole`, `GetAllRoles`, und `DeleteRole` Methoden, um die Rollen im System zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-207">The remainder of this tutorial looks at using the `Roles` class's `CreateRole`, `GetAllRoles`, and `DeleteRole` methods to manage the roles in the system.</span></span>

## <a name="step-4-creating-new-roles"></a><span data-ttu-id="00f6f-208">Schritt 4: Erstellen neue Rollen</span><span class="sxs-lookup"><span data-stu-id="00f6f-208">Step 4: Creating New Roles</span></span>

<span data-ttu-id="00f6f-209">Rollen bieten eine Möglichkeit, Benutzer nach dem Zufallsprinzip aus, und diese Gruppierung wird am häufigsten für eine praktischere Möglichkeit, Sie gelten die Autorisierungsregeln verwendet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-209">Roles offer a way to arbitrarily group users, and most commonly this grouping is used for a more convenient way to apply authorization rules.</span></span> <span data-ttu-id="00f6f-210">Sondern um Rollen als ein Autorisierungsmechanismus für die zu verwenden, müssen wir zuerst definieren, welche Rollen in der Anwendung vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="00f6f-210">But in order to use roles as an authorization mechanism we first need to define what roles exist in the application.</span></span> <span data-ttu-id="00f6f-211">Leider ist ein CreateRoleWizard-Steuerelement von ASP.NET nicht enthalten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-211">Unfortunately, ASP.NET does not include a CreateRoleWizard control.</span></span> <span data-ttu-id="00f6f-212">Um neue Rollen hinzuzufügen, müssen wir eine geeignete Benutzeroberfläche und Aufrufen der API für die Rollen selbst.</span><span class="sxs-lookup"><span data-stu-id="00f6f-212">In order to add new roles we need to create a suitable user interface and invoke the Roles API ourselves.</span></span> <span data-ttu-id="00f6f-213">Die gute Nachricht ist, dass dies sehr einfach zu erreichen ist.</span><span class="sxs-lookup"><span data-stu-id="00f6f-213">The good news is that this is very easy to accomplish.</span></span>

> [!NOTE]
> <span data-ttu-id="00f6f-214">Es gibt zwar keine CreateRoleWizard-Websteuerelement, besteht die [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), d.h. einer lokalen ASP.NET-Anwendung entwickelt, um Unterstützung bei der Anzeige und Verwaltung der Konfiguration für Ihre Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="00f6f-214">While there is no CreateRoleWizard Web control, there is the [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), which is a local ASP.NET application designed to assist with viewing and managing your web application's configuration.</span></span> <span data-ttu-id="00f6f-215">Ich bin jedoch nicht aus zwei Gründen ein großer Fan von der ASP.NET Web Site Administration Tool.</span><span class="sxs-lookup"><span data-stu-id="00f6f-215">However, I am not a big fan of the ASP.NET Web Site Administration Tool for two reasons.</span></span> <span data-ttu-id="00f6f-216">Zunächst ist es ein wenig fehlerhaften und die Benutzeroberfläche verlässt, viel zu wünschen übrig.</span><span class="sxs-lookup"><span data-stu-id="00f6f-216">First, it is a bit buggy and the user experience leaves a lot to be desired.</span></span> <span data-ttu-id="00f6f-217">Andererseits ist das ASP.NET Websiteverwaltungs-Tool ausgelegt nur lokal bedeutet, dass Sie Ihre eigene Rolle Management-Webseiten erstellen, wenn Sie zur Remoteverwaltung von Rollen auf einer Livewebsite müssen hat.</span><span class="sxs-lookup"><span data-stu-id="00f6f-217">Second, the ASP.NET Web Site Administration Tool is designed to only work locally, meaning that you will have to build your own role management web pages if you need to manage roles on a live site remotely.</span></span> <span data-ttu-id="00f6f-218">Aus diesen zwei Gründen in diesem Tutorial und dem nächsten konzentriert sich auf die Rolle "erforderlich"-Verwaltungstools auf einer Webseite erstellen, statt Sie zu der das ASP.NET Websiteverwaltungs-Tool.</span><span class="sxs-lookup"><span data-stu-id="00f6f-218">For these two reasons, this tutorial and the next will focus on building the necessary role management tools in a web page rather than relying on the ASP.NET Web Site Administration Tool.</span></span>

<span data-ttu-id="00f6f-219">Öffnen der `ManageRoles.aspx` auf der Seite die `Roles` Ordner, und fügen Sie einem Textfeld und einer Schaltfläche-Websteuerelement zur Seite hinzu.</span><span class="sxs-lookup"><span data-stu-id="00f6f-219">Open the `ManageRoles.aspx` page in the `Roles` folder and add a TextBox and a Button Web control to the page.</span></span> <span data-ttu-id="00f6f-220">Legen Sie das Textfeld-Steuerelement `ID` Eigenschaft `RoleName` und der Schaltfläche `ID` und `Text` Eigenschaften `CreateRoleButton` und die Rolle zu erstellen bzw.</span><span class="sxs-lookup"><span data-stu-id="00f6f-220">Set the TextBox control's `ID` property to `RoleName` and the Button's `ID` and `Text` properties to `CreateRoleButton` and Create Role, respectively.</span></span> <span data-ttu-id="00f6f-221">An diesem Punkt sollte deklaratives Markup Ihrer Seite etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="00f6f-221">At this point, your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample6.aspx)]

<span data-ttu-id="00f6f-222">Doppelklicken Sie dann auf die `CreateRoleButton` Schaltflächen-Steuerelement im Designer zum Erstellen einer `Click` -Ereignishandler und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="00f6f-222">Next, double-click the `CreateRoleButton` Button control in the Designer to create a `Click` event handler and then add the following code:</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample7.cs)]

<span data-ttu-id="00f6f-223">Der obige Code beginnt durch Zuweisen der verkürzten Rollenname eingegeben haben, der `RoleName` Textfeldern nicht das für die `newRoleName` Variable.</span><span class="sxs-lookup"><span data-stu-id="00f6f-223">The above code starts by assigning the trimmed role name entered in the `RoleName` TextBox to the `newRoleName` variable.</span></span> <span data-ttu-id="00f6f-224">Als Nächstes die `Roles` Klasse `RoleExists` aufgerufen, um zu bestimmen, ob die Rolle `newRoleName` bereits im System vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="00f6f-224">Next, the `Roles` class's `RoleExists` method is called to determine if the role `newRoleName` already exists in the system.</span></span> <span data-ttu-id="00f6f-225">Wenn die Rolle nicht vorhanden ist, wird er erstellt, über einen Aufruf an die `CreateRole` Methode.</span><span class="sxs-lookup"><span data-stu-id="00f6f-225">If the role does not exist, it is created via a call to the `CreateRole` method.</span></span> <span data-ttu-id="00f6f-226">Wenn die `CreateRole` -Methode übergeben den Namen einer Rolle, die bereits im System vorhanden ist. eine `ProviderException` Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="00f6f-226">If the `CreateRole` method is passed a role name that already exists in the system, a `ProviderException` exception is thrown.</span></span> <span data-ttu-id="00f6f-227">Daher ist der Code zunächst prüft, um sicherzustellen, dass die Rolle im System vor dem Aufruf nicht bereits vorhanden ist `CreateRole`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-227">This is why the code first checks to ensure that the role does not already exist in the system before calling `CreateRole`.</span></span> <span data-ttu-id="00f6f-228">Die `Click` Ereignishandler abgeschlossen wird, indem Sie Sie deaktivieren die `RoleName` Textfeldss `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="00f6f-228">The `Click` event handler concludes by clearing out the `RoleName` TextBox's `Text` property.</span></span>

> [!NOTE]
> <span data-ttu-id="00f6f-229">Vielleicht was passiert, wenn der Benutzer einen beliebigen Wert in eingeben, nicht die `RoleName` Textfeld.</span><span class="sxs-lookup"><span data-stu-id="00f6f-229">You may be wondering what will happen if the user doesn't enter any value into the `RoleName` TextBox.</span></span> <span data-ttu-id="00f6f-230">Wenn der übergebene Wert. in der `CreateRole` Methode `null` oder eine leere Zeichenfolge ist, eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="00f6f-230">If the value passed into the `CreateRole` method is `null` or an empty string, an exception is raised.</span></span> <span data-ttu-id="00f6f-231">Ebenso, wenn der Name der Rolle ein Komma enthält wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="00f6f-231">Likewise, if the role name contains a comma an exception is raised.</span></span> <span data-ttu-id="00f6f-232">Die Seite sollte daher Validierungssteuerelementen, um sicherzustellen, dass der Benutzer eine Rolle gibt und sie keine Kommas enthält enthalten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-232">Consequently, the page should contain validation controls to ensure that the user enters a role and that it does not contain any commas.</span></span> <span data-ttu-id="00f6f-233">Ich lassen Sie für den Leser als Übung.</span><span class="sxs-lookup"><span data-stu-id="00f6f-233">I leave as an exercise for the reader.</span></span>

<span data-ttu-id="00f6f-234">Wir erstellen eine Rolle mit dem Namen Administrators ein.</span><span class="sxs-lookup"><span data-stu-id="00f6f-234">Let's create a role named Administrators.</span></span> <span data-ttu-id="00f6f-235">Besuchen Sie die `ManageRoles.aspx` Seite über einen Browser, und geben Sie in der Administratoren, in das Textfeld ein (siehe Abbildung 3), und klicken Sie dann auf die Schaltfläche "Create Role".</span><span class="sxs-lookup"><span data-stu-id="00f6f-235">Visit the `ManageRoles.aspx` page through a browser, type in Administrators into the textbox (see Figure 3), and then click the Create Role button.</span></span>

<span data-ttu-id="00f6f-236">[![Erstellen Sie eine Rolle "Administratoren"](creating-and-managing-roles-cs/_static/image8.png)](creating-and-managing-roles-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-236">[![Create an Administrators Role](creating-and-managing-roles-cs/_static/image8.png)](creating-and-managing-roles-cs/_static/image7.png)</span></span>

<span data-ttu-id="00f6f-237">**Abbildung 3**: Erstellen Sie eine Rolle "Administratoren" ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-237">**Figure 3**: Create an Administrators Role  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image9.png))</span></span>

<span data-ttu-id="00f6f-238">Was ist los?</span><span class="sxs-lookup"><span data-stu-id="00f6f-238">What happens?</span></span> <span data-ttu-id="00f6f-239">Ein Postback auftritt, aber es gibt keinen visuellen Hinweis, der die Rolle tatsächlich wurde dem System hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-239">A postback occurs, but there's no visual cue that the role has actually been added to the system.</span></span> <span data-ttu-id="00f6f-240">Wir aktualisieren diese Seite in Schritt 5 visuelles Feedback einschließen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-240">We will update this page in Step 5 to include visual feedback.</span></span> <span data-ttu-id="00f6f-241">Im Moment jedoch überprüfen, ob die Rolle erstellt wurde, indem Sie auf die `SecurityTutorials.mdf` -Datenbank und zum Anzeigen der Daten aus der `aspnet_Roles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="00f6f-241">For now, however, you can verify that the role was created by going to the `SecurityTutorials.mdf` database and displaying the data from the `aspnet_Roles` table.</span></span> <span data-ttu-id="00f6f-242">Wie in Abbildung 4 gezeigt, die `aspnet_Roles` Tabelle enthält einen Datensatz für den gerade hinzugefügten Administratorrollen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-242">As Figure 4 shows, the `aspnet_Roles` table contains a record for the just-added Administrators roles.</span></span>

<span data-ttu-id="00f6f-243">[![Die Aspnet_Roles Tabelle enthält eine Zeile für Administratoren](creating-and-managing-roles-cs/_static/image11.png)](creating-and-managing-roles-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-243">[![The aspnet_Roles Table has a Row for the Administrators](creating-and-managing-roles-cs/_static/image11.png)](creating-and-managing-roles-cs/_static/image10.png)</span></span>

<span data-ttu-id="00f6f-244">**Abbildung 4**: Die `aspnet_Roles` Tabelle enthält eine Zeile für die Administratoren ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-244">**Figure 4**: The `aspnet_Roles` Table has a Row for the Administrators  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image12.png))</span></span>

## <a name="step-5-displaying-the-roles-in-the-system"></a><span data-ttu-id="00f6f-245">Schritt 5: Anzeigen von Rollen im System</span><span class="sxs-lookup"><span data-stu-id="00f6f-245">Step 5: Displaying the Roles in the System</span></span>

<span data-ttu-id="00f6f-246">Wir erweitern die `ManageRoles.aspx` Seite, um eine Liste der aktuellen Rollen im System enthalten.</span><span class="sxs-lookup"><span data-stu-id="00f6f-246">Let's augment the `ManageRoles.aspx` page to include a list of the current roles in the system.</span></span> <span data-ttu-id="00f6f-247">Um dies zu erreichen, fügen Sie ein GridView-Steuerelement auf der Seite, und legen Sie dessen `ID` Eigenschaft `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-247">To accomplish this, add a GridView control to the page and set its `ID` property to `RoleList`.</span></span> <span data-ttu-id="00f6f-248">Fügen Sie eine Methode auf der Seite des Code-Behind-Klasse, die mit dem Namen `DisplayRolesInGrid` mithilfe des folgenden Codes:</span><span class="sxs-lookup"><span data-stu-id="00f6f-248">Next, add a method to the page's code-behind class named `DisplayRolesInGrid` using the following code:</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample8.cs)]

<span data-ttu-id="00f6f-249">Die `Roles` Klasse `GetAllRoles` Methodenrückgabe aller Rollen im System als ein Array von Zeichenfolgen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-249">The `Roles` class's `GetAllRoles` method returns all of the roles in the system as an array of strings.</span></span> <span data-ttu-id="00f6f-250">Diese Zeichenfolgen-Array wird anschließend an die GridView gebunden.</span><span class="sxs-lookup"><span data-stu-id="00f6f-250">This string array is then bound to the GridView.</span></span> <span data-ttu-id="00f6f-251">Um die Liste der Rollen an die GridView binden, beim ersten die Seite laden, müssen wir rufen die `DisplayRolesInGrid` Methode aus der Seite `Page_Load` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="00f6f-251">In order to bind the list of roles to the GridView when the page is first loaded, we need to call the `DisplayRolesInGrid` method from the page's `Page_Load` event handler.</span></span> <span data-ttu-id="00f6f-252">Der folgende Code ruft diese Methode auf, wenn die Seite zuerst aufgerufen wird, aber nicht bei nachfolgenden Postbacks.</span><span class="sxs-lookup"><span data-stu-id="00f6f-252">The following code calls this method when the page is first visited, but not on subsequent postbacks.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample9.cs)]

<span data-ttu-id="00f6f-253">Finden Sie mit diesem Code werden auf der Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="00f6f-253">With this code in place, visit the page through a browser.</span></span> <span data-ttu-id="00f6f-254">Wie in Abbildung 5 gezeigt, sehen Sie ein Raster mit einer einzelnen Spalte mit der Bezeichnung Element.</span><span class="sxs-lookup"><span data-stu-id="00f6f-254">As Figure 5 shows, you should see a grid with a single column labeled Item.</span></span> <span data-ttu-id="00f6f-255">Das Raster enthält eine Zeile für die Rolle "Administratoren", die in Schritt 4 hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="00f6f-255">The grid includes a row for the Administrators role we added in Step 4.</span></span>

<span data-ttu-id="00f6f-256">[![GridView zeigt die Rollen in einer einzelnen Spalte an.](creating-and-managing-roles-cs/_static/image14.png)](creating-and-managing-roles-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-256">[![The GridView Displays the Roles in a Single Column](creating-and-managing-roles-cs/_static/image14.png)](creating-and-managing-roles-cs/_static/image13.png)</span></span>

<span data-ttu-id="00f6f-257">**Abbildung 5**: Die GridView zeigt die Rollen in einer einzelnen Spalte ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-257">**Figure 5**: The GridView Displays the Roles in a Single Column  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image15.png))</span></span>

<span data-ttu-id="00f6f-258">GridView zeigt eine einzelne Spalte mit dem Element bezeichnet, weil der GridView `AutoGenerateColumns` -Eigenschaftensatz auf "true" (Standard), wodurch die GridView automatisch eine Spalte für jede Eigenschaft im Erstellen der `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-258">The GridView displays a lone column labeled Item because the GridView's `AutoGenerateColumns` property is set to True (the default), which causes the GridView to automatically create a column for each property in its `DataSource`.</span></span> <span data-ttu-id="00f6f-259">Ein Array verfügt über eine einzelne Eigenschaft, die Elemente im Array, daher die einzelne Spalte in den GridView-Ansicht darstellt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-259">An array has a single property that represents the elements in the array, hence the single column in the GridView.</span></span>

<span data-ttu-id="00f6f-260">Wenn Sie Daten mit einer GridView-Ansicht anzeigen, bevorzuge ich explizit definieren Meine Kolumnen statt sie implizit von der GridView generiert.</span><span class="sxs-lookup"><span data-stu-id="00f6f-260">When displaying data with a GridView, I prefer to explicitly define my columns rather than have them implicitly generated by the GridView.</span></span> <span data-ttu-id="00f6f-261">Durch die Spalten explizit zu definieren ist es einfacher, formatieren Sie die Daten, die Spalten neu anordnen und andere häufige Aufgaben ausführen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-261">By explicitly defining the columns it is much easier to format the data, rearrange the columns, and perform other common tasks.</span></span> <span data-ttu-id="00f6f-262">Aus diesem Grund aktualisieren wir den GridView deklarative Markup, damit die Spalten explizit definiert sind.</span><span class="sxs-lookup"><span data-stu-id="00f6f-262">Therefore, let's update the GridView's declarative markup so that its columns are explicitly defined.</span></span>

<span data-ttu-id="00f6f-263">Starten, indem Sie des GridView `AutoGenerateColumns` Eigenschaft auf "false".</span><span class="sxs-lookup"><span data-stu-id="00f6f-263">Start by setting the GridView's `AutoGenerateColumns` property to False.</span></span> <span data-ttu-id="00f6f-264">Fügen Sie ein TemplateField zum Raster, legen Sie als Nächstes die `HeaderText` Eigenschaft zuweisen, und konfigurieren Sie die `ItemTemplate` , damit sie den Inhalt des Arrays angezeigt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-264">Next, add a TemplateField to the grid, set its `HeaderText` property to Roles, and configure its `ItemTemplate` so that it displays the contents of the array.</span></span> <span data-ttu-id="00f6f-265">Zu diesem Zweck fügen Sie ein Label-Steuerelement mit dem Namen `RoleNameLabel` auf die `ItemTemplate` und binden die `Text` Eigenschaft `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-265">To accomplish this, add a Label Web control named `RoleNameLabel` to the `ItemTemplate` and bind its `Text` property to `Container.DataItem`.</span></span>

<span data-ttu-id="00f6f-266">Diese Eigenschaften und die `ItemTemplate`des Inhalts können deklarativ oder über den GridView Felder (Dialogfeld) und Vorlagen bearbeiten-Schnittstelle festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="00f6f-266">These properties and the `ItemTemplate`'s contents can be set declaratively or through the GridView's Fields dialog box and Edit Templates interface.</span></span> <span data-ttu-id="00f6f-267">Um die Felder im Dialogfeld gelangen, klicken Sie auf den Link "Spalten bearbeiten" in des GridView Smarttag.</span><span class="sxs-lookup"><span data-stu-id="00f6f-267">To reach the Fields dialog box, click the Edit Columns link in the GridView's Smart Tag.</span></span> <span data-ttu-id="00f6f-268">Als Nächstes, deaktivieren Sie das Kontrollkästchen des Automatisches Generieren von-Felder festlegen der `AutoGenerateColumns` Eigenschaft auf "false", und fügen Sie ein TemplateField an die GridView, Festlegen der `HeaderText` Eigenschaft, um die Rolle.</span><span class="sxs-lookup"><span data-stu-id="00f6f-268">Next, uncheck the Auto-generate fields checkbox to set the `AutoGenerateColumns` property to False, and add a TemplateField to the GridView, setting its `HeaderText` property to Role.</span></span> <span data-ttu-id="00f6f-269">Zum Definieren der `ItemTemplate`Inhalt, wählen Sie die Vorlagen bearbeiten-Option von GridView Smarttag.</span><span class="sxs-lookup"><span data-stu-id="00f6f-269">To define the `ItemTemplate`'s contents, choose the Edit Templates option from the GridView's Smart Tag.</span></span> <span data-ttu-id="00f6f-270">Ziehen Sie ein Label-Steuerelement auf der `ItemTemplate`legen die `ID` Eigenschaft `RoleNameLabel`, und seine Databinding-Einstellungen zu konfigurieren, damit die `Text` Eigenschaft gebunden ist `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-270">Drag a Label Web control onto the `ItemTemplate`, set its `ID` property to `RoleNameLabel`, and configure its databinding settings so that its `Text` property is bound to `Container.DataItem`.</span></span>

<span data-ttu-id="00f6f-271">Unabhängig davon, welche Methode Sie verwenden, sieht GridView resultierende deklarative Markup etwa wie folgt, wenn Sie fertig sind.</span><span class="sxs-lookup"><span data-stu-id="00f6f-271">Regardless of what approach you use, the GridView's resulting declarative markup should look similar to the following when you are done.</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample10.aspx)]

> [!NOTE]
> <span data-ttu-id="00f6f-272">Inhalt des Arrays werden angezeigt, mit der Datenbindungssyntax `<%# Container.DataItem %>`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-272">The array's contents are displayed using the databinding syntax `<%# Container.DataItem %>`.</span></span> <span data-ttu-id="00f6f-273">Eine ausführliche Beschreibung der warum diese Syntax verwendet wird, beim Anzeigen des Inhalts eines Arrays an die GridView gebunden ist, würde den Rahmen dieses Tutorials.</span><span class="sxs-lookup"><span data-stu-id="00f6f-273">A thorough description of why this syntax is used when displaying the contents of an array bound to the GridView is beyond the scope of this tutorial.</span></span> <span data-ttu-id="00f6f-274">Weitere Informationen zu dieser Angelegenheit, finden Sie unter [binden ein Array von skalaren auf ein Websteuerelement Daten](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="00f6f-274">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="00f6f-275">Derzeit den `RoleList` GridView ist nur an die Liste der Rollen gebunden, wenn zuerst die Seite besucht wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-275">Currently, the `RoleList` GridView is only bound to the list of roles when the page is first visited.</span></span> <span data-ttu-id="00f6f-276">Wir müssen das Raster zu aktualisieren, wenn eine neue Rolle hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-276">We need to refresh the grid whenever a new role is added.</span></span> <span data-ttu-id="00f6f-277">Aktualisieren Sie zu diesem Zweck die `CreateRoleButton` Schaltfläche `Click` Ereignishandler aufruft und die It die `DisplayRolesInGrid` Methode, wenn eine neue Rolle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-277">To accomplish this, update the `CreateRoleButton` Button's `Click` event handler so that it calls the `DisplayRolesInGrid` method if a new role is created.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample11.cs)]

<span data-ttu-id="00f6f-278">Jetzt bei der Benutzer fügt eine neue Rolle der `RoleList` GridView zeigt die gerade hinzugefügte Rolle beim Postback, Bereitstellen von visuellem Feedback, dass die Rolle erfolgreich erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="00f6f-278">Now when the user adds a new role the `RoleList` GridView shows the just-added role on postback, providing visual feedback that the role was successfully created.</span></span> <span data-ttu-id="00f6f-279">Um dies zu veranschaulichen, finden Sie auf die `ManageRoles.aspx` Seite über einen Browser, und fügen Sie eine Rolle mit dem Namen Vorgesetzte.</span><span class="sxs-lookup"><span data-stu-id="00f6f-279">To illustrate this, visit the `ManageRoles.aspx` page through a browser and add a role named Supervisors.</span></span> <span data-ttu-id="00f6f-280">Nach dem Klicken auf die Schaltfläche "Create Role", wird ein Postback zur Folge haben, und das Raster wird aktualisiert, und Administratoren als auch für die neue Rolle, Supervisor gehören.</span><span class="sxs-lookup"><span data-stu-id="00f6f-280">Upon clicking the Create Role button, a postback will ensue and the grid will update to include Administrators as well as the new role, Supervisors.</span></span>

<span data-ttu-id="00f6f-281">[![Der Supervisor-Rolle zugewiesen wurde, wurde hinzugefügt](creating-and-managing-roles-cs/_static/image17.png)](creating-and-managing-roles-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-281">[![The Supervisors Role has Been Added](creating-and-managing-roles-cs/_static/image17.png)](creating-and-managing-roles-cs/_static/image16.png)</span></span>

<span data-ttu-id="00f6f-282">**Abbildung 6**: Der Supervisor-Rolle zugewiesen wurde, wurde hinzugefügt ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-282">**Figure 6**: The Supervisors Role has Been Added  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image18.png))</span></span>

## <a name="step-6-deleting-roles"></a><span data-ttu-id="00f6f-283">Schritt 6: Löschen von Rollen</span><span class="sxs-lookup"><span data-stu-id="00f6f-283">Step 6: Deleting Roles</span></span>

<span data-ttu-id="00f6f-284">An diesem Punkt ein Benutzer eine neue Rolle erstellen kann, und zeigen Sie alle vorhandene Rollen aus der `ManageRoles.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="00f6f-284">At this point a user can create a new role and view all existing roles from the `ManageRoles.aspx` page.</span></span> <span data-ttu-id="00f6f-285">Wir können Benutzer auch Rollen löschen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-285">Let's allow users to also delete roles.</span></span> <span data-ttu-id="00f6f-286">Die `Roles.DeleteRole` Methode verfügt über zwei Überladungen:</span><span class="sxs-lookup"><span data-stu-id="00f6f-286">The `Roles.DeleteRole` method has two overloads:</span></span>

- <span data-ttu-id="00f6f-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) -Löscht die Rolle *RoleName*.</span><span class="sxs-lookup"><span data-stu-id="00f6f-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="00f6f-288">Eine Ausnahme wird ausgelöst, wenn die Rolle ein oder mehrere Elemente enthält.</span><span class="sxs-lookup"><span data-stu-id="00f6f-288">An exception is thrown if the role contains one or more members.</span></span>
- <span data-ttu-id="00f6f-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) -Löscht die Rolle *RoleName*.</span><span class="sxs-lookup"><span data-stu-id="00f6f-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="00f6f-290">Wenn *ThrowOnPopulateRole* ist `true`, und klicken Sie dann eine Ausnahme ausgelöst wird, wenn die Rolle ein oder mehrere Elemente enthält.</span><span class="sxs-lookup"><span data-stu-id="00f6f-290">If *throwOnPopulateRole* is `true`, then an exception is thrown if the role contains one or more members.</span></span> <span data-ttu-id="00f6f-291">Wenn *ThrowOnPopulateRole* ist `false`, und klicken Sie dann die Rolle gelöscht wird, ob sie alle Elemente oder nicht enthält.</span><span class="sxs-lookup"><span data-stu-id="00f6f-291">If *throwOnPopulateRole* is `false`, then the role is deleted whether it contains any members or not.</span></span> <span data-ttu-id="00f6f-292">Intern wird die `DeleteRole(roleName)` Methodenaufrufe `DeleteRole(roleName, true)`.</span><span class="sxs-lookup"><span data-stu-id="00f6f-292">Internally, the `DeleteRole(roleName)` method calls `DeleteRole(roleName, true)`.</span></span>

<span data-ttu-id="00f6f-293">Die `DeleteRole` Methode löst außerdem eine Ausnahme aus, wenn *RoleName* ist `null` oder eine leere Zeichenfolge oder, wenn *RoleName* enthält ein Komma.</span><span class="sxs-lookup"><span data-stu-id="00f6f-293">The `DeleteRole` method will also throw an exception if *roleName* is `null` or an empty string or if *roleName* contains a comma.</span></span> <span data-ttu-id="00f6f-294">Wenn *RoleName* ist nicht im System `DeleteRole` fehlschlägt, im Hintergrund, ohne eine Ausnahme auszulösen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-294">If *roleName* does not exist in the system, `DeleteRole` fails silently, without raising an exception.</span></span>

<span data-ttu-id="00f6f-295">Wir erweitern die GridView in `ManageRoles.aspx` sollen eine Löschen-Schaltfläche geklickt wird, löscht die ausgewählte Rolle.</span><span class="sxs-lookup"><span data-stu-id="00f6f-295">Let's augment the GridView in `ManageRoles.aspx` to include a Delete button that, when clicked, deletes the selected role.</span></span> <span data-ttu-id="00f6f-296">Starten Sie, indem eine Löschen-Schaltfläche an die GridView hinzufügen, indem Sie die Felder (Dialogfeld) und Hinzufügen einer Schaltfläche "löschen", der sich unter der Option "CommandField" befindet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-296">Start by adding a Delete button to the GridView by going to the Fields dialog box and adding a Delete button, which is located under the CommandField option.</span></span> <span data-ttu-id="00f6f-297">Stellen Sie das Löschen die Spalte ganz linke Schaltfläche, und legen Sie dessen `DeleteText` Eigenschaft, um die Rolle zu löschen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-297">Make the Delete button the far left column and set its `DeleteText` property to Delete Role .</span></span>

<span data-ttu-id="00f6f-298">[![Hinzufügen einer Schaltfläche "löschen" an die RoleList GridView](creating-and-managing-roles-cs/_static/image20.png)](creating-and-managing-roles-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="00f6f-298">[![Add a Delete Button to the RoleList GridView](creating-and-managing-roles-cs/_static/image20.png)](creating-and-managing-roles-cs/_static/image19.png)</span></span>

<span data-ttu-id="00f6f-299">**Abbildung 7**: Hinzufügen einer Schaltfläche löschen, um die `RoleList` GridView ([klicken Sie, um das Bild in voller Größe anzeigen](creating-and-managing-roles-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="00f6f-299">**Figure 7**: Add a Delete Button to the `RoleList` GridView  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image21.png))</span></span>

<span data-ttu-id="00f6f-300">Nach dem Hinzufügen der Schaltfläche "löschen", sollte Ihre GridView deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="00f6f-300">After adding the Delete button, your GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample12.aspx)]

<span data-ttu-id="00f6f-301">Als Nächstes erstellen Sie einen Ereignishandler für der GridView `RowDeleting` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="00f6f-301">Next, create an event handler for the GridView's `RowDeleting` event.</span></span> <span data-ttu-id="00f6f-302">Dies ist das Ereignis, das beim Postback ausgelöst wird, wenn die Rolle löschen-Schaltfläche geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-302">This is the event that is raised on postback when the Delete Role button is clicked.</span></span> <span data-ttu-id="00f6f-303">Fügen Sie dem Ereignishandler folgenden Code hinzu.</span><span class="sxs-lookup"><span data-stu-id="00f6f-303">Add the following code to the event handler.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample13.cs)]

<span data-ttu-id="00f6f-304">Der Code beginnt, durch Programmgesteuertes Verweisen auf die `RoleNameLabel` Webserver-Steuerelement in der Zeile, deren Rolle löschen-Schaltfläche geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="00f6f-304">The code starts by programmatically referencing the `RoleNameLabel` Web control in the row whose Delete Role button was clicked.</span></span> <span data-ttu-id="00f6f-305">Die `Roles.DeleteRole` Methode wird dann aufgerufen, übergibt die `Text` von der `RoleNameLabel` und `false`, wodurch löschen Sie die Rolle, unabhängig davon, ob alle Benutzer der Rolle zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="00f6f-305">The `Roles.DeleteRole` method is then invoked, passing in the `Text` of the `RoleNameLabel` and `false`, thereby deleting the role regardless of whether there are any users associated with the role.</span></span> <span data-ttu-id="00f6f-306">Zum Schluss die `RoleList` GridView wird aktualisiert, damit die Rolle nur gelöschte nicht mehr im Raster angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="00f6f-306">Finally, the `RoleList` GridView is refreshed so that the just-deleted role no longer appears in the grid.</span></span>

> [!NOTE]
> <span data-ttu-id="00f6f-307">Die Schaltfläche "Löschen der Rolle" erfordert ein beliebiges Bestätigung durch den Benutzer vor dem Löschen der Rolle nicht.</span><span class="sxs-lookup"><span data-stu-id="00f6f-307">The Delete Role button does not require any sort of confirmation from the user before deleting the role.</span></span> <span data-ttu-id="00f6f-308">Eine der einfachsten Möglichkeiten, eine Aktion zu bestätigen ist über ein Dialogfeld für die clientseitige bestätigen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-308">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="00f6f-309">Weitere Informationen zu dieser Technik finden Sie unter [Hinzufügen der clientseitigen Bestätigung beim Löschen von](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="00f6f-309">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="00f6f-310">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="00f6f-310">Summary</span></span>

<span data-ttu-id="00f6f-311">Viele Webanwendungen verfügen über bestimmte Autorisierungsregeln oder auf Seitenebene-Funktionen, die nur bestimmte Klassen von Benutzern zur Verfügung steht.</span><span class="sxs-lookup"><span data-stu-id="00f6f-311">Many web applications have certain authorization rules or page-level functionality that is only available to certain classes of users.</span></span> <span data-ttu-id="00f6f-312">Möglicherweise gibt es z. B. ein Satz von Webseiten, die nur Administratoren zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="00f6f-312">For example, there may be a set of web pages that only administrators can access.</span></span> <span data-ttu-id="00f6f-313">Anstatt definieren diese Autorisierungsregeln pro Benutzer mit dem Benutzernamen, ist es häufig sinnvoller, die Regeln basierend auf einer Rolle zu definieren.</span><span class="sxs-lookup"><span data-stu-id="00f6f-313">Rather than defining these authorization rules on a user-by-user basis, oftentimes it is more useful to define the rules based on a role.</span></span> <span data-ttu-id="00f6f-314">Also anstatt explizit ermöglicht Benutzern Scott und Jisun auf die administrative Seiten zugreifen, ein besser verwaltbaren Ansatz sind Mitglieder der Rolle "Administratoren" Zugriff auf diese Seiten, und klicken Sie dann auf, um anzugeben, Scott und Jisun als Benutzer, die die Rolle "Administratoren".</span><span class="sxs-lookup"><span data-stu-id="00f6f-314">That is, rather than explicitly allowing users Scott and Jisun to access the administrative web pages, a more maintainable approach is to permit members of the Administrators role to access these pages, and then to denote Scott and Jisun as users belonging to the Administrators role.</span></span>

<span data-ttu-id="00f6f-315">Die Rollen-Framework erleichtert das Erstellen und Verwalten von Rollen.</span><span class="sxs-lookup"><span data-stu-id="00f6f-315">The Roles framework makes it easy to create and manage roles.</span></span> <span data-ttu-id="00f6f-316">In diesem Tutorial wurde beschrieben, wie so konfigurieren Sie die Rollen-Framework mit der `SqlRoleProvider`, die Microsoft SQL Server-Datenbank als rollenspeicher verwendet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-316">In this tutorial we examined how to configure the Roles framework to use the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span> <span data-ttu-id="00f6f-317">Es wurde außerdem eine Webseite, die Listet die vorhandenen Rollen im System, und ermöglicht neue Rollen erstellt werden soll, und vorhandene gelöscht werden soll.</span><span class="sxs-lookup"><span data-stu-id="00f6f-317">We also created a web page that lists the existing roles in the system and allows for new roles to be created and existing ones to be deleted.</span></span> <span data-ttu-id="00f6f-318">In den nachfolgenden Tutorials wird zum Zuweisen von Benutzern zu Rollen und zum Anwenden der rollenbasierten Autorisierung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="00f6f-318">In subsequent tutorials we will see how to assign users to roles and how to apply role-based authorization.</span></span>

<span data-ttu-id="00f6f-319">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="00f6f-319">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="00f6f-320">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="00f6f-320">Further Reading</span></span>

<span data-ttu-id="00f6f-321">Weitere Informationen zu den Themen in diesem Tutorial erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="00f6f-321">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="00f6f-322">Untersuchen von ASP.NET 2.0 Mitgliedschaft, Rollen und Profile</span><span class="sxs-lookup"><span data-stu-id="00f6f-322">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="00f6f-323">How To: Verwenden Sie Rollen-Manager in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="00f6f-323">How To: Use Role Manager in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998314.aspx)
- [<span data-ttu-id="00f6f-324">Rollenanbieter</span><span class="sxs-lookup"><span data-stu-id="00f6f-324">Role Providers</span></span>](https://msdn.microsoft.com/library/aa478950.aspx)
- [<span data-ttu-id="00f6f-325">Paralleles eigene Websiteverwaltungs-Tool</span><span class="sxs-lookup"><span data-stu-id="00f6f-325">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="00f6f-326">Technische Dokumentation für die `<roleManager>` Element</span><span class="sxs-lookup"><span data-stu-id="00f6f-326">Technical documentation for the `<roleManager>` Element</span></span>](https://msdn.microsoft.com/library/ms164660.aspx)
- [<span data-ttu-id="00f6f-327">Verwenden die Mitgliedschaft und Rollen-Manager-APIs</span><span class="sxs-lookup"><span data-stu-id="00f6f-327">Using the Membership and Role Manager APIs</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx)

### <a name="about-the-author"></a><span data-ttu-id="00f6f-328">Der Autor</span><span class="sxs-lookup"><span data-stu-id="00f6f-328">About the Author</span></span>

<span data-ttu-id="00f6f-329">Scott Mitchell, Autor von mehreren Büchern zu ASP/ASP.NET und Gründer von 4GuysFromRolla.com, ist seit 1998 mit Microsoft-Web-Technologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="00f6f-329">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="00f6f-330">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="00f6f-330">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="00f6f-331">Sein neueste Buch wird *[Sams Schulen selbst ASP.NET 2.0 in 24 Stunden](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="00f6f-331">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="00f6f-332">Scott erreicht werden kann, zur [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="00f6f-332">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="00f6f-333">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="00f6f-333">Special Thanks To</span></span>

<span data-ttu-id="00f6f-334">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="00f6f-334">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="00f6f-335">Führendes Prüfer für dieses Tutorial enthalten Alicja Maziarz Suchi Banerjee und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="00f6f-335">Lead reviewers for this tutorial include Alicja Maziarz, Suchi Banerjee, and Teresa Murphy.</span></span> <span data-ttu-id="00f6f-336">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="00f6f-336">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="00f6f-337">Wenn dies der Fall ist, löschen Sie mir eine Linie an [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="00f6f-337">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="00f6f-338">Nächste</span><span class="sxs-lookup"><span data-stu-id="00f6f-338">Next</span></span>](assigning-roles-to-users-cs.md)
