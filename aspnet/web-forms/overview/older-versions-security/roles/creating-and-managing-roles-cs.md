---
uid: web-forms/overview/older-versions-security/roles/creating-and-managing-roles-cs
title: Erstellen und Verwalten von RollenC#() | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial werden die erforderlichen Schritte zum Konfigurieren des Rollen-Frameworks erläutert. Danach erstellen wir Webseiten, mit denen Rollen erstellt und gelöscht werden.
ms.author: riande
ms.date: 03/24/2008
ms.assetid: 113f10b3-a19a-471b-8ff6-db3c79ce8a91
msc.legacyurl: /web-forms/overview/older-versions-security/roles/creating-and-managing-roles-cs
msc.type: authoredcontent
ms.openlocfilehash: a7883d0b05f2fa5a3fdac887f8c8b39d70418fb3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78520065"
---
# <a name="creating-and-managing-roles-c"></a><span data-ttu-id="75537-104">Erstellen und Verwalten von Rollen (C#)</span><span class="sxs-lookup"><span data-stu-id="75537-104">Creating and Managing Roles (C#)</span></span>

<span data-ttu-id="75537-105">von [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="75537-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="75537-106">[Code herunterladen](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.09.zip) oder [PDF herunterladen](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="75537-106">[Download Code](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/CS.09.zip) or [Download PDF](https://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_cs.pdf)</span></span>

> <span data-ttu-id="75537-107">In diesem Tutorial werden die erforderlichen Schritte zum Konfigurieren des Rollen-Frameworks erläutert.</span><span class="sxs-lookup"><span data-stu-id="75537-107">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="75537-108">Danach erstellen wir Webseiten, mit denen Rollen erstellt und gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="75537-108">Following that, we will build web pages to create and delete roles.</span></span>

## <a name="introduction"></a><span data-ttu-id="75537-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="75537-109">Introduction</span></span>

<span data-ttu-id="75537-110"><a id="_msoanchor_1"> </a>Im Tutorial zur [*benutzerbasierten Autorisierung*](../membership/user-based-authorization-cs.md) haben wir uns mit der Verwendung der URL-Autorisierung beschäftigt, um bestimmte Benutzer von einer Gruppe von Seiten einzuschränken und deklarative und programmgesteuerte Techniken zum Anpassen der Funktionalität einer ASP.NET-Seite basierend auf dem Benutzer zu untersuchen.</span><span class="sxs-lookup"><span data-stu-id="75537-110">In the <a id="_msoanchor_1"></a>[*User-Based Authorization*](../membership/user-based-authorization-cs.md) tutorial we looked at using URL authorization to restrict certain users from a set of pages and explored declarative and programmatic techniques for adjusting an ASP.NET page's functionality based on the visiting user.</span></span> <span data-ttu-id="75537-111">Das Erteilen von Berechtigungen für den Seiten Zugriff oder die Benutzer-zu-Benutzer-Basis kann jedoch zu einem Wartungs Albtraum in Szenarios werden, in denen viele Benutzerkonten vorhanden sind oder wenn sich die Benutzerberechtigungen häufig ändern.</span><span class="sxs-lookup"><span data-stu-id="75537-111">Granting permission for page access or functionality on a user-by-user basis, however, can become a maintenance nightmare in scenarios where there are many user accounts or when users' privileges change often.</span></span> <span data-ttu-id="75537-112">Jedes Mal, wenn ein Benutzer die Autorisierung zum Ausführen einer bestimmten Aufgabe erhält oder verliert, muss der Administrator die entsprechenden URL-Autorisierungs Regeln, das deklarative Markup und den Code aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="75537-112">Any time a user gains or loses authorization to perform a particular task, the administrator needs to update the appropriate URL authorization rules, declarative markup, and code.</span></span>

<span data-ttu-id="75537-113">In der Regel ist es hilfreich, Benutzer in Gruppen oder *Rollen* zu klassifizieren und dann Berechtigungen für Rollen Weise anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="75537-113">It usually helps to classify users into groups or *roles* and then to apply permissions on a role-by-role basis.</span></span> <span data-ttu-id="75537-114">Beispielsweise verfügen die meisten Webanwendungen über eine bestimmte Gruppe von Seiten oder Tasks, die nur für Administratoren reserviert sind.</span><span class="sxs-lookup"><span data-stu-id="75537-114">For example, most web applications have a certain set of pages or tasks that are reserved only for administrative users.</span></span> <span data-ttu-id="75537-115">Mithilfe der im Tutorial zur *benutzerbasierten Autorisierung* gewonnenen Techniken fügen wir die entsprechenden URL-Autorisierungs Regeln, das deklarative Markup und den Code hinzu, um den angegebenen Benutzerkonten das Ausführen administrativer Aufgaben zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="75537-115">Using the techniques learned in the *User-Based Authorization* tutorial, we would add the appropriate URL authorization rules, declarative markup, and code to allow the specified user accounts to perform administrative tasks.</span></span> <span data-ttu-id="75537-116">Wenn jedoch ein neuer Administrator hinzugefügt wurde oder wenn ein vorhandener Administrator seine Administratorrechte widerrufen musste, müssten die Konfigurationsdateien und Webseiten zurückgegeben und aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="75537-116">But if a new administrator was added or if an existing administrator needed to have her administration rights revoked, we would have to return and update the configuration files and web pages.</span></span> <span data-ttu-id="75537-117">Mit Rollen können wir jedoch eine Rolle namens "Administratoren" erstellen und diese vertrauenswürdigen Benutzer der Administrator Rolle zuweisen.</span><span class="sxs-lookup"><span data-stu-id="75537-117">With roles, however, we could create a role called Administrators and assign those trusted users to the Administrators role.</span></span> <span data-ttu-id="75537-118">Als Nächstes fügen wir die entsprechenden URL-Autorisierungs Regeln, das deklarative Markup und den Code hinzu, damit die Administrator Rolle die verschiedenen administrativen Aufgaben ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="75537-118">Next, we would add the appropriate URL authorization rules, declarative markup, and code to allow the Administrators role to perform the various administrative tasks.</span></span> <span data-ttu-id="75537-119">Wenn diese Infrastruktur vorhanden ist, ist das Hinzufügen neuer Administratoren zur Website oder das Entfernen vorhandener Administratoren so einfach wie das einschließen oder Entfernen des Benutzers aus der Administrator Rolle.</span><span class="sxs-lookup"><span data-stu-id="75537-119">With this infrastructure in place, adding new administrators to the site or removing existing ones is as simple as including or removing the user from the Administrators role.</span></span> <span data-ttu-id="75537-120">Es sind keine Konfigurations-, deklarative Markup-oder Codeänderungen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="75537-120">No configuration, declarative markup, or code changes are necessary.</span></span>

<span data-ttu-id="75537-121">ASP.net bietet ein Rollen Framework zum Definieren von Rollen und zum Zuordnen der Rollen zu Benutzerkonten.</span><span class="sxs-lookup"><span data-stu-id="75537-121">ASP.NET offers a Roles framework for defining roles and associating them with user accounts.</span></span> <span data-ttu-id="75537-122">Mit dem Rollen Framework können wir Rollen erstellen und löschen, Benutzer zu einer Rolle hinzufügen oder aus einer Rolle entfernen, den Satz von Benutzern ermitteln, die zu einer bestimmten Rolle gehören, und feststellen, ob ein Benutzer zu einer bestimmten Rolle gehört.</span><span class="sxs-lookup"><span data-stu-id="75537-122">With the Roles framework we can create and delete roles, add users to or remove users from a role, determine the set of users that belong to a particular role, and tell whether a user belongs to a particular role.</span></span> <span data-ttu-id="75537-123">Nachdem das Rollen Framework konfiguriert wurde, können wir den Zugriff auf Seiten auf Rollen Basis über URL-Autorisierungs Regeln einschränken und zusätzliche Informationen oder Funktionen auf einer Seite auf der Grundlage der aktuell angemeldeten Benutzer Rollen anzeigen oder ausblenden.</span><span class="sxs-lookup"><span data-stu-id="75537-123">Once the Roles framework has been configured, we can limit access to pages on a role-by-role basis through URL authorization rules and show or hide additional information or functionality on a page based on the currently logged on user's roles.</span></span>

<span data-ttu-id="75537-124">In diesem Tutorial werden die erforderlichen Schritte zum Konfigurieren des Rollen-Frameworks erläutert.</span><span class="sxs-lookup"><span data-stu-id="75537-124">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="75537-125">Danach erstellen wir Webseiten, mit denen Rollen erstellt und gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="75537-125">Following that, we will build web pages to create and delete roles.</span></span> <span data-ttu-id="75537-126"><a id="_msoanchor_2"> </a>Im Tutorial [*Zuweisen von Rollen zu Benutzern*](assigning-roles-to-users-cs.md) wird erläutert, wie Sie Benutzer zu Rollen hinzufügen und daraus entfernen.</span><span class="sxs-lookup"><span data-stu-id="75537-126">In the <a id="_msoanchor_2"></a>[*Assigning Roles to Users*](assigning-roles-to-users-cs.md) tutorial we will look at how to add and remove users from roles.</span></span> <span data-ttu-id="75537-127">Im <a id="_msoanchor_3"> </a>Tutorial zur [*rollenbasierten Autorisierung*](role-based-authorization-cs.md) erfahren Sie, wie Sie den Zugriff auf Seiten auf Rollen Basis beschränken und wie Sie die Seiten Funktionalität abhängig von der Rolle des Besuchs Benutzers anpassen.</span><span class="sxs-lookup"><span data-stu-id="75537-127">And in the <a id="_msoanchor_3"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial we will see how to limit access to pages on a role-by-role basis along with how to adjust page functionality depending on the visiting user's role.</span></span> <span data-ttu-id="75537-128">Erste Schritte</span><span class="sxs-lookup"><span data-stu-id="75537-128">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="75537-129">Schritt 1: Hinzufügen neuer ASP.NET Seiten</span><span class="sxs-lookup"><span data-stu-id="75537-129">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="75537-130">In diesem Tutorial und den nächsten beiden werden verschiedene Rollen bezogene Funktionen und Funktionen untersucht.</span><span class="sxs-lookup"><span data-stu-id="75537-130">In this tutorial and the next two we will be examining various roles-related functions and capabilities.</span></span> <span data-ttu-id="75537-131">Wir benötigen eine Reihe von ASP.NET-Seiten, um die in diesen Tutorials untersuchten Themen zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="75537-131">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="75537-132">Erstellen Sie diese Seiten, und aktualisieren Sie die Site Übersicht.</span><span class="sxs-lookup"><span data-stu-id="75537-132">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="75537-133">Erstellen Sie zunächst einen neuen Ordner in dem Projekt mit dem Namen `Roles`.</span><span class="sxs-lookup"><span data-stu-id="75537-133">Start by creating a new folder in the project named `Roles`.</span></span> <span data-ttu-id="75537-134">Fügen Sie als nächstes vier neue ASP.NET-Seiten zum Ordner "`Roles`" hinzu, wobei jede Seite mit der `Site.master` Master Seite verknüpft wird.</span><span class="sxs-lookup"><span data-stu-id="75537-134">Next, add four new ASP.NET pages to the `Roles` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="75537-135">Benennen Sie die Seiten:</span><span class="sxs-lookup"><span data-stu-id="75537-135">Name the pages:</span></span>

- `ManageRoles.aspx`
- `UsersAndRoles.aspx`
- `CreateUserWizardWithRoles.aspx`
- `RoleBasedAuthorization.aspx`

<span data-ttu-id="75537-136">An diesem Punkt sollte die Projektmappen-Explorer des Projekts ähnlich wie der Screenshot in Abbildung 1 aussehen.</span><span class="sxs-lookup"><span data-stu-id="75537-136">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="75537-137">[dem Ordner "Rollen" wurden ![vier neue Seiten hinzugefügt.](creating-and-managing-roles-cs/_static/image2.png)](creating-and-managing-roles-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="75537-137">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-cs/_static/image2.png)](creating-and-managing-roles-cs/_static/image1.png)</span></span>

<span data-ttu-id="75537-138">**Abbildung 1**: vier neue Seiten wurden dem `Roles` Ordner hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="75537-138">**Figure 1**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image3.png))</span></span>

<span data-ttu-id="75537-139">Jede Seite sollte an diesem Punkt über die beiden Inhalts Steuerelemente verfügen, eine für jede der Inhalts Platzhalter der Master Seite: `MainContent` und `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="75537-139">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample1.aspx)]

<span data-ttu-id="75537-140">Beachten Sie, dass das Standard Markup des `LoginContent` contentplachalter einen Link zum Anmelden oder Abmelden der Website anzeigt, je nachdem, ob der Benutzer authentifiziert ist.</span><span class="sxs-lookup"><span data-stu-id="75537-140">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="75537-141">Wenn das `Content2` Content-Steuerelement auf der Seite ASP.net vorhanden ist, wird jedoch das Standard Markup der Master Seite überschrieben.</span><span class="sxs-lookup"><span data-stu-id="75537-141">The presence of the `Content2` Content control in the ASP.NET page, however, overrides the master page's default markup.</span></span> <span data-ttu-id="75537-142">Wie in <a id="_msoanchor_4"> </a> [*einer Übersicht über*](../introduction/an-overview-of-forms-authentication-cs.md) das Tutorial zur Formular Authentifizierung erläutert, ist das Überschreiben des Standard Markups in Seiten nützlich, bei denen wir keine Anmelde bezogenen Optionen in der linken Spalte anzeigen möchten.</span><span class="sxs-lookup"><span data-stu-id="75537-142">As we discussed in <a id="_msoanchor_4"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, overriding the default markup is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="75537-143">Für diese vier Seiten möchten wir jedoch das Standard Markup der Master Seite für den `LoginContent` contentplachalter anzeigen.</span><span class="sxs-lookup"><span data-stu-id="75537-143">For these four pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="75537-144">Entfernen Sie deshalb das deklarative Markup für das `Content2` Content-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="75537-144">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="75537-145">Anschließend sollte jedes Markup der vier Seite nur ein Inhalts Steuerelement enthalten.</span><span class="sxs-lookup"><span data-stu-id="75537-145">After doing so, each of the four page's markup should contain just one Content control.</span></span>

<span data-ttu-id="75537-146">Abschließend aktualisieren wir die Site Map (`Web.sitemap`) so, dass Sie diese neuen Webseiten enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-146">Finally, let's update the site map (`Web.sitemap`) to include these new web pages.</span></span> <span data-ttu-id="75537-147">Fügen Sie den folgenden XML-Code nach `<siteMapNode>` dem hinzu, den Sie für die Mitgliedschafts Lernprogramme</span><span class="sxs-lookup"><span data-stu-id="75537-147">Add the following XML after the `<siteMapNode>` we added for the Membership tutorials.</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample2.xml)]

<span data-ttu-id="75537-148">Wenn die Site Übersicht aktualisiert wurde, besuchen Sie die Website über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="75537-148">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="75537-149">Wie in Abbildung 2 gezeigt, enthält die Navigation auf der linken Seite die Elemente für die Lernprogramme "Rollen".</span><span class="sxs-lookup"><span data-stu-id="75537-149">As Figure 2 shows, the navigation on the left now includes items for the Roles tutorials.</span></span>

<span data-ttu-id="75537-150">[dem Ordner "Rollen" wurden ![vier neue Seiten hinzugefügt.](creating-and-managing-roles-cs/_static/image5.png)](creating-and-managing-roles-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="75537-150">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-cs/_static/image5.png)](creating-and-managing-roles-cs/_static/image4.png)</span></span>

<span data-ttu-id="75537-151">**Abbildung 2**: vier neue Seiten wurden zum `Roles` Ordner hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="75537-151">**Figure 2**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image6.png))</span></span>

## <a name="step-2-specifying-and-configuring-the-roles-framework-provider"></a><span data-ttu-id="75537-152">Schritt 2: angeben und Konfigurieren des Rollen Framework-Anbieters</span><span class="sxs-lookup"><span data-stu-id="75537-152">Step 2: Specifying and Configuring the Roles Framework Provider</span></span>

<span data-ttu-id="75537-153">Wie das Mitgliedschafts Framework basiert das Rollen Framework auf dem Anbieter Modell.</span><span class="sxs-lookup"><span data-stu-id="75537-153">Like the Membership framework, the Roles framework is built atop the provider model.</span></span> <span data-ttu-id="75537-154">Wie im Lernprogramm <a id="_msoanchor_5"> </a>zu den [*Sicherheitsgrundlagen und ASP.NET-Unterstützung*](../introduction/security-basics-and-asp-net-support-cs.md) erläutert, werden die .NET Framework mit drei integrierten Rollen Anbietern ausgeliefert: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx)und [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span><span class="sxs-lookup"><span data-stu-id="75537-154">As discussed in the <a id="_msoanchor_5"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-cs.md) tutorial, the .NET Framework ships with three built-in Roles providers: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), and [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span></span> <span data-ttu-id="75537-155">Diese tutorialreihe konzentriert sich auf die `SqlRoleProvider`, die eine Microsoft SQL Server-Datenbank als Rollen Speicher verwendet.</span><span class="sxs-lookup"><span data-stu-id="75537-155">This tutorial series focuses on the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span>

<span data-ttu-id="75537-156">Unterhalb von werden das Rollen Framework und `SqlRoleProvider` wie das Mitgliedschafts Framework und `SqlMembershipProvider`funktionieren.</span><span class="sxs-lookup"><span data-stu-id="75537-156">Underneath the covers the Roles framework and `SqlRoleProvider` work just like the Membership framework and `SqlMembershipProvider`.</span></span> <span data-ttu-id="75537-157">Der .NET Framework enthält eine `Roles` Klasse, die als API für das Rollen Framework fungiert.</span><span class="sxs-lookup"><span data-stu-id="75537-157">The .NET Framework contains a `Roles` class that serves as the API to the Roles framework.</span></span> <span data-ttu-id="75537-158">Die `Roles`-Klasse verfügt über statische Methoden wie `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`und so weiter.</span><span class="sxs-lookup"><span data-stu-id="75537-158">The `Roles` class has static methods like `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, and so forth.</span></span> <span data-ttu-id="75537-159">Wenn eine dieser Methoden aufgerufen wird, delegiert die `Roles`-Klasse den Aufruf an den konfigurierten Anbieter.</span><span class="sxs-lookup"><span data-stu-id="75537-159">When one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="75537-160">Der `SqlRoleProvider` funktioniert mit den Rollen spezifischen Tabellen (`aspnet_Roles` und `aspnet_UsersInRoles`) als Antwort.</span><span class="sxs-lookup"><span data-stu-id="75537-160">The `SqlRoleProvider` works with the role-specific tables (`aspnet_Roles` and `aspnet_UsersInRoles`) in response.</span></span>

<span data-ttu-id="75537-161">Um den `SqlRoleProvider` Anbieter in unserer Anwendung verwenden zu können, müssen wir angeben, welche Datenbank als Speicher verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="75537-161">In order to use the `SqlRoleProvider` provider in our application, we need to specify what database to use as the store.</span></span> <span data-ttu-id="75537-162">Der `SqlRoleProvider` erwartet, dass der angegebene Rollen Speicher über bestimmte Datenbanktabellen, Sichten und gespeicherte Prozeduren verfügt.</span><span class="sxs-lookup"><span data-stu-id="75537-162">The `SqlRoleProvider` expects the specified role store to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="75537-163">Diese erforderlichen Datenbankobjekte können mithilfe des [`aspnet_regsql.exe` Tools](https://msdn.microsoft.com/library/ms229862.aspx)hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="75537-163">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="75537-164">An diesem Punkt verfügen wir bereits über eine Datenbank mit dem Schema, das für die `SqlRoleProvider`erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="75537-164">At this point we already have a database with the schema necessary for the `SqlRoleProvider`.</span></span> <span data-ttu-id="75537-165">Zurück zum <a id="_msoanchor_6"> </a> [*Erstellen des Mitgliedschafts Schemas in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) Tutorial haben wir eine Datenbank mit dem Namen `SecurityTutorials.mdf` erstellt und `aspnet_regsql.exe` zum Hinzufügen der Anwendungsdienste verwendet, die die für die `SqlRoleProvider`erforderlichen Datenbankobjekte enthalten.</span><span class="sxs-lookup"><span data-stu-id="75537-165">Back in the <a id="_msoanchor_6"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) tutorial we created a database named `SecurityTutorials.mdf` and used `aspnet_regsql.exe` to add the application services, which included the database objects required by the `SqlRoleProvider`.</span></span> <span data-ttu-id="75537-166">Daher müssen wir nur das Rollen Framework anweisen, die Rollen Unterstützung zu aktivieren und die `SqlRoleProvider` mit der `SecurityTutorials.mdf` Datenbank als Rollen Speicher zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="75537-166">Therefore we just need to tell the Roles framework to enable role support and to use the `SqlRoleProvider` with the `SecurityTutorials.mdf` database as the role store.</span></span>

<span data-ttu-id="75537-167">Das Rollen Framework wird über das &lt;`roleManager`&gt;-Element in der `Web.config` Datei der Anwendung konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="75537-167">The Roles framework is configured via the &lt;`roleManager`&gt; element in the application's `Web.config` file.</span></span> <span data-ttu-id="75537-168">Standardmäßig ist die Rollen Unterstützung deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="75537-168">By default, role support is disabled.</span></span> <span data-ttu-id="75537-169">Um es zu aktivieren, müssen Sie das `enabled`-Attribut des [&lt;`roleManager`&gt;](https://msdn.microsoft.com/library/ms164660.aspx) Elements auf `true` wie folgt festlegen:</span><span class="sxs-lookup"><span data-stu-id="75537-169">To enable it, you must set the [&lt;`roleManager`&gt;](https://msdn.microsoft.com/library/ms164660.aspx) element's `enabled` attribute to `true` like so:</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample3.xml)]

<span data-ttu-id="75537-170">Standardmäßig verfügen alle Webanwendungen über einen Rollen Anbieter mit dem Namen `AspNetSqlRoleProvider` vom Typ `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="75537-170">By default, all web applications have a Roles provider named `AspNetSqlRoleProvider` of type `SqlRoleProvider`.</span></span> <span data-ttu-id="75537-171">Dieser Standardanbieter wird in `machine.config` (`%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`) registriert:</span><span class="sxs-lookup"><span data-stu-id="75537-171">This default provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample4.xml)]

<span data-ttu-id="75537-172">Das `connectionStringName`-Attribut des Anbieters gibt den verwendeten Rollen Speicher an.</span><span class="sxs-lookup"><span data-stu-id="75537-172">The provider's `connectionStringName` attribute specifies the role store that is used.</span></span> <span data-ttu-id="75537-173">Der `AspNetSqlRoleProvider`-Anbieter legt dieses Attribut auf `LocalSqlServer`fest, das auch in `machine.config` und Punkten standardmäßig auf eine SQL Server 2005 Express Edition Datenbank im `App_Data`-Ordner mit dem Namen `aspnet.mdf`festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="75537-173">The `AspNetSqlRoleProvider` provider sets this attribute to `LocalSqlServer`, which is also defined in `machine.config` and points, by default, to a SQL Server 2005 Express Edition database in the `App_Data` folder named `aspnet.mdf`.</span></span>

<span data-ttu-id="75537-174">Wenn wir das Rollen Framework einfach aktivieren, ohne Anbieter Informationen in der `Web.config` Datei der Anwendung anzugeben, verwendet die Anwendung daher den Standardanbieter für registrierte Rollen `AspNetSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="75537-174">Consequently, if we simply enable the Roles framework without specifying any provider information in our application's `Web.config` file, the application uses the default registered Roles provider, `AspNetSqlRoleProvider`.</span></span> <span data-ttu-id="75537-175">Wenn die `~/App_Data/aspnet.mdf` Datenbank nicht vorhanden ist, wird Sie von der ASP.NET-Laufzeit automatisch erstellt und das Anwendungs Dienst Schema hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="75537-175">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="75537-176">Wir möchten jedoch nicht die `aspnet.mdf` Datenbank verwenden. Stattdessen möchten wir die `SecurityTutorials.mdf` Datenbank verwenden, die wir bereits erstellt haben, und das Anwendungs Dienst Schema hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="75537-176">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database that we have already created and added the application services schema to.</span></span> <span data-ttu-id="75537-177">Diese Änderung kann auf zwei Arten durchgeführt werden:</span><span class="sxs-lookup"><span data-stu-id="75537-177">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="75537-178">Geben Sie in`Web.config`<strong>einen Wert für den Namen der</strong> <strong>`LocalSqlServer`</strong> <strong>Verbindungs Zeichenfolge an</strong> <strong>.</strong></span><span class="sxs-lookup"><span data-stu-id="75537-178"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="75537-179">Wenn Sie den Wert `LocalSqlServer` Verbindungs Zeichenfolgen-Name in `Web.config`überschreiben, können wir den Standardanbieter für registrierte Rollen (`AspNetSqlRoleProvider`) verwenden und ihn ordnungsgemäß mit der `SecurityTutorials.mdf` Datenbank arbeiten lassen.</span><span class="sxs-lookup"><span data-stu-id="75537-179">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Roles provider (`AspNetSqlRoleProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="75537-180">Weitere Informationen zu dieser Technik finden Sie im Blogbeitrag von [Scott Guthrie](https://weblogs.asp.net/scottgu/), [Konfigurieren von ASP.NET 2,0 Anwendungsdienste für die Verwendung von SQL Server 2000 oder SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span><span class="sxs-lookup"><span data-stu-id="75537-180">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="75537-181"><strong>Fügen Sie einen neuen registrierten Anbieter vom Typ</strong> <strong>`SqlRoleProvider`</strong>hinzu, <strong>und konfigurieren Sie seine</strong> <strong>`connectionStringName`</strong> <strong>Einstellungen so, dass er auf die</strong> <strong>`SecurityTutorials.mdf`</strong> <strong>Datenbank verweist.</strong></span><span class="sxs-lookup"><span data-stu-id="75537-181"><strong>Add a new registered provider of type</strong><strong>`SqlRoleProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="75537-182">Dies ist der empfohlene Ansatz, der im <a id="_msoanchor_7"> </a>Tutorial [*Erstellen des Mitgliedschafts Schemas in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) beschrieben und verwendet wird. Dies ist der Ansatz, den ich in diesem Tutorial verwenden werde.</span><span class="sxs-lookup"><span data-stu-id="75537-182">This is the approach I recommended and used in the <a id="_msoanchor_7"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-cs.md) tutorial, and it is the approach I will use in this tutorial as well.</span></span>

<span data-ttu-id="75537-183">Fügen Sie der `Web.config` Datei das folgende Rollen-Konfigurations Markup hinzu.</span><span class="sxs-lookup"><span data-stu-id="75537-183">Add the following Roles configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="75537-184">Dieses Markup registriert einen neuen Anbieter mit dem Namen `SecurityTutorialsSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="75537-184">This markup registers a new provider named `SecurityTutorialsSqlRoleProvider`.</span></span>

[!code-xml[Main](creating-and-managing-roles-cs/samples/sample5.xml)]

<span data-ttu-id="75537-185">Das obige Markup definiert die `SecurityTutorialsSqlRoleProvider` als Standardanbieter (über das `defaultProvider`-Attribut im `<roleManager>`-Element).</span><span class="sxs-lookup"><span data-stu-id="75537-185">The above markup defines the `SecurityTutorialsSqlRoleProvider` as the default provider (via the `defaultProvider` attribute in the `<roleManager>` element).</span></span> <span data-ttu-id="75537-186">Außerdem wird die `applicationName` Einstellung des `SecurityTutorialsSqlRoleProvider`auf `SecurityTutorials`festgelegt, wobei es sich um dieselbe `applicationName` Einstellung handelt, die vom Mitgliedschafts Anbieter (`SecurityTutorialsSqlMembershipProvider`) verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="75537-186">It also sets the `SecurityTutorialsSqlRoleProvider`'s `applicationName` setting to `SecurityTutorials`, which is the same `applicationName` setting used by the Membership provider (`SecurityTutorialsSqlMembershipProvider`).</span></span> <span data-ttu-id="75537-187">Obwohl es hier nicht gezeigt wird, kann das [`<add>`-Element](https://msdn.microsoft.com/library/ms164662.aspx) für die `SqlRoleProvider` auch ein `commandTimeout`-Attribut enthalten, um die Timeout Dauer der Datenbank in Sekunden anzugeben.</span><span class="sxs-lookup"><span data-stu-id="75537-187">While not shown here, the [`<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) for the `SqlRoleProvider` may also contain a `commandTimeout` attribute to specify the database timeout duration, in seconds.</span></span> <span data-ttu-id="75537-188">Der Standardwert ist 30.</span><span class="sxs-lookup"><span data-stu-id="75537-188">The default value is 30.</span></span>

<span data-ttu-id="75537-189">Wenn dieses Konfigurations Markup vorhanden ist, können wir mit der Verwendung von Rollen Funktionen in der Anwendung beginnen.</span><span class="sxs-lookup"><span data-stu-id="75537-189">With this configuration markup in place, we are ready to start using role functionality within our application.</span></span>

> [!NOTE]
> <span data-ttu-id="75537-190">Das obige Konfigurations Markup veranschaulicht die Verwendung der `enabled` und `defaultProvider` Attribute &lt;des &gt; Elements `roleManager`Elements.</span><span class="sxs-lookup"><span data-stu-id="75537-190">The above configuration markup illustrates using the &lt;`roleManager`&gt; element's `enabled` and `defaultProvider` attributes.</span></span> <span data-ttu-id="75537-191">Es gibt eine Reihe weiterer Attribute, die sich darauf auswirken, wie das Rollen Framework Rollen Informationen auf Benutzerbasis zuordnet.</span><span class="sxs-lookup"><span data-stu-id="75537-191">There are a number of other attributes that affect how the Roles framework associates role information on a user-by-user basis.</span></span> <span data-ttu-id="75537-192">Diese Einstellungen werden im Tutorial zur <a id="_msoanchor_8"> </a> [*rollenbasierten Autorisierung*](role-based-authorization-cs.md) untersucht.</span><span class="sxs-lookup"><span data-stu-id="75537-192">We will examine these settings in the <a id="_msoanchor_8"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial.</span></span>

## <a name="step-3-examining-the-roles-api"></a><span data-ttu-id="75537-193">Schritt 3: Untersuchen der Rollen-API</span><span class="sxs-lookup"><span data-stu-id="75537-193">Step 3: Examining the Roles API</span></span>

<span data-ttu-id="75537-194">Die Funktionalität des Rollen-Frameworks wird über die [`Roles`-Klasse](https://msdn.microsoft.com/library/system.web.security.roles.aspx)verfügbar gemacht, die 13 statische Methoden zum Ausführen von rollenbasierten Vorgängen enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-194">The Roles framework's functionality is exposed via the [`Roles` class](https://msdn.microsoft.com/library/system.web.security.roles.aspx), which contains thirteen static methods for performing role-based operations.</span></span> <span data-ttu-id="75537-195">Wenn wir uns das Erstellen und Löschen von Rollen in den Schritten 4 und 6 ansehen, werden die Methoden [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) und [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) verwendet, mit denen eine Rolle zum System hinzugefügt oder daraus entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-195">When we look at creating and deleting roles in Steps 4 and 6 we will use the [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) and [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) methods, which add or remove a role from the system.</span></span>

<span data-ttu-id="75537-196">Um eine Liste aller Rollen im System zu erhalten, verwenden Sie die`GetAllRoles`- [Methode](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (siehe Schritt 5).</span><span class="sxs-lookup"><span data-stu-id="75537-196">To get a list of all of the roles in the system, use the [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (see Step 5).</span></span> <span data-ttu-id="75537-197">Die [`RoleExists`-Methode](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) gibt einen booleschen Wert zurück, der angibt, ob eine angegebene Rolle vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="75537-197">The [`RoleExists` method](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) returns a Boolean value indicating whether a specified role exists.</span></span>

<span data-ttu-id="75537-198">Im nächsten Tutorial untersuchen wir, wie Benutzer Rollen zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="75537-198">In the next tutorial we will examine how to associate users with roles.</span></span> <span data-ttu-id="75537-199">Die Methoden [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx)und [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) der `Roles` Klasse fügen mindestens einer Rolle einen Benutzer hinzu.</span><span class="sxs-lookup"><span data-stu-id="75537-199">The `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), and [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) methods add one or more users to one or more roles.</span></span> <span data-ttu-id="75537-200">Wenn Sie Benutzer aus Rollen entfernen möchten, verwenden Sie die Methoden [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx)oder [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) .</span><span class="sxs-lookup"><span data-stu-id="75537-200">To remove users from roles, use the [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), or [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) methods.</span></span>

<span data-ttu-id="75537-201"><a id="_msoanchor_9"> </a>Im Tutorial zur [*rollenbasierten Autorisierung*](role-based-authorization-cs.md) betrachten wir die Möglichkeiten, die Funktionalität basierend auf der aktuell angemeldeten Benutzerrolle Programm gesteuert anzuzeigen oder auszublenden.</span><span class="sxs-lookup"><span data-stu-id="75537-201">In the <a id="_msoanchor_9"></a>[*Role-Based Authorization*](role-based-authorization-cs.md) tutorial we will look at ways to programmatically show or hide functionality based on the currently logged in user's role.</span></span> <span data-ttu-id="75537-202">Um dies zu erreichen, können wir die Methoden [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx)oder [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) der `Role` Klasse verwenden.</span><span class="sxs-lookup"><span data-stu-id="75537-202">To accomplish this, we can use the `Role` class's [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), or [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) methods.</span></span>

> [!NOTE]
> <span data-ttu-id="75537-203">Beachten Sie, dass die `Roles`-Klasse den Aufruf an den konfigurierten Anbieter delegiert, wenn eine dieser Methoden aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="75537-203">Keep in mind that any time one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="75537-204">In unserem Fall bedeutet dies, dass der-Rückruf an den `SqlRoleProvider`gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="75537-204">In our case, this means that the call is being sent to the `SqlRoleProvider`.</span></span> <span data-ttu-id="75537-205">Der `SqlRoleProvider` führt dann den entsprechenden Daten Bank Vorgang basierend auf der aufgerufenen Methode aus.</span><span class="sxs-lookup"><span data-stu-id="75537-205">The `SqlRoleProvider` then performs the appropriate database operation based on the invoked method.</span></span> <span data-ttu-id="75537-206">Beispielsweise führt der Code `Roles.CreateRole("Administrators")` dazu, dass die `SqlRoleProvider` die gespeicherte Prozedur `aspnet_Roles_CreateRole` ausführt, mit der ein neuer Datensatz in die `aspnet_Roles` Tabelle mit dem Namen "Administratoren" eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-206">For example, the code `Roles.CreateRole("Administrators")` results in the `SqlRoleProvider` executing the `aspnet_Roles_CreateRole` stored procedure, which inserts a new record into the `aspnet_Roles` table named Administrators .</span></span>

<span data-ttu-id="75537-207">Im restlichen Teil dieses Tutorials wird die Verwendung der Methoden `CreateRole`, `GetAllRoles`und `DeleteRole` der `Roles` Klasse zum Verwalten der Rollen im System untersucht.</span><span class="sxs-lookup"><span data-stu-id="75537-207">The remainder of this tutorial looks at using the `Roles` class's `CreateRole`, `GetAllRoles`, and `DeleteRole` methods to manage the roles in the system.</span></span>

## <a name="step-4-creating-new-roles"></a><span data-ttu-id="75537-208">Schritt 4: Erstellen neuer Rollen</span><span class="sxs-lookup"><span data-stu-id="75537-208">Step 4: Creating New Roles</span></span>

<span data-ttu-id="75537-209">Rollen bieten eine Möglichkeit zum willkürlichen Gruppieren von Benutzern, und in der Regel wird diese Gruppierung verwendet, um eine komfortablere Methode zum Anwenden von Autorisierungs Regeln zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="75537-209">Roles offer a way to arbitrarily group users, and most commonly this grouping is used for a more convenient way to apply authorization rules.</span></span> <span data-ttu-id="75537-210">Um jedoch Rollen als Autorisierungs Mechanismus verwenden zu können, müssen Sie zunächst definieren, welche Rollen in der Anwendung vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="75537-210">But in order to use roles as an authorization mechanism we first need to define what roles exist in the application.</span></span> <span data-ttu-id="75537-211">Leider enthält ASP.net kein "kreaterolewizard"-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="75537-211">Unfortunately, ASP.NET does not include a CreateRoleWizard control.</span></span> <span data-ttu-id="75537-212">Um neue Rollen hinzuzufügen, müssen wir eine passende Benutzeroberfläche erstellen und die Rollen-API selbst aufrufen.</span><span class="sxs-lookup"><span data-stu-id="75537-212">In order to add new roles we need to create a suitable user interface and invoke the Roles API ourselves.</span></span> <span data-ttu-id="75537-213">Die gute Nachricht ist, dass dies sehr einfach zu erreichen ist.</span><span class="sxs-lookup"><span data-stu-id="75537-213">The good news is that this is very easy to accomplish.</span></span>

> [!NOTE]
> <span data-ttu-id="75537-214">Es gibt zwar kein websteuer Element " [ASP.net Web Site Administration](https://msdn.microsoft.com/library/ms228053.aspx)", aber es gibt eine lokale ASP.NET-Anwendung, die die Anzeige und Verwaltung der Konfiguration Ihrer Webanwendung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="75537-214">While there is no CreateRoleWizard Web control, there is the [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), which is a local ASP.NET application designed to assist with viewing and managing your web application's configuration.</span></span> <span data-ttu-id="75537-215">Ich bin jedoch aus zwei Gründen kein großer Fan des ASP.NET-Websiteverwaltungs-Tools.</span><span class="sxs-lookup"><span data-stu-id="75537-215">However, I am not a big fan of the ASP.NET Web Site Administration Tool for two reasons.</span></span> <span data-ttu-id="75537-216">Erstens ist es ein wenig fehlerhaft, und die Benutzer Darstellung lässt sich sehr viel wünschen.</span><span class="sxs-lookup"><span data-stu-id="75537-216">First, it is a bit buggy and the user experience leaves a lot to be desired.</span></span> <span data-ttu-id="75537-217">Zweitens ist das ASP.NET-Websiteverwaltungs-Tool nur für die lokale Ausführung konzipiert. Dies bedeutet, dass Sie eigene Rollen Verwaltungs Webseiten erstellen müssen, wenn Sie Rollen auf einer Live Website remote verwalten müssen.</span><span class="sxs-lookup"><span data-stu-id="75537-217">Second, the ASP.NET Web Site Administration Tool is designed to only work locally, meaning that you will have to build your own role management web pages if you need to manage roles on a live site remotely.</span></span> <span data-ttu-id="75537-218">Aus diesen beiden Gründen konzentrieren sich dieses Lernprogramm und das nächste auf das Entwickeln der erforderlichen Rollen Verwaltungs Tools auf einer Webseite, anstatt sich auf das ASP.net Web Site Administration-Tool zu verlassen.</span><span class="sxs-lookup"><span data-stu-id="75537-218">For these two reasons, this tutorial and the next will focus on building the necessary role management tools in a web page rather than relying on the ASP.NET Web Site Administration Tool.</span></span>

<span data-ttu-id="75537-219">Öffnen Sie die Seite `ManageRoles.aspx` im Ordner `Roles`, und fügen Sie der Seite ein Textfeld und ein Schaltflächen-websteuer Element hinzu.</span><span class="sxs-lookup"><span data-stu-id="75537-219">Open the `ManageRoles.aspx` page in the `Roles` folder and add a TextBox and a Button Web control to the page.</span></span> <span data-ttu-id="75537-220">Legen Sie die `ID`-Eigenschaft des TextBox-Steuer Elements auf `RoleName` und die Eigenschaften `ID` und `Text` der Schaltfläche auf `CreateRoleButton` bzw. Create Role fest.</span><span class="sxs-lookup"><span data-stu-id="75537-220">Set the TextBox control's `ID` property to `RoleName` and the Button's `ID` and `Text` properties to `CreateRoleButton` and Create Role, respectively.</span></span> <span data-ttu-id="75537-221">An diesem Punkt sollte das deklarative Markup der Seite in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="75537-221">At this point, your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample6.aspx)]

<span data-ttu-id="75537-222">Doppelklicken Sie im Designer auf das Schaltflächen-Steuerelement `CreateRoleButton`, um einen `Click`-Ereignishandler zu erstellen, und fügen Sie dann den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="75537-222">Next, double-click the `CreateRoleButton` Button control in the Designer to create a `Click` event handler and then add the following code:</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample7.cs)]

<span data-ttu-id="75537-223">Der obige Code beginnt mit dem Zuweisen des im Textfeld `RoleName` eingegebenen gekürzten Rollen namens zur `newRoleName`-Variablen.</span><span class="sxs-lookup"><span data-stu-id="75537-223">The above code starts by assigning the trimmed role name entered in the `RoleName` TextBox to the `newRoleName` variable.</span></span> <span data-ttu-id="75537-224">Als nächstes wird die `RoleExists`-Methode der `Roles` Klasse aufgerufen, um zu bestimmen, ob die Rollen `newRoleName` bereits im System vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="75537-224">Next, the `Roles` class's `RoleExists` method is called to determine if the role `newRoleName` already exists in the system.</span></span> <span data-ttu-id="75537-225">Wenn die Rolle nicht vorhanden ist, wird Sie über einen aufzurufenden `CreateRole` Methode erstellt.</span><span class="sxs-lookup"><span data-stu-id="75537-225">If the role does not exist, it is created via a call to the `CreateRole` method.</span></span> <span data-ttu-id="75537-226">Wenn der `CreateRole`-Methode ein Rollenname übermittelt wird, der bereits im System vorhanden ist, wird eine `ProviderException` Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="75537-226">If the `CreateRole` method is passed a role name that already exists in the system, a `ProviderException` exception is thrown.</span></span> <span data-ttu-id="75537-227">Aus diesem Grund überprüft der Code zuerst, ob die Rolle noch nicht im System vorhanden ist, bevor `CreateRole`aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="75537-227">This is why the code first checks to ensure that the role does not already exist in the system before calling `CreateRole`.</span></span> <span data-ttu-id="75537-228">Der `Click` Ereignishandler schließt das Löschen der `Text`-Eigenschaft des `RoleName` Textfelds ab.</span><span class="sxs-lookup"><span data-stu-id="75537-228">The `Click` event handler concludes by clearing out the `RoleName` TextBox's `Text` property.</span></span>

> [!NOTE]
> <span data-ttu-id="75537-229">Sie Fragen sich vielleicht, was passieren wird, wenn der Benutzer keinen Wert in das Textfeld "`RoleName`" eingibt.</span><span class="sxs-lookup"><span data-stu-id="75537-229">You may be wondering what will happen if the user doesn't enter any value into the `RoleName` TextBox.</span></span> <span data-ttu-id="75537-230">Wenn der an die `CreateRole` Methode eingegebene Wert `null` oder eine leere Zeichenfolge ist, wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="75537-230">If the value passed into the `CreateRole` method is `null` or an empty string, an exception is raised.</span></span> <span data-ttu-id="75537-231">Ebenso wird eine Ausnahme ausgelöst, wenn der Rollenname ein Komma enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-231">Likewise, if the role name contains a comma an exception is raised.</span></span> <span data-ttu-id="75537-232">Folglich sollte die Seite Validierungs Steuerelemente enthalten, um sicherzustellen, dass der Benutzer eine Rolle eingibt und keine Kommas enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-232">Consequently, the page should contain validation controls to ensure that the user enters a role and that it does not contain any commas.</span></span> <span data-ttu-id="75537-233">Ich lasse als Übung für den Reader aus.</span><span class="sxs-lookup"><span data-stu-id="75537-233">I leave as an exercise for the reader.</span></span>

<span data-ttu-id="75537-234">Wir erstellen nun eine Rolle mit dem Namen "Administratoren".</span><span class="sxs-lookup"><span data-stu-id="75537-234">Let's create a role named Administrators.</span></span> <span data-ttu-id="75537-235">Besuchen Sie die Seite `ManageRoles.aspx` über einen Browser, geben Sie Administratoren in das Textfeld ein (siehe Abbildung 3), und klicken Sie dann auf die Schaltfläche Rolle erstellen.</span><span class="sxs-lookup"><span data-stu-id="75537-235">Visit the `ManageRoles.aspx` page through a browser, type in Administrators into the textbox (see Figure 3), and then click the Create Role button.</span></span>

<span data-ttu-id="75537-236">[![Erstellen einer Administrator Rolle](creating-and-managing-roles-cs/_static/image8.png)](creating-and-managing-roles-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="75537-236">[![Create an Administrators Role](creating-and-managing-roles-cs/_static/image8.png)](creating-and-managing-roles-cs/_static/image7.png)</span></span>

<span data-ttu-id="75537-237">**Abbildung 3**: Erstellen einer Administrator Rolle ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="75537-237">**Figure 3**: Create an Administrators Role  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image9.png))</span></span>

<span data-ttu-id="75537-238">Was ist los?</span><span class="sxs-lookup"><span data-stu-id="75537-238">What happens?</span></span> <span data-ttu-id="75537-239">Ein Postback tritt auf, aber es gibt keinen visuellen Hinweis darauf, dass die Rolle tatsächlich dem System hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="75537-239">A postback occurs, but there's no visual cue that the role has actually been added to the system.</span></span> <span data-ttu-id="75537-240">Wir werden diese Seite in Schritt 5 aktualisieren, um visuelles Feedback einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="75537-240">We will update this page in Step 5 to include visual feedback.</span></span> <span data-ttu-id="75537-241">Derzeit können Sie jedoch überprüfen, ob die Rolle erstellt wurde, indem Sie die `SecurityTutorials.mdf` Datenbank aufrufen und die Daten aus der `aspnet_Roles` Tabelle anzeigen.</span><span class="sxs-lookup"><span data-stu-id="75537-241">For now, however, you can verify that the role was created by going to the `SecurityTutorials.mdf` database and displaying the data from the `aspnet_Roles` table.</span></span> <span data-ttu-id="75537-242">Wie in Abbildung 4 gezeigt, enthält die `aspnet_Roles` Tabelle einen Datensatz für die soeben hinzugefügten Administratoren Rollen.</span><span class="sxs-lookup"><span data-stu-id="75537-242">As Figure 4 shows, the `aspnet_Roles` table contains a record for the just-added Administrators roles.</span></span>

<span data-ttu-id="75537-243">[![die aspnet_Roles Tabelle eine Zeile für die Administratoren enthält.](creating-and-managing-roles-cs/_static/image11.png)](creating-and-managing-roles-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="75537-243">[![The aspnet_Roles Table has a Row for the Administrators](creating-and-managing-roles-cs/_static/image11.png)](creating-and-managing-roles-cs/_static/image10.png)</span></span>

<span data-ttu-id="75537-244">**Abbildung 4**: die `aspnet_Roles` Tabelle enthält eine Zeile für die Administratoren ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="75537-244">**Figure 4**: The `aspnet_Roles` Table has a Row for the Administrators  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image12.png))</span></span>

## <a name="step-5-displaying-the-roles-in-the-system"></a><span data-ttu-id="75537-245">Schritt 5: Anzeigen der Rollen im System</span><span class="sxs-lookup"><span data-stu-id="75537-245">Step 5: Displaying the Roles in the System</span></span>

<span data-ttu-id="75537-246">Erweitern Sie nun die Seite "`ManageRoles.aspx`", um eine Liste der aktuellen Rollen im System einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="75537-246">Let's augment the `ManageRoles.aspx` page to include a list of the current roles in the system.</span></span> <span data-ttu-id="75537-247">Fügen Sie hierzu der Seite ein GridView-Steuerelement hinzu, und legen Sie dessen `ID`-Eigenschaft auf `RoleList`fest.</span><span class="sxs-lookup"><span data-stu-id="75537-247">To accomplish this, add a GridView control to the page and set its `ID` property to `RoleList`.</span></span> <span data-ttu-id="75537-248">Fügen Sie als nächstes der Code Behind-Klasse der Seite mit dem Namen `DisplayRolesInGrid` eine Methode mit dem folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="75537-248">Next, add a method to the page's code-behind class named `DisplayRolesInGrid` using the following code:</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample8.cs)]

<span data-ttu-id="75537-249">Die `GetAllRoles`-Methode der `Roles` Klasse gibt alle Rollen im System als Array von Zeichen folgen zurück.</span><span class="sxs-lookup"><span data-stu-id="75537-249">The `Roles` class's `GetAllRoles` method returns all of the roles in the system as an array of strings.</span></span> <span data-ttu-id="75537-250">Dieses Zeichen folgen Array wird dann an die GridView gebunden.</span><span class="sxs-lookup"><span data-stu-id="75537-250">This string array is then bound to the GridView.</span></span> <span data-ttu-id="75537-251">Um die Liste der Rollen an die GridView zu binden, wenn die Seite zum ersten Mal geladen wird, müssen wir die `DisplayRolesInGrid`-Methode aus dem `Page_Load`-Ereignishandler der Seite aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="75537-251">In order to bind the list of roles to the GridView when the page is first loaded, we need to call the `DisplayRolesInGrid` method from the page's `Page_Load` event handler.</span></span> <span data-ttu-id="75537-252">Mit dem folgenden Code wird diese Methode aufgerufen, wenn die Seite zum ersten Mal aufgerufen wird, jedoch nicht bei nachfolgenden Postbacks.</span><span class="sxs-lookup"><span data-stu-id="75537-252">The following code calls this method when the page is first visited, but not on subsequent postbacks.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample9.cs)]

<span data-ttu-id="75537-253">Wenn dieser Code vorhanden ist, besuchen Sie die Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="75537-253">With this code in place, visit the page through a browser.</span></span> <span data-ttu-id="75537-254">Wie in Abbildung 5 gezeigt, sollte ein Raster mit einer einzelnen Spalte mit der Bezeichnung Item angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="75537-254">As Figure 5 shows, you should see a grid with a single column labeled Item.</span></span> <span data-ttu-id="75537-255">Das Raster enthält eine Zeile für die in Schritt 4 hinzugefügte Administrator Rolle.</span><span class="sxs-lookup"><span data-stu-id="75537-255">The grid includes a row for the Administrators role we added in Step 4.</span></span>

<span data-ttu-id="75537-256">[![in der GridView die Rollen in einer einzelnen Spalte angezeigt werden.](creating-and-managing-roles-cs/_static/image14.png)](creating-and-managing-roles-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="75537-256">[![The GridView Displays the Roles in a Single Column](creating-and-managing-roles-cs/_static/image14.png)](creating-and-managing-roles-cs/_static/image13.png)</span></span>

<span data-ttu-id="75537-257">**Abbildung 5**: die GridView zeigt die Rollen in einer einzelnen Spalte an ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="75537-257">**Figure 5**: The GridView Displays the Roles in a Single Column  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image15.png))</span></span>

<span data-ttu-id="75537-258">In der GridView wird eine einzelne Spalte mit der Bezeichnung Item angezeigt, da die `AutoGenerateColumns`-Eigenschaft der GridView auf true festgelegt ist (Standardeinstellung). dadurch erstellt die GridView automatisch eine Spalte für jede Eigenschaft in der `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="75537-258">The GridView displays a lone column labeled Item because the GridView's `AutoGenerateColumns` property is set to True (the default), which causes the GridView to automatically create a column for each property in its `DataSource`.</span></span> <span data-ttu-id="75537-259">Ein Array verfügt über eine einzelne Eigenschaft, die die Elemente im Array darstellt, daher die einzelne Spalte in der GridView.</span><span class="sxs-lookup"><span data-stu-id="75537-259">An array has a single property that represents the elements in the array, hence the single column in the GridView.</span></span>

<span data-ttu-id="75537-260">Beim Anzeigen von Daten mit einer GridView-Sicht empfiehlt es sich, meine Spalten explizit zu definieren, anstatt Sie implizit von der GridView generieren zu lassen.</span><span class="sxs-lookup"><span data-stu-id="75537-260">When displaying data with a GridView, I prefer to explicitly define my columns rather than have them implicitly generated by the GridView.</span></span> <span data-ttu-id="75537-261">Durch das explizite Definieren der Spalten ist es viel einfacher, die Daten zu formatieren, die Spalten neu anzuordnen und andere häufige Aufgaben auszuführen.</span><span class="sxs-lookup"><span data-stu-id="75537-261">By explicitly defining the columns it is much easier to format the data, rearrange the columns, and perform other common tasks.</span></span> <span data-ttu-id="75537-262">Daher aktualisieren wir das deklarative Markup der GridView, damit seine Spalten explizit definiert werden.</span><span class="sxs-lookup"><span data-stu-id="75537-262">Therefore, let's update the GridView's declarative markup so that its columns are explicitly defined.</span></span>

<span data-ttu-id="75537-263">Legen Sie zunächst die `AutoGenerateColumns`-Eigenschaft der GridView auf false fest.</span><span class="sxs-lookup"><span data-stu-id="75537-263">Start by setting the GridView's `AutoGenerateColumns` property to False.</span></span> <span data-ttu-id="75537-264">Fügen Sie als nächstes ein TemplateField zum Raster hinzu, legen Sie dessen `HeaderText`-Eigenschaft auf Rollen fest, und konfigurieren Sie die `ItemTemplate`, sodass der Inhalt des Arrays angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-264">Next, add a TemplateField to the grid, set its `HeaderText` property to Roles, and configure its `ItemTemplate` so that it displays the contents of the array.</span></span> <span data-ttu-id="75537-265">Fügen Sie zu diesem Zweck dem `ItemTemplate` ein Label-websteuer Element mit dem Namen `RoleNameLabel` hinzu, und binden Sie dessen `Text`-Eigenschaft an `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="75537-265">To accomplish this, add a Label Web control named `RoleNameLabel` to the `ItemTemplate` and bind its `Text` property to `Container.DataItem`.</span></span>

<span data-ttu-id="75537-266">Diese Eigenschaften und die Inhalte der `ItemTemplate`können deklarativ oder über das Dialogfeld Felder von GridView und Vorlagen bearbeiten festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="75537-266">These properties and the `ItemTemplate`'s contents can be set declaratively or through the GridView's Fields dialog box and Edit Templates interface.</span></span> <span data-ttu-id="75537-267">Um das Dialogfeld Felder zu erreichen, klicken Sie auf den Link Spalten bearbeiten im Smarttags von GridView.</span><span class="sxs-lookup"><span data-stu-id="75537-267">To reach the Fields dialog box, click the Edit Columns link in the GridView's Smart Tag.</span></span> <span data-ttu-id="75537-268">Deaktivieren Sie als nächstes das Kontrollkästchen Felder automatisch generieren, um die `AutoGenerateColumns`-Eigenschaft auf false festzulegen, und fügen Sie der GridView ein TemplateField-Objekt hinzu, und legen Sie dessen `HeaderText`-Eigenschaft auf Role fest.</span><span class="sxs-lookup"><span data-stu-id="75537-268">Next, uncheck the Auto-generate fields checkbox to set the `AutoGenerateColumns` property to False, and add a TemplateField to the GridView, setting its `HeaderText` property to Role.</span></span> <span data-ttu-id="75537-269">Um den Inhalt der `ItemTemplate`zu definieren, wählen Sie die Option Vorlagen bearbeiten im Smarttags von GridView aus.</span><span class="sxs-lookup"><span data-stu-id="75537-269">To define the `ItemTemplate`'s contents, choose the Edit Templates option from the GridView's Smart Tag.</span></span> <span data-ttu-id="75537-270">Ziehen Sie ein Label-websteuer Element auf die `ItemTemplate`, legen Sie dessen `ID`-Eigenschaft auf `RoleNameLabel`fest, und konfigurieren Sie die zugehörigen Datenbindung-Einstellungen so, dass die `Text`-Eigenschaft an `Container.DataItem`gebunden ist.</span><span class="sxs-lookup"><span data-stu-id="75537-270">Drag a Label Web control onto the `ItemTemplate`, set its `ID` property to `RoleNameLabel`, and configure its databinding settings so that its `Text` property is bound to `Container.DataItem`.</span></span>

<span data-ttu-id="75537-271">Unabhängig davon, welchen Ansatz Sie verwenden, sollte das resultierende deklarative Markup der GridView in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="75537-271">Regardless of what approach you use, the GridView's resulting declarative markup should look similar to the following when you are done.</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample10.aspx)]

> [!NOTE]
> <span data-ttu-id="75537-272">Der Inhalt des Arrays wird mithilfe der Datenbindung-Syntax `<%# Container.DataItem %>`angezeigt.</span><span class="sxs-lookup"><span data-stu-id="75537-272">The array's contents are displayed using the databinding syntax `<%# Container.DataItem %>`.</span></span> <span data-ttu-id="75537-273">Eine ausführliche Beschreibung, warum diese Syntax verwendet wird, wenn der Inhalt eines Arrays, das an die GridView gebunden ist, angezeigt wird, geht über den Rahmen dieses Tutorials hinaus.</span><span class="sxs-lookup"><span data-stu-id="75537-273">A thorough description of why this syntax is used when displaying the contents of an array bound to the GridView is beyond the scope of this tutorial.</span></span> <span data-ttu-id="75537-274">Weitere Informationen zu diesem Thema finden Sie unter [Binden eines skalaren Arrays an ein datenweb-Steuer](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx)Element.</span><span class="sxs-lookup"><span data-stu-id="75537-274">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="75537-275">Derzeit wird das `RoleList` GridView nur an die Liste der Rollen gebunden, wenn die Seite zum ersten Mal besucht wird.</span><span class="sxs-lookup"><span data-stu-id="75537-275">Currently, the `RoleList` GridView is only bound to the list of roles when the page is first visited.</span></span> <span data-ttu-id="75537-276">Das Raster muss immer dann aktualisiert werden, wenn eine neue Rolle hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-276">We need to refresh the grid whenever a new role is added.</span></span> <span data-ttu-id="75537-277">Um dies zu erreichen, aktualisieren Sie den `Click`-Ereignishandler der `CreateRoleButton` Schaltfläche, damit die `DisplayRolesInGrid`-Methode aufgerufen wird, wenn eine neue Rolle erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-277">To accomplish this, update the `CreateRoleButton` Button's `Click` event handler so that it calls the `DisplayRolesInGrid` method if a new role is created.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample11.cs)]

<span data-ttu-id="75537-278">Wenn der Benutzer nun eine neue Rolle hinzufügt, zeigt der `RoleList` GridView die soeben hinzugefügte Rolle beim Postback an und bietet visuelles Feedback, dass die Rolle erfolgreich erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="75537-278">Now when the user adds a new role the `RoleList` GridView shows the just-added role on postback, providing visual feedback that the role was successfully created.</span></span> <span data-ttu-id="75537-279">Um dies zu veranschaulichen, besuchen Sie die Seite `ManageRoles.aspx` über einen Browser, und fügen Sie eine Rolle mit dem Namen Supervisor hinzu.</span><span class="sxs-lookup"><span data-stu-id="75537-279">To illustrate this, visit the `ManageRoles.aspx` page through a browser and add a role named Supervisors.</span></span> <span data-ttu-id="75537-280">Wenn Sie auf die Schaltfläche Rolle erstellen klicken, wird ein Postback durchführt, und das Raster wird aktualisiert, um sowohl Administratoren als auch die neue Rolle, Supervisor, einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="75537-280">Upon clicking the Create Role button, a postback will ensue and the grid will update to include Administrators as well as the new role, Supervisors.</span></span>

<span data-ttu-id="75537-281">[![die Rolle "Supervisoren" wurde hinzugefügt.](creating-and-managing-roles-cs/_static/image17.png)](creating-and-managing-roles-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="75537-281">[![The Supervisors Role has Been Added](creating-and-managing-roles-cs/_static/image17.png)](creating-and-managing-roles-cs/_static/image16.png)</span></span>

<span data-ttu-id="75537-282">**Abbildung 6**: die Rolle "Supervisoren" wurde hinzugefügt ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="75537-282">**Figure 6**: The Supervisors Role has Been Added  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image18.png))</span></span>

## <a name="step-6-deleting-roles"></a><span data-ttu-id="75537-283">Schritt 6: Löschen von Rollen</span><span class="sxs-lookup"><span data-stu-id="75537-283">Step 6: Deleting Roles</span></span>

<span data-ttu-id="75537-284">An diesem Punkt kann ein Benutzer eine neue Rolle erstellen und alle vorhandenen Rollen auf der Seite `ManageRoles.aspx` anzeigen.</span><span class="sxs-lookup"><span data-stu-id="75537-284">At this point a user can create a new role and view all existing roles from the `ManageRoles.aspx` page.</span></span> <span data-ttu-id="75537-285">Gestatten Sie Benutzern, auch Rollen zu löschen.</span><span class="sxs-lookup"><span data-stu-id="75537-285">Let's allow users to also delete roles.</span></span> <span data-ttu-id="75537-286">Die `Roles.DeleteRole`-Methode verfügt über zwei über Ladungen:</span><span class="sxs-lookup"><span data-stu-id="75537-286">The `Roles.DeleteRole` method has two overloads:</span></span>

- <span data-ttu-id="75537-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) : Löscht die Rolle *roleName*.</span><span class="sxs-lookup"><span data-stu-id="75537-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="75537-288">Eine Ausnahme wird ausgelöst, wenn die Rolle mindestens ein Element enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-288">An exception is thrown if the role contains one or more members.</span></span>
- <span data-ttu-id="75537-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) : Löscht die Rolle *roleName*.</span><span class="sxs-lookup"><span data-stu-id="75537-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="75537-290">Wenn *throwonpopulaterole* `true`ist, wird eine Ausnahme ausgelöst, wenn die Rolle mindestens ein Element enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-290">If *throwOnPopulateRole* is `true`, then an exception is thrown if the role contains one or more members.</span></span> <span data-ttu-id="75537-291">Wenn *throwonpopulaterole* `false`ist, wird die Rolle gelöscht, unabhängig davon, ob Sie Elemente enthält oder nicht.</span><span class="sxs-lookup"><span data-stu-id="75537-291">If *throwOnPopulateRole* is `false`, then the role is deleted whether it contains any members or not.</span></span> <span data-ttu-id="75537-292">Intern ruft die `DeleteRole(roleName)`-Methode `DeleteRole(roleName, true)`auf.</span><span class="sxs-lookup"><span data-stu-id="75537-292">Internally, the `DeleteRole(roleName)` method calls `DeleteRole(roleName, true)`.</span></span>

<span data-ttu-id="75537-293">Die `DeleteRole`-Methode löst auch eine Ausnahme aus, wenn *roleName* `null` oder eine leere Zeichenfolge ist oder wenn *roleName* ein Komma enthält.</span><span class="sxs-lookup"><span data-stu-id="75537-293">The `DeleteRole` method will also throw an exception if *roleName* is `null` or an empty string or if *roleName* contains a comma.</span></span> <span data-ttu-id="75537-294">Wenn *roleName* nicht im System vorhanden ist, wird `DeleteRole` im Hintergrund fehlschlagen, ohne dass eine Ausnahme ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="75537-294">If *roleName* does not exist in the system, `DeleteRole` fails silently, without raising an exception.</span></span>

<span data-ttu-id="75537-295">Erweitern Sie nun die GridView in `ManageRoles.aspx`, um eine Schaltfläche "Löschen" einzuschließen, mit der die ausgewählte Rolle gelöscht wird, wenn darauf geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-295">Let's augment the GridView in `ManageRoles.aspx` to include a Delete button that, when clicked, deletes the selected role.</span></span> <span data-ttu-id="75537-296">Fügen Sie der GridView zunächst eine Lösch Schaltfläche hinzu, indem Sie zum Dialogfeld Felder navigieren und eine DELETE-Schaltfläche hinzufügen, die sich unter der CommandField-Option befindet.</span><span class="sxs-lookup"><span data-stu-id="75537-296">Start by adding a Delete button to the GridView by going to the Fields dialog box and adding a Delete button, which is located under the CommandField option.</span></span> <span data-ttu-id="75537-297">Erstellen Sie die Schaltfläche Löschen in der Spalte ganz links, und legen Sie die `DeleteText`-Eigenschaft auf Rolle löschen fest.</span><span class="sxs-lookup"><span data-stu-id="75537-297">Make the Delete button the far left column and set its `DeleteText` property to Delete Role .</span></span>

<span data-ttu-id="75537-298">[![der rolelist-GridView eine Lösch Schaltfläche Hinzufügen](creating-and-managing-roles-cs/_static/image20.png)](creating-and-managing-roles-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="75537-298">[![Add a Delete Button to the RoleList GridView](creating-and-managing-roles-cs/_static/image20.png)](creating-and-managing-roles-cs/_static/image19.png)</span></span>

<span data-ttu-id="75537-299">**Abbildung 7**: Hinzufügen einer Lösch Schaltfläche zur `RoleList` GridView ([Klicken Sie, um das Bild in voller Größe anzuzeigen](creating-and-managing-roles-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="75537-299">**Figure 7**: Add a Delete Button to the `RoleList` GridView  ([Click to view full-size image](creating-and-managing-roles-cs/_static/image21.png))</span></span>

<span data-ttu-id="75537-300">Nach dem Hinzufügen der Schaltfläche Löschen sollte das deklarative Markup Ihrer GridView in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="75537-300">After adding the Delete button, your GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-cs/samples/sample12.aspx)]

<span data-ttu-id="75537-301">Erstellen Sie als nächstes einen Ereignishandler für das `RowDeleting` Ereignis der GridView.</span><span class="sxs-lookup"><span data-stu-id="75537-301">Next, create an event handler for the GridView's `RowDeleting` event.</span></span> <span data-ttu-id="75537-302">Dies ist das Ereignis, das beim Postback ausgelöst wird, wenn auf die Schaltfläche "Rolle löschen" geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-302">This is the event that is raised on postback when the Delete Role button is clicked.</span></span> <span data-ttu-id="75537-303">Fügen Sie dem Ereignishandler folgenden Code hinzu.</span><span class="sxs-lookup"><span data-stu-id="75537-303">Add the following code to the event handler.</span></span>

[!code-csharp[Main](creating-and-managing-roles-cs/samples/sample13.cs)]

<span data-ttu-id="75537-304">Der Code beginnt mit einem programmgesteuerten Verweis auf das `RoleNameLabel`-websteuer Element in der Zeile, auf deren Schaltfläche "Rolle löschen" geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="75537-304">The code starts by programmatically referencing the `RoleNameLabel` Web control in the row whose Delete Role button was clicked.</span></span> <span data-ttu-id="75537-305">Anschließend wird die `Roles.DeleteRole`-Methode aufgerufen, die die `Text` der `RoleNameLabel` und `false`übergibt und dadurch die Rolle löscht, unabhängig davon, ob Benutzer der Rolle zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="75537-305">The `Roles.DeleteRole` method is then invoked, passing in the `Text` of the `RoleNameLabel` and `false`, thereby deleting the role regardless of whether there are any users associated with the role.</span></span> <span data-ttu-id="75537-306">Zum Schluss wird die `RoleList` GridView aktualisiert, sodass die soeben gelöschte Rolle nicht mehr im Raster angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="75537-306">Finally, the `RoleList` GridView is refreshed so that the just-deleted role no longer appears in the grid.</span></span>

> [!NOTE]
> <span data-ttu-id="75537-307">Die Schaltfläche Rolle löschen erfordert keine Bestätigung vom Benutzer, bevor die Rolle gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="75537-307">The Delete Role button does not require any sort of confirmation from the user before deleting the role.</span></span> <span data-ttu-id="75537-308">Eine der einfachsten Möglichkeiten, eine Aktion zu bestätigen, ist das Dialogfeld Client seitiges bestätigen.</span><span class="sxs-lookup"><span data-stu-id="75537-308">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="75537-309">Weitere Informationen zu dieser Technik finden Sie unter [Hinzufügen der Client seitigen Bestätigung beim Löschen](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span><span class="sxs-lookup"><span data-stu-id="75537-309">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-cs.aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="75537-310">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="75537-310">Summary</span></span>

<span data-ttu-id="75537-311">Viele Webanwendungen verfügen über bestimmte Autorisierungs Regeln oder Funktionen auf Seitenebene, die nur für bestimmte Benutzer Klassen verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="75537-311">Many web applications have certain authorization rules or page-level functionality that is only available to certain classes of users.</span></span> <span data-ttu-id="75537-312">Beispielsweise kann eine Gruppe von Webseiten vorhanden sein, auf die nur Administratoren zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="75537-312">For example, there may be a set of web pages that only administrators can access.</span></span> <span data-ttu-id="75537-313">Anstatt diese Autorisierungs Regeln auf Benutzerbasis zu definieren, empfiehlt es sich, die Regeln basierend auf einer Rolle zu definieren.</span><span class="sxs-lookup"><span data-stu-id="75537-313">Rather than defining these authorization rules on a user-by-user basis, oftentimes it is more useful to define the rules based on a role.</span></span> <span data-ttu-id="75537-314">Das heißt, dass Benutzer Scott und jisun nicht explizit auf die administrativen Webseiten zugreifen können. ein besser verwaltbarerer Ansatz besteht darin, Mitgliedern der Administrator Rolle den Zugriff auf diese Seiten zu gestatten und dann Scott und jisun als Benutzer anzugeben, die zum Administrator Rolle.</span><span class="sxs-lookup"><span data-stu-id="75537-314">That is, rather than explicitly allowing users Scott and Jisun to access the administrative web pages, a more maintainable approach is to permit members of the Administrators role to access these pages, and then to denote Scott and Jisun as users belonging to the Administrators role.</span></span>

<span data-ttu-id="75537-315">Das Rollen Framework erleichtert das Erstellen und Verwalten von Rollen.</span><span class="sxs-lookup"><span data-stu-id="75537-315">The Roles framework makes it easy to create and manage roles.</span></span> <span data-ttu-id="75537-316">In diesem Tutorial wurde die Konfiguration des Rollen-Frameworks für die Verwendung der `SqlRoleProvider`erläutert, die eine Microsoft SQL Server-Datenbank als Rollen Speicher verwendet.</span><span class="sxs-lookup"><span data-stu-id="75537-316">In this tutorial we examined how to configure the Roles framework to use the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span> <span data-ttu-id="75537-317">Wir haben auch eine Webseite erstellt, auf der die vorhandenen Rollen im System aufgelistet sind und die das Erstellen neuer Rollen und das Löschen vorhandener Rollen ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="75537-317">We also created a web page that lists the existing roles in the system and allows for new roles to be created and existing ones to be deleted.</span></span> <span data-ttu-id="75537-318">In den nachfolgenden Tutorials erfahren Sie, wie Sie Benutzern Rollen zuweisen und wie Sie die rollenbasierte Autorisierung anwenden.</span><span class="sxs-lookup"><span data-stu-id="75537-318">In subsequent tutorials we will see how to assign users to roles and how to apply role-based authorization.</span></span>

<span data-ttu-id="75537-319">Fröhliche Programmierung!</span><span class="sxs-lookup"><span data-stu-id="75537-319">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="75537-320">Weitere nützliche Informationen</span><span class="sxs-lookup"><span data-stu-id="75537-320">Further Reading</span></span>

<span data-ttu-id="75537-321">Weitere Informationen zu den in diesem Tutorial behandelten Themen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="75537-321">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="75537-322">Überprüfen der Mitgliedschaft, Rollen und Profile von ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="75537-322">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="75537-323">Vorgehensweise: Verwenden des Rollen-Managers in ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="75537-323">How To: Use Role Manager in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998314.aspx)
- [<span data-ttu-id="75537-324">Rollen Anbieter</span><span class="sxs-lookup"><span data-stu-id="75537-324">Role Providers</span></span>](https://msdn.microsoft.com/library/aa478950.aspx)
- [<span data-ttu-id="75537-325">Ein eigenes Websiteverwaltungs-Tool</span><span class="sxs-lookup"><span data-stu-id="75537-325">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="75537-326">Technische Dokumentation für das `<roleManager>`-Element</span><span class="sxs-lookup"><span data-stu-id="75537-326">Technical documentation for the `<roleManager>` Element</span></span>](https://msdn.microsoft.com/library/ms164660.aspx)
- [<span data-ttu-id="75537-327">Verwenden der Mitgliedschafts-und Rollen-Manager-APIs</span><span class="sxs-lookup"><span data-stu-id="75537-327">Using the Membership and Role Manager APIs</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx)

### <a name="about-the-author"></a><span data-ttu-id="75537-328">Zum Autor</span><span class="sxs-lookup"><span data-stu-id="75537-328">About the Author</span></span>

<span data-ttu-id="75537-329">Scott Mitchell, Autor mehrerer ASP/ASP. net-Bücher und Gründer von 4GuysFromRolla.com, hat seit 1998 mit Microsoft-Webtechnologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="75537-329">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="75537-330">Scott arbeitet als unabhängiger Berater, Ausbilder und Writer.</span><span class="sxs-lookup"><span data-stu-id="75537-330">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="75537-331">Sein letztes Buch ist *[Sams Teach Yourself ASP.NET 2,0 in 24 Stunden](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="75537-331">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="75537-332">Scott kann über [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/)erreicht werden.</span><span class="sxs-lookup"><span data-stu-id="75537-332">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="75537-333">Besonders vielen Dank</span><span class="sxs-lookup"><span data-stu-id="75537-333">Special Thanks To</span></span>

<span data-ttu-id="75537-334">Diese tutorialreihe wurde von vielen hilfreichen Reviewern geprüft.</span><span class="sxs-lookup"><span data-stu-id="75537-334">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="75537-335">Zu den führenden Reviewern für dieses Tutorial zählen Alicja Maziarz, Suchi Banerjee und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="75537-335">Lead reviewers for this tutorial include Alicja Maziarz, Suchi Banerjee, and Teresa Murphy.</span></span> <span data-ttu-id="75537-336">Möchten Sie meine bevorstehenden MSDN-Artikel überprüfen?</span><span class="sxs-lookup"><span data-stu-id="75537-336">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="75537-337">Wenn dies der Fall ist, löschen Sie eine Zeile bei [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="75537-337">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="75537-338">Weiter</span><span class="sxs-lookup"><span data-stu-id="75537-338">Next</span></span>](assigning-roles-to-users-cs.md)
