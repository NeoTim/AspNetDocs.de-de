---
uid: web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
title: Erstellen einer sicheren ASP.net-Web Forms-App mit Benutzerregistrierung, e-Mail-C#Bestätigung und Kenn Wort Zurücksetzung () | Microsoft-Dokumentation
author: Erikre
description: In diesem Tutorial wird gezeigt, wie Sie eine ASP.net Web Forms-App mit Benutzerregistrierung, e-Mail-Bestätigung und Kenn Wort Zurücksetzung mit dem ASP.net Identity Mitglied erstellen...
ms.author: riande
ms.date: 10/02/2014
ms.assetid: 0a8d6044-5fab-4213-82d6-5618d5601358
msc.legacyurl: /web-forms/overview/security/create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset
msc.type: authoredcontent
ms.openlocfilehash: af3653bc164810126bc3bf8f1b1794d75642d807
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78507129"
---
# <a name="create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset-c"></a><span data-ttu-id="e43cf-103">Erstellen einer sicheren ASP.NET Web Forms-App mit Benutzerregistrierung, E-Mail-Bestätigung und Kennwortzurücksetzung (C#)</span><span class="sxs-lookup"><span data-stu-id="e43cf-103">Create a secure ASP.NET Web Forms app with user registration, email confirmation and password reset (C#)</span></span>

<span data-ttu-id="e43cf-104">von [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="e43cf-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

> <span data-ttu-id="e43cf-105">In diesem Tutorial wird gezeigt, wie Sie eine ASP.net Web Forms-App mit Benutzerregistrierung, e-Mail-Bestätigung und Kenn Wort Zurücksetzung mithilfe des ASP.net Identity Mitgliedschafts Systems erstellen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-105">This tutorial shows you how to build an ASP.NET Web Forms app with user registration, email confirmation and password reset using the ASP.NET Identity membership system.</span></span> <span data-ttu-id="e43cf-106">Dieses Tutorial basiert auf dem [MVC-Tutorial](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md)von Rick Anderson.</span><span class="sxs-lookup"><span data-stu-id="e43cf-106">This tutorial was based on Rick Anderson's [MVC tutorial](../../../mvc/overview/security/create-an-aspnet-mvc-5-web-app-with-email-confirmation-and-password-reset.md).</span></span>

## <a name="introduction"></a><span data-ttu-id="e43cf-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="e43cf-107">Introduction</span></span>

<span data-ttu-id="e43cf-108">Dieses Tutorial führt Sie durch die erforderlichen Schritte zum Erstellen einer ASP.net-Web Forms Anwendung mithilfe von Visual Studio und ASP.NET 4,5 zum Erstellen einer sicheren Web Forms-App mit Benutzerregistrierung, e-Mail-Bestätigung und Kenn Wort Zurücksetzung.</span><span class="sxs-lookup"><span data-stu-id="e43cf-108">This tutorial guides you through the steps required to create an ASP.NET Web Forms application using Visual Studio and ASP.NET 4.5 to create a secure Web Forms app with user registration, email confirmation and password reset.</span></span>

### <a name="tutorial-tasks-and-information"></a><span data-ttu-id="e43cf-109">Lernprogramm Aufgaben und-Informationen:</span><span class="sxs-lookup"><span data-stu-id="e43cf-109">Tutorial Tasks and Information:</span></span>

- [<span data-ttu-id="e43cf-110">Erstellen einer ASP.net-Web Forms-App</span><span class="sxs-lookup"><span data-stu-id="e43cf-110">Create an ASP.NET Web Forms app</span></span>](#createWebForms)
- [<span data-ttu-id="e43cf-111">Sendgrid anschließen</span><span class="sxs-lookup"><span data-stu-id="e43cf-111">Hook Up SendGrid</span></span>](#SG)
- [<span data-ttu-id="e43cf-112">E-Mail-Bestätigung vor der Anmeldung erforderlich</span><span class="sxs-lookup"><span data-stu-id="e43cf-112">Require Email Confirmation Before Log In</span></span>](#require)
- [<span data-ttu-id="e43cf-113">Kenn Wort Wiederherstellung und Zurücksetzen</span><span class="sxs-lookup"><span data-stu-id="e43cf-113">Password Recovery and Reset</span></span>](#reset)
- [<span data-ttu-id="e43cf-114">Link zum erneuten Senden von e-Mail</span><span class="sxs-lookup"><span data-stu-id="e43cf-114">Resend Email Confirmation Link</span></span>](#rsend)
- [<span data-ttu-id="e43cf-115">Problembehandlung der APP</span><span class="sxs-lookup"><span data-stu-id="e43cf-115">Troubleshooting the App</span></span>](#dbg)
- [<span data-ttu-id="e43cf-116">Weitere Ressourcen</span><span class="sxs-lookup"><span data-stu-id="e43cf-116">Additional Resources</span></span>](#addRes)

<a id="createWebForms"></a>
## <a name="create-an-aspnet-web-forms-app"></a><span data-ttu-id="e43cf-117">Erstellen einer ASP.net-Web Forms-App</span><span class="sxs-lookup"><span data-stu-id="e43cf-117">Create an ASP.NET Web Forms App</span></span>

<span data-ttu-id="e43cf-118">Beginnen Sie mit der Installation und Ausführung von [Visual Studio Express 2013 für Web](https://go.microsoft.com/fwlink/?LinkId=299058) -oder [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span><span class="sxs-lookup"><span data-stu-id="e43cf-118">Start by installing and running [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566).</span></span> <span data-ttu-id="e43cf-119">Installieren Sie auch [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) oder höher.</span><span class="sxs-lookup"><span data-stu-id="e43cf-119">Install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher as well.</span></span>

> [!NOTE]
> <span data-ttu-id="e43cf-120">Warnung: Sie müssen [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) oder höher installieren, um dieses Tutorial abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-120">Warning: You must install [Visual Studio 2013 Update 3](https://go.microsoft.com/fwlink/?LinkId=390465) or higher to complete this tutorial.</span></span>

1. <span data-ttu-id="e43cf-121">Erstellen Sie ein neues Projekt (**Datei** -&gt; **Neues Projekt**), und wählen Sie im Dialogfeld **Neues Projekt** die Vorlage **ASP.NET-Webanwendung** und die neueste .NET Framework Version aus.</span><span class="sxs-lookup"><span data-stu-id="e43cf-121">Create a new project (**File** -&gt; **New Project**) and select the **ASP.NET Web Application** template and the latest .NET Framework version from the **New Project** dialog box.</span></span>
2. <span data-ttu-id="e43cf-122">Wählen Sie im Dialogfeld **Neues ASP.net-Projekt** die Vorlage **Web Forms** aus.</span><span class="sxs-lookup"><span data-stu-id="e43cf-122">From the **New ASP.NET Project** dialog box, select the **Web Forms** template.</span></span> <span data-ttu-id="e43cf-123">Überlassen Sie die Standard Authentifizierung als **einzelne Benutzerkonten**.</span><span class="sxs-lookup"><span data-stu-id="e43cf-123">Leave the default authentication as **Individual User Accounts**.</span></span> <span data-ttu-id="e43cf-124">Wenn Sie die app in Azure hosten möchten, lassen Sie das Kontrollkästchen **Host in der Cloud** aktiviert.</span><span class="sxs-lookup"><span data-stu-id="e43cf-124">If you'd like to host the app in Azure, leave the **Host in the cloud** check box checked.</span></span>   
 <span data-ttu-id="e43cf-125">Klicken Sie dann auf **OK** , um das neue Projekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-125">Then, click **OK** to create the new project.</span></span>  
    <span data-ttu-id="e43cf-126">![Dialogfeld "Neues ASP.NET-Projekt"](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e43cf-126">![New ASP.NET Project dialog box](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image1.png)</span></span>
3. <span data-ttu-id="e43cf-127">Aktivieren Sie Secure Sockets Layer (SSL) für das Projekt.</span><span class="sxs-lookup"><span data-stu-id="e43cf-127">Enable Secure Sockets Layer (SSL) for the project.</span></span> <span data-ttu-id="e43cf-128">Führen Sie die Schritte aus, die im Abschnitt **Aktivieren von SSL für den Projekt** Abschnitt der [Reihe "Getting Started with Web Forms Tutorial](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)" beschrieben sind.</span><span class="sxs-lookup"><span data-stu-id="e43cf-128">Follow the steps available in the **Enable SSL for the Project** section of the [Getting Started with Web Forms tutorial series](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms).</span></span>
4. <span data-ttu-id="e43cf-129">Führen Sie die APP aus, klicken Sie auf den Link **registrieren** , und registrieren Sie einen neuen Benutzer.</span><span class="sxs-lookup"><span data-stu-id="e43cf-129">Run the app, click the **Register** link and register a new user.</span></span> <span data-ttu-id="e43cf-130">An dieser Stelle basiert die einzige Überprüfung auf der e-Mail auf dem [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) -Attribut, um sicherzustellen, dass die e-Mail-Adresse wohl geformt ist.</span><span class="sxs-lookup"><span data-stu-id="e43cf-130">At this point, the only validation on the email is based on the [[EmailAddress]](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.emailaddressattribute(v=vs.110).aspx) attribute to ensure the email address is well-formed.</span></span> <span data-ttu-id="e43cf-131">Sie ändern den Code, um eine e-Mail-Bestätigung hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-131">You will modify the code to add email confirmation.</span></span> <span data-ttu-id="e43cf-132">Schließen Sie das Browserfenster.</span><span class="sxs-lookup"><span data-stu-id="e43cf-132">Close the browser window.</span></span>
5. <span data-ttu-id="e43cf-133">Navigieren Sie in **Server-Explorer** von Visual Studio (**anzeigen** -&gt; **Server-Explorer**) zu **Daten connections\defaultconnection\tables\aspnettusers**, klicken Sie mit der rechten Maustaste, und wählen Sie **Tabellendefinition öffnen**aus.</span><span class="sxs-lookup"><span data-stu-id="e43cf-133">In **Server Explorer** of Visual Studio (**View** -&gt; **Server Explorer**), navigate to **Data Connections\DefaultConnection\Tables\AspNetUsers**, right click and select **Open table definition**.</span></span> 

    <span data-ttu-id="e43cf-134">Die folgende Abbildung zeigt das `AspNetUsers` Tabellen Schema:</span><span class="sxs-lookup"><span data-stu-id="e43cf-134">The following image shows the `AspNetUsers` table schema:</span></span>

    ![Aspnettusers-Tabellen Schema](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image2.png)
6. <span data-ttu-id="e43cf-136">Klicken Sie in **Server-Explorer**mit der rechten Maustaste auf die **aspnettusers** -Tabelle, und wählen Sie **Tabellendaten anzeigen**aus.</span><span class="sxs-lookup"><span data-stu-id="e43cf-136">In **Server Explorer**, right-click on the **AspNetUsers** table and select **Show Table Data**.</span></span>  
  
    ![Aspnettusers-Tabellendaten](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image3.png)  
 <span data-ttu-id="e43cf-138">An diesem Punkt wurde die e-Mail für den registrierten Benutzer nicht bestätigt.</span><span class="sxs-lookup"><span data-stu-id="e43cf-138">At this point the email for the registered user has not been confirmed.</span></span>
7. <span data-ttu-id="e43cf-139">Klicken Sie auf die Zeile, und wählen Sie löschen aus, um den Benutzer zu löschen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-139">Click on the row and select delete to delete the user.</span></span> <span data-ttu-id="e43cf-140">Sie fügen diese e-Mail im nächsten Schritt erneut hinzu und senden eine Bestätigungsmeldung an die e-Mail-Adresse.</span><span class="sxs-lookup"><span data-stu-id="e43cf-140">You'll add this email again in the next step and send a confirmation message to the email address.</span></span>

## <a name="email-confirmation"></a><span data-ttu-id="e43cf-141">Bestätigung per e-Mail</span><span class="sxs-lookup"><span data-stu-id="e43cf-141">Email Confirmation</span></span>

<span data-ttu-id="e43cf-142">Es empfiehlt sich, die e-Mail während der Registrierung eines neuen Benutzers zu bestätigen, um sicherzustellen, dass Sie nicht die Identität eines anderen Benutzers angenommen haben (d. h., Sie haben sich nicht bei der e-Mail einer anderen Person registriert).</span><span class="sxs-lookup"><span data-stu-id="e43cf-142">It's a best practice to confirm the email during the registration of a new user to verify they are not impersonating someone else (that is, they haven't registered with someone else's email).</span></span> <span data-ttu-id="e43cf-143">Angenommen, Sie hatten ein Diskussionsforum, Sie sollten verhindern, dass sich `"bob@cpandl.com"` als `"joe@contoso.com"`registrieren.</span><span class="sxs-lookup"><span data-stu-id="e43cf-143">Suppose you had a discussion forum, you would want to prevent `"bob@cpandl.com"` from registering as `"joe@contoso.com"`.</span></span> <span data-ttu-id="e43cf-144">Ohne e-Mail-Bestätigung können `"joe@contoso.com"` unerwünschte e-Mails von Ihrer APP erhalten.</span><span class="sxs-lookup"><span data-stu-id="e43cf-144">Without email confirmation, `"joe@contoso.com"` could get unwanted email from your app.</span></span> <span data-ttu-id="e43cf-145">Wenn Bob versehentlich als `"bib@cpandl.com"` registriert ist und es nicht bemerkt hat, wäre er nicht in der Lage, die Kenn Wort Wiederherstellung zu verwenden, da die APP nicht über die richtige e-Mail verfügt.</span><span class="sxs-lookup"><span data-stu-id="e43cf-145">Suppose Bob accidentally registered as `"bib@cpandl.com"` and hadn't noticed it, he wouldn't be able to use password recovery because the app doesn't have his correct email.</span></span> <span data-ttu-id="e43cf-146">E-Mail-Bestätigung bietet nur eingeschränkten Schutz vor Bots und bietet keinen Schutz vor ermittelten Spammern.</span><span class="sxs-lookup"><span data-stu-id="e43cf-146">Email confirmation provides only limited protection from bots and doesn't provide protection from determined spammers.</span></span>

<span data-ttu-id="e43cf-147">Im Allgemeinen möchten Sie, dass neue Benutzer keine Daten an Ihre Website senden können, bevor Sie durch e-Mail, SMS, SMS oder einen anderen Mechanismus bestätigt wurden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-147">You generally want to prevent new users from posting any data to your website before they have been confirmed by either email, an SMS text message or another mechanism.</span></span> <span data-ttu-id="e43cf-148">In den folgenden Abschnitten aktivieren wir die e-Mail-Bestätigung und ändern den Code, um zu verhindern, dass sich neu registrierte Benutzer anmelden, bis Ihre e-Mail-Nachricht bestätigt wird.</span><span class="sxs-lookup"><span data-stu-id="e43cf-148">In the sections below, we will enable email confirmation and modify the code to prevent newly registered users from logging in until their email has been confirmed.</span></span> <span data-ttu-id="e43cf-149">In diesem Tutorial verwenden Sie den e-Mail-Dienst sendgrid.</span><span class="sxs-lookup"><span data-stu-id="e43cf-149">You'll use the email service SendGrid in this tutorial.</span></span>

<a id="SG"></a>
## <a name="hook-up-sendgrid"></a><span data-ttu-id="e43cf-150">Sendgrid anschließen</span><span class="sxs-lookup"><span data-stu-id="e43cf-150">Hook up SendGrid</span></span>

<span data-ttu-id="e43cf-151">Sendgrid hat seine API geändert, seit dieses Tutorial geschrieben wurde.</span><span class="sxs-lookup"><span data-stu-id="e43cf-151">SendGrid has changed it's API since this tutorial was written.</span></span> <span data-ttu-id="e43cf-152">Aktuelle sendgrid-Anweisungen finden Sie unter [sendgrid](http://sendgrid.com/) oder [Aktivieren der Konto Bestätigung und Kenn Wort Wiederherstellung](xref:security/authentication/accconfirm#enable-account-confirmation-and-password-recovery).</span><span class="sxs-lookup"><span data-stu-id="e43cf-152">For current SendGrid instructions, see [SendGrid](http://sendgrid.com/) or [Enable account confirmation and password recovery](xref:security/authentication/accconfirm#enable-account-confirmation-and-password-recovery).</span></span>

<span data-ttu-id="e43cf-153">Obwohl in diesem Tutorial nur das Hinzufügen von e-Mail-Benachrichtigungen über [sendgrid](http://sendgrid.com/)veranschaulicht wird, können Sie e-Mails mithilfe von SMTP und anderen Mechanismen (siehe [zusätzliche Ressourcen](#addRes)) senden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-153">Although this tutorial only shows how to add email notification through [SendGrid](http://sendgrid.com/), you can send email using SMTP and other mechanisms (see [additional resources](#addRes)).</span></span>

1. <span data-ttu-id="e43cf-154">Öffnen Sie in Visual Studio die **Paket-Manager-Konsole** (**Tools** -&gt; **nuget-Paket** -Manager -&gt; Paket- **Manager-Konsole**), und geben Sie den folgenden Befehl ein:</span><span class="sxs-lookup"><span data-stu-id="e43cf-154">In Visual Studio, open the **Package Manager Console** (**Tools** -&gt; **NuGet Package Manger** -&gt; **Package Manager Console**), and enter the following command:</span></span>  
    `Install-Package SendGrid`
2. <span data-ttu-id="e43cf-155">Wechseln Sie zur [Azure sendgrid-Registrierungsseite](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) , und registrieren Sie sich für das kostenlose sendgrid-Konto.</span><span class="sxs-lookup"><span data-stu-id="e43cf-155">Go to the [Azure SendGrid sign-up page](https://azure.microsoft.com/gallery/store/sendgrid/sendgrid-azure/) and register for free SendGrid account.</span></span> <span data-ttu-id="e43cf-156">Sie können sich auch direkt auf [der sendgrid-Website](http://www.sendgrid.com)für ein kostenloses sendgrid-Konto registrieren.</span><span class="sxs-lookup"><span data-stu-id="e43cf-156">You can also sign-up for a free SendGrid account directly on [SendGrid's site](http://www.sendgrid.com).</span></span>
3. <span data-ttu-id="e43cf-157">Öffnen Sie in **Projektmappen-Explorer** die Datei *IdentityConfig.cs* im Ordner *App\_Start* , und fügen Sie den folgenden Code, der in gelb hervorgehoben ist, der `EmailService`-Klasse hinzu, um **sendgrid**zu konfigurieren:</span><span class="sxs-lookup"><span data-stu-id="e43cf-157">From **Solution Explorer** open the *IdentityConfig.cs* file in the *App\_Start* folder and add the following code highlighted in yellow to the `EmailService` class to configure **SendGrid**:</span></span>

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample1.cs?highlight=3,5,8-37)]
4. <span data-ttu-id="e43cf-158">Fügen Sie außerdem die folgenden `using`-Anweisungen am Anfang der *IdentityConfig.cs* -Datei hinzu:</span><span class="sxs-lookup"><span data-stu-id="e43cf-158">Also, add the following `using` statements to the beginning of the *IdentityConfig.cs* file:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample2.cs?highlight=1-4)]
5. <span data-ttu-id="e43cf-159">Um dieses Beispiel einfach zu halten, speichern Sie die Werte für das e-Mail-Dienst Konto im `appSettings` Abschnitt der Datei " *Web. config* ".</span><span class="sxs-lookup"><span data-stu-id="e43cf-159">To keep this sample simple, you'll store the email service account values in the `appSettings` section of the *web.config* file.</span></span> <span data-ttu-id="e43cf-160">Fügen Sie der Datei " *Web. config* " im Stammverzeichnis des Projekts den folgenden XML-Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="e43cf-160">Add the following XML highlighted in yellow to the *web.config* file at the root of your project:</span></span>

    [!code-xml[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample3.xml?highlight=2-5)]

    > [!WARNING]
    > <span data-ttu-id="e43cf-161">Sicherheit: Speichern Sie vertrauliche Daten niemals in Ihrem Quellcode.</span><span class="sxs-lookup"><span data-stu-id="e43cf-161">Security - Never store sensitive data in your source code.</span></span> <span data-ttu-id="e43cf-162">In diesem Beispiel werden das Konto und die Anmelde Informationen im **appSetting** -Abschnitt der Datei " *Web. config* " gespeichert.</span><span class="sxs-lookup"><span data-stu-id="e43cf-162">In this example, the account and credentials are stored in the **appSetting** section of the *Web.config* file.</span></span> <span data-ttu-id="e43cf-163">In Azure können diese Werte auf der Registerkarte **[Konfigurieren](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** des Azure-Portal sicher gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-163">On Azure, you can securely store these values on the **[Configure](https://blogs.msdn.com/b/webdev/archive/2014/06/04/queuebackgroundworkitem-to-reliably-schedule-and-run-long-background-process-in-asp-net.aspx)** tab in the Azure portal.</span></span> <span data-ttu-id="e43cf-164">Weitere Informationen finden Sie im Thema zu den bewährten Methoden für die Bereitstellung von [Kenn Wörtern und anderen sensiblen Daten für ASP.net und Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span><span class="sxs-lookup"><span data-stu-id="e43cf-164">For related information see Rick Anderson's topic titled [Best practices for deploying passwords and other sensitive data to ASP.NET and Azure](https://go.microsoft.com/fwlink/?LinkId=513141).</span></span>
6. <span data-ttu-id="e43cf-165">Fügen Sie die Werte für den e-Mail-Dienst der sendgrid-Authentifizierungs Werte (Benutzer Name und Kennwort) hinzu, damit Sie erfolgreich e-Mails von Ihrer APP senden können.</span><span class="sxs-lookup"><span data-stu-id="e43cf-165">Add the email service values to reflect your SendGrid authentication values (User Name and Password) so that you can successful send email from your app.</span></span> <span data-ttu-id="e43cf-166">Achten Sie darauf, dass Sie Ihren sendgrid-Kontonamen anstelle der von Ihnen angegebenen e-Mail-Adresse verwenden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-166">Be sure to use your SendGrid account name rather than the email address you provided SendGrid.</span></span>

### <a name="enable-email-confirmation"></a><span data-ttu-id="e43cf-167">Bestätigung per e-Mail aktivieren</span><span class="sxs-lookup"><span data-stu-id="e43cf-167">Enable Email Confirmation</span></span>

 <span data-ttu-id="e43cf-168">Um die e-Mail-Bestätigung zu aktivieren, ändern Sie den Registrierungscode mithilfe der folgenden Schritte.</span><span class="sxs-lookup"><span data-stu-id="e43cf-168">To enable email confirmation, you'll modify the registration code using the following steps.</span></span>  

1. <span data-ttu-id="e43cf-169">Öffnen Sie im *Konto* Ordner den *Register.aspx.cs* -Code Behind, und aktualisieren Sie die `CreateUser_Click`-Methode, um die folgenden markierten Änderungen zu aktivieren:</span><span class="sxs-lookup"><span data-stu-id="e43cf-169">In the *Account* folder, open the *Register.aspx.cs* code-behind and update the `CreateUser_Click` method to enable the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample4.cs?highlight=9-11)]
2. <span data-ttu-id="e43cf-170">Klicken Sie in **Projektmappen-Explorer**mit der rechten Maustaste auf *default. aspx* , und wählen Sie **als Start Seite festlegen**aus.</span><span class="sxs-lookup"><span data-stu-id="e43cf-170">In **Solution Explorer**, right-click *Default.aspx* and select **Set As Start Page**.</span></span>
3. <span data-ttu-id="e43cf-171">Drücken Sie F5, um die APP auszuführen **.**</span><span class="sxs-lookup"><span data-stu-id="e43cf-171">Run the app by pressing **F5.**</span></span> <span data-ttu-id="e43cf-172">Nachdem die Seite angezeigt wird, klicken Sie auf den Link **registrieren** , um die Registerseite anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-172">After the page is displayed, click the **Register** link to display the Register page.</span></span>
4. <span data-ttu-id="e43cf-173">Geben Sie Ihre e-Mail und Ihr Kennwort ein, und klicken Sie auf die Schaltfläche **registrieren** , um eine e-Mail über sendgrid zu senden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-173">Enter your email and password, then click the **Register** button to send an email message via SendGrid.</span></span>  
   <span data-ttu-id="e43cf-174">Der aktuelle Zustand des Projekts und Codes ermöglicht dem Benutzer das anmelden, sobald er das Registrierungsformular abschließt, auch wenn Sie sein Konto nicht bestätigt haben.</span><span class="sxs-lookup"><span data-stu-id="e43cf-174">The current state of your project and code will allow the user to log in once they complete the registration form, even though they haven't confirmed their account.</span></span>
5. <span data-ttu-id="e43cf-175">Überprüfen Sie Ihr e-Mail-Konto, und klicken Sie auf den Link, um Ihre e-Mail</span><span class="sxs-lookup"><span data-stu-id="e43cf-175">Check your email account and click on the link to confirm your email.</span></span>  
   <span data-ttu-id="e43cf-176">Nachdem Sie das Registrierungsformular eingereicht haben, werden Sie angemeldet.</span><span class="sxs-lookup"><span data-stu-id="e43cf-176">Once you submit the registration form, you will be logged in.</span></span>  
    ![Beispiel Website-angemeldet](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/_static/image4.png)

<a id="require"></a>
## <a name="require-email-confirmation-before-log-in"></a><span data-ttu-id="e43cf-178">E-Mail-Bestätigung vor der Anmeldung erforderlich</span><span class="sxs-lookup"><span data-stu-id="e43cf-178">Require Email Confirmation Before Log In</span></span>

<span data-ttu-id="e43cf-179">Obwohl Sie das e-Mail-Konto bestätigt haben, müssen Sie an diesem Punkt nicht auf den in der Bestätigungs-e-Mail enthaltenen Link klicken, um vollständig angemeldet zu sein.</span><span class="sxs-lookup"><span data-stu-id="e43cf-179">Although you have confirmed the email account, at this point you would not need to click on the link contained in the verification email to be fully signed-in.</span></span> <span data-ttu-id="e43cf-180">Im folgenden Abschnitt ändern Sie den Code, der erfordert, dass neue Benutzer eine bestätigte e-Mail-Nachricht erhalten, bevor Sie angemeldet werden (authentifiziert).</span><span class="sxs-lookup"><span data-stu-id="e43cf-180">In the following section, you will modify the code requiring new users to have a confirmed email before they are logged in (authenticated).</span></span>

1. <span data-ttu-id="e43cf-181">Aktualisieren Sie in **Projektmappen-Explorer** von Visual Studio das `CreateUser_Click`-Ereignis in der *Register.aspx.cs* -Code-Behind-Datei, die im *Konten* Ordner enthalten ist, mit den folgenden hervorgehobenen Änderungen:</span><span class="sxs-lookup"><span data-stu-id="e43cf-181">In **Solution Explorer** of Visual Studio, update the `CreateUser_Click` event in the *Register.aspx.cs* code-behind contained in the *Accounts* folder with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample5.cs?highlight=13-14,17-21)]
2. <span data-ttu-id="e43cf-182">Aktualisieren Sie die `LogIn`-Methode im Code-Behind *Login.aspx.cs* mit den folgenden hervorgehobenen Änderungen:</span><span class="sxs-lookup"><span data-stu-id="e43cf-182">Update the `LogIn` method in the *Login.aspx.cs* code-behind with the following highlighted changes:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample6.cs?highlight=9-19,45-46)]

### <a name="run-the-application"></a><span data-ttu-id="e43cf-183">Ausführen der Anwendung</span><span class="sxs-lookup"><span data-stu-id="e43cf-183">Run the Application</span></span>

 <span data-ttu-id="e43cf-184">Nachdem Sie den Code implementiert haben, um zu überprüfen, ob die e-Mail-Adresse eines Benutzers bestätigt wurde, können Sie die Funktionalität sowohl auf den **Register** -als auch auf den **Anmelde** Seiten überprüfen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-184">Now that you have implemented the code to check whether a user's email address has been confirmed, you can check the functionality on both the **Register** and **Login** pages.</span></span> 

1. <span data-ttu-id="e43cf-185">Löschen Sie alle Konten in der Tabelle " **aspnettusers** ", die den zu testenden e-Mail-Alias enthalten.</span><span class="sxs-lookup"><span data-stu-id="e43cf-185">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
2. <span data-ttu-id="e43cf-186">Führen Sie die APP (**F5**) aus, und vergewissern Sie sich, dass Sie sich erst dann als Benutzer registrieren können, wenn Sie Ihre e-Mail</span><span class="sxs-lookup"><span data-stu-id="e43cf-186">Run the app (**F5**) and verify you cannot register as a user until you have confirmed your email address.</span></span>
3. <span data-ttu-id="e43cf-187">Bevor Sie Ihr neues Konto über die soeben gesendete e-Mail bestätigen, versuchen Sie, sich mit dem neuen Konto anzumelden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-187">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
 <span data-ttu-id="e43cf-188">Sie werden feststellen, dass Sie sich nicht anmelden können und dass Sie über ein bestätigtes e-Mail-Konto verfügen müssen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-188">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span>
4. <span data-ttu-id="e43cf-189">Wenn Sie Ihre e-Mail-Adresse bestätigt haben, melden Sie sich bei der APP an.</span><span class="sxs-lookup"><span data-stu-id="e43cf-189">Once you confirm your email address, log in to the app.</span></span>

<a id="reset"></a>
## <a name="password-recovery-and-reset"></a><span data-ttu-id="e43cf-190">Kenn Wort Wiederherstellung und Zurücksetzen</span><span class="sxs-lookup"><span data-stu-id="e43cf-190">Password Recovery and Reset</span></span>

1. <span data-ttu-id="e43cf-191">Entfernen Sie in Visual Studio die Kommentarzeichen aus der `Forgot`-Methode im Code-Behind *Forgot.aspx.cs* , der im *Konto* Ordner enthalten ist, damit die-Methode wie folgt aussieht:</span><span class="sxs-lookup"><span data-stu-id="e43cf-191">In Visual Studio, remove the comment characters from the `Forgot` method in the *Forgot.aspx.cs* code-behind contained in the *Account* folder, so that the method appears as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample7.cs?highlight=16-18)]
2. <span data-ttu-id="e43cf-192">Öffnen Sie die Seite *Login. aspx* .</span><span class="sxs-lookup"><span data-stu-id="e43cf-192">Open the *Login.aspx* page.</span></span> <span data-ttu-id="e43cf-193">Ersetzen Sie das Markup am Ende des **LoginForm** -Abschnitts wie unten gezeigt:</span><span class="sxs-lookup"><span data-stu-id="e43cf-193">Replace the markup near the end of the **loginForm** section as highlighted below:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample8.aspx?highlight=52-53)]
3. <span data-ttu-id="e43cf-194">Öffnen Sie den *Login.aspx.cs* -Code-Behind, und heben Sie die Auskommentierung der folgenden Codezeile auf, die im `Page_Load` Ereignishandler gelb hervorgehoben ist:</span><span class="sxs-lookup"><span data-stu-id="e43cf-194">Open the *Login.aspx.cs* code-behind and uncomment the following line of code highlighted in yellow from the `Page_Load` event handler:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample9.cs?highlight=5)]
4. <span data-ttu-id="e43cf-195">Drücken Sie F5, um die APP auszuführen **.**</span><span class="sxs-lookup"><span data-stu-id="e43cf-195">Run the app by pressing **F5.**</span></span> <span data-ttu-id="e43cf-196">Nachdem die Seite angezeigt wird, klicken Sie auf den Link **Anmelden** .</span><span class="sxs-lookup"><span data-stu-id="e43cf-196">After the page is displayed, click the **Log in** link.</span></span>
5. <span data-ttu-id="e43cf-197">Klicken Sie auf den Link **Kennwort vergessen?** , um die Seite **Kennwort vergessen** anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-197">Click the **Forgot your password?** link to display the **Forgot Password** page.</span></span>
6. <span data-ttu-id="e43cf-198">Geben Sie Ihre e-Mail-Adresse ein, und klicken Sie auf die Schaltfläche **senden** , um eine e-Mail an Ihre Adresse zu senden</span><span class="sxs-lookup"><span data-stu-id="e43cf-198">Enter your email address and click the **Submit** button to send an email to your address which will allow you to reset your password.</span></span>   
   <span data-ttu-id="e43cf-199">Aktivieren Sie Ihr e-Mail-Konto, und klicken Sie auf den Link, um die Seite **Kennwort zurücksetzen**</span><span class="sxs-lookup"><span data-stu-id="e43cf-199">Check your email account and click on the link to display the **Reset Password** page.</span></span>
7. <span data-ttu-id="e43cf-200">Geben Sie auf der Seite **Kennwort zurücksetzen** Ihre e-Mail, Ihr Kennwort und Ihr bestätigtes Kennwort ein.</span><span class="sxs-lookup"><span data-stu-id="e43cf-200">On the **Reset Password** page, enter your email, password, and confirmed password.</span></span> <span data-ttu-id="e43cf-201">Klicken Sie dann auf die Schaltfläche **Zurücksetzen** .</span><span class="sxs-lookup"><span data-stu-id="e43cf-201">Then, press the **Reset** button.</span></span>  
   <span data-ttu-id="e43cf-202">Wenn Sie Ihr Kennwort erfolgreich zurückgesetzt haben, wird die Seite **Kennwort geändert** angezeigt.</span><span class="sxs-lookup"><span data-stu-id="e43cf-202">When you successfully reset your password, the **Password Changed** page will be displayed.</span></span> <span data-ttu-id="e43cf-203">Jetzt können Sie sich mit Ihrem neuen Kennwort anmelden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-203">Now you can log in with your new password.</span></span>

<a id="rsend"></a>
## <a name="resend-email-confirmation-link"></a><span data-ttu-id="e43cf-204">Link zum erneuten Senden von e-Mail</span><span class="sxs-lookup"><span data-stu-id="e43cf-204">Resend Email Confirmation Link</span></span>

<span data-ttu-id="e43cf-205">Nachdem ein Benutzer ein neues lokales Konto erstellt hat, sendet er einen Bestätigungslink per e-Mail, bevor er sich anmelden kann.</span><span class="sxs-lookup"><span data-stu-id="e43cf-205">Once a user creates a new local account, they are emailed a confirmation link they are required to use before they can log on.</span></span> <span data-ttu-id="e43cf-206">Wenn der Benutzer die Bestätigungs-e-Mail versehentlich löscht oder die e-Mail nie eintrifft, muss der Bestätigungslink erneut gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-206">If the user accidentally deletes the confirmation email, or the email never arrives, they will need the confirmation link sent again.</span></span> <span data-ttu-id="e43cf-207">Die folgenden Codeänderungen zeigen, wie Sie diese aktivieren.</span><span class="sxs-lookup"><span data-stu-id="e43cf-207">The following code changes show how to enable this.</span></span>

1. <span data-ttu-id="e43cf-208">Öffnen Sie in Visual Studio den **Login.aspx.cs** -Code Behind, und fügen Sie den folgenden Ereignishandler nach dem `LogIn`-Ereignishandler hinzu:</span><span class="sxs-lookup"><span data-stu-id="e43cf-208">In Visual Studio, open the **Login.aspx.cs** code-behind and add the following event handler after the `LogIn` event handler:</span></span>   

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample10.cs)]
2. <span data-ttu-id="e43cf-209">Ändern Sie den `LogIn`-Ereignishandler im Code Behind *Login.aspx.cs* , indem Sie den in gelb markierten Code wie folgt ändern:</span><span class="sxs-lookup"><span data-stu-id="e43cf-209">Modify the `LogIn` event handler in the *Login.aspx.cs* code-behind by changing the code highlighted in yellow as follows:</span></span> 

    [!code-csharp[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample11.cs?highlight=15-17)]
3. <span data-ttu-id="e43cf-210">Aktualisieren Sie die Seite *Login. aspx* , indem Sie den in gelb markierten Code wie folgt hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="e43cf-210">Update the *Login.aspx* page by adding the code highlighted in yellow as follows:</span></span> 

    [!code-aspx[Main](create-a-secure-aspnet-web-forms-app-with-user-registration-email-confirmation-and-password-reset/samples/sample12.aspx?highlight=45-46)]
4. <span data-ttu-id="e43cf-211">Löschen Sie alle Konten in der Tabelle " **aspnettusers** ", die den zu testenden e-Mail-Alias enthalten.</span><span class="sxs-lookup"><span data-stu-id="e43cf-211">Delete any accounts in the **AspNetUsers** table that contain the email alias you wish to test.</span></span>
5. <span data-ttu-id="e43cf-212">Führen Sie die APP (**F5**) und Ihre e-Mail-Adresse aus.</span><span class="sxs-lookup"><span data-stu-id="e43cf-212">Run the app (**F5**) and register your email address.</span></span>
6. <span data-ttu-id="e43cf-213">Bevor Sie Ihr neues Konto über die soeben gesendete e-Mail bestätigen, versuchen Sie, sich mit dem neuen Konto anzumelden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-213">Before confirming your new account via the email that was just sent, attempt to log in with the new account.</span></span>  
   <span data-ttu-id="e43cf-214">Sie werden feststellen, dass Sie sich nicht anmelden können und dass Sie über ein bestätigtes e-Mail-Konto verfügen müssen.</span><span class="sxs-lookup"><span data-stu-id="e43cf-214">You'll see that you are unable to log in and that you must have a confirmed email account.</span></span> <span data-ttu-id="e43cf-215">Außerdem können Sie jetzt eine Bestätigungsnachricht erneut an Ihr e-Mail-Konto senden.</span><span class="sxs-lookup"><span data-stu-id="e43cf-215">In addition, you can now resend a confirmation message to your email account.</span></span>
7. <span data-ttu-id="e43cf-216">Geben Sie Ihre e-Mail-Adresse und Ihr Kennwort ein, und **Klicken Sie dann auf die Schalt** Fläche</span><span class="sxs-lookup"><span data-stu-id="e43cf-216">Enter your email address and password, then press the **Resend confirmation** button.</span></span>
8. <span data-ttu-id="e43cf-217">Wenn Sie Ihre e-Mail-Adresse anhand der neu gesendeten e-Mail-Nachricht bestätigen, melden Sie sich bei der APP an.</span><span class="sxs-lookup"><span data-stu-id="e43cf-217">Once you confirm your email address based on the newly sent email message, log in to the app.</span></span>

<a id="dbg"></a>
## <a name="troubleshooting-the-app"></a><span data-ttu-id="e43cf-218">Problembehandlung der APP</span><span class="sxs-lookup"><span data-stu-id="e43cf-218">Troubleshooting the App</span></span>

<span data-ttu-id="e43cf-219">Wenn Sie keine e-Mail mit dem Link erhalten, um Ihre Anmelde Informationen zu überprüfen:</span><span class="sxs-lookup"><span data-stu-id="e43cf-219">If you don't receive an email containing the link to verify your credentials:</span></span>

- <span data-ttu-id="e43cf-220">Überprüfen Sie Ihren Junk-oder Spam Ordner.</span><span class="sxs-lookup"><span data-stu-id="e43cf-220">Check your junk or spam folder.</span></span>
- <span data-ttu-id="e43cf-221">Melden Sie sich bei Ihrem sendgrid-Konto an, und klicken Sie auf den [Link Email Activity](https://sendgrid.com/logs/index).</span><span class="sxs-lookup"><span data-stu-id="e43cf-221">Log into your SendGrid account and click on the [Email Activity link](https://sendgrid.com/logs/index).</span></span>
- <span data-ttu-id="e43cf-222">Stellen Sie sicher, dass Sie Ihren sendgrid-Benutzerkonto Namen als *Web. config* -Wert anstelle der e-Mail-Adresse Ihres sendgrid-Kontos verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="e43cf-222">Be certain you used your SendGrid user account name as a *Web.config* value rather than your SendGrid account email address.</span></span>

<a id="addRes"></a>
## <a name="additional-resources"></a><span data-ttu-id="e43cf-223">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="e43cf-223">Additional Resources</span></span>

- [<span data-ttu-id="e43cf-224">Links zu ASP.net Identity empfohlenen Ressourcen</span><span class="sxs-lookup"><span data-stu-id="e43cf-224">Links to ASP.NET Identity Recommended Resources</span></span>](../../../identity/overview/getting-started/aspnet-identity-recommended-resources.md)
- [<span data-ttu-id="e43cf-225">Konto Bestätigung und Kenn Wort Wiederherstellung mit ASP.net Identity</span><span class="sxs-lookup"><span data-stu-id="e43cf-225">Account Confirmation and Password Recovery with ASP.NET Identity</span></span>](../../../identity/overview/features-api/account-confirmation-and-password-recovery-with-aspnet-identity.md)
- [<span data-ttu-id="e43cf-226">ASP.net Web Forms-tutorialreihe: Hinzufügen eines OAuth 2,0-Anbieters</span><span class="sxs-lookup"><span data-stu-id="e43cf-226">ASP.NET Web Forms tutorial series - Add an OAuth 2.0 Provider</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#OAuthWebForms)
- [<span data-ttu-id="e43cf-227">Stellen Sie eine sichere ASP.net Web Forms-App mit Mitgliedschaft, OAuth und SQL-Datenbank bereit, um Azure App Service</span><span class="sxs-lookup"><span data-stu-id="e43cf-227">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to Azure App Service</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)
- [<span data-ttu-id="e43cf-228">ASP.net Web Forms-tutorialreihe: Aktivieren von SSL für das Projekt</span><span class="sxs-lookup"><span data-stu-id="e43cf-228">ASP.NET Web Forms tutorial series - Enable SSL for the Project</span></span>](../getting-started/getting-started-with-aspnet-45-web-forms/checkout-and-payment-with-paypal.md#SSLWebForms)
