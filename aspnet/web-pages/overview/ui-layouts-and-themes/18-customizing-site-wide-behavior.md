---
uid: web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
title: Anpassen des Standort weiten Verhaltens für ASP.net Web Pages (Razor) Websites | Microsoft-Dokumentation
author: Rick-Anderson
description: In diesem Kapitel wird erläutert, wie Sie die Einstellungen für Ihre gesamte Website oder einen vollständigen Ordner anstatt nur für eine Seite erstellen.
ms.author: riande
ms.date: 02/17/2014
ms.assetid: e158bed7-226f-4275-b02e-7553bd58c669
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
msc.type: authoredcontent
ms.openlocfilehash: f05e05f725d9209bce283ce18659ae5efe4de2ee
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/06/2020
ms.locfileid: "78515247"
---
# <a name="customizing-site-wide-behavior-for-aspnet-web-pages-razor-sites"></a><span data-ttu-id="7fba8-103">Anpassen des Standort weiten Verhaltens für ASP.net Web Pages-Websites (Razor)</span><span class="sxs-lookup"><span data-stu-id="7fba8-103">Customizing Site-Wide Behavior for ASP.NET Web Pages (Razor) Sites</span></span>

<span data-ttu-id="7fba8-104">von [Tom fitzmacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="7fba8-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="7fba8-105">In diesem Artikel wird erläutert, wie Sie Standort seitige Einstellungen für Seiten auf einer ASP.net Web Pages-Website (Razor) erstellen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-105">This article explains how to make site-side settings for pages in an ASP.NET Web Pages (Razor) website.</span></span>
> 
> <span data-ttu-id="7fba8-106">Sie lernen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-106">What you'll learn:</span></span>
> 
> - <span data-ttu-id="7fba8-107">Ausführen von Code, mit dem Sie Werte für alle Seiten einer Site festlegen können (globale Werte oder Hilfseinstellungen).</span><span class="sxs-lookup"><span data-stu-id="7fba8-107">How to run code that lets you set values (global values or helper settings) for all pages in a site.</span></span>
> - <span data-ttu-id="7fba8-108">Ausführen von Code, mit dem Sie Werte für alle Seiten in einem Ordner festlegen können.</span><span class="sxs-lookup"><span data-stu-id="7fba8-108">How to run code that lets you set values for all pages in a folder.</span></span>
> - <span data-ttu-id="7fba8-109">Ausführen von Code vor und nach dem Laden einer Seite.</span><span class="sxs-lookup"><span data-stu-id="7fba8-109">How to run code before and after a page loads.</span></span>
> - <span data-ttu-id="7fba8-110">Vorgehensweise beim Senden von Fehlern an eine zentrale Fehlerseite</span><span class="sxs-lookup"><span data-stu-id="7fba8-110">How to send errors to a central error page.</span></span>
> - <span data-ttu-id="7fba8-111">Vorgehensweise beim Hinzufügen von Authentifizierung zu allen Seiten in einem Ordner.</span><span class="sxs-lookup"><span data-stu-id="7fba8-111">How to add authentication to all pages in a folder.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="7fba8-112">Im Tutorial verwendete Software Versionen</span><span class="sxs-lookup"><span data-stu-id="7fba8-112">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="7fba8-113">ASP.net Web Pages (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="7fba8-113">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="7fba8-114">Webmatrix 3</span><span class="sxs-lookup"><span data-stu-id="7fba8-114">WebMatrix 3</span></span>
> - <span data-ttu-id="7fba8-115">ASP.net-webhilfsprogramme-Bibliothek (nuget-Paket)</span><span class="sxs-lookup"><span data-stu-id="7fba8-115">ASP.NET Web Helpers Library (NuGet package)</span></span>
>   
> 
> <span data-ttu-id="7fba8-116">Dieses Tutorial funktioniert auch mit ASP.net Web Pages 3 und Visual Studio 2013 (oder Visual Studio Express 2013 für Web), mit der Ausnahme, dass Sie nicht die ASP.net-webhilfsprogramme-Bibliothek verwenden können.</span><span class="sxs-lookup"><span data-stu-id="7fba8-116">This tutorial also works with ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web), except you cannot use the ASP.NET Web Helpers Library.</span></span>

<a id="Adding_Website_Startup_Code"></a>
## <a name="adding-website-startup-code-for-aspnet-web-pages"></a><span data-ttu-id="7fba8-117">Startcode für Website wird hinzugefügt für ASP.net Web Pages</span><span class="sxs-lookup"><span data-stu-id="7fba8-117">Adding Website Startup Code for ASP.NET Web Pages</span></span>

<span data-ttu-id="7fba8-118">Für einen Großteil des Codes, den Sie in ASP.net Web Pages schreiben, kann eine einzelne Seite den gesamten Code enthalten, der für diese Seite erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7fba8-118">For much of the code that you write in ASP.NET Web Pages, an individual page can contain all the code that's required for that page.</span></span> <span data-ttu-id="7fba8-119">Wenn eine Seite z. b. eine e-Mail-Nachricht sendet, können Sie den gesamten Code für diesen Vorgang auf einer einzelnen Seite ablegen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-119">For example, if a page sends an email message, it's possible to put all the code for that operation in a single page.</span></span> <span data-ttu-id="7fba8-120">Dies kann den Code zum Initialisieren der Einstellungen für das Senden von e-Mails (d. h. für den SMTP-Server) und das Senden der e-Mail-Nachricht einschließen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-120">This can include the code to initialize the settings for sending email (that is, for the SMTP server) and for sending the email message.</span></span>

<span data-ttu-id="7fba8-121">In einigen Fällen möchten Sie jedoch vielleicht Code ausführen, bevor eine Seite auf der Website ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="7fba8-121">However, in some situations, you might want to run some code before any page on the site runs.</span></span> <span data-ttu-id="7fba8-122">Dies ist nützlich, um Werte festzulegen, die an beliebiger Stelle auf der Website verwendet werden können (als *globale Werte*bezeichnet). Beispielsweise erfordern einige Hilfsprogramme, dass Sie Werte wie e-Mail-Einstellungen oder Kontoschlüssel angeben.</span><span class="sxs-lookup"><span data-stu-id="7fba8-122">This is useful for setting values that can be used anywhere in the site (referred to as *global values*.) For example, some helpers require you to provide values like email settings or account keys.</span></span> <span data-ttu-id="7fba8-123">Es kann nützlich sein, diese Einstellungen in globalen Werten zu speichern.</span><span class="sxs-lookup"><span data-stu-id="7fba8-123">It can be handy to keep these settings in global values.</span></span>

<span data-ttu-id="7fba8-124">Erstellen Sie hierzu im Stammverzeichnis der Website eine Seite mit dem Namen *\_AppStart. cshtml* .</span><span class="sxs-lookup"><span data-stu-id="7fba8-124">You can do this by creating a page named *\_AppStart.cshtml* in the root of the site.</span></span> <span data-ttu-id="7fba8-125">Wenn diese Seite vorhanden ist, wird Sie ausgeführt, wenn eine Seite der Website zum ersten Mal angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="7fba8-125">If this page exists, it runs the first time any page in the site is requested.</span></span> <span data-ttu-id="7fba8-126">Daher ist es ein guter Ausgangspunkt, Code zum Festlegen globaler Werte auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-126">Therefore, it's a good place to run code to set global values.</span></span> <span data-ttu-id="7fba8-127">(Da *\_AppStart. cshtml* ein Unterstrich Präfix enthält, sendet ASP.net die Seite auch dann nicht an einen Browser, wenn Sie von den Benutzern direkt angefordert werden.)</span><span class="sxs-lookup"><span data-stu-id="7fba8-127">(Because *\_AppStart.cshtml* has an underscore prefix, ASP.NET won't send the page to a browser even if users request it directly.)</span></span>

<span data-ttu-id="7fba8-128">Das folgende Diagramm zeigt, wie die *\_AppStart. cshtml* -Seite funktioniert.</span><span class="sxs-lookup"><span data-stu-id="7fba8-128">The following diagram shows how the *\_AppStart.cshtml* page works.</span></span> <span data-ttu-id="7fba8-129">Wenn eine Anforderung für eine Seite angezeigt wird, und wenn dies die erste Anforderung für eine beliebige Seite in der Site ist, überprüft ASP.net zuerst, ob eine *\_AppStart. cshtml* -Seite vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="7fba8-129">When a request comes in for a page, and if this is the first request for any page in the site, ASP.NET first checks whether a *\_AppStart.cshtml* page exists.</span></span> <span data-ttu-id="7fba8-130">Wenn dies der Fall ist, wird der Code auf der *\_AppStart. cshtml* -Seite ausgeführt, und dann wird die angeforderte Seite ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-130">If so, any code in the *\_AppStart.cshtml* page runs, and then the requested page runs.</span></span>

![Klang](18-customizing-site-wide-behavior/_static/image1.jpg)

## <a name="setting-global-values-for-your-website"></a><span data-ttu-id="7fba8-132">Festlegen globaler Werte für Ihre Website</span><span class="sxs-lookup"><span data-stu-id="7fba8-132">Setting Global Values for Your Website</span></span>

1. <span data-ttu-id="7fba8-133">Erstellen Sie im Stamm Ordner einer webmatrix-Website eine Datei mit dem Namen *\_AppStart. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-133">In the root folder of a WebMatrix website, create a file named *\_AppStart.cshtml*.</span></span> <span data-ttu-id="7fba8-134">Die Datei muss sich im Stammverzeichnis der Website befinden.</span><span class="sxs-lookup"><span data-stu-id="7fba8-134">The file must be in the root of the site.</span></span>
2. <span data-ttu-id="7fba8-135">Ersetzen Sie den vorhandenen Inhalt durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-135">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample1.cshtml)]

    <span data-ttu-id="7fba8-136">In diesem Code wird ein Wert im `AppState` Wörterbuch gespeichert, das für alle Seiten der Site automatisch verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="7fba8-136">This code stores a value in the `AppState` dictionary, which is automatically available to all pages in the site.</span></span> <span data-ttu-id="7fba8-137">Beachten Sie, dass die *\_AppStart. cshtml* -Datei kein Markup enthält.</span><span class="sxs-lookup"><span data-stu-id="7fba8-137">Notice that the *\_AppStart.cshtml* file does not have any markup in it.</span></span> <span data-ttu-id="7fba8-138">Die Seite führt den Code aus und leitet dann zu der ursprünglich angeforderten Seite um.</span><span class="sxs-lookup"><span data-stu-id="7fba8-138">The page will run the code and then redirect to the page that was originally requested.</span></span>

    > [!NOTE]
    > <span data-ttu-id="7fba8-139">Gehen Sie vorsichtig vor, wenn Sie Code in der *\_AppStart. cshtml* -Datei ablegen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-139">Be careful when you put code in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="7fba8-140">Wenn Fehler im Code in der *\_AppStart. cshtml* -Datei auftreten, wird die Website nicht gestartet.</span><span class="sxs-lookup"><span data-stu-id="7fba8-140">If any errors occur in code in the *\_AppStart.cshtml* file, the website won't start.</span></span>
3. <span data-ttu-id="7fba8-141">Erstellen Sie im Stamm Ordner eine neue Seite mit dem Namen *appname. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-141">In the root folder, create a new page named *AppName.cshtml*.</span></span>
4. <span data-ttu-id="7fba8-142">Ersetzen Sie das Standard Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-142">Replace the default markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample2.html)]

    <span data-ttu-id="7fba8-143">Mit diesem Code wird der Wert aus dem `AppState`-Objekt extrahiert, das Sie auf der Seite *\_AppStart. cshtml* festgelegt haben.</span><span class="sxs-lookup"><span data-stu-id="7fba8-143">This code extracts the value from the `AppState` object that you set in the *\_AppStart.cshtml* page.</span></span>
5. <span data-ttu-id="7fba8-144">Führen Sie die Seite *appname. cshtml* in einem Browser aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-144">Run the *AppName.cshtml* page in a browser.</span></span> <span data-ttu-id="7fba8-145">(Stellen Sie sicher, dass die Seite im Arbeitsbereich " **Dateien** " ausgewählt ist, bevor Sie Sie ausführen.) Auf der Seite wird der globale Wert angezeigt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-145">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays the global value.</span></span> 

    ![Klang](18-customizing-site-wide-behavior/_static/image2.jpg)

<a id="Setting_Values_For_Helpers"></a>
## <a name="setting-values-for-helpers"></a><span data-ttu-id="7fba8-147">Festlegen von Werten für Hilfsprogramme</span><span class="sxs-lookup"><span data-stu-id="7fba8-147">Setting Values for Helpers</span></span>

<span data-ttu-id="7fba8-148">Eine gute Verwendung für die *\_AppStart. cshtml* -Datei ist die Festlegung von Werten für Hilfsprogramme, die Sie an Ihrer Website verwenden und die initialisiert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-148">A good use for the *\_AppStart.cshtml* file is to set values for helpers that you use in your site and that have to be initialized.</span></span> <span data-ttu-id="7fba8-149">Typische Beispiele hierfür sind e-Mail-Einstellungen für die `WebMail`-Hilfsprogramm und die privaten und öffentlichen Schlüssel für das `ReCaptcha`-Hilfsprogramm.</span><span class="sxs-lookup"><span data-stu-id="7fba8-149">Typical examples are email settings for the `WebMail` helper and the private and public keys for the `ReCaptcha` helper.</span></span> <span data-ttu-id="7fba8-150">In solchen Fällen können Sie die Werte einmal in der *\_AppStart. cshtml* festlegen und sind dann für alle Seiten auf Ihrer Website bereits festgelegt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-150">In cases like these, you can set the values once in the *\_AppStart.cshtml* and then they're already set for all the pages in your site.</span></span>

<span data-ttu-id="7fba8-151">In diesem Verfahren wird gezeigt, wie Sie `WebMail` Einstellungen global festlegen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-151">This procedure shows you how to set `WebMail` settings globally.</span></span> <span data-ttu-id="7fba8-152">(Weitere Informationen zur Verwendung des `WebMail`-Hilfsprogramms finden Sie unter [Hinzufügen von e-Mail zu einer ASP.net Web Pages Website](../getting-started/11-adding-email-to-your-web-site.md).)</span><span class="sxs-lookup"><span data-stu-id="7fba8-152">(For more information about using the `WebMail` helper, see [Adding Email to an ASP.NET Web Pages Site](../getting-started/11-adding-email-to-your-web-site.md).)</span></span>

1. <span data-ttu-id="7fba8-153">Fügen Sie die ASP.net-webhilfsbibliothek Ihrer Website hinzu, wie unter [Installieren von Hilfsprogrammen an einer ASP.net Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372)beschrieben, wenn Sie Sie noch nicht hinzugefügt haben.</span><span class="sxs-lookup"><span data-stu-id="7fba8-153">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you haven't already added it.</span></span>
2. <span data-ttu-id="7fba8-154">Wenn Sie nicht bereits über eine *\_AppStart. cshtml* -Datei verfügen, erstellen Sie im Stamm Ordner einer Website eine Datei mit dem Namen *\_AppStart. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-154">If you don't already have a *\_AppStart.cshtml* file, in the root folder of a website create a file named *\_AppStart.cshtml*.</span></span>
3. <span data-ttu-id="7fba8-155">Fügen Sie der *\_AppStart. cshtml* -Datei die folgenden `WebMail` Einstellungen hinzu:</span><span class="sxs-lookup"><span data-stu-id="7fba8-155">Add the following `WebMail` settings to the *\_AppStart.cshtml* file:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample3.cshtml?highlight=2-7)]

    <span data-ttu-id="7fba8-156">Ändern Sie die folgenden e-Mail-bezogenen Einstellungen im Code:</span><span class="sxs-lookup"><span data-stu-id="7fba8-156">Modify the following email related settings in the code:</span></span>

   - <span data-ttu-id="7fba8-157">Legen Sie `your-SMTP-host` auf den Namen des SMTP-Servers fest, auf den Sie Zugriff haben.</span><span class="sxs-lookup"><span data-stu-id="7fba8-157">Set `your-SMTP-host` to the name of the SMTP server that you have access to.</span></span>
   - <span data-ttu-id="7fba8-158">Legen Sie `your-user-name-here` auf den Benutzernamen für Ihr SMTP-Server Konto fest.</span><span class="sxs-lookup"><span data-stu-id="7fba8-158">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
   - <span data-ttu-id="7fba8-159">Legen Sie `your-account-password` auf das Kennwort für Ihr SMTP-Server Konto fest.</span><span class="sxs-lookup"><span data-stu-id="7fba8-159">Set `your-account-password` to the password for your SMTP server account.</span></span>
   - <span data-ttu-id="7fba8-160">Legen Sie `your-email-address-here` auf Ihre e-Mail-Adresse fest.</span><span class="sxs-lookup"><span data-stu-id="7fba8-160">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="7fba8-161">Dies ist die e-Mail-Adresse, von der die Nachricht gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="7fba8-161">This is the email address that the message is sent from.</span></span> <span data-ttu-id="7fba8-162">(Bei einigen e-Mail-Anbietern ist es nicht möglich, eine andere `From` Adresse anzugeben, und der Benutzername wird als `From` Adresse verwendet.)</span><span class="sxs-lookup"><span data-stu-id="7fba8-162">(Some email providers don't let you specify a different `From` address and will use your user name as the `From` address.)</span></span>

     <span data-ttu-id="7fba8-163">Weitere Informationen zu SMTP-Einstellungen finden Sie [unter Konfigurieren von e](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) -Mail-Einstellungen im Artikel [Senden von e-Mail von einer ASP.net Web Pages-Website (Razor)](https://go.microsoft.com/fwlink/?LinkID=202899) und [Problemen beim Senden von e-Mails](https://go.microsoft.com/fwlink/?LinkId=253001#email) im Handbuch zur Problembehandlung bei [ASP.net Web Pages (Razor)](https://go.microsoft.com/fwlink/?LinkId=253001).</span><span class="sxs-lookup"><span data-stu-id="7fba8-163">For more information about SMTP settings, see [Configuring Email Settings](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) in the article [Sending Email from an ASP.NET Web Pages (Razor) Site](https://go.microsoft.com/fwlink/?LinkID=202899) and [Issues with Sending Email](https://go.microsoft.com/fwlink/?LinkId=253001#email) in the [ASP.NET Web Pages (Razor) Troubleshooting Guide](https://go.microsoft.com/fwlink/?LinkId=253001).</span></span>
4. <span data-ttu-id="7fba8-164">Speichern Sie die Datei *\_AppStart. cshtml* , und schließen Sie Sie.</span><span class="sxs-lookup"><span data-stu-id="7fba8-164">Save the *\_AppStart.cshtml* file and close it.</span></span>
5. <span data-ttu-id="7fba8-165">Erstellen Sie im Stamm Ordner einer Website eine neue Seite mit dem Namen *Testemail. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-165">In the root folder of a website, create new page named *TestEmail.cshtml*.</span></span>
6. <span data-ttu-id="7fba8-166">Ersetzen Sie den vorhandenen Inhalt durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-166">Replace the existing content with the following:</span></span> 

     [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample4.cshtml)]
7. <span data-ttu-id="7fba8-167">Führen Sie die Seite " *Testemail. cshtml* " in einem Browser aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-167">Run the *TestEmail.cshtml* page in a browser.</span></span>
8. <span data-ttu-id="7fba8-168">Füllen Sie die Felder aus, um sich selbst eine e-Mail zu senden, und klicken Sie dann auf **senden**.</span><span class="sxs-lookup"><span data-stu-id="7fba8-168">Fill in the fields to send yourself an email message and then click **Send**.</span></span>
9. <span data-ttu-id="7fba8-169">Überprüfen Sie Ihre e-Mail, um sicherzustellen, dass die Nachricht abgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="7fba8-169">Check your email to make sure you've gotten the message.</span></span>

<span data-ttu-id="7fba8-170">Der wichtige Teil dieses Beispiels ist, dass die Einstellungen, die Sie in der Regel nicht ändern – wie der Name des SMTP-Servers und Ihre e-Mail-Anmelde Informationen – in der *\_AppStart. cshtml* -Datei festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="7fba8-170">The important part of this example is that the settings that you don't usually change — like the name of your SMTP server and your email credentials — are set in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="7fba8-171">Auf diese Weise müssen Sie Sie nicht erneut auf jeder Seite festlegen, an die Sie eine e-Mail senden.</span><span class="sxs-lookup"><span data-stu-id="7fba8-171">That way you don't need to set them again in each page where you send email.</span></span> <span data-ttu-id="7fba8-172">(Obwohl Sie aus irgendeinem Grund diese Einstellungen ändern müssen, können Sie sie einzeln auf einer Seite festlegen.) Auf der Seite legen Sie nur die Werte fest, die normalerweise jedes Mal geändert werden, z. b. den Empfänger und den Text der e-Mail-Nachricht.</span><span class="sxs-lookup"><span data-stu-id="7fba8-172">(Although if for some reason you need to change those settings, you can set them individually in a page.) In the page, you only set the values that typically change each time, like the recipient and the body of the email message.</span></span>

<a id="Running_Code_Before_and_After"></a>
## <a name="running-code-before-and-after-files-in-a-folder"></a><span data-ttu-id="7fba8-173">Ausführen von Code vor und nach Dateien in einem Ordner</span><span class="sxs-lookup"><span data-stu-id="7fba8-173">Running Code Before and After Files in a Folder</span></span>

<span data-ttu-id="7fba8-174">Ebenso wie Sie *\_AppStart. cshtml* zum Schreiben von Code verwenden können, bevor Seiten auf der Website ausgeführt werden, können Sie Code schreiben, der vor (und nach) einer beliebigen Seite in einem bestimmten Ordner ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="7fba8-174">Just like you can use *\_AppStart.cshtml* to write code before pages in the site run, you can write code that runs before (and after) any page in a particular folder run.</span></span> <span data-ttu-id="7fba8-175">Dies ist hilfreich, wenn die gleiche Layoutseite für alle Seiten in einem Ordner festgelegt wird, oder um zu überprüfen, ob ein Benutzer angemeldet ist, bevor eine Seite im Ordner ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="7fba8-175">This is useful for things like setting the same layout page for all the pages in a folder, or for checking that a user is logged in before running a page in the folder.</span></span>

<span data-ttu-id="7fba8-176">Für Seiten in bestimmten Ordnern können Sie Code in einer Datei mit dem Namen *\_pagestart. cshtml*erstellen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-176">For pages in particular folders, you can create code in a file named *\_PageStart.cshtml*.</span></span> <span data-ttu-id="7fba8-177">Das folgende Diagramm zeigt, wie die Seite *\_pagestart. cshtml* funktioniert.</span><span class="sxs-lookup"><span data-stu-id="7fba8-177">The following diagram shows how the *\_PageStart.cshtml* page works.</span></span> <span data-ttu-id="7fba8-178">Wenn eine Anforderung für eine Seite eingehen soll, sucht ASP.net zuerst nach einer *\_AppStart. cshtml* -Seite und führt diese aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-178">When a request comes in for a page, ASP.NET first checks for a *\_AppStart.cshtml* page and runs that.</span></span> <span data-ttu-id="7fba8-179">Dann überprüft ASP.net, ob eine *\_Page Start. cshtml* -Seite vorhanden ist. ist dies der Fall, wird diese ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-179">Then ASP.NET checks whether there's a *\_PageStart.cshtml* page, and if so, runs that.</span></span> <span data-ttu-id="7fba8-180">Anschließend wird die angeforderte Seite ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-180">It then runs the requested page.</span></span>

<span data-ttu-id="7fba8-181">Auf der Seite *\_pagestart. cshtml* können Sie angeben, wohin die angeforderte Seite während der Verarbeitung durch Einschließen einer `RunPage` Methode ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="7fba8-181">Inside the *\_PageStart.cshtml* page, you can specify where during processing you want the requested page to run by including a `RunPage` method.</span></span> <span data-ttu-id="7fba8-182">Auf diese Weise können Sie Code ausführen, bevor die angeforderte Seite ausgeführt wird, und dann erneut darauf klicken.</span><span class="sxs-lookup"><span data-stu-id="7fba8-182">This lets you run code before the requested page runs and then again after it.</span></span> <span data-ttu-id="7fba8-183">Wenn Sie `RunPage`nicht einschließen, wird der gesamte Code in *\_pagestart. cshtml* ausgeführt, und anschließend wird die angeforderte Seite automatisch ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-183">If you don't include `RunPage`, all the code in *\_PageStart.cshtml* runs, and then the requested page runs automatically.</span></span>

![Klang](18-customizing-site-wide-behavior/_static/image3.jpg)

<span data-ttu-id="7fba8-185">Mit ASP.net können Sie eine Hierarchie von *\_pagestart. cshtml* -Dateien erstellen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-185">ASP.NET lets you create a hierarchy of *\_PageStart.cshtml* files.</span></span> <span data-ttu-id="7fba8-186">Sie können eine *\_pagestart. cshtml* -Datei im Stammverzeichnis der Website und in einem beliebigen Unterordner platzieren.</span><span class="sxs-lookup"><span data-stu-id="7fba8-186">You can put a *\_PageStart.cshtml* file in the root of the site and in any subfolder.</span></span> <span data-ttu-id="7fba8-187">Wenn eine Seite angefordert wird, wird die *\_pagestart. cshtml* -Datei auf der obersten Ebene (am nächsten zum Stammverzeichnis der Website) ausgeführt, gefolgt von der *\_pagestart. cshtml* -Datei im nächsten Unterordner usw., bis die Anforderung den Ordner erreicht, der die angeforderte Seite enthält.</span><span class="sxs-lookup"><span data-stu-id="7fba8-187">When a page is requested, the *\_PageStart.cshtml* file at the top-most level (nearest to the site root) runs, followed by the *\_PageStart.cshtml* file in the next subfolder, and so on down the subfolder structure until the request reaches the folder that contains the requested page.</span></span> <span data-ttu-id="7fba8-188">Nachdem alle anwendbaren *\_pagestart. cshtml* -Dateien ausgeführt wurden, wird die angeforderte Seite ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-188">After all the applicable *\_PageStart.cshtml* files have run, the requested page runs.</span></span>

<span data-ttu-id="7fba8-189">Beispielsweise können Sie die folgende Kombination aus *\_Page Start. cshtml* -Dateien und der Datei " *default. cshtml* " aufweisen:</span><span class="sxs-lookup"><span data-stu-id="7fba8-189">For example, you might have the following combination of *\_PageStart.cshtml* files and *Default.cshtml* file:</span></span>

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample5.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample6.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample7.cshtml)]

<span data-ttu-id="7fba8-190">Wenn Sie */MyFolder/default.cshtml*ausführen, wird Folgendes angezeigt:</span><span class="sxs-lookup"><span data-stu-id="7fba8-190">When you run */myfolder/default.cshtml*, you'll see the following:</span></span>

[!code-console[Main](18-customizing-site-wide-behavior/samples/sample8.cmd)]

## <a name="running-initialization-code-for-all-pages-in-a-folder"></a><span data-ttu-id="7fba8-191">Ausführen des Initialisierungs Codes für alle Seiten in einem Ordner</span><span class="sxs-lookup"><span data-stu-id="7fba8-191">Running Initialization Code for All Pages in a Folder</span></span>

<span data-ttu-id="7fba8-192">Eine gute Verwendung für *\_pagestart. cshtml* -Dateien ist die Initialisierung derselben Layoutseite für alle Dateien in einem einzelnen Ordner.</span><span class="sxs-lookup"><span data-stu-id="7fba8-192">A good use for *\_PageStart.cshtml* files is to initialize the same layout page for all files in a single folder.</span></span>

1. <span data-ttu-id="7fba8-193">Erstellen Sie im Stamm Ordner einen neuen Ordner mit dem Namen *initpages*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-193">In the root folder, create a new folder named *InitPages*.</span></span>
2. <span data-ttu-id="7fba8-194">Erstellen Sie im Ordner *initpages* Ihrer Website eine Datei mit dem Namen *\_pagestart. cshtml* , und ersetzen Sie das Standard Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-194">In the *InitPages* folder of your website, create a file named *\_PageStart.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample9.cshtml)]
3. <span data-ttu-id="7fba8-195">Erstellen Sie im Stammverzeichnis der Website einen Ordner mit dem Namen *Shared*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-195">In the root of the website, create a folder named *Shared*.</span></span>
4. <span data-ttu-id="7fba8-196">Erstellen Sie im frei *gegebenen* Ordner eine Datei mit dem Namen *\_layout1. cshtml* , und ersetzen Sie das Standard Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-196">In the *Shared* folder, create a file named *\_Layout1.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample10.cshtml)]
5. <span data-ttu-id="7fba8-197">Erstellen Sie im Ordner *initpages* eine Datei mit dem Namen *Content1. cshtml* , und ersetzen Sie den vorhandenen Inhalt durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-197">In the *InitPages* folder, create a file named *Content1.cshtml* and replace the existing content with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample11.html)]
6. <span data-ttu-id="7fba8-198">Erstellen Sie im Ordner *initpages* eine weitere Datei mit dem Namen *Content2. cshtml* , und ersetzen Sie das Standard Markup durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-198">In the *InitPages* folder, create another file named *Content2.cshtml* and replace the default markup with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample12.html)]
7. <span data-ttu-id="7fba8-199">Führen Sie *Content1. cshtml* in einem Browser aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-199">Run *Content1.cshtml* in a browser.</span></span> 

    ![Klang](18-customizing-site-wide-behavior/_static/image4.jpg)

    <span data-ttu-id="7fba8-201">Wenn die *Content1. cshtml* -Seite ausgeführt wird, legt die *\_pagestart. cshtml* -Datei `Layout` fest und legt `PageData["MyBackground"]` auf eine Farbe fest.</span><span class="sxs-lookup"><span data-stu-id="7fba8-201">When the *Content1.cshtml* page runs, the *\_PageStart.cshtml* file sets `Layout` and also sets `PageData["MyBackground"]` to a color.</span></span> <span data-ttu-id="7fba8-202">In *Content1. cshtml*werden Layout und Farbe angewendet.</span><span class="sxs-lookup"><span data-stu-id="7fba8-202">In *Content1.cshtml*, the layout and color are applied.</span></span>
8. <span data-ttu-id="7fba8-203">Anzeigen von *Content2. cshtml* in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="7fba8-203">Display *Content2.cshtml* in a browser.</span></span> 

    <span data-ttu-id="7fba8-204">Das Layout ist identisch, da beide Seiten die gleiche Layoutseite und-Farbe wie in *\_pagestart. cshtml*initialisiert verwenden.</span><span class="sxs-lookup"><span data-stu-id="7fba8-204">The layout is the same, because both pages use the same layout page and color as initialized in *\_PageStart.cshtml*.</span></span>

## <a name="using-_pagestartcshtml-to-handle-errors"></a><span data-ttu-id="7fba8-205">Verwenden von \_pagestart. cshtml zum Behandeln von Fehlern</span><span class="sxs-lookup"><span data-stu-id="7fba8-205">Using \_PageStart.cshtml to Handle Errors</span></span>

<span data-ttu-id="7fba8-206">Ein weiterer guter Verwendungs Vorteil für die Datei *\_pagestart. cshtml* besteht darin, eine Möglichkeit zum Verarbeiten von Programmierfehlern (Ausnahmen) zu erstellen, die auf einer beliebigen *cshtml* -Seite in einem Ordner auftreten können.</span><span class="sxs-lookup"><span data-stu-id="7fba8-206">Another good use for the *\_PageStart.cshtml* file is to create a way to handle programming errors (exceptions) that might occur in any *.cshtml* page in a folder.</span></span> <span data-ttu-id="7fba8-207">Dieses Beispiel zeigt eine Möglichkeit, dies zu tun.</span><span class="sxs-lookup"><span data-stu-id="7fba8-207">This example shows you one way to do this.</span></span>

1. <span data-ttu-id="7fba8-208">Erstellen Sie im Stamm Ordner einen Ordner mit dem Namen *initcatch*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-208">In the root folder, create a folder named *InitCatch*.</span></span>
2. <span data-ttu-id="7fba8-209">Erstellen Sie im Ordner *initcatch* Ihrer Website eine Datei mit dem Namen *\_pagestart. cshtml* , und ersetzen Sie das vorhandene Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-209">In the *InitCatch* folder of your website, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample13.cshtml)]

    <span data-ttu-id="7fba8-210">In diesem Code versuchen Sie, die angeforderte Seite explizit durch Aufrufen der `RunPage`-Methode in einem `try`-Block auszuführen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-210">In this code, you try running the requested page explicitly by calling the `RunPage` method inside a `try` block.</span></span> <span data-ttu-id="7fba8-211">Wenn auf der angeforderten Seite Programmierfehler auftreten, wird der Code im `catch`-Block ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="7fba8-211">If any programming errors occur in the requested page, the code inside the `catch` block runs.</span></span> <span data-ttu-id="7fba8-212">In diesem Fall wird der Code an eine Seite (*Error. cshtml*) umgeleitet und übergibt den Namen der Datei, in der der Fehler aufgetreten ist, als Teil der URL.</span><span class="sxs-lookup"><span data-stu-id="7fba8-212">In this case, the code redirects to a page (*Error.cshtml*) and passes the name of the file that experienced the error as part of the URL.</span></span> <span data-ttu-id="7fba8-213">(Sie erstellen die Seite in Kürze.)</span><span class="sxs-lookup"><span data-stu-id="7fba8-213">(You'll create the page shortly.)</span></span>
3. <span data-ttu-id="7fba8-214">Erstellen Sie im Ordner *initcatch* Ihrer Website eine Datei mit dem Namen *Exception. cshtml* , und ersetzen Sie das vorhandene Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-214">In the *InitCatch* folder of your website, create a file named *Exception.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample14.cshtml)]

    <span data-ttu-id="7fba8-215">Im Rahmen dieses Beispiels wird in diesem Beispiel bewusst ein Fehler erstellt, wenn Sie versuchen, eine Datenbankdatei zu öffnen, die nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="7fba8-215">For purposes of this example, what you're doing in this page is deliberately creating an error by trying to open a database file that doesn't exist.</span></span>
4. <span data-ttu-id="7fba8-216">Erstellen Sie im Stamm Ordner eine Datei namens *Error. cshtml* , und ersetzen Sie das vorhandene Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-216">In the root folder, create a file named *Error.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample15.html)]

    <span data-ttu-id="7fba8-217">Auf dieser Seite ruft der Ausdruck `@Request["source"]` den Wert aus der URL ab und zeigt ihn an.</span><span class="sxs-lookup"><span data-stu-id="7fba8-217">In this page, the expression `@Request["source"]` gets the value out of the URL and displays it.</span></span>
5. <span data-ttu-id="7fba8-218">Klicken Sie in der Symbolleiste auf **Speichern**.</span><span class="sxs-lookup"><span data-stu-id="7fba8-218">In the toolbar, click **Save**.</span></span>
6. <span data-ttu-id="7fba8-219">Führen Sie *Exception. cshtml* in einem Browser aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-219">Run *Exception.cshtml* in a browser.</span></span> 

    ![Klang](18-customizing-site-wide-behavior/_static/image5.jpg)

    <span data-ttu-id="7fba8-221">Da in *Exception. cshtml*ein Fehler auftritt, wird die *\_pagestart. cshtml* -Seite an die Datei *Error. cshtml* umgeleitet, in der die Meldung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="7fba8-221">Because an error occurs in *Exception.cshtml*, the *\_PageStart.cshtml* page redirects to the *Error.cshtml* file, which displays the message.</span></span>

    <span data-ttu-id="7fba8-222">Weitere Informationen zu Ausnahmen finden Sie unter [Einführung in ASP.net Web Pages Programmierung mithilfe der Razor-Syntax](https://go.microsoft.com/fwlink/?LinkID=251587).</span><span class="sxs-lookup"><span data-stu-id="7fba8-222">For more information about exceptions, see [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkID=251587).</span></span>

<a id="Using__PageStart.cshtml_to_Restrict_Folder_Access"></a>
## <a name="using-_pagestartcshtml-to-restrict-folder-access"></a><span data-ttu-id="7fba8-223">Verwenden von \_pagestart. cshtml zum Einschränken des Ordner Zugriffs</span><span class="sxs-lookup"><span data-stu-id="7fba8-223">Using \_PageStart.cshtml to Restrict Folder Access</span></span>

<span data-ttu-id="7fba8-224">Sie können auch die Datei *\_pagestart. cshtml* verwenden, um den Zugriff auf alle Dateien in einem Ordner einzuschränken.</span><span class="sxs-lookup"><span data-stu-id="7fba8-224">You can also use the *\_PageStart.cshtml* file to restrict access to all the files in a folder.</span></span>

1. <span data-ttu-id="7fba8-225">Erstellen Sie in webmatrix mithilfe der Option **Site from Template** eine neue Website.</span><span class="sxs-lookup"><span data-stu-id="7fba8-225">In WebMatrix, create a new website using the **Site From Template** option.</span></span>
2. <span data-ttu-id="7fba8-226">Wählen Sie in den verfügbaren Vorlagen die Option **Starter Site**aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-226">From the available templates, select **Starter Site**.</span></span>
3. <span data-ttu-id="7fba8-227">Erstellen Sie im Stamm Ordner einen Ordner mit dem Namen *authentieredcontent*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-227">In the root folder, create a folder named *AuthenticatedContent*.</span></span>
4. <span data-ttu-id="7fba8-228">Erstellen Sie im Ordner *Authenti-Content* eine Datei mit dem Namen *\_pagestart. cshtml* , und ersetzen Sie das vorhandene Markup und den Code durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-228">In the *AuthenticatedContent* folder, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample16.cshtml)]

    <span data-ttu-id="7fba8-229">Der Code wird gestartet, indem verhindert wird, dass alle Dateien im Ordner zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="7fba8-229">The code starts by preventing all files in the folder from being cached.</span></span> <span data-ttu-id="7fba8-230">(Dies ist für Szenarien wie z. b. öffentliche Computer erforderlich, in denen Sie nicht möchten, dass die zwischengespeicherten Seiten eines Benutzers für den nächsten Benutzer verfügbar sind.) Als Nächstes bestimmt der Code, ob der Benutzer sich bei der Website angemeldet hat, bevor er eine der Seiten im Ordner anzeigen kann.</span><span class="sxs-lookup"><span data-stu-id="7fba8-230">(This is required for scenarios like public computers, where you don't want one user's cached pages to be available to the next user.) Next, the code determines whether the user has signed in to the site before they can view any of the pages in the folder.</span></span> <span data-ttu-id="7fba8-231">Wenn der Benutzer nicht angemeldet ist, wird der Code an die Anmeldeseite umgeleitet.</span><span class="sxs-lookup"><span data-stu-id="7fba8-231">If the user is not signed in, the code redirects to the login page.</span></span> <span data-ttu-id="7fba8-232">Auf der Anmeldeseite kann der Benutzer auf die ursprünglich angeforderte Seite zurückgegeben werden, wenn Sie einen Abfrage Zeichenfolgen-Wert mit dem Namen `ReturnUrl`einschließen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-232">The login page can return the user to the page that was originally requested if you include a query string value named `ReturnUrl`.</span></span>
5. <span data-ttu-id="7fba8-233">Erstellen Sie im Ordner *Authenti-Content* eine neue Seite mit dem Namen *Page. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="7fba8-233">Create a new page in the *AuthenticatedContent* folder named *Page.cshtml*.</span></span>
6. <span data-ttu-id="7fba8-234">Ersetzen Sie das Standard Markup durch Folgendes:</span><span class="sxs-lookup"><span data-stu-id="7fba8-234">Replace the default markup with the following:</span></span>  

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample17.cshtml)]
7. <span data-ttu-id="7fba8-235">Führen Sie *Page. cshtml* in einem Browser aus.</span><span class="sxs-lookup"><span data-stu-id="7fba8-235">Run *Page.cshtml* in a browser.</span></span> <span data-ttu-id="7fba8-236">Der Code leitet Sie zu einer Anmeldeseite um.</span><span class="sxs-lookup"><span data-stu-id="7fba8-236">The code redirects you to a login page.</span></span> <span data-ttu-id="7fba8-237">Sie müssen sich registrieren, bevor Sie sich anmelden.</span><span class="sxs-lookup"><span data-stu-id="7fba8-237">You must register before logging in.</span></span> <span data-ttu-id="7fba8-238">Nachdem Sie registriert und angemeldet sind, können Sie zu der Seite navigieren und ihren Inhalt anzeigen.</span><span class="sxs-lookup"><span data-stu-id="7fba8-238">After you've registered and logged in, you can navigate to the page and view its contents.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="7fba8-239">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="7fba8-239">Additional Resources</span></span>

[<span data-ttu-id="7fba8-240">Einführung in ASP.net Web Pages Programmierung mithilfe der Razor-Syntax</span><span class="sxs-lookup"><span data-stu-id="7fba8-240">Introduction to ASP.NET Web Pages Programming Using the Razor Syntax</span></span>](https://go.microsoft.com/fwlink/?LinkID=251587)
